Run started:2025-04-12 17:13:48.129914

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	AUTHOR_EMAIL = "jupyter@googlegroups.org"
19	URL = "https://github.com/jupyter-incubator/sparkmagic"
20	DOWNLOAD_URL = "https://github.com/jupyter-incubator/sparkmagic"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	URL = "https://github.com/jupyter-incubator/sparkmagic"
20	DOWNLOAD_URL = "https://github.com/jupyter-incubator/sparkmagic"
21	LICENSE = "BSD 3-clause"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/setup.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	    with io.open(path, encoding=encoding) as fp:
33	        return fp.read()
34	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	def requirements(path):
38	    lines = read(path).splitlines()
39	    # remove comments and empty lines

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/setup.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	    """
49	    version_file = read(path)
50	    version_match = re.search(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/auth/customauth.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        else:
23	            self.url = "http://example.com/livy"
24	        self.widgets = self.get_widgets(WIDGET_WIDTH)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/auth/customauth.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        self.address_widget = ipywidget_factory.get_text(
38	            description="Address:", value="http://example.com/livy", width=widget_width
39	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/kernels/kernelmagics.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	        self._assure_cell_body_is_empty(KernelMagics.help.__name__, cell)
96	        help_html = """
97	<table>
98	  <tr>
99	    <th>Magic</th>
100	    <th>Example</th>
101	    <th>Explanation</th>
102	  </tr>
103	  <tr>
104	    <td>info</td>
105	    <td>%%info</td>
106	    <td>Outputs session information for the current Livy endpoint.</td>
107	  </tr>
108	  <tr>
109	    <td>cleanup</td>
110	    <td>%%cleanup -f</td>
111	    <td>Deletes all sessions for the current Livy endpoint, including this notebook's session. The force flag is mandatory.</td>
112	  </tr>
113	  <tr>
114	    <td>delete</td>
115	    <td>%%delete -f -s 0</td>
116	    <td>Deletes a session by number for the current Livy endpoint. Cannot delete this kernel's session.</td>
117	  </tr>
118	  <tr>
119	    <td>logs</td>
120	    <td>%%logs</td>
121	    <td>Outputs the current session's Livy logs.</td>
122	  </tr>
123	  <tr>
124	    <td>configure</td>
125	    <td>%%configure -f<br/>{"executorMemory": "1000M", "executorCores": 4}</td>
126	    <td>Configure the session creation parameters. The force flag is mandatory if a session has already been
127	    created and the session will be dropped and recreated.<br/>Look at <a href="https://github.com/cloudera/livy#request-body">
128	    Livy's POST /sessions Request Body</a> for a list of valid parameters. Parameters must be passed in as a JSON string.</td>
129	  </tr>
130	  <tr>
131	    <td>spark</td>
132	    <td>%%spark -o df<br/>df = spark.read.parquet('...</td>
133	    <td>Executes spark commands.
134	    Parameters:
135	      <ul>
136	        <li>-o VAR_NAME: The Spark dataframe of name VAR_NAME will be available in the %%local Python context as a
137	          <a href="http://pandas.pydata.org/">Pandas</a> dataframe with the same name.</li>
138	        <li>-m METHOD: Sample method, either <tt>take</tt> or <tt>sample</tt>.</li>
139	        <li>-n MAXROWS: The maximum number of rows of a dataframe that will be pulled from Livy to Jupyter.
140	            If this number is negative, then the number of rows will be unlimited.</li>
141	        <li>-r FRACTION: Fraction used for sampling.</li>
142	      </ul>
143	    </td>
144	  </tr>
145	  <tr>
146	    <td>sql</td>
147	    <td>%%sql -o tables -q<br/>SHOW TABLES</td>
148	    <td>Executes a SQL query against the variable sqlContext (Spark v1.x) or spark (Spark v2.x).
149	    Parameters:
150	      <ul>
151	        <li>-o VAR_NAME: The result of the SQL query will be available in the %%local Python context as a
152	          <a href="http://pandas.pydata.org/">Pandas</a> dataframe.</li>
153	        <li>-q: The magic will return None instead of the dataframe (no visualization).</li>
154	        <li>-m, -n, -r are the same as the %%spark parameters above.</li>
155	      </ul>
156	    </td>
157	  </tr>
158	  <tr>
159	    <td>local</td>
160	    <td>%%local<br/>a = 1</td>
161	    <td>All the code in subsequent lines will be executed locally. Code must be valid Python code.</td>
162	  </tr>
163	  <tr>
164	    <td>send_to_spark</td>
165	    <td>%%send_to_spark -i variable -t str -n var</td>
166	    <td>Sends a variable from local output to spark cluster.
167	    <br/>
168	    Parameters:
169	      <ul>
170	        <li>-i VAR_NAME: Local Pandas DataFrame(or String) of name VAR_NAME will be available in the %%spark context as a 
171	          Spark dataframe(or String) with the same name.</li>
172	        <li>-t TYPE: Specifies the type of variable passed as -i. Available options are:
173	         `str` for string and `df` for Pandas DataFrame. Optional, defaults to `str`.</li>
174	        <li>-n NAME: Custom name of variable passed as -i. Optional, defaults to -i variable name.</li>
175	        <li>-m MAXROWS: Maximum amount of Pandas rows that will be sent to Spark. Defaults to 2500.</li>
176	      </ul>
177	    </td>
178	  </tr>
179	  <tr>
180	    <td>pretty</td>
181	    <td>%%pretty</td>
182	    <td>If the cell output is a dataframe, like <code>df.show()</code>, then it will pretty print the dataframe as an HTML table</td>
183	  </tr>
184	</table>
185	"""
186	        self.ipython_display.html(help_html)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/kernels/wrapperkernel/sparkkernelbase.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	        # Do not load magics in testing
112	        if kwargs.get("testing", False):
113	            return

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/livyclientlib/command.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
143	                    if MIMETYPE_IMAGE_PNG in data:
144	                        image = Image(base64.b64decode(data[MIMETYPE_IMAGE_PNG]))
145	                        return (True, image, MIMETYPE_IMAGE_PNG)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/livyclientlib/command.py:144
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
143	                    if MIMETYPE_IMAGE_PNG in data:
144	                        image = Image(base64.b64decode(data[MIMETYPE_IMAGE_PNG]))
145	                        return (True, image, MIMETYPE_IMAGE_PNG)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/livyclientlib/reliablehttpclient.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	        http_session_config = conf.http_session_config()
32	        if http_session_config and http_session_config.get("adapters"):
33	            self._set_http_session_adapters(http_session_config["adapters"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/livyclientlib/reliablehttpclient.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	        for adapter in adapters:
37	            full_class = adapter.get("adapter")
38	            adapter_prefix = adapter.get("prefix")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/livyclientlib/reliablehttpclient.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	            full_class = adapter.get("adapter")
38	            adapter_prefix = adapter.get("prefix")
39	            if full_class is None or adapter_prefix is None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/livyclientlib/reliablehttpclient.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
57	        """Sends a get request. Returns a response."""
58	        return self._send_request(
59	            relative_url, accepted_status_codes, self._session.get
60	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/livyclientlib/reliablehttpclient.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
63	        """Sends a post request. Returns a response."""
64	        return self._send_request(
65	            relative_url, accepted_status_codes, self._session.post, data
66	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/livyclientlib/reliablehttpclient.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
69	        """Sends a delete request. Returns a response."""
70	        return self._send_request(
71	            relative_url, accepted_status_codes, self._session.delete
72	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/magics/remotesparkmagics.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	                self.ipython_display.send_error(
239	                    "Need to supply URL argument (e.g. -u https://example.com/livyendpoint)"
240	                )
241	                return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/magics/sparkmagicsbase.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	        else:
112	            self.ipython_display.write(
113	                "Successfully passed '{}' as '{}' to Spark"
114	                " kernel".format(input_variable_name, output_variable_name)
115	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/utils/configuration.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	        "base64_password": "",
122	        "url": "http://localhost:8998",
123	        "auth": NO_AUTH,
124	    }
125	
126	
127	def base64_kernel_python_credentials():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/utils/configuration.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        "base64_password": "",
146	        "url": "http://localhost:8998",
147	        "auth": NO_AUTH,
148	    }
149	
150	
151	def base64_kernel_scala_credentials():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/utils/configuration.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	        "base64_password": "",
160	        "url": "http://localhost:8998",
161	        "auth": NO_AUTH,
162	    }
163	
164	
165	def base64_kernel_r_credentials():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/utils/configuration.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	    base64_decoded_credentials = {
340	        k: credentials.get(k) for k in ("username", "password", "url", "auth")
341	    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/utils/configuration.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
341	    }
342	    base64_password = credentials.get("base64_password")
343	    if base64_password is not None:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/utils/configuration.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
344	        try:
345	            base64_decoded_credentials["password"] = base64.b64decode(
346	                base64_password
347	            ).decode()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/utils/configuration.py:345
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
344	        try:
345	            base64_decoded_credentials["password"] = base64.b64decode(
346	                base64_password
347	            ).decode()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sparkmagic-0.22.0/sparkmagic-0.22.0/sparkmagic/utils/constants.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	INTERNAL_ERROR_MSG = (
113	    "An internal error was encountered.\n"
114	    "Please file an issue at https://github.com/jupyter-incubator/sparkmagic\nError:\n{}"
115	)
116	EXPECTED_ERROR_MSG = "An error was encountered:\n{}"
117	

--------------------------------------------------

Code scanned:
	Total lines of code: 4764
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 2.0
Files skipped (0):
