Run started:2025-04-12 10:36:58.488846

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/__init__.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	        __git_hash__ = str(_package_metadata['git_hash'])
85	        __git_base_url__ = 'https://github.com/yahoo/redislite'
86	        if __git_origin__.endswith('.git'):  # pragma: no cover

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/client.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
118	                    # noinspection PyTypeChecker
119	                    pid = int(open(self.pidfile).read())
120	                    try:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/client.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
129	                ):  # pragma: no cover
130	                    shutil.rmtree(self.redis_dir)
131	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/client.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
206	        with open(self.redis_configuration_filename, 'w') as file_handle:
207	            file_handle.write(self.redis_configuration)
208	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/client.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
206	        with open(self.redis_configuration_filename, 'w') as file_handle:
207	            file_handle.write(self.redis_configuration)
208	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/client.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
280	            with open(settings['pidfile']) as file_handle:
281	                pid = file_handle.read().strip()   # NOQA
282	                pid = int(pid)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/client.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
306	        with open(self.settingregistryfile, 'w') as fh:
307	            os.fchmod(fh.fileno(), 0o0600)  # Only owner can access
308	            json.dump(settings, fh)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/client.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
323	            with open(pidfile) as fh:
324	                pid_number = int(fh.read())
325	            if pid_number:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/client.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
511	            with open(self.pidfile) as file_handle:
512	                pid = int(file_handle.read().strip())
513	                if pid:  # pragma: no cover

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/debug.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	    info.append('\n\tFound redis-server: %s' % redis_server)
72	    for item in os.popen('%s --version' % redis_server).read().strip().split():
73	        if '=' in item:

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redislite/debug.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
71	    info.append('\n\tFound redis-server: %s' % redis_server)
72	    for item in os.popen('%s --version' % redis_server).read().strip().split():
73	        if '=' in item:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	REDIS_VERSION = os.environ.get('REDIS_VERSION', '6.2.14')
33	REDIS_URL = f'http://download.redis.io/releases/redis-{REDIS_VERSION}.tar.gz'
34	install_scripts = ''

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
42	    if pathlib.Path(REDIS_PATH).exists():
43	        shutil.rmtree(REDIS_PATH)
44	    with tempfile.TemporaryDirectory() as tempdir:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
45	        print(f'Downloading {REDIS_URL} to temp directory {tempdir}')
46	        ftpstream = urllib.request.urlopen(REDIS_URL)
47	        tf = tarfile.open(fileobj=ftpstream, mode="r|gz")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
45	        print(f'Downloading {REDIS_URL} to temp directory {tempdir}')
46	        ftpstream = urllib.request.urlopen(REDIS_URL)
47	        tf = tarfile.open(fileobj=ftpstream, mode="r|gz")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
46	        ftpstream = urllib.request.urlopen(REDIS_URL)
47	        tf = tarfile.open(fileobj=ftpstream, mode="r|gz")
48	        directory = tf.next().name

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
138	        if os.path.exists(md_file):
139	            with open(md_file) as fh:
140	                md = json.load(fh)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
147	            # Store the redis-server --version output for later
148	            for line in os.popen('%s --version' % md['redis_bin']).readlines():
149	                line = line.strip()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
147	            # Store the redis-server --version output for later
148	            for line in os.popen('%s --version' % md['redis_bin']).readlines():
149	                line = line.strip()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
155	            print('new metadata: %s' % md)
156	            with open(md_file, 'w') as fh:
157	                json.dump(md, fh, indent=4)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
202	        """
203	        git_rev = len(os.popen('git rev-list HEAD').readlines())
204	        if git_rev != 0:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
202	        """
203	        git_rev = len(os.popen('git rev-list HEAD').readlines())
204	        if git_rev != 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
214	        """
215	        return os.popen('git rev-parse --abbrev-ref HEAD').read().strip()
216	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
214	        """
215	        return os.popen('git rev-parse --abbrev-ref HEAD').read().strip()
216	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
214	        """
215	        return os.popen('git rev-parse --abbrev-ref HEAD').read().strip()
216	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
222	        """
223	        return os.popen('git rev-parse HEAD').read().strip()
224	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
222	        """
223	        return os.popen('git rev-parse HEAD').read().strip()
224	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
222	        """
223	        return os.popen('git rev-parse HEAD').read().strip()
224	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
230	        """
231	        for item in os.popen('git remote -v'):
232	            split_item = item.strip().split()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
230	        """
231	        for item in os.popen('git remote -v'):
232	            split_item = item.strip().split()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
245	    if not os.path.exists('.git') and os.path.exists(METADATA_FILENAME):
246	        with open(METADATA_FILENAME) as fh:
247	            metadata = json.load(fh)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/setup.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
256	        }
257	        with open(METADATA_FILENAME, 'w') as fh:
258	            json.dump(metadata, fh, indent=4)

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_client.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
45	                if proc.name() == 'redis-server':
46	                    if proc.username() == getpass.getuser():
47	                        processes.append(proc)

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_client.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
45	                if proc.name() == 'redis-server':
46	                    if proc.username() == getpass.getuser():
47	                        processes.append(proc)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_client.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
55	            with open(connection.logfile) as f:
56	                print(f.read())
57	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_client.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
109	        self.assertTrue(os.path.exists(filename))
110	        shutil.rmtree(temp_dir)
111	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_client.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
123	        self.assertTrue(os.path.exists(filename))
124	        shutil.rmtree(temp_dir)
125	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_configuration.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
46	                if proc.name() == 'redis-server':
47	                    if proc.username() == getpass.getuser():
48	                        processes.append(proc)

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_configuration.py:47
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
46	                if proc.name() == 'redis-server':
47	                    if proc.username() == getpass.getuser():
48	                        processes.append(proc)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_configuration.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
66	        if os.path.exists(self.tempdir) and 'tmp' in self.tempdir:
67	            shutil.rmtree(self.tempdir)
68	            self.tempdir = None

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_patch.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
44	                if proc.name() == 'redis-server':
45	                    if proc.username() == getpass.getuser():
46	                        processes.append(proc)

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_patch.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
44	                if proc.name() == 'redis-server':
45	                    if proc.username() == getpass.getuser():
46	                        processes.append(proc)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/tests/test_patch.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
67	        if os.path.exists(self.tempdir) and 'tmp' in self.tempdir:
68	            shutil.rmtree(self.tempdir)
69	            self.tempdir = None

--------------------------------------------------

Code scanned:
	Total lines of code: 2039
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 38.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 3.0
Files skipped (2):
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redis.submodule/deps/jemalloc/scripts/gen_run_tests.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/redislite-6.2.912183/redislite-6.2.912183/redis.submodule/deps/jemalloc/scripts/gen_travis.py (syntax error while parsing AST from file)
