Run started:2025-04-12 11:39:26.019488

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/auth0.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	    url = f"https://{domain}/.well-known/openid-configuration"
18	    openid_config = requests.get(url).json()
19	    return str(openid_config.get("issuer", ""))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/auth0.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	    openid_config = requests.get(url).json()
19	    return str(openid_config.get("issuer", ""))
20	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/auth0.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	    def _construct(self, jwks: Dict[str, Any]) -> Dict[str, Key]:
24	        return {_jwk["kid"]: jwk.construct(_jwk) for _jwk in jwks.get("keys", [])}
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/cognito.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    ):
35	        url = f"https://cognito-idp.{region}.amazonaws.com/{userPoolId}/.well-known/jwks.json"
36	        jwks = JWKS(url=url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/cognito.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	            audience=client_id,
40	            issuer=f"https://cognito-idp.{region}.amazonaws.com/{userPoolId}",
41	            scope_key=scope_key,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/cognito.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	                client_id=client_id,
45	                issuer=f"https://cognito-idp.{region}.amazonaws.com/{userPoolId}",
46	                token_use={"access"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/cognito.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	    ):
71	        url = f"https://cognito-idp.{region}.amazonaws.com/{userPoolId}/.well-known/jwks.json"
72	        jwks = JWKS(url=url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/cognito.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	            audience=client_id,
77	            issuer=f"https://cognito-idp.{region}.amazonaws.com/{userPoolId}",
78	            extra=CognitoExtraVerifier(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/cognito.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	                client_id=client_id,
80	                issuer=f"https://cognito-idp.{region}.amazonaws.com/{userPoolId}",
81	                token_use={"id"},

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/firebase.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	    def _set_expiration(self, resp: requests.Response) -> Optional[datetime]:
27	        expires_header = resp.headers.get("expires")
28	        if expires_header:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/firebase.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    def __init__(self, project_id: str, *args: Any, **kwargs: Any):
52	        url = "https://www.googleapis.com/robot/v1/metadata/x509/securetoken@system.gserviceaccount.com"
53	        jwks = JWKS(url=url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/firebase.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	            audience=project_id,
59	            issuer=f"https://securetoken.google.com/{project_id}",
60	            extra=FirebaseExtraVerifier(project_id=project_id),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/firebase.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        # auth_time must be past time
71	        if claims.get("auth_time"):
72	            auth_time = int(claims["auth_time"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/verification.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        if self.__fixed_keys is not None:
71	            return self.__fixed_keys.get(kid)
72	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/verification.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	
79	        return self.__keys.get(kid)
80	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/verification.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
115	        # requests at once.
116	        jwks_resp = requests.get(self.__url)
117	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/verification.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	
180	        kid = header.get("kid")
181	        if not kid:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/verification.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	        # iat validation
237	        if claims.get("iat"):
238	            iat = int(claims["iat"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_cloudauth-0.4.3-py3-none-any/fastapi_cloudauth/verification.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	
331	        scopes = claims.get(self.scope_key)
332	        if self.scope_name is None:

--------------------------------------------------

Code scanned:
	Total lines of code: 804
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 0.0
Files skipped (0):
