Run started:2025-04-12 14:04:10.376038

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/analytics/client.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
134	                    "python_version": python_version(),
135	                    "operating_system": operating_system(),
136	                    **properties,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/analytics/client.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
165	        with open(config_file, "w") as f:
166	            f.write(f"analytics_user_id: {user_id}")
167	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/cli/cli.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
200	        ) and Path(spec_files_dir).exists():
201	            shutil.rmtree(spec_files_dir)
202	        if (

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/cli/cli.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
209	        ) and Path(tf_files_dir).exists():
210	            shutil.rmtree(tf_files_dir)
211	        declare(f"Stack '{stack_name}' has been destroyed.")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/cli/cli.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
222	                destroy_remote_state(provider)
223	                shutil.rmtree(remote_state_dir)
224	            declare(f"Remote state for {provider} has been destroyed.")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/constants.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	INVALID_COMPONENT_FLAVOR_ERROR_MESSAGE = (
106	    "Only certain flavors are allowed for a given provider-component type "
107	    "combination. For more information, consult the tables for your specified "
108	    "provider at the MLStacks documentation: "
109	    "https://mlstacks.zenml.io/stacks/stack-specification."
110	)
111	STACK_COMPONENT_PROVIDER_MISMATCH_ERROR_MESSAGE = (
112	    "Stack provider and component provider mismatch."

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
337	        with open(destination_path / "terraform.tf", "w") as f:
338	            f.write(tf_config)
339	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
345	        ) as f:
346	            f.write(remote_state_bucket)
347	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
353	        ).version
354	        f.write(mlstacks_version)
355	    logger.debug("Wrote mlstacks version %s to directory.", mlstacks_version)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
386	        with open(definitions_path / MLSTACKS_VERSION_FILE_NAME) as f:
387	            tf_version = f.read()
388	            mlstacks_version = pkg_resources.get_distribution(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
439	        http_url = (
440	            f"https://storage.googleapis.com/{remote_state_bucket_url[5:]}"
441	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
602	    full_outputs = runner.client.output(full_value=True, state=state_path)
603	    return {k: v["value"] for k, v in full_outputs.items() if v.get("value")}
604	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
609	    tf_path = Path(CONFIG_DIR) / "terraform"
610	    shutil.rmtree(tf_path)
611	    logger.info("Deleted Terraform directory at %s", tf_path)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
676	    )
677	    project_id = parse_and_extract_tf_vars(stack).get("project_id")
678	    remote_state_variables = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
708	        remote_state_variables = json.load(f)
709	    return cast(str, remote_state_variables.get("bucket_name"))
710	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
784	    return (
785	        _tf_client_output(
786	            runner=tfr,
787	            state_path=os.path.join(
788	                remote_state_tf_definitions_path,
789	                "terraform.tfstate",
790	            ),
791	            output_key=REMOTE_STATE_BUCKET_URL_OUTPUT_KEY,
792	        ).get(REMOTE_STATE_BUCKET_URL_OUTPUT_KEY)
793	        or ""

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
964	    with open(os.path.join(bucket_url_file)) as f:
965	        return f.read()
966	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlstacks-0.10.0/mlstacks-0.10.0/src/mlstacks/utils/terraform_utils.py:1019
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1018	        logger.exception(
1019	            "Infracost is not installed or you have not logged in. "
1020	            "Please visit their docs at https://www.infracost.io/docs/ "
1021	            "and install, then run 'infracost auth login' before retrying.",

--------------------------------------------------

Code scanned:
	Total lines of code: 2010
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 0.0
Files skipped (0):
