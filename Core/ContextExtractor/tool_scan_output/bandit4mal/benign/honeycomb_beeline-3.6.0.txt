Run started:2025-04-12 12:27:13.164847

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/__init__.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	                 writekey='', dataset='', service_name='',
59	                 tracer=None, sample_rate=1, api_host='https://api.honeycomb.io',
60	                 max_concurrent_batches=10, max_batch_size=100, send_frequency=0.25,
61	                 block_on_send=False, block_on_response=False,
62	                 transmission_impl=None, sampler_hook=None, presend_hook=None,
63	                 http_trace_parser_hook=beeline.propagation.default.http_trace_parser_hook,
64	                 http_trace_propagation_hook=beeline.propagation.default.http_trace_propagation_hook,
65	                 debug=False):
66	
67	        self.client = None
68	        self.tracer_impl = None

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/__init__.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
158	        self.client.add_field('meta.beeline_version', VERSION)
159	        self.client.add_field('meta.local_hostname', socket.gethostname())
160	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/__init__.py:159
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
158	        self.client.add_field('meta.beeline_version', VERSION)
159	        self.client.add_field('meta.local_hostname', socket.gethostname())
160	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/__init__.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
184	            ev.add(data)
185	        self._run_hooks_and_send(ev)
186	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/__init__.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
305	            self.log("enqueuing event ev = %s", ev.fields())
306	            ev.send()
307	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/__init__.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
326	        if self.client:
327	            self.client.close()
328	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/__init__.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
330	def init(writekey='', dataset='', service_name='', tracer=None,
331	         sample_rate=1, api_host='https://api.honeycomb.io', transmission_impl=None,
332	         sampler_hook=None, presend_hook=None, debug=False, *args, **kwargs):
333	    ''' initialize the honeycomb beeline. This will initialize a libhoney
334	    client local to this module, and a tracer to track traces and spans.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/__init__.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
361	        _GBL.log(f"beeline already initialized, but process ID has changed (was {_INITPID}, now {pid}). Reinitializing.")
362	        _GBL.close()
363	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/__init__.py:774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
773	    if _GBL:
774	        _GBL.close()
775	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/requests.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
25	        # interpolation vs. when assigning a variable.
26	        method = kwargs.get('method') or args[0]
27	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/requests.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	            "request.method": method,
31	            "request.url": kwargs.get('url') or args[1],
32	        })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/requests.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
32	        })
33	        resp = _request(*args, **kwargs)
34	        return resp

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/requests.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	        if resp is not None:
43	            content_type = resp.headers.get('content-type')
44	            if content_type:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/requests.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	                    "response.content_type", content_type)
47	            content_length = resp.headers.get('content-length')
48	            if content_length:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/test_requests.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	            args = ['get']
31	            kwargs = {'url': 'http://example.com'}
32	            ret = request(m_request, m_session, args, kwargs)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/test_requests.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
31	            kwargs = {'url': 'http://example.com'}
32	            ret = request(m_request, m_session, args, kwargs)
33	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/test_requests.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	                args = ['get']
62	                kwargs = {'url': 'http://example.com'}
63	                ret = request(m_request, m_session, args, kwargs)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/test_requests.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
62	                kwargs = {'url': 'http://example.com'}
63	                ret = request(m_request, m_session, args, kwargs)
64	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/test_requests.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        args = ['get']
95	        kwargs = {'url': 'http://example.com'}
96	        ret = request(m_request, m_session, args, kwargs)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/test_requests.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
95	        kwargs = {'url': 'http://example.com'}
96	        ret = request(m_request, m_session, args, kwargs)
97	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/test_urllib.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	                headers={'content-type': 'application/json', 'content-length': 23}, status_code=500)
25	            args = ('https://example.com',)
26	            kwargs = {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/test_urllib.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	                headers={'content-type': 'application/json', 'content-length': 23}, status_code=500)
43	            req = urllib.request.Request('https://example.com/2')
44	            args = [req]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/test_urllib.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	            self.assertEqual(type(args[0]), urllib.request.Request)
47	            self.assertEqual(args[0].full_url, 'https://example.com/2')
48	            self.assertEqual(

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/patch/urllib.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
31	        })
32	        resp = _urlopen(*args, **kwargs)
33	        return resp

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/propagation/honeycomb.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
46	    version = 1
47	    trace_fields = base64.b64encode(json.dumps(
48	        propagation_context.trace_fields).encode()).decode()
49	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/propagation/honeycomb.py:47
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
46	    version = 1
47	    trace_fields = base64.b64encode(json.dumps(
48	        propagation_context.trace_fields).encode()).decode()
49	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/propagation/honeycomb.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
96	        elif k == 'context':
97	            context = json.loads(base64.b64decode(v.encode()).decode())
98	        elif k == 'dataset' and beeline.propagation.propagate_dataset:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/propagation/honeycomb.py:97
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
96	        elif k == 'context':
97	            context = json.loads(base64.b64decode(v.encode()).decode())
98	        elif k == 'dataset' and beeline.propagation.propagate_dataset:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/test_async.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
382	        loop = asyncio.get_running_loop()  # pylint: disable=no-member
383	        executor = concurrent.futures.ThreadPoolExecutor(max_workers=2)
384	        calls = set()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/test_trace.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
594	        trace_fields = {"i": "like", "to": "trace"}
595	        fields_string = base64.b64encode(
596	            json.dumps(trace_fields).encode()).decode()
597	        trace_context = f"{1};trace_id={trace_id},parent_id={parent_id},dataset_id={dataset_id},context={fields_string}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/test_trace.py:595
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
594	        trace_fields = {"i": "like", "to": "trace"}
595	        fields_string = base64.b64encode(
596	            json.dumps(trace_fields).encode()).decode()
597	        trace_context = f"{1};trace_id={trace_id},parent_id={parent_id},dataset_id={dataset_id},context={fields_string}"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/trace.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
401	    version = 1
402	    trace_fields = base64.b64encode(json.dumps(context).encode()).decode()
403	    trace_context = f"{version};trace_id={trace_id},parent_id={parent_id},context={trace_fields}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/honeycomb_beeline-3.6.0/honeycomb_beeline-3.6.0/beeline/trace.py:402
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
401	    version = 1
402	    trace_fields = base64.b64encode(json.dumps(context).encode()).decode()
403	    trace_context = f"{version};trace_id={trace_id},parent_id={parent_id},context={trace_fields}"

--------------------------------------------------

Code scanned:
	Total lines of code: 3811
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 5.0
Files skipped (0):
