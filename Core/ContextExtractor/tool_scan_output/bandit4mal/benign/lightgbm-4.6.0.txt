Run started:2025-04-12 10:16:41.765678

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/basic.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
882	        with open(file_name, "a") as f:
883	            f.write(pandas_str)
884	    return pandas_str

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/basic.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
882	        with open(file_name, "a") as f:
883	            f.write(pandas_str)
884	    return pandas_str

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/callback.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	            raise RuntimeError(
149	                "record_evaluation() callback enabled but no evaluation results found. This is a probably bug in LightGBM. "
150	                "Please report it at https://github.com/microsoft/LightGBM/issues"
151	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/callback.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	            raise RuntimeError(
167	                "record_evaluation() callback enabled but no evaluation results found. This is a probably bug in LightGBM. "
168	                "Please report it at https://github.com/microsoft/LightGBM/issues"
169	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/callback.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
408	            raise RuntimeError(
409	                "early_stopping() callback enabled but no evaluation results found. This is a probably bug in LightGBM. "
410	                "Please report it at https://github.com/microsoft/LightGBM/issues"
411	            )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/dask.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
68	    def acquire(self) -> int:
69	        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
70	        self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/dask.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
74	    def release(self) -> None:
75	        self.socket.close()
76	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/libpath.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
26	    ]
27	    if system() in ("Windows", "Microsoft"):
28	        dll_path.append(curr_path.parents[1] / "Release")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/libpath.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
26	    ]
27	    if system() in ("Windows", "Microsoft"):
28	        dll_path.append(curr_path.parents[1] / "Release")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/libpath.py:27
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
26	    ]
27	    if system() in ("Windows", "Microsoft"):
28	        dll_path.append(curr_path.parents[1] / "Release")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/libpath.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
30	        dll_path = [p / "lib_lightgbm.dll" for p in dll_path]
31	    elif system() == "Darwin":
32	        dll_path = [p / "lib_lightgbm.dylib" for p in dll_path]

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/libpath.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
30	        dll_path = [p / "lib_lightgbm.dll" for p in dll_path]
31	    elif system() == "Darwin":
32	        dll_path = [p / "lib_lightgbm.dylib" for p in dll_path]

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/libpath.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
30	        dll_path = [p / "lib_lightgbm.dll" for p in dll_path]
31	    elif system() == "Darwin":
32	        dll_path = [p / "lib_lightgbm.dylib" for p in dll_path]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/plotting.py:834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
833	    s = BytesIO()
834	    s.write(graph.pipe(format="png"))
835	    s.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/plotting.py:836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
835	    s.seek(0)
836	    img = matplotlib.image.imread(s)
837	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/sklearn.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	    error_msg = (
124	        "Estimators in lightgbm.sklearn should only retrieve query groups from a constructed Dataset. "
125	        "If you're seeing this message, it's a bug in lightgbm. Please report it at https://github.com/microsoft/LightGBM/issues."
126	    )
127	    assert group is None or isinstance(group, np.ndarray), error_msg
128	    return group

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/sklearn.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	    error_msg = (
134	        "Estimators in lightgbm.sklearn should only retrieve labels from a constructed Dataset. "
135	        "If you're seeing this message, it's a bug in lightgbm. Please report it at https://github.com/microsoft/LightGBM/issues."
136	    )
137	    assert isinstance(label, np.ndarray), error_msg
138	    return label

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/sklearn.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	    error_msg = (
144	        "Estimators in lightgbm.sklearn should only retrieve weights from a constructed Dataset. "
145	        "If you're seeing this message, it's a bug in lightgbm. Please report it at https://github.com/microsoft/LightGBM/issues."
146	    )
147	    assert weight is None or isinstance(weight, np.ndarray), error_msg
148	    return weight

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/sklearn.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
414	
415	_lgbmmodel_doc_predict = """
416	    {description}
417	
418	    Parameters
419	    ----------
420	    X : {X_shape}
421	        Input features matrix.
422	    raw_score : bool, optional (default=False)
423	        Whether to predict raw scores.
424	    start_iteration : int, optional (default=0)
425	        Start index of the iteration to predict.
426	        If <= 0, starts from the first iteration.
427	    num_iteration : int or None, optional (default=None)
428	        Total number of iterations used in the prediction.
429	        If None, if the best iteration exists and start_iteration <= 0, the best iteration is used;
430	        otherwise, all iterations from ``start_iteration`` are used (no limits).
431	        If <= 0, all iterations from ``start_iteration`` are used (no limits).
432	    pred_leaf : bool, optional (default=False)
433	        Whether to predict leaf index.
434	    pred_contrib : bool, optional (default=False)
435	        Whether to predict feature contributions.
436	
437	        .. note::
438	
439	            If you want to get more explanations for your model's predictions using SHAP values,
440	            like SHAP interaction values,
441	            you can install the shap package (https://github.com/slundberg/shap).
442	            Note that unlike the shap package, with ``pred_contrib`` we return a matrix with an extra
443	            column, where the last column is the expected value.
444	
445	    validate_features : bool, optional (default=False)
446	        If True, ensure that the features used to predict match the ones used to train.
447	        Used only if data is pandas DataFrame.
448	    **kwargs
449	        Other parameters for the prediction.
450	
451	    Returns
452	    -------
453	    {output_name} : {predicted_result_shape}
454	        The predicted values.
455	    X_leaves : {X_leaves_shape}
456	        If ``pred_leaf=True``, the predicted leaf of every tree for each sample.
457	    X_SHAP_values : {X_SHAP_values_shape}
458	        If ``pred_contrib=True``, the feature contributions for each sample.
459	    """
460	
461	
462	def _extract_evaluation_meta_data(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/sklearn.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
675	        check_sample_weight_str = (
676	            "In LightGBM, setting a sample's weight to 0 can produce a different result than omitting the sample. "
677	            "Such samples intentionally still affect count-based measures like 'min_data_in_leaf' "
678	            "(https://github.com/microsoft/LightGBM/issues/5626#issuecomment-1712706678) and the estimated distribution "
679	            "of features for Dataset construction (see https://github.com/microsoft/LightGBM/issues/5553)."
680	        )
681	        # "check_sample_weight_equivalence" can be removed when lightgbm's
682	        # minimum supported scikit-learn version is at least 1.6
683	        # ref: https://github.com/scikit-learn/scikit-learn/pull/30137
684	        return {
685	            "allow_nan": True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightgbm-4.6.0/lightgbm-4.6.0/lightgbm/sklearn.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
687	            "_xfail_checks": {
688	                "check_no_attributes_set_in_init": "scikit-learn incorrectly asserts that private attributes "
689	                "cannot be set in __init__: "
690	                "(see https://github.com/microsoft/LightGBM/issues/2628)",
691	                "check_sample_weight_equivalence": check_sample_weight_str,
692	                "check_sample_weight_equivalence_on_dense_data": check_sample_weight_str,
693	                "check_sample_weight_equivalence_on_sparse_data": check_sample_weight_str,
694	            },
695	        }

--------------------------------------------------

Code scanned:
	Total lines of code: 9778
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 3.0
Files skipped (0):
