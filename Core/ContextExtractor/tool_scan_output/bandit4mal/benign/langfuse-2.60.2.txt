Run started:2025-04-12 12:22:29.211008

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/_task_manager/media_manager.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	        try:
38	            upload_job = self._queue.get(block=True, timeout=1)
39	            self._log.debug(f"Processing upload for {upload_job['media_id']}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/_task_manager/media_manager.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	            body = event["body"]
56	            trace_id = body.get("traceId", None) or (
57	                body.get("id", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/_task_manager/media_manager.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	            trace_id = body.get("traceId", None) or (
57	                body.get("id", None)
58	                if "type" in event and "trace" in event["type"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/_task_manager/media_manager.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	            observation_id = (
66	                body.get("id", None)
67	                if "type" in event

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/api/core/http_client.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
206	
207	        response = self.httpx_client.request(
208	            method=method,
209	            url=urllib.parse.urljoin(f"{base_url}/", path),
210	            headers=jsonable_encoder(
211	                remove_none_from_dict(
212	                    {
213	                        **self.base_headers,
214	                        **(headers if headers is not None else {}),
215	                        **(
216	                            request_options.get("additional_headers", {}) or {}
217	                            if request_options is not None
218	                            else {}
219	                        ),
220	                    }
221	                )
222	            ),
223	            params=encode_query(
224	                jsonable_encoder(
225	                    remove_none_from_dict(
226	                        remove_omit_from_dict(
227	                            {
228	                                **(params if params is not None else {}),
229	                                **(
230	                                    request_options.get(
231	                                        "additional_query_parameters", {}
232	                                    )
233	                                    or {}
234	                                    if request_options is not None
235	                                    else {}
236	                                ),
237	                            },
238	                            omit,
239	                        )
240	                    )
241	                )
242	            ),
243	            json=json_body,
244	            data=data_body,
245	            content=content,
246	            files=convert_file_dict_to_httpx_tuples(remove_none_from_dict(files))
247	            if files is not None
248	            else None,
249	            timeout=timeout,
250	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/api/core/http_client.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
257	                time.sleep(_retry_timeout(response=response, retries=retries))
258	                return self.request(
259	                    path=path,
260	                    method=method,
261	                    base_url=base_url,
262	                    params=params,
263	                    json=json,
264	                    content=content,
265	                    files=files,
266	                    headers=headers,
267	                    request_options=request_options,
268	                    retries=retries + 1,
269	                    omit=omit,
270	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/api/core/http_client.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
407	        # Add the input to each of these and do None-safety checks
408	        response = await self.httpx_client.request(
409	            method=method,
410	            url=urllib.parse.urljoin(f"{base_url}/", path),
411	            headers=jsonable_encoder(
412	                remove_none_from_dict(
413	                    {
414	                        **self.base_headers,
415	                        **(headers if headers is not None else {}),
416	                        **(
417	                            request_options.get("additional_headers", {}) or {}
418	                            if request_options is not None
419	                            else {}
420	                        ),
421	                    }
422	                )
423	            ),
424	            params=encode_query(
425	                jsonable_encoder(
426	                    remove_none_from_dict(
427	                        remove_omit_from_dict(
428	                            {
429	                                **(params if params is not None else {}),
430	                                **(
431	                                    request_options.get(
432	                                        "additional_query_parameters", {}
433	                                    )
434	                                    or {}
435	                                    if request_options is not None
436	                                    else {}
437	                                ),
438	                            },
439	                            omit,
440	                        )
441	                    )
442	                )
443	            ),
444	            json=json_body,
445	            data=data_body,
446	            content=content,
447	            files=convert_file_dict_to_httpx_tuples(remove_none_from_dict(files))
448	            if files is not None
449	            else None,
450	            timeout=timeout,
451	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/api/core/http_client.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
458	                await asyncio.sleep(_retry_timeout(response=response, retries=retries))
459	                return await self.request(
460	                    path=path,
461	                    method=method,
462	                    base_url=base_url,
463	                    params=params,
464	                    json=json,
465	                    content=content,
466	                    files=files,
467	                    headers=headers,
468	                    request_options=request_options,
469	                    retries=retries + 1,
470	                    omit=omit,
471	                )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/api/core/jsonable_encoder.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
65	    if isinstance(obj, bytes):
66	        return base64.b64encode(obj).decode("utf-8")
67	    if isinstance(obj, Enum):

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/api/core/jsonable_encoder.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
65	    if isinstance(obj, bytes):
66	        return base64.b64encode(obj).decode("utf-8")
67	    if isinstance(obj, Enum):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/callback/langchain.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
841	            self.log.warning(
842	                "Langfuse was not able to parse the LLM model. The LLM call will be recorded without model name. Please create an issue: https://github.com/langfuse/langfuse/issues/new/choose"
843	            )
844	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/client.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	            self.log.warning(
265	                "Langfuse client is disabled since no public_key was provided as a parameter or environment variable 'LANGFUSE_PUBLIC_KEY'. See our docs: https://langfuse.com/docs/sdk/python/low-level-sdk#initialize-client"
266	            )
267	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/client.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	            self.log.warning(
271	                "Langfuse client is disabled since no secret_key was provided as a parameter or environment variable 'LANGFUSE_SECRET_KEY'. See our docs: https://langfuse.com/docs/sdk/python/low-level-sdk#initialize-client"
272	            )
273	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/client.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
291	            if host
292	            else os.environ.get("LANGFUSE_HOST", "https://cloud.langfuse.com")
293	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/llama_index/llama_index.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
390	
391	        parsed_end_payload = self._parse_LLM_end_event_payload(end_event)
392	        parsed_metadata = self._parse_metadata_from_event(end_event)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/llama_index/llama_index.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
420	    ) -> None:
421	        parsed_end_payload = self._parse_LLM_end_event_payload(end_event)
422	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/llama_index/llama_index.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
449	        result["output"] = self._parse_output_from_event(end_event)
450	        result["model"], result["usage"] = self._parse_usage_from_event_payload(
451	            end_event.payload
452	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/media.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
97	            with open(file_path, "rb") as file:
98	                return file.read()
99	        except Exception as e:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/media.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
114	
115	        return base64.b64encode(sha256_hash_bytes).decode("utf-8")
116	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/media.py:115
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
114	
115	        return base64.b64encode(sha256_hash_bytes).decode("utf-8")
116	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/media.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
201	
202	            return base64.b64decode(actual_data), cast(MediaContentType, content_type)
203	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/media.py:202
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
201	
202	            return base64.b64decode(actual_data), cast(MediaContentType, content_type)
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/media.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
279	                        ).data
280	                        media_content = requests.get(
281	                            media_data.url, timeout=content_fetch_timeout_seconds
282	                        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/media.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
285	
286	                        base64_media_content = base64.b64encode(
287	                            media_content.content
288	                        ).decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/media.py:286
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
285	
286	                        base64_media_content = base64.b64encode(
287	                            media_content.content
288	                        ).decode()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/parse_error.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	
19	SUPPORT_URL = "https://langfuse.com/support"
20	API_DOCS_URL = "https://api.reference.langfuse.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/parse_error.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	SUPPORT_URL = "https://langfuse.com/support"
20	API_DOCS_URL = "https://api.reference.langfuse.com"
21	RBAC_DOCS_URL = "https://langfuse.com/docs/rbac"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/parse_error.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	API_DOCS_URL = "https://api.reference.langfuse.com"
21	RBAC_DOCS_URL = "https://langfuse.com/docs/rbac"
22	INSTALLATION_DOCS_URL = "https://langfuse.com/docs/sdk/typescript/guide"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/parse_error.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	RBAC_DOCS_URL = "https://langfuse.com/docs/rbac"
22	INSTALLATION_DOCS_URL = "https://langfuse.com/docs/sdk/typescript/guide"
23	RATE_LIMITS_URL = "https://langfuse.com/faq/all/api-limits"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/parse_error.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	INSTALLATION_DOCS_URL = "https://langfuse.com/docs/sdk/typescript/guide"
23	RATE_LIMITS_URL = "https://langfuse.com/faq/all/api-limits"
24	PYPI_PACKAGE_URL = "https://pypi.org/project/langfuse/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/parse_error.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	RATE_LIMITS_URL = "https://langfuse.com/faq/all/api-limits"
24	PYPI_PACKAGE_URL = "https://pypi.org/project/langfuse/"
25	
26	# Error messages
27	updatePromptResponse = (

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/request.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
39	            "Authorization": "Basic "
40	            + b64encode(
41	                f"{self._public_key}:{self._secret_key}".encode("utf-8")
42	            ).decode("ascii"),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/request.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
39	            "Authorization": "Basic "
40	            + b64encode(
41	                f"{self._public_key}:{self._secret_key}".encode("utf-8")
42	            ).decode("ascii"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/langfuse-2.60.2/langfuse-2.60.2/langfuse/utils/base_callback_handler.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	        prio_host = host or os.environ.get(
59	            "LANGFUSE_HOST", "https://cloud.langfuse.com"
60	        )
61	

--------------------------------------------------

Code scanned:
	Total lines of code: 25581
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 5.0
Files skipped (0):
