Run started:2025-04-12 12:11:46.617516

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_main.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	            logger.debug(
452	                '"%s" is not supported when using Juju for storage\n'
453	                'see: https://github.com/canonical/operator/issues/348',
454	                dispatcher.event_name,
455	            )
456	            # Note that we don't exit nonzero, because that would cause Juju to rerun the hook

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
325	        warnings.warn(
326	            'Harness is deprecated. For the recommended approach, see: '
327	            'https://ops.readthedocs.io/en/latest/howto/write-unit-tests-for-a-charm.html',
328	            PendingDeprecationWarning,
329	            stacklevel=2,
330	        )
331	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
585	                self._charm_dir = charm_dir
586	                charmcraft_metadata = yaml.safe_load(charmcraft_meta.read_text())
587	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
591	                charm_metadata_yaml = dedent(charm_metadata_yaml)
592	            charm_metadata = yaml.safe_load(charm_metadata_yaml)
593	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
604	                if metadata_path.is_file():
605	                    charm_metadata = yaml.safe_load(metadata_path.read_text())
606	                    self._charm_dir = charm_dir

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
616	                action_metadata_yaml = dedent(action_metadata_yaml)
617	            action_metadata = yaml.safe_load(action_metadata_yaml)
618	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
626	                if actions_path.is_file():
627	                    action_metadata = yaml.safe_load(actions_path.read_text())
628	                    self._charm_dir = charm_dir

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
634	                config_metadata_yaml = dedent(config_metadata_yaml)
635	            config_metadata = yaml.safe_load(config_metadata_yaml)
636	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
644	                if config_path.is_file():
645	                    config_metadata = yaml.safe_load(config_path.read_text())
646	                    self._charm_dir = charm_dir

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
667	                charm_config_yaml = dedent(charm_config_yaml)
668	            config = yaml.safe_load(charm_config_yaml)
669	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
673	                if charmcraft_meta.is_file():
674	                    charmcraft_metadata: Dict[str, Any] = yaml.safe_load(
675	                        charmcraft_meta.read_text()
676	                    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
682	                    if config_path.is_file():
683	                        config = yaml.safe_load(config_path.read_text())
684	                        self._charm_dir = charm_dir

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1004	            if not self._backend._networks.get((relation_name, relation_id)):
1005	                self.add_network('10.0.0.10', endpoint=relation_name, relation_id=relation_id)
1006	            # If we don't already have a default network binding for this endpoint, create one.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:1008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1007	            if not self._backend._networks.get((relation_name, None)):
1008	                self.add_network('192.0.2.0', endpoint=relation_name)
1009	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:2290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2289	            raise RuntimeError(
2290	                f'Unknown config option {key}; '
2291	                'not declared in `config.yaml`.'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:2539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2538	            raise model.ModelError(
2539	                'ERROR could not download resource: HTTP request failed: '
2540	                'Get https://.../units/unit-{}/resources/{}: resource#{}/{} not found'.format(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:2551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2550	            with resource_filename.open(mode=mode) as resource_file:
2551	                resource_file.write(contents)
2552	        return resource_filename

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:2551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2550	            with resource_filename.open(mode=mode) as resource_file:
2551	                resource_file.write(contents)
2552	        return resource_filename

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3112	            raise pebble.TimeoutError(f'timed out waiting for change ({self._timeout} seconds)')
3113	        out_value = self.stdout.read() if self.stdout is not None else None
3114	        err_value = self.stderr.read() if self.stderr is not None else None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3113	        out_value = self.stdout.read() if self.stdout is not None else None
3114	        err_value = self.stderr.read() if self.stderr is not None else None
3115	        if self._exit_code != 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3616	                # If source is binary, open file in binary mode and ignore encoding param
3617	                is_binary = isinstance(source.read(0), bytes)  # type: ignore
3618	                open_mode = 'wb' if is_binary else 'w'

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
3621	                    shutil.copyfileobj(cast(IOBase, source), cast(IOBase, f))
3622	            os.chmod(file_path, permissions)
3623	        except FileNotFoundError as e:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3622
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
3621	                    shutil.copyfileobj(cast(IOBase, source), cast(IOBase, f))
3622	            os.chmod(file_path, permissions)
3623	        except FileNotFoundError as e:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
3691	            dir_path.mkdir()
3692	            os.chmod(dir_path, permissions)
3693	        except FileExistsError:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3692
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
3691	            dir_path.mkdir()
3692	            os.chmod(dir_path, permissions)
3693	        except FileExistsError:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
3711	            if recursive:
3712	                shutil.rmtree(file_path)
3713	            else:

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
3714	                try:
3715	                    file_path.rmdir()
3716	                except OSError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/_private/harness.py:3786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3785	        if hasattr(stdin, 'read'):
3786	            stdin = stdin.read()  # type: ignore
3787	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/framework.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
568	# the message to show to the user when a pdb breakpoint goes active
569	_BREAKPOINT_WELCOME_MESSAGE = """
570	Starting pdb to debug charm operator.
571	Run `h` for help, `c` to continue, or `exit`/CTRL-d to abort.
572	Future breakpoints may interrupt execution again.
573	More details at https://juju.is/docs/sdk/debugging
574	
575	"""
576	
577	_event_regex = r'^(|.*/)on/[a-zA-Z_]+\[\d+\]$'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:1965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1964	    def __getitem__(self, key: str) -> str:
1965	        self._validate_read()
1966	        return super().__getitem__(key)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:1986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1985	        }
1986	        self._validate_write(changes)  # always check permissions
1987	        if not changes:  # return early if there are no changes required

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:1986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1985	        }
1986	        self._validate_write(changes)  # always check permissions
1987	        if not changes:  # return early if there are no changes required

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:1999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1998	        try:
1999	            self._validate_read()
2000	        except RelationDataAccessError:

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:2862
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
2861	        try:
2862	            pw_name = pwd.getpwuid(info.st_uid).pw_name
2863	        except KeyError:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:3573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
3572	        finally:
3573	            shutil.rmtree(str(tmpdir))
3574	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:3849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3848	                with open(f'{tmp}/{k}', mode='w', encoding='utf-8') as f:
3849	                    f.write(v)
3850	                args.append(f'{k}#file={tmp}/{k}')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:3849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3848	                with open(f'{tmp}/{k}', mode='w', encoding='utf-8') as f:
3849	                    f.write(v)
3850	                args.append(f'{k}#file={tmp}/{k}')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:3878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3877	                with open(f'{tmp}/{k}', mode='w', encoding='utf-8') as f:
3878	                    f.write(v)
3879	                args.append(f'{k}#file={tmp}/{k}')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/model.py:3878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3877	                with open(f'{tmp}/{k}', mode='w', encoding='utf-8') as f:
3878	                    f.write(v)
3879	                args.append(f'{k}#file={tmp}/{k}')

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:374
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
373	            raise NotImplementedError(f'Unix sockets not supported on {sys.platform}')
374	        self.sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
375	        self.sock.connect(self.socket_path)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
374	        self.sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
375	        self.sock.connect(self.socket_path)
376	        if self.timeout is not _not_provided:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
376	        if self.timeout is not _not_provided:
377	            self.sock.settimeout(self.timeout)
378	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
406	    """Helper to simplify starting a thread."""
407	    thread = threading.Thread(target=target, args=args, kwargs=kwargs)
408	    thread.start()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
814	        if isinstance(raw, str):  # noqa: SIM108
815	            d = yaml.safe_load(raw) or {}  # type: ignore
816	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
904	        if isinstance(raw, str):  # noqa: SIM108
905	            d = yaml.safe_load(raw) or {}  # type: ignore # (Any 'raw' type)
906	        else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1764	        if self._cancel_reader is not None:
1765	            os.close(self._cancel_reader)
1766	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1805	
1806	        t = _start_thread(shutil.copyfileobj, self.stdout, out)
1807	        self._threads.append(t)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1809	        if self.stderr is not None:
1810	            t = _start_thread(shutil.copyfileobj, self.stderr, err)
1811	            self._threads.append(t)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1835	        msg = json.dumps(payload, sort_keys=True)
1836	        self._control_ws.send(msg)
1837	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1864	
1865	        chunk = reader.read(bufsize)
1866	        if not chunk:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1871	
1872	    ws.send('{"command":"end"}')  # Send "end" command as TEXT frame to signal EOF
1873	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1877	    while True:
1878	        chunk = ws.recv()
1879	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1896	            chunk = typing.cast(bytes, chunk).decode(encoding)
1897	        writer.write(chunk)
1898	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1896	            chunk = typing.cast(bytes, chunk).decode(encoding)
1897	        writer.write(chunk)
1898	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1919
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1918	        """Send end-of-file message to websocket."""
1919	        self.ws.send('{"command":"end"}')
1920	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1941
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1940	        while not self.remaining:
1941	            chunk = self.ws.recv()
1942	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1969
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1968	        """An alias for read."""
1969	        return self.read(n)
1970	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:1999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1998	        opener: Optional[urllib.request.OpenerDirector] = None,
1999	        base_url: str = 'http://localhost',
2000	        timeout: float = 5.0,
2001	    ):
2002	        if not isinstance(socket_path, str):
2003	            raise TypeError(f'`socket_path` should be a string, not: {type(socket_path)}')
2004	        if opener is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2043	        self._ensure_content_type(response.headers, 'application/json')
2044	        raw_resp: Dict[str, Any] = json.loads(response.read())
2045	        return raw_resp

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2086
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2085	            try:
2086	                body: Dict[str, Any] = json.loads(e.read())
2087	                message: str = body['result']['message']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2104	        """Get system info."""
2105	        resp = self._request('GET', '/v1/system-info')
2106	        return SystemInfo.from_dict(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2110	        query = {'select': select.value}
2111	        resp = self._request('GET', '/v1/warnings', query)
2112	        return [Warning.from_dict(w) for w in resp['result']]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2116	        body = {'action': 'okay', 'timestamp': timestamp.isoformat()}
2117	        resp = self._request('POST', '/v1/warnings', body=body)
2118	        return resp['result']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2128	            query['for'] = service
2129	        resp = self._request('GET', '/v1/changes', query)
2130	        return [Change.from_dict(c) for c in resp['result']]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2133	        """Get single change by ID."""
2134	        resp = self._request('GET', f'/v1/changes/{change_id}')
2135	        return Change.from_dict(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2139	        body = {'action': 'abort'}
2140	        resp = self._request('POST', f'/v1/changes/{change_id}', body=body)
2141	        return Change.from_dict(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2272	        body = {'action': action, 'services': services}
2273	        resp = self._request('POST', '/v1/services', body=body)
2274	        change_id = ChangeID(resp['change'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2342	        try:
2343	            resp = self._request('GET', f'/v1/changes/{change_id}/wait', query)
2344	        except APIError as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2381	        body = {'action': action, 'checks': checks}
2382	        resp = self._request('POST', '/v1/checks', body=body)
2383	        return resp['result']['changed']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2413	        }
2414	        self._request('POST', '/v1/layers', body=body)
2415	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2417	        """Get the Pebble plan (contains combined layer configuration)."""
2418	        resp = self._request('GET', '/v1/plan', {'format': 'yaml'})
2419	        return Plan(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2429	            query = {'names': ','.join(names)}
2430	        resp = self._request('GET', '/v1/services', query)
2431	        return [ServiceInfo.from_dict(info) for info in resp['result']]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2470	        while True:
2471	            chunk = response.read(self._chunk_size)
2472	            if not chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2558	        self._ensure_content_type(response.headers, 'application/json')
2559	        resp = json.loads(response.read())
2560	        # we need to cast the Dict[Any, Any] to _FilesResponse

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2618	
2619	            content: Union[str, bytes] = source_io.read(self._chunk_size)
2620	            while content:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2623	                yield content
2624	                content = source_io.read(self._chunk_size)
2625	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2662	            query['itself'] = 'true'
2663	        resp = self._request('GET', '/v1/files', query)
2664	        result: List[_FileInfoDict] = resp['result'] or []  # in case it's null instead of []

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2703	        }
2704	        resp = self._request('POST', '/v1/files', None, body)
2705	        self._raise_on_path_error(typing.cast('_FilesResponse', resp), path)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2727	        }
2728	        resp = self._request('POST', '/v1/files', None, body)
2729	        self._raise_on_path_error(typing.cast('_FilesResponse', resp), path)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2946	        }
2947	        resp = self._request('POST', '/v1/exec', body=body)
2948	        change_id = resp['change']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2976	                def _cancel_stdin():
2977	                    os.write(cancel_writer, b'x')  # doesn't matter what we write
2978	                    os.close(cancel_writer)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2976	                def _cancel_stdin():
2977	                    os.write(cancel_writer, b'x')  # doesn't matter what we write
2978	                    os.close(cancel_writer)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2977	                    os.write(cancel_writer, b'x')  # doesn't matter what we write
2978	                    os.close(cancel_writer)
2979	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2981	
2982	            t = _start_thread(_reader_to_websocket, stdin, stdio_ws, encoding, cancel_reader)
2983	            threads.append(t)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:2991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2990	        if stdout is not None:
2991	            t = _start_thread(_websocket_to_writer, stdio_ws, stdout, encoding)
2992	            threads.append(t)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3001	            if stderr is not None:
3002	                t = _start_thread(_websocket_to_writer, stderr_ws, stderr, encoding)
3003	                threads.append(t)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3033
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
3032	    def _connect_websocket(self, task_id: str, websocket_id: str) -> _WebSocket:
3033	        sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
3034	        # Set socket timeout to a short timeout during connection phase, in

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3037
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
3036	        # https://github.com/canonical/operator/issues/1246
3037	        sock.settimeout(self.timeout)
3038	        sock.connect(self.socket_path)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
3037	        sock.settimeout(self.timeout)
3038	        sock.connect(self.socket_path)
3039	        url = self._websocket_url(task_id, websocket_id)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
3040	        ws: _WebSocket = websocket.WebSocket(skip_utf8_validation=True)  # type: ignore
3041	        ws.connect(url, socket=sock)
3042	        # Reset to no timeout so connection can be "long polling" when data is

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
3043	        # being received.
3044	        sock.settimeout(None)
3045	        return ws

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3077	        }
3078	        self._request('POST', '/v1/signals', body=body)
3079	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3098	            query['names'] = list(names)
3099	        resp = self._request('GET', '/v1/checks', query)
3100	        return [CheckInfo.from_dict(info) for info in resp['result']]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3158	            body['repeat-after'] = _format_timeout(repeat_after.total_seconds())
3159	        resp = self._request('POST', '/v1/notices', body=body)
3160	        return resp['result']['id']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3167	        """
3168	        resp = self._request('GET', f'/v1/notices/{id}')
3169	        return Notice.from_dict(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3210	            query['keys'] = list(keys)
3211	        resp = self._request('GET', '/v1/notices', query)
3212	        return [Notice.from_dict(info) for info in resp['result']]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3244	        parser.feed(data)
3245	        self._headers = parser.close()
3246	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3274	                outfile = self._get_open_tempfile()
3275	                outfile.write(data)
3276	                outfile.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3274	                outfile = self._get_open_tempfile()
3275	                outfile.write(data)
3276	                outfile.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3275	                outfile.write(data)
3276	                outfile.close()
3277	                self._headers = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3280	                outfile = self._get_open_tempfile()
3281	                outfile.write(data)
3282	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/pebble.py:3281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3280	                outfile = self._get_open_tempfile()
3281	                outfile.write(data)
3282	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/storage.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
75	            try:
76	                os.chmod(filename, mode)
77	            except OSError as e:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/ops/storage.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
75	            try:
76	                os.chmod(filename, mode)
77	            except OSError as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_main.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	            logger.debug(
452	                '"%s" is not supported when using Juju for storage\n'
453	                'see: https://github.com/canonical/operator/issues/348',
454	                dispatcher.event_name,
455	            )
456	            # Note that we don't exit nonzero, because that would cause Juju to rerun the hook

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
325	        warnings.warn(
326	            'Harness is deprecated. For the recommended approach, see: '
327	            'https://ops.readthedocs.io/en/latest/howto/write-unit-tests-for-a-charm.html',
328	            PendingDeprecationWarning,
329	            stacklevel=2,
330	        )
331	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
585	                self._charm_dir = charm_dir
586	                charmcraft_metadata = yaml.safe_load(charmcraft_meta.read_text())
587	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
591	                charm_metadata_yaml = dedent(charm_metadata_yaml)
592	            charm_metadata = yaml.safe_load(charm_metadata_yaml)
593	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
604	                if metadata_path.is_file():
605	                    charm_metadata = yaml.safe_load(metadata_path.read_text())
606	                    self._charm_dir = charm_dir

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
616	                action_metadata_yaml = dedent(action_metadata_yaml)
617	            action_metadata = yaml.safe_load(action_metadata_yaml)
618	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
626	                if actions_path.is_file():
627	                    action_metadata = yaml.safe_load(actions_path.read_text())
628	                    self._charm_dir = charm_dir

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
634	                config_metadata_yaml = dedent(config_metadata_yaml)
635	            config_metadata = yaml.safe_load(config_metadata_yaml)
636	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
644	                if config_path.is_file():
645	                    config_metadata = yaml.safe_load(config_path.read_text())
646	                    self._charm_dir = charm_dir

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
667	                charm_config_yaml = dedent(charm_config_yaml)
668	            config = yaml.safe_load(charm_config_yaml)
669	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
673	                if charmcraft_meta.is_file():
674	                    charmcraft_metadata: Dict[str, Any] = yaml.safe_load(
675	                        charmcraft_meta.read_text()
676	                    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
682	                    if config_path.is_file():
683	                        config = yaml.safe_load(config_path.read_text())
684	                        self._charm_dir = charm_dir

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1004	            if not self._backend._networks.get((relation_name, relation_id)):
1005	                self.add_network('10.0.0.10', endpoint=relation_name, relation_id=relation_id)
1006	            # If we don't already have a default network binding for this endpoint, create one.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:1008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1007	            if not self._backend._networks.get((relation_name, None)):
1008	                self.add_network('192.0.2.0', endpoint=relation_name)
1009	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:2290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2289	            raise RuntimeError(
2290	                f'Unknown config option {key}; '
2291	                'not declared in `config.yaml`.'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:2539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2538	            raise model.ModelError(
2539	                'ERROR could not download resource: HTTP request failed: '
2540	                'Get https://.../units/unit-{}/resources/{}: resource#{}/{} not found'.format(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:2551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2550	            with resource_filename.open(mode=mode) as resource_file:
2551	                resource_file.write(contents)
2552	        return resource_filename

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:2551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2550	            with resource_filename.open(mode=mode) as resource_file:
2551	                resource_file.write(contents)
2552	        return resource_filename

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3112	            raise pebble.TimeoutError(f'timed out waiting for change ({self._timeout} seconds)')
3113	        out_value = self.stdout.read() if self.stdout is not None else None
3114	        err_value = self.stderr.read() if self.stderr is not None else None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3113	        out_value = self.stdout.read() if self.stdout is not None else None
3114	        err_value = self.stderr.read() if self.stderr is not None else None
3115	        if self._exit_code != 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3616	                # If source is binary, open file in binary mode and ignore encoding param
3617	                is_binary = isinstance(source.read(0), bytes)  # type: ignore
3618	                open_mode = 'wb' if is_binary else 'w'

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
3621	                    shutil.copyfileobj(cast(IOBase, source), cast(IOBase, f))
3622	            os.chmod(file_path, permissions)
3623	        except FileNotFoundError as e:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3622
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
3621	                    shutil.copyfileobj(cast(IOBase, source), cast(IOBase, f))
3622	            os.chmod(file_path, permissions)
3623	        except FileNotFoundError as e:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
3691	            dir_path.mkdir()
3692	            os.chmod(dir_path, permissions)
3693	        except FileExistsError:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3692
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
3691	            dir_path.mkdir()
3692	            os.chmod(dir_path, permissions)
3693	        except FileExistsError:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
3711	            if recursive:
3712	                shutil.rmtree(file_path)
3713	            else:

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
3714	                try:
3715	                    file_path.rmdir()
3716	                except OSError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/_private/harness.py:3786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3785	        if hasattr(stdin, 'read'):
3786	            stdin = stdin.read()  # type: ignore
3787	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/framework.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
568	# the message to show to the user when a pdb breakpoint goes active
569	_BREAKPOINT_WELCOME_MESSAGE = """
570	Starting pdb to debug charm operator.
571	Run `h` for help, `c` to continue, or `exit`/CTRL-d to abort.
572	Future breakpoints may interrupt execution again.
573	More details at https://juju.is/docs/sdk/debugging
574	
575	"""
576	
577	_event_regex = r'^(|.*/)on/[a-zA-Z_]+\[\d+\]$'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:1965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1964	    def __getitem__(self, key: str) -> str:
1965	        self._validate_read()
1966	        return super().__getitem__(key)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:1986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1985	        }
1986	        self._validate_write(changes)  # always check permissions
1987	        if not changes:  # return early if there are no changes required

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:1986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1985	        }
1986	        self._validate_write(changes)  # always check permissions
1987	        if not changes:  # return early if there are no changes required

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:1999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1998	        try:
1999	            self._validate_read()
2000	        except RelationDataAccessError:

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:2862
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
2861	        try:
2862	            pw_name = pwd.getpwuid(info.st_uid).pw_name
2863	        except KeyError:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:3573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
3572	        finally:
3573	            shutil.rmtree(str(tmpdir))
3574	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:3849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3848	                with open(f'{tmp}/{k}', mode='w', encoding='utf-8') as f:
3849	                    f.write(v)
3850	                args.append(f'{k}#file={tmp}/{k}')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:3849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3848	                with open(f'{tmp}/{k}', mode='w', encoding='utf-8') as f:
3849	                    f.write(v)
3850	                args.append(f'{k}#file={tmp}/{k}')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:3878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3877	                with open(f'{tmp}/{k}', mode='w', encoding='utf-8') as f:
3878	                    f.write(v)
3879	                args.append(f'{k}#file={tmp}/{k}')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/model.py:3878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3877	                with open(f'{tmp}/{k}', mode='w', encoding='utf-8') as f:
3878	                    f.write(v)
3879	                args.append(f'{k}#file={tmp}/{k}')

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:374
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
373	            raise NotImplementedError(f'Unix sockets not supported on {sys.platform}')
374	        self.sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
375	        self.sock.connect(self.socket_path)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
374	        self.sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
375	        self.sock.connect(self.socket_path)
376	        if self.timeout is not _not_provided:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
376	        if self.timeout is not _not_provided:
377	            self.sock.settimeout(self.timeout)
378	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
406	    """Helper to simplify starting a thread."""
407	    thread = threading.Thread(target=target, args=args, kwargs=kwargs)
408	    thread.start()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
814	        if isinstance(raw, str):  # noqa: SIM108
815	            d = yaml.safe_load(raw) or {}  # type: ignore
816	        else:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
904	        if isinstance(raw, str):  # noqa: SIM108
905	            d = yaml.safe_load(raw) or {}  # type: ignore # (Any 'raw' type)
906	        else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1764	        if self._cancel_reader is not None:
1765	            os.close(self._cancel_reader)
1766	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1805	
1806	        t = _start_thread(shutil.copyfileobj, self.stdout, out)
1807	        self._threads.append(t)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1809	        if self.stderr is not None:
1810	            t = _start_thread(shutil.copyfileobj, self.stderr, err)
1811	            self._threads.append(t)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1835	        msg = json.dumps(payload, sort_keys=True)
1836	        self._control_ws.send(msg)
1837	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1864	
1865	        chunk = reader.read(bufsize)
1866	        if not chunk:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1871	
1872	    ws.send('{"command":"end"}')  # Send "end" command as TEXT frame to signal EOF
1873	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1877	    while True:
1878	        chunk = ws.recv()
1879	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1896	            chunk = typing.cast(bytes, chunk).decode(encoding)
1897	        writer.write(chunk)
1898	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1896	            chunk = typing.cast(bytes, chunk).decode(encoding)
1897	        writer.write(chunk)
1898	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1919
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1918	        """Send end-of-file message to websocket."""
1919	        self.ws.send('{"command":"end"}')
1920	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1941
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1940	        while not self.remaining:
1941	            chunk = self.ws.recv()
1942	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1969
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1968	        """An alias for read."""
1969	        return self.read(n)
1970	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:1999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1998	        opener: Optional[urllib.request.OpenerDirector] = None,
1999	        base_url: str = 'http://localhost',
2000	        timeout: float = 5.0,
2001	    ):
2002	        if not isinstance(socket_path, str):
2003	            raise TypeError(f'`socket_path` should be a string, not: {type(socket_path)}')
2004	        if opener is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2043	        self._ensure_content_type(response.headers, 'application/json')
2044	        raw_resp: Dict[str, Any] = json.loads(response.read())
2045	        return raw_resp

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2086
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2085	            try:
2086	                body: Dict[str, Any] = json.loads(e.read())
2087	                message: str = body['result']['message']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2104	        """Get system info."""
2105	        resp = self._request('GET', '/v1/system-info')
2106	        return SystemInfo.from_dict(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2110	        query = {'select': select.value}
2111	        resp = self._request('GET', '/v1/warnings', query)
2112	        return [Warning.from_dict(w) for w in resp['result']]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2116	        body = {'action': 'okay', 'timestamp': timestamp.isoformat()}
2117	        resp = self._request('POST', '/v1/warnings', body=body)
2118	        return resp['result']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2128	            query['for'] = service
2129	        resp = self._request('GET', '/v1/changes', query)
2130	        return [Change.from_dict(c) for c in resp['result']]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2133	        """Get single change by ID."""
2134	        resp = self._request('GET', f'/v1/changes/{change_id}')
2135	        return Change.from_dict(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2139	        body = {'action': 'abort'}
2140	        resp = self._request('POST', f'/v1/changes/{change_id}', body=body)
2141	        return Change.from_dict(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2272	        body = {'action': action, 'services': services}
2273	        resp = self._request('POST', '/v1/services', body=body)
2274	        change_id = ChangeID(resp['change'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2342	        try:
2343	            resp = self._request('GET', f'/v1/changes/{change_id}/wait', query)
2344	        except APIError as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2381	        body = {'action': action, 'checks': checks}
2382	        resp = self._request('POST', '/v1/checks', body=body)
2383	        return resp['result']['changed']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2413	        }
2414	        self._request('POST', '/v1/layers', body=body)
2415	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2417	        """Get the Pebble plan (contains combined layer configuration)."""
2418	        resp = self._request('GET', '/v1/plan', {'format': 'yaml'})
2419	        return Plan(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2429	            query = {'names': ','.join(names)}
2430	        resp = self._request('GET', '/v1/services', query)
2431	        return [ServiceInfo.from_dict(info) for info in resp['result']]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2470	        while True:
2471	            chunk = response.read(self._chunk_size)
2472	            if not chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2558	        self._ensure_content_type(response.headers, 'application/json')
2559	        resp = json.loads(response.read())
2560	        # we need to cast the Dict[Any, Any] to _FilesResponse

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2618	
2619	            content: Union[str, bytes] = source_io.read(self._chunk_size)
2620	            while content:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2623	                yield content
2624	                content = source_io.read(self._chunk_size)
2625	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2662	            query['itself'] = 'true'
2663	        resp = self._request('GET', '/v1/files', query)
2664	        result: List[_FileInfoDict] = resp['result'] or []  # in case it's null instead of []

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2703	        }
2704	        resp = self._request('POST', '/v1/files', None, body)
2705	        self._raise_on_path_error(typing.cast('_FilesResponse', resp), path)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2727	        }
2728	        resp = self._request('POST', '/v1/files', None, body)
2729	        self._raise_on_path_error(typing.cast('_FilesResponse', resp), path)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2946	        }
2947	        resp = self._request('POST', '/v1/exec', body=body)
2948	        change_id = resp['change']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2976	                def _cancel_stdin():
2977	                    os.write(cancel_writer, b'x')  # doesn't matter what we write
2978	                    os.close(cancel_writer)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2976	                def _cancel_stdin():
2977	                    os.write(cancel_writer, b'x')  # doesn't matter what we write
2978	                    os.close(cancel_writer)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2977	                    os.write(cancel_writer, b'x')  # doesn't matter what we write
2978	                    os.close(cancel_writer)
2979	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2981	
2982	            t = _start_thread(_reader_to_websocket, stdin, stdio_ws, encoding, cancel_reader)
2983	            threads.append(t)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:2991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2990	        if stdout is not None:
2991	            t = _start_thread(_websocket_to_writer, stdio_ws, stdout, encoding)
2992	            threads.append(t)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3001	            if stderr is not None:
3002	                t = _start_thread(_websocket_to_writer, stderr_ws, stderr, encoding)
3003	                threads.append(t)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3033
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
3032	    def _connect_websocket(self, task_id: str, websocket_id: str) -> _WebSocket:
3033	        sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
3034	        # Set socket timeout to a short timeout during connection phase, in

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3037
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
3036	        # https://github.com/canonical/operator/issues/1246
3037	        sock.settimeout(self.timeout)
3038	        sock.connect(self.socket_path)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
3037	        sock.settimeout(self.timeout)
3038	        sock.connect(self.socket_path)
3039	        url = self._websocket_url(task_id, websocket_id)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
3040	        ws: _WebSocket = websocket.WebSocket(skip_utf8_validation=True)  # type: ignore
3041	        ws.connect(url, socket=sock)
3042	        # Reset to no timeout so connection can be "long polling" when data is

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
3043	        # being received.
3044	        sock.settimeout(None)
3045	        return ws

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3077	        }
3078	        self._request('POST', '/v1/signals', body=body)
3079	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3098	            query['names'] = list(names)
3099	        resp = self._request('GET', '/v1/checks', query)
3100	        return [CheckInfo.from_dict(info) for info in resp['result']]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3158	            body['repeat-after'] = _format_timeout(repeat_after.total_seconds())
3159	        resp = self._request('POST', '/v1/notices', body=body)
3160	        return resp['result']['id']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3167	        """
3168	        resp = self._request('GET', f'/v1/notices/{id}')
3169	        return Notice.from_dict(resp['result'])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3210	            query['keys'] = list(keys)
3211	        resp = self._request('GET', '/v1/notices', query)
3212	        return [Notice.from_dict(info) for info in resp['result']]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3244	        parser.feed(data)
3245	        self._headers = parser.close()
3246	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3274	                outfile = self._get_open_tempfile()
3275	                outfile.write(data)
3276	                outfile.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3274	                outfile = self._get_open_tempfile()
3275	                outfile.write(data)
3276	                outfile.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3275	                outfile.write(data)
3276	                outfile.close()
3277	                self._headers = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3280	                outfile = self._get_open_tempfile()
3281	                outfile.write(data)
3282	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/pebble.py:3281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3280	                outfile = self._get_open_tempfile()
3281	                outfile.write(data)
3282	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/storage.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
75	            try:
76	                os.chmod(filename, mode)
77	            except OSError as e:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/charms/test_main/lib/ops/storage.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
75	            try:
76	                os.chmod(filename, mode)
77	            except OSError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/fake_pebble.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        d_json = json.dumps(d, indent=4, sort_keys=True)
69	        self.wfile.write(d_json.encode('utf-8'))
70	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/fake_pebble.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
68	        d_json = json.dumps(d, indent=4, sort_keys=True)
69	        self.wfile.write(d_json.encode('utf-8'))
70	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/fake_pebble.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
111	    def do_GET(self):  # noqa: N802 ("should be lowercase")
112	        self.do_request('GET')
113	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/fake_pebble.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
114	    def do_POST(self):  # noqa: N802 ("should be lowercase")
115	        self.do_request('POST')
116	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/fake_pebble.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
153	            return {}
154	        body = self.rfile.read(content_len)
155	        if isinstance(body, bytes):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/fake_pebble.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
176	                if service not in self._services:
177	                    self.bad_request(f'service "{service}" does not exist')
178	                    return

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/fake_pebble.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
186	        else:
187	            self.bad_request(f'action "{action}" not implemented')
188	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/fake_pebble.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	    server = socketserver.UnixStreamServer(socket_path, Handler)
195	    thread = threading.Thread(target=server.serve_forever)
196	    thread.start()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/fake_pebble.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
199	        server.shutdown()
200	        server.server_close()
201	        thread.join()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/pebble_cli.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
180	                with open(args.layer_path, encoding='utf-8') as f:
181	                    layer_yaml = f.read()
182	            except OSError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/pebble_cli.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
215	                else:
216	                    stdin = sys.stdin.buffer.read() if encoding is None else sys.stdin.read()
217	                stdout = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/pebble_cli.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
215	                else:
216	                    stdin = sys.stdin.buffer.read() if encoding is None else sys.stdin.read()
217	                stdout = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/pebble_cli.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
260	        elif args.command == 'pull':
261	            content = client.pull(args.remote_path, encoding=None).read()
262	            if args.local_path != '-':

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/pebble_cli.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	                with open(args.local_path, 'wb') as f:
264	                    f.write(content)
265	                result = f'wrote remote file {args.remote_path} to {args.local_path}'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/pebble_cli.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
266	            else:
267	                sys.stdout.buffer.write(content)
268	                return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/smoke/test_smoke.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
103	    with open('./test/charms/test_smoke/charmcraft.yaml', 'w') as outf:
104	        outf.write(charmcraft_yaml)
105	    charm = pack(pathlib.Path('./test/charms/test_smoke/'))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
262	
263	    fake_script.write(
264	        'storage-get',
265	        """
266	        if [ "$1" = "-s" ]; then

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
294	    )
295	    fake_script.write(
296	        'storage-list',
297	        """
298	        echo '["disks/0"]'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
597	def _setup_test_action(fake_script: FakeScript):
598	    fake_script.write('action-get', """echo '{"foo-name": "name", "silent": true}'""")
599	    fake_script.write('action-set', '')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
598	    fake_script.write('action-get', """echo '{"foo-name": "name", "silent": true}'""")
599	    fake_script.write('action-set', '')
600	    fake_script.write('action-log', '')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
599	    fake_script.write('action-set', '')
600	    fake_script.write('action-log', '')
601	    fake_script.write('action-fail', '')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
600	    fake_script.write('action-log', '')
601	    fake_script.write('action-fail', '')
602	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
723	    cmd_type = 'action'
724	    fake_script.write(f'{cmd_type}-get', """echo '{"foo-name": "name", "silent": true}'""")
725	    monkeypatch.setenv(f'JUJU_{cmd_type.upper()}_NAME', 'start')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
896	    charm = MyCharm(framework)
897	    fake_script.write('secret-remove', 'exit 0')
898	    secret_id = 'secret:remove'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
919	
920	    fake_script.write('secret-get', """echo '{"key": "value"}'""")
921	    fake_script.write('secret-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
920	    fake_script.write('secret-get', """echo '{"key": "value"}'""")
921	    fake_script.write('secret-set', 'exit 0')
922	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
945	
946	    fake_script.write('is-leader', 'echo true')
947	    fake_script.write('status-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
946	    fake_script.write('is-leader', 'echo true')
947	    fake_script.write('status-set', 'exit 0')
948	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
967	
968	    fake_script.write('is-leader', 'echo true')
969	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
987	
988	    fake_script.write('is-leader', 'echo false')
989	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1011	    # called only for collecting app statuses
1012	    fake_script.write('is-leader', 'echo false')
1013	    fake_script.write('status-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1012	    fake_script.write('is-leader', 'echo false')
1013	    fake_script.write('status-set', 'exit 0')
1014	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1034	    # called only for collecting app statuses
1035	    fake_script.write('is-leader', 'echo false')
1036	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1059
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1058	
1059	    fake_script.write('is-leader', 'echo true')
1060	    fake_script.write('status-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1060
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1059	    fake_script.write('is-leader', 'echo true')
1060	    fake_script.write('status-set', 'exit 0')
1061	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1082
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1081	
1082	    fake_script.write('is-leader', 'echo true')
1083	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1113	
1114	    fake_script.write('is-leader', 'echo true')
1115	    fake_script.write('status-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1114	    fake_script.write('is-leader', 'echo true')
1115	    fake_script.write('status-set', 'exit 0')
1116	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1147	
1148	    fake_script.write('is-leader', 'echo true')
1149	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1157	    # Each type of link can be a single item.
1158	    meta = ops.CharmMeta.from_yaml("""
1159	name: my-charm

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1164	""")
1165	    assert meta.links.websites == ['https://example.com']
1166	    assert meta.links.sources == ['https://git.example.com']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1165	    assert meta.links.websites == ['https://example.com']
1166	    assert meta.links.sources == ['https://git.example.com']
1167	    assert meta.links.issues == ['https://bugs.example.com']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1166	    assert meta.links.sources == ['https://git.example.com']
1167	    assert meta.links.issues == ['https://bugs.example.com']
1168	    assert meta.links.documentation == 'https://docs.example.com'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1167	    assert meta.links.issues == ['https://bugs.example.com']
1168	    assert meta.links.documentation == 'https://docs.example.com'
1169	    # Other than documentation, they can also all be lists of items.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1169	    # Other than documentation, they can also all be lists of items.
1170	    meta = ops.CharmMeta.from_yaml("""
1171	name: my-charm

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1181	""")
1182	    assert meta.links.websites == ['https://example.com', 'https://example.org']
1183	    assert meta.links.sources == ['https://git.example.com', 'https://bzr.example.com']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1181	""")
1182	    assert meta.links.websites == ['https://example.com', 'https://example.org']
1183	    assert meta.links.sources == ['https://git.example.com', 'https://bzr.example.com']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1182	    assert meta.links.websites == ['https://example.com', 'https://example.org']
1183	    assert meta.links.sources == ['https://git.example.com', 'https://bzr.example.com']
1184	    assert meta.links.issues == ['https://bugs.example.com', 'https://features.example.com']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1182	    assert meta.links.websites == ['https://example.com', 'https://example.org']
1183	    assert meta.links.sources == ['https://git.example.com', 'https://bzr.example.com']
1184	    assert meta.links.issues == ['https://bugs.example.com', 'https://features.example.com']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1183	    assert meta.links.sources == ['https://git.example.com', 'https://bzr.example.com']
1184	    assert meta.links.issues == ['https://bugs.example.com', 'https://features.example.com']
1185	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1183	    assert meta.links.sources == ['https://git.example.com', 'https://bzr.example.com']
1184	    assert meta.links.issues == ['https://bugs.example.com', 'https://features.example.com']
1185	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1187	def test_meta_links_charmcraft_yaml():
1188	    meta = ops.CharmMeta.from_yaml("""
1189	links:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1198	""")
1199	    assert meta.links.websites == ['https://example.com/']
1200	    assert meta.links.sources == ['https://git.example.com/issues/']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1199	    assert meta.links.websites == ['https://example.com/']
1200	    assert meta.links.sources == ['https://git.example.com/issues/']
1201	    assert meta.links.issues == ['https://git.example.com/']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1200	    assert meta.links.sources == ['https://git.example.com/issues/']
1201	    assert meta.links.issues == ['https://git.example.com/']
1202	    assert meta.links.documentation == 'https://discourse.example.com/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_charm.py:1202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1201	    assert meta.links.issues == ['https://git.example.com/']
1202	    assert meta.links.documentation == 'https://discourse.example.com/'
1203	    assert meta.maintainers == ['Support Team <help@example.com>']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_framework.py:2164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2163	        framework.observe(publisher.foobar_action, observer.callback_method)
2164	        fake_script.write('action-get', 'echo {}')
2165	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_framework.py:2188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2187	        framework.observe(publisher.foobar_action, observer.callback_method)
2188	        fake_script.write('action-get', 'echo {}')
2189	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
37	        def cleanup():
38	            shutil.rmtree(fake_script_path)
39	            os.environ['PATH'] = old_path

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	        # ASCII 1E is RS 'record separator', and 1C is FS 'file separator', which seem appropriate.
54	        f.write(  # type: ignore
55	            """#!/bin/sh
56	{{ printf {name}; printf "\\036%s" "$@"; printf "\\034"; }} >> {path}/calls.txt
57	{content}""".format_map(template_args)
58	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
53	        # ASCII 1E is RS 'record separator', and 1C is FS 'file separator', which seem appropriate.
54	        f.write(  # type: ignore
55	            """#!/bin/sh
56	{{ printf {name}; printf "\\036%s" "$@"; printf "\\034"; }} >> {path}/calls.txt
57	{content}""".format_map(template_args)
58	        )

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
58	        )
59	    os.chmod(str(path), 0o755)  # type: ignore  # noqa: S103
60	    # TODO: this hardcodes the path to bash.exe, which works for now but might

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
58	        )
59	    os.chmod(str(path), 0o755)  # type: ignore  # noqa: S103
60	    # TODO: this hardcodes the path to bash.exe, which works for now but might

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	    with calls_file.open('r+t', newline='\n', encoding='utf8') as f:  # type: ignore
77	        calls = [line.split('\x1e') for line in f.read().split('\x1c')[:-1]]  # type: ignore
78	        if clear:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
120	        os.environ.update(env_backup)
121	        shutil.rmtree(tmpdir)
122	        ops.CharmBase.on = ops.CharmEvents()  # type: ignore

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
142	            def cleanup():
143	                shutil.rmtree(self.path)
144	                os.environ['PATH'] = old_path

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	            # RS 'record separator' (octal 036 in ASCII), FS 'file separator' (octal 034 in ASCII).
161	            f.write(
162	                """#!/bin/sh
163	{{ printf {name}; printf "\\036%s" "$@"; printf "\\034"; }} >> {path}/calls.txt
164	
165	# Capture key and data from key#file=/some/path arguments
166	for word in "$@"; do
167	  echo "$word" | grep -q "#file=" || continue
168	  key=$(echo "$word" | cut -d'#' -f1)
169	  path=$(echo "$word" | cut -d'=' -f2)
170	  cp "$path" "{path}/$key.secret"
171	done
172	
173	{content}""".format_map(template_args)
174	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
160	            # RS 'record separator' (octal 036 in ASCII), FS 'file separator' (octal 034 in ASCII).
161	            f.write(
162	                """#!/bin/sh
163	{{ printf {name}; printf "\\036%s" "$@"; printf "\\034"; }} >> {path}/calls.txt
164	
165	# Capture key and data from key#file=/some/path arguments
166	for word in "$@"; do
167	  echo "$word" | grep -q "#file=" || continue
168	  key=$(echo "$word" | cut -d'#' -f1)
169	  path=$(echo "$word" | cut -d'=' -f2)
170	  cp "$path" "{path}/$key.secret"
171	done
172	
173	{content}""".format_map(template_args)
174	            )

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
174	            )
175	        path.chmod(0o755)
176	        # TODO: this hardcodes the path to bash.exe, which works for now but might

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_helpers.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
189	        with calls_file.open('r+t', newline='\n', encoding='utf8') as f:
190	            calls = [line.split('\036') for line in f.read().split('\034')[:-1]]
191	            if clear:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_infra.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	    with open(testfile, 'w', encoding='utf8') as fh:
41	        fh.write(template.format(module_name=mod_name))
42	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
169	        ('2.0.0', '1.0.0', False),
170	        ('2.0.0.0', '2.0.0', True),
171	        ('2.0.0.0', '2.0.0.0', True),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
170	        ('2.0.0.0', '2.0.0', True),
171	        ('2.0.0.0', '2.0.0.0', True),
172	        ('2.0.0.1', '2.0.0.0', False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
170	        ('2.0.0.0', '2.0.0', True),
171	        ('2.0.0.0', '2.0.0.0', True),
172	        ('2.0.0.1', '2.0.0.0', False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
171	        ('2.0.0.0', '2.0.0.0', True),
172	        ('2.0.0.1', '2.0.0.0', False),
173	        ('2.0.1.10', '2.0.0.0', False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
171	        ('2.0.0.0', '2.0.0.0', True),
172	        ('2.0.0.1', '2.0.0.0', False),
173	        ('2.0.1.10', '2.0.0.0', False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
172	        ('2.0.0.1', '2.0.0.0', False),
173	        ('2.0.1.10', '2.0.0.0', False),
174	    ],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
172	        ('2.0.0.1', '2.0.0.0', False),
173	        ('2.0.1.10', '2.0.0.0', False),
174	    ],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
200	        ('2.0.0', '1.0.0', False, False),
201	        ('2.0.0.0', '2.0.0', False, True),
202	        ('2.0.0.0', '2.0.0.0', False, True),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
201	        ('2.0.0.0', '2.0.0', False, True),
202	        ('2.0.0.0', '2.0.0.0', False, True),
203	        ('2.0.0.1', '2.0.0.0', False, False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
201	        ('2.0.0.0', '2.0.0', False, True),
202	        ('2.0.0.0', '2.0.0.0', False, True),
203	        ('2.0.0.1', '2.0.0.0', False, False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
202	        ('2.0.0.0', '2.0.0.0', False, True),
203	        ('2.0.0.1', '2.0.0.0', False, False),
204	        ('2.0.1.10', '2.0.0.0', False, False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
202	        ('2.0.0.0', '2.0.0.0', False, True),
203	        ('2.0.0.1', '2.0.0.0', False, False),
204	        ('2.0.1.10', '2.0.0.0', False, False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
203	        ('2.0.0.1', '2.0.0.0', False, False),
204	        ('2.0.1.10', '2.0.0.0', False, False),
205	        ('2.10.0', '2.8.0', False, False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_jujuversion.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
203	        ('2.0.0.1', '2.0.0.0', False, False),
204	        ('2.0.1.10', '2.0.0.0', False, False),
205	        ('2.10.0', '2.8.0', False, False),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_lib.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
369	        with open(m.origin, 'w', encoding='latin-1') as f:
370	            f.write(
371	                dedent("""
372	            LIBNAME = "foo"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	                with fake_metadata.open('wb') as fh:
149	                    fh.write(b'name: test')
150	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
148	                with fake_metadata.open('wb') as fh:
149	                    fh.write(b'name: test')
150	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
224	            with fake_metadata.open('wb') as fh:
225	                fh.write(b'name: test')
226	            if with_dispatch:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
224	            with fake_metadata.open('wb') as fh:
225	                fh.write(b'name: test')
226	            if with_dispatch:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
228	                dispatch.write_text('', encoding='utf8')
229	                dispatch.chmod(0o755)
230	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
308	
309	        fake_script.write('is-leader', 'echo true')
310	        fake_script.write('juju-log', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
308	
309	        fake_script.write('is-leader', 'echo true')
310	        fake_script.write('juju-log', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
309	        fake_script.write('is-leader', 'echo true')
310	        fake_script.write('juju-log', 'exit 0')
311	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
309	        fake_script.write('is-leader', 'echo true')
310	        fake_script.write('juju-log', 'exit 0')
311	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
319	        def cleanup():
320	            shutil.rmtree(self._tmpdir, ignore_errors=True)
321	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
497	    def test_no_reemission_on_collect_metrics(self, fake_script: FakeScript):
498	        fake_script.write('add-metric', 'exit 0')
499	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
497	    def test_no_reemission_on_collect_metrics(self, fake_script: FakeScript):
498	        fake_script.write('add-metric', 'exit 0')
499	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
522	
523	        fake_script.write('action-get', "echo '{}'")
524	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
522	
523	        fake_script.write('action-get', "echo '{}'")
524	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
805	    def test_collect_metrics(self, fake_script: FakeScript):
806	        fake_script.write('add-metric', 'exit 0')
807	        self._simulate_event(fake_script, EventSpec(ops.InstallEvent, 'install'))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
805	    def test_collect_metrics(self, fake_script: FakeScript):
806	        fake_script.write('add-metric', 'exit 0')
807	        self._simulate_event(fake_script, EventSpec(ops.InstallEvent, 'install'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
849	    def test_logger(self, fake_script: FakeScript):
850	        fake_script.write('action-get', "echo '{}'")
851	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
849	    def test_logger(self, fake_script: FakeScript):
850	        fake_script.write('action-get', "echo '{}'")
851	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:949
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
948	
949	        fake_script.write('action-get', "echo '{}'")
950	        state = self._simulate_event(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:949
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
948	
949	        fake_script.write('action-get', "echo '{}'")
950	        state = self._simulate_event(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
966	
967	        fake_script.write('action-get', "echo '{}'")
968	        fake_script.write('status-get', """echo '{"status": "unknown", "message": ""}'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
966	
967	        fake_script.write('action-get', "echo '{}'")
968	        fake_script.write('status-get', """echo '{"status": "unknown", "message": ""}'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
967	        fake_script.write('action-get', "echo '{}'")
968	        fake_script.write('status-get', """echo '{"status": "unknown", "message": ""}'""")
969	        state = self._simulate_event(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
967	        fake_script.write('action-get', "echo '{}'")
968	        fake_script.write('status-get', """echo '{"status": "unknown", "message": ""}'""")
969	        state = self._simulate_event(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
980	        assert state.status_message == ''
981	        fake_script.write(
982	            'status-get', """echo '{"status": "blocked", "message": "help meeee"}'"""
983	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
980	        assert state.status_message == ''
981	        fake_script.write(
982	            'status-get', """echo '{"status": "blocked", "message": "help meeee"}'"""
983	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1015	        # interpreter for the child process to support virtual environments.
1016	        fake_script.write(
1017	            'storage-get',
1018	            """
1019	            if [ "$1" = "-s" ]; then

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1015	        # interpreter for the child process to support virtual environments.
1016	        fake_script.write(
1017	            'storage-get',
1018	            """
1019	            if [ "$1" = "-s" ]; then

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1049
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1048	
1049	        fake_script.write(
1050	            'storage-list',
1051	            """
1052	            echo '["disks/0"]'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1049
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1048	
1049	        fake_script.write(
1050	            'storage-list',
1051	            """
1052	            echo '["disks/0"]'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1187	        fake_script_hooks = FakeScript(request, self.hooks_dir)
1188	        fake_script_hooks.write('install', 'exit 0')
1189	        state = self._simulate_event(fake_script, EventSpec(ops.InstallEvent, 'install'))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1187	        fake_script_hooks = FakeScript(request, self.hooks_dir)
1188	        fake_script_hooks.write('install', 'exit 0')
1189	        state = self._simulate_event(fake_script, EventSpec(ops.InstallEvent, 'install'))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1255	        fake_script_hooks = FakeScript(request, self.hooks_dir)
1256	        fake_script_hooks.write('install', 'exit 42')
1257	        event = EventSpec(ops.InstallEvent, 'install')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1255	        fake_script_hooks = FakeScript(request, self.hooks_dir)
1256	        fake_script_hooks.write('install', 'exit 42')
1257	        event = EventSpec(ops.InstallEvent, 'install')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1261	        self.stdout.seek(0)
1262	        assert self.stdout.read() == b''
1263	        self.stderr.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1263	        self.stderr.seek(0)
1264	        assert self.stderr.read() == b''
1265	        calls = fake_script.calls()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1353	        dispatch = self.JUJU_CHARM_DIR / 'dispatch'
1354	        fake_script.write(
1355	            'storage-get',
1356	            """
1357	            if [ "$1" = "-s" ]; then

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1353	        dispatch = self.JUJU_CHARM_DIR / 'dispatch'
1354	        fake_script.write(
1355	            'storage-get',
1356	            """
1357	            if [ "$1" = "-s" ]; then

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1385	        )
1386	        fake_script.write(
1387	            'storage-list',
1388	            """
1389	            echo '["disks/0"]'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1385	        )
1386	        fake_script.write(
1387	            'storage-list',
1388	            """
1389	            echo '["disks/0"]'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1405	        request.addfinalizer(self.stderr.close)
1406	        fake_script.write('action-get', "echo '{}'")
1407	        with pytest.raises(subprocess.CalledProcessError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1405	        request.addfinalizer(self.stderr.close)
1406	        fake_script.write('action-get', "echo '{}'")
1407	        with pytest.raises(subprocess.CalledProcessError):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1417	        self.stderr.seek(0)
1418	        stderr = self.stderr.read()
1419	        assert 'KeyError' in stderr

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1435	            )
1436	            path.chmod(0o755)
1437	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1445	        env['JUJU_VERSION'] = '2.8.0'
1446	        fake_script.write(
1447	            'storage-get',
1448	            """
1449	            if [ "$1" = "-s" ]; then

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1445	        env['JUJU_VERSION'] = '2.8.0'
1446	        fake_script.write(
1447	            'storage-get',
1448	            """
1449	            if [ "$1" = "-s" ]; then

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1477	        )
1478	        fake_script.write(
1479	            'storage-list',
1480	            """
1481	            echo '["disks/0"]'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_main.py:1478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1477	        )
1478	        fake_script.write(
1479	            'storage-list',
1480	            """
1481	            echo '["disks/0"]'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1054
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1053	
1054	        fake_script.write(
1055	            'storage-list',
1056	            """
1057	            if [ "$1" = disks ]; then

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1054
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1053	
1054	        fake_script.write(
1055	            'storage-list',
1056	            """
1057	            if [ "$1" = disks ]; then

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1063	        )
1064	        fake_script.write(
1065	            'storage-get',
1066	            """
1067	            if [ "$2" = disks/0 ]; then

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1063	        )
1064	        fake_script.write(
1065	            'storage-get',
1066	            """
1067	            if [ "$2" = disks/0 ]; then

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1075	        )
1076	        fake_script.write('storage-add', '')
1077	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1075	        )
1076	        fake_script.write('storage-add', '')
1077	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1134	        model = ops.Model(ops.CharmMeta(), _ModelBackend('myapp/0'))
1135	        fake_script.write('status-get', """echo 'ERROR cannot get status' >&2; exit 1""")
1136	        with pytest.raises(ops.ModelError) as excinfo:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1134	        model = ops.Model(ops.CharmMeta(), _ModelBackend('myapp/0'))
1135	        fake_script.write('status-get', """echo 'ERROR cannot get status' >&2; exit 1""")
1136	        with pytest.raises(ops.ModelError) as excinfo:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1175	    def test_relation_remote_model(self, fake_script: FakeScript):
1176	        fake_script.write('relation-list', """echo '["remoteapp1/0"]'""")
1177	        fake_script.write('relation-ids', """echo '["db0:1"]'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1175	    def test_relation_remote_model(self, fake_script: FakeScript):
1176	        fake_script.write('relation-list', """echo '["remoteapp1/0"]'""")
1177	        fake_script.write('relation-ids', """echo '["db0:1"]'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1176	        fake_script.write('relation-list', """echo '["remoteapp1/0"]'""")
1177	        fake_script.write('relation-ids', """echo '["db0:1"]'""")
1178	        fake_script.write('relation-model-get', """echo '{"uuid": "UUID"}'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1176	        fake_script.write('relation-list', """echo '["remoteapp1/0"]'""")
1177	        fake_script.write('relation-ids', """echo '["db0:1"]'""")
1178	        fake_script.write('relation-model-get', """echo '{"uuid": "UUID"}'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1177	        fake_script.write('relation-ids', """echo '["db0:1"]'""")
1178	        fake_script.write('relation-model-get', """echo '{"uuid": "UUID"}'""")
1179	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1177	        fake_script.write('relation-ids', """echo '["db0:1"]'""")
1178	        fake_script.write('relation-model-get', """echo '{"uuid": "UUID"}'""")
1179	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1425	        with open(fpath, 'wb') as f:
1426	            f.write(b'push \xc3\x28')  # invalid UTF-8 to ensure binary works
1427	    if case.dirs:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1425	        with open(fpath, 'wb') as f:
1426	            f.write(b'push \xc3\x28')  # invalid UTF-8 to ensure binary works
1427	    if case.dirs:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1457	        assert c.exists(fpath), f'push_path failed: file {fpath} missing at destination'
1458	        content = c.pull(fpath, encoding=None).read()
1459	        assert content == b'push \xc3\x28'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:1548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1547	            for want_path in case.want:
1548	                content = container.pull(want_path).read()
1549	                assert content == 'test'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2431	
2432	        fake_script.write('relation-ids', """([ "$1" = db0 ] && echo '["db0:4"]') || echo '[]'""")
2433	        fake_script.write('relation-list', """[ "$2" = 4 ] && echo '["remoteapp1/0"]' || exit 2""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2431	
2432	        fake_script.write('relation-ids', """([ "$1" = db0 ] && echo '["db0:4"]') || echo '[]'""")
2433	        fake_script.write('relation-list', """[ "$2" = 4 ] && echo '["remoteapp1/0"]' || exit 2""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2432	        fake_script.write('relation-ids', """([ "$1" = db0 ] && echo '["db0:4"]') || echo '[]'""")
2433	        fake_script.write('relation-list', """[ "$2" = 4 ] && echo '["remoteapp1/0"]' || exit 2""")
2434	        self.network_get_out = """{

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2432	        fake_script.write('relation-ids', """([ "$1" = db0 ] && echo '["db0:4"]') || echo '[]'""")
2433	        fake_script.write('relation-list', """[ "$2" = 4 ] && echo '["remoteapp1/0"]' || exit 2""")
2434	        self.network_get_out = """{

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2505	        assert binding.name == binding_name
2506	        assert binding.network.bind_address == ipaddress.ip_address('192.0.2.2')
2507	        assert binding.network.ingress_address == ipaddress.ip_address('192.0.2.2')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2506	        assert binding.network.bind_address == ipaddress.ip_address('192.0.2.2')
2507	        assert binding.network.ingress_address == ipaddress.ip_address('192.0.2.2')
2508	        # /32 and /128 CIDRs are valid one-address networks for IPv{4,6}Network types respectively.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2516	        for i, (name, address, subnet) in enumerate([
2517	            ('lo', '192.0.2.2', '192.0.2.0/24'),
2518	            ('lo', 'dead:beef::1', 'dead:beef::/64'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2518	            ('lo', 'dead:beef::1', 'dead:beef::/64'),
2519	            ('tun', '192.0.3.3', '192.0.3.3/32'),
2520	            ('tun', '2001:db8::3', '2001:db8::3/128'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2527	        for i, (name, address, subnet) in enumerate([
2528	            ('lo', '192.0.2.2', '192.0.2.0/24'),
2529	            ('lo', 'dead:beef::1', 'dead:beef::/64'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2529	            ('lo', 'dead:beef::1', 'dead:beef::/64'),
2530	            ('tun', '192.0.3.3', '192.0.3.3/32'),
2531	            ('tun', '2001:db8::3', '2001:db8::3/128'),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2544	    def test_dead_relations(self, fake_script: FakeScript, model: ops.Model):
2545	        fake_script.write(
2546	            'network-get',
2547	            f"""
2548	                if [ "$1" = db0 ] && [ "$2" = --format=json ]; then
2549	                    echo '{self.network_get_out}'
2550	                else

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2544	    def test_dead_relations(self, fake_script: FakeScript, model: ops.Model):
2545	        fake_script.write(
2546	            'network-get',
2547	            f"""
2548	                if [ "$1" = db0 ] && [ "$2" = --format=json ]; then
2549	                    echo '{self.network_get_out}'
2550	                else

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2557	        binding = ops.Binding('db0', 42, model._backend)
2558	        assert binding.network.bind_address == ipaddress.ip_address('192.0.2.2')
2559	        assert fake_script.calls(clear=True) == [

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2578	        model = ops.Model(meta, backend, broken_relation_id=8)
2579	        fake_script.write(
2580	            'relation-ids',
2581	            """if [ "$1" = "db0" ]; then
2582	                         echo '["db0:4"]'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2578	        model = ops.Model(meta, backend, broken_relation_id=8)
2579	        fake_script.write(
2580	            'relation-ids',
2581	            """if [ "$1" = "db0" ]; then
2582	                         echo '["db0:4"]'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2591	        )
2592	        fake_script.write('relation-list', """echo '""'""")
2593	        assert model.relations['db0']

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2591	        )
2592	        fake_script.write('relation-list', """echo '""'""")
2593	        assert model.relations['db0']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2597	    def test_binding_by_relation_name(self, fake_script: FakeScript, model: ops.Model):
2598	        fake_script.write(
2599	            'network-get', f"""[ "$1" = db0 ] && echo '{self.network_get_out}' || exit 1"""
2600	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2597	    def test_binding_by_relation_name(self, fake_script: FakeScript, model: ops.Model):
2598	        fake_script.write(
2599	            'network-get', f"""[ "$1" = db0 ] && echo '{self.network_get_out}' || exit 1"""
2600	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2608	    def test_binding_by_relation(self, fake_script: FakeScript, model: ops.Model):
2609	        fake_script.write(
2610	            'network-get', f"""[ "$1" = db0 ] && echo '{self.network_get_out}' || exit 1"""
2611	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2608	    def test_binding_by_relation(self, fake_script: FakeScript, model: ops.Model):
2609	        fake_script.write(
2610	            'network-get', f"""[ "$1" = db0 ] && echo '{self.network_get_out}' || exit 1"""
2611	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2628	                    'interface-name': '',
2629	                    'addresses': [{'hostname': '', 'value': '10.1.89.35', 'cidr': ''}],
2630	                }

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2632	            'egress-subnets': ['10.152.183.158/32'],
2633	            'ingress-addresses': ['10.152.183.158'],
2634	        }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2635	        network_get_out = json.dumps(network_get_out_obj)
2636	        fake_script.write(
2637	            'network-get', f"""[ "$1" = db0 ] && echo '{network_get_out}' || exit 1"""
2638	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2635	        network_get_out = json.dumps(network_get_out_obj)
2636	        fake_script.write(
2637	            'network-get', f"""[ "$1" = db0 ] && echo '{network_get_out}' || exit 1"""
2638	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2643	        assert binding.name == 'db0'
2644	        assert binding.network.bind_address == ipaddress.ip_address('10.1.89.35')
2645	        assert binding.network.ingress_address == ipaddress.ip_address('10.152.183.158')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2644	        assert binding.network.bind_address == ipaddress.ip_address('10.1.89.35')
2645	        assert binding.network.ingress_address == ipaddress.ip_address('10.152.183.158')
2646	        assert fake_script.calls(clear=True) == expected_calls

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2649	        network_data = json.dumps({})
2650	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2651	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2649	        network_data = json.dumps({})
2650	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2651	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2656	        network_data = json.dumps({'bind-addresses': [{}]})
2657	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2658	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2656	        network_data = json.dumps({'bind-addresses': [{}]})
2657	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2658	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2663	        network_data = json.dumps({'bind-addresses': [{'addresses': None}]})
2664	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2665	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2663	        network_data = json.dumps({'bind-addresses': [{'addresses': None}]})
2664	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2665	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2678
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2677	        })
2678	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2679	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2678
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2677	        })
2678	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2679	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2689	        })
2690	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2691	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2689	        })
2690	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2691	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2700	        })
2701	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2702	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2700	        })
2701	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2702	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2711	        })
2712	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2713	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2711	        })
2712	        fake_script.write('network-get', f"""[ "$1" = db0 ] && echo '{network_data}' || exit 1""")
2713	        binding_name = 'db0'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2757	        model = ops.Model(meta, self.backend)
2758	        fake_script.write('is-leader', 'echo false')
2759	        assert not model.unit.is_leader()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2757	        model = ops.Model(meta, self.backend)
2758	        fake_script.write('is-leader', 'echo false')
2759	        assert not model.unit.is_leader()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2761	        # Change the leadership status
2762	        fake_script.write('is-leader', 'echo true')
2763	        # If you don't force it, we don't check, so we won't see the change

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2761	        # Change the leadership status
2762	        fake_script.write('is-leader', 'echo true')
2763	        # If you don't force it, we don't check, so we won't see the change

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2769	        # Force a recheck without changing the leadership status.
2770	        fake_script.write('is-leader', 'echo true')
2771	        self.backend._leader_check_time = None

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2769	        # Force a recheck without changing the leadership status.
2770	        fake_script.write('is-leader', 'echo true')
2771	        self.backend._leader_check_time = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2781	            (
2782	                lambda: fake_script.write('relation-list', 'echo fooerror >&2 ; exit 1'),
2783	                lambda: self.backend.relation_list(3),

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2781	            (
2782	                lambda: fake_script.write('relation-list', 'echo fooerror >&2 ; exit 1'),
2783	                lambda: self.backend.relation_list(3),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2787	            (
2788	                lambda: fake_script.write('relation-list', f'echo {err_msg} >&2 ; exit 2'),
2789	                lambda: self.backend.relation_list(3),

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2787	            (
2788	                lambda: fake_script.write('relation-list', f'echo {err_msg} >&2 ; exit 2'),
2789	                lambda: self.backend.relation_list(3),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2793	            (
2794	                lambda: fake_script.write('relation-set', 'echo fooerror >&2 ; exit 1'),
2795	                lambda: self.backend.relation_set(3, {'foo': 'bar'}, is_app=False),

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2793	            (
2794	                lambda: fake_script.write('relation-set', 'echo fooerror >&2 ; exit 1'),
2795	                lambda: self.backend.relation_set(3, {'foo': 'bar'}, is_app=False),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2799	            (
2800	                lambda: fake_script.write('relation-set', f'echo {err_msg} >&2 ; exit 2'),
2801	                lambda: self.backend.relation_set(3, {'foo': 'bar'}, is_app=False),

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2799	            (
2800	                lambda: fake_script.write('relation-set', f'echo {err_msg} >&2 ; exit 2'),
2801	                lambda: self.backend.relation_set(3, {'foo': 'bar'}, is_app=False),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2811	            (
2812	                lambda: fake_script.write('relation-get', 'echo fooerror >&2 ; exit 1'),
2813	                lambda: self.backend.relation_get(3, 'remote/0', is_app=False),

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2811	            (
2812	                lambda: fake_script.write('relation-get', 'echo fooerror >&2 ; exit 1'),
2813	                lambda: self.backend.relation_get(3, 'remote/0', is_app=False),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2817	            (
2818	                lambda: fake_script.write('relation-get', f'echo {err_msg} >&2 ; exit 2'),
2819	                lambda: self.backend.relation_get(3, 'remote/0', is_app=False),

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2817	            (
2818	                lambda: fake_script.write('relation-get', f'echo {err_msg} >&2 ; exit 2'),
2819	                lambda: self.backend.relation_get(3, 'remote/0', is_app=False),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2843	    ):
2844	        fake_script.write('relation-get', """echo '{"foo": "bar"}' """)
2845	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2843	    ):
2844	        fake_script.write('relation-get', """echo '{"foo": "bar"}' """)
2845	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2872	        try:
2873	            fake_script.write(
2874	                'relation-set',
2875	                dedent("""
2876	                cat >> {}
2877	                """).format(pathlib.Path(t.name).as_posix()),
2878	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2872	        try:
2873	            fake_script.write(
2874	                'relation-set',
2875	                dedent("""
2876	                cat >> {}
2877	                """).format(pathlib.Path(t.name).as_posix()),
2878	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2885	            t.seek(0)
2886	            content = t.read()
2887	        finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2902	        content = '{"message": "", "status": "unknown", "status-data": {}}'
2903	        fake_script.write('status-get', f"echo '{content}'")
2904	        s = self.backend.status_get(is_app=False)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2902	        content = '{"message": "", "status": "unknown", "status-data": {}}'
2903	        fake_script.write('status-get', f"echo '{content}'")
2904	        s = self.backend.status_get(is_app=False)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2923	            """)
2924	        fake_script.write('status-get', f"echo '{content}'")
2925	        s = self.backend.status_get(is_app=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2923	            """)
2924	        fake_script.write('status-get', f"echo '{content}'")
2925	        s = self.backend.status_get(is_app=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2933	    def test_status_is_app_forced_kwargs(self, fake_script: FakeScript):
2934	        fake_script.write('status-get', 'exit 1')
2935	        fake_script.write('status-set', 'exit 1')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2933	    def test_status_is_app_forced_kwargs(self, fake_script: FakeScript):
2934	        fake_script.write('status-get', 'exit 1')
2935	        fake_script.write('status-set', 'exit 1')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2934	        fake_script.write('status-get', 'exit 1')
2935	        fake_script.write('status-set', 'exit 1')
2936	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2934	        fake_script.write('status-get', 'exit 1')
2935	        fake_script.write('status-set', 'exit 1')
2936	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2954
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2953	        model = ops.Model(meta, self.backend)
2954	        fake_script.write('is-leader', 'echo true')
2955	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2954
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2953	        model = ops.Model(meta, self.backend)
2954	        fake_script.write('is-leader', 'echo true')
2955	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2992	        })
2993	        fake_script.write('status-get', f"echo '{content}'")
2994	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:2993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2992	        })
2993	        fake_script.write('status-get', f"echo '{content}'")
2994	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3005	        })
3006	        fake_script.write('status-get', f"echo '{content}'")
3007	        fake_script.write('is-leader', 'echo true')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3005	        })
3006	        fake_script.write('status-get', f"echo '{content}'")
3007	        fake_script.write('is-leader', 'echo true')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3006	        fake_script.write('status-get', f"echo '{content}'")
3007	        fake_script.write('is-leader', 'echo true')
3008	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3006	        fake_script.write('status-get', f"echo '{content}'")
3007	        fake_script.write('is-leader', 'echo true')
3008	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3029	    def test_storage_tool_errors(self, fake_script: FakeScript):
3030	        fake_script.write('storage-list', 'echo fooerror >&2 ; exit 1')
3031	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3029	    def test_storage_tool_errors(self, fake_script: FakeScript):
3030	        fake_script.write('storage-list', 'echo fooerror >&2 ; exit 1')
3031	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3033	        assert fake_script.calls(clear=True) == [['storage-list', 'foobar', '--format=json']]
3034	        fake_script.write('storage-get', 'echo fooerror >&2 ; exit 1')
3035	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3033	        assert fake_script.calls(clear=True) == [['storage-list', 'foobar', '--format=json']]
3034	        fake_script.write('storage-get', 'echo fooerror >&2 ; exit 1')
3035	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3039	        ]
3040	        fake_script.write('storage-add', 'echo fooerror >&2 ; exit 1')
3041	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3039	        ]
3040	        fake_script.write('storage-add', 'echo fooerror >&2 ; exit 1')
3041	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3043	        assert fake_script.calls(clear=True) == [['storage-add', 'foobar=2']]
3044	        fake_script.write('storage-add', 'echo fooerror >&2 ; exit 1')
3045	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3043	        assert fake_script.calls(clear=True) == [['storage-add', 'foobar=2']]
3044	        fake_script.write('storage-add', 'echo fooerror >&2 ; exit 1')
3045	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3047	        assert fake_script.calls(clear=True) == []
3048	        fake_script.write('storage-add', 'echo fooerror >&2 ; exit 1')
3049	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3047	        assert fake_script.calls(clear=True) == []
3048	        fake_script.write('storage-add', 'echo fooerror >&2 ; exit 1')
3049	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3075
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3074	}"""
3075	        fake_script.write(
3076	            'network-get', f"""[ "$1" = deadbeef ] && echo '{network_get_out}' || exit 1"""
3077	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3075
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3074	}"""
3075	        fake_script.write(
3076	            'network-get', f"""[ "$1" = deadbeef ] && echo '{network_get_out}' || exit 1"""
3077	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3093	            (
3094	                lambda: fake_script.write('network-get', f'echo {err_no_endpoint} >&2 ; exit 1'),
3095	                lambda: self.backend.network_get('deadbeef'),

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3093	            (
3094	                lambda: fake_script.write('network-get', f'echo {err_no_endpoint} >&2 ; exit 1'),
3095	                lambda: self.backend.network_get('deadbeef'),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3099	            (
3100	                lambda: fake_script.write('network-get', f'echo {err_no_rel} >&2 ; exit 2'),
3101	                lambda: self.backend.network_get('deadbeef', 3),

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3099	            (
3100	                lambda: fake_script.write('network-get', f'echo {err_no_rel} >&2 ; exit 2'),
3101	                lambda: self.backend.network_get('deadbeef', 3),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3112	    def test_action_get_error(self, fake_script: FakeScript):
3113	        fake_script.write('action-get', '')
3114	        fake_script.write('action-get', 'echo fooerror >&2 ; exit 1')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3112	    def test_action_get_error(self, fake_script: FakeScript):
3113	        fake_script.write('action-get', '')
3114	        fake_script.write('action-get', 'echo fooerror >&2 ; exit 1')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3113	        fake_script.write('action-get', '')
3114	        fake_script.write('action-get', 'echo fooerror >&2 ; exit 1')
3115	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3113	        fake_script.write('action-get', '')
3114	        fake_script.write('action-get', 'echo fooerror >&2 ; exit 1')
3115	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3120	    def test_action_set_error(self, fake_script: FakeScript):
3121	        fake_script.write('action-get', '')
3122	        fake_script.write('action-set', 'echo fooerror >&2 ; exit 1')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3120	    def test_action_set_error(self, fake_script: FakeScript):
3121	        fake_script.write('action-get', '')
3122	        fake_script.write('action-set', 'echo fooerror >&2 ; exit 1')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3121	        fake_script.write('action-get', '')
3122	        fake_script.write('action-set', 'echo fooerror >&2 ; exit 1')
3123	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3121	        fake_script.write('action-get', '')
3122	        fake_script.write('action-set', 'echo fooerror >&2 ; exit 1')
3123	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3129	    def test_action_log_error(self, fake_script: FakeScript):
3130	        fake_script.write('action-get', '')
3131	        fake_script.write('action-log', 'echo fooerror >&2 ; exit 1')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3129	    def test_action_log_error(self, fake_script: FakeScript):
3130	        fake_script.write('action-get', '')
3131	        fake_script.write('action-log', 'echo fooerror >&2 ; exit 1')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3130	        fake_script.write('action-get', '')
3131	        fake_script.write('action-log', 'echo fooerror >&2 ; exit 1')
3132	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3130	        fake_script.write('action-get', '')
3131	        fake_script.write('action-log', 'echo fooerror >&2 ; exit 1')
3132	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3137	    def test_action_get(self, fake_script: FakeScript):
3138	        fake_script.write('action-get', """echo '{"foo-name": "bar", "silent": false}'""")
3139	        params = self.backend.action_get()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3137	    def test_action_get(self, fake_script: FakeScript):
3138	        fake_script.write('action-get', """echo '{"foo-name": "bar", "silent": false}'""")
3139	        params = self.backend.action_get()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3144	    def test_action_set(self, fake_script: FakeScript):
3145	        fake_script.write('action-get', 'exit 1')
3146	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3144	    def test_action_set(self, fake_script: FakeScript):
3145	        fake_script.write('action-get', 'exit 1')
3146	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3145	        fake_script.write('action-get', 'exit 1')
3146	        fake_script.write('action-set', 'exit 0')
3147	        self.backend.action_set({'x': 'dead beef', 'y': 1})

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3145	        fake_script.write('action-get', 'exit 1')
3146	        fake_script.write('action-set', 'exit 0')
3147	        self.backend.action_set({'x': 'dead beef', 'y': 1})

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3160	    def test_action_set_nested(self, fake_script: FakeScript):
3161	        fake_script.write('action-get', 'exit 1')
3162	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3160	    def test_action_set_nested(self, fake_script: FakeScript):
3161	        fake_script.write('action-get', 'exit 1')
3162	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3161	        fake_script.write('action-get', 'exit 1')
3162	        fake_script.write('action-set', 'exit 0')
3163	        self.backend.action_set({'a': {'b': 1, 'c': 2}, 'd': 3})

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3161	        fake_script.write('action-get', 'exit 1')
3162	        fake_script.write('action-set', 'exit 0')
3163	        self.backend.action_set({'a': {'b': 1, 'c': 2}, 'd': 3})

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3166	    def test_action_set_more_nested(self, fake_script: FakeScript):
3167	        fake_script.write('action-get', 'exit 1')
3168	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3166	    def test_action_set_more_nested(self, fake_script: FakeScript):
3167	        fake_script.write('action-get', 'exit 1')
3168	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3167	        fake_script.write('action-get', 'exit 1')
3168	        fake_script.write('action-set', 'exit 0')
3169	        self.backend.action_set({'a': {'b': 1, 'c': 2, 'd': {'e': 3}}, 'f': 4})

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3167	        fake_script.write('action-get', 'exit 1')
3168	        fake_script.write('action-set', 'exit 0')
3169	        self.backend.action_set({'a': {'b': 1, 'c': 2, 'd': {'e': 3}}, 'f': 4})

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3174	    def test_action_set_dotted_dict(self, fake_script: FakeScript):
3175	        fake_script.write('action-get', 'exit 1')
3176	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3174	    def test_action_set_dotted_dict(self, fake_script: FakeScript):
3175	        fake_script.write('action-get', 'exit 1')
3176	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3175	        fake_script.write('action-get', 'exit 1')
3176	        fake_script.write('action-set', 'exit 0')
3177	        self.backend.action_set({'a.b': 1, 'a': {'c': 2}, 'd': 3})

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3175	        fake_script.write('action-get', 'exit 1')
3176	        fake_script.write('action-set', 'exit 0')
3177	        self.backend.action_set({'a.b': 1, 'a': {'c': 2}, 'd': 3})

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3180	    def test_action_set_duplicated_keys(self, fake_script: FakeScript):
3181	        fake_script.write('action-get', 'exit 1')
3182	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3180	    def test_action_set_duplicated_keys(self, fake_script: FakeScript):
3181	        fake_script.write('action-get', 'exit 1')
3182	        fake_script.write('action-set', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3181	        fake_script.write('action-get', 'exit 1')
3182	        fake_script.write('action-set', 'exit 0')
3183	        with pytest.raises(ValueError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3181	        fake_script.write('action-get', 'exit 1')
3182	        fake_script.write('action-set', 'exit 0')
3183	        with pytest.raises(ValueError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3188	    def test_action_fail(self, fake_script: FakeScript):
3189	        fake_script.write('action-get', 'exit 1')
3190	        fake_script.write('action-fail', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3188	    def test_action_fail(self, fake_script: FakeScript):
3189	        fake_script.write('action-get', 'exit 1')
3190	        fake_script.write('action-fail', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3189	        fake_script.write('action-get', 'exit 1')
3190	        fake_script.write('action-fail', 'exit 0')
3191	        self.backend.action_fail('error 42')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3189	        fake_script.write('action-get', 'exit 1')
3190	        fake_script.write('action-fail', 'exit 0')
3191	        self.backend.action_fail('error 42')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3194	    def test_action_log(self, fake_script: FakeScript):
3195	        fake_script.write('action-get', 'exit 1')
3196	        fake_script.write('action-log', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3194	    def test_action_log(self, fake_script: FakeScript):
3195	        fake_script.write('action-get', 'exit 1')
3196	        fake_script.write('action-log', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3195	        fake_script.write('action-get', 'exit 1')
3196	        fake_script.write('action-log', 'exit 0')
3197	        self.backend.action_log('progress: 42%')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3195	        fake_script.write('action-get', 'exit 1')
3196	        fake_script.write('action-log', 'exit 0')
3197	        self.backend.action_log('progress: 42%')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3200	    def test_application_version_set(self, fake_script: FakeScript):
3201	        fake_script.write('application-version-set', 'exit 0')
3202	        self.backend.application_version_set('1.2b3')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3200	    def test_application_version_set(self, fake_script: FakeScript):
3201	        fake_script.write('application-version-set', 'exit 0')
3202	        self.backend.application_version_set('1.2b3')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3205	    def test_application_version_set_invalid(self, fake_script: FakeScript):
3206	        fake_script.write('application-version-set', 'exit 0')
3207	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3205	    def test_application_version_set_invalid(self, fake_script: FakeScript):
3206	        fake_script.write('application-version-set', 'exit 0')
3207	        with pytest.raises(TypeError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3213	    def test_juju_log(self, fake_script: FakeScript):
3214	        fake_script.write('juju-log', 'exit 0')
3215	        self.backend.juju_log('WARNING', 'foo')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3213	    def test_juju_log(self, fake_script: FakeScript):
3214	        fake_script.write('juju-log', 'exit 0')
3215	        self.backend.juju_log('WARNING', 'foo')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3223	
3224	        fake_script.write('juju-log', 'exit 1')
3225	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3223	
3224	        fake_script.write('juju-log', 'exit 1')
3225	        with pytest.raises(ops.ModelError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3229	    def test_valid_metrics(self, fake_script: FakeScript):
3230	        fake_script.write('add-metric', 'exit 0')
3231	        test_cases: typing.List[_ValidMetricsTestCase] = [

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3229	    def test_valid_metrics(self, fake_script: FakeScript):
3230	        fake_script.write('add-metric', 'exit 0')
3231	        test_cases: typing.List[_ValidMetricsTestCase] = [

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3319	        # JUJU_RELATION_ID and JUJU_REMOTE_APP both unset
3320	        fake_script.write(
3321	            'relation-list',
3322	            r"""
3323	echo '"remoteapp2"'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3319	        # JUJU_RELATION_ID and JUJU_REMOTE_APP both unset
3320	        fake_script.write(
3321	            'relation-list',
3322	            r"""
3323	echo '"remoteapp2"'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3344	    def test_relation_remote_app_name_script_errors(self, fake_script: FakeScript):
3345	        fake_script.write(
3346	            'relation-list',
3347	            r"""
3348	echo "ERROR invalid value \"6\" for option -r: relation not found" >&2  # NOQA

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3344	    def test_relation_remote_app_name_script_errors(self, fake_script: FakeScript):
3345	        fake_script.write(
3346	            'relation-list',
3347	            r"""
3348	echo "ERROR invalid value \"6\" for option -r: relation not found" >&2  # NOQA

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3356	
3357	        fake_script.write(
3358	            'relation-list',
3359	            r"""
3360	echo "ERROR option provided but not defined: --app" >&2

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3356	
3357	        fake_script.write(
3358	            'relation-list',
3359	            r"""
3360	echo "ERROR option provided but not defined: --app" >&2

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3370	        # no units
3371	        fake_script.write(
3372	            'goal-state',
3373	            """
3374	echo '{"units":{}, "relations":{}}'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3370	        # no units
3371	        fake_script.write(
3372	            'goal-state',
3373	            """
3374	echo '{"units":{}, "relations":{}}'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3379	        # only active units
3380	        fake_script.write(
3381	            'goal-state',
3382	            """
3383	echo '{

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3379	        # only active units
3380	        fake_script.write(
3381	            'goal-state',
3382	            """
3383	echo '{

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3393	        # active and dying units
3394	        fake_script.write(
3395	            'goal-state',
3396	            """
3397	echo '{

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3393	        # active and dying units
3394	        fake_script.write(
3395	            'goal-state',
3396	            """
3397	echo '{

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3432	    def test_app_add_secret_simple(self, fake_script: FakeScript, model: ops.Model):
3433	        fake_script.write('secret-add', 'echo secret:123')
3434	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3432	    def test_app_add_secret_simple(self, fake_script: FakeScript, model: ops.Model):
3433	        fake_script.write('secret-add', 'echo secret:123')
3434	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3445	    def test_app_add_secret_args(self, fake_script: FakeScript, model: ops.Model):
3446	        fake_script.write('secret-add', 'echo secret:234')
3447	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3445	    def test_app_add_secret_args(self, fake_script: FakeScript, model: ops.Model):
3446	        fake_script.write('secret-add', 'echo secret:234')
3447	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3479	    def test_unit_add_secret_simple(self, fake_script: FakeScript, model: ops.Model):
3480	        fake_script.write('secret-add', 'echo secret:345')
3481	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3479	    def test_unit_add_secret_simple(self, fake_script: FakeScript, model: ops.Model):
3480	        fake_script.write('secret-add', 'echo secret:345')
3481	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3490	    def test_unit_add_secret_args(self, fake_script: FakeScript, model: ops.Model):
3491	        fake_script.write('secret-add', 'echo secret:456')
3492	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3490	    def test_unit_add_secret_args(self, fake_script: FakeScript, model: ops.Model):
3491	        fake_script.write('secret-add', 'echo secret:456')
3492	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3556	    def test_get_secret_id(self, fake_script: FakeScript, model: ops.Model):
3557	        fake_script.write('secret-get', """echo '{"foo": "g"}'""")
3558	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3556	    def test_get_secret_id(self, fake_script: FakeScript, model: ops.Model):
3557	        fake_script.write('secret-get', """echo '{"foo": "g"}'""")
3558	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3568	    def test_get_secret_label(self, fake_script: FakeScript, model: ops.Model):
3569	        fake_script.write('secret-get', """echo '{"foo": "g"}'""")
3570	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3568	    def test_get_secret_label(self, fake_script: FakeScript, model: ops.Model):
3569	        fake_script.write('secret-get', """echo '{"foo": "g"}'""")
3570	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3578	    def test_get_secret_id_and_label(self, fake_script: FakeScript, model: ops.Model):
3579	        fake_script.write('secret-get', """echo '{"foo": "h"}'""")
3580	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3578	    def test_get_secret_id_and_label(self, fake_script: FakeScript, model: ops.Model):
3579	        fake_script.write('secret-get', """echo '{"foo": "h"}'""")
3580	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3601	        script = """echo 'ERROR secret "123" not found' >&2; exit 1"""
3602	        fake_script.write('secret-get', script)
3603	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3601	        script = """echo 'ERROR secret "123" not found' >&2; exit 1"""
3602	        fake_script.write('secret-get', script)
3603	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3608	        script = """echo 'ERROR other error' >&2; exit 1"""
3609	        fake_script.write('secret-get', script)
3610	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3608	        script = """echo 'ERROR other error' >&2; exit 1"""
3609	        fake_script.write('secret-get', script)
3610	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3615	    def test_secret_unique_identifier(self, fake_script: FakeScript, model: ops.Model):
3616	        fake_script.write('secret-get', """echo '{"foo": "g"}'""")
3617	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3615	    def test_secret_unique_identifier(self, fake_script: FakeScript, model: ops.Model):
3616	        fake_script.write('secret-get', """echo '{"foo": "g"}'""")
3617	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3742	    def test_get_content_cached(self, model: ops.Model, fake_script: FakeScript):
3743	        fake_script.write('secret-get', """exit 1""")
3744	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3742	    def test_get_content_cached(self, model: ops.Model, fake_script: FakeScript):
3743	        fake_script.write('secret-get', """exit 1""")
3744	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3751	    def test_get_content_refresh(self, model: ops.Model, fake_script: FakeScript):
3752	        fake_script.write('secret-get', """echo '{"foo": "refreshed"}'""")
3753	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3751	    def test_get_content_refresh(self, model: ops.Model, fake_script: FakeScript):
3752	        fake_script.write('secret-get', """echo '{"foo": "refreshed"}'""")
3753	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3762	    def test_get_content_uncached(self, model: ops.Model, fake_script: FakeScript):
3763	        fake_script.write('secret-get', """echo '{"foo": "notcached"}'""")
3764	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3762	    def test_get_content_uncached(self, model: ops.Model, fake_script: FakeScript):
3763	        fake_script.write('secret-get', """echo '{"foo": "notcached"}'""")
3764	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3773	    def test_get_content_copies_dict(self, model: ops.Model, fake_script: FakeScript):
3774	        fake_script.write('secret-get', """echo '{"foo": "bar"}'""")
3775	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3773	    def test_get_content_copies_dict(self, model: ops.Model, fake_script: FakeScript):
3774	        fake_script.write('secret-get', """echo '{"foo": "bar"}'""")
3775	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3786	    def test_peek_content(self, model: ops.Model, fake_script: FakeScript):
3787	        fake_script.write('secret-get', """echo '{"foo": "peeked"}'""")
3788	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3786	    def test_peek_content(self, model: ops.Model, fake_script: FakeScript):
3787	        fake_script.write('secret-get', """echo '{"foo": "peeked"}'""")
3788	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3804	    def test_get_info(self, model: ops.Model, fake_script: FakeScript):
3805	        fake_script.write('secret-info-get', """echo '{"x": {"label": "y", "revision": 7}}'""")
3806	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3804	    def test_get_info(self, model: ops.Model, fake_script: FakeScript):
3805	        fake_script.write('secret-info-get', """echo '{"x": {"label": "y", "revision": 7}}'""")
3806	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3834	    def test_set_content(self, model: ops.Model, fake_script: FakeScript):
3835	        fake_script.write('secret-set', """exit 0""")
3836	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3834	    def test_set_content(self, model: ops.Model, fake_script: FakeScript):
3835	        fake_script.write('secret-set', """exit 0""")
3836	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3835	        fake_script.write('secret-set', """exit 0""")
3836	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
3837	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3835	        fake_script.write('secret-set', """exit 0""")
3836	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
3837	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3857	    def test_set_info(self, model: ops.Model, fake_script: FakeScript):
3858	        fake_script.write('secret-set', """exit 0""")
3859	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3857	    def test_set_info(self, model: ops.Model, fake_script: FakeScript):
3858	        fake_script.write('secret-set', """exit 0""")
3859	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3858	        fake_script.write('secret-set', """exit 0""")
3859	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
3860	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3858	        fake_script.write('secret-set', """exit 0""")
3859	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
3860	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3896	    def test_set_content_then_info(self, model: ops.Model, fake_script: FakeScript):
3897	        fake_script.write('secret-set', """exit 0""")
3898	        fake_script.write('secret-get', """echo '{"foo": "bar"}'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3896	    def test_set_content_then_info(self, model: ops.Model, fake_script: FakeScript):
3897	        fake_script.write('secret-set', """exit 0""")
3898	        fake_script.write('secret-get', """echo '{"foo": "bar"}'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3898
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3897	        fake_script.write('secret-set', """exit 0""")
3898	        fake_script.write('secret-get', """echo '{"foo": "bar"}'""")
3899	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3898
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3897	        fake_script.write('secret-set', """exit 0""")
3898	        fake_script.write('secret-get', """echo '{"foo": "bar"}'""")
3899	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3922	    def test_set_info_then_content(self, model: ops.Model, fake_script: FakeScript):
3923	        fake_script.write('secret-set', """exit 0""")
3924	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3922	    def test_set_info_then_content(self, model: ops.Model, fake_script: FakeScript):
3923	        fake_script.write('secret-set', """exit 0""")
3924	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3945	    def test_set_content_aggregates(self, model: ops.Model, fake_script: FakeScript):
3946	        fake_script.write('secret-set', """exit 0""")
3947	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3945	    def test_set_content_aggregates(self, model: ops.Model, fake_script: FakeScript):
3946	        fake_script.write('secret-set', """exit 0""")
3947	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3958
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3957	    def test_grant(self, model: ops.Model, fake_script: FakeScript):
3958	        fake_script.write('relation-list', """echo '[]'""")
3959	        fake_script.write('secret-grant', """exit 0""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3958
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3957	    def test_grant(self, model: ops.Model, fake_script: FakeScript):
3958	        fake_script.write('relation-list', """echo '[]'""")
3959	        fake_script.write('secret-grant', """exit 0""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3959
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3958	        fake_script.write('relation-list', """echo '[]'""")
3959	        fake_script.write('secret-grant', """exit 0""")
3960	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3959
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3958	        fake_script.write('relation-list', """echo '[]'""")
3959	        fake_script.write('secret-grant', """exit 0""")
3960	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3959	        fake_script.write('secret-grant', """exit 0""")
3960	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
3961	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3959	        fake_script.write('secret-grant', """exit 0""")
3960	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
3961	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3997	    def test_revoke(self, model: ops.Model, fake_script: FakeScript):
3998	        fake_script.write('relation-list', """echo '[]'""")
3999	        fake_script.write('secret-revoke', """exit 0""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3997	    def test_revoke(self, model: ops.Model, fake_script: FakeScript):
3998	        fake_script.write('relation-list', """echo '[]'""")
3999	        fake_script.write('secret-revoke', """exit 0""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3998	        fake_script.write('relation-list', """echo '[]'""")
3999	        fake_script.write('secret-revoke', """exit 0""")
4000	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:3999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3998	        fake_script.write('relation-list', """echo '[]'""")
3999	        fake_script.write('secret-revoke', """exit 0""")
4000	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3999	        fake_script.write('secret-revoke', """exit 0""")
4000	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
4001	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3999	        fake_script.write('secret-revoke', """exit 0""")
4000	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
4001	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4034	    def test_remove_revision(self, model: ops.Model, fake_script: FakeScript):
4035	        fake_script.write('secret-remove', """exit 0""")
4036	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4034	    def test_remove_revision(self, model: ops.Model, fake_script: FakeScript):
4035	        fake_script.write('secret-remove', """exit 0""")
4036	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4036
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4035	        fake_script.write('secret-remove', """exit 0""")
4036	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
4037	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4036
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4035	        fake_script.write('secret-remove', """exit 0""")
4036	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
4037	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4054
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4053	    def test_remove_all_revisions(self, model: ops.Model, fake_script: FakeScript):
4054	        fake_script.write('secret-remove', """exit 0""")
4055	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4054
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4053	    def test_remove_all_revisions(self, model: ops.Model, fake_script: FakeScript):
4054	        fake_script.write('secret-remove', """exit 0""")
4055	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4055
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4054	        fake_script.write('secret-remove', """exit 0""")
4055	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
4056	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4055
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4054	        fake_script.write('secret-remove', """exit 0""")
4055	        fake_script.write('secret-info-get', """echo '{"z": {"label": "y", "revision": 7}}'""")
4056	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4079	    def test_open_port(self, fake_script: FakeScript, unit: ops.Unit):
4080	        fake_script.write('open-port', 'exit 0')
4081	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4079	    def test_open_port(self, fake_script: FakeScript, unit: ops.Unit):
4080	        fake_script.write('open-port', 'exit 0')
4081	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4092	    def test_open_port_error(self, fake_script: FakeScript, unit: ops.Unit):
4093	        fake_script.write('open-port', "echo 'ERROR bad protocol' >&2; exit 1")
4094	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4092	    def test_open_port_error(self, fake_script: FakeScript, unit: ops.Unit):
4093	        fake_script.write('open-port', "echo 'ERROR bad protocol' >&2; exit 1")
4094	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4103	    def test_close_port(self, fake_script: FakeScript, unit: ops.Unit):
4104	        fake_script.write('close-port', 'exit 0')
4105	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4103	    def test_close_port(self, fake_script: FakeScript, unit: ops.Unit):
4104	        fake_script.write('close-port', 'exit 0')
4105	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4116	    def test_close_port_error(self, fake_script: FakeScript, unit: ops.Unit):
4117	        fake_script.write('close-port', "echo 'ERROR bad protocol' >&2; exit 1")
4118	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4116	    def test_close_port_error(self, fake_script: FakeScript, unit: ops.Unit):
4117	        fake_script.write('close-port', "echo 'ERROR bad protocol' >&2; exit 1")
4118	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4127	    def test_opened_ports(self, fake_script: FakeScript, unit: ops.Unit):
4128	        fake_script.write('opened-ports', """echo 8080/tcp; echo icmp""")
4129	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4127	    def test_opened_ports(self, fake_script: FakeScript, unit: ops.Unit):
4128	        fake_script.write('opened-ports', """echo 8080/tcp; echo icmp""")
4129	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4147	    ):
4148	        fake_script.write('opened-ports', """echo 8080/tcp; echo 1234/ftp; echo 1000-2000/udp""")
4149	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4147	    ):
4148	        fake_script.write('opened-ports', """echo 8080/tcp; echo 1234/ftp; echo 1000-2000/udp""")
4149	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4170	    def test_set_ports_all_open(self, fake_script: FakeScript, unit: ops.Unit):
4171	        fake_script.write('open-port', 'exit 0')
4172	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4170	    def test_set_ports_all_open(self, fake_script: FakeScript, unit: ops.Unit):
4171	        fake_script.write('open-port', 'exit 0')
4172	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4171	        fake_script.write('open-port', 'exit 0')
4172	        fake_script.write('close-port', 'exit 0')
4173	        fake_script.write('opened-ports', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4171	        fake_script.write('open-port', 'exit 0')
4172	        fake_script.write('close-port', 'exit 0')
4173	        fake_script.write('opened-ports', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4172	        fake_script.write('close-port', 'exit 0')
4173	        fake_script.write('opened-ports', 'exit 0')
4174	        unit.set_ports(8000, 8025)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4172	        fake_script.write('close-port', 'exit 0')
4173	        fake_script.write('opened-ports', 'exit 0')
4174	        unit.set_ports(8000, 8025)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4184	        # Two open ports, leave one alone and open another one.
4185	        fake_script.write('open-port', 'exit 0')
4186	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4184	        # Two open ports, leave one alone and open another one.
4185	        fake_script.write('open-port', 'exit 0')
4186	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4185	        fake_script.write('open-port', 'exit 0')
4186	        fake_script.write('close-port', 'exit 0')
4187	        fake_script.write('opened-ports', 'echo 8025/tcp; echo 8028/tcp')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4185	        fake_script.write('open-port', 'exit 0')
4186	        fake_script.write('close-port', 'exit 0')
4187	        fake_script.write('opened-ports', 'echo 8025/tcp; echo 8028/tcp')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4186	        fake_script.write('close-port', 'exit 0')
4187	        fake_script.write('opened-ports', 'echo 8025/tcp; echo 8028/tcp')
4188	        unit.set_ports(ops.Port('udp', 8022), 8028)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4186	        fake_script.write('close-port', 'exit 0')
4187	        fake_script.write('opened-ports', 'echo 8025/tcp; echo 8028/tcp')
4188	        unit.set_ports(ops.Port('udp', 8022), 8028)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4195	    def test_set_ports_replace(self, fake_script: FakeScript, unit: ops.Unit):
4196	        fake_script.write('open-port', 'exit 0')
4197	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4195	    def test_set_ports_replace(self, fake_script: FakeScript, unit: ops.Unit):
4196	        fake_script.write('open-port', 'exit 0')
4197	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4196	        fake_script.write('open-port', 'exit 0')
4197	        fake_script.write('close-port', 'exit 0')
4198	        fake_script.write('opened-ports', 'echo 8025/tcp; echo 8028/tcp')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4196	        fake_script.write('open-port', 'exit 0')
4197	        fake_script.write('close-port', 'exit 0')
4198	        fake_script.write('opened-ports', 'echo 8025/tcp; echo 8028/tcp')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4197	        fake_script.write('close-port', 'exit 0')
4198	        fake_script.write('opened-ports', 'echo 8025/tcp; echo 8028/tcp')
4199	        unit.set_ports(8001, 8002)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4197	        fake_script.write('close-port', 'exit 0')
4198	        fake_script.write('opened-ports', 'echo 8025/tcp; echo 8028/tcp')
4199	        unit.set_ports(8001, 8002)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4210	    def test_set_ports_close_all(self, fake_script: FakeScript, unit: ops.Unit):
4211	        fake_script.write('open-port', 'exit 0')
4212	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4210	    def test_set_ports_close_all(self, fake_script: FakeScript, unit: ops.Unit):
4211	        fake_script.write('open-port', 'exit 0')
4212	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4211	        fake_script.write('open-port', 'exit 0')
4212	        fake_script.write('close-port', 'exit 0')
4213	        fake_script.write('opened-ports', 'echo 8022/udp')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4211	        fake_script.write('open-port', 'exit 0')
4212	        fake_script.write('close-port', 'exit 0')
4213	        fake_script.write('opened-ports', 'echo 8022/udp')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4212	        fake_script.write('close-port', 'exit 0')
4213	        fake_script.write('opened-ports', 'echo 8022/udp')
4214	        unit.set_ports()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4212	        fake_script.write('close-port', 'exit 0')
4213	        fake_script.write('opened-ports', 'echo 8022/udp')
4214	        unit.set_ports()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4220	    def test_set_ports_noop(self, fake_script: FakeScript, unit: ops.Unit):
4221	        fake_script.write('open-port', 'exit 0')
4222	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4220	    def test_set_ports_noop(self, fake_script: FakeScript, unit: ops.Unit):
4221	        fake_script.write('open-port', 'exit 0')
4222	        fake_script.write('close-port', 'exit 0')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4221	        fake_script.write('open-port', 'exit 0')
4222	        fake_script.write('close-port', 'exit 0')
4223	        fake_script.write('opened-ports', 'echo 8000/tcp')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4221	        fake_script.write('open-port', 'exit 0')
4222	        fake_script.write('close-port', 'exit 0')
4223	        fake_script.write('opened-ports', 'echo 8000/tcp')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4222	        fake_script.write('close-port', 'exit 0')
4223	        fake_script.write('opened-ports', 'echo 8000/tcp')
4224	        unit.set_ports(ops.Port('tcp', 8000))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4222	        fake_script.write('close-port', 'exit 0')
4223	        fake_script.write('opened-ports', 'echo 8000/tcp')
4224	        unit.set_ports(ops.Port('tcp', 8000))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4233	        unit = model.unit
4234	        fake_script.write('juju-reboot', 'exit 0')
4235	        unit.reboot()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4233	        unit = model.unit
4234	        fake_script.write('juju-reboot', 'exit 0')
4235	        unit.reboot()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4346	            'region': 'localhost',
4347	            'endpoint': 'https://10.76.251.1:8443',
4348	            'credential': cred,
4349	            'identity-endpoint': 'foo',
4350	            'storage-endpoint': 'bar',
4351	            'cacertificates': ['foo', 'bar'],
4352	            'skip-tls-verify': False,
4353	            'is-controller-cloud': True,
4354	        }
4355	        cloud_spec = ops.CloudSpec.from_dict(d)
4356	        assert cloud_spec.type == d['type']
4357	        assert cloud_spec.name == d['name']
4358	        assert cloud_spec.region == d['region']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4371	            'region': 'localhost',
4372	            'endpoint': 'https://10.76.251.1:8443',
4373	            'identity-endpoint': 'foo',
4374	            'storage-endpoint': 'bar',
4375	            'cacertificates': ['foo', 'bar'],
4376	            'skip-tls-verify': False,
4377	            'is-controller-cloud': True,
4378	        }
4379	        cloud_spec = ops.CloudSpec.from_dict(d)
4380	        assert cloud_spec.type == d['type']
4381	        assert cloud_spec.name == d['name']
4382	        assert cloud_spec.region == d['region']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4397	    def test_success(self, fake_script: FakeScript, model: ops.Model):
4398	        fake_script.write('credential-get', """echo '{"type": "lxd", "name": "localhost"}'""")
4399	        cloud_spec = model.get_cloud_spec()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4397	    def test_success(self, fake_script: FakeScript, model: ops.Model):
4398	        fake_script.write('credential-get', """echo '{"type": "lxd", "name": "localhost"}'""")
4399	        cloud_spec = model.get_cloud_spec()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4404	    def test_error(self, fake_script: FakeScript, model: ops.Model):
4405	        fake_script.write(
4406	            'credential-get', """echo 'ERROR cannot access cloud credentials' >&2; exit 1"""
4407	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_model.py:4405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
4404	    def test_error(self, fake_script: FakeScript, model: ops.Model):
4405	        fake_script.write(
4406	            'credential-get', """echo 'ERROR cannot access cloud credentials' >&2; exit 1"""
4407	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
527	
528	        plan = pebble.Plan("""
529	checks:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
538	        assert plan.checks['bar'].override == 'replace'
539	        assert plan.checks['bar'].http == {'url': 'https://example.com/'}
540	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
548	
549	        location = 'https://example.com:3100/loki/api/v1/push'
550	        plan = pebble.Plan(f"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
574	        # With a service, we return validated yaml content.
575	        raw = """\
576	services:
577	 foo:
578	  override: replace
579	  command: echo foo
580	
581	checks:
582	 bar:
583	  http:
584	   https://example.com/
585	
586	log-targets:
587	 baz:
588	  override: replace
589	  type: loki
590	  location: https://example.com:3100/loki/api/v1/push
591	"""
592	        plan = pebble.Plan(raw)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
613	                'bar': {
614	                    'http': {'url': 'https://example.com/'},
615	                },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
620	                    'type': 'loki',
621	                    'location': 'https://example.com:3100/loki/api/v1/push',
622	                },
623	            },
624	        }
625	        plan = pebble.Plan(raw)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
676	        assert plan1 != plan3
677	        plan4 = pebble.Plan("""
678	services:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
693	""")
694	        plan5 = pebble.Plan("""
695	services:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
712	        assert plan4 != plan5
713	        plan6 = pebble.Plan("""
714	services:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
731	        assert plan4 != plan6
732	        plan7 = pebble.Plan("""
733	services:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
787	                    'type': 'loki',
788	                    'location': 'https://example.com',
789	                    'services': ['foo'],
790	                    'labels': {
791	                        'key': 'value $VAR',
792	                    },
793	                },
794	            },
795	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:808
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
807	        assert s.log_targets['baz'].type == 'loki'
808	        assert s.log_targets['baz'].location == 'https://example.com'
809	        assert s.log_targets['baz'].services == ['foo']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
817	
818	        yaml = """checks:
819	  chk:
820	    http:
821	      url: https://example.com/
822	description: The quick brown fox!
823	log-targets:
824	  baz:
825	    location: https://example.com:3100
826	    override: replace
827	    type: loki
828	services:
829	  bar:
830	    command: echo bar
831	    environment:
832	      ENV1: value1
833	      ENV2: value2
834	    group: staff
835	    group-id: 2000
836	    summary: Bar
837	    user: bob
838	    user-id: 1000
839	  foo:
840	    command: echo foo
841	    summary: Foo
842	summary: Sum Mary
843	"""
844	        s = pebble.Layer(yaml)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
859	        assert s.checks['chk'].name == 'chk'
860	        assert s.checks['chk'].http == {'url': 'https://example.com/'}
861	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
863	        assert s.log_targets['baz'].override == 'replace'
864	        assert s.log_targets['baz'].location == 'https://example.com:3100'
865	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:1088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1087	            # but it makes things simpler for the unit tests.
1088	            'http': {'url': 'https://example.com/'},
1089	            'tcp': {'port': 80},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1099	        assert check.threshold == 5
1100	        assert check.http == {'url': 'https://example.com/'}
1101	        assert check.tcp == {'port': 80}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:1108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1107	        assert check.http is not None and check.tcp is not None and check.exec is not None
1108	        check.http['url'] = 'https://www.google.com'
1109	        assert d['http'] == {'url': 'https://example.com/'}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1108	        check.http['url'] = 'https://www.google.com'
1109	        assert d['http'] == {'url': 'https://example.com/'}
1110	        check.tcp['port'] = 81

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:1122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1121	            'threshold': 5,
1122	            'http': {'url': 'https://example.com/'},
1123	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1133	            'threshold': 5,
1134	            'http': {'url': 'https://example.com/'},
1135	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:1165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1164	            'type': 'loki',
1165	            'location': 'https://example.com:3100/loki/api/v1/push',
1166	            'services': ['+all'],
1167	            'labels': {'key': 'val', 'key2': 'val2'},
1168	        }
1169	        target = pebble.LogTarget('tgt', d)
1170	        assert target.name == 'tgt'
1171	        assert target.override == 'replace'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:1173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1172	        assert target.type == 'loki'
1173	        assert target.location == 'https://example.com:3100/loki/api/v1/push'
1174	        assert target.services == ['+all']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:1191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1190	            'type': 'loki',
1191	            'location': 'https://example.com',
1192	            'services': ['foo', 'bar'],
1193	            'labels': {'k': 'v'},
1194	        }
1195	        one = pebble.LogTarget('one', d)
1196	        two = pebble.LogTarget('two', d)
1197	        assert one == two

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:2644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2643	            parser.feed(b)
2644	        message = parser.close()
2645	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:2891
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2890	
2891	        client.send_signal('SIGHUP', ['s1', 's2'])
2892	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:2906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2905	
2906	        client.send_signal(signal.SIGHUP, ['s1', 's2'])
2907	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:2914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2913	        with pytest.raises(TypeError):
2914	            client.send_signal('SIGHUP', 'should-be-a-list')
2915	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:2917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2916	        with pytest.raises(TypeError):
2917	            client.send_signal('SIGHUP', [1, 2])  # type: ignore
2918	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3453	        process = client.exec(['server'])
3454	        process.send_signal('SIGHUP')
3455	        num_sends = 1

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3456	        if hasattr(signal, 'SIGHUP'):
3457	            process.send_signal(1)
3458	            process.send_signal(signal.SIGHUP)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3457	            process.send_signal(1)
3458	            process.send_signal(signal.SIGHUP)
3459	            num_sends += 2

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3742	        try:
3743	            fin.write('foo\n')
3744	            fin.seek(0)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3768	        finally:
3769	            fin.close()
3770	            out.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3769	            fin.close()
3770	            out.close()
3771	            err.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3770	            out.close()
3771	            err.close()
3772	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3780	        assert process.stdout is not None and process.stdin is not None
3781	        process.stdin.write('Foo Bar\n')
3782	        assert process.stdout.read(4) == 'FOO '

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3782	        assert process.stdout.read(4) == 'FOO '
3783	        process.stdin.write('bazz\n')
3784	        assert process.stdout.read() == 'BAR\nBAZZ\n'

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3784	        assert process.stdout.read() == 'BAR\nBAZZ\n'
3785	        process.stdin.close()
3786	        assert process.stdout.read() == ''

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3805	        assert process.stdout is not None and process.stdin is not None
3806	        process.stdin.write(b'Foo Bar\n')
3807	        assert process.stdout.read(4) == b'FOO '

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3809
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
3808	        assert process.stdout.read() == b'BAR\n'
3809	        process.stdin.write(b'bazz\n')
3810	        assert process.stdout.read() == b'BAZZ\n'

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_pebble.py:3811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3810	        assert process.stdout.read() == b'BAZZ\n'
3811	        process.stdin.close()
3812	        assert process.stdout.read() == b''

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
140	        assert excinfo.value.code == 502
141	        health = json.loads(excinfo.value.read())
142	        assert health == {

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
158	    def _get_health(self):
159	        f = urllib.request.urlopen('http://localhost:4000/v1/health')
160	        return json.loads(f.read())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	    def _get_health(self):
159	        f = urllib.request.urlopen('http://localhost:4000/v1/health')
160	        return json.loads(f.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
159	        f = urllib.request.urlopen('http://localhost:4000/v1/health')
160	        return json.loads(f.read())
161	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
210	        with client.pull(fname) as f:
211	            data = f.read()
212	            assert data == content

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
244	                for line in ['one\n', '2\n', 'THREE\n']:
245	                    process.stdin.write(line)
246	                    process.stdin.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
244	                for line in ['one\n', '2\n', 'THREE\n']:
245	                    process.stdin.write(line)
246	                    process.stdin.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
250	
251	        threading.Thread(target=stdin_thread).start()
252	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
266	                for line in [b'one\n', b'2\n', b'THREE\n']:
267	                    process.stdin.write(line)
268	                    process.stdin.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
266	                for line in [b'one\n', b'2\n', b'THREE\n']:
267	                    process.stdin.write(line)
268	                    process.stdin.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
272	
273	        threading.Thread(target=stdin_thread).start()
274	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
294	                        'override': 'replace',
295	                        'location': 'https://example.com',
296	                        'services': ['all'],
297	                        'labels': {'foo': 'bar'},
298	                    },
299	                },
300	            },
301	            combine=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
306	        assert plan.log_targets['pretend-loki'].override == 'replace'
307	        assert plan.log_targets['pretend-loki'].location == 'https://example.com'
308	        assert plan.log_targets['pretend-loki'].services == ['all']

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_real_pebble.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
322	        yield pebble_dir
323	        shutil.rmtree(pebble_dir)
324	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
280	            # Set the file to access that will need fixing for user, group, and other.
281	            os.chmod(filename, 0o744)
282	            storage = ops.storage.SQLiteStorage(filename)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:281
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
280	            # Set the file to access that will need fixing for user, group, and other.
281	            os.chmod(filename, 0o744)
282	            storage = ops.storage.SQLiteStorage(filename)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
312	
313	    fake_script.write(
314	        'state-set',
315	        dedent("""\
316	        {executable} -c '
317	        import sys
318	        if "{pthpth}" not in sys.path:
319	            sys.path.append("{pthpth}")
320	        import sys, yaml, pathlib, pickle
321	        assert sys.argv[1:] == ["--file", "-"]
322	        request = yaml.load(sys.stdin, Loader=getattr(yaml, "CSafeLoader", yaml.SafeLoader))
323	        state_file = pathlib.Path("{state_file}")
324	        if state_file.exists() and state_file.stat().st_size > 0:
325	            with state_file.open("rb") as f:
326	                state = pickle.load(f)
327	        else:
328	            state = {{}}
329	        for k, v in request.items():
330	            state[k] = v
331	        with state_file.open("wb") as f:
332	            pickle.dump(state, f)
333	        ' "$@"
334	        """).format(**template_args),
335	    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
312	
313	    fake_script.write(
314	        'state-set',
315	        dedent("""\
316	        {executable} -c '
317	        import sys
318	        if "{pthpth}" not in sys.path:
319	            sys.path.append("{pthpth}")
320	        import sys, yaml, pathlib, pickle
321	        assert sys.argv[1:] == ["--file", "-"]
322	        request = yaml.load(sys.stdin, Loader=getattr(yaml, "CSafeLoader", yaml.SafeLoader))
323	        state_file = pathlib.Path("{state_file}")
324	        if state_file.exists() and state_file.stat().st_size > 0:
325	            with state_file.open("rb") as f:
326	                state = pickle.load(f)
327	        else:
328	            state = {{}}
329	        for k, v in request.items():
330	            state[k] = v
331	        with state_file.open("wb") as f:
332	            pickle.dump(state, f)
333	        ' "$@"
334	        """).format(**template_args),
335	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
336	
337	    fake_script.write(
338	        'state-get',
339	        dedent("""\
340	        {executable} -Sc '
341	        import sys
342	        if "{pthpth}" not in sys.path:
343	            sys.path.append("{pthpth}")
344	        import sys, pathlib, pickle
345	        assert len(sys.argv) == 2
346	        state_file = pathlib.Path("{state_file}")
347	        if state_file.exists() and state_file.stat().st_size > 0:
348	            with state_file.open("rb") as f:
349	                state = pickle.load(f)
350	        else:
351	            state = {{}}
352	        result = state.get(sys.argv[1], "\\n")
353	        sys.stdout.write(result)
354	        ' "$@"
355	        """).format(**template_args),
356	    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
336	
337	    fake_script.write(
338	        'state-get',
339	        dedent("""\
340	        {executable} -Sc '
341	        import sys
342	        if "{pthpth}" not in sys.path:
343	            sys.path.append("{pthpth}")
344	        import sys, pathlib, pickle
345	        assert len(sys.argv) == 2
346	        state_file = pathlib.Path("{state_file}")
347	        if state_file.exists() and state_file.stat().st_size > 0:
348	            with state_file.open("rb") as f:
349	                state = pickle.load(f)
350	        else:
351	            state = {{}}
352	        result = state.get(sys.argv[1], "\\n")
353	        sys.stdout.write(result)
354	        ' "$@"
355	        """).format(**template_args),
356	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
357	
358	    fake_script.write(
359	        'state-delete',
360	        dedent("""\
361	        {executable} -Sc '
362	        import sys
363	        if "{pthpth}" not in sys.path:
364	            sys.path.append("{pthpth}")
365	        import sys, pathlib, pickle
366	        assert len(sys.argv) == 2
367	        state_file = pathlib.Path("{state_file}")
368	        if state_file.exists() and state_file.stat().st_size > 0:
369	            with state_file.open("rb") as f:
370	                state = pickle.load(f)
371	        else:
372	            state = {{}}
373	        state.pop(sys.argv[1], None)
374	        with state_file.open("wb") as f:
375	            pickle.dump(state, f)
376	        ' "$@"
377	        """).format(**template_args),
378	    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
357	
358	    fake_script.write(
359	        'state-delete',
360	        dedent("""\
361	        {executable} -Sc '
362	        import sys
363	        if "{pthpth}" not in sys.path:
364	            sys.path.append("{pthpth}")
365	        import sys, pathlib, pickle
366	        assert len(sys.argv) == 2
367	        state_file = pathlib.Path("{state_file}")
368	        if state_file.exists() and state_file.stat().st_size > 0:
369	            with state_file.open("rb") as f:
370	                state = pickle.load(f)
371	        else:
372	            state = {{}}
373	        state.pop(sys.argv[1], None)
374	        with state_file.open("wb") as f:
375	            pickle.dump(state, f)
376	        ' "$@"
377	        """).format(**template_args),
378	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
438	    def test_is_available(self, fake_script: FakeScript):
439	        fake_script.write('state-get', 'echo ""')
440	        assert ops.storage.juju_backend_available()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
438	    def test_is_available(self, fake_script: FakeScript):
439	        fake_script.write('state-get', 'echo ""')
440	        assert ops.storage.juju_backend_available()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
445	        try:
446	            fake_script.write(
447	                'state-set',
448	                dedent("""
449	                cat >> {}
450	                """).format(pathlib.Path(t.name).as_posix()),
451	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
445	        try:
446	            fake_script.write(
447	                'state-set',
448	                dedent("""
449	                cat >> {}
450	                """).format(pathlib.Path(t.name).as_posix()),
451	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
457	            t.seek(0)
458	            content = t.read()
459	        finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
466	    def test_get(self, fake_script: FakeScript):
467	        fake_script.write(
468	            'state-get',
469	            dedent("""
470	            echo 'foo: "bar"'

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
466	    def test_get(self, fake_script: FakeScript):
467	        fake_script.write(
468	            'state-get',
469	            dedent("""
470	            echo 'foo: "bar"'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
482	        try:
483	            fake_script.write(
484	                'state-set',
485	                dedent("""
486	                cat >> {}
487	                """).format(pathlib.Path(t.name).as_posix()),
488	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
482	        try:
483	            fake_script.write(
484	                'state-set',
485	                dedent("""
486	                cat >> {}
487	                """).format(pathlib.Path(t.name).as_posix()),
488	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
502	            t.seek(0)
503	            content = t.read()
504	        finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
522	        # Value of where to store the entry.
523	        fake_script.write(
524	            'state-get',
525	            dedent("""
526	            echo "foo: 2

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_storage.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
522	        # Value of where to store the entry.
523	        fake_script.write(
524	            'state-get',
525	            dedent("""
526	            echo "foo: 2

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
47	
48	is_linux = platform.system() == 'Linux'
49	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
47	
48	is_linux = platform.system() == 'Linux'
49	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
47	
48	is_linux = platform.system() == 'Linux'
49	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
298	        harness.update_relation_data(rel_id, 'test-app', {'k': 'v1'})
299	        harness.update_relation_data(rel_id, 'test-app/0', {'ingress-address': '192.0.2.1'})
300	        backend = harness._backend

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
302	        assert backend.relation_get(rel_id, 'test-app/0', is_app=False) == {
303	            'ingress-address': '192.0.2.1'
304	        }
305	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
308	        assert backend.relation_get(rel_id, 'test-app/0', is_app=False) == {
309	            'ingress-address': '192.0.2.1'
310	        }
311	        # Make sure no relation-changed events are emitted for our own data bags.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
318	        # We can also update our own relation data, even if it is a bit 'cheaty'
319	        harness.update_relation_data(rel_id, 'test-app/0', {'ingress-address': '192.0.2.2'})
320	        # But no event happens

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
324	        harness.update_relation_data(rel_id, 'test-app', {'k': 'v3'})
325	        harness.update_relation_data(rel_id, 'test-app/0', {'ingress-address': '192.0.2.2'})
326	        assert harness.charm.observed_events == []

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
357	        harness.update_relation_data(rel_id, 'test-app', {'k': 'v'})
358	        harness.update_relation_data(rel_id, 'test-app/0', {'ingress-address': '192.0.2.1'})
359	        backend = harness._backend

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
361	        assert backend.relation_get(rel_id, 'test-app/0', is_app=False) == {
362	            'ingress-address': '192.0.2.1'
363	        }
364	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
367	        assert backend.relation_get(rel_id, 'test-app/0', is_app=False) == {
368	            'ingress-address': '192.0.2.1'
369	        }
370	        # Make sure no relation-changed events are emitted for our own data bags.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
374	        harness.update_relation_data(rel_id, 'test-app', {'k': 'v2'})
375	        harness.update_relation_data(rel_id, 'test-app/0', {'ingress-address': '192.0.2.2'})
376	        assert harness.charm.observed_events == []

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1452	        tmp = pathlib.Path(tempfile.mkdtemp())
1453	        request.addfinalizer(lambda: shutil.rmtree(tmp))
1454	        metadata_filename = tmp / 'metadata.yaml'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:1456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1455	        with metadata_filename.open('wt') as metadata:
1456	            metadata.write(
1457	                textwrap.dedent("""
1458	            name: my-charm

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:1456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1455	        with metadata_filename.open('wt') as metadata:
1456	            metadata.write(
1457	                textwrap.dedent("""
1458	            name: my-charm

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:1472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1471	        tmp = pathlib.Path(tempfile.mkdtemp())
1472	        request.addfinalizer(lambda: shutil.rmtree(tmp))
1473	        charmcraft_filename = tmp / 'charmcraft.yaml'

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:1499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1498	        tmp = pathlib.Path(tempfile.mkdtemp())
1499	        request.addfinalizer(lambda: shutil.rmtree(tmp))
1500	        config_filename = tmp / 'config.yaml'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:1502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1501	        with config_filename.open('wt') as config:
1502	            config.write(
1503	                textwrap.dedent("""
1504	            options:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:1502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1501	        with config_filename.open('wt') as config:
1502	            config.write(
1503	                textwrap.dedent("""
1504	            options:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:1541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1540	        tmp = pathlib.Path(tempfile.mkdtemp())
1541	        request.addfinalizer(lambda: shutil.rmtree(tmp))
1542	        charmcraft_filename = tmp / 'charmcraft.yaml'

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2055
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2054	        tmp = pathlib.Path(tempfile.mkdtemp())
2055	        request.addfinalizer(lambda: shutil.rmtree(tmp))
2056	        actions_filename = tmp / 'actions.yaml'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2058
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2057	        with actions_filename.open('wt') as actions:
2058	            actions.write(
2059	                textwrap.dedent("""
2060	            test:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2058
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2057	        with actions_filename.open('wt') as actions:
2058	            actions.write(
2059	                textwrap.dedent("""
2060	            test:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2071	        tmp = pathlib.Path(tempfile.mkdtemp())
2072	        request.addfinalizer(lambda: shutil.rmtree(tmp))
2073	        charmcraft_filename = tmp / 'charmcraft.yaml'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2108	            # language=Python
2109	            charmpy.write(
2110	                textwrap.dedent("""
2111	                from ops import CharmBase

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2108	            # language=Python
2109	            charmpy.write(
2110	                textwrap.dedent("""
2111	                from ops import CharmBase

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2388	        with path.open('r') as resource_file:
2389	            contents = yaml.safe_load(resource_file.read())
2390	        assert contents['registrypath'] == 'registrypath'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2467	        with resource.open('r') as resource_file:
2468	            contents = yaml.safe_load(resource_file.read())
2469	        assert contents['registrypath'] == 'custompath'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2538	        with path.open('rt') as f:
2539	            assert f.read() == 'foo contents\n'
2540	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:2560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2559	        with path.open('rb') as f:
2560	            assert raw_contents == f.read()
2561	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3165	    def test_add_layer_with_log_targets_to_plan(self):
3166	        layer_yaml = """\
3167	        services:
3168	         foo:
3169	          override: replace
3170	          command: echo foo
3171	
3172	        checks:
3173	         bar:
3174	          http:
3175	           https://example.com/
3176	
3177	        log-targets:
3178	         baz:
3179	          override: replace
3180	          type: loki
3181	          location: https://example.com:3100/loki/api/v1/push
3182	        """
3183	        harness = ops.testing.Harness(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3328	    def test_add_network_defaults(self, harness: ops.testing.Harness[ops.CharmBase]):
3329	        harness.add_network('10.0.0.10')
3330	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3334	        network = binding.network
3335	        assert network.bind_address == ipaddress.IPv4Address('10.0.0.10')
3336	        assert network.ingress_address == ipaddress.IPv4Address('10.0.0.10')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3335	        assert network.bind_address == ipaddress.IPv4Address('10.0.0.10')
3336	        assert network.ingress_address == ipaddress.IPv4Address('10.0.0.10')
3337	        assert network.ingress_addresses == [ipaddress.IPv4Address('10.0.0.10')]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3336	        assert network.ingress_address == ipaddress.IPv4Address('10.0.0.10')
3337	        assert network.ingress_addresses == [ipaddress.IPv4Address('10.0.0.10')]
3338	        assert network.egress_subnets == [ipaddress.IPv4Network('10.0.0.0/24')]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3341	        assert interface.name == 'eth0'
3342	        assert interface.address == ipaddress.IPv4Address('10.0.0.10')
3343	        assert interface.subnet == ipaddress.IPv4Network('10.0.0.0/24')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3347	        harness.add_network(
3348	            '10.0.0.10',
3349	            endpoint='db',
3350	            relation_id=relation_id,
3351	            cidr='10.0.0.0/8',
3352	            interface='eth1',
3353	            ingress_addresses=['10.0.0.1', '10.0.0.2'],
3354	            egress_subnets=['10.0.0.0/8', '10.10.0.0/16'],
3355	        )
3356	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3352	            interface='eth1',
3353	            ingress_addresses=['10.0.0.1', '10.0.0.2'],
3354	            egress_subnets=['10.0.0.0/8', '10.10.0.0/16'],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3352	            interface='eth1',
3353	            ingress_addresses=['10.0.0.1', '10.0.0.2'],
3354	            egress_subnets=['10.0.0.0/8', '10.10.0.0/16'],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3362	        network = binding.network
3363	        assert network.bind_address == ipaddress.IPv4Address('10.0.0.10')
3364	        assert network.ingress_address == ipaddress.IPv4Address('10.0.0.1')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3363	        assert network.bind_address == ipaddress.IPv4Address('10.0.0.10')
3364	        assert network.ingress_address == ipaddress.IPv4Address('10.0.0.1')
3365	        assert network.ingress_addresses == [

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3365	        assert network.ingress_addresses == [
3366	            ipaddress.IPv4Address('10.0.0.1'),
3367	            ipaddress.IPv4Address('10.0.0.2'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3366	            ipaddress.IPv4Address('10.0.0.1'),
3367	            ipaddress.IPv4Address('10.0.0.2'),
3368	        ]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3375	        assert interface.name == 'eth1'
3376	        assert interface.address == ipaddress.IPv4Address('10.0.0.10')
3377	        assert interface.subnet == ipaddress.IPv4Network('10.0.0.0/8')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3379	    def test_add_network_specific_endpoint(self, harness: ops.testing.Harness[ops.CharmBase]):
3380	        harness.add_network('10.0.0.1')
3381	        harness.add_network('10.0.2.1', endpoint='db')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3380	        harness.add_network('10.0.0.1')
3381	        harness.add_network('10.0.2.1', endpoint='db')
3382	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3386	        network = binding.network
3387	        assert network.bind_address == ipaddress.IPv4Address('10.0.2.1')
3388	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3391	        assert foo_binding is not None
3392	        assert foo_binding.network.bind_address == ipaddress.IPv4Address('10.0.0.1')
3393	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3394	    def test_add_network_specific_relation(self, harness: ops.testing.Harness[ops.CharmBase]):
3395	        harness.add_network('10.0.0.1')
3396	        harness.add_network('10.0.2.1', endpoint='db')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3395	        harness.add_network('10.0.0.1')
3396	        harness.add_network('10.0.2.1', endpoint='db')
3397	        relation_id = harness.add_relation('db', 'postgresql')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3397	        relation_id = harness.add_relation('db', 'postgresql')
3398	        harness.add_network('35.0.0.1', endpoint='db', relation_id=relation_id)
3399	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3405	        network = binding.network
3406	        assert network.bind_address == ipaddress.IPv4Address('35.0.0.1')
3407	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3410	        assert foo_binding is not None
3411	        assert foo_binding.network.bind_address == ipaddress.IPv4Address('10.0.0.1')
3412	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3414	        relation_id = harness.add_relation('db', 'postgresql')
3415	        harness.add_network('10.0.0.10', endpoint='db')
3416	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3422	        network = binding.network
3423	        assert network.bind_address == ipaddress.IPv4Address('10.0.0.10')
3424	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3425	    def test_add_network_default_fallback(self, harness: ops.testing.Harness[ops.CharmBase]):
3426	        harness.add_network('10.0.0.10')
3427	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3431	        network = binding.network
3432	        assert network.bind_address == ipaddress.IPv4Address('10.0.0.10')
3433	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3464	        with pytest.raises(ops.ModelError):
3465	            harness.add_network('35.0.0.1', endpoint='xyz')
3466	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3471	        with pytest.raises(TypeError):
3472	            harness.add_network('35.0.0.1', relation_id=relation_id)
3473	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3476	        with pytest.raises(ops.ModelError):
3477	            harness.add_network('35.0.0.1', endpoint='db', relation_id=relation_id + 1)
3478	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:3484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
3483	        with pytest.raises(ops.ModelError):
3484	            harness.add_network('35.0.0.1', endpoint='foo', relation_id=relation_id)
3485	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4134	            'foo',
4135	            pebble.Layer("""\
4136	            checks:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4161	            'foo',
4162	            """\
4163	            checks:
4164	                up:
4165	                    override: replace
4166	                    level: alive
4167	                    period: 10s
4168	                    threshold: 5
4169	                    exec:
4170	                        command: service nginx status
4171	                        environment:
4172	                            key1: value1
4173	                ready-http:
4174	                    override: replace
4175	                    level: ready
4176	                    period: 10s
4177	                    threshold: 5
4178	                    http:
4179	                        url: https://example.com:3101/health
4180	                ready-tcp:
4181	                    override: replace
4182	                    level: ready
4183	                    period: 10s
4184	                    threshold: 5
4185	                    tcp:
4186	                        port: 8081
4187	                        host: localhost1
4188	            """,
4189	            combine=True,
4190	        )
4191	        # Expected changes:
4192	        #  * All checks should have `period` 10s and `threshold` 5

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4197	        assert (
4198	            textwrap.dedent("""\
4199	            checks:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4233	            'foo',
4234	            pebble.Layer("""\
4235	            checks:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4292	        assert (
4293	            textwrap.dedent("""\
4294	            checks:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4332	            'foo',
4333	            pebble.Layer("""\
4334	            log-targets:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4347	            'foo',
4348	            pebble.Layer("""\
4349	            log-targets:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4362	        assert (
4363	            textwrap.dedent("""\
4364	            log-targets:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4379	            'foo',
4380	            pebble.Layer("""\
4381	            log-targets:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:4404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4403	        assert (
4404	            textwrap.dedent("""\
4405	            log-targets:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5052	        with client.pull(f'{pebble_dir}/test', encoding=encoding) as infile:
5053	            received_data = infile.read()
5054	        assert original_data == received_data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5065	        with client.pull(f'{pebble_dir}/test', encoding=encoding) as infile:
5066	            received_data = infile.read()
5067	        assert original_data == received_data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5076	        with client.pull(f'{pebble_dir}/test', encoding=None) as infile:
5077	            received_data = infile.read()
5078	        assert received_data == b'\x00\x01'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5087	        with client.pull(f'{pebble_dir}/test', encoding=None) as infile:
5088	            received_data = infile.read()
5089	        assert received_data == b'\x00\x01'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5103	        with client.pull(f'{pebble_dir}/test', encoding=None) as infile:
5104	            received_data = infile.read()
5105	        assert original_data == received_data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5457	        with open(fpath) as f:
5458	            assert f.read() == '42'
5459	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5469	        with c3.pull(c3_fpath) as f:
5470	            assert f.read() == '42'
5471	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5473	        with c1.pull(c1_fpath) as f:
5474	            assert f.read() == '42'
5475	        files = c1.list_files(c1_fpath)

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
5487	    def _select_testing_user_group(self):
5488	        user = next(u for u in pwd.getpwall() if u.pw_uid != os.getuid())
5489	        group = next(g for g in grp.getgrall() if g.gr_gid != os.getgid())

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5488
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
5487	    def _select_testing_user_group(self):
5488	        user = next(u for u in pwd.getpwall() if u.pw_uid != os.getuid())
5489	        group = next(g for g in grp.getgrall() if g.gr_gid != os.getgid())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5621	        (container_fs_root / 'foo').write_text('foo')
5622	        assert container.pull('/foo').read() == 'foo'
5623	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:5665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5664	        (container_fs_root / 'mounts/foo/bar').write_text('foobar')
5665	        assert container.pull('/mounts/foo/bar').read() == 'foobar'
5666	        harness.detach_storage(storage_id)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:6533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6532	        proc.wait()
6533	        assert proc.stdout.read() == 'output'
6534	        assert proc.stderr.read() == 'error'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:6534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6533	        assert proc.stdout.read() == 'output'
6534	        assert proc.stderr.read() == 'error'
6535	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:6545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6544	        assert proc.stderr is not None  # Not assertIsNotNone to help type checkers.
6545	        assert proc.stdout.read() == 'output'
6546	        assert proc.stderr.read() == 'error'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:6546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6545	        assert proc.stdout.read() == 'output'
6546	        assert proc.stderr.read() == 'error'
6547	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:6556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6555	        assert proc.stderr is not None  # Not assertIsNotNone to help type checkers.
6556	        assert proc.stdout.read() == b'output'
6557	        assert proc.stderr.read() == b'error'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:6557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6556	        assert proc.stdout.read() == b'output'
6557	        assert proc.stderr.read() == b'error'
6558	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7063	            'type': 'lxd',
7064	            'endpoint': 'https://127.0.0.1:8443',
7065	            'credential': {
7066	                'auth-type': 'certificate',
7067	                'attrs': {'client-cert': 'foo', 'client-key': 'bar', 'server-cert': 'baz'},
7068	            },
7069	        }
7070	        harness.set_cloud_spec(ops.CloudSpec.from_dict(cloud_spec_dict))
7071	        harness.begin()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7208	                    'threshold': 10,
7209	                    'http': {'url': 'http://localhost:5000/version'},
7210	                }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7166	                        'level': 'ready',
7167	                        'http': {'url': 'http://localhost:5050/version'},
7168	                    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7177	                        'startup': 'disabled',
7178	                        'http': {'url': 'http://localhost:5050/version'},
7179	                    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7250	                'timeout': '28s',
7251	                'http': {'url': 'http://localhost:5000/version'},
7252	            }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7257	                'type': 'loki',
7258	                'location': 'https://loki.example.com',
7259	                'services': ['server'],
7260	                'labels': {'foo': 'bar'},
7261	            }
7262	        },
7263	    })
7264	    layer2 = pebble.Layer({

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7274	                'level': 'alive',
7275	                'http': {'url': 'http://localhost:5050/version'},
7276	            }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7280	                'override': 'merge',
7281	                'location': 'https://loki2.example.com',
7282	            },
7283	        },
7284	    })

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7312	    assert check.http is not None
7313	    assert check.http.get('url') == 'http://localhost:5050/version'
7314	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ops-2.20.0/ops-2.20.0/test/test_testing.py:7320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7319	    assert log_target.override == 'merge'
7320	    assert log_target.location == 'https://loki2.example.com'
7321	

--------------------------------------------------

Code scanned:
	Total lines of code: 47798
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 163.0
		High: 650.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 797.0
		High: 16.0
Files skipped (0):
