Run started:2025-04-12 11:05:04.726649

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/circleci_real.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	class RealCircleCIEndpoint(ghstack.circleci.CircleCIEndpoint):
17	    rest_endpoint: str = "https://circleci.com/api/v1.1"
18	
19	    # The API token to authenticate to CircleCI with
20	    # https://circleci.com/account/api
21	    circle_token: Optional[str]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/circleci_real.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
55	
56	        async with aiohttp.request(
57	            method.upper(),
58	            url,
59	            params=params,
60	            json=kwargs,
61	            headers=headers,
62	            proxy=self.proxy,
63	        ) as resp:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	def get_path_from_env_var(var_name: str) -> Optional[Path]:
48	    if (path := os.environ.get(var_name)) is not None:
49	        return Path(path).expanduser().resolve()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	    logging.debug(f"config_path = {config_path}")
78	    config.read([".ghstackrc", config_path])
79	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	    if config.has_option("ghstack", "github_url"):
85	        github_url = config.get("ghstack", "github_url")
86	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	    if github_oauth is None and config.has_option("ghstack", "github_oauth"):
107	        github_oauth = config.get("ghstack", "github_oauth")
108	    if github_oauth is None and request_github_token:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
110	        CLIENT_ID = "89cc88ca50efbe86907a"
111	        res = requests.post(
112	            f"https://{github_url}/login/device/code",
113	            headers={"Accept": "application/json"},
114	            data={"client_id": CLIENT_ID, "scope": "repo"},
115	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	        print(f"User verification code: {data['user_code']}")
118	        print("Go to https://github.com/login/device and enter the code.")
119	        print("Once you've authorized ghstack, press any key to continue...")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
121	
122	        res = requests.post(
123	            f"https://{github_url}/login/oauth/access_token",
124	            headers={"Accept": "application/json"},
125	            data={
126	                "client_id": CLIENT_ID,
127	                "device_code": data["device_code"],
128	                "grant_type": "urn:ietf:params:oauth:grant-type:device_code",
129	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	    if circle_token is None and config.has_option("ghstack", "circle_token"):
139	        circle_token = config.get("ghstack", "circle_token")
140	    if circle_token is None and request_circle_token:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	        circle_token = getpass.getpass(
142	            "CircleCI Personal API token (make one at "
143	            "https://circleci.com/account/api ): "
144	        ).strip()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
151	    if config.has_option("ghstack", "github_username"):
152	        github_username = config.get("ghstack", "github_username")
153	    if github_username is None and github_oauth is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	        if github_url == "github.com":
156	            request_url = f"https://api.{github_url}/user"
157	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
158	            request_url = f"https://{github_url}/api/v3/user"
159	        res = requests.get(
160	            request_url,
161	            headers={
162	                "Accept": "application/vnd.github+json",
163	                "Authorization": f"Bearer {github_oauth}",
164	                "X-GitHub-Api-Version": "2022-11-28",
165	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
183	    if config.has_option("ghstack", "proxy"):
184	        proxy = config.get("ghstack", "proxy")
185	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
186	    if config.has_option("ghstack", "fbsource_path"):
187	        fbsource_path = config.get("ghstack", "fbsource_path")
188	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	    if config.has_option("ghstack", "github_path"):
192	        github_path = config.get("ghstack", "github_path")
193	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
196	    if config.has_option("ghstack", "default_project"):
197	        default_project_dir = config.get("ghstack", "default_project_dir")
198	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	    if config.has_option("ghstack", "remote_name"):
202	        remote_name = config.get("ghstack", "remote_name")
203	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/config.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
207	        with open(config_path, "w") as f:
208	            config.write(f)
209	        logging.info("NB: configuration saved to {}".format(config_path))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/diff.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	RAW_PULL_REQUEST_RESOLVED = (
17	    r"Pull Request resolved: "
18	    r"https://{github_url}/(?P<owner>[^/]+)/(?P<repo>[^/]+)/pull/(?P<number>[0-9]+)"
19	)
20	
21	
22	def re_pull_request_resolved(github_url: str) -> Pattern[str]:
23	    return re.compile(RAW_PULL_REQUEST_RESOLVED.format(github_url=github_url))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/diff.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    def url(self) -> str:
38	        return "https://{}/{}/{}/pull/{}".format(
39	            self.github_url, self.owner, self.repo, self.number

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/forensics.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	
16	RE_CIRCLECI_URL = re.compile(r"^https://circleci.com/gh/pytorch/pytorch/([0-9]+)")
17	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/forensics.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
48	
49	    params = ghstack.github_utils.parse_pull_request(pull_request)
50	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/forensics.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
114	            icon = "âŒ"
115	            async with aiohttp.request(
116	                "get", r["steps"][-1]["actions"][-1]["output_url"]
117	            ) as resp:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/github_fake.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
311	) as f:
312	    GITHUB_SCHEMA = graphql.build_schema(f.read())
313	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/github_fake.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
384	            closed=False,
385	            url="https://github.com/{}/pull/{}".format(repo.nameWithOwner, number),
386	            baseRef=baseRef,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/github_real.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        if self.github_url == "github.com":
23	            return f"https://api.{self.github_url}/graphql"
24	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/github_real.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        if self.github_url == "github.com":
32	            return f"https://api.{self.github_url}"
33	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/github_real.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    # interact with the real website
38	    www_endpoint: str = "https://{github_url}"
39	
40	    # The string OAuth token to authenticate to the GraphQL server with.
41	    # May be None if we're doing public access only.
42	    oauth_token: Optional[str]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/github_real.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
85	
86	        resp = requests.post(
87	            self.graphql_endpoint.format(github_url=self.github_url),
88	            json={"query": query, "variables": kwargs},
89	            headers=headers,
90	            proxies=self._proxies(),
91	            verify=self.verify,
92	            cert=self.cert,
93	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/github_real.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	            number = params["number"]
133	            resp = requests.get(
134	                f"{self.www_endpoint.format(github_url=self.github_url)}/{owner}/{name}/pull/{number}",
135	                proxies=self._proxies(),
136	                verify=self.verify,
137	                cert=self.cert,
138	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/github_real.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
182	            raise ghstack.github.NotFoundError(
183	                """\
184	GitHub raised a 404 error on the request for

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/github_utils.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
103	RE_PR_URL = re.compile(
104	    r"^https://(?P<github_url>[^/]+)/(?P<owner>[^/]+)/(?P<name>[^/]+)/pull/(?P<number>[0-9]+)/?$"
105	)
106	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/land.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	            raise RuntimeError(
77	                """\
78	Default branch {default_branch} is protected, and doesn't allow force pushes.
79	ghstack land does not work.  You will not be able to land your ghstack; please

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/logs.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	    with open(os.path.join(run_dir(), "exception"), "w") as f:
161	        f.write(type(e).__name__)
162	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/logs.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
166	    with open(os.path.join(run_dir(), "argv"), "w") as f:
167	        f.write(subprocess.list2cmdline(sys.argv))
168	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/logs.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
171	    with open(os.path.join(run_dir(), "status"), "w") as f:
172	        f.write(status)
173	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/logs.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
181	        assert RE_LOG_DIRNAME.fullmatch(stale_log)
182	        shutil.rmtree(os.path.join(log_base, stale_log))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	        with open(argv_fn, "r") as f:
20	            argv = f.read().rstrip()
21	    return argv

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	        with open(status_fn, "r") as f:
29	            status = f.read().rstrip()
30	    return status

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
90	                with open(exception_fn, "r") as f:
91	                    exception = "Failed with: " + f.read().rstrip()
92	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
109	    ) as g:
110	        g.write("version: {}\n".format(ghstack.__version__))
111	        g.write("command: {}\n".format(get_argv(log_dir)))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
109	    ) as g:
110	        g.write("version: {}\n".format(ghstack.__version__))
111	        g.write("command: {}\n".format(get_argv(log_dir)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
110	        g.write("version: {}\n".format(ghstack.__version__))
111	        g.write("command: {}\n".format(get_argv(log_dir)))
112	        g.write("status: {}\n".format(get_status(log_dir)))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
110	        g.write("version: {}\n".format(ghstack.__version__))
111	        g.write("command: {}\n".format(get_argv(log_dir)))
112	        g.write("status: {}\n".format(get_status(log_dir)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	        g.write("command: {}\n".format(get_argv(log_dir)))
112	        g.write("status: {}\n".format(get_status(log_dir)))
113	        g.write("\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
111	        g.write("command: {}\n".format(get_argv(log_dir)))
112	        g.write("status: {}\n".format(get_status(log_dir)))
113	        g.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	        g.write("status: {}\n".format(get_status(log_dir)))
113	        g.write("\n")
114	        log_fn = os.path.join(log_dir, "ghstack.log")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
112	        g.write("status: {}\n".format(get_status(log_dir)))
113	        g.write("\n")
114	        log_fn = os.path.join(log_dir, "ghstack.log")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	            with open(log_fn) as log:
117	                g.write(log.read())
118	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
116	            with open(log_fn) as log:
117	                g.write(log.read())
118	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/rage.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	            with open(log_fn) as log:
117	                g.write(log.read())
118	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/shell.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
157	                elif setting == subprocess.STDOUT:
158	                    sys.stdout.buffer.write(line)
159	                elif isinstance(setting, int):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/shell.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
159	                elif isinstance(setting, int):
160	                    os.write(setting, line)
161	                elif setting is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/shell.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
162	                    # Sigh.  See https://stackoverflow.com/questions/55681488/python-3-write-binary-to-stdout-respecting-buffering
163	                    default_stream.write(line.decode("utf-8"))
164	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/shell.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
167	                    # "parity" with the normal subprocess implementation
168	                    os.write(setting.fileno(), line)
169	            return b"".join(output)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/shell.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
175	                return
176	            stdin_writer.write(input.encode("utf-8"))
177	            await stdin_writer.drain()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/status.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	RE_CIRCLECI_URL = re.compile(r"^https://circleci.com/gh/pytorch/pytorch/([0-9]+)")
16	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/status.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
47	
48	    params = ghstack.github_utils.parse_pull_request(pull_request)
49	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/status.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
112	            if state == "FAILURE":
113	                async with aiohttp.request(
114	                    "get", r["steps"][-1]["actions"][-1]["output_url"]
115	                ) as resp:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/submit.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	STACK_HEADER = (
170	    "Stack from [ghstack](https://github.com/ezyang/ghstack) (oldest at bottom)"
171	)
172	
173	
174	def starts_with_bullet(body: str) -> bool:
175	    """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/submit.py:1483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1482	            logging.info(
1483	                "# Updating https://{github_url}/{owner}/{repo}/pull/{number}".format(
1484	                    github_url=self.github_url,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/submit.py:1541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1540	        def format_url(s: DiffMeta) -> str:
1541	            return "https://{github_url}/{owner}/{repo}/pull/{number}".format(
1542	                github_url=self.github_url,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/submit.py:1769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1768	                extra = (
1769	                    "\n\nDifferential Revision: "
1770	                    "[{phabdiff}]"
1771	                    "(https://our.internmc.facebook.com/intern/diff/{phabdiff})"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/submit.py:1807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1806	                raise RuntimeError(
1807	                    "[E001] git push failed, probably because it asked for password "
1808	                    "(scroll up to see original error).  "
1809	                    "Change your git URL to use SSH instead of HTTPS to enable passwordless push.  "

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/test_prelude.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
89	    if not os.access(path, os.W_OK):
90	        os.chmod(path, stat.S_IWUSR)
91	        func(path)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/test_prelude.py:90
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
89	    if not os.access(path, os.W_OK):
90	        os.chmod(path, stat.S_IWUSR)
91	        func(path)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/test_prelude.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
117	        else:
118	            shutil.rmtree(
119	                self.upstream_sh.cwd,
120	                onerror=handle_remove_read_only,
121	            )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/test_prelude.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
121	            )
122	            shutil.rmtree(
123	                self.sh.cwd,
124	                onerror=handle_remove_read_only,
125	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/test_prelude.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
242	    with self.sh.open(filename, "w") as f:
243	        f.write(contents)
244	    self.sh.git("add", filename)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ghstack-0.9.4/ghstack-0.9.4/ghstack/test_prelude.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
242	    with self.sh.open(filename, "w") as f:
243	        f.write(contents)
244	    self.sh.git("add", filename)

--------------------------------------------------

Code scanned:
	Total lines of code: 3884
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 51.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 71.0
		High: 1.0
Files skipped (0):
