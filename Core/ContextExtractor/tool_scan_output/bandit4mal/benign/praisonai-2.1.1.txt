Run started:2025-04-12 13:50:39.864980

Test results:
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
116	
117	    async with websockets.connect(
118	        'wss://api.openai.com/v1/realtime?model=gpt-4o-realtime-preview-2024-10-01',
119	        extra_headers={
120	            "Authorization": f"Bearer {OPENAI_API_KEY}",
121	            "OpenAI-Beta": "realtime=v1"
122	        }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
137	                        }
138	                        await openai_ws.send(json.dumps(audio_append))
139	                    elif data['event'] == 'start':

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
144	                if openai_ws.open:
145	                    await openai_ws.close()
146	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
163	                        try:
164	                            audio_payload = base64.b64encode(base64.b64decode(response['delta'])).decode('utf-8')
165	                            audio_delta = {

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:164
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
163	                        try:
164	                            audio_payload = base64.b64encode(base64.b64decode(response['delta'])).decode('utf-8')
165	                            audio_delta = {

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
163	                        try:
164	                            audio_payload = base64.b64encode(base64.b64decode(response['delta'])).decode('utf-8')
165	                            audio_delta = {

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:164
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
163	                        try:
164	                            audio_payload = base64.b64encode(base64.b64decode(response['delta'])).decode('utf-8')
165	                            audio_delta = {

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
199	    # Send the function call result back to OpenAI
200	    await openai_ws.send(json.dumps({
201	        "type": "conversation.item.create",
202	        "item": {
203	            "type": "function_call_output",
204	            "call_id": call_id,
205	            "output": json.dumps(result)
206	        }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
209	    # Create a new response after sending the function call result
210	    await openai_ws.send(json.dumps({
211	        "type": "response.create"
212	    }))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
257	    print('Sending session update:', json.dumps(session_update))
258	    await openai_ws.send(json.dumps(session_update))
259	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
262	        conf.get_default().auth_token = NGROK_AUTH_TOKEN
263	    public_url = ngrok.connect(addr=str(port)).public_url
264	    print(f"Praison AI Voice URL: {public_url}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
271	    else:
272	        print(f"Starting Praison AI Call Server on http://localhost:{port}")
273	    uvicorn.run(app, host="0.0.0.0", port=port, log_level="warning")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/api/call.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
272	        print(f"Starting Praison AI Call Server on http://localhost:{port}")
273	    uvicorn.run(app, host="0.0.0.0", port=port, log_level="warning")
274	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/auto.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	                'model': os.environ.get("OPENAI_MODEL_NAME", "gpt-4o"),
97	                'base_url': os.environ.get("OPENAI_API_BASE", "https://api.openai.com/v1"),
98	                'api_key': os.environ.get("OPENAI_API_KEY")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/auto.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
204	Use below example to understand the structure of the output. 
205	The final role you create should satisfy the provided task: """ + self.topic + """.
206	{
207	"roles": {
208	"narrative_designer": {
209	"role": "Narrative Designer",
210	"goal": "Create AI storylines",
211	"backstory": "Skilled in narrative development for AI, with a focus on story resonance.",
212	"tools": ["ScrapeWebsiteTool"],
213	"tasks": {
214	"story_concept_development": {
215	"description": "Craft a unique AI story concept with depth and engagement using concept from this page the content https://www.asthebirdfliesblog.com/posts/how-to-write-book-story-development .",
216	"expected_output": "Document with narrative arcs, character bios, and settings."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/chainlit_ui.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	                'model': os.environ.get("OPENAI_MODEL_NAME", "gpt-4o"),
20	                'base_url': os.environ.get("OPENAI_API_BASE", "https://api.openai.com/v1"),
21	                'api_key': os.environ.get("OPENAI_API_KEY", "")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/chainlit_ui.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	        with open("tools.py", "w") as f:
86	            f.write("# Add your custom tools here\n")
87	    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/chainlit_ui.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
108	            with open(full_agent_file_path, 'r') as f:
109	                yaml_content = f.read()
110	            msg = cl.Message(content=yaml_content, language="yaml")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/chainlit_ui.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	            with open(full_tools_file_path, 'r') as f:
117	                tools_content = f.read()
118	            msg = cl.Message(content=tools_content, language="python")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/chainlit_ui.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
162	        with open("agents.yaml", "w") as f:
163	            f.write(settings["agents"])
164	    if "tools" in settings:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/chainlit_ui.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
165	        with open("tools.py", "w") as f:
166	            f.write(settings["tools"])
167	    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/chainlit_ui.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
267	            with open(full_agent_file_path, 'r') as f:
268	                yaml_content = f.read()
269	            # tool_res = await tool()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/chainlit_ui.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
273	                with open(full_tools_file_path, 'r') as f:
274	                    tools_content = f.read()
275	                msg_tools = cl.Message(content=tools_content, language="python")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/cli.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	                'model': os.environ.get("OPENAI_MODEL_NAME", "gpt-4o"),
119	                'base_url': os.environ.get("OPENAI_API_BASE", "https://api.openai.com/v1"),
120	                'api_key': os.environ.get("OPENAI_API_KEY")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	        with open("Dockerfile", "w") as file:
56	            file.write("FROM python:3.11-slim\n")
57	            file.write("WORKDIR /app\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	            file.write("FROM python:3.11-slim\n")
57	            file.write("WORKDIR /app\n")
58	            file.write("COPY . .\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
57	            file.write("WORKDIR /app\n")
58	            file.write("COPY . .\n")
59	            file.write("RUN pip install flask praisonai==2.1.1 gunicorn markdown\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
58	            file.write("COPY . .\n")
59	            file.write("RUN pip install flask praisonai==2.1.1 gunicorn markdown\n")
60	            file.write("EXPOSE 8080\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	            file.write("RUN pip install flask praisonai==2.1.1 gunicorn markdown\n")
60	            file.write("EXPOSE 8080\n")
61	            file.write('CMD ["gunicorn", "-b", "0.0.0.0:8080", "api:app"]\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
60	            file.write("EXPOSE 8080\n")
61	            file.write('CMD ["gunicorn", "-b", "0.0.0.0:8080", "api:app"]\n')
62	            

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
75	        with open("api.py", "w") as file:
76	            file.write("from flask import Flask\n")
77	            file.write("from praisonai import PraisonAI\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
76	            file.write("from flask import Flask\n")
77	            file.write("from praisonai import PraisonAI\n")
78	            file.write("import markdown\n\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	            file.write("from praisonai import PraisonAI\n")
78	            file.write("import markdown\n\n")
79	            file.write("app = Flask(__name__)\n\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	            file.write("import markdown\n\n")
79	            file.write("app = Flask(__name__)\n\n")
80	            file.write("def basic():\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
79	            file.write("app = Flask(__name__)\n\n")
80	            file.write("def basic():\n")
81	            file.write("    praisonai = PraisonAI(agent_file=\"agents.yaml\")\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	            file.write("def basic():\n")
81	            file.write("    praisonai = PraisonAI(agent_file=\"agents.yaml\")\n")
82	            file.write("    return praisonai.run()\n\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
81	            file.write("    praisonai = PraisonAI(agent_file=\"agents.yaml\")\n")
82	            file.write("    return praisonai.run()\n\n")
83	            file.write("@app.route('/')\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	            file.write("    return praisonai.run()\n\n")
83	            file.write("@app.route('/')\n")
84	            file.write("def home():\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
83	            file.write("@app.route('/')\n")
84	            file.write("def home():\n")
85	            file.write("    output = basic()\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	            file.write("def home():\n")
85	            file.write("    output = basic()\n")
86	            file.write("    html_output = markdown.markdown(output)\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	            file.write("    output = basic()\n")
86	            file.write("    html_output = markdown.markdown(output)\n")
87	            file.write("    return f'<html><body>{html_output}</body></html>'\n\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
86	            file.write("    html_output = markdown.markdown(output)\n")
87	            file.write("    return f'<html><body>{html_output}</body></html>'\n\n")
88	            file.write("if __name__ == \"__main__\":\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	            file.write("    return f'<html><body>{html_output}</body></html>'\n\n")
88	            file.write("if __name__ == \"__main__\":\n")
89	            file.write("    app.run(debug=True)\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
88	            file.write("if __name__ == \"__main__\":\n")
89	            file.write("    app.run(debug=True)\n")
90	    

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/deploy.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        os.environ["OPENAI_API_KEY"] = os.getenv("OPENAI_API_KEY", "Enter your API key")
95	        os.environ["OPENAI_API_BASE"] = os.getenv("OPENAI_API_BASE", "https://api.openai.com/v1")
96	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/inc/models.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	            self.api_key_var = "OPENAI_API_KEY"
45	            self.base_url = base_url or "https://api.openai.com/v1"
46	            self.model_name = self.model.replace("openai/", "")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/inc/models.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	            self.api_key_var = "GROQ_API_KEY"
49	            self.base_url = base_url or "https://api.groq.com/openai/v1"
50	            self.model_name = self.model.replace("groq/", "")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/inc/models.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	            self.api_key_var = "OLLAMA_API_KEY"
57	            self.base_url = base_url or "http://localhost:11434/v1"
58	            self.model_name = self.model.replace("ollama/", "")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/inc/models.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	            self.api_key_var = "OPENROUTER_API_KEY"
69	            self.base_url = base_url or "https://openrouter.ai/api/v1"
70	            self.model_name = self.model.replace("openrouter/", "")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/inc/models.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	            self.api_key_var = api_key_var or "OPENAI_API_KEY" 
73	            self.base_url = base_url or os.environ.get("OPENAI_API_BASE", "https://api.openai.com/v1")
74	            self.model_name = self.model

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/setup/setup_conda_env.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
9	    
10	    if platform.system() == 'Windows':
11	        print("Windows detected. Please run the setup_conda_env.sh script manually in Git Bash or WSL.")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/setup/setup_conda_env.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
9	    
10	    if platform.system() == 'Windows':
11	        print("Windows detected. Please run the setup_conda_env.sh script manually in Git Bash or WSL.")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/setup/setup_conda_env.py:10
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
9	    
10	    if platform.system() == 'Windows':
11	        print("Windows detected. Please run the setup_conda_env.sh script manually in Git Bash or WSL.")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/test.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        'model': os.environ.get("OPENAI_MODEL_NAME", "gpt-4o-mini"),
11	        'base_url': os.environ.get("OPENAI_API_BASE", "https://api.openai.com/v1"),
12	        'api_key': os.environ.get("OPENAI_API_KEY")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/train.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
295	        if os.path.exists(self.config["hf_model_name"]):
296	            shutil.rmtree(self.config["hf_model_name"])
297	        self.model.push_to_hub_merged(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/train.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
526	        with open("Modelfile", "w") as file:
527	            file.write(modelfile_content)
528	        subprocess.run(["ollama", "serve"])

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/train_vision.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
219	        if os.path.exists(self.config["hf_model_name"]):
220	            shutil.rmtree(self.config["hf_model_name"])
221	        self.model.push_to_hub_merged(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/train_vision.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	        with open("Modelfile", "w") as file:
264	            file.write(modelfile_content)
265	        subprocess.run(["ollama", "serve"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        'model': os.environ.get("OPENAI_MODEL_NAME", "gpt-4o"),
14	        'base_url': os.environ.get("OPENAI_API_BASE", "https://api.openai.com/v1"),
15	        'api_key': os.environ.get("OPENAI_API_KEY", "")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
115	        try:
116	            await cl_data.update_thread(thread_id, metadata=metadata)
117	            return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
652	            with open("tools.py", "w") as f:
653	                f.write("# Add your custom tools here\n")
654	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
656	            with open("agents.yaml", "w") as f:
657	                f.write("# Add your custom agents here\n")
658	        

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
679	                with open(full_agent_file_path, 'r') as f:
680	                    yaml_content = f.read()
681	                msg = cl.Message(content=yaml_content, language="yaml")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
686	                with open(full_tools_file_path, 'r') as f:
687	                    tools_content = f.read()
688	                msg = cl.Message(content=tools_content, language="python")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
784	            with open("agents.yaml", "w") as f:
785	                f.write(settings["agents"])
786	        if "tools" in settings:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
787	            with open("tools.py", "w") as f:
788	                f.write(settings["tools"])
789	        

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
793	                try:
794	                    thread = await cl_data.get_thread(thread_id)
795	                    if thread:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/agents.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
803	                        metadata["model_name"] = config_list[0]['model']
804	                        await cl_data.update_thread(thread_id, metadata=metadata)
805	                        cl.user_session.set("metadata", metadata)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/chat.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
174	    if thread_id:
175	        thread = await cl_data.get_thread(thread_id)
176	        if thread:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/chat.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	            metadata["model_name"] = model_name
184	            await cl_data.update_thread(thread_id, metadata=metadata)
185	            cl.user_session.set("metadata", metadata)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/chat.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
228	        image.save(buffered, format="PNG")
229	        img_str = base64.b64encode(buffered.getvalue()).decode()
230	        completion_params["messages"][-1] = {

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/chat.py:229
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
228	        image.save(buffered, format="PNG")
229	        img_str = base64.b64encode(buffered.getvalue()).decode()
230	        completion_params["messages"][-1] = {

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/chat.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
384	    if image_data:
385	        image = Image.open(io.BytesIO(base64.b64decode(image_data)))
386	        cl.user_session.set("image", image)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/chat.py:385
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
384	    if image_data:
385	        image = Image.open(io.BytesIO(base64.b64decode(image_data)))
386	        cl.user_session.set("image", image)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/code.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
122	    if thread_id:
123	        thread = await cl_data._data_layer.get_thread(thread_id)
124	        if thread:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/code.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	            # Always store metadata as a dictionary
135	            await cl_data._data_layer.update_thread(thread_id, metadata=metadata)
136	            

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/code.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
248	        image.save(buffered, format="PNG")
249	        img_str = base64.b64encode(buffered.getvalue()).decode()
250	        

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/code.py:249
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
248	        image.save(buffered, format="PNG")
249	        img_str = base64.b64encode(buffered.getvalue()).decode()
250	        

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/code.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
437	    if image_data:
438	        image = Image.open(io.BytesIO(base64.b64decode(image_data)))
439	        cl.user_session.set("image", image)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/code.py:438
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
437	    if image_data:
438	        image = Image.open(io.BytesIO(base64.b64decode(image_data)))
439	        cl.user_session.set("image", image)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/components/aicoder.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
109	            with open(file_path, 'w') as file:
110	                file.write(content)
111	            return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/components/aicoder.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
117	            with open(file_path, 'r') as file:
118	                return file.read()
119	        except:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/context.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
164	                with open(file_path, 'r', encoding='utf-8') as f:
165	                    content = f.read()
166	                    context.append(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/context.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
240	        with open(self.output_file, 'w', encoding='utf-8') as f:
241	            f.write(context)
242	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/db.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
48	                    if os.path.exists(dst_path):
49	                        shutil.rmtree(dst_path)
50	                    shutil.copytree(src_path, dst_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtime.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
358	    if thread_id:
359	        thread = await cl_data._data_layer.get_thread(thread_id)
360	        if thread:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtime.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
370	            # Always store metadata as a dictionary
371	            await cl_data._data_layer.update_thread(thread_id, metadata=metadata)
372	            

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
31	    """
32	    binary_data = base64.b64decode(base64_string)
33	    return np.frombuffer(binary_data, dtype=np.uint8)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
31	    """
32	    binary_data = base64.b64decode(base64_string)
33	    return np.frombuffer(binary_data, dtype=np.uint8)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
47	    
48	    return base64.b64encode(array_buffer).decode('utf-8')
49	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
47	    
48	    return base64.b64encode(array_buffer).decode('utf-8')
49	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
107	            raise Exception("Already connected")
108	        self.ws = await websockets.connect(f"{self.url}?model={model}", extra_headers={
109	            'Authorization': f'Bearer {self.api_key}',
110	            'OpenAI-Beta': 'realtime=v1'
111	        })

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
137	        self.log("sent:", event)
138	        await self.ws.send(json.dumps(event))
139	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
144	        if self.ws:
145	            await self.ws.close()
146	            self.ws = None

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
470	            result = await tool_config["handler"](**json_arguments)
471	            await self.realtime.send("conversation.item.create", {
472	                "item": {
473	                    "type": "function_call_output",
474	                    "call_id": tool["call_id"],
475	                    "output": json.dumps(result),
476	                }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
480	            logger.error(f"Tool call error: {error_message}")
481	            await self.realtime.send("conversation.item.create", {
482	                "item": {
483	                    "type": "function_call_output",
484	                    "call_id": tool["call_id"],
485	                    "output": error_message,
486	                }

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
493	    def reset(self):
494	        self.disconnect()
495	        self.realtime.clear_event_handlers()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
502	            raise Exception("Already connected, use .disconnect() first")
503	        await self.realtime.connect()
504	        await self.update_session()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
517	        if self.realtime.is_connected():
518	            await self.realtime.disconnect()
519	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
541	    async def delete_item(self, id):
542	        await self.realtime.send("conversation.item.delete", {"item_id": id})
543	        return True

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
556	        if self.realtime.is_connected():
557	            await self.realtime.send("session.update", {"session": session})
558	        return True

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
560	    async def create_conversation_item(self, item):
561	        await self.realtime.send("conversation.item.create", {
562	            "item": item
563	        })

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
570	                        c["audio"] = array_buffer_to_base64(c["audio"])
571	            await self.realtime.send("conversation.item.create", {
572	                "item": {
573	                    "type": "message",
574	                    "role": "user",
575	                    "content": content,
576	                }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
582	        if len(array_buffer) > 0:
583	            await self.realtime.send("input_audio_buffer.append", {
584	                "audio": array_buffer_to_base64(np.array(array_buffer)),
585	            })

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
590	        if self.get_turn_detection_type() is None and len(self.input_audio_buffer) > 0:
591	            await self.realtime.send("input_audio_buffer.commit")
592	            self.conversation.queue_input_audio(self.input_audio_buffer)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
593	            self.input_audio_buffer = bytearray()
594	        await self.realtime.send("response.create")
595	        return True

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
598	        if not id:
599	            await self.realtime.send("response.cancel")
600	            return {"item": None}

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
608	                raise Exception('Can only cancelResponse messages with role "assistant"')
609	            await self.realtime.send("response.cancel")
610	            audio_index = next((i for i, c in enumerate(item["content"]) if c["type"] == "audio"), -1)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
612	                raise Exception("Could not find audio on item to cancel")
613	            await self.realtime.send("conversation.item.truncate", {
614	                "item_id": id,
615	                "content_index": audio_index,
616	                "audio_end_ms": int((sample_count / self.conversation.default_frequency) * 1000),
617	            })

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
640	                if content:
641	                    await cl.Message(content=content, author="User").send()
642	            elif item["role"] == "assistant":

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/__init__.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
644	                if content:
645	                    await cl.Message(content=content, author="AI").send()
646	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/tools.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	        import requests
218	        image_content = requests.get(image_url).content
219	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/tools.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
220	        # Convert image to base64
221	        image_base64 = base64.b64encode(image_content).decode('utf-8')
222	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/realtimeclient/tools.py:221
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
220	        # Convert image to base64
221	        image_base64 = base64.b64encode(image_content).decode('utf-8')
222	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/sql_alchemy.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
467	            async with aiofiles.open(element.path, "rb") as f:
468	                content = await f.read()
469	        elif element.url:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/sql_alchemy.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
467	            async with aiofiles.open(element.path, "rb") as f:
468	                content = await f.read()
469	        elif element.url:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/sql_alchemy.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
472	                    if response.status == 200:
473	                        content = await response.read()
474	                    else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/sql_alchemy.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
472	                    if response.status == 200:
473	                        content = await response.read()
474	                    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/sql_alchemy.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
482	
483	        user_id: str = await self._get_user_id_by_thread(element.thread_id) or "unknown"
484	        file_object_key = f"{user_id}/{element.id}" + (

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/ui/sql_alchemy.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
482	
483	        user_id: str = await self._get_user_id_by_thread(element.thread_id) or "unknown"
484	        file_object_key = f"{user_id}/{element.id}" + (

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/upload_vision.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
41	        if os.path.exists(self.config["hf_model_name"]):
42	            shutil.rmtree(self.config["hf_model_name"])
43	        self.model.push_to_hub_merged(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/praisonai-2.1.1/praisonai-2.1.1/praisonai/upload_vision.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	        with open("Modelfile", "w") as file:
88	            file.write(modelfile_content)
89	        

--------------------------------------------------

Code scanned:
	Total lines of code: 7584
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 98.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 112.0
		High: 10.0
Files skipped (0):
