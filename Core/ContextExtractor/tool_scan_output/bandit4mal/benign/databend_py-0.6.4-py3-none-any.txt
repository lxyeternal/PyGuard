Run started:2025-04-12 11:04:42.596805

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
165	                "Authorization": "Basic "
166	                + base64.b64encode(
167	                    "{}:{}".format(self.user, self.password).encode(encoding="utf-8")
168	                ).decode(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:166
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
165	                "Authorization": "Basic "
166	                + base64.b64encode(
167	                    "{}:{}".format(self.user, self.password).encode(encoding="utf-8")
168	                ).decode(),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
180	    def do_query(self, url, query_sql):
181	        response = self.requests_session.post(
182	            url,
183	            data=json.dumps(query_sql),
184	            headers=self.make_headers(),
185	            auth=HTTPBasicAuth(self.user, self.password),
186	            timeout=(self.connect_timeout, self.read_timeout),
187	            verify=True,
188	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
193	                    resp_dict
194	                    and resp_dict.get("error")
195	                    and "no endpoint" in resp_dict.get("error")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
194	                    and resp_dict.get("error")
195	                    and "no endpoint" in resp_dict.get("error")
196	                ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	                resp_dict
214	                and resp_dict.get("error")
215	                and "no endpoint" in resp_dict.get("error")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	                and resp_dict.get("error")
215	                and "no endpoint" in resp_dict.get("error")
216	            ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	                raise WarehouseTimeoutException
218	            if resp_dict and resp_dict.get("error"):
219	                raise UnexpectedException("failed to query: %s" % response.content)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
242	            resp_dict = self.do_query(url, query_sql)
243	            new_session_state = resp_dict.get("session", self.default_session())
244	            if new_session_state:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
247	                self.additional_headers.update(
248	                    {XDatabendQueryIDHeader: resp_dict.get(QueryID)}
249	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	                self.additional_headers = {
252	                    XDatabendQueryIDHeader: resp_dict.get(QueryID)
253	                }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	    def wait_until_has_schema(self, raw_data_dict):
272	        resp_schema = raw_data_dict.get("schema")
273	        while resp_schema is not None and len(resp_schema) == 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
279	            raw_data_dict = resp_dict
280	            resp_schema = raw_data_dict.get("schema")
281	            if resp_schema is not None and (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
281	            if resp_schema is not None and (
282	                len(resp_schema) != 0 or len(raw_data_dict.get("data")) != 0
283	            ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
289	
290	        response = self.requests_session.get(
291	            url=url, headers=self.make_headers(), cookies=self.cookies
292	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
307	        time_limit = 12
308	        session = response.get("session")
309	        if session:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/connection.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
315	            self.check_error(response)
316	            session = response.get("session")
317	            if session:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/uploader.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	        copy_options = {}
143	        copy_options["PURGE"] = self.settings.get("copy_purge", False)
144	        copy_options["FORCE"] = self.settings.get("force", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/uploader.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	        copy_options["PURGE"] = self.settings.get("copy_purge", False)
144	        copy_options["FORCE"] = self.settings.get("force", False)
145	        copy_options["SIZE_LIMIT"] = self.settings.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/uploader.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
144	        copy_options["FORCE"] = self.settings.get("force", False)
145	        copy_options["SIZE_LIMIT"] = self.settings.get(
146	            "size_limit", 0
147	        )  # TODO: is this correct to set size_limit = 100?

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/uploader.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	        )  # TODO: is this correct to set size_limit = 100?
148	        copy_options["ON_ERROR"] = self.settings.get("on_error", "abort")
149	        return (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/uploader.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	            resp_dict = self.connection.do_query(url, data)
163	            self.client_session = resp_dict.get(
164	                "session", self.connection.default_session()
165	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/uploader.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	        copy_options = {}
179	        copy_options["PURGE"] = self.settings.get("copy_purge", "False")
180	        copy_options["FORCE"] = self.settings.get("force", "False")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/uploader.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	        copy_options["PURGE"] = self.settings.get("copy_purge", "False")
180	        copy_options["FORCE"] = self.settings.get("force", "False")
181	        copy_options["SIZE_LIMIT"] = self.settings.get("size_limit", "0")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/uploader.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	        copy_options["FORCE"] = self.settings.get("force", "False")
181	        copy_options["SIZE_LIMIT"] = self.settings.get("size_limit", "0")
182	        copy_options["ON_ERROR"] = self.settings.get("on_error", "abort")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databend_py-0.6.4-py3-none-any/databend_py/uploader.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	        copy_options["SIZE_LIMIT"] = self.settings.get("size_limit", "0")
182	        copy_options["ON_ERROR"] = self.settings.get("on_error", "abort")
183	

--------------------------------------------------

Code scanned:
	Total lines of code: 1095
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 1.0
Files skipped (0):
