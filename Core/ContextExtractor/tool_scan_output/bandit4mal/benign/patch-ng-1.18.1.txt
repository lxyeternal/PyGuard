Run started:2025-04-12 13:41:04.653144

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	__license__ = "MIT"
36	__url__ = "https://github.com/conan-io/python-patch"
37	
38	import copy

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
183	def safe_unlink(filepath):
184	  os.chmod(filepath, stat.S_IWUSR | stat.S_IWGRP | stat.S_IWOTH)
185	  os.unlink(filepath)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:184
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
183	def safe_unlink(filepath):
184	  os.chmod(filepath, stat.S_IWUSR | stat.S_IWGRP | stat.S_IWOTH)
185	  os.unlink(filepath)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
219	  """
220	  ps = PatchSet( urllib_request.urlopen(url) )
221	  if ps.errors == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
275	  with open(path, 'rb') as handle:
276	    tmp = handle.read()
277	    return tmp if binary else decode_text(tmp)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
300	  with open(path, "wb") as handle:
301	    handle.write(new_content)
302	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
300	  with open(path, "wb") as handle:
301	    handle.write(new_content)
302	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
917	      # The source file must contain a line for the hunk matching to succeed.
918	      os.write(handle, b' ')
919	      os.close(handle)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
917	      # The source file must contain a line for the hunk matching to succeed.
918	      os.write(handle, b' ')
919	      os.close(handle)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/patch_ng.py:1304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1303	
1304	  opt = OptionParser(usage="1. %prog [options] unified.diff\n"
1305	                    "       2. %prog [options] http://host/patch\n"
1306	                    "       3. %prog [options] -- < unified.diff",
1307	                     version="python-patch %s" % __version__)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
18	with open(os.path.join(here, 'README.md'), encoding='utf-8') as f:
19	    long_description = f.read()
20	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	    with open(filename) as req_file:
25	        for line in req_file.read().splitlines():
26	            if not line.strip().startswith("#"):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/setup.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	    with open(filename, "rt") as version_file:
36	        content = version_file.read()
37	        version = re.search('__version__ = "([0-9a-z.-]+)"', content).group(1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/patch-ng-1.18.1/patch-ng-1.18.1/setup.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	    # The project's main homepage.
61	    url='https://github.com/conan-io/python-patch',
62	
63	    # Author details
64	    author='Conan.io',

--------------------------------------------------

Code scanned:
	Total lines of code: 1041
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 10.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 1.0
Files skipped (0):
