Run started:2025-04-12 15:16:25.126392

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/pydruid/client.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
54	            authstring = "{}:{}".format(self.username, self.password)
55	            b64string = b64encode(authstring.encode()).decode()
56	            headers["Authorization"] = "Basic {}".format(b64string)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/pydruid/client.py:55
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
54	            authstring = "{}:{}".format(self.username, self.password)
55	            b64string = b64encode(authstring.encode()).decode()
56	            headers["Authorization"] = "Basic {}".format(b64string)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/pydruid/client.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
550	            req = urllib.request.Request(url, querystr, headers)
551	            res = urllib.request.urlopen(url=req, cafile=self.cafile)
552	            data = res.read().decode("utf-8")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/pydruid/console.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	    except IndexError:
161	        url = "http://localhost:8082/druid/v2/sql/"
162	    kwargs = get_connection_kwargs(url)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/pydruid/db/api.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
358	
359	        r = requests.post(
360	            self.url,
361	            stream=True,
362	            headers=headers,
363	            json=payload,
364	            auth=auth,
365	            verify=self.ssl_verify_cert,
366	            cert=self.ssl_client_cert,
367	            proxies=self.proxies,
368	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/setup.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    packages=find_packages(),
23	    url="https://druid.apache.org",
24	    project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    project_urls={
25	        "Bug Tracker": "https://github.com/druid-io/pydruid/issues",
26	        "Documentation": "https://pythonhosted.org/pydruid/",
27	        "Source Code": "https://github.com/druid-io/pydruid",
28	    },
29	    license="Apache License, Version 2.0",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        "Bug Tracker": "https://github.com/druid-io/pydruid/issues",
26	        "Documentation": "https://pythonhosted.org/pydruid/",
27	        "Source Code": "https://github.com/druid-io/pydruid",
28	    },
29	    license="Apache License, Version 2.0",
30	    description="A Python connector for Druid.",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/setup.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        "Documentation": "https://pythonhosted.org/pydruid/",
27	        "Source Code": "https://github.com/druid-io/pydruid",
28	    },
29	    license="Apache License, Version 2.0",
30	    description="A Python connector for Druid.",
31	    long_description=long_description,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	
26	        cursor = Cursor("http://example.com/")
27	        cursor.execute("SELECT * FROM table")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	
39	        cursor = Cursor("http://example.com/")
40	        cursor.execute("SELECT * FROM table")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	
52	        url = "http://example.com/"
53	        query = "SELECT * FROM table"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	        requests_post_mock.assert_called_with(
60	            "http://example.com/",
61	            auth=None,
62	            stream=True,
63	            headers={"Content-Type": "application/json"},
64	            json={"query": query, "context": context, "header": False},
65	            verify=True,
66	            cert=None,
67	            proxies=None,
68	        )
69	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	
78	        url = "http://example.com/"
79	        query = "SELECT * FROM table"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	
98	        url = "http://example.com/"
99	        query = "SELECT * FROM table"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	
115	        url = "http://example.com/"
116	        query = "SELECT * FROM table"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	        password = "test_password"
165	        url = "http://example.com/"
166	        query = "SELECT * FROM table"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
190	        jwt = "test_jwt"
191	        url = "http://example.com/"
192	        query = "SELECT * FROM table"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
249	
250	        url = "http://example.com/"
251	        user = "test_user"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
285	
286	        url = "http://example.com/"
287	        query = "SELECT * FROM table"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
315	
316	        url = "http://example.com/"
317	        user = "user"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/db/test_cursor.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
348	
349	        url = "http://example.com/"
350	        query = "SELECT * FROM table"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/test_async_client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        client = AsyncPyDruid(
65	            "http://localhost:%s" % (self.get_http_port(),), "druid/v2/fail_request"
66	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/test_async_client.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	        client = AsyncPyDruid(
86	            "http://localhost:%s" % (self.get_http_port(),), "druid/v2/return_results"
87	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/test_async_client.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	        client = AsyncPyDruid(
111	            "http://localhost:%s" % (self.get_http_port(),), "druid/v2/return_results"
112	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/test_async_client.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	        client = AsyncPyDruid(
134	            "http://localhost:%s" % (self.get_http_port(),),
135	            "druid/v2/return_results",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/test_async_client.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	        client = AsyncPyDruid(
159	            "http://localhost:%s" % (self.get_http_port(),),
160	            "druid/v2/return_results",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/test_client.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	def create_client():
16	    return PyDruid("http://localhost:8083", "druid/v2/")
17	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/test_client.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    return urllib.error.HTTPError(
27	        url="http://fakeurl:8080/druid/v2/", hdrs={}, code=code, msg=msg, fp=fp
28	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/test_client.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	        message = textwrap.dedent(
56	            """
57	            <html>
58	            <head>

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/utils/test_query_utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	        f.close()
23	        assert file_path.read() == "value1\t㬓" + line_ending()
24	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pydruid-0.6.9/pydruid-0.6.9/tests/utils/test_query_utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
31	        assert (
32	            file_path.read()
33	            == "header1\theader2" + line_ending() + "value1\t㬓" + line_ending()

--------------------------------------------------

Code scanned:
	Total lines of code: 4554
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 5.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 1.0
Files skipped (0):
