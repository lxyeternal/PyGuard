Run started:2025-04-12 12:40:12.886446

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
271	                    with open(source_path, 'r', encoding=self._encoding) as f:
272	                        code += f.read()
273	                    break

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
314	    def _inline_svg_image(self, diagram: bytes, options: Dict[str, Optional[str]]) -> str:
315	        etree.register_namespace("", "http://www.w3.org/2000/svg")
316	        data = self.ADAPT_SVG_REGEX.sub('', diagram.decode('UTF-8'))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
328	        # Firefox handles only base64 encoded SVGs
329	        data = 'data:image/svg+xml;base64,{0}'.format(base64.b64encode(diagram).decode('ascii'))
330	        img = etree.Element('img')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:329
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
328	        # Firefox handles only base64 encoded SVGs
329	        data = 'data:image/svg+xml;base64,{0}'.format(base64.b64encode(diagram).decode('ascii'))
330	        img = etree.Element('img')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
336	        # Firefox handles only base64 encoded SVGs
337	        data = 'data:image/svg+xml;base64,{0}'.format(base64.b64encode(diagram).decode('ascii'))
338	        img = etree.Element('object')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:337
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
336	        # Firefox handles only base64 encoded SVGs
337	        data = 'data:image/svg+xml;base64,{0}'.format(base64.b64encode(diagram).decode('ascii'))
338	        img = etree.Element('object')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
345	        map_tag = ''
346	        data = 'data:image/png;base64,{0}'.format(base64.b64encode(diagram).decode('ascii'))
347	        img = etree.Element('img')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:346
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
345	        map_tag = ''
346	        data = 'data:image/png;base64,{0}'.format(base64.b64encode(diagram).decode('ascii'))
347	        img = etree.Element('img')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
413	                with open(cached_diagram_file, 'rb') as f:
414	                    diagram = f.read()
415	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
432	            with open(cached_diagram_file, 'wb') as f:
433	                f.write(diagram)
434	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
544	                    # download manually the image to be able to continue in case of errors
545	                    r = session.post(image_url, data=temp_file, headers={"Content-Type": 'text/plain; charset=utf-8'},
546	                                     verify=ssl_verify)
547	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
560	                    compressed_diag = self._deflate_and_encode(temp_file)
561	                content, err, stop = self._handle_response(session.get(f"{srv['url']}{img_format}/{compressed_diag}", verify=ssl_verify), srv)
562	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
592	
593	        return base64.b64encode(zlibbed_str[2:-4]).translate(b64_to_plantuml).decode('utf-8')
594	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:593
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
592	
593	        return base64.b64encode(zlibbed_str[2:-4]).translate(b64_to_plantuml).decode('utf-8')
594	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
597	        # diagram encoding for Kroki
598	        return base64.urlsafe_b64encode(zlib.compress(source.encode('utf-8'), 9)).decode('utf-8')
599	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/plantuml_markdown/plantuml_markdown.py:808
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
807	        # Fix to make links navigable in SVG diagrams
808	        etree.register_namespace('xlink', 'http://www.w3.org/1999/xlink')
809	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	with open(path.join(here, "README.md")) as f:
8	    long_description = f.read()
9	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/setup.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
10	with open(path.join(here, 'requirements.txt')) as f:
11	    install_requirements = f.read().splitlines()
12	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	with open(path.join(here, 'test-requirements.txt')) as f:
14	    test_requirements = f.read().splitlines()
15	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    keywords=['Markdown', 'typesetting', 'include', 'plugin', 'extension'],
25	    url="https://github.com/mikitex70/plantuml-markdown",
26	    packages=['plantuml_markdown'],

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/test/test_plantuml.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	        with open(os.path.join(dir_path, 'data', filename), 'r') as f:
52	            return f.read()[:-1]  # skip the last newline
53	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/test/test_plantuml.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
158	        with open(defs_file, 'w') as f:
159	            f.write('A --> B')
160	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/test/test_plantuml.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
158	        with open(defs_file, 'w') as f:
159	            f.write('A --> B')
160	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/test/test_plantuml.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
402	        """
403	        text = self.text_builder.diagram('A --> B [[https://www.google.fr]]').build()
404	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/test/test_plantuml.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
404	        self.assertEqual(
405	            self._stripImageData("""<p><img alt="uml diagram" class="uml" src="data:image/png;base64,%s" title="" usemap="test" /><map id="test" name="test">
406	<area shape="rect" id="id1" href="https://www.google.fr" title="https://www.google.fr" alt="" coords="1,2,3,4" />
407	</map></p>""" % self.FAKE_IMAGE),
408	            self.UUID_REGEX.sub('"test"', self.COORDS_REGEX.sub(' coords="1,2,3,4"', self._stripImageData(self.md.convert(text)))))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/test/test_plantuml.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
424	
425	        text = self.text_builder.diagram('A --> B [[https://www.google.fr]]').build()
426	        result = self._stripImageData(self.md.convert(text))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/test/test_plantuml.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
664	        with open(defs_file, 'w') as f:
665	            f.write('A --> B')
666	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/test/test_plantuml.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
664	        with open(defs_file, 'w') as f:
665	            f.write('A --> B')
666	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/plantuml_markdown-3.11.1/plantuml_markdown-3.11.1/test/test_plantuml.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
765	        """
766	        self._server_render('unused.puml', f"""
767	@startuml

--------------------------------------------------

Code scanned:
	Total lines of code: 1410
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 4.0
Files skipped (0):
