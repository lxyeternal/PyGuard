Run started:2025-04-12 17:04:31.938492

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/env.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	
19	LIGHTNING_CLOUD_URL = os.getenv("LIGHTNING_CLOUD_URL", "https://lightning.ai")
20	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/login.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	        for key in Keys:
44	            setattr(self, key.suffix, os.environ.get(key.value, None))
45	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/login.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	            for key in Keys:
68	                setattr(self, key.suffix, credentials.get(key.suffix, None))
69	            return True

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/login.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
106	            token = f"{self.user_id}:{self.api_key}"
107	            return f"Basic {base64.b64encode(token.encode('ascii')).decode('ascii')}"  # noqa E501
108	        raise AttributeError(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/login.py:107
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
106	            token = f"{self.user_id}:{self.api_key}"
107	            return f"Basic {base64.b64encode(token.encode('ascii')).decode('ascii')}"  # noqa E501
108	        raise AttributeError(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/login.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	    def get_auth_url(self, port: int) -> str:
144	        redirect_uri = f"http://localhost:{port}/login-complete"
145	        params = urlencode(dict(redirectTo=redirect_uri))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/login.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	
169	        @app.get("/login-complete")
170	        async def save_token(request: Request,

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/openapi/api_client.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
91	        if self._pool is None:
92	            self._pool = ThreadPool()
93	        return self._pool

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/openapi/api_client.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
457	                        filename = os.path.basename(f.name)
458	                        filedata = f.read()
459	                        mimetype = (mimetypes.guess_type(filename)[0] or

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/openapi/api_client.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
544	                    response_data = response_data.encode('utf-8')
545	                    f.write(response_data)
546	                else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/openapi/api_client.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
544	                    response_data = response_data.encode('utf-8')
545	                    f.write(response_data)
546	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/openapi/api_client.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
546	                else:
547	                    f.write(response_data)
548	        return path

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/openapi/api_client.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
546	                else:
547	                    f.write(response_data)
548	        return path

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/source_code/local.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
64	        try:
65	            rmtree(session_path, ignore_errors=True)
66	            copytree(self.path, session_path)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/source_code/local.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
68	        finally:
69	            rmtree(session_path, ignore_errors=True)
70	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/source_code/tar.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
151	
152	    with tarfile.open(target_file, file_mode) as tar:
153	        if os.path.isdir(source_path):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/source_code/tar.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
156	            file_info = tarfile.TarInfo(os.path.basename(str(source_path)))
157	            tar.addfile(file_info, open(source_path))
158	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/lightning_cloud/utils/network.py:8
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
7	    try:
8	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
9	            sock.bind(("", 0))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lightning_cloud-0.5.70/lightning_cloud-0.5.70/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	DESCRIPTION = 'Lightning Cloud'
8	URL = 'https://lightning.ai'
9	EMAIL = 'grid-eng@grid.ai'

--------------------------------------------------

Code scanned:
	Total lines of code: 121336
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 2.0
Files skipped (0):
