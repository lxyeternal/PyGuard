Run started:2025-04-13 07:07:57.188141

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/base.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	
31	DEFAULT_API_ENDPOINT = "https://api.civisanalytics.com/"
32	
33	
34	def tostr_urljoin(*x):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/base.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	                self.error_message = (
73	                    json.get("errorDescription") or "No Error Message Available"
74	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/base.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	def get_base_url():
101	    base_url = os.environ.get("CIVIS_API_ENDPOINT", DEFAULT_API_ENDPOINT)
102	    if not base_url.endswith("/"):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/base.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
151	                )
152	                pre_request = sess.prepare_request(request)
153	                response = retry_request(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/base.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
152	                pre_request = sess.prepare_request(request)
153	                response = retry_request(
154	                    method, pre_request, sess, self._client._retrying
155	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/base.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
183	        else:
184	            resp = self._make_request(method, path, params, data, **kwargs)
185	            resp = convert_response_data_type(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/base.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
307	    session.auth = (api_key, "")
308	    session_agent = session.headers.get("User-Agent", "")
309	    ver_string = "{}.{}.{}".format(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	_REPLACEABLE_COMMAND_CHARS = re.compile(r"[^A-Za-z0-9]+")
48	_BASE_API_URL = "https://api.civisanalytics.com"
49	CLI_USER_AGENT = "civis-cli"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
174	        request = Request(**request_info)
175	        pre_request = sess.prepare_request(request)
176	        response = retry_request(method, pre_request, sess)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
175	        pre_request = sess.prepare_request(request)
176	        response = retry_request(method, pre_request, sess)
177	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
270	        resource = path.strip("/").split("/")[0]
271	        grp = groups.get(resource)
272	        if grp is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
292	        name = make_operation_name(path, method, resource)
293	        summary = op_dict.get("summary", "")
294	        op_help = summary

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	        op_help = summary
295	        description = op_dict.get("description", "")
296	        if description:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	    # Extract properties of objects in body to make click params for them.
321	    parameters_orig = op_dict.get("parameters", [])
322	    parameters = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
325	            body_params = []
326	            req = p["schema"].get("required", [])
327	            for prop_name, prop_info in p["schema"]["properties"].items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	                    type=prop_info["type"],
331	                    description=prop_info.get("description", ""),
332	                    required=req == "all" or prop_name in req,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
344	    for p in parameters:
345	        param_type_spec = p.get("type", "string")
346	        param_type = _TYPE_MAP[param_type_spec]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/__main__.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
346	        param_type = _TYPE_MAP[param_type_spec]
347	        description = p.get("description", "")
348	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/_cli_commands.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	        with open(filename, "rt") as f:
146	            sql = f.read()
147	    elif not command:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/_cli_commands.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244	    client = civis.APIClient()
245	    info = client.notebooks.get(notebook_id)
246	    response = requests.get(info["notebook_url"], stream=True, timeout=60)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/_cli_commands.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
245	    info = client.notebooks.get(notebook_id)
246	    response = requests.get(info["notebook_url"], stream=True, timeout=60)
247	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/_cli_commands.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
251	        for lines in chunked:
252	            f.write(lines)
253	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/_cli_commands.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
270	    kwargs = {k: v for k, v in kwargs.items() if v is not None}
271	    new_nb = client.notebooks.post(language=language, **kwargs)
272	    print(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/_cli_commands.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
272	    print(
273	        "Created new {language} notebook with ID {id} in Civis Platform"
274	        " (https://platform.civisanalytics.com/#/notebooks/{id}).".format(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/_cli_commands.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
312	    client = civis.APIClient()
313	    nb = client.notebooks.get(notebook_id)
314	    state = nb["most_recent_deployment"]["state"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/cli/_cli_commands.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
328	def _notebooks_open(notebook_id):
329	    url = "https://platform.civisanalytics.com/#/notebooks/{}?fullscreen=true"
330	    url = url.format(notebook_id)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/futures.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
181	        """
182	        return f"https://platform.civisanalytics.com/spa/#/jobs/{self.job_id}"
183	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
93	def _single_upload(buf, name, client, **kwargs):
94	    file_response = client.files.post(name, **kwargs)
95	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
116	        # which can't be streamed with using requests-toolbelt anyway
117	        response = requests.post(url, files=form_key, timeout=60)
118	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
122	
123	    _post()
124	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
170	    try:
171	        pool = Pool(MAX_THREADS)
172	        _upload_part = partial(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
283	        mode = "w"
284	        if isinstance(buf.read(0), bytes):
285	            mode += "b"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
375	        client = APIClient()
376	    files_response = client.files.get(file_id)
377	    url = files_response.file_url

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
392	
393	        response = requests.get(url, stream=True, timeout=60)
394	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
396	        for lines in chunked:
397	            buf.write(lines)
398	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
396	        for lines in chunked:
397	            buf.write(lines)
398	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
515	    client = APIClient() if client is None else client
516	    file_info = client.files.get(file_id)
517	    file_url = file_info.file_url

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_files.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
694	            bytes_to_read = min(size, bytes_left)
695	        data = self.buf.read(bytes_to_read)
696	        self.bytes_read += len(data)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
384	    else:
385	        response = requests.get(url, stream=True, timeout=60)
386	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
499	
500	    delimiter = DELIMITERS.get(delimiter)
501	    if not delimiter:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
659	        client = APIClient()
660	    delimiter = DELIMITERS.get(delimiter)
661	    if not delimiter:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
821	
822	    headers = False if kwargs.get("header") is False else True
823	    with TemporaryDirectory() as tmp_dir:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1154	    if delimiter is not None:  # i.e. it was provided as an argument
1155	        delimiter = DELIMITERS.get(delimiter)
1156	        if not delimiter:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1192	    if table_columns:
1193	        sql_type_cnt = sum(1 for col in table_columns if col.get("sql_type"))
1194	        if sql_type_cnt == len(table_columns):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1312	    # however, our use of content-encoding is inconsistent
1313	    chunk = response.raw.read(CHUNK_SIZE)
1314	    d = zlib.decompressobj(zlib.MAX_WBITS | 32)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1322	        if write_bytes:
1323	            buf.write(d.decompress(to_decompress))
1324	        else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1322	        if write_bytes:
1323	            buf.write(d.decompress(to_decompress))
1324	        else:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
1322	        if write_bytes:
1323	            buf.write(d.decompress(to_decompress))
1324	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1324	        else:
1325	            buf.write(d.decompress(to_decompress).decode(encoding))
1326	        chunk = response.raw.read(CHUNK_SIZE)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1324	        else:
1325	            buf.write(d.decompress(to_decompress).decode(encoding))
1326	        chunk = response.raw.read(CHUNK_SIZE)

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
1324	        else:
1325	            buf.write(d.decompress(to_decompress).decode(encoding))
1326	        chunk = response.raw.read(CHUNK_SIZE)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1325	            buf.write(d.decompress(to_decompress).decode(encoding))
1326	        chunk = response.raw.read(CHUNK_SIZE)
1327	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1329	def _download_file(url, local_path, headers, compression):
1330	    response = requests.get(url, stream=True, timeout=60)
1331	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1335	        with gzip.open(local_path, "wb") as fout:
1336	            fout.write(headers)
1337	        with open(local_path, "ab") as fout:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1335	        with gzip.open(local_path, "wb") as fout:
1336	            fout.write(headers)
1337	        with open(local_path, "ab") as fout:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1342	        with open(local_path, "wb") as fout:
1343	            fout.write(headers)
1344	            _decompress_stream(response, fout)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1342	        with open(local_path, "wb") as fout:
1343	            fout.write(headers)
1344	            _decompress_stream(response, fout)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1350	            with open(tmp_path, "wb") as tmp_file:
1351	                tmp_file.write(headers)
1352	                _decompress_stream(response, tmp_file)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1350	            with open(tmp_path, "wb") as tmp_file:
1351	                tmp_file.write(headers)
1352	                _decompress_stream(response, tmp_file)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1357	                    arcname = arcname.split(".")[0] + ".csv"
1358	                fout.write(tmp_path, arcname, zipfile.ZIP_DEFLATED)
1359	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1357	                    arcname = arcname.split(".")[0] + ".csv"
1358	                fout.write(tmp_path, arcname, zipfile.ZIP_DEFLATED)
1359	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1365	            return
1366	        outputs = future.result().get("output")
1367	        if not outputs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1446	            fid,
1447	            client.files.get(fid).name,
1448	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1465	        # `objs` is guaranteed to have exactly one file output.
1466	        f = client.files.get(objs[0].object_id)
1467	        files.append(_File(id=f.id, name=f.name, detected_info=f.detected_info))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1544	    for i, cols in enumerate(cols_by_col, 1):
1545	        col_name = next((c.get("name") for c in cols if c.get("name")), f"column_{i}")
1546	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/io/_tables.py:1545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1544	    for i, cols in enumerate(cols_by_col, 1):
1545	        col_name = next((c.get("name") for c in cols if c.get("name")), f"column_{i}")
1546	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/ml/_model.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
194	    finally:
195	        shutil.rmtree(tempdir)
196	    return obj

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/ml/_model.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1044	            finally:
1045	                shutil.rmtree(tempdir)
1046	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/ml/_model.py:1365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1364	            finally:
1365	                shutil.rmtree(tempdir)
1366	        train_args["MODEL"] = self.model

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/ml/_model.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1379	                finally:
1380	                    shutil.rmtree(tempdir)
1381	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/parallel.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	
163	    if not os.environ.get("CIVIS_JOB_ID"):
164	        raise RuntimeError("This function must be run inside a container job.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/parallel.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
381	    if setup_cmd is None:
382	        if kwargs.get("repo_http_uri"):
383	            setup_cmd = _DEFAULT_REPO_SETUP_CMD

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/parallel.py:830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
829	        if self.from_template_id:
830	            self.executor = CustomScriptExecutor(
831	                self.from_template_id, client=self.client, **self.executor_kwargs
832	            )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/parallel.py:834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
833	        else:
834	            self.executor = _ContainerShellExecutor(
835	                client=self.client, **self.executor_kwargs
836	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
46	    with open(client_pyi_path, "w") as f:
47	        f.write(
48	            """# This file is auto-generated by tools/update_civis_api_spec.py.
49	# Do not edit it by hand.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	        for endpoint_name, endpoint_class in classes.items():
63	            f.write(f"class {_get_endpoint_class_name(endpoint_name)}:\n")
64	            method_defs = []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	                method_defs.append(method_def)
98	            f.write("\n".join(method_defs))
99	            f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	            f.write("\n".join(method_defs))
99	            f.write("\n")
100	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
102	            if len(line1 := f"class {response_class.__name__}(Response):") <= 88:
103	                f.write(f"{line1}\n")
104	            elif len(line2 := f"class {response_class.__name__}(") <= 88:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
104	            elif len(line2 := f"class {response_class.__name__}(") <= 88:
105	                f.write(f"{line2}\n    Response\n):\n")
106	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	            else:
107	                f.write(
108	                    f"class {response_class.__name__}(  # noqa: E501\n"
109	                    "    Response\n):\n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	                if len(line := f"    {name}: {anno_str}") <= 88:
121	                    f.write(f"{line}\n")
122	                elif anno_str.startswith("List"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
122	                elif anno_str.startswith("List"):
123	                    f.write(f"    {name}: List[\n        {inner_anno_str}\n    ]\n")
124	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
124	                else:
125	                    f.write(f"    {name}: (\n        {anno_str}\n    )\n")
126	            f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
125	                    f.write(f"    {name}: (\n        {anno_str}\n    )\n")
126	            f.write("\n")
127	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	
128	        f.write(
129	            """# Need the individual endpoint classes defined first as above,
130	# before we can define APIClient to use them.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_client_pyi.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	        for endpoint_name in classes:
171	            f.write(
172	                f"    {endpoint_name} = {_get_endpoint_class_name(endpoint_name)}()\n"  # noqa: E501
173	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	def get_properties(x):
75	    return x.get("properties") or x.get("items", {}).get("properties")
76	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	def get_properties(x):
75	    return x.get("properties") or x.get("items", {}).get("properties")
76	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	def get_properties(x):
75	    return x.get("properties") or x.get("items", {}).get("properties")
76	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	    )
86	    fmt = props.get("format")
87	    return "{} ({})".format(t, fmt) if get_format and fmt else t

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	    docs.append(name_and_type_doc(name, prop, level, optional, in_returned_object))
119	    doc_str = prop.get("description")
120	    if doc_str:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
158	    response_code, response_object = next(iter(responses.items()))
159	    schema = response_object.get("schema", {})
160	    properties = get_properties(schema)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	    response_object = next(iter(responses.values()))
182	    schema = response_object.get("schema", {})
183	    properties = get_properties(schema)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244	    if main_type == "List":
245	        items = param.get("items", {})
246	        if "type" in items:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	    param_type = type_from_param(param)
266	    desc = param.get("description")
267	    optional = "" if param["required"] else ", optional"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
343	        if param["required"]:
344	            args[name] = {"type": param.get("type")}
345	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
346	            optional_args[name] = {
347	                "default": param.get("default", DEFAULT_ARG_VALUE),
348	                "type": param.get("type"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
347	                "default": param.get("default", DEFAULT_ARG_VALUE),
348	                "type": param.get("type"),
349	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
416	        arguments = sig.bind(*args, **kwargs).arguments
417	        if arguments.get("kwargs"):
418	            arguments.update(arguments.pop("kwargs"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
474	        if not req:
475	            a["default"] = param.get("default", DEFAULT_ARG_VALUE)
476	        args.append(a)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
520	        raise
521	    req = schema.get("required", [])
522	    arguments = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
535	        if not is_req:
536	            a["default"] = prop.get("default", DEFAULT_ARG_VALUE)
537	        arguments.append(a)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
579	    summary = operation["summary"]
580	    params = operation.get("parameters", [])
581	    responses = operation["responses"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
581	    responses = operation["responses"]
582	    deprecation_warning = operation.get("x-deprecation-warning", None)
583	    if "deprecated" in summary.lower():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
647	        class_name = base_path.title()
648	        if methods and classes.get(base_path) is None:
649	            cls = type(class_name, (Endpoint,), {})

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
679	            request = Request("GET", "{}endpoints".format(get_base_url()))
680	            pre_request = sess.prepare_request(request)
681	            response = retry_request("get", pre_request, sess)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/resources/_resources.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
680	            pre_request = sess.prepare_request(request)
681	            response = retry_request("get", pre_request, sess)
682	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/response.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	        self.calls_remaining = (
134	            int(x) if (x := (headers or {}).get("X-RateLimit-Remaining")) else x
135	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/response.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	        self.rate_limit = (
137	            int(x) if (x := (headers or {}).get("X-RateLimit-Limit")) else x
138	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/response.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	                if key == "value" and (
148	                    from_json_values or json_data.get("objectType") == "JSONValue"
149	                ):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/response.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
380	        while True:
381	            response = self._endpoint._make_request("GET", self._path, self._params)
382	            page_data = _response_to_json(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/service_client.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	        api_client = APIClient()
21	    service = api_client.services.get(client._service_id)
22	    return service

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/service_client.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	    # Make request for adding Authentication Cookie to session
29	    session.get(auth_url)
30	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/service_client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	        class_name = to_camelcase(base_path)
72	        if methods and classes.get(base_path) is None:
73	            classes[base_path] = type(str(class_name), (ServiceEndpoint,), {})

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/service_client.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
99	            with self._lock:
100	                response = sess.request(method, url, json=data, params=params, **kwargs)
101	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/service_client.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
172	            auth_service_session(sess, self)
173	            response = sess.get(swagger_url)
174	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/workflows/_schemas.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	TASK_SCHEMA = {
146	    "$schema": "https://json-schema.org/draft/2020-12/schema",
147	    "type": "object",
148	    "properties": {
149	        "name": {
150	            "type": "string",
151	            "maxLength": 255,
152	            "not": {"enum": ["noop", "fail", "succeed", "pause"]},
153	        },
154	        "description": {"type": "string"},
155	        "action": {
156	            "type": "string",
157	            "enum": [
158	                "civis.scripts.python3",
159	                "civis.scripts.r",
160	                "civis.scripts.sql",
161	                "civis.scripts.javascript",
162	                "civis.scripts.container",
163	                "civis.scripts.dbt",
164	                "civis.scripts.custom",
165	                "civis.enhancements.cass_ncoa",
166	                "civis.import",
167	                "civis.run_job",
168	                "civis.workflows.execute",
169	                "std.async_noop",
170	                "std.echo",
171	                "std.fail",
172	                "std.noop",
173	            ],
174	        },
175	        "input": {"type": "object"},
176	        "publish": {"type": "object"},
177	        "publish-on-error": {"type": "object"},
178	        "on-success": TASK_TRANSITION_SCHEMA,
179	        "on-error": TASK_TRANSITION_SCHEMA,
180	        "on-complete": TASK_TRANSITION_SCHEMA,
181	        "join": {
182	            "oneOf": [
183	                {"const": "all"},
184	                {"type": "integer", "minimum": 1},
185	            ],
186	        },
187	        "requires": {"type": "array"},
188	        "with-items": {
189	            "oneOf": [
190	                {"type": "string"},
191	                {"type": "array", "items": {"type": "string"}},
192	            ],
193	        },
194	        "keep-result": {"type": "boolean"},
195	        "target": {"type": "string"},
196	        "pause-before": {"type": "boolean"},
197	        "wait-before": {"type": "number", "minimum": 0},
198	        "wait-after": {"type": "number", "minimum": 0},
199	        "fail-on": {"type": "string"},
200	        "timeout": {"type": "number", "minimum": 0},
201	        "retry": {
202	            "oneOf": [
203	                {"type": "string"},
204	                {
205	                    "type": "object",
206	                    "properties": {
207	                        "count": {"type": "number", "minimum": 0},
208	                        "delay": {"type": "number", "minimum": 0},
209	                        "break-on": {"type": "string"},
210	                        "continue-on": {"type": "string"},
211	                    },
212	                },
213	            ],
214	        },
215	        "concurrency": {"type": "number", "minimum": 1},
216	        "safe-rerun": {"type": "boolean"},
217	    },
218	    "required": ["action"],
219	    "allOf": [
220	        # If "action" is one of the Civis-defined ones,
221	        # then the allowed properties under "input" closely mirror the relevant
222	        # API endpoint method.
223	        _if_then_create_script("civis.scripts.python3"),
224	        _if_then_create_script("civis.scripts.r"),
225	        _if_then_create_script("civis.scripts.sql"),
226	        _if_then_create_script("civis.scripts.javascript"),
227	        _if_then_create_script("civis.scripts.container"),
228	        _if_then_create_script("civis.scripts.dbt"),
229	        _if_then_create_script("civis.scripts.custom"),
230	        _if_then_create_script("civis.enhancements.cass_ncoa"),
231	        _if_then_execute("civis.run_job", "job_id"),
232	        _if_then_execute("civis.workflows.execute", "workflow_id"),
233	        _if_then_import(),
234	    ],
235	    "additionalProperties": False,
236	}
237	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/src/civis/workflows/_schemas.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	WORKFLOW_SCHEMA = {
240	    "$schema": "https://json-schema.org/draft/2020-12/schema",
241	    "type": "object",
242	    "properties": {"version": {"const": "2.0"}},
243	    "patternProperties": {
244	        "^(?:(?!version).)*$": {
245	            "type": "object",
246	            "properties": {
247	                "type": {"type": "string"},
248	                "description": {"type": "string"},
249	                "input": {
250	                    "type": "array",
251	                    "items": {"oneOf": [{"type": "string"}, {"type": "object"}]},
252	                },
253	                "output": {},
254	                "output-on-error": {},
255	                "task-defaults": {
256	                    k: v for k, v in TASK_SCHEMA.items() if k != "required"
257	                },
258	                "tasks": {
259	                    "type": "object",
260	                    "patternProperties": {"^.*$": TASK_SCHEMA},
261	                    "minProperties": 1,
262	                },
263	            },
264	            "required": ["tasks"],
265	            "additionalProperties": True,  # Allow anchor definitions.
266	        },
267	    },
268	    "required": ["version"],
269	    "minProperties": 2,
270	    "maxProperties": 2,
271	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_base.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	def test_base_url_default():
11	    assert get_base_url() == "https://api.civisanalytics.com/"
12	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_base.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	def test_base_url_from_env():
15	    custom_url = "https://api1.civisanalytics.com"
16	    with mock.patch.dict("os.environ", {"CIVIS_API_ENDPOINT": custom_url}):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_base.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	
25	    assert endpoint._base_url == "https://base.api.url/"
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_base.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	@mock.patch("civis.base.get_base_url", return_value="https://base.api.url/")
21	def test_endpoint_base_url(mock_get_base_url):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_cli.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	    mock_request.assert_called_with(
160	        url="https://api.civisanalytics.com/wobble/wubble",
161	        json={},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_futures.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	    assert result.job_url == (
161	        f"https://platform.civisanalytics.com/spa/#/jobs/{expected_job_id}"
162	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_futures.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	    assert result.run_id == run_id
174	    assert result.job_url == f"https://platform.civisanalytics.com/spa/#/jobs/{job_id}"
175	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_futures.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	    # Verify that this script's job and run ID are passed to arguments
190	    args = c.scripts.post_custom.call_args[1].get("arguments")
191	    for k, v in (("CIVIS_PARENT_JOB_ID", "12"), ("CIVIS_PARENT_RUN_ID", "40")):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_futures.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	    for k, v in (("CIVIS_PARENT_JOB_ID", "12"), ("CIVIS_PARENT_RUN_ID", "40")):
192	        assert args.get(k) == v
193	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_futures.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	    params = sorted(
214	        c.scripts.post_containers.call_args[1].get("params"), key=itemgetter("name")
215	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	    buf = BytesIO()
63	    buf.write(b"a,b,c\n1,2,3")
64	    buf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
62	    buf = BytesIO()
63	    buf.write(b"a,b,c\n1,2,3")
64	    buf.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
95	    buf = StringIO()
96	    buf.write("a,b,c\n1,2,3")
97	    buf.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
95	    buf = StringIO()
96	    buf.write("a,b,c\n1,2,3")
97	    buf.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	        with open(fname, "w+b") as tmp:
113	            tmp.write(b"a,b,c\n1,2,3")
114	        with open(fname, "r+b") as tmp:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
112	        with open(fname, "w+b") as tmp:
113	            tmp.write(b"a,b,c\n1,2,3")
114	        with open(fname, "r+b") as tmp:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
186	    buf.seek(0)
187	    assert buf.read() == b"a,b,c\n1,2,3"
188	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1067	    # We need to write some JSON into the buffer to avoid errors.
1068	    m_civis_to_file.side_effect = lambda _, buf, *args, **kwargs: buf.write(b"{}")
1069	    mock_client = mock.MagicMock()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1067	    # We need to write some JSON into the buffer to avoid errors.
1068	    m_civis_to_file.side_effect = lambda _, buf, *args, **kwargs: buf.write(b"{}")
1069	    mock_client = mock.MagicMock()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1113	        with open(fname, "w") as tmp:
1114	            tmp.write(expected)
1115	        civis.io._tables._download_file("test_url", fname, b"", "none")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1113	        with open(fname, "w") as tmp:
1114	            tmp.write(expected)
1115	        civis.io._tables._download_file("test_url", fname, b"", "none")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1116	        with open(fname, "r") as f:
1117	            data = f.read()
1118	    assert data == expected

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1265	    def _dump_json(file_id, buf, *args, **kwargs):
1266	        buf.write(json.dumps(obj).encode())
1267	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1265	    def _dump_json(file_id, buf, *args, **kwargs):
1266	        buf.write(json.dumps(obj).encode())
1267	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1284	        with open(fname, "rt") as _fin:
1285	            assert _fin.read() == "abcdef"
1286	    mock_civis.files.get.assert_called_once_with(137)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1323	    buf.seek(0)
1324	    assert buf.read() == b"0123abcdef"
1325	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1343	        with open(fname, "wt") as _fout:
1344	            _fout.write("abcdef")
1345	        fid = _files.file_to_civis(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1343	        with open(fname, "wt") as _fout:
1344	            _fout.write("abcdef")
1345	        fid = _files.file_to_civis(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1358	        with open(file_path, "wb") as f:
1359	            f.write(b"foobar")
1360	        with pytest.raises(ValueError, match="longer than 512 characters"):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1358	        with open(file_path, "wb") as f:
1359	            f.write(b"foobar")
1360	        with pytest.raises(ValueError, match="longer than 512 characters"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1581	        with open(tmp_csv_path, "wb") as f:
1582	            f.write(gzip.compress(expected_data.encode("utf-8")))
1583	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py:1582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1581	        with open(tmp_csv_path, "wb") as f:
1582	            f.write(gzip.compress(expected_data.encode("utf-8")))
1583	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170	    assert mock_backend.call_count == 1
171	    assert mock_backend.call_args_list[0][1].get("from_template_id") == 1234
172	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	    assert mock_backend.call_count == 1
182	    assert mock_backend.call_args_list[0][1].get("setup_cmd") == "sample"
183	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	    assert mock_backend.call_count == 1
193	    assert mock_backend.call_args_list[0][1].get("setup_cmd") == ":"
194	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	    assert (
205	        mock_backend.call_args_list[0][1].get("setup_cmd")
206	        == "cd /app; pip install .; cd /"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
406	
407	    assert res.get() == "spam"
408	    assert callback.call_count == 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
437	    with pytest.raises(ZeroDivisionError):
438	        res.get()
439	    assert callback.call_count == 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
455	    with pytest.raises(CivisJobFailure) as exc:
456	        res.get()
457	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
477	    with pytest.raises(ZeroDivisionError):
478	        res.get()
479	    assert callback.call_count == 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
496	
497	    assert res.get() == "spam"
498	    assert callback.call_count == 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_parallel.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
515	    with pytest.raises(requests.ConnectionError):
516	        res.get()
517	    assert callback.call_count == 0

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_resources.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
692	        generate_client_pyi(test_client_pyi_path, API_SPEC_PATH)
693	        actual = open(CLIENT_PYI_PATH).read()
694	        expected = open(test_client_pyi_path).read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_resources.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
693	        actual = open(CLIENT_PYI_PATH).read()
694	        expected = open(test_client_pyi_path).read()
695	        match = expected == actual

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_response.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
423	    assert response.json_data == json_data
424	    assert response.get("foo") == 123
425	    assert response.bar.get("baz_qux") == response.bar.get("bazQux") == 456

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_response.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
424	    assert response.get("foo") == 123
425	    assert response.bar.get("baz_qux") == response.bar.get("bazQux") == 456
426	    assert response.get("doesn't exist") is None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_response.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
424	    assert response.get("foo") == 123
425	    assert response.bar.get("baz_qux") == response.bar.get("bazQux") == 456
426	    assert response.get("doesn't exist") is None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_response.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
425	    assert response.bar.get("baz_qux") == response.bar.get("bazQux") == 456
426	    assert response.get("doesn't exist") is None
427	    assert response.get("doesn't exist", "fallback value") == "fallback value"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_response.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
426	    assert response.get("doesn't exist") is None
427	    assert response.get("doesn't exist", "fallback value") == "fallback value"
428	    assert response.bar.get("doesn't exist") is None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_response.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
427	    assert response.get("doesn't exist", "fallback value") == "fallback value"
428	    assert response.bar.get("doesn't exist") is None
429	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_service_client.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
317	
318	    response = se._make_request("get", "resources/resources")
319	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	            json={},
35	            url="https://api.civisanalytics.com/wobble/wubble",
36	            method=verb,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
38	        request = Request(**request_info)
39	        pre_request = session_context.prepare_request(request)
40	        retry_request(verb, pre_request, session_context, _get_retrying(3))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
39	        pre_request = session_context.prepare_request(request)
40	        retry_request(verb, pre_request, session_context, _get_retrying(3))
41	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	            json={},
60	            url="https://api.civisanalytics.com/wobble/wubble",
61	            method=verb,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
63	        request = Request(**request_info)
64	        pre_request = session_context.prepare_request(request)
65	        retry_request(verb, pre_request, session_context, _get_retrying(max_calls))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
64	        pre_request = session_context.prepare_request(request)
65	        retry_request(verb, pre_request, session_context, _get_retrying(max_calls))
66	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	                json={},
86	                url="https://api.civisanalytics.com/wobble/wubble",
87	                method=verb,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
90	            request = Request(**request_info)
91	            pre_request = session_context.prepare_request(request)
92	            retry_request(verb, pre_request, session_context, _get_retrying(max_calls))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
91	            pre_request = session_context.prepare_request(request)
92	            retry_request(verb, pre_request, session_context, _get_retrying(max_calls))
93	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	                json={},
113	                url="https://api.civisanalytics.com/wobble/wubble",
114	                method=verb.lower(),

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
117	            request = Request(**request_info)
118	            pre_request = session_context.prepare_request(request)
119	            retry_request(verb, pre_request, session_context, _get_retrying(max_calls))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
118	            pre_request = session_context.prepare_request(request)
119	            retry_request(verb, pre_request, session_context, _get_retrying(max_calls))
120	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	        json={},
137	        url="https://api.civisanalytics.com/wobble/wubble",
138	        method="POST",

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
140	    request = Request(**request_info)
141	    pre_request = session_context.prepare_request(request)
142	    retry_request("post", pre_request, session_context, _get_retrying(max_calls))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
141	    pre_request = session_context.prepare_request(request)
142	    retry_request("post", pre_request, session_context, _get_retrying(max_calls))
143	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	            json={},
163	            url="https://api.civisanalytics.com/wobble/wubble",
164	            method="POST",

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
166	        request = Request(**request_info)
167	        pre_request = session_context.prepare_request(request)
168	        retry_request("post", pre_request, session_context, _get_retrying(max_calls))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
167	        pre_request = session_context.prepare_request(request)
168	        retry_request("post", pre_request, session_context, _get_retrying(max_calls))
169	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	            json={},
186	            url="https://api.civisanalytics.com/wobble/wubble",
187	            method=verb,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
189	        request = Request(**request_info)
190	        pre_request = session_context.prepare_request(request)
191	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
193	        try:
194	            retry_request(verb, pre_request, session_context, _get_retrying(3))
195	        except ConnectionError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	            json={},
234	            url="https://api.civisanalytics.com/wobble/wubble",
235	            method=verb,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
238	        request = Request(**request_info)
239	        pre_request = session_context.prepare_request(request)
240	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_utils.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
241	        start_time = datetime.now().timestamp()
242	        retry_request(verb, pre_request, session_context, _get_retrying(max_calls))
243	        end_time = datetime.now().timestamp()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_version.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
11	    """__version__ and CHANGELOG.md match for the latest version number."""
12	    changelog = open(os.path.join(_REPO_DIR, "CHANGELOG.md")).read()
13	    version_in_changelog = re.search(r"##\s+(\d+\.\d+\.\d+)", changelog).groups()[0]

--------------------------------------------------

Code scanned:
	Total lines of code: 13548
	Total lines skipped (#nosec): 6

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 173.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 195.0
		High: 0.0
Files skipped (0):
