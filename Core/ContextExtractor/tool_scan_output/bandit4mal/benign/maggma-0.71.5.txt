Run started:2025-04-12 13:48:00.664023

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/api/API.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
110	
111	    def run(self, ip: str = "127.0.0.1", port: int = 8000, log_level: str = "info"):
112	        """

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/api/utils.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
174	    elif isinstance(obj, bytes):
175	        return base64.b64encode(obj).decode("utf-8")
176	    raise TypeError

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/api/utils.py:175
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
174	    elif isinstance(obj, bytes):
175	        return base64.b64encode(obj).decode("utf-8")
176	    raise TypeError

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:25
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
24	def find_port():
25	    sock = pysocket.socket()
26	    sock.bind(("", 0))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
56	        try:
57	            builder.connect()
58	            chunk_dicts = [{"chunk": d, "distributed": False, "completed": False} for d in builder.prechunk(num_chunks)]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
80	            if num_workers <= 0:
81	                socket.close()
82	                raise RuntimeError("No workers to distribute chunks to")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
176	        socket.send_multipart([identity, b"", b"EXIT"])
177	    socket.close()
178	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
223	    socket.setsockopt_string(zmq.IDENTITY, identity)
224	    socket.connect(f"{url}:{port}")
225	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
229	    # Initial message package
230	    hostname = pysocket.gethostname()
231	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:230
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
229	    # Initial message package
230	    hostname = pysocket.gethostname()
231	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
234	        while running:
235	            socket.send(f"READY_{hostname}".encode())
236	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
239	            if not connections:
240	                socket.close()
241	                raise RuntimeError("Stopping work as manager timed out.")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
242	
243	            bmessage: bytes = socket.recv()
244	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
265	        logger.error(f"A worker failed with error: {e}")
266	        socket.send(f"ERROR_{e}".encode())
267	        socket.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
266	        socket.send(f"ERROR_{e}".encode())
267	        socket.close()
268	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
268	
269	    socket.close()
270	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
277	    if not connections:
278	        socket.close()
279	        raise RuntimeError("Stopping work as manager timed out.")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
280	
281	    message: bytes = socket.recv()
282	    if message.decode("utf-8") != "PONG":

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/distributed.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
282	    if message.decode("utf-8") != "PONG":
283	        socket.close()
284	        raise RuntimeError("Stopping work as manager did not respond to heartbeat from worker.")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/multiprocessing.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
157	    cursor = builder.get_items()
158	    executor = ProcessPoolExecutor(num_processes)
159	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/rabbitmq.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
29	def find_port():
30	    sock = pysocket.socket()
31	    sock.bind(("", 0))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/rabbitmq.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
67	        try:
68	            builder.connect()
69	            chunk_dicts = [{"chunk": d, "distributed": False, "completed": False} for d in builder.prechunk(num_chunks)]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/rabbitmq.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
91	            if num_workers <= 0:
92	                connection.close()
93	                raise RuntimeError("No workers to distribute chunks to")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/rabbitmq.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
188	        )
189	    connection.close()
190	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/rabbitmq.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
300	        )
301	        connection.close()
302	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/rabbitmq.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
302	
303	    connection.close()
304	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/settings.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
7	
8	tempdir = "/tmp" if platform.system() == "Darwin" else tempfile.gettempdir()
9	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/settings.py:8
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
7	
8	tempdir = "/tmp" if platform.system() == "Darwin" else tempfile.gettempdir()
9	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/cli/source_loader.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
73	                    # run the code in themodule
74	                    exec(code, module.__dict__)
75	        finally:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/advanced_stores.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
173	        # Read the vault secret
174	        json_db_creds = client.read(vault_secret_path)
175	        db_creds = json.loads(json_db_creds["data"]["value"])

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/aws.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
234	        if compressed:
235	            data = zlib.decompress(data)
236	        # requires msgpack-python to be installed to fix string encoding problem

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/aws.py:235
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
234	        if compressed:
235	            data = zlib.decompress(data)
236	        # requires msgpack-python to be installed to fix string encoding problem

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/aws.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
342	        """
343	        with ThreadPoolExecutor(max_workers=self.s3_workers) as pool:
344	            fs = {

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/azure.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
256	        if compressed:
257	            data = zlib.decompress(data)
258	        # requires msgpack-python to be installed to fix string encoding problem

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/azure.py:257
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
256	        if compressed:
257	            data = zlib.decompress(data)
258	        # requires msgpack-python to be installed to fix string encoding problem

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/azure.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
359	
360	        with ThreadPoolExecutor(max_workers=self.workers) as pool:
361	            fs = {

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/azure.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
396	        """
397	        if threading.current_thread().name == "MainThread":
398	            return self.container

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/azure.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
538	            if self.compress:
539	                data = zlib.decompress(data)
540	            unpacked_data = msgpack.unpackb(data, raw=False)

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/azure.py:539
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
538	            if self.compress:
539	                data = zlib.decompress(data)
540	            unpacked_data = msgpack.unpackb(data, raw=False)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/file_store.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
292	        super().connect(force_reset=force_reset)
293	        super().update(self.read())
294	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/file_store.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
329	        if len(requests) > 0:
330	            self._collection.bulk_write(requests, ordered=False)
331	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/file_store.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
445	                        with zopen(d["path"], mode="rt", encoding=self.encoding) as f:
446	                            data = f.read()
447	                    except Exception as e:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/gridfs.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
265	                if metadata.get("compression", "") == "zlib":
266	                    data = zlib.decompress(data).decode("UTF-8")
267	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/gridfs.py:266
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
265	                if metadata.get("compression", "") == "zlib":
266	                    data = zlib.decompress(data).decode("UTF-8")
267	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/mongolike.py:796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
795	    MontyClient is not None,
796	    "MontyStore requires MontyDB to be installed. See the MontyDB repository for more "
797	    "information: https://github.com/davidlatwe/montydb",
798	)
799	class MontyStore(MemoryStore):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/shared_stores.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
606	        MultiStoreManager.register("MultiStore", callable=lambda: multistore)
607	        m = MultiStoreManager(address=("127.0.0.1", 0), authkey=b"abcd")
608	        m.start()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/ssh_tunnel.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
46	            if local_port is None:
47	                local_port = _find_free_port("127.0.0.1")
48	            local_bind_address = ("127.0.0.1", local_port)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/ssh_tunnel.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
47	                local_port = _find_free_port("127.0.0.1")
48	            local_bind_address = ("127.0.0.1", local_port)
49	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/ssh_tunnel.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
86	
87	def _find_free_port(address="0.0.0.0"):
88	    s = socket()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/stores/ssh_tunnel.py:88
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
87	def _find_free_port(address="0.0.0.0"):
88	    s = socket()
89	    s.bind((address, 0))  # Bind to a free port provided by the host.

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/utils.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
198	        if self.seconds:
199	            signal.signal(signal.SIGALRM, self.handle_timeout)
200	            signal.alarm(self.seconds)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/src/maggma/utils.py:199
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
198	        if self.seconds:
199	            signal.signal(signal.SIGALRM, self.handle_timeout)
200	            signal.alarm(self.seconds)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_api.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	        print(url)
132	    res = client.get(url)
133	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_api.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	    try:
134	        data = res.json().get("data", [])
135	    except json.decoder.JSONDecodeError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_read_resource.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	
84	    assert client.get("/").status_code == 200
85	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_read_resource.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	
86	    assert client.get("/Person1/").status_code == 200
87	    assert client.get("/Person1/").json()["data"][0]["name"] == "Person1"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_read_resource.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	    assert client.get("/Person1/").status_code == 200
87	    assert client.get("/Person1/").json()["data"][0]["name"] == "Person1"
88	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_read_resource.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	
97	    assert client.get("/Person1/").status_code == 200
98	    assert client.get("/Person1/").json()["data"][0]["name"] == "Person1"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_read_resource.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	    assert client.get("/Person1/").status_code == 200
98	    assert client.get("/Person1/").json()["data"][0]["name"] == "Person1"
99	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_read_resource.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	
109	    client.get("/?param=test").status_code
110	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_read_resource.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	        print(url)
163	    res = client.get(url)
164	    json = res.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/api/test_read_resource.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	    json = res.json()
165	    return res, json.get("data", [])  # type: ignore
166	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_distributed.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
14	
15	HOSTNAME = pysocket.gethostname()
16	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_distributed.py:15
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
14	
15	HOSTNAME = pysocket.gethostname()
16	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_distributed.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
97	    socket = context.socket(REQ)
98	    socket.connect(f"{SERVER_URL}:{SERVER_PORT}")
99	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_distributed.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
99	
100	    await socket.send(b"ERROR_testerror")
101	    await asyncio.sleep(1)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_distributed.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
115	
116	    message = await socket.recv()
117	    assert message == f"READY_{HOSTNAME}".encode()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_distributed.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
126	
127	    await socket.send(json.dumps(dummy_work).encode("utf-8"))
128	    await asyncio.sleep(1)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_distributed.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
128	    await asyncio.sleep(1)
129	    message = await socket.recv()
130	    assert message.decode("utf-8") == "ERROR_Dummy error"

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_distributed.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
144	
145	    message = await socket.recv()
146	    assert message == f"READY_{HOSTNAME}".encode()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_distributed.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
147	    await asyncio.sleep(1)
148	    await socket.send(b"EXIT")
149	    await asyncio.sleep(1)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/cli/test_multiprocessing.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
62	async def test_async_map():
63	    executor = ThreadPoolExecutor(1)
64	    amap = AsyncUnorderedMap(wait_and_return, arange(3), executor)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/conftest.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
23	    os.chdir(old_cwd)
24	    shutil.rmtree(newpath)
25	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/stores/test_advanced_stores.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
62	    os.remove(config_path)
63	    shutil.rmtree(mdpath)
64	    os.remove(mdlogpath)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/stores/test_advanced_stores.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	    """
163	    os.environ["VAULT_ADDR"] = "https://fake:8200/"
164	    os.environ["VAULT_TOKEN"] = "dummy"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/stores/test_advanced_stores.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	    # Save token in env
176	    os.environ["VAULT_ADDR"] = "https://fake:8200/"
177	    os.environ["GITHUB_TOKEN"] = "dummy"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/stores/test_advanced_stores.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
356	def vaultstore():
357	    os.environ["VAULT_ADDR"] = "https://fake:8200/"
358	    os.environ["VAULT_TOKEN"] = "dummy"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/stores/test_aws.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
441	            store._get_session()
442	            assert store._get_endpoint_url() == "http://ADDRESS:PORT"
443	            store.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/stores/test_azure.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	AZURITE_CONNECTION_STRING = (
25	    "DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;"
26	    "AccountKey="
27	    "Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq"
28	    "/K1SZFPTOtr/KBHBeksoGMGw==;"
29	    "BlobEndpoint=http://127.0.0.1:10000/devstoreaccount1;"
30	)
31	
32	AZURITE_CONTAINER_NAME = "maggma-test-container"
33	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/stores/test_ssh_tunnel.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
16	    try:
17	        client.connect("127.0.0.1", 22)
18	        client.close()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/maggma-0.71.5/maggma-0.71.5/tests/stores/test_ssh_tunnel.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
27	    try:
28	        client.connect("127.0.0.1", local_port)
29	        client.close()

--------------------------------------------------

Code scanned:
	Total lines of code: 13115
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 55.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 68.0
		High: 13.0
Files skipped (0):
