Run started:2025-04-12 14:48:26.583327

Test results:
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/client.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
198	            ))
199	            metadata, = await self._dispatch.send_request(
200	                self._metadata,
201	                method_name=self._method_name,
202	                deadline=self._deadline,
203	                content_type=content_type,
204	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/client.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
205	            headers.extend(encode_metadata(metadata))
206	            release_stream = await stream.send_request(
207	                headers, end_stream=end, _processor=protocol.processor,
208	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/client.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
241	        if not self._send_request_done:
242	            await self.send_request()
243	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/client.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
656	            if host is None:
657	                host = '127.0.0.1'
658	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/client.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
882	        """
883	        return self.channel.request(self.name, self._cardinality,
884	                                    self.request_type, self.reply_type,
885	                                    timeout=timeout, metadata=metadata)
886	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/client.py:975
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
974	            else:
975	                await stream.send_request(end=True)
976	            reply = await stream.recv_message()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/client.py:1010
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1009	            else:
1010	                await stream.send_request(end=True)
1011	            return [message async for message in stream]

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/metadata.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
17	        lib_ver=__version__,
18	        sys=platform.system(),
19	        py=platform.python_implementation(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/metadata.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
17	        lib_ver=__version__,
18	        sys=platform.system(),
19	        py=platform.python_implementation(),

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/metadata.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
127	def decode_bin_value(value: bytes) -> bytes:
128	    return b64decode(value + (b'=' * (len(value) % 4)))
129	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/metadata.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
127	def decode_bin_value(value: bytes) -> bytes:
128	    return b64decode(value + (b'=' * (len(value) % 4)))
129	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/metadata.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
143	def encode_bin_value(value: bytes) -> bytes:
144	    return b64encode(value).rstrip(b'=')
145	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/metadata.py:144
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
143	def encode_bin_value(value: bytes) -> bytes:
144	    return b64encode(value).rstrip(b'=')
145	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/plugin/main.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
212	    with os.fdopen(sys.stdin.fileno(), 'rb') as inp:
213	        request = CodeGeneratorRequest.FromString(inp.read())
214	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/plugin/main.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
259	    with os.fdopen(sys.stdout.fileno(), 'wb') as out:
260	        out.write(response.SerializeToString())

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
211	    def flush(self) -> None:
212	        data = self._connection.data_to_send()
213	        if data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
213	        if data:
214	            self._transport.write(data)
215	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
233	        if hasattr(self, '_transport'):
234	            self._transport.close()
235	            # remove cyclic references to improve memory usage

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
346	    async def recv_data(self, size: int) -> bytes:
347	        return await self.buffer.read(size)
348	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
392	                release_stream = _processor.register(self)
393	                self._transport.write(self._h2_connection.data_to_send())
394	                self.connection.headers_send_process()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
392	                release_stream = _processor.register(self)
393	                self._transport.write(self._h2_connection.data_to_send())
394	                self.connection.headers_send_process()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
412	                                         end_stream=end_stream)
413	        self._transport.write(self._h2_connection.data_to_send())
414	        self.connection.headers_send_process()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
412	                                         end_stream=end_stream)
413	        self._transport.write(self._h2_connection.data_to_send())
414	        self.connection.headers_send_process()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
432	            max_frame_size = self._h2_connection.max_outbound_frame_size
433	            f_chunk = f.read(min(window, max_frame_size, f_last - f_pos))
434	            f_chunk_len = len(f_chunk)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
439	                                              end_stream=end_stream)
440	                self._transport.write(self._h2_connection.data_to_send())
441	                self.data_sent += f_chunk_len

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
439	                                              end_stream=end_stream)
440	                self._transport.write(self._h2_connection.data_to_send())
441	                self.data_sent += f_chunk_len

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
446	                self._h2_connection.send_data(self.id, f_chunk)
447	                self._transport.write(self._h2_connection.data_to_send())
448	                self.data_sent += f_chunk_len

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
446	                self._h2_connection.send_data(self.id, f_chunk)
447	                self._transport.write(self._h2_connection.data_to_send())
448	                self.data_sent += f_chunk_len

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
454	        self._h2_connection.end_stream(self.id)
455	        self._transport.write(self._h2_connection.data_to_send())
456	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
454	        self._h2_connection.end_stream(self.id)
455	        self._transport.write(self._h2_connection.data_to_send())
456	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
459	        self._h2_connection.reset_stream(self.id, error_code=error_code)
460	        self._transport.write(self._h2_connection.data_to_send())
461	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
459	        self._h2_connection.reset_stream(self.id, error_code=error_code)
460	        self._transport.write(self._h2_connection.data_to_send())
461	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
467	        if self.connection.write_ready.is_set():
468	            self._transport.write(self._h2_connection.data_to_send())
469	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
467	        if self.connection.write_ready.is_set():
468	            self._transport.write(self._h2_connection.data_to_send())
469	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
555	    def close(self, reason: str = 'Connection closed') -> None:
556	        self.connection.close()
557	        self.handler.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
556	        self.connection.close()
557	        self.handler.close()
558	        for stream in self.streams.values():

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
658	    ) -> None:
659	        self.close(reason=(
660	            'Received GOAWAY frame, closing connection; error_code: {}'
661	            .format(event.error_code)
662	        ))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
718	            log.debug('Protocol error', exc_info=True)
719	            self.processor.close('Protocol error')
720	        else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/protocol.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
732	    def connection_lost(self, exc: Optional[BaseException]) -> None:
733	        self.processor.close(reason='Connection lost')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/server.py:727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
726	            raise RuntimeError('Server is not started')
727	        self._server.close()
728	        if not self._server_closed_fut.done():

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/server.py:731
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
730	        for handler in self._handlers:
731	            handler.close()
732	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/grpclib-0.4.8rc2/grpclib-0.4.8rc2/grpclib/server.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
754	    ) -> None:
755	        self.close()
756	        await self.wait_closed()

--------------------------------------------------

Code scanned:
	Total lines of code: 4298
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 38.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 39.0
		High: 3.0
Files skipped (0):
