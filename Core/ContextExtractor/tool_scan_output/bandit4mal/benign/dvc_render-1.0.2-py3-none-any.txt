Run started:2025-04-12 18:33:05.841742

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/plotly.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	
28	    SCRIPTS = """
29	    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
30	    """
31	
32	    # pylint: disable=W0231
33	    def __init__(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	
77	    SCRIPTS = """
78	    <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
79	    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.2.0"></script>
80	    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.18.2"></script>
81	    """
82	
83	    EXTENSIONS = {".yml", ".yaml", ".json", ".csv", ".tsv"}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
202	
203	                base64_str = base64.b64encode(output_file.getvalue()).decode()  # type: ignore[attr-defined]
204	                src = f"data:image/png;base64,{base64_str}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega.py:203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
202	
203	                base64_str = base64.b64encode(output_file.getvalue()).decode()  # type: ignore[attr-defined]
204	                src = f"data:image/png;base64,{base64_str}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega_templates.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	    DEFAULT_CONTENT = {
136	        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
137	        "data": {"values": Template.anchor("data")},
138	        "title": {"text": Template.anchor("title"), "anchor": "middle"},
139	        "width": Template.anchor("plot_width"),
140	        "height": Template.anchor("plot_height"),
141	        "mark": {"type": "bar"},
142	        "params": [Template.anchor("zoom_and_pan")],
143	        "encoding": {
144	            "x": {
145	                "field": Template.anchor("x"),
146	                "type": "quantitative",
147	                "title": Template.anchor("x_label"),
148	                "scale": {"zero": False},
149	            },
150	            "y": {
151	                "field": Template.anchor("y"),
152	                "type": "nominal",
153	                "title": Template.anchor("y_label"),
154	                "sort": "-x",
155	            },
156	            "yOffset": {"field": "rev", "sort": []},
157	            "color": Template.anchor("color"),
158	            "column": Template.anchor("column"),
159	        },
160	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega_templates.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	    DEFAULT_CONTENT = {
167	        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
168	        "data": {"values": Template.anchor("data")},
169	        "title": {"text": Template.anchor("title"), "anchor": "middle"},
170	        "width": Template.anchor("plot_width"),
171	        "height": Template.anchor("plot_height"),
172	        "mark": {"type": "bar"},
173	        "params": [Template.anchor("zoom_and_pan")],
174	        "encoding": {
175	            "x": {
176	                "field": Template.anchor("x"),
177	                "type": "quantitative",
178	                "title": Template.anchor("x_label"),
179	                "scale": {"zero": False},
180	            },
181	            "y": {
182	                "field": Template.anchor("y"),
183	                "type": "nominal",
184	                "title": Template.anchor("y_label"),
185	            },
186	            "yOffset": {"field": "rev", "sort": []},
187	            "color": Template.anchor("color"),
188	            "column": Template.anchor("column"),
189	        },
190	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega_templates.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	    DEFAULT_CONTENT = {
196	        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
197	        "data": {"values": Template.anchor("data")},
198	        "title": {"text": Template.anchor("title"), "anchor": "middle"},
199	        "facet": {
200	            "column": {"field": "rev", "sort": []},
201	            "row": Template.anchor("row"),
202	        },
203	        "params": [
204	            {
205	                "name": "showValues",
206	                "bind": {"input": "checkbox"},
207	            },
208	        ],
209	        "spec": {
210	            "transform": [
211	                {
212	                    "aggregate": [{"op": "count", "as": "xy_count"}],
213	                    "groupby": [Template.anchor("y"), Template.anchor("x")],
214	                },
215	                {
216	                    "impute": "xy_count",
217	                    "groupby": Template.anchor("group_by_y"),
218	                    "key": Template.anchor("x"),
219	                    "value": 0,
220	                },
221	                {
222	                    "impute": "xy_count",
223	                    "groupby": Template.anchor("group_by_x"),
224	                    "key": Template.anchor("y"),
225	                    "value": 0,
226	                },
227	                {
228	                    "joinaggregate": [
229	                        {"op": "max", "field": "xy_count", "as": "max_count"}
230	                    ],
231	                    "groupby": [],
232	                },
233	                {
234	                    "calculate": "datum.xy_count / datum.max_count",
235	                    "as": "percent_of_max",
236	                },
237	            ],
238	            "encoding": {
239	                "x": {
240	                    "field": Template.anchor("x"),
241	                    "type": "nominal",
242	                    "sort": "ascending",
243	                    "title": Template.anchor("x_label"),
244	                },
245	                "y": {
246	                    "field": Template.anchor("y"),
247	                    "type": "nominal",
248	                    "sort": "ascending",
249	                    "title": Template.anchor("y_label"),
250	                },
251	            },
252	            "layer": [
253	                {
254	                    "mark": "rect",
255	                    "width": Template.anchor("plot_width"),
256	                    "height": Template.anchor("plot_height"),
257	                    "encoding": {
258	                        "color": {
259	                            "field": "xy_count",
260	                            "type": "quantitative",
261	                            "title": "",
262	                            "scale": {"domainMin": 0, "nice": True},
263	                        }
264	                    },
265	                },
266	                {
267	                    "selection": {
268	                        "label": {
269	                            "type": "single",
270	                            "on": "mouseover",
271	                            "encodings": ["x", "y"],
272	                            "empty": "none",
273	                            "clear": "mouseout",
274	                        }
275	                    },
276	                    "mark": "rect",
277	                    "encoding": {
278	                        "tooltip": [
279	                            {"field": Template.anchor("x"), "type": "nominal"},
280	                            {"field": Template.anchor("y"), "type": "nominal"},
281	                            {"field": "xy_count", "type": "quantitative"},
282	                        ],
283	                        "opacity": {
284	                            "condition": {"selection": "label", "value": 1},
285	                            "value": 0,
286	                        },
287	                    },
288	                },
289	                {
290	                    "transform": [{"filter": {"selection": "label"}}],
291	                    "layer": [
292	                        {"mark": {"type": "rect", "color": "lightpink"}},
293	                    ],
294	                },
295	                {
296	                    "mark": "text",
297	                    "encoding": {
298	                        "text": {
299	                            "condition": {
300	                                "param": "showValues",
301	                                "field": "xy_count",
302	                                "type": "quantitative",
303	                            },
304	                        },
305	                        "color": {
306	                            "condition": {
307	                                "test": "datum.percent_of_max > 0.5",
308	                                "value": "white",
309	                            },
310	                            "value": "black",
311	                        },
312	                    },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega_templates.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
321	    DEFAULT_CONTENT = {
322	        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
323	        "data": {"values": Template.anchor("data")},
324	        "title": {"text": Template.anchor("title"), "anchor": "middle"},
325	        "facet": {
326	            "column": {"field": "rev", "sort": []},
327	            "row": Template.anchor("row"),
328	        },
329	        "spec": {
330	            "transform": [
331	                {
332	                    "aggregate": [{"op": "count", "as": "xy_count"}],
333	                    "groupby": [Template.anchor("y"), Template.anchor("x")],
334	                },
335	                {
336	                    "impute": "xy_count",
337	                    "groupby": ["rev", Template.anchor("y")],
338	                    "key": Template.anchor("x"),
339	                    "value": 0,
340	                },
341	                {
342	                    "impute": "xy_count",
343	                    "groupby": Template.anchor("group_by_x"),
344	                    "key": Template.anchor("y"),
345	                    "value": 0,
346	                },
347	                {
348	                    "joinaggregate": [
349	                        {"op": "sum", "field": "xy_count", "as": "sum_y"}
350	                    ],
351	                    "groupby": [Template.anchor("y")],
352	                },
353	                {
354	                    "calculate": "datum.xy_count / datum.sum_y",
355	                    "as": "percent_of_y",
356	                },
357	            ],
358	            "encoding": {
359	                "x": {
360	                    "field": Template.anchor("x"),
361	                    "type": "nominal",
362	                    "sort": "ascending",
363	                    "title": Template.anchor("x_label"),
364	                },
365	                "y": {
366	                    "field": Template.anchor("y"),
367	                    "type": "nominal",
368	                    "sort": "ascending",
369	                    "title": Template.anchor("y_label"),
370	                },
371	            },
372	            "layer": [
373	                {
374	                    "mark": "rect",
375	                    "width": Template.anchor("plot_width"),
376	                    "height": Template.anchor("plot_height"),
377	                    "encoding": {
378	                        "color": {
379	                            "field": "percent_of_y",
380	                            "type": "quantitative",
381	                            "title": "",
382	                            "scale": {"domain": [0, 1]},
383	                        }
384	                    },
385	                },
386	                {
387	                    "selection": {
388	                        "label": {
389	                            "type": "single",
390	                            "on": "mouseover",
391	                            "encodings": ["x", "y"],
392	                            "empty": "none",
393	                            "clear": "mouseout",
394	                        }
395	                    },
396	                    "mark": "rect",
397	                    "encoding": {
398	                        "tooltip": [
399	                            {"field": Template.anchor("x"), "type": "nominal"},
400	                            {"field": Template.anchor("y"), "type": "nominal"},
401	                            {
402	                                "field": "percent_of_y",
403	                                "type": "quantitative",
404	                                "format": ".2f",
405	                            },
406	                        ],
407	                        "opacity": {
408	                            "condition": {"selection": "label", "value": 1},
409	                            "value": 0,
410	                        },
411	                    },
412	                },
413	                {
414	                    "transform": [{"filter": {"selection": "label"}}],
415	                    "layer": [
416	                        {"mark": {"type": "rect", "color": "lightpink"}},
417	                    ],
418	                },
419	                {
420	                    "mark": "text",
421	                    "encoding": {
422	                        "color": {
423	                            "condition": {
424	                                "test": "datum.percent_of_y > 0.5",
425	                                "value": "white",
426	                            },
427	                            "value": "black",
428	                        },
429	                    },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega_templates.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
439	    DEFAULT_CONTENT = {
440	        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
441	        "data": {"values": Template.anchor("data")},
442	        "title": {"text": Template.anchor("title"), "anchor": "middle"},
443	        "width": Template.anchor("plot_width"),
444	        "height": Template.anchor("plot_height"),
445	        "mark": {"type": "point", "tooltip": {"content": "data"}},
446	        "params": [Template.anchor("zoom_and_pan")],
447	        "encoding": {
448	            "x": {
449	                "field": Template.anchor("x"),
450	                "type": "quantitative",
451	                "title": Template.anchor("x_label"),
452	            },
453	            "y": {
454	                "field": Template.anchor("y"),
455	                "type": "quantitative",
456	                "title": Template.anchor("y_label"),
457	            },
458	            "color": Template.anchor("color"),
459	            "shape": Template.anchor("shape"),
460	            "tooltip": Template.anchor("tooltip"),
461	        },
462	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega_templates.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
468	    DEFAULT_CONTENT = {
469	        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
470	        "data": {"values": Template.anchor("data")},
471	        "title": {"text": Template.anchor("title"), "anchor": "middle"},
472	        "width": Template.anchor("plot_width"),
473	        "height": Template.anchor("plot_height"),
474	        "transform": [
475	            {"calculate": "random()", "as": "randomX"},
476	            {"calculate": "random()", "as": "randomY"},
477	        ],
478	        "mark": {"type": "point", "tooltip": {"content": "data"}},
479	        "encoding": {
480	            "x": {
481	                "field": Template.anchor("x"),
482	                "title": Template.anchor("x_label"),
483	            },
484	            "y": {
485	                "field": Template.anchor("y"),
486	                "title": Template.anchor("y_label"),
487	            },
488	            "color": Template.anchor("color"),
489	            "shape": Template.anchor("shape"),
490	            "tooltip": Template.anchor("tooltip"),
491	            "xOffset": {"field": "randomX", "type": "quantitative"},
492	            "yOffset": {"field": "randomY", "type": "quantitative"},
493	        },
494	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega_templates.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
499	    DEFAULT_CONTENT = {
500	        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
501	        "data": {"values": Template.anchor("data")},
502	        "title": {"text": Template.anchor("title"), "anchor": "middle"},
503	        "width": Template.anchor("plot_width"),
504	        "height": Template.anchor("plot_height"),
505	        "params": [
506	            {
507	                "name": "smooth",
508	                "value": 0.001,
509	                "bind": {
510	                    "input": "range",
511	                    "min": 0.001,
512	                    "max": 1,
513	                    "step": 0.001,
514	                },
515	            },
516	        ],
517	        "encoding": {
518	            "x": {
519	                "field": Template.anchor("x"),
520	                "type": "quantitative",
521	                "title": Template.anchor("x_label"),
522	            },
523	            "color": Template.anchor("color"),
524	            "strokeDash": Template.anchor("stroke_dash"),
525	        },
526	        "layer": [
527	            {
528	                "layer": [
529	                    {"params": [Template.anchor("zoom_and_pan")], "mark": "line"},
530	                    {
531	                        "transform": [{"filter": {"param": "hover", "empty": False}}],
532	                        "mark": "point",
533	                    },
534	                ],
535	                "encoding": {
536	                    "y": {
537	                        "field": Template.anchor("y"),
538	                        "type": "quantitative",
539	                        "title": Template.anchor("y_label"),
540	                        "scale": {"zero": False},
541	                    },
542	                    "color": {
543	                        "field": "rev",
544	                        "type": "nominal",
545	                    },
546	                },
547	                "transform": [
548	                    {
549	                        "loess": Template.anchor("y"),
550	                        "on": Template.anchor("x"),
551	                        "groupby": Template.anchor("group_by"),
552	                        "bandwidth": {"signal": "smooth"},
553	                    },
554	                ],
555	            },
556	            {
557	                "mark": {"type": "line", "opacity": 0.2},
558	                "encoding": {
559	                    "x": {
560	                        "field": Template.anchor("x"),
561	                        "type": "quantitative",
562	                        "title": Template.anchor("x_label"),
563	                    },
564	                    "y": {
565	                        "field": Template.anchor("y"),
566	                        "type": "quantitative",
567	                        "title": Template.anchor("y_label"),
568	                        "scale": {"zero": False},
569	                    },
570	                    "color": {"field": "rev", "type": "nominal"},
571	                },
572	            },
573	            {
574	                "mark": {"type": "circle", "size": 10},
575	                "encoding": {
576	                    "x": {
577	                        "aggregate": "max",
578	                        "field": Template.anchor("x"),
579	                        "type": "quantitative",
580	                        "title": Template.anchor("x_label"),
581	                    },
582	                    "y": {
583	                        "aggregate": {"argmax": Template.anchor("x")},
584	                        "field": Template.anchor("y"),
585	                        "type": "quantitative",
586	                        "title": Template.anchor("y_label"),
587	                        "scale": {"zero": False},
588	                    },
589	                    "color": {"field": "rev", "type": "nominal"},
590	                },
591	            },
592	            {
593	                "transform": [
594	                    {"calculate": Template.anchor("pivot_field"), "as": "pivot_field"},
595	                    {
596	                        "pivot": "pivot_field",
597	                        "op": "mean",
598	                        "value": Template.anchor("y"),
599	                        "groupby": [Template.anchor("x")],
600	                    },
601	                ],
602	                "mark": {
603	                    "type": "rule",
604	                    "tooltip": {"content": "data"},
605	                    "stroke": "grey",
606	                },
607	                "encoding": {
608	                    "opacity": {
609	                        "condition": {"value": 0.3, "param": "hover", "empty": False},
610	                        "value": 0,
611	                    }
612	                },
613	                "params": [
614	                    {
615	                        "name": "hover",
616	                        "select": {
617	                            "type": "point",
618	                            "fields": [Template.anchor("x")],
619	                            "nearest": True,
620	                            "on": "mouseover",
621	                            "clear": "mouseout",
622	                        },
623	                    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_render-1.0.2-py3-none-any/dvc_render/vega_templates.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
637	    DEFAULT_CONTENT = {
638	        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
639	        "data": {"values": Template.anchor("data")},
640	        "title": {"text": Template.anchor("title"), "anchor": "middle"},
641	        "params": [Template.anchor("zoom_and_pan")],
642	        "width": Template.anchor("plot_width"),
643	        "height": Template.anchor("plot_height"),
644	        "mark": {
645	            "type": "line",
646	            "tooltip": {"content": "data"},
647	        },
648	        "encoding": {
649	            "x": {
650	                "field": Template.anchor("x"),
651	                "type": "quantitative",
652	                "title": Template.anchor("x_label"),
653	            },
654	            "y": {
655	                "field": Template.anchor("y"),
656	                "type": "quantitative",
657	                "title": Template.anchor("y_label"),
658	                "scale": {"zero": False},
659	            },
660	            "color": Template.anchor("color"),
661	            "strokeDash": Template.anchor("stroke_dash"),
662	            "tooltip": Template.anchor("tooltip"),
663	        },
664	    }

--------------------------------------------------

Code scanned:
	Total lines of code: 1498
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 1.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 1.0
Files skipped (0):
