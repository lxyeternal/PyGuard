Run started:2025-04-12 18:24:41.746020

Test results:
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/__init__.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
87	    # Decode base64-encoded header and payload
88	    decoded_header = base64.urlsafe_b64decode(header + "==").decode("utf-8")
89	    decoded_payload = base64.urlsafe_b64decode(payload + "==").decode("utf-8")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/__init__.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
88	    decoded_header = base64.urlsafe_b64decode(header + "==").decode("utf-8")
89	    decoded_payload = base64.urlsafe_b64decode(payload + "==").decode("utf-8")
90	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	_GCP_IDENTITY_REQUEST_URL = (
39	    "http://metadata/computeMetadata/v1/instance/service-accounts/default/identity"  # noqa
40	)
41	_GCP_GENERATEIDTOKEN_REQUEST_URL = (
42	    "https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/{}:generateIdToken"  # noqa

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	_GCP_GENERATEIDTOKEN_REQUEST_URL = (
42	    "https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/{}:generateIdToken"  # noqa
43	)
44	
45	_env_var_regex = re.compile(r"[^A-Z0-9_]|^[^A-Z_]")
46	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	    logger.debug("GitHub: requesting OIDC token")
80	    resp = requests.get(
81	        req_url,
82	        params={"audience": audience},
83	        headers={"Authorization": f"bearer {req_token}"},
84	        timeout=30,
85	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	        logger.debug("GCP: requesting access token")
125	        resp = requests.get(
126	            _GCP_TOKEN_REQUEST_URL,
127	            params={"scopes": "https://www.googleapis.com/auth/cloud-platform"},
128	            headers={"Metadata-Flavor": "Google"},
129	            timeout=30,
130	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	            _GCP_TOKEN_REQUEST_URL,
127	            params={"scopes": "https://www.googleapis.com/auth/cloud-platform"},
128	            headers={"Metadata-Flavor": "Google"},

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
140	
141	        access_token = resp.json().get("access_token")
142	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
145	
146	        resp = requests.post(
147	            _GCP_GENERATEIDTOKEN_REQUEST_URL.format(service_account_name),
148	            json={"audience": audience, "includeEmail": True},
149	            headers={
150	                "Authorization": f"Bearer {access_token}",
151	            },
152	            timeout=30,
153	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	
166	        oidc_token: str = resp.json().get("token")
167	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
178	            with open(_GCP_PRODUCT_NAME_FILE) as f:
179	                name = f.read().strip()
180	        except OSError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/id-1.5.0/id-1.5.0/id/_internal/oidc/ambient.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
188	        logger.debug("GCP: requesting OIDC token")
189	        resp = requests.get(
190	            _GCP_IDENTITY_REQUEST_URL,
191	            params={"audience": audience, "format": "full"},
192	            headers={"Metadata-Flavor": "Google"},
193	            timeout=30,
194	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 936
	Total lines skipped (#nosec): 4

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 0.0
Files skipped (0):
