Run started:2025-04-12 16:33:55.321271

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/handlers.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	        with self.handler.lock:
49	            self.handler.write(data)
50	        del data

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/handlers.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
68	    elif archive_format in ["tgz", "tar.gz"]:
69	        archive_file = tarfile.open(fileobj=fileobj, mode="w|gz")
70	    elif archive_format in ["tbz", "tbz2", "tar.bz", "tar.bz2"]:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/handlers.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
70	    elif archive_format in ["tbz", "tbz2", "tar.bz", "tar.bz2"]:
71	        archive_file = tarfile.open(fileobj=fileobj, mode="w|bz2")
72	    elif archive_format in ["txz", "tar.xz"]:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/handlers.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
72	    elif archive_format in ["txz", "tar.xz"]:
73	        archive_file = tarfile.open(fileobj=fileobj, mode="w|xz")
74	    else:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/handlers.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
85	    elif any([archive_format.endswith(ext) for ext in [".tgz", ".tar.gz"]]):
86	        archive_file = tarfile.open(archive_path, mode="r|gz")
87	    elif any([archive_format.endswith(ext) for ext in [".tbz", ".tbz2", ".tar.bz", ".tar.bz2"]]):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/handlers.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
87	    elif any([archive_format.endswith(ext) for ext in [".tbz", ".tbz2", ".tar.bz", ".tar.bz2"]]):
88	        archive_file = tarfile.open(archive_path, mode="r|bz2")
89	    elif any([archive_format.endswith(ext) for ext in [".txz", ".tar.xz"]]):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/handlers.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
89	    elif any([archive_format.endswith(ext) for ext in [".txz", ".tar.xz"]]):
90	        archive_file = tarfile.open(archive_path, mode="r|xz")
91	    else:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/tests/test_archive_handler.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
76	async def test_download(jp_fetch, jp_root_dir, followSymlinks, download_hidden, file_list, format, mode):
77	    if followSymlinks and platform.system() == "Windows":
78	        pytest.skip("Symlinks not working on Windows")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/tests/test_archive_handler.py:77
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
76	async def test_download(jp_fetch, jp_root_dir, followSymlinks, download_hidden, file_list, format, mode):
77	    if followSymlinks and platform.system() == "Windows":
78	        pytest.skip("Symlinks not working on Windows")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/tests/test_archive_handler.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
98	    (symlink_dir_path / "test6.md").write_text("hello6")
99	    if platform.system() != "Windows":
100	        (archive_dir_path / "symlink-test-dir").symlink_to(symlink_dir_path, target_is_directory=True)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/tests/test_archive_handler.py:99
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
98	    (symlink_dir_path / "test6.md").write_text("hello6")
99	    if platform.system() != "Windows":
100	        (archive_dir_path / "symlink-test-dir").symlink_to(symlink_dir_path, target_is_directory=True)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/tests/test_archive_handler.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
119	    else:
120	        with tarfile.open(fileobj=r.buffer, mode=mode) as tf:
121	            assert set(map(lambda m: m.name, tf.getmembers())) == file_list

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/tests/test_archive_handler.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
142	    else:
143	        with tarfile.open(str(archive_path), mode=mode) as writer:
144	            for file_path in archive_dir_path.rglob("*"):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/tests/test_archive_handler.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
148	    # Remove the directory
149	    shutil.rmtree(archive_dir_path)
150	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/tests/test_archive_handler.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
221	    archive_path = jp_root_dir / "test.tar.gz"
222	    open(unsafe_file_path, 'a').close()
223	    with tarfile.open(archive_path, "w:gz") as tf:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyter_archive-3.4.0/jupyter_archive-3.4.0/jupyter_archive/tests/test_archive_handler.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
222	    open(unsafe_file_path, 'a').close()
223	    with tarfile.open(archive_path, "w:gz") as tf:
224	        tf.add(unsafe_file_path, file_path)

--------------------------------------------------

Code scanned:
	Total lines of code: 490
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 2.0
Files skipped (0):
