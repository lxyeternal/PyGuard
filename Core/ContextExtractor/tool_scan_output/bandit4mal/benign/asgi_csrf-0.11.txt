Run started:2025-04-12 17:02:06.077335

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/asgi_csrf.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
302	            messages.append(message)
303	            form_parser.write(message.get("body", b""))
304	            more_body = message.get("more_body", False)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/asgi_csrf.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
359	    simple_cookie = SimpleCookie()
360	    simple_cookie.load(cookie.decode("utf8"))
361	    return {key: morsel.value for key, morsel in simple_cookie.items()}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	    ) as client:
91	        response = await client.get("http://localhost/")
92	    assert b'{"hello":"world"}' == response.content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	    async with httpx.AsyncClient(transport=httpx.ASGITransport(app=app_csrf)) as client:
118	        response = await client.get("http://localhost/")
119	    assert b'{"hello":"world"}' == response.content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	    async with httpx.AsyncClient(transport=httpx.ASGITransport(app=app_csrf)) as client:
128	        response = await client.get("http://localhost/?_vary=User-Agent")
129	    assert b'{"hello":"world"}' == response.content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
137	    async with httpx.AsyncClient(transport=httpx.ASGITransport(app=app_csrf)) as client:
138	        response = await client.get("http://localhost/static")
139	    assert b'{"hello":"world","static":true}' == response.content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	    ) as client:
149	        assert "vary" in (await client.get("http://localhost/")).headers
150	        assert "vary" not in (await client.get("http://localhost/?_no_token=1")).headers

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	        assert "vary" in (await client.get("http://localhost/")).headers
150	        assert "vary" not in (await client.get("http://localhost/?_no_token=1")).headers
151	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	    async with httpx.AsyncClient(transport=httpx.ASGITransport(app=app_csrf)) as client:
156	        response = await client.get("http://localhost/static")
157	        assert "application/json" == response.headers["content-type"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	    ) as client:
165	        response = await client.get("http://localhost/")
166	    assert b'{"hello":"world"}' == response.content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	    ) as client:
175	        response = await client.post("http://localhost/")
176	    assert 403 == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
190	        response = await client.post(
191	            "http://localhost/",
192	            data={"csrftoken": csrftoken[-1]},
193	        )
194	    assert 403 == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
207	        response = await client.post(
208	            "http://localhost/",
209	            headers={"x-csrftoken": csrftoken},
210	        )
211	    assert 200 == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
222	        response = await client.post(
223	            "http://localhost/",
224	            data={"csrftoken": csrftoken, "hello": "world"},
225	        )
226	    assert 200 == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	        response = await client.post(
239	            "http://localhost/",
240	            data={"csrftoken": csrftoken},
241	            files={"csv": ("data.csv", "blah,foo\n1,2", "text/csv")},
242	        )
243	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	        response = await client.post(
261	            "http://localhost/",
262	            data={"csrftoken": csrftoken},
263	            files={"csv": ("data.csv", "blah,foo\n1,2", "text/csv")},
264	        )
265	        assert response.status_code == 403

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
292	        response = await client.post(
293	            "http://localhost/",
294	            data={"foo": "bar"},
295	            files=TrickEmptyDictionary(),
296	        )
297	        assert response.status_code == 403

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
317	        request = httpx.Request(
318	            url="http://localhost/",
319	            method="POST",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
355	        response = await client.post(
356	            "http://localhost/",
357	            headers={"Authorization": authorization},
358	        )
359	        assert expected_status == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
382	    ) as client:
383	        response = await client.post("http://localhost{}".format(path))
384	        assert expected_status == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
409	    ) as client:
410	        response = await client.post("http://localhost{}".format(path))
411	        assert expected_status == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
425	    ) as client:
426	        response = await client.get("http://localhost/static")
427	        assert 200 == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
447	    ) as client:
448	        response = await client.get("http://localhost/static")
449	        assert 200 == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
464	            response = await client.post(
465	                "http://localhost/",
466	                headers={"Authorization": "Bearer xxx"},
467	            )
468	            assert 200 == response.status_code

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
481	    async with httpx.AsyncClient(
482	        transport=transport, base_url="http://testserver"
483	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
483	    ) as client:
484	        response = await client.get("http://testserver/")
485	    assert cookie_name in response.cookies

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
495	    async with httpx.AsyncClient(
496	        transport=transport, base_url="http://testserver"
497	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
497	    ) as client:
498	        response = await client.get("http://testserver/")
499	    assert f"Path={cookie_path}" in response.headers["set-cookie"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
509	    async with httpx.AsyncClient(
510	        transport=transport, base_url="http://testserver"
511	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
511	    ) as client:
512	        response = await client.get("http://testserver/")
513	    if cookie_domain:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
526	    async with httpx.AsyncClient(
527	        transport=transport, base_url="http://testserver"
528	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
528	    ) as client:
529	        response = await client.get("http://testserver/")
530	    if cookie_secure:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
543	    async with httpx.AsyncClient(
544	        transport=transport, base_url="http://testserver"
545	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
545	    ) as client:
546	        response = await client.get("http://testserver/")
547	    assert f"SameSite={cookie_samesite}" in response.headers["set-cookie"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
554	    async with httpx.AsyncClient(
555	        transport=transport, base_url="http://testserver"
556	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asgi_csrf-0.11/asgi_csrf-0.11/tests/test_asgi_csrf.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
556	    ) as client:
557	        response = await client.get("http://testserver/")
558	    set_cookie = response.headers["set-cookie"]

--------------------------------------------------

Code scanned:
	Total lines of code: 784
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 2.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 0.0
Files skipped (0):
