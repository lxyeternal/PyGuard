Run started:2025-04-12 13:01:30.246659

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/__main__.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
653	    with open(CORE.config_path, mode="r+", encoding="utf-8") as raw_file:
654	        raw_contents = raw_file.read()
655	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/__main__.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
698	    with open(new_path, mode="w", encoding="utf-8") as new_file:
699	        new_file.write(new_raw)
700	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/__main__.py:958
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
957	        type=str,
958	        default="0.0.0.0",
959	    )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/api/__init__.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
56	    try:
57	        decoded = base64.b64decode(value, validate=True)
58	    except ValueError as err:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/api/__init__.py:57
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
56	    try:
57	        decoded = base64.b64decode(value, validate=True)
58	    except ValueError as err:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/api/__init__.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
154	    if encryption_config := config.get(CONF_ENCRYPTION):
155	        decoded = base64.b64decode(encryption_config[CONF_KEY])
156	        cg.add(var.set_noise_psk(list(decoded)))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/api/__init__.py:155
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
154	    if encryption_config := config.get(CONF_ENCRYPTION):
155	        decoded = base64.b64decode(encryption_config[CONF_KEY])
156	        cg.add(var.set_noise_psk(list(decoded)))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/bedjet/climate/__init__.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	            cv.Optional(ble_client.CONF_BLE_CLIENT_ID): cv.invalid(
49	                "The 'ble_client_id' option has been removed. Please migrate "
50	                "to the new `bedjet_id` option in the `bedjet` component.\n"
51	                "See https://esphome.io/components/climate/bedjet.html"
52	            ),
53	            cv.Optional(CONF_TIME_ID): cv.invalid(
54	                "The 'time_id' option has been moved to the `bedjet` component."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/bme68x_bsec2/__init__.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        filename = "bsec_iaq"
95	    return f"https://raw.githubusercontent.com/boschsensortec/Bosch-BSEC2-Library/{BSEC2_LIBRARY_VERSION}/src/config/{model}/{model}_{algo}_{volts}_{sample_rate}_{operating_age}/{filename}.txt"
96	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/bme68x_bsec2/__init__.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
190	        None,
191	        f"https://github.com/boschsensortec/Bosch-BSEC2-Library.git#{BSEC2_LIBRARY_VERSION}",
192	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/custom/binary_sensor/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    'The "custom" component has been removed. Consider conversion to an external component.\nhttps://esphome.io/guides/contributing#a-note-about-custom-components'
5	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/custom/climate/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    'The "custom" component has been removed. Consider conversion to an external component.\nhttps://esphome.io/guides/contributing#a-note-about-custom-components'
5	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/custom/cover/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    'The "custom" component has been removed. Consider conversion to an external component.\nhttps://esphome.io/guides/contributing#a-note-about-custom-components'
5	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/custom/light/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    'The "custom" component has been removed. Consider conversion to an external component.\nhttps://esphome.io/guides/contributing#a-note-about-custom-components'
5	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/custom/output/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    'The "custom" component has been removed. Consider conversion to an external component.\nhttps://esphome.io/guides/contributing#a-note-about-custom-components'
5	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/custom/sensor/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    'The "custom" component has been removed. Consider conversion to an external component.\nhttps://esphome.io/guides/contributing#a-note-about-custom-components'
5	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/custom/switch/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    'The "custom" component has been removed. Consider conversion to an external component.\nhttps://esphome.io/guides/contributing#a-note-about-custom-components'
5	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/custom/text_sensor/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    'The "custom" component has been removed. Consider conversion to an external component.\nhttps://esphome.io/guides/contributing#a-note-about-custom-components'
5	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/custom_component/__init__.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	CONFIG_SCHEMA = cv.invalid(
6	    'The "custom" component has been removed. Consider conversion to an external component.\nhttps://esphome.io/guides/contributing#a-note-about-custom-components'
7	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/dallas/__init__.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	CONFIG_SCHEMA = cv.invalid(
6	    'The "dallas" component has been replaced by the "one_wire" component.\nhttps://esphome.io/components/one_wire'
7	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/dallas/sensor.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    'The "dallas" sensor is now "dallas_temp"\nhttps://esphome.io/components/sensor/dallas_temp'
5	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/dashboard_import/__init__.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	def _final_validate(config):
59	    full_config = fv.full_config.get()[CONF_ESPHOME]
60	    if CONF_PROJECT not in full_config:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/dashboard_import/__init__.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	        try:
103	            req = requests.get(url, timeout=30)
104	            req.raise_for_status()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/dashboard_import/__init__.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
159	            noise_psk = secrets.token_bytes(32)
160	            key = base64.b64encode(noise_psk).decode()
161	            config["api"] = {"encryption": {"key": key}}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/dashboard_import/__init__.py:160
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
159	            noise_psk = secrets.token_bytes(32)
160	            key = base64.b64encode(noise_psk).decode()
161	            config["api"] = {"encryption": {"key": key}}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/__init__.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
231	    if release:
232	        return f"pioarduino/framework-espidf@https://github.com/pioarduino/esp-idf/releases/download/v{str(ver)}.{release}/esp-idf-v{str(ver)}.zip"
233	    return f"pioarduino/framework-espidf@https://github.com/pioarduino/esp-idf/releases/download/v{str(ver)}/esp-idf-v{str(ver)}.zip"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/__init__.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
232	        return f"pioarduino/framework-espidf@https://github.com/pioarduino/esp-idf/releases/download/v{str(ver)}.{release}/esp-idf-v{str(ver)}.zip"
233	    return f"pioarduino/framework-espidf@https://github.com/pioarduino/esp-idf/releases/download/v{str(ver)}/esp-idf-v{str(ver)}.zip"
234	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/__init__.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
288	    lookups = {
289	        "dev": (cv.Version(2, 1, 0), "https://github.com/espressif/arduino-esp32.git"),
290	        "latest": (cv.Version(2, 0, 9), None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/__init__.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
323	    lookups = {
324	        "dev": (cv.Version(5, 1, 5), "https://github.com/espressif/esp-idf.git"),
325	        "latest": (cv.Version(5, 1, 5), None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/__init__.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
402	                # maybe a release candidate?...definitely not our default, just use it as-is...
403	                return f"https://github.com/pioarduino/platform-espressif32.git#{value}"
404	            return f"https://github.com/pioarduino/platform-espressif32.git#{ver.major}.{ver.minor:02d}.{ver.patch:02d}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/__init__.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
403	                return f"https://github.com/pioarduino/platform-espressif32.git#{value}"
404	            return f"https://github.com/pioarduino/platform-espressif32.git#{ver.major}.{ver.minor:02d}.{ver.patch:02d}"
405	        # if platform version is a valid version constraint, prefix the default package

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/__init__.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
805	
806	        shutil.rmtree(CORE.relative_build_path("components"), ignore_errors=True)
807	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/__init__.py:859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
858	            with open(CORE.relative_build_path(file[KEY_NAME]), "wb") as f:
859	                f.write(requests.get(file[KEY_PATH], timeout=30).content)
860	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/__init__.py:859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
858	            with open(CORE.relative_build_path(file[KEY_NAME]), "wb") as f:
859	                f.write(requests.get(file[KEY_PATH], timeout=30).content)
860	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/gpio_esp32_h2.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        _LOGGER.warning(
20	            "GPIO%d is a Strapping PIN and should be avoided.\n"
21	            "Attaching external pullup/down resistors to strapping pins can cause unexpected failures.\n"
22	            "See https://esphome.io/guides/faq.html#why-am-i-getting-a-warning-about-strapping-pins",
23	            value,
24	        )
25	    if value in _ESP32H2_SPI_FLASH_PINS:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32/gpio_esp32_h2.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        _LOGGER.warning(
27	            "GPIO%d is reserved for SPI Flash communication on some ESP32-H2 chip variants.\n"
28	            "Utilizing SPI-reserved pins could cause unexpected failures.\n"
29	            "See https://docs.espressif.com/projects/esp-idf/en/latest/esp32h2/api-reference/peripherals/gpio.html",
30	            value,
31	        )
32	    if value in _ESP32H2_USB_JTAG_PINS:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp32_camera/__init__.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
297	            name="esp32-camera",
298	            repo="https://github.com/espressif/esp32-camera.git",
299	            ref="v2.0.9",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esp8266/__init__.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	    lookups = {
100	        "dev": (cv.Version(3, 1, 2), "https://github.com/esp8266/Arduino.git"),
101	        "latest": (cv.Version(3, 1, 2), None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esphome/ota/__init__.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	            cv.Optional(CONF_NUM_ATTEMPTS): cv.invalid(
107	                f"'{CONF_SAFE_MODE}' (and its related configuration variables) has moved from 'ota' to its own component. See https://esphome.io/components/safe_mode"
108	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esphome/ota/__init__.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	            cv.Optional(CONF_REBOOT_TIMEOUT): cv.invalid(
110	                f"'{CONF_SAFE_MODE}' (and its related configuration variables) has moved from 'ota' to its own component. See https://esphome.io/components/safe_mode"
111	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/esphome/ota/__init__.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	            cv.Optional(CONF_SAFE_MODE): cv.invalid(
113	                f"'{CONF_SAFE_MODE}' (and its related configuration variables) has moved from 'ota' to its own component. See https://esphome.io/components/safe_mode"
114	            ),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/ethernet/__init__.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
100	        cv.Required(CONF_SUBNET): cv.ipv4address,
101	        cv.Optional(CONF_DNS1, default="0.0.0.0"): cv.ipv4address,
102	        cv.Optional(CONF_DNS2, default="0.0.0.0"): cv.ipv4address,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/ethernet/__init__.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
101	        cv.Optional(CONF_DNS1, default="0.0.0.0"): cv.ipv4address,
102	        cv.Optional(CONF_DNS2, default="0.0.0.0"): cv.ipv4address,
103	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/font/__init__.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
306	    )
307	    url = f"https://fonts.googleapis.com/css2?family={name}"
308	    path = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/font/__init__.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
314	        try:
315	            req = requests.get(url, timeout=external_files.NETWORK_TIMEOUT)
316	            req.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/http_request/__init__.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	        return value
59	    raise cv.Invalid("URL must start with 'http://' or 'https://'")
60	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/http_request/__init__.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	            cv.Optional(
100	                CONF_USERAGENT, f"ESPHome/{__version__} (https://esphome.io)"
101	            ): cv.string,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/image/__init__.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
318	
319	    url = f"https://raw.githubusercontent.com/Templarian/MaterialDesign/master/svg/{mdi_id}.svg"
320	    return download_file(url, path)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/internal_temperature/sensor.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	                raise cv.Invalid(
33	                    "ESP32-S3 Internal Temperature Sensor requires framework version 2.0.6 or higher. See <https://github.com/esphome/issues/issues/4271>."
34	                )
35	            if CORE.using_esp_idf and CORE.data[KEY_CORE][

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/internal_temperature/sensor.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	                raise cv.Invalid(
39	                    "ESP32-S3 Internal Temperature Sensor requires framework version 4.4.3 or higher. See <https://github.com/esphome/issues/issues/4271>."
40	                )
41	    return config

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/kalman_combinator/sensor.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	CONFIG_SCHEMA = cv.invalid(
4	    "The kalman_combinator sensor has moved.\nPlease use the combination platform instead with type: kalman.\n"
5	    "See https://esphome.io/components/sensor/combination.html"
6	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/libretiny/__init__.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	ARDUINO_VERSIONS = {
176	    "dev": (cv.Version(1, 7, 0), "https://github.com/libretiny-eu/libretiny.git"),
177	    "latest": (cv.Version(1, 7, 0), "libretiny"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/mdns/__init__.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	            name="mdns",
93	            repo="https://github.com/espressif/esp-protocols.git",
94	            ref="mdns-v1.8.2",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/micro_wake_word/__init__.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
242	            CONF_TYPE: TYPE_HTTP,
243	            CONF_URL: f"https://github.com/esphome/micro-wake-word-models/raw/main/models/v2/{value}.json",
244	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/micro_wake_word/__init__.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
418	        name="esp-tflite-micro",
419	        repo="https://github.com/espressif/esp-tflite-micro",
420	        ref="v1.3.1",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/micro_wake_word/__init__.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
425	        name="esp-nn",
426	        repo="https://github.com/espressif/esp-nn",
427	        ref="v1.1.0",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/online_image/__init__.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	        cg.add_define("USE_ONLINE_IMAGE_JPEG_SUPPORT")
69	        cg.add_library("JPEGDEC", None, "https://github.com/bitbank2/JPEGDEC#ca1e0f2")
70	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/pn532/__init__.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        raise cv.Invalid(
57	            "This component has been moved in 1.16, please see the docs for updated "
58	            "instructions. https://esphome.io/components/binary_sensor/pn532.html"
59	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/rp2040/__init__.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	    # the GitHub release is one path forward for now.
67	    return f"https://github.com/earlephilhower/arduino-pico/releases/download/{ver}/rp2040-{ver}.zip"
68	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/rp2040/__init__.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	
80	    return f"https://github.com/maxgerhardt/platform-raspberrypi.git#{value}"
81	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/rp2040/__init__.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	    lookups = {
102	        "dev": (cv.Version(3, 9, 4), "https://github.com/earlephilhower/arduino-pico"),
103	        "latest": (cv.Version(3, 9, 4), None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/rp2040/__init__.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
197	        raise EsphomeError(
198	            f"[{component}] Invalid PIO key: {key}. Allowed characters: [{ascii_letters}{digits}_]\nPlease report an issue https://github.com/esphome/issues"
199	        ) from e

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/rp2040/__init__.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
205	
206	    shutil.rmtree(CORE.relative_build_path("src/pio"), ignore_errors=True)
207	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/rp2040_pio/__init__.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	PIOASM_REPO_VERSION = "1.5.0-b"
9	PIOASM_REPO_BASE = f"https://github.com/earlephilhower/pico-quick-toolchain/releases/download/{PIOASM_REPO_VERSION}"
10	PIOASM_VERSION = "pioasm-2e6142b.230216"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/rp2040_pio/__init__.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
33	    # )
34	    file = PIOASM_DOWNLOADS[platform.system().lower()][platform.machine().lower()]
35	    cg.add_platformio_option(

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/rp2040_pio/__init__.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
33	    # )
34	    file = PIOASM_DOWNLOADS[platform.system().lower()][platform.machine().lower()]
35	    cg.add_platformio_option(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/sgp40/sensor.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	CONFIG_SCHEMA = cv.invalid(
6	    "SGP40 is deprecated.\nPlease use the SGP4x platform instead.\nSGP4x supports both SPG40 and SGP41.\n"
7	    " See https://esphome.io/components/sensor/sgp4x.html"
8	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/sgp4x/sensor.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	        None,
144	        "https://github.com/Sensirion/arduino-gas-index-algorithm.git#3.2.1",
145	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/shelly_dimmer/light.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	    "51.5": (
54	        "https://github.com/jamesturton/shelly-dimmer-stm32/releases/download/v51.5/shelly-dimmer-stm32_v51.5.bin",
55	        "553fc1d78ed113227af7683eaa9c26189a961c4ea9a48000fb5aa8f8ac5d7b60",
56	    ),
57	    "51.6": (
58	        "https://github.com/jamesturton/shelly-dimmer-stm32/releases/download/v51.6/shelly-dimmer-stm32_v51.6.bin",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/shelly_dimmer/light.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	    "51.6": (
58	        "https://github.com/jamesturton/shelly-dimmer-stm32/releases/download/v51.6/shelly-dimmer-stm32_v51.6.bin",
59	        "eda483e111c914723a33f5088f1397d5c0b19333db4a88dc965636b976c16c36",
60	    ),
61	    "51.7": (
62	        "https://github.com/jamesturton/shelly-dimmer-stm32/releases/download/v51.7/shelly-dimmer-stm32_v51.7.bin",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/shelly_dimmer/light.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	    "51.7": (
62	        "https://github.com/jamesturton/shelly-dimmer-stm32/releases/download/v51.7/shelly-dimmer-stm32_v51.7.bin",
63	        "7a20f1c967c469917368a79bc56498009045237080408cef7190743e08031889",
64	    ),
65	}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/shelly_dimmer/light.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	        try:
83	            req = requests.get(url, timeout=30)
84	            req.raise_for_status()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/udp/__init__.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
88	            cv.Optional(
89	                CONF_LISTEN_ADDRESS, default="255.255.255.255"
90	            ): cv.ipv4address_multi_broadcast,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/udp/__init__.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
90	            ): cv.ipv4address_multi_broadcast,
91	            cv.Optional(CONF_ADDRESSES, default=["255.255.255.255"]): cv.ensure_list(
92	                cv.ipv4address,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/udp/__init__.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
160	        cg.add(var.add_provider(name))
161	        if (listen_address := str(config[CONF_LISTEN_ADDRESS])) != "255.255.255.255":
162	            cg.add(var.set_listen_address(listen_address))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/web_server/__init__.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	        if CONF_CSS_URL not in config:
52	            config[CONF_CSS_URL] = "https://esphome.io/_static/webserver-v1.min.css"
53	        if CONF_JS_URL not in config:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/web_server/__init__.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        if CONF_JS_URL not in config:
54	            config[CONF_JS_URL] = "https://esphome.io/_static/webserver-v1.min.js"
55	    if config[CONF_VERSION] == 2:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/web_server/__init__.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	        if CONF_JS_URL not in config:
59	            config[CONF_JS_URL] = "https://oi.esphome.io/v2/www.js"
60	    if config[CONF_VERSION] == 3:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/web_server/__init__.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	        if CONF_JS_URL not in config:
64	            config[CONF_JS_URL] = "https://oi.esphome.io/v3/www.js"
65	    return config

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/wifi/__init__.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
103	    {
104	        cv.Optional(CONF_DNS1, default="0.0.0.0"): cv.ipv4address,
105	        cv.Optional(CONF_DNS2, default="0.0.0.0"): cv.ipv4address,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/wifi/__init__.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
104	        cv.Optional(CONF_DNS1, default="0.0.0.0"): cv.ipv4address,
105	        cv.Optional(CONF_DNS2, default="0.0.0.0"): cv.ipv4address,
106	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/wifi/__init__.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	            raise cv.Invalid(
219	                f"power_save_mode NONE is incompatible with {conflicting}. "
220	                f"Please remove the power save mode. See also "

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/components/wireguard/__init__.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
70	        cv.Required(CONF_ADDRESS): cv.ipv4address,
71	        cv.Optional(CONF_NETMASK, default="255.255.255.255"): cv.ipv4address,
72	        cv.Required(CONF_PRIVATE_KEY): _wireguard_key,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/config_validation.py:1173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1172	    address = ipv4address(value)
1173	    if not (address.is_multicast or (address == IPv4Address("255.255.255.255"))):
1174	        raise Invalid(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/config_validation.py:2043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2042	            raise Invalid(
2043	                f"""
2044	            Internal Error: require_framework_version does not support this platform configuration
2045	                platform: {core_data[KEY_TARGET_PLATFORM]}
2046	                framework: {framework}
2047	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/config_validation.py:2127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2126	            CONF_TYPE: TYPE_GIT,
2127	            CONF_URL: "https://github.com/esphome/esphome.git",
2128	            CONF_REF: f"pull/{m.group(4)}/head",
2129	        }
2130	    else:
2131	        conf = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/config_validation.py:2133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2132	            CONF_TYPE: TYPE_GIT,
2133	            CONF_URL: f"https://github.com/{m.group(1)}/{m.group(2)}.git",
2134	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/core/config.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	        _LOGGER.warning(
66	            "'%s': Using the '_' (underscore) character in the hostname is discouraged "
67	            "as it can cause problems with some DHCP and local name services. "
68	            "For more information, see https://esphome.io/guides/faq.html#why-shouldn-t-i-use-underscores-in-my-device-name",
69	            config[CONF_NAME],
70	        )
71	    return config

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/dashboard.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
33	        pid = os.getpid()
34	        os.close(os.pidfd_open(pid, 0))
35	    except OSError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/dashboard.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	                    self._watcher = asyncio.ThreadedChildWatcher()
61	                if threading.current_thread() is threading.main_thread():
62	                    self._watcher.attach_loop(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/dashboard.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	                    self._watcher = asyncio.ThreadedChildWatcher()
61	                if threading.current_thread() is threading.main_thread():
62	                    self._watcher.attach_loop(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/dashboard.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
78	
79	        executor = ThreadPoolExecutor(
80	            thread_name_prefix="SyncWorker", max_workers=MAX_EXECUTOR_WORKERS
81	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/status/ping.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
135	    try:
136	        await async_ping("127.0.0.1", count=0, timeout=0, privileged=True)
137	    except SocketPermissionError:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/status/ping.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
138	        try:
139	            await async_ping("127.0.0.1", count=0, timeout=0, privileged=False)
140	        except SocketPermissionError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/util/file.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	        ) as fdesc:
39	            fdesc.write(utf8_data)
40	            tmp_filename = fdesc.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/util/file.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
38	        ) as fdesc:
39	            fdesc.write(utf8_data)
40	            tmp_filename = fdesc.name

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/util/file.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
42	                try:
43	                    os.fchmod(fdesc.fileno(), 0o644)
44	                except AttributeError:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/util/file.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
49	        if missing_fchmod:
50	            os.chmod(filename, 0o644)
51	    finally:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/util/file.py:50
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
49	        if missing_fchmod:
50	            os.chmod(filename, 0o644)
51	    finally:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    if "b" in version:
76	        docs_link = "https://beta.esphome.io/"
77	    elif "dev" in version:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	    elif "dev" in version:
78	        docs_link = "https://next.esphome.io/"
79	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    else:
80	        docs_link = "https://www.esphome.io/"
81	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	        # X-HA-Ingress is automatically stripped on the non-ingress server in nginx
111	        header = handler.request.headers.get("X-HA-Ingress", "NO")
112	        if str(header) == "YES":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
115	    if settings.using_auth:
116	        if auth_header := handler.request.headers.get("Authorization"):
117	            assert isinstance(auth_header, str)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
118	            if auth_header.startswith("Basic "):
119	                auth_decoded = base64.b64decode(auth_header[6:]).decode()
120	                username, password = auth_decoded.split(":", 1)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:119
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
118	            if auth_header.startswith("Basic "):
119	                auth_decoded = base64.b64decode(auth_header[6:]).decode()
120	                username, password = auth_decoded.split(":", 1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
232	            )
233	            stdout_thread = threading.Thread(target=self._stdout_thread)
234	            stdout_thread.daemon = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
258	        _LOGGER.debug("< stdin: %s", data)
259	        self._proc.stdin.write(data)
260	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
267	                if self._use_popen:
268	                    data: bytes = yield self._queue.get()
269	                    if data is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
328	            port == "OTA"  # pylint: disable=too-many-boolean-expressions
329	            and (entry := entries.get(config_file))
330	            and entry.loaded_integrations

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
387	        entries = DASHBOARD.entries
388	        if entry := entries.get(self.old_name):
389	            entries.async_set_state(entry, UNKNOWN_STATE)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	        command = [*DASHBOARD_COMMAND, "compile"]
408	        if json_message.get("only_generate", False):
409	            command.append("--only-generate")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
466	        self.set_header("content-type", "application/json")
467	        self.write(json.dumps(data))
468	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
482	            self.set_header("content-type", "application/json")
483	            self.write(json.dumps({"error": "Name is required"}))
484	            return

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
490	        noise_psk = secrets.token_bytes(32)
491	        kwargs["api_encryption_key"] = base64.b64encode(noise_psk).decode()
492	        filename = f"{kwargs['name']}.yaml"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:491
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
490	        noise_psk = secrets.token_bytes(32)
491	        kwargs["api_encryption_key"] = base64.b64encode(noise_psk).decode()
492	        filename = f"{kwargs['name']}.yaml"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
493	        destination = settings.rel_path(filename)
494	        wizard.wizard_write(path=destination, **kwargs)
495	        self.set_status(200)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
496	        self.set_header("content-type", "application/json")
497	        self.write(json.dumps({"configuration": filename}))
498	        self.finish()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
509	            name = args["name"]
510	            friendly_name = args.get("friendly_name")
511	            encryption = args.get("encryption", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
510	            friendly_name = args.get("friendly_name")
511	            encryption = args.get("encryption", False)
512	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
541	            self.set_status(500)
542	            self.write("File already exists")
543	            return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
546	            self.set_status(422)
547	            self.write("Invalid package url")
548	            return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
551	        self.set_header("content-type", "application/json")
552	        self.write(json.dumps({"configuration": f"{name}.yaml"}))
553	        self.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
566	            self.set_header("content-type", "application/json")
567	            self.write(json.dumps({"error": "Invalid payload"}))
568	            return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
581	            self.set_header("content-type", "application/json")
582	            self.write(json.dumps({"error": "Device not found"}))
583	            return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
611	        self.set_header("content-type", "application/json")
612	        self.write(downloads_json)
613	        self.finish()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
616	        storage_path = ext_storage_path(configuration)
617	        storage_json = StorageJSON.load(storage_path)
618	        if storage_json is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
652	        with open(path, "rb") as f:
653	            data = f.read()
654	            if compressed:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
665	        storage_path = ext_storage_path(configuration)
666	        storage_json = StorageJSON.load(storage_path)
667	        if storage_json is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
719	        data = await loop.run_in_executor(None, self._load_file, path, compressed)
720	        self.write(data)
721	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
728	        self.set_header("Content-Type", "application/json")
729	        self.write(json.dumps({"version": const.__version__}))
730	        self.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
741	
742	        self.write(
743	            json.dumps(
744	                {
745	                    "configured": [entry.to_dict() for entry in entries],
746	                    "importable": [
747	                        {
748	                            "name": res.device_name,
749	                            "friendly_name": res.friendly_name,
750	                            "package_import_url": res.package_import_url,
751	                            "project_name": res.project_name,
752	                            "project_version": res.project_version,
753	                            "network": res.network,
754	                            "ignored": res.device_name in dashboard.ignored_devices,
755	                        }
756	                        for res in dashboard.import_result.values()
757	                        if res.device_name not in configured
758	                    ],

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:808
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
807	            )
808	        self.write(json.dumps(sd))
809	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
848	        self.set_header("content-type", "application/json")
849	        self.write(json.dumps(output))
850	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:861
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
860	
861	        self.write(
862	            json.dumps(
863	                {
864	                    entry.filename: entry_state_to_bool(entry.state)
865	                    for entry in dashboard.entries.async_all()
866	                }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
876	        dashboard = DASHBOARD
877	        entry = dashboard.entries.get(yaml_path)
878	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
883	        self.set_header("content-type", "application/json")
884	        self.write(entry.storage.to_json())
885	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:907
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
906	            self.set_header("Content-Type", "application/yaml")
907	            self.write(content)
908	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
912	            with open(file=filename, encoding="utf-8") as f:
913	                return f.read()
914	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
954	
955	        storage_json = StorageJSON.load(storage_path)
956	        if storage_json is not None:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:961
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
960	            if build_folder is not None:
961	                shutil.rmtree(build_folder, os.path.join(archive_path, name))
962	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
997	        }
998	        return requests.post(
999	            "http://supervisor/auth", headers=headers, json=data, timeout=30
1000	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
998	        return requests.post(
999	            "http://supervisor/auth", headers=headers, json=data, timeout=30
1000	        )
1001	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1067	        self.set_header("content-type", "application/json")
1068	        self.write(json.dumps(secret_keys))
1069	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1101	
1102	        data = yaml.load(stdout, Loader=SafeLoaderIgnoreUnknown)
1103	        self.set_header("content-type", "application/json")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:1104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1103	        self.set_header("content-type", "application/json")
1104	        self.write(json.dumps(data))
1105	        self.finish()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:1141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1140	    with open(path, "rb") as f_handle:
1141	        hash_ = hashlib.md5(f_handle.read()).hexdigest()[:8]
1142	    return f"{base}?hash={hash_}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:1248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1247	        _LOGGER.info(
1248	            "Starting dashboard web server on http://%s:%s and configuration dir %s...",
1249	            address,
1250	            port,
1251	            config_dir,
1252	        )
1253	        app.listen(port, address)

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/dashboard/web_server.py:1261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
1260	    )
1261	    server = tornado.httpserver.HTTPServer(app)
1262	    socket = tornado.netutil.bind_unix_socket(socket, mode=0o666)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
83	def recv_decode(sock, amount, decode=True):
84	    data = sock.recv(amount)
85	    if not decode:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
103	    except OTAError as err:
104	        sock.close()
105	        raise OTAError(f"Error {msg}: {err}") from err

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
190	
191	        sock.sendall(data)
192	    except OSError as err:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
252	    # Set higher timeout during upload
253	    sock.settimeout(30.0)
254	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
287	        try:
288	            sock.sendall(chunk)
289	            if version >= OTA_VERSION_2_0:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
322	        _LOGGER.error(
323	            "(If this error persists, please set a static IP address: "
324	            "https://esphome.io/components/wifi.html#manual-ips)"
325	        )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:331
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
330	        _LOGGER.info("Connecting to %s port %s...", sa[0], sa[1])
331	        sock = socket.socket(af, socktype)
332	        sock.settimeout(10.0)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
331	        sock = socket.socket(af, socktype)
332	        sock.settimeout(10.0)
333	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
333	        try:
334	            sock.connect(sa)
335	        except OSError as err:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
335	        except OSError as err:
336	            sock.close()
337	            _LOGGER.error("Connecting to %s port %s failed: %s", sa[0], sa[1], err)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/espota2.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
347	            finally:
348	                sock.close()
349	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/external_files.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	    try:
95	        req = requests.get(
96	            url,
97	            timeout=timeout,
98	            headers={"User-agent": f"ESPHome/{__version__} (https://esphome.io)"},
99	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/external_files.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	            timeout=timeout,
98	            headers={"User-agent": f"ESPHome/{__version__} (https://esphome.io)"},
99	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/git.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        raise cv.Invalid(
23	            "git is not installed but required for external_components.\n"
24	            "Please see https://git-scm.com/book/en/v2/Getting-Started-Installing-Git for installing git"
25	        ) from err

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/git.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	        if self.domain == "github.com":
148	            return f"https://raw.githubusercontent.com/{self.owner}/{self.repo}/{self.ref}/{self.filename}"
149	        if self.domain == "gitlab.com":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/git.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	        if self.domain == "gitlab.com":
150	            return f"https://gitlab.com/{self.owner}/{self.repo}/-/raw/{self.ref}/{self.filename}"
151	        raise NotImplementedError(f"Git domain {self.domain} not supported")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
14	
15	IS_MACOS = platform.system() == "Darwin"
16	IS_WINDOWS = platform.system() == "Windows"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
14	
15	IS_MACOS = platform.system() == "Darwin"
16	IS_WINDOWS = platform.system() == "Windows"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:15
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
14	
15	IS_MACOS = platform.system() == "Darwin"
16	IS_WINDOWS = platform.system() == "Windows"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
15	IS_MACOS = platform.system() == "Darwin"
16	IS_WINDOWS = platform.system() == "Windows"
17	IS_LINUX = platform.system() == "Linux"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
15	IS_MACOS = platform.system() == "Darwin"
16	IS_WINDOWS = platform.system() == "Windows"
17	IS_LINUX = platform.system() == "Linux"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
15	IS_MACOS = platform.system() == "Darwin"
16	IS_WINDOWS = platform.system() == "Windows"
17	IS_LINUX = platform.system() == "Linux"

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
16	IS_WINDOWS = platform.system() == "Windows"
17	IS_LINUX = platform.system() == "Linux"
18	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
16	IS_WINDOWS = platform.system() == "Windows"
17	IS_LINUX = platform.system() == "Linux"
18	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:17
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
16	IS_WINDOWS = platform.system() == "Windows"
17	IS_LINUX = platform.system() == "Linux"
18	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
234	        with codecs.open(path, "r", encoding="utf-8") as f_handle:
235	            return f_handle.read()
236	    except OSError as err:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
265	            tmp_path = f_handle.name
266	            f_handle.write(data)
267	        # Newer tempfile implementations create the file with mode 0o600

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
265	            tmp_path = f_handle.name
266	            f_handle.write(data)
267	        # Newer tempfile implementations create the file with mode 0o600

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
267	        # Newer tempfile implementations create the file with mode 0o600
268	        os.chmod(tmp_path, 0o644)
269	        # If destination exists, will be overwritten

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:268
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
267	        # Newer tempfile implementations create the file with mode 0o600
268	        os.chmod(tmp_path, 0o644)
269	        # If destination exists, will be overwritten

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
358	        while True:
359	            blob1, blob2 = fh1.read(bufsize), fh2.read(bufsize)
360	            if blob1 != blob2:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/helpers.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
358	        while True:
359	            blob1, blob2 = fh1.read(bufsize), fh2.read(bufsize)
360	            if blob1 != blob2:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/pins.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
268	        logger.warning(
269	            f"GPIO{num} is a strapping PIN and should only be used for I/O with care.\n"
270	            "Attaching external pullup/down resistors to strapping pins can cause unexpected failures.\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/platformio_api.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    r"Verbose mode can be enabled via `-v, --verbose` option.*",
47	    r"CONFIGURATION: https://docs.platformio.org/.*",
48	    r"DEBUG: Current.*",
49	    r"LDF Modes:.*",
50	    r"LDF: Library Dependency Finder -> https://bit.ly/configure-pio-ldf.*",
51	    f"Looking for {IGNORE_LIB_WARNINGS} library in registry",
52	    f"Warning! Library `.*'{IGNORE_LIB_WARNINGS}.*` has not been found in PlatformIO Registry.",
53	    f"You can ignore this message, if `.*{IGNORE_LIB_WARNINGS}.*` is a built-in library.*",
54	    r"Scanning dependencies...",
55	    r"Found \d+ compatible libraries",
56	    r"Memory Usage -> http://bit.ly/pio-memory-usage",
57	    r"Found: https://platformio.org/lib/show/.*",
58	    r"Using cache: .*",
59	    r"Installing dependencies",
60	    r"Library Manager: Already installed, built-in library",
61	    r"Building in .* mode",
62	    r"Advanced Memory Usage is available via .*",
63	    r"Merged .* ELF section",
64	    r"esptool.py v.*",
65	    r"Checking size .*",
66	    r"Retrieving maximum program size .*",
67	    r"PLATFORM: .*",
68	    r"PACKAGES:.*",
69	    r" - framework-arduinoespressif.* \(.*\)",
70	    r" - tool-esptool.* \(.*\)",
71	    r" - toolchain-.* \(.*\)",
72	    r"Creating BIN file .*",
73	]
74	
75	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/platformio_api.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    r"LDF Modes:.*",
50	    r"LDF: Library Dependency Finder -> https://bit.ly/configure-pio-ldf.*",
51	    f"Looking for {IGNORE_LIB_WARNINGS} library in registry",
52	    f"Warning! Library `.*'{IGNORE_LIB_WARNINGS}.*` has not been found in PlatformIO Registry.",
53	    f"You can ignore this message, if `.*{IGNORE_LIB_WARNINGS}.*` is a built-in library.*",
54	    r"Scanning dependencies...",
55	    r"Found \d+ compatible libraries",
56	    r"Memory Usage -> http://bit.ly/pio-memory-usage",
57	    r"Found: https://platformio.org/lib/show/.*",
58	    r"Using cache: .*",
59	    r"Installing dependencies",
60	    r"Library Manager: Already installed, built-in library",
61	    r"Building in .* mode",
62	    r"Advanced Memory Usage is available via .*",
63	    r"Merged .* ELF section",
64	    r"esptool.py v.*",
65	    r"Checking size .*",
66	    r"Retrieving maximum program size .*",
67	    r"PLATFORM: .*",
68	    r"PACKAGES:.*",
69	    r" - framework-arduinoespressif.* \(.*\)",
70	    r" - tool-esptool.* \(.*\)",
71	    r" - toolchain-.* \(.*\)",
72	    r"Creating BIN file .*",
73	]
74	
75	
76	def run_platformio_cli(*args, **kwargs) -> Union[str, int]:
77	    os.environ["PLATFORMIO_FORCE_COLOR"] = "true"
78	    os.environ["PLATFORMIO_BUILD_DIR"] = os.path.abspath(CORE.relative_pioenvs_path())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/platformio_api.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    r"Found \d+ compatible libraries",
56	    r"Memory Usage -> http://bit.ly/pio-memory-usage",
57	    r"Found: https://platformio.org/lib/show/.*",
58	    r"Using cache: .*",
59	    r"Installing dependencies",
60	    r"Library Manager: Already installed, built-in library",
61	    r"Building in .* mode",
62	    r"Advanced Memory Usage is available via .*",
63	    r"Merged .* ELF section",
64	    r"esptool.py v.*",
65	    r"Checking size .*",
66	    r"Retrieving maximum program size .*",
67	    r"PLATFORM: .*",
68	    r"PACKAGES:.*",
69	    r" - framework-arduinoespressif.* \(.*\)",
70	    r" - tool-esptool.* \(.*\)",
71	    r" - toolchain-.* \(.*\)",
72	    r"Creating BIN file .*",
73	]
74	
75	
76	def run_platformio_cli(*args, **kwargs) -> Union[str, int]:
77	    os.environ["PLATFORMIO_FORCE_COLOR"] = "true"
78	    os.environ["PLATFORMIO_BUILD_DIR"] = os.path.abspath(CORE.relative_pioenvs_path())
79	    os.environ.setdefault(
80	        "PLATFORMIO_LIBDEPS_DIR", os.path.abspath(CORE.relative_piolibdeps_path())
81	    )
82	    cmd = ["platformio"] + list(args)
83	
84	    if not CORE.verbose:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/platformio_api.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    r"Memory Usage -> http://bit.ly/pio-memory-usage",
57	    r"Found: https://platformio.org/lib/show/.*",
58	    r"Using cache: .*",
59	    r"Installing dependencies",
60	    r"Library Manager: Already installed, built-in library",
61	    r"Building in .* mode",
62	    r"Advanced Memory Usage is available via .*",
63	    r"Merged .* ELF section",
64	    r"esptool.py v.*",
65	    r"Checking size .*",
66	    r"Retrieving maximum program size .*",
67	    r"PLATFORM: .*",
68	    r"PACKAGES:.*",
69	    r" - framework-arduinoespressif.* \(.*\)",
70	    r" - tool-esptool.* \(.*\)",
71	    r" - toolchain-.* \(.*\)",
72	    r"Creating BIN file .*",
73	]
74	
75	
76	def run_platformio_cli(*args, **kwargs) -> Union[str, int]:
77	    os.environ["PLATFORMIO_FORCE_COLOR"] = "true"
78	    os.environ["PLATFORMIO_BUILD_DIR"] = os.path.abspath(CORE.relative_pioenvs_path())
79	    os.environ.setdefault(
80	        "PLATFORMIO_LIBDEPS_DIR", os.path.abspath(CORE.relative_piolibdeps_path())
81	    )
82	    cmd = ["platformio"] + list(args)
83	
84	    if not CORE.verbose:
85	        kwargs["filter_lines"] = FILTER_PLATFORMIO_LINES

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/util.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
122	            s = s.replace("\033", "\\033")
123	        self._out.write(s)
124	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/wizard.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
363	        board_link = (
364	            "http://docs.platformio.org/en/latest/platforms/espressif32.html#boards"
365	        )
366	    elif platform == "ESP8266":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/wizard.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
367	        board_link = (
368	            "http://docs.platformio.org/en/latest/platforms/espressif8266.html#boards"
369	        )
370	    elif platform == "RP2040":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/wizard.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
371	        board_link = (
372	            "https://www.raspberrypi.com/documentation/microcontrollers/rp2040.html"
373	        )
374	    elif platform in ["BK72XX", "RTL87XX"]:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/wizard.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
374	    elif platform in ["BK72XX", "RTL87XX"]:
375	        board_link = "https://docs.libretiny.eu/docs/status/supported/"
376	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/wizard.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
486	
487	    if not wizard_write(
488	        path=path,
489	        name=name,
490	        platform=platform,
491	        board=board,
492	        ssid=ssid,
493	        psk=psk,
494	        password=password,
495	    ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/wizard.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
506	    safe_print(
507	        "  > https://esphome.io/guides/getting_started_command_line.html#adding-some-features"
508	    )
509	    safe_print("  > to learn how to customize ESPHome and install it to your device.")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/writer.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
356	        _LOGGER.info("Deleting %s", pioenvs)
357	        shutil.rmtree(pioenvs)
358	    piolibdeps = CORE.relative_piolibdeps_path()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/writer.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
360	        _LOGGER.info("Deleting %s", piolibdeps)
361	        shutil.rmtree(piolibdeps)
362	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/esphome-2025.4.0b1/esphome-2025.4.0b1/esphome/writer.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
375	        with open(file=path, mode="w", encoding="utf-8") as f:
376	            f.write(GITIGNORE_CONTENT)

--------------------------------------------------

Code scanned:
	Total lines of code: 99336
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 104.0
		High: 92.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 184.0
		High: 12.0
Files skipped (0):
