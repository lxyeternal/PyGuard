Run started:2025-04-12 15:18:42.131671

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/cfripper/cli.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
232	        logging.exception(
233	            "Unhandled exception raised, please create an issue with the error message at "
234	            "https://github.com/Skyscanner/cfripper/issues"
235	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/cfripper/config/rule_configs/firehose_ips.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    reason=(
47	        "Exclude Kinesis Data Firehose IPs to allow access from Amazon Redshift Clusters. "
48	        "See https://docs.aws.amazon.com/firehose/latest/dev/controlling-access.html"
49	    ),
50	    rule_mode=RuleMode.ALLOWED,
51	    eval={"and": [{"exists": {"ref": "ingress_ip"}}, {"in": [{"ref": "ingress_ip"}, FIREHOSE_IPS]}]},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/cfripper/model/utils.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    # https://bucket.s3.amazonaws.com/path1/path2
31	    match = re.search(r"^https://([^.]+)\.s3\.amazonaws\.com(.*?)$", url)
32	    if match:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/cfripper/model/utils.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	    # https://bucket.s3.aws-region.amazonaws.com/path1/path2
36	    match = re.search(r"^https://([^.]+)\.s3\.[^\.]+\.amazonaws\.com(.*?)$", url)
37	    if match:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/cfripper/model/utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    # https://bucket.s3-aws-region.amazonaws.com/path1/path2
41	    match = re.search(r"^https://([^.]+)\.s3-[^\.]+\.amazonaws\.com(.*?)$", url)
42	    if match:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/cfripper/model/utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    # https://s3.amazonaws.com/bucket/path1/path2
46	    match = re.search(r"^https://s3\.amazonaws\.com/([^\/]+)(.*?)$", url)
47	    if match:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/cfripper/model/utils.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    # https://s3.aws-region.amazonaws.com/bucket/path1/path2
51	    match = re.search(r"^https://s3\.[^.]+\.amazonaws\.com/([^\/]+)(.*?)$", url)
52	    if match:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/cfripper/model/utils.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    # https://s3-aws-region.amazonaws.com/bucket/path1/path2
56	    match = re.search(r"^https://s3-[^.]+\.amazonaws\.com/([^\/]+)(.*?)$", url)
57	    if match:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/cfripper/rules/privilege_escalation.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	class PrivilegeEscalationRule(BaseDangerousPolicyActions):
11	    f"""
12	    Checks for any dangerous IAM actions that could allow privilege escalation and potentially
13	    represent a large security risk.
14	    See [current blacklisted IAM actions]\
15	(https://github.com/Skyscanner/cfripper/blob/master/cfripper/rules/privilege_escalation.py#L25).
16	
17	    Fix:
18	        Unless strictly necessary, do not use actions in the IAM action blacklist. CloudFormation files that do require
19	        these actions should be added to the allowlist.
20	
21	    {BaseDangerousPolicyActions.DEFAULT_FILTERS_CONTEXT}
22	    """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    [
9	        ("https://cf-templates.s3.amazonaws.com/path/to/template.yml", "cf-templates", "path/to/template.yml"),
10	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        (
11	            "https://cf-templates.s3-eu-central-1.amazonaws.com/path/to/template.yml",
12	            "cf-templates",
13	            "path/to/template.yml",
14	        ),
15	        ("https://s3.amazonaws.com/cf-templates/path/to/template.yml", "cf-templates", "path/to/template.yml"),
16	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	        ),
15	        ("https://s3.amazonaws.com/cf-templates/path/to/template.yml", "cf-templates", "path/to/template.yml"),
16	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        (
17	            "https://s3.eu-central-1.amazonaws.com/cf-templates/path/to/template.yml",
18	            "cf-templates",
19	            "path/to/template.yml",
20	        ),
21	        (
22	            "https://s3-eu-central-1.amazonaws.com/cf-templates/path/to/template.yml",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        (
22	            "https://s3-eu-central-1.amazonaws.com/cf-templates/path/to/template.yml",
23	            "cf-templates",
24	            "path/to/template.yml",
25	        ),
26	        (
27	            "https://cf-templates.s3.eu-central-1.amazonaws.com/path/to/template.yml",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        (
27	            "https://cf-templates.s3.eu-central-1.amazonaws.com/path/to/template.yml",
28	            "cf-templates",
29	            "path/to/template.yml",
30	        ),
31	    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    [
40	        ("https://cf-templatesXs3Xamazonaws.com/path/to/template.yml"),
41	        ("https://cf-templatesXs3-eu-central-1Xamazonaws.com/path/to/template.yml"),
42	        ("https://s3Xamazonaws.com/cf-templates/path/to/template.yml"),
43	        ("https://s3Xeu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
44	        ("https://s3-eu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
45	    ],
46	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        ("https://cf-templatesXs3Xamazonaws.com/path/to/template.yml"),
41	        ("https://cf-templatesXs3-eu-central-1Xamazonaws.com/path/to/template.yml"),
42	        ("https://s3Xamazonaws.com/cf-templates/path/to/template.yml"),
43	        ("https://s3Xeu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
44	        ("https://s3-eu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
45	    ],
46	)
47	def test_extract_bucket_name_and_path_from_url_fail(template_url):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	        ("https://cf-templatesXs3-eu-central-1Xamazonaws.com/path/to/template.yml"),
42	        ("https://s3Xamazonaws.com/cf-templates/path/to/template.yml"),
43	        ("https://s3Xeu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
44	        ("https://s3-eu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
45	    ],
46	)
47	def test_extract_bucket_name_and_path_from_url_fail(template_url):
48	    with pytest.raises(InvalidURLException):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	        ("https://s3Xamazonaws.com/cf-templates/path/to/template.yml"),
43	        ("https://s3Xeu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
44	        ("https://s3-eu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
45	    ],
46	)
47	def test_extract_bucket_name_and_path_from_url_fail(template_url):
48	    with pytest.raises(InvalidURLException):
49	        extract_bucket_name_and_path_from_url(template_url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/model/test_utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	        ("https://s3Xeu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
44	        ("https://s3-eu-central-1XamazonawsXcom/cf-templates/path/to/template.yml"),
45	    ],
46	)
47	def test_extract_bucket_name_and_path_from_url_fail(template_url):
48	    with pytest.raises(InvalidURLException):
49	        extract_bucket_name_and_path_from_url(template_url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/test_boto3_client.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	    result = boto3_client.download_template_to_dictionary(
110	        f"https://s3-eu-west-1.amazonaws.com/{TEST_BUCKET_NAME}/{filename}"
111	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/test_boto3_client.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	    result = boto3_client.download_template_to_dictionary(
123	        f"https://s3-eu-west-1.amazonaws.com/{TEST_BUCKET_NAME}/{filename}"
124	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/test_boto3_client.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	    result = boto3_client.download_template_to_dictionary(
148	        f"https://s3-eu-west-1.amazonaws.com/{TEST_BUCKET_NAME}/{filename}"
149	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/test_boto3_client.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	    result = boto3_client.download_template_to_dictionary(
161	        f"https://s3-eu-west-1.amazonaws.com/{TEST_BUCKET_NAME}/{filename}"
162	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/test_boto3_client.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	    result = boto3_client.download_template_to_dictionary(
177	        f"https://s3-eu-west-1.amazonaws.com/{TEST_BUCKET_NAME}/{filename}"
178	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/test_boto3_client.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	    result = boto3_client.download_template_to_dictionary(
190	        f"https://s3-eu-west-1.amazonaws.com/{TEST_BUCKET_NAME}/{filename}"
191	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/test_boto3_client.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	        boto3_client.download_template_to_dictionary(
206	            f"https://s3-eu-west-1.amazonaws.com/{TEST_BUCKET_NAME}/{filename}"
207	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/test_boto3_client.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	    result = boto3_client.download_template_to_dictionary(
229	        f"https://s3-eu-west-1.amazonaws.com/{TEST_BUCKET_NAME}/{filename}"
230	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/test_boto3_client.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	    result = boto3_client.download_template_to_dictionary(
245	        f"https://s3-eu-west-1.amazonaws.com/{TEST_BUCKET_NAME}/{expected_filename}"
246	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfripper-1.17.0/cfripper-1.17.0/tests/utils.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	    with Path(FIXTURE_ROOT_PATH / path).open() as f:
33	        content = f.read()
34	    return parse(convert_json_or_yaml_to_dict(content))

--------------------------------------------------

Code scanned:
	Total lines of code: 10283
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 1.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 0.0
Files skipped (0):
