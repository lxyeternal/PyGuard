Run started:2025-04-12 13:56:04.438323

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/cli.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	    with open(jsonfile, "w", encoding="utf-8") as file:
57	        file.write(json_dumps(data))
58	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/cli.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
104	            with open(os.path.join(dir_path, filename[:200]), "wb") as file:
105	                file.write(resp.content)
106	    except Exception as ex:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/cli.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
122	    threads = 10 if threads is None else threads
123	    with ThreadPoolExecutor(max_workers=threads) as executor:
124	        futures = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/cli.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	@click.option("-k", "--keywords", required=True, help="text search, keywords for query")
160	@click.option("-r", "--region", default="wt-wt", help="wt-wt, us-en, ru-ru, etc. -region https://duckduckgo.com/params")
161	@click.option("-s", "--safesearch", default="moderate", type=click.Choice(["on", "moderate", "off"]))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/cli.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	@click.option("-k", "--keywords", required=True, help="keywords for query")
213	@click.option("-r", "--region", default="wt-wt", help="wt-wt, us-en, ru-ru, etc. -region https://duckduckgo.com/params")
214	@click.option("-s", "--safesearch", default="moderate", type=click.Choice(["on", "moderate", "off"]))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/cli.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	@click.option("-k", "--keywords", required=True, help="keywords for query")
303	@click.option("-r", "--region", default="wt-wt", help="wt-wt, us-en, ru-ru, etc. -region https://duckduckgo.com/params")
304	@click.option("-s", "--safesearch", default="moderate", type=click.Choice(["on", "moderate", "off"]))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/cli.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
345	@click.option("-k", "--keywords", required=True, help="keywords for query")
346	@click.option("-r", "--region", default="wt-wt", help="wt-wt, us-en, ru-ru, etc. -region https://duckduckgo.com/params")
347	@click.option("-s", "--safesearch", default="moderate", type=click.Choice(["on", "moderate", "off"]))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        self.headers = headers if headers else {}
80	        self.headers["Referer"] = "https://duckduckgo.com/"
81	        self.timeout = timeout

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	        """Get vqd value for a search query."""
160	        resp_content = self._get_url("GET", "https://duckduckgo.com", params={"q": keywords}).content
161	        return _extract_vqd(resp_content, keywords)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	        for _ in range(5):
234	            resp_content = self._get_url("POST", "https://html.duckduckgo.com/html", data=payload).content
235	            if b"No  results." in resp_content:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
250	                        and not href.startswith(
251	                            ("http://www.google.com/search?q=", "https://duckduckgo.com/y.js?ad_domain")
252	                        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
250	                        and not href.startswith(
251	                            ("http://www.google.com/search?q=", "https://duckduckgo.com/y.js?ad_domain")
252	                        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
300	        for _ in range(5):
301	            resp_content = self._get_url("POST", "https://lite.duckduckgo.com/lite/", data=payload).content
302	            if b"No more results." in resp_content:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
319	                            or href.startswith(
320	                                ("http://www.google.com/search?q=", "https://duckduckgo.com/y.js?ad_domain")
321	                            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
319	                            or href.startswith(
320	                                ("http://www.google.com/search?q=", "https://duckduckgo.com/y.js?ad_domain")
321	                            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
422	            resp_content = self._get_url(
423	                "GET", "https://duckduckgo.com/i.js", params=payload, headers={"Referer": "https://duckduckgo.com/"}
424	            ).content
425	            resp_json = json_loads(resp_content)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
422	            resp_content = self._get_url(
423	                "GET", "https://duckduckgo.com/i.js", params=payload, headers={"Referer": "https://duckduckgo.com/"}
424	            ).content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
503	        for _ in range(8):
504	            resp_content = self._get_url("GET", "https://duckduckgo.com/v.js", params=payload).content
505	            resp_json = json_loads(resp_content)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/duckduckgo_search/duckduckgo_search.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
565	        for _ in range(5):
566	            resp_content = self._get_url("GET", "https://duckduckgo.com/news.js", params=payload).content
567	            resp_json = json_loads(resp_content)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/tests/test_cli.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
83	        assert file.is_file()
84	    shutil.rmtree(str(pathname))
85	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/duckduckgo_search-8.0.0/duckduckgo_search-8.0.0/tests/test_cli.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
93	        assert file.is_file()
94	    shutil.rmtree(str(pathname))

--------------------------------------------------

Code scanned:
	Total lines of code: 1024
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 5.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 0.0
Files skipped (0):
