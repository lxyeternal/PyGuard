Run started:2025-04-12 10:58:59.510083

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/codecs/blosc.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
172	    ) -> Buffer:
173	        return await asyncio.to_thread(
174	            as_numpy_array_wrapper, self._blosc_codec.decode, chunk_bytes, chunk_spec.prototype
175	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/codecs/blosc.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	        # between numpy array and buffer
184	        return await asyncio.to_thread(
185	            lambda chunk: chunk_spec.prototype.buffer.from_bytes(
186	                self._blosc_codec.encode(chunk.as_numpy_array())
187	            ),
188	            chunk_bytes,
189	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/core/array.py:1287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1286	            # reading chunks and decoding them
1287	            await self.codec_pipeline.read(
1288	                [
1289	                    (
1290	                        self.store_path / self.metadata.encode_chunk_key(chunk_coords),
1291	                        self.metadata.get_chunk_spec(chunk_coords, _config, prototype=prototype),
1292	                        chunk_selection,
1293	                        out_selection,
1294	                        is_complete_chunk,
1295	                    )
1296	                    for chunk_coords, chunk_selection, out_selection, is_complete_chunk in indexer
1297	                ],
1298	                out_buffer,
1299	                drop_axes=indexer.drop_axes,
1300	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/core/array.py:1415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1414	        # merging with existing data and encoding chunks
1415	        await self.codec_pipeline.write(
1416	            [
1417	                (
1418	                    self.store_path / self.metadata.encode_chunk_key(chunk_coords),
1419	                    self.metadata.get_chunk_spec(chunk_coords, _config, prototype),
1420	                    chunk_selection,
1421	                    out_selection,
1422	                    is_complete_chunk,
1423	                )
1424	                for chunk_coords, chunk_selection, out_selection, is_complete_chunk in indexer
1425	            ],
1426	            value_buffer,
1427	            drop_axes=indexer.drop_axes,
1428	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/core/metadata/v2.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
170	            if fill_value_encoded is not None:
171	                fill_value = base64.standard_b64decode(fill_value_encoded)
172	                _data["fill_value"] = fill_value

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/core/metadata/v2.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
202	            # means we should have a bytes-type fill_value.
203	            fill_value = base64.standard_b64encode(cast(bytes, self.fill_value)).decode("ascii")
204	            zarray_dict["fill_value"] = fill_value

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/core/sync.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
58	        logger.debug("Creating Zarr ThreadPoolExecutor with max_workers=%s", max_workers)
59	        _executor = ThreadPoolExecutor(max_workers=max_workers, thread_name_prefix="zarr_pool")
60	        _get_loop().set_default_executor(_executor)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/core/sync.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
180	                loop[0] = new_loop
181	                iothread[0] = threading.Thread(target=new_loop.run_forever, name="zarr_io")
182	                assert iothread[0] is not None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	            f.seek(byte_range.start)
34	            return prototype.buffer.from_bytes(f.read(byte_range.end - f.tell()))
35	        elif isinstance(byte_range, OffsetByteRequest):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
40	            raise TypeError(f"Unexpected byte_range, got {byte_range}.")
41	        return prototype.buffer.from_bytes(f.read())
42	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	            f.seek(start)
54	            f.write(value.as_numpy_array().tobytes())
55	        return None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	        with path.open(mode=mode) as f:
63	            return f.write(view)
64	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
110	        self._check_writable()
111	        shutil.rmtree(self.root)
112	        self.root.mkdir()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	        try:
138	            return await asyncio.to_thread(_get, path, prototype, byte_range)
139	        except (FileNotFoundError, IsADirectoryError, NotADirectoryError):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175	        path = self.root / key
176	        await asyncio.to_thread(_put, path, value, start=None, exclusive=exclusive)
177	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
206	        if path.is_dir():  # TODO: support deleting directories? shutil.rmtree?
207	            shutil.rmtree(path)
208	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	        else:
209	            await asyncio.to_thread(path.unlink, True)  # Q: we may want to raise if path is missing
210	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
215	        if path.is_dir():
216	            shutil.rmtree(path)
217	        elif path.is_file():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_local.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
226	        path = self.root / key
227	        return await asyncio.to_thread(path.is_file)
228	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_zip.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
158	                if byte_range is None:
159	                    return prototype.buffer.from_bytes(f.read())
160	                elif isinstance(byte_range, RangeByteRequest):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_zip.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	                    f.seek(byte_range.start)
162	                    return prototype.buffer.from_bytes(f.read(byte_range.end - f.tell()))
163	                size = f.seek(0, os.SEEK_END)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/src/zarr/storage/_zip.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
169	                    raise TypeError(f"Unexpected byte_range, got {byte_range}.")
170	                return prototype.buffer.from_bytes(f.read())
171	        except KeyError:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/tests/test_array.py:1420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
1419	    ctx = mp.get_context(method)
1420	    pool = ctx.Pool()
1421	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/tests/test_store/test_core.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	    pytest.importorskip("fsspec")
124	    store_path = await make_store_path("http://foo.com/bar")
125	    assert isinstance(store_path.store, FsspecStore)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/tests/test_store/test_fsspec.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	port = 5555
34	endpoint_url = f"http://127.0.0.1:{port}/"
35	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/tests/test_store/test_fsspec.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
41	    # This fixture is module-scoped, meaning that we can reuse the MotoServer across all tests
42	    server = moto_server.ThreadedMotoServer(ip_address="127.0.0.1", port=port)
43	    server.start()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/tests/test_store/test_fsspec.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
128	        #  make a new, synchronous instance of the filesystem because this test is run in sync code
129	        new_fs = fsspec.filesystem(
130	            "s3", endpoint_url=store.fs.endpoint_url, anon=store.fs.anon, asynchronous=False
131	        )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/tests/test_store/test_fsspec.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
135	        #  make a new, synchronous instance of the filesystem because this test is run in sync code
136	        new_fs = fsspec.filesystem(
137	            "s3", endpoint_url=store.fs.endpoint_url, anon=store.fs.anon, asynchronous=False
138	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/tests/test_store/test_fsspec.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	
265	    store = FsspecStore.from_url("https://test/path")
266	

--------------------------------------------------

Code scanned:
	Total lines of code: 27983
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 0.0
Files skipped (1):
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/zarr-3.0.6/zarr-3.0.6/tests/test_indexing.py (syntax error while parsing AST from file)
