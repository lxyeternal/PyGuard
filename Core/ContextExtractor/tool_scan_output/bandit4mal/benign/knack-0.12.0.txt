Run started:2025-04-12 14:11:37.387990

Test results:
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/cli.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
123	        version_info = '\n\n'
124	        version_info += 'Python ({}) {}'.format(platform.system(), sys.version)
125	        version_info += '\n\n'

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/cli.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
123	        version_info = '\n\n'
124	        version_info += 'Python ({}) {}'.format(platform.system(), sys.version)
125	        version_info += '\n\n'

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/cli.py:124
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
123	        version_info = '\n\n'
124	        version_info += 'Python ({}) {}'.format(platform.system(), sys.version)
125	        version_info += '\n\n'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/config.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	        if os.path.exists(config_path):
195	            self.config_parser.read(config_path, encoding=CONFIG_FILE_ENCODING)
196	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/config.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
226	            if self.config_comment:
227	                configfile.write(self.config_comment + '\n')
228	            config.write(configfile)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/config.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
227	                configfile.write(self.config_comment + '\n')
228	            config.write(configfile)
229	        os.chmod(self.config_path, stat.S_IRUSR | stat.S_IWUSR)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/config.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
228	            config.write(configfile)
229	        os.chmod(self.config_path, stat.S_IRUSR | stat.S_IWUSR)
230	        self.config_parser.read(self.config_path)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/config.py:229
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
228	            config.write(configfile)
229	        os.chmod(self.config_path, stat.S_IRUSR | stat.S_IWUSR)
230	        self.config_parser.read(self.config_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/config.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
229	        os.chmod(self.config_path, stat.S_IRUSR | stat.S_IWUSR)
230	        self.config_parser.read(self.config_path)
231	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/config.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	        config = configparser.ConfigParser()
234	        config.read(self.config_path)
235	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/query.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	        arg_group.add_argument('--query', dest='_jmespath_query', metavar='JMESPATH',
33	                               help='JMESPath query string. See http://jmespath.org/ for more'
34	                                    ' information and examples.',
35	                               type=CLIQuery.jmespath_type)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/testsdk/base.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	            for _ in range(size_kb):
54	                f.write(chunk)
55	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/testsdk/base.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
53	            for _ in range(size_kb):
54	                f.write(chunk)
55	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/knack/testsdk/base.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
63	        temp_dir = tempfile.mkdtemp()
64	        self.addCleanup(lambda: shutil.rmtree(temp_dir, ignore_errors=True))
65	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/setup.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    author_email='azpycli@microsoft.com',
33	    url='https://github.com/microsoft/knack',
34	    zip_safe=False,

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/test_config.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
19	    if os.path.exists(local_temp_folders):
20	        shutil.rmtree(local_temp_folders)
21	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/test_config.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
213	        import platform
214	        if platform.system() != 'Windows':
215	            # Not shown

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/test_config.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
213	        import platform
214	        if platform.system() != 'Windows':
215	            # Not shown

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/test_config.py:214
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
213	        import platform
214	        if platform.system() != 'Windows':
215	            # Not shown

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/test_config.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
229	        config = configparser.ConfigParser()
230	        config.read(self.cli_config.config_path)
231	        self.assertEqual(config.get('test_section', 'test_option'), 'a_value')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/test_help.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
262	            self.cli_ctx.invoke('n5 -h'.split())
263	        expected = """
264	Command
265	    {} n5 : This module does xyz one-line or so.
266	        This module.... kjsdflkj... klsfkj paragraph1
267	        this module.... kjsdflkj... klsfkj paragraph2.
268	
269	Arguments
270	    --foobar  [Required] : One line partial sentence.  Values from: mycli abc xyz, default.
271	        Text, markdown, etc.
272	    --foobar2 [Required] : One line partial sentence.
273	        Paragraph(s).
274	    --foobar3            : The foobar3.
275	
276	Global Arguments
277	    --debug              : Increase logging verbosity to show all debug logs.
278	    --help -h            : Show this help message and exit.
279	    --only-show-errors   : Only show errors, suppressing warnings.
280	    --output -o          : Output format.  Allowed values: json, jsonc, none, table, tsv, yaml,
281	                           yamlc.  Default: json.
282	    --query              : JMESPath query string. See http://jmespath.org/ for more information and
283	                           examples.
284	    --verbose            : Increase logging verbosity. Use --debug for full debug logs.
285	
286	Examples
287	    foo example
288	        example details
289	
290	"""
291	        actual = self.io.getvalue()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/test_help.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
300	            self.cli_ctx.invoke('n1 --arg 1 -h'.split())
301	        expected = """
302	Command
303	    {} n1 : Short summary here.
304	        Long summary here. Still long summary.
305	
306	Arguments
307	    -b      [Required] : Allowed values: a, b, c.
308	    --arg -a           : Allowed values: 1, 2, 3.
309	    --arg3
310	
311	Global Arguments
312	    --debug            : Increase logging verbosity to show all debug logs.
313	    --help -h          : Show this help message and exit.
314	    --only-show-errors : Only show errors, suppressing warnings.
315	    --output -o        : Output format.  Allowed values: json, jsonc, none, table, tsv, yaml, yamlc.
316	                         Default: json.
317	    --query            : JMESPath query string. See http://jmespath.org/ for more information and
318	                         examples.
319	    --verbose          : Increase logging verbosity. Use --debug for full debug logs.
320	
321	"""
322	        actual = self.io.getvalue()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/test_help.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
416	            self.cli_ctx.invoke('n1 -h'.split())
417	        s = """
418	Command
419	    {} n1 : Short summary here.
420	        Long summary here. Still long summary.
421	
422	Arguments
423	    -b      [Required] : Allowed values: a, b, c.
424	    --arg -a           : Allowed values: 1, 2, 3.
425	    --arg3
426	
427	Global Arguments
428	    --debug            : Increase logging verbosity to show all debug logs.
429	    --exampl           : This is a new global argument.
430	    --help -h          : Show this help message and exit.
431	    --only-show-errors : Only show errors, suppressing warnings.
432	    --output -o        : Output format.  Allowed values: json, jsonc, none, table, tsv, yaml, yamlc.
433	                         Default: json.
434	    --query            : JMESPath query string. See http://jmespath.org/ for more information and
435	                         examples.
436	    --verbose          : Increase logging verbosity. Use --debug for full debug logs.
437	
438	"""
439	        actual = self.io.getvalue()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/test_parser.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
162	            with open(file, 'w') as f:
163	                f.write(contents)
164	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/knack-0.12.0/knack-0.12.0/tests/util.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
92	    if os.path.exists(temp_dir):
93	        shutil.rmtree(temp_dir)
94	    os.mkdir(temp_dir)

--------------------------------------------------

Code scanned:
	Total lines of code: 6582
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 3.0
Files skipped (0):
