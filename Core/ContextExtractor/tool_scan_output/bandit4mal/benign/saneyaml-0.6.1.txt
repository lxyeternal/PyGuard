Run started:2025-04-12 11:11:16.024110

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/docs/source/conf.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	intersphinx_mapping = {
39	    "aboutcode": ("https://aboutcode.readthedocs.io/en/latest/", None),
40	    "scancode-workbench": ("https://scancode-workbench.readthedocs.io/en/develop/", None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/docs/source/conf.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    "aboutcode": ("https://aboutcode.readthedocs.io/en/latest/", None),
40	    "scancode-workbench": ("https://scancode-workbench.readthedocs.io/en/develop/", None),
41	}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/gen_pypi_simple.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
163	        with open(archive_file, "rb") as f:
164	            checksum = hashlib.sha256(f.read()).hexdigest()
165	        return cls(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/gen_pypi_simple.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
178	
179	def build_pypi_index(directory, base_url="https://thirdparty.aboutcode.org/pypi"):
180	    """

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/gen_pypi_simple.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
193	    if index_dir.exists():
194	        shutil.rmtree(str(index_dir), ignore_errors=True)
195	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_dejacode.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	
24	DEJACODE_API_KEY = os.environ.get("DEJACODE_API_KEY", "")
25	DEJACODE_API_URL = os.environ.get("DEJACODE_API_URL", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_dejacode.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	DEJACODE_API_KEY = os.environ.get("DEJACODE_API_KEY", "")
25	DEJACODE_API_URL = os.environ.get("DEJACODE_API_URL", "")
26	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_dejacode.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	
50	    response = requests.get(
51	        DEJACODE_API_URL_PACKAGES,
52	        params=params,
53	        headers=DEJACODE_API_HEADERS,
54	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_dejacode.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	        about_url = f"{package_api_url}about"
97	        response = requests.get(about_url, headers=DEJACODE_API_HEADERS)
98	        # note that this is YAML-formatted

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_dejacode.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	        about_url = f"{package_api_url}about_files"
117	        response = requests.get(about_url, headers=DEJACODE_API_HEADERS)
118	        about_zip = response.content

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_dejacode.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
200	
201	    response = requests.post(
202	        DEJACODE_API_URL_PACKAGES,
203	        data=new_package_payload,
204	        headers=DEJACODE_API_HEADERS,
205	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_requirements.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	    with open(requirements_file) as reqs:
29	        req_lines = reqs.read().splitlines(False)
30	    return get_required_name_versions(req_lines, with_unpinned=with_unpinned)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_requirements.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
83	    with open(requirements_file, "w") as fo:
84	        fo.write(get_installed_reqs(site_packages_dir=site_packages_dir))
85	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_requirements.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	    with open(dev_requirements_file, "w") as fo:
107	        fo.write(new_reqs)
108	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	
190	ABOUT_BASE_URL = "https://thirdparty.aboutcode.org/pypi"
191	ABOUT_PYPI_SIMPLE_URL = f"{ABOUT_BASE_URL}/simple"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	ABOUT_LINKS_URL = f"{ABOUT_PYPI_SIMPLE_URL}/links.html"
193	PYPI_SIMPLE_URL = "https://pypi.org/simple"
194	PYPI_INDEX_URLS = (PYPI_SIMPLE_URL, ABOUT_PYPI_SIMPLE_URL)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
211	
212	LICENSEDB_API_URL = "https://scancode-licensedb.aboutcode.org"
213	
214	LICENSING = license_expression.Licensing()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:679
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
678	                with open(location) as fi:
679	                    existing_content = fi.read()
680	                if existing_content == content:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
685	            with open(location, "w") as fo:
686	                fo.write(content)
687	            return True

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
685	            with open(location, "w") as fo:
686	                fo.write(content)
687	            return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
717	                with open(about_path) as fi:
718	                    about_data = saneyaml.load(fi.read())
719	                    if not about_data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
744	                with open(notice_loc) as fi:
745	                    about_data["notice_text"] = fi.read()
746	        return self.update(about_data, keep_extra=True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
753	        try:
754	            about_text = CACHE.get(
755	                path_or_url=self.about_download_url,
756	                as_text=True,
757	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
767	            try:
768	                notice_text = CACHE.get(
769	                    path_or_url=self.notice_download_url,
770	                    as_text=True,
771	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:803
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
802	            csv = getattr(self, csk)
803	            rcv = real_checksums.get(csk)
804	            if csv and rcv and csv != rcv:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
825	        errors = []
826	        extra_lic_names = [l.get("file") for l in self.extra_data.get("licenses", {})]
827	        extra_lic_names += [self.extra_data.get("license_file")]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
825	        errors = []
826	        extra_lic_names = [l.get("file") for l in self.extra_data.get("licenses", {})]
827	        extra_lic_names += [self.extra_data.get("license_file")]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:827
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
826	        extra_lic_names = [l.get("file") for l in self.extra_data.get("licenses", {})]
827	        extra_lic_names += [self.extra_data.get("license_file")]
828	        extra_lic_names = [ln for ln in extra_lic_names if ln]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:895
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
894	                    with open(pi) as fi:
895	                        return fi.read()
896	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:953
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
952	        """
953	        package_url = data.get("package_url")
954	        if package_url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1681	        else:
1682	            return self._get_package_versions_map(name).get(version)
1683	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1689	        package_url = f"{self.index_url}/{normalized_name}"
1690	        text = CACHE.get(
1691	            path_or_url=package_url,
1692	            as_text=True,
1693	            force=not self.use_cached_index,
1694	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1756	
1757	        text = CACHE.get(
1758	            path_or_url=links_url,
1759	            as_text=True,
1760	            force=not self.use_cached_index,
1761	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1847	            with open(cached, wmode) as fo:
1848	                fo.write(content)
1849	            return content

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1847	            with open(cached, wmode) as fo:
1848	                fo.write(content)
1849	            return content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1888	    with open(path, mode) as fo:
1889	        return fo.read()
1890	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1917	    print(f"    DOWNLOADING: {url}")
1918	    with requests.get(url, allow_redirects=True, stream=True, headers=headers) as response:
1919	        status = response.status_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1953
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1952	    """
1953	    content = CACHE.get(
1954	        path_or_url=path_or_url,
1955	        as_text=as_text,
1956	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1959	    with open(output, wmode) as fo:
1960	        fo.write(content)
1961	    return content

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/etc/scripts/utils_thirdparty.py:1960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1959	    with open(output, wmode) as fo:
1960	        fo.write(content)
1961	    return content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/tests/test_saneyaml.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	        test_file_without_tag = get_test_loc('ruby_tags/metadata1.notag')
48	        with_tags = saneyaml.load(open(test_file_with_tag, 'rb').read())
49	        without_tags = saneyaml.load(open(test_file_without_tag, 'rb').read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/tests/test_saneyaml.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	        with_tags = saneyaml.load(open(test_file_with_tag, 'rb').read())
49	        without_tags = saneyaml.load(open(test_file_without_tag, 'rb').read())
50	        assert with_tags == without_tags

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/tests/test_saneyaml.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175	        with io.open(test_file, encoding='utf-8') as inp:
176	            test_load = saneyaml.load(inp.read())
177	            test_dump = saneyaml.dump(test_load)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/tests/test_saneyaml.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
183	            with io.open(expected_dump_file, 'w', encoding='utf-8') as out:
184	                out.write(test_dump)
185	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/saneyaml-0.6.1/saneyaml-0.6.1/tests/test_saneyaml.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
189	        with io.open(expected_dump_file, encoding='utf-8') as inp:
190	            expected_dump = inp.read()
191	

--------------------------------------------------

Code scanned:
	Total lines of code: 3590
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 39.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 45.0
		High: 0.0
Files skipped (0):
