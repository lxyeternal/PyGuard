Run started:2025-04-12 14:01:05.668906

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	        if scheme in {"ws", "wss"}:
158	            subprotocol = request.headers.get("sec-websocket-protocol", None)
159	            if subprotocol is None:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
214	                try:
215	                    chunk = body.send(None)
216	                    if isinstance(chunk, str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
239	                    (key.decode(), value.decode())
240	                    for key, value in message.get("headers", [])
241	                ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	                ), 'Received "http.response.body" after response completed.'
254	                body = message.get("body", b"")
255	                more_body = message.get("more_body", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254	                body = message.get("body", b"")
255	                more_body = message.get("more_body", False)
256	                if request.method != "HEAD":

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
314	            _: "Future[None]" = self.portal.start_task_soon(self._run)
315	            self.send({"type": "websocket.connect"})
316	            message = self.receive()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
316	            message = self.receive()
317	            self._raise_on_close(message)
318	        except Exception:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
318	        except Exception:
319	            self.exit_stack.close()
320	            raise

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	            raise
321	        self.accepted_subprotocol = message.get("subprotocol", None)
322	        self.extra_headers = message.get("headers", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
321	        self.accepted_subprotocol = message.get("subprotocol", None)
322	        self.extra_headers = message.get("headers", None)
323	        return self

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
326	        try:
327	            self.close(1000)
328	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
328	        finally:
329	            self.exit_stack.close()
330	        while not self._send_queue.empty():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	        while not self._send_queue.empty():
331	            message = self._send_queue.get()
332	            if isinstance(message, BaseException):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
350	            await anyio.sleep(0)
351	        return self._receive_queue.get()
352	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
357	        if message["type"] == "websocket.close":
358	            raise WebSocketDisconnect(
359	                message.get("code", 1000), message.get("reason", "")
360	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	            raise WebSocketDisconnect(
359	                message.get("code", 1000), message.get("reason", "")
360	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	            raise WebSocketDisconnect(
359	                message.get("code", 1000), message.get("reason", "")
360	            )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
365	    def send_text(self, data: str) -> None:
366	        self.send({"type": "websocket.receive", "text": data})
367	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
368	    def send_bytes(self, data: bytes) -> None:
369	        self.send({"type": "websocket.receive", "bytes": data})
370	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
374	        if mode == "text":
375	            self.send({"type": "websocket.receive", "text": text})
376	        else:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
376	        else:
377	            self.send({"type": "websocket.receive", "bytes": text.encode("utf-8")})
378	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
379	    def close(self, code: int = 1000) -> None:
380	        self.send({"type": "websocket.disconnect", "code": code})
381	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
382	    def receive(self) -> Message:
383	        message = self._send_queue.get()
384	        if isinstance(message, BaseException):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
389	        message = self.receive()
390	        self._raise_on_close(message)
391	        return message["text"]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
394	        message = self.receive()
395	        self._raise_on_close(message)
396	        return message["bytes"]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
400	        message = self.receive()
401	        self._raise_on_close(message)
402	        if mode == "text":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
416	        app: typing.Union[ASGI2App, ASGI3App],
417	        base_url: str = "http://testserver",
418	        raise_server_exceptions: bool = True,
419	        root_path: str = "",
420	        backend: str = "asyncio",
421	        backend_options: typing.Optional[typing.Dict[str, typing.Any]] = None,
422	    ) -> None:
423	        super().__init__()
424	        self.async_backend = _AsyncBackend(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
476	        url = urljoin(self.base_url, url)
477	        return super().request(
478	            method,
479	            url,
480	            params=params,
481	            data=data,
482	            headers=headers,
483	            cookies=cookies,
484	            files=files,
485	            auth=auth,
486	            timeout=timeout,
487	            allow_redirects=allow_redirects,  # type: ignore
488	            proxies=proxies,
489	            hooks=hooks,
490	            stream=stream,
491	            verify=verify,
492	            cert=cert,
493	            json=json,
494	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
476	        url = urljoin(self.base_url, url)
477	        return super().request(
478	            method,
479	            url,
480	            params=params,
481	            data=data,
482	            headers=headers,
483	            cookies=cookies,
484	            files=files,
485	            auth=auth,
486	            timeout=timeout,
487	            allow_redirects=allow_redirects,  # type: ignore
488	            proxies=proxies,
489	            hooks=hooks,
490	            stream=stream,
491	            verify=verify,
492	            cert=cert,
493	            json=json,
494	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
499	        url = urljoin("ws://testserver", url)
500	        headers = kwargs.get("headers", {})
501	        headers.setdefault("connection", "upgrade")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
507	        try:
508	            super().request("GET", url, **kwargs)
509	        except _Upgrade as exc:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
507	        try:
508	            super().request("GET", url, **kwargs)
509	        except _Upgrade as exc:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
543	    def __exit__(self, *args: typing.Any) -> None:
544	        self.exit_stack.close()
545	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
550	        finally:
551	            await self.stream_send.send(None)
552	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
553	    async def wait_startup(self) -> None:
554	        await self.stream_receive.send({"type": "lifespan.startup"})
555	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/starlette_testclient/_testclient.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
577	        async with self.stream_send:
578	            await self.stream_receive.send({"type": "lifespan.shutdown"})
579	            message = await receive()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/tests/test_testclient.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
174	        async def inner(receive, send):
175	            await send(
176	                {
177	                    "type": "http.response.start",
178	                    "status": 200,
179	                    "headers": [[b"content-type", b"text/plain"]],
180	                }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/tests/test_testclient.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
181	            )
182	            await send({"type": "http.response.body", "body": b"Hello, world!"})
183	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/tests/test_testclient.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
192	    async def app(scope, receive, send):
193	        await send(
194	            {
195	                "type": "http.response.start",
196	                "status": 200,
197	                "headers": [[b"content-type", b"text/plain"]],
198	            }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/tests/test_testclient.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
199	        )
200	        await send({"type": "http.response.body", "body": b"Hello, world!"})
201	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/starlette_testclient-0.4.1/starlette_testclient-0.4.1/tests/test_testclient.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
226	    client = test_client_factory(app)
227	    with client.websocket_connect("/") as websocket:
228	        data = websocket.receive_json()

--------------------------------------------------

Code scanned:
	Total lines of code: 695
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 40.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 0.0
Files skipped (0):
