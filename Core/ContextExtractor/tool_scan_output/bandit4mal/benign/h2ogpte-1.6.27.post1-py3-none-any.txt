Run started:2025-04-12 18:10:50.417834

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/connectors.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
130	        with open(self.path_to_json_key_file, "rb") as file:
131	            key = file.read()
132	            encoded = base64.b64encode(key).decode("ascii")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/connectors.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
131	            key = file.read()
132	            encoded = base64.b64encode(key).decode("ascii")
133	            return {

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/connectors.py:132
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
131	            key = file.read()
132	            encoded = base64.b64encode(key).decode("ascii")
133	            return {

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_async.py:3272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3271	        if isinstance(file, io.StringIO) or isinstance(file, io.TextIOBase):
3272	            file = io.BytesIO(file.read().encode("utf8"))
3273	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_async.py:3465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3464	        async with aiofiles.open(destination_file, "wb") as f:
3465	            await f.write(res.content)
3466	        return destination_file

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_sync_base.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
137	    def _post(self, slug: str, data: Any):
138	        res = requests.post(
139	            f"{self._address}{slug}",
140	            data=data,
141	            headers={**self._get_auth_header(), **{"Content-Type": "application/json"}},
142	            verify=self._verify,
143	            timeout=H2OGPTESyncBase.TIMEOUT,
144	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_sync_base.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
153	        }
154	        res = requests.post(
155	            f"{self._address}{slug}",
156	            data=data,
157	            headers=headers,
158	            verify=self._verify,
159	            timeout=H2OGPTESyncBase.TIMEOUT,
160	            stream=True,
161	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_sync_base.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
191	    def _db(self, method: str, *args: Any) -> Any:
192	        return self._post("/rpc/db", marshal([method, *args]))
193	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_sync_base.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
195	        request_id = str(uuid.uuid4())
196	        return self._post("/rpc/job", marshal([method, kwargs, request_id]))
197	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_sync_base.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
198	    def _lang(self, method: str, **kwargs: Any) -> Any:
199	        res = self._post("/rpc/lang", marshal(dict(method=method, params=kwargs)))
200	        ret = res["result"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_sync_base.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	        ret = res["result"]
201	        if isinstance(ret, dict) and ret.get("error"):
202	            raise SessionError(ret["error"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_sync_base.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
205	    def _crawl_func(self, name: str, **kwargs: Any) -> Any:
206	        response = self._post("/rpc/crawl/func", marshal([name, kwargs]))
207	        return response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_sync_base.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	def _to_id(data: Dict[str, Any]) -> str:
260	    if data is not None and isinstance(data, dict) and data.get("error", ""):
261	        raise ValueError(data.get("error", ""))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/h2ogpte_sync_base.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	    if data is not None and isinstance(data, dict) and data.get("error", ""):
261	        raise ValueError(data.get("error", ""))
262	    return Identifier(**data).id

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/rest/api_client.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
554	                    filename = os.path.basename(f.name)
555	                    filedata = f.read()
556	            elif isinstance(v, bytes):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/rest/api_client.py:711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
710	        with open(path, "wb") as f:
711	            f.write(response.data)
712	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/rest/api_client.py:711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
710	        with open(path, "wb") as f:
711	            f.write(response.data)
712	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/rest/configuration.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	        """
189	        self._base_path = "https://h2ogpte.genai.h2o.ai/api/v1" if host is None else host
190	        """Default Base url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/rest/configuration.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
511	            {
512	                'url': "https://h2ogpte.genai.h2o.ai/api/v1",
513	                'description': "No description provided",
514	            }
515	        ]

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/rest/rest.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
39	        if self.data is None:
40	            self.data = await self.response.read()
41	        return self.data

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/rest/rest.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
212	
213	        r = await pool_manager.request(**args)
214	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
123	            try:
124	                self.disconnect()
125	            except Exception:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
145	            try:
146	                self._connection = ws_connect(
147	                    self._address,
148	                    additional_headers=auth_headers,
149	                    ssl_context=ssl_context,
150	                    open_timeout=self._open_timeout,
151	                    close_timeout=self._close_timeout,
152	                )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
405	            try:
406	                self.connection.send(serialize(request))
407	                break

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
405	            try:
406	                self.connection.send(serialize(request))
407	                break

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
414	                print(f"Send failed: {e}, retrying...", file=sys.stderr)
415	                self.connect()
416	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
422	                    try:
423	                        res = self.connection.recv(deadline - time.time())
424	                        assert isinstance(res, str)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
485	                )
486	                self.connect()
487	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
495	            try:
496	                self._connection.close(code=1000, reason="Client disconnecting")
497	            except Exception as e:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
502	    def __enter__(self):
503	        self.connect()
504	        return self

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
511	    ) -> None:
512	        self.disconnect()
513	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session_async.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
303	        async def send_recv_query() -> ChatMessage:
304	            await self.websocket.send(serialized)
305	            info = _QueryInfo(correlation_id=correlation_id, callback=callback)

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session_async.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
303	        async def send_recv_query() -> ChatMessage:
304	            await self.websocket.send(serialized)
305	            info = _QueryInfo(correlation_id=correlation_id, callback=callback)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session_async.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
325	                await asyncio.sleep(0.5)
326	                await self.connect()
327	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session_async.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
336	                await asyncio.sleep(0.5)
337	                await self.connect()
338	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session_async.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
339	    async def _poll(self) -> None:
340	        res = await self.websocket.recv()
341	        assert isinstance(res, str)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session_async.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
427	            try:
428	                self._websocket = await ws_old_connect(
429	                    uri=f"{scheme}://{url.netloc}/ws?currentSessionID={self._chat_session_id}",
430	                    extra_headers=headers,
431	                    open_timeout=self._open_timeout,
432	                    close_timeout=self._close_timeout,
433	                    ssl=ssl_context,
434	                )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session_async.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
461	    async def __aenter__(self) -> "SessionAsync":
462	        await self.connect()
463	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/h2ogpte-1.6.27.post1-py3-none-any/h2ogpte/session_async.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
476	    ) -> None:
477	        await self.websocket.close()
478	

--------------------------------------------------

Code scanned:
	Total lines of code: 44935
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 36.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 38.0
		High: 1.0
Files skipped (0):
