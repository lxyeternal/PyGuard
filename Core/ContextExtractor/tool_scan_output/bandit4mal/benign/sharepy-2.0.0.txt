Run started:2025-04-12 17:07:53.980457

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/setup.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
10	with open(path.join(DIR, './README.md')) as f:
11	    long_description = f.read()
12	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/setup.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    author_email='jonathan.holvey@outlook.com',
22	    url='https://github.com/JonathanHolvey/sharepy',
23	    project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    project_urls={
24	        'Issues': 'https://github.com/JonathanHolvey/sharepy/issues',
25	    },
26	    license='GPLv3',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/adfs.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	MSO_AUTH_URL = 'https://login.microsoftonline.com/rst2.srf'
16	
17	
18	class SharePointADFS(BaseAuth):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/adfs.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
53	        # Request security token from Microsoft Online
54	        response = requests.post(self.login_url, data=saml, headers=headers)
55	        # Parse and extract assertion from returned XML

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/adfs.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
70	                                                        endpoint='sharepoint.com')
71	        response = requests.post(url=MSO_AUTH_URL, data=saml, headers=headers)
72	        # Parse and extract token from returned XML

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/adfs.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	                   'User-Agent': ''}
87	        response = requests.get(url=idcrl_url, headers=headers)
88	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/adfs.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	            request_url = f'https://{self.site}/_vti_bin/sites.asmx'
101	            headers = ({'SOAPAction': 'http://schemas.microsoft.com/'
102	                       'sharepoint/soap/GetUpdatedFormDigestInformation',
103	                        'Host': self.site,
104	                        'Content-Type': 'text/xml;charset=utf-8',
105	                        'Cookie': self.cookie,
106	                        'X-RequestForceAuthentication': 'true'})
107	            digest_envelope = templates.load('adfs-digest.saml')

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/adfs.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
107	            digest_envelope = templates.load('adfs-digest.saml')
108	            response = requests.post(request_url, data=digest_envelope, headers=headers)
109	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/detect.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    """Detect the correct auth class to use for a SharePoint login"""
18	    url = 'https://login.microsoftonline.com/GetUserRealm.srf?login={}&xml=1'
19	    realm = et.fromstring(requests.get(url.format(escape(username))).text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/detect.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	    url = 'https://login.microsoftonline.com/GetUserRealm.srf?login={}&xml=1'
19	    realm = et.fromstring(requests.get(url.format(escape(username))).text)
20	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/spol.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
39	        # Request security token from Microsoft Online
40	        response = requests.post(self.login_url, data=saml)
41	        # Parse and extract token from returned XML

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/spol.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	        cookie_url = f'https://{self.site}/_forms/default.aspx?wa=wsignin1.0'
57	        response = requests.post(cookie_url, data=self.token, headers={'Host': self.site})
58	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/spol.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	        test_url = f'https://{self.site}/_api/web'
63	        response = requests.get(test_url, headers={'Cookie': cookie})
64	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/spol.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
74	            digest_url = f'https://{self.site}/_api/contextinfo'
75	            response = requests.post(digest_url, data='', headers={'Cookie': self.cookie})
76	            # Parse digest text and timeout from XML

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/spol.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	        domain = realm.find('CloudInstanceName').text
102	        return f'https://login.{domain}/extSTS.srf'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/templates/__init__.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
6	    with open(os.path.join(os.path.dirname(__file__), filename), 'r') as file:
7	        return file.read()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/xml.py:2
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	namespaces = {
2	    'd': 'http://schemas.microsoft.com/ado/2007/08/dataservices',
3	    'ds': 'http://www.w3.org/2000/09/xmldsig#',
4	    'ec': 'http://www.w3.org/2001/10/xml-exc-c14n#',
5	    'psf': 'http://schemas.microsoft.com/Passport/SoapServices/SOAPFault',
6	    'S': 'http://www.w3.org/2003/05/soap-envelope',
7	    'saml': 'urn:oasis:names:tc:SAML:1.0:assertion',
8	    'soap': 'http://schemas.microsoft.com/sharepoint/soap/',
9	    'wsse': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd',
10	    'xs': 'http://www.w3.org/2001/XMLSchema',
11	    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',
12	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/xml.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	    'd': 'http://schemas.microsoft.com/ado/2007/08/dataservices',
3	    'ds': 'http://www.w3.org/2000/09/xmldsig#',
4	    'ec': 'http://www.w3.org/2001/10/xml-exc-c14n#',
5	    'psf': 'http://schemas.microsoft.com/Passport/SoapServices/SOAPFault',
6	    'S': 'http://www.w3.org/2003/05/soap-envelope',
7	    'saml': 'urn:oasis:names:tc:SAML:1.0:assertion',
8	    'soap': 'http://schemas.microsoft.com/sharepoint/soap/',
9	    'wsse': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd',
10	    'xs': 'http://www.w3.org/2001/XMLSchema',
11	    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',
12	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/xml.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	    'ds': 'http://www.w3.org/2000/09/xmldsig#',
4	    'ec': 'http://www.w3.org/2001/10/xml-exc-c14n#',
5	    'psf': 'http://schemas.microsoft.com/Passport/SoapServices/SOAPFault',
6	    'S': 'http://www.w3.org/2003/05/soap-envelope',
7	    'saml': 'urn:oasis:names:tc:SAML:1.0:assertion',
8	    'soap': 'http://schemas.microsoft.com/sharepoint/soap/',
9	    'wsse': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd',
10	    'xs': 'http://www.w3.org/2001/XMLSchema',
11	    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',
12	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/xml.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	    'ec': 'http://www.w3.org/2001/10/xml-exc-c14n#',
5	    'psf': 'http://schemas.microsoft.com/Passport/SoapServices/SOAPFault',
6	    'S': 'http://www.w3.org/2003/05/soap-envelope',
7	    'saml': 'urn:oasis:names:tc:SAML:1.0:assertion',
8	    'soap': 'http://schemas.microsoft.com/sharepoint/soap/',
9	    'wsse': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd',
10	    'xs': 'http://www.w3.org/2001/XMLSchema',
11	    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',
12	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/xml.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	    'psf': 'http://schemas.microsoft.com/Passport/SoapServices/SOAPFault',
6	    'S': 'http://www.w3.org/2003/05/soap-envelope',
7	    'saml': 'urn:oasis:names:tc:SAML:1.0:assertion',
8	    'soap': 'http://schemas.microsoft.com/sharepoint/soap/',
9	    'wsse': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd',
10	    'xs': 'http://www.w3.org/2001/XMLSchema',
11	    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',
12	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/xml.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	    'saml': 'urn:oasis:names:tc:SAML:1.0:assertion',
8	    'soap': 'http://schemas.microsoft.com/sharepoint/soap/',
9	    'wsse': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd',
10	    'xs': 'http://www.w3.org/2001/XMLSchema',
11	    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',
12	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/xml.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    'soap': 'http://schemas.microsoft.com/sharepoint/soap/',
9	    'wsse': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd',
10	    'xs': 'http://www.w3.org/2001/XMLSchema',
11	    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',
12	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/xml.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	    'wsse': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd',
10	    'xs': 'http://www.w3.org/2001/XMLSchema',
11	    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',
12	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/auth/xml.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    'xs': 'http://www.w3.org/2001/XMLSchema',
11	    'xsi': 'http://www.w3.org/2001/XMLSchema-instance',
12	}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/session.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	        # Request file in stream mode
75	        response = self.get(url, *args, **kwargs)
76	        # Save to output file

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sharepy-2.0.0/sharepy-2.0.0/src/sharepy/session.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
79	                for chunk in response:
80	                    file.write(chunk)
81	        return response

--------------------------------------------------

Code scanned:
	Total lines of code: 368
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 0.0
Files skipped (0):
