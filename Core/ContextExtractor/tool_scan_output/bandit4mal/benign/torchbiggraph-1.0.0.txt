Run started:2025-04-12 14:11:20.467188

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/docs/source/conf.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	intersphinx_mapping = {
187	    'numpy': ('http://docs.scipy.org/doc/numpy/', None),
188	    'python': ('https://docs.python.org/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/docs/source/conf.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
187	    'numpy': ('http://docs.scipy.org/doc/numpy/', None),
188	    'python': ('https://docs.python.org/', None),
189	    'torch': ('https://pytorch.org/docs/master/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/docs/source/conf.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	    'python': ('https://docs.python.org/', None),
189	    'torch': ('https://pytorch.org/docs/master/', None),
190	}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
88	            ), "xt") as tf:
89	                tf.write("%d" % len(embedding))
90	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
88	            ), "xt") as tf:
89	                tf.write("%d" % len(embedding))
90	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	    with open(os.path.join(target, "checkpoint_version.txt"), "xt") as tf:
157	        tf.write("%d" % version)
158	    for entity_name, entity in config.entities.items():

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
156	    with open(os.path.join(target, "checkpoint_version.txt"), "xt") as tf:
157	        tf.write("%d" % version)
158	    for entity_name, entity in config.entities.items():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
163	            ), "rt") as tf:
164	                entity_count = int(tf.read().strip())
165	            with h5py.File(os.path.join(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
247	        with open(os.path.join(config.checkpoint_path, "checkpoint_version.txt"), "rt") as tf:
248	            self.assertEqual(version, int(tf.read().strip()))
249	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
269	                ), "rt") as tf:
270	                    entity_count = int(tf.read().strip())
271	                with h5py.File(os.path.join(

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
473	        # Just make sure no exceptions are raised and nothing crashes.
474	        trainer0 = mp.get_context("spawn").Process(
475	            name="Trainer-0",
476	            target=partial(
477	                call_one_after_the_other,
478	                self.subprocess_init,
479	                partial(train, train_config, rank=0, subprocess_init=self.subprocess_init),
480	            ),

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
481	        )
482	        trainer1 = mp.get_context("spawn").Process(
483	            name="Trainer-1",
484	            target=partial(
485	                call_one_after_the_other,
486	                self.subprocess_init,
487	                partial(train, train_config, rank=1, subprocess_init=self.subprocess_init),
488	            ),

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
533	        # Just make sure no exceptions are raised and nothing crashes.
534	        trainer0 = mp.get_context("spawn").Process(
535	            name="Trainer-0",
536	            target=partial(
537	                call_one_after_the_other,
538	                self.subprocess_init,
539	                partial(train, train_config, rank=0, subprocess_init=self.subprocess_init),
540	            ),

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
541	        )
542	        trainer1 = mp.get_context("spawn").Process(
543	            name="Trainer-1",
544	            target=partial(
545	                call_one_after_the_other,
546	                self.subprocess_init,
547	                partial(train, train_config, rank=1, subprocess_init=self.subprocess_init),
548	            ),

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
549	        )
550	        partition_server = mp.get_context("spawn").Process(
551	            name="PartitionServer-0",
552	            target=partial(
553	                call_one_after_the_other,
554	                self.subprocess_init,
555	                partial(
556	                    run_partition_server,
557	                    train_config,
558	                    rank=0,
559	                    subprocess_init=self.subprocess_init,
560	                ),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
614	        ), "xt") as f:
615	            f.write("%d" % len(gen_config.relations))
616	        train_config = attr.evolve(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/test/test_functional.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
614	        ), "xt") as f:
615	            f.write("%d" % len(gen_config.relations))
616	        train_config = attr.evolve(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/checkpoint_storage.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
301	        with self.get_version_file().open("wt") as tf:
302	            tf.write(f"{version}\n")
303	            tf.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/checkpoint_storage.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
312	            with self.get_version_file().open("rt") as tf:
313	                version_string = tf.read().strip()
314	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/checkpoint_storage.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
423	        with self.get_config_file().open("wt") as tf:
424	            tf.write(config_json)
425	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/checkpoint_storage.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
428	            with self.get_config_file().open("rt") as tf:
429	                return tf.read()
430	        except FileNotFoundError as err:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/checkpoint_storage.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
434	        with self.get_stats_file().open("at") as tf:
435	            tf.write("".join(f"{s}\n" for s in stats_json))
436	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/checkpoint_storage.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
468	        with dst_path.open("wt") as tf:
469	            tf.write(f"{version}\n")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/converters/utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
31	
32	    with fpath.open("wb") as out_bf, gzip.GzipFile(gzip_path) as zip_f:
33	        shutil.copyfileobj(zip_f, out_bf)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/converters/utils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
41	    # extract file
42	    with tarfile.open(fpath, "r:gz") as tar:
43	        tar.extractall(path=fpath.parent)

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/converters/utils.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
77	            print(f"Downloading {url} to {fpath}")
78	            urlretrieve(
79	                url, str(fpath),
80	                reporthook=gen_bar_updater(tqdm(unit='B', unit_scale=True))
81	            )

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/distributed.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
134	) -> mp.Process:
135	    p = mp.get_context("spawn").Process(
136	        name=process_name,
137	        target=_server_init,
138	        args=(
139	            server,
140	            process_name,
141	            init_method,
142	            world_size,
143	            server_rank,
144	            groups,
145	            subprocess_init,
146	        ),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/eval.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
113	    def load_embeddings(entity: EntityName, part: Partition) -> torch.nn.Parameter:
114	        embs, _ = checkpoint_manager.read(entity, part)
115	        assert embs.is_shared()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/examples/fb15k.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	FB15K_URL = 'https://dl.fbaipublicfiles.com/starspace/fb15k.tgz'
30	FILENAMES = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/examples/livejournal.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	URL = 'https://snap.stanford.edu/data/soc-LiveJournal1.txt.gz'
30	TRAIN_FILENAME = "train.txt"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/examples/livejournal.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        for line in lines[:split_len]:
69	            out_tf_train.write(line)
70	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/examples/livejournal.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	        for line in lines[split_len:]:
73	            out_tf_test.write(line)
74	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/parameter_sharing.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
471	        self.errq = mp.get_context("spawn").Queue()
472	        self.p = mp.get_context("spawn").Process(
473	            name=process_name,
474	            target=_client_thread_loop,
475	            args=(
476	                process_name,
477	                client_rank,
478	                all_server_ranks,
479	                self.q,
480	                self.errq,
481	                init_method,
482	                world_size,
483	                groups,
484	                subprocess_init,
485	            ),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/train.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
497	        if strict:
498	            embs, optim_state = checkpoint_manager.read(entity, part,
499	                                                        force_dirty=force_dirty)
500	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/train.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
503	            # run was resumed) so we fall back on initial values.
504	            embs, optim_state = checkpoint_manager.maybe_read(entity, part,
505	                                                              force_dirty=force_dirty)
506	            if embs is None and loadpath_manager is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/train.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
506	            if embs is None and loadpath_manager is not None:
507	                embs, optim_state = loadpath_manager.maybe_read(entity, part)
508	            if embs is None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/train.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
593	                io_bytes += embs.numel() * embs.element_size()  # ignore optim state
594	                checkpoint_manager.write(entity, part, embs.detach(), optim_state)
595	                if optim_key in trainer.entity_optimizers:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/train.py:851
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
850	
851	                    checkpoint_manager.write(
852	                        entity, Partition(0),
853	                        embs.detach(), OptimizerStateDict(optimizer.state_dict()))
854	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/torchbiggraph-1.0.0/torchbiggraph-1.0.0/torchbiggraph/util.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
209	    torch.set_num_threads(1)
210	    return mp.get_context("spawn").Pool(
211	        num_workers, initializer=_pool_init, initargs=(subprocess_name, subprocess_init,)
212	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 9569
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 34.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 39.0
		High: 0.0
Files skipped (0):
