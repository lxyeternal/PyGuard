Run started:2025-04-12 12:11:21.557966

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/alation/client.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
13	        while url:
14	            response = requests.get(
15	                url,
16	                params=params if params else None,
17	                headers=self.headers,
18	                timeout=10,
19	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/alation/client.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	            response.raise_for_status()
21	            url = response.headers.get("X-Next-Page")
22	            # `response.json()` is a list of objects, we're returning them as an iterator

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/azure_data_factory/extractor.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
561	            params = {"factory": factory.id}
562	            pipeline_url = f"https://adf.azure.com/authoring/pipeline/{pipeline_name}?{urlencode(params)}"
563	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/bigquery/config.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    type: str = "service_account"
42	    auth_uri: str = "https://accounts.google.com/o/oauth2/auth"
43	    token_uri: str = "https://oauth2.googleapis.com/token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/bigquery/config.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    auth_uri: str = "https://accounts.google.com/o/oauth2/auth"
43	    token_uri: str = "https://oauth2.googleapis.com/token"
44	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/bigquery/extractor.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
80	
81	            with ThreadPoolExecutor(
82	                max_workers=self._config.max_concurrency
83	            ) as executor:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/bigquery/profile/extractor.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
102	
103	        with ThreadPoolExecutor(max_workers=self._max_concurrency) as executor:
104	            datasets = [dataset for dataset in executor.map(profile, tables)]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/bigquery/utils.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	                json.load(fin),
45	                scopes=["https://www.googleapis.com/auth/cloud-platform"],
46	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/bigquery/utils.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        config.credentials.__dict__,
50	        scopes=["https://www.googleapis.com/auth/cloud-platform"],
51	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/common/file_sink.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
191	            arcname = f"{dir_name}/run.log"
192	            file.write(LOG_FILE, arcname=arcname)
193	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/common/file_sink.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
191	            arcname = f"{dir_name}/run.log"
192	            file.write(LOG_FILE, arcname=arcname)
193	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/common/file_sink.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
195	                arcname = f"{dir_name}/{path.basename(debug_file)}"
196	                file.write(debug_file, arcname=arcname)
197	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/common/file_sink.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
195	                arcname = f"{dir_name}/{path.basename(debug_file)}"
196	                file.write(debug_file, arcname=arcname)
197	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/common/file_sink.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
198	        with open(zip_file, "rb") as file:
199	            self._storage.write_file(f"{self.path}/log.zip", file.read(), True)
200	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/common/logger.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
43	    with open(out_file, "w") as fp:
44	        fp.write(json.dumps(value, default=str))
45	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/common/sink.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
22	        logger.info("validating MCE records")
23	        with ThreadPoolExecutor() as tpe:
24	            valid_records = [

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/common/storage.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	        with open(path, mode) as fp:
54	            fp.write(payload)
55	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/common/storage.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	        with open(path, mode, transport_params=transport_params) as fp:
116	            fp.write(payload)
117	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/datahub/extractor.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	
66	        resp = requests.get(
67	            f"{self._endpoint}/entity/dataset",
68	            headers=self._headers,
69	            params=params,
70	            timeout=10,
71	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/datahub/extractor.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	            body = self._get_dataset_page(scroll_id)
78	            for entity in body.get("entities", []):
79	                self._init_dataset(entity["urn"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/datahub/extractor.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	                self._init_dataset(entity["urn"])
80	            scroll_id = body.get("scrollId", None)
81	            if not scroll_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	        logger.debug(f"Sending request to {url}")
65	        req = requests.get(
66	            url,
67	            params=params,
68	            headers={
69	                "Content-Type": "application/json",
70	                "Authorization": f"Token {self.service_token}",
71	            },
72	            timeout=60,  # request timeout 60s
73	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/client.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	        """Get all projects in the account"""
80	        resp = self._get("projects/")
81	        return [DbtProject.model_validate(project) for project in resp.get("data")]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/client.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	        resp = self._get("projects/")
81	        return [DbtProject.model_validate(project) for project in resp.get("data")]
82	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/client.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	        """Get all environments under the project"""
85	        resp = self._get(f"projects/{project_id}/environments/")
86	        return [DbtEnvironment.model_validate(env) for env in resp.get("data")]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/client.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	        resp = self._get(f"projects/{project_id}/environments/")
86	        return [DbtEnvironment.model_validate(env) for env in resp.get("data")]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/config.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    # Base URL for dbt instance
38	    base_url: str = "https://cloud.getdbt.com"
39	
40	    # Discovery API endpoint
41	    discovery_api_url: str = "https://metadata.cloud.getdbt.com/graphql"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/config.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    # Discovery API endpoint
41	    discovery_api_url: str = "https://metadata.cloud.getdbt.com/graphql"

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/http.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
34	
35	        self._log_payload(req_file_name, r_body)
36	        self._log_payload(res_file_name, response)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/http.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
35	        self._log_payload(req_file_name, r_body)
36	        self._log_payload(res_file_name, response)
37	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/cloud/http.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
49	
50	        response = self.transport.handle_request(request)
51	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v10.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    dbt_schema_version: Optional[str] = (
19	        'https://schemas.getdbt.com/dbt/manifest/v10.json'
20	    )
21	    dbt_version: Optional[str] = '1.6.5'
22	    generated_at: Optional[AwareDatetime] = '2023-10-05T00:33:14.410024Z'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v5.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    dbt_schema_version: Optional[str] = (
19	        'https://schemas.getdbt.com/dbt/manifest/v5.json'
20	    )
21	    dbt_version: Optional[str] = '1.1.0b1'
22	    generated_at: Optional[AwareDatetime] = '2022-04-12T01:16:32.489402Z'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v5.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
362	    )
363	    dbt_schema_version: Optional[str] = 'https://schemas.getdbt.com/dbt/sources/v3.json'
364	    dbt_version: Optional[str] = '1.1.0b1'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v6.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    dbt_schema_version: Optional[str] = (
19	        'https://schemas.getdbt.com/dbt/manifest/v6.json'
20	    )
21	    dbt_version: Optional[str] = '1.2.0'
22	    generated_at: Optional[AwareDatetime] = '2022-07-26T13:02:44.173047Z'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v6.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
368	    )
369	    dbt_schema_version: Optional[str] = 'https://schemas.getdbt.com/dbt/sources/v3.json'
370	    dbt_version: Optional[str] = '1.2.0'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v7.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    dbt_schema_version: Optional[str] = (
19	        'https://schemas.getdbt.com/dbt/manifest/v7.json'
20	    )
21	    dbt_version: Optional[str] = '1.3.0b2'
22	    generated_at: Optional[AwareDatetime] = '2022-10-05T17:41:25.798224Z'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v7.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
385	    )
386	    dbt_schema_version: Optional[str] = 'https://schemas.getdbt.com/dbt/sources/v3.json'
387	    dbt_version: Optional[str] = '1.3.0b2'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v8.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    dbt_schema_version: Optional[str] = (
19	        'https://schemas.getdbt.com/dbt/manifest/v8.json'
20	    )
21	    dbt_version: Optional[str] = '1.4.1'
22	    generated_at: Optional[AwareDatetime] = '2023-02-09T10:04:47.350768Z'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v8.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
203	    )
204	    dbt_schema_version: Optional[str] = 'https://schemas.getdbt.com/dbt/sources/v3.json'
205	    dbt_version: Optional[str] = '1.4.1'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v9.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    dbt_schema_version: Optional[str] = (
19	        'https://schemas.getdbt.com/dbt/manifest/v9.json'
20	    )
21	    dbt_version: Optional[str] = '1.6.0a1'
22	    generated_at: Optional[AwareDatetime] = '2023-04-21T11:09:06.496436Z'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_manifest_v9.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
247	    )
248	    dbt_schema_version: Optional[str] = 'https://schemas.getdbt.com/dbt/sources/v3.json'
249	    dbt_version: Optional[str] = '1.6.0a1'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/dbt/generated/dbt_run_results_v4.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    )
38	    dbt_schema_version: Optional[str] = 'https://schemas.getdbt.com/dbt/sources/v3.json'
39	    dbt_version: Optional[str] = '1.0.0b2'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	        self._users: Dict[str, str] = {}
137	        self._base_url = "https://api.fivetran.com/v1"
138	        self._requests_timeout = config.requests.timeout

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	        for table in tables:
185	            parent_schema: Optional[SchemaMetadata] = schema_map.get(table.parent_id)
186	            if parent_schema is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	        for column in columns:
199	            parent_table: Optional[TableMetadata] = table_map.get(column.parent_id)
200	            if parent_table is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	    ) -> None:
218	        destination = self._destinations.get(connector.group_id)
219	        assert destination, "destination for connector should exist"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244	        source_platform = (
245	            SOURCE_PLATFORM_MAPPING.get(connector.service) or DataPlatform.EXTERNAL
246	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	        )
269	        destination_platform = PLATFORM_MAPPING.get(destination.service)
270	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
348	            connector,
349	            self._source_metadata.get(connector.service),
350	            serialized_schema_metadata,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
350	            serialized_schema_metadata,
351	            self._users.get(connector.connected_by) if connector.connected_by else None,
352	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
363	    ) -> Pipeline:
364	        url = f"https://fivetran.com/dashboard/connectors/{connector.id}"
365	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	    def get_snowflake_account_from_config(config: dict) -> Optional[str]:
400	        host = config.get("host")
401	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
413	        elif source_platform == DataPlatform.MSSQL:
414	            host = config.get("host")
415	            if host:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
423	        if destination.service == "big_query":
424	            return destination.config.get("project_id")
425	        return destination.config.get("database")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
424	            return destination.config.get("project_id")
425	        return destination.config.get("database")
426	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
429	        config = connector.config
430	        return config.get("database") if isinstance(config, dict) else None
431	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	    def get_destination_info(self, group_id: str) -> Optional[DestinationPayload]:
479	        response: GenericResponse[DestinationPayload] = self._call_get(
480	            url=f"{self._base_url}/destinations/{group_id}",
481	            type_=GenericResponse[DestinationPayload],
482	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
485	    def get_connector_detail(self, connector_id: str) -> Optional[ConnectorPayload]:
486	        response: GenericResponse[ConnectorPayload] = self._call_get(
487	            url=f"{self._base_url}/connectors/{connector_id}",
488	            type_=GenericResponse[ConnectorPayload],
489	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
534	            try:
535	                response = self._call_get(
536	                    url=url,
537	                    type_=target_type,
538	                    params=query,
539	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/fivetran/extractor.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
552	        headers = {"Accept": "application/json;version=2"}
553	        return make_request(
554	            url=url,
555	            headers=headers,
556	            timeout=self._requests_timeout,
557	            auth=self._auth,
558	            **kwargs,
559	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/kafka/schema_parsers/protobuf_parser.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
58	        with open(file_path.as_posix(), "w") as file:
59	            file.write(raw_schema)
60	        return file_path

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/kafka/schema_parsers/protobuf_parser.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
150	        if Path(self.base_dir).exists():
151	            shutil.rmtree(self.base_dir)
152	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
103	        # fetch session token
104	        session_token_resp = requests.post(
105	            f"{self._server_url}/api/session",
106	            None,
107	            {
108	                "username": self._username,
109	                "password": self._password,
110	            },
111	            timeout=600,  # request timeout 600s
112	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
150	    def _fetch_assets(self, asset_type: str, withData=False) -> List[Dict]:
151	        resp = self._session.get(f"{self._server_url}/api/{asset_type}")
152	        resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	    def _fetch_asset(self, asset_type: str, asset_id: Union[str, int]) -> Dict:
162	        resp = self._session.get(f"{self._server_url}/api/{asset_type}/{asset_id}")
163	        resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	
175	        slug = collection.get("slug")
176	        name = collection.get("name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	        slug = collection.get("slug")
176	        name = collection.get("name")
177	        description = collection.get("description")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	        name = collection.get("name")
177	        description = collection.get("description")
178	        location = collection.get("location")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	        description = collection.get("description")
178	        location = collection.get("location")
179	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	        database_id = database["id"]
214	        platform = self._db_engine_mapping.get(database["engine"])
215	        details = database.get("details")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	        platform = self._db_engine_mapping.get(database["engine"])
215	        details = database.get("details")
216	        default_schema = next(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	                platform,
232	                details.get("db"),
233	                default_schema,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
233	                default_schema,
234	                details.get("account"),
235	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	                platform,
239	                details.get("project-id"),
240	                default_schema or details.get("dataset-id"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
239	                details.get("project-id"),
240	                default_schema or details.get("dataset-id"),
241	                None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244	            self._databases[database_id] = DatabaseInfo(
245	                platform, details.get("db"), default_schema, None
246	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
255	
256	        dashboard_collection = dashboard_details.get("collection")
257	        collection = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257	        collection = (
258	            self._collections.get(dashboard_collection.get("id"))
259	            if dashboard_collection

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257	        collection = (
258	            self._collections.get(dashboard_collection.get("id"))
259	            if dashboard_collection

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
267	
268	        cards = dashboard_details.get("dashcards", [])
269	        charts, upstream_datasets = [], set()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
313	            description=card["description"],
314	            chart_type=self._chart_type_mapping.get(card.get("display", "")),
315	            url=f"{self._server_url}/card/{card_id}",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
313	            description=card["description"],
314	            chart_type=self._chart_type_mapping.get(card.get("display", "")),
315	            url=f"{self._server_url}/card/{card_id}",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
318	        upstream_tables = set()
319	        dataset_query = card.get("dataset_query", {})
320	        query_type = dataset_query.get("type")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
319	        dataset_query = card.get("dataset_query", {})
320	        query_type = dataset_query.get("type")
321	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
322	        if query_type == "query":
323	            upstream_table_id = dataset_query.get("query", {}).get("source-table", 0)
324	            dataset_id = self._get_table_by_id(upstream_table_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
322	        if query_type == "query":
323	            upstream_table_id = dataset_query.get("query", {}).get("source-table", 0)
324	            dataset_id = self._get_table_by_id(upstream_table_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
342	
343	        schema = table_json.get("schema")
344	        name = table_json.get("name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
343	        schema = table_json.get("schema")
344	        name = table_json.get("name")
345	        database_id = table_json.get("db", {}).get("id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
344	        name = table_json.get("name")
345	        database_id = table_json.get("db", {}).get("id")
346	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
344	        name = table_json.get("name")
345	        database_id = table_json.get("db", {}).get("id")
346	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
346	
347	        database = self._databases.get(database_id)
348	        if database is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
371	
372	        database_id = dataset_query.get("database", 0)
373	        database = self._databases.get(database_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/metabase/extractor.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
372	        database_id = dataset_query.get("database", 0)
373	        database = self._databases.get(database_id)
374	        if database is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/monday/extractor.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	baseURL = "https://api.monday.com/v2"
19	max_items_query = 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/monday/extractor.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
108	            logger.info("Retrieving all available boards")
109	            r = requests.post(url=baseURL, json=data, headers=self.headers, timeout=15)
110	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/monday/extractor.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
182	            logger.info(f"Getting items for board {board_id}")
183	            r = requests.post(url=baseURL, json=data, headers=self.headers, timeout=30)
184	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/monday/extractor.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
226	            logger.info(f"Consuming cursor {cursor} for board {board_id}")
227	            r = requests.post(url=baseURL, json=data, headers=self.headers, timeout=30)
228	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/monday/extractor.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
260	            logger.info(f"Retrieving Monday doc {object_id}")
261	            r = requests.post(url=baseURL, json=data, headers=self.headers, timeout=15)
262	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/monday/extractor.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
274	            block_json = json.loads(block["content"])
275	            if block_json.get("deltaFormat"):  # If there's a text body present
276	                block_text = block_json["deltaFormat"][0]["insert"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/monte_carlo/extractor.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	
36	assets_base_url = "https://getmontecarlo.com/assets"
37	monitors_base_url = "https://getmontecarlo.com/monitors"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/monte_carlo/extractor.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	assets_base_url = "https://getmontecarlo.com/assets"
37	monitors_base_url = "https://getmontecarlo.com/monitors"
38	alerts_base_url = "https://getmontecarlo.com/alerts"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/monte_carlo/extractor.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	monitors_base_url = "https://getmontecarlo.com/monitors"
38	alerts_base_url = "https://getmontecarlo.com/alerts"
39	
40	
41	# https://apidocs.getmontecarlo.com/#definition-MonitorBreachType
42	monitor_breached_map = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/notion/extractor.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	
19	baseURL = "https://api.notion.com/v1"
20	
21	
22	class NotionExtractor(BaseExtractor):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/notion/extractor.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	        try:
75	            r = requests.get(
76	                f"{baseURL}/pages/{page}/properties/title", headers=headers, timeout=15
77	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/notion/extractor.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
102	            # Send databases query
103	            r = requests.post(
104	                f"{baseURL}/search", headers=headers, json=payload, timeout=15
105	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/notion/extractor.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	                # Construct link
167	                link = f'https://notion.so/{q.metadata["pageId"]}'
168	                q.metadata["link"] = link

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/openapi/extractor.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	        )
121	        resp = session.get(str(spec.openapi_json_url), headers=headers)
122	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/openapi/extractor.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	        apis: List[API] = []
137	        servers = openapi.get("servers")
138	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/openapi/extractor.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	        for path, path_item in openapi["paths"].items():
140	            path_servers = path_item.get("servers")
141	            server = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/openapi/extractor.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	                    OpenAPIMethod(
191	                        summary=item.get("summary") or None,
192	                        description=item.get("description") or None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/openapi/extractor.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	                        summary=item.get("summary") or None,
192	                        description=item.get("description") or None,
193	                        type=operation_type,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/openapi/extractor.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	
217	        for tag in openapi.get("tags") or []:
218	            name = tag.get("name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/openapi/extractor.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	        for tag in openapi.get("tags") or []:
218	            name = tag.get("name")
219	            description = tag.get("description")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/openapi/extractor.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	            name = tag.get("name")
219	            description = tag.get("description")
220	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/extractor.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	            name=workspace.name,
190	            url=f"https://app.powerbi.com/groups/{workspace_id}",
191	            users=users,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/extractor.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
263	                    ),
264	                    dataflow_url=f"https://app.powerbi.com/groups/{workspace.id}/dataflows/{data_flow_id}",
265	                    workspace_id=workspace.id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/graph_api_client.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        )
25	        scopes = ["https://graph.microsoft.com/.default"]
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	class PowerBIClient:
64	    AUTHORITY = "https://login.microsoftonline.com/{tenant_id}"
65	    SCOPES = ["https://analysis.windows.net/powerbi/api/.default"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	    AUTHORITY = "https://login.microsoftonline.com/{tenant_id}"
65	    SCOPES = ["https://analysis.windows.net/powerbi/api/.default"]
66	    API_ENDPOINT = "https://api.powerbi.com/v1.0/myorg"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    SCOPES = ["https://analysis.windows.net/powerbi/api/.default"]
66	    API_ENDPOINT = "https://api.powerbi.com/v1.0/myorg"
67	
68	    # Only include active workspaces. Ignore personal workspaces & legacy workspaces.
69	    GROUPS_FILTER = "state eq 'Active' and type eq 'Workspace'"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	        token = app.acquire_token_for_client(scopes=self.SCOPES)
88	        access_token = token.get("access_token")
89	        if access_token is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	        if access_token is None:
90	            raise AccessTokenError(token.get("error_description", "unknown error"))
91	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	        url = f"{self.API_ENDPOINT}/admin/groups?$top=5000&$filter={PowerBIClient.GROUPS_FILTER}"
97	        return self._call_get(
98	            url, List[PowerBIWorkspace], transform_response=lambda r: r.json()["value"]
99	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	        url = f"{self.API_ENDPOINT}/admin/apps?$top=5000"
104	        return self._call_get(
105	            url, List[PowerBIApp], transform_response=lambda r: r.json()["value"]
106	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	        url = f"{self.API_ENDPOINT}/admin/datasets"
111	        return self._call_get(
112	            url, List[PowerBIDataset], transform_response=lambda r: r.json()["value"]
113	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	        try:
122	            return self._call_get(
123	                url,
124	                List[PowerBIDatasetParameter],
125	                transform_response=lambda r: r.json()["value"],
126	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	        try:
140	            return self._call_get(
141	                url,
142	                List[PowerBIDataSource],
143	                transform_response=lambda r: r.json()["value"],
144	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
153	        url = f"{self.API_ENDPOINT}/admin/dashboards"
154	        return self._call_get(
155	            url, List[PowerBIDashboard], transform_response=lambda r: r.json()["value"]
156	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        try:
165	            return self._call_get(
166	                url, List[PowerBITile], transform_response=lambda r: r.json()["value"]
167	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	        url = f"{self.API_ENDPOINT}/admin/reports"
177	        return self._call_get(
178	            url, List[PowerBIReport], transform_response=lambda r: r.json()["value"]
179	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
188	            try:
189	                response = self._call_get(continuationUri, SubscriptionsByUserResponse)
190	            except EntityNotFoundError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	        try:
207	            return self._call_get(
208	                url, List[PowerBIPage], transform_response=lambda r: r.json()["value"]
209	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	        try:
228	            return self._call_get(
229	                url,
230	                List[PowerBIRefresh],
231	                transform_response=lambda r: r.json()["value"],
232	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	        try:
253	            return self._call_get(
254	                url,
255	                PowerBiRefreshSchedule,
256	                transform_response=lambda r: r.json(),
257	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
277	        try:
278	            return self._call_get(
279	                url,
280	                PowerBiRefreshSchedule,
281	                transform_response=lambda r: r.json(),
282	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
299	        try:
300	            data_sources = self._call_get(
301	                url,
302	                dict,
303	                transform_response=lambda r: r.json(),
304	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
317	        try:
318	            data_sources = self._call_get(
319	                url,
320	                List[DataflowTransaction],
321	                transform_response=lambda r: r.json()["value"],
322	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
335	            request_body = {"workspaces": workspace_ids}
336	            result = requests.post(
337	                url,
338	                headers=self.get_headers(),
339	                params={
340	                    "datasetExpressions": True,
341	                    "datasetSchema": True,
342	                    "datasourceDetails": True,
343	                    "getArtifactUsers": True,
344	                    "lineage": True,
345	                },
346	                data=request_body,
347	                timeout=600,  # request timeout 600s
348	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
367	            while True:
368	                result = requests.get(url, headers=self.get_headers(), timeout=600)
369	                if result.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
388	        url = f"{self.API_ENDPOINT}/admin/workspaces/scanResult/{scan_id}"
389	        workspaces = self._call_get(
390	            url,
391	            List[WorkspaceInfo],
392	            transform_response=transform_scan_result,
393	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
405	            try:
406	                response = self._call_get(
407	                    continuationUri,
408	                    GetActivitiesResponse,
409	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/power_bi/power_bi_client.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
463	        try:
464	            return make_request(
465	                url,
466	                self.get_headers(),
467	                type_,
468	                transform_response,
469	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/snowflake/extractor.py:1008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1007	        return (
1008	            f"https://app.snowflake.com/{org_name}/{account_name}/#/data/"
1009	            f"databases/{db}/schemas/{schema}/table/{table}"
1010	        )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/snowflake/utils.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
125	    workers = max_workers if max_workers is not None else DEFAULT_THREAD_POOL_SIZE
126	    with futures.ThreadPoolExecutor(max_workers=workers) as executor:
127	        future_map = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/static_web/extractor.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	        try:
130	            r = requests.get(input_URL, timeout=5)
131	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/tableau/extractor.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
650	    def _build_preview_data_url(preview: bytes) -> str:
651	        return f"data:image/png;base64,{base64.b64encode(preview).decode('ascii')}"
652	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/tableau/extractor.py:651
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
650	    def _build_preview_data_url(preview: bytes) -> str:
651	        return f"data:image/png;base64,{base64.b64encode(preview).decode('ascii')}"
652	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/unity_catalog/profile/extractor.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
132	        entities = []
133	        with ThreadPoolExecutor(max_workers=connection_pool.maxsize) as executor:
134	            futures = {executor.submit(profile, table): table for table in tables}

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/unity_catalog/utils.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
44	
45	    with ThreadPoolExecutor(max_workers=connection_pool.maxsize) as executor:
46	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_connectors-0.14.185/metaphor_connectors-0.14.185/metaphor/unity_catalog/utils.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
83	
84	    with ThreadPoolExecutor(max_workers=connection_pool.maxsize) as executor:
85	

--------------------------------------------------

Code scanned:
	Total lines of code: 39302
	Total lines skipped (#nosec): 2

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 116.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 150.0
		High: 1.0
Files skipped (0):
