Run started:2025-04-12 12:21:39.999185

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/amazon/aws/extractors/redshift.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	
6	SCHEMA_URI = "https://raw.githubusercontent.com/OpenLineage/OpenLineage/main/spec/OpenLineage.json"
7	
8	
9	class RedshiftAsyncExtractor(RedshiftDataExtractor):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/amazon/aws/xcom_backends/s3.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
94	        with open(file, "rb") as f:
95	            data = f.read()
96	        if filename.endswith(".gz"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	PEM_FILENAME = os.getenv("PEM_FILENAME", "providers_team_keypair")
37	PRIVATE_KEY = Variable.get("providers_team_keypair")
38	HIVE_OPERATOR_INGRESS_PORT = int(os.getenv("HIVE_OPERATOR_INGRESS_PORT", 10000))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	COMMAND_TO_CREATE_TABLE_DATA_FILE: List[str] = [
47	    "curl https://raw.githubusercontent.com/astronomer/astronomer-providers/\
48	main/astronomer/providers/apache/hive/example_dags/zipcodes.csv \
49	 >> zipcodes.csv",
50	    "hdfs dfs -put zipcodes.csv /user/root",
51	]
52	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	
160	    current_docker_ip = get("https://api.ipify.org").text
161	    logging.info("Current ip address is: %s", str(current_docker_ip))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	
160	    current_docker_ip = get("https://api.ipify.org").text
161	    logging.info("Current ip address is: %s", str(current_docker_ip))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	    except ClientError as error:
180	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
181	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	    except ClientError as error:
180	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
181	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	    except ClientError as error:
205	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
206	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	    except ClientError as error:
205	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
206	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	
218	    current_docker_ip = get("https://api.ipify.org").text
219	    ip_range = str(current_docker_ip) + "/32"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
217	
218	    current_docker_ip = get("https://api.ipify.org").text
219	    ip_range = str(current_docker_ip) + "/32"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
258	    with open(f"/tmp/{PEM_FILENAME}.pem", "w+") as fh:
259	        fh.write(PRIVATE_KEY)
260	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
261	    # write private key to file with 400 permissions
262	    os.chmod(f"/tmp/{PEM_FILENAME}.pem", 0o400)
263	    # Check if the PEM file exists or not.

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:262
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
261	    # write private key to file with 400 permissions
262	    os.chmod(f"/tmp/{PEM_FILENAME}.pem", 0o400)
263	    # Check if the PEM file exists or not.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/hive/example_dags/example_hive.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
281	        stdin, stdout, stderr = client.exec_command(command)
282	        stdout.read()
283	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	PEM_FILENAME = os.getenv("PEM_FILENAME", "providers_team_keypair")
36	PRIVATE_KEY = Variable.get("providers_team_keypair")
37	EXECUTION_TIMEOUT = int(os.getenv("EXECUTION_TIMEOUT", 6))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	COMMAND_TO_CREATE_PI_FILE: List[str] = [
46	    "curl https://raw.githubusercontent.com/apache/spark/master/examples/src/main/python/pi.py >> pi.py",
47	    "hadoop fs -copyFromLocal pi.py /user/hadoop",
48	]
49	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	
123	    current_docker_ip = get("https://api.ipify.org").text
124	    logging.info("Current ip address is: %s", str(current_docker_ip))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	
123	    current_docker_ip = get("https://api.ipify.org").text
124	    logging.info("Current ip address is: %s", str(current_docker_ip))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	    except ClientError as error:
143	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
144	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	    except ClientError as error:
143	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
144	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	    except ClientError as error:
168	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
169	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	    except ClientError as error:
168	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
169	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	
181	    current_docker_ip = get("https://api.ipify.org").text
182	    ip_range = str(current_docker_ip) + "/32"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	
181	    current_docker_ip = get("https://api.ipify.org").text
182	    ip_range = str(current_docker_ip) + "/32"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
208	    with open(f"/tmp/{PEM_FILENAME}.pem", "w+") as fh:
209	        fh.write(PRIVATE_KEY)
210	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
211	    # write private key to file with 400 permissions
212	    os.chmod(f"/tmp/{PEM_FILENAME}.pem", 0o400)
213	    # check if the PEM file exists or not.

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:212
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
211	    # write private key to file with 400 permissions
212	    os.chmod(f"/tmp/{PEM_FILENAME}.pem", 0o400)
213	    # check if the PEM file exists or not.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/apache/livy/example_dags/example_livy.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
232	            stdin, stdout, stderr = client.exec_command(command)
233	            stdout.read()
234	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/core/hooks/astro.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	            "placeholders": {
42	                "host": "https://clmkpsyfc010391acjie00t1l.astronomer.run/d5lc9c9x",
43	                "password": "Astro API JWT Token",
44	            },
45	        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/core/hooks/astro.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	        conn = BaseHook.get_connection(self.astro_cloud_conn_id)
50	        base_url = conn.host or os.environ.get("AIRFLOW__WEBSERVER__BASE_URL")
51	        if base_url is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/core/hooks/astro.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	        url = f"{base_url}{path}"
79	        response = requests.get(url, headers=self._headers, params=params)
80	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/core/hooks/astro.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        url = f"{base_url}{path}"
95	        response = requests.get(url, headers=self._headers)
96	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/core/hooks/astro.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	        async with ClientSession(headers=self._headers) as session:
113	            async with session.get(url) as response:
114	                response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/core/hooks/astro.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	        url = f"{base_url}{path}"
132	        response = requests.get(url, headers=self._headers)
133	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/core/hooks/astro.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	        async with ClientSession(headers=self._headers) as session:
153	            async with session.get(url) as response:
154	                response.raise_for_status()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/databricks/hooks/databricks.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
107	            encoded_bytes = auth_str.encode("utf-8")
108	            auth = base64.b64encode(encoded_bytes).decode("utf-8")
109	            headers["Authorization"] = f"Basic {auth}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/databricks/hooks/databricks.py:108
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
107	            encoded_bytes = auth_str.encode("utf-8")
108	            auth = base64.b64encode(encoded_bytes).decode("utf-8")
109	            headers["Authorization"] = f"Basic {auth}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/google/cloud/gke_utils.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	        target_principal=impersonation_account,
30	        target_scopes=["https://www.googleapis.com/auth/cloud-platform"],
31	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/google/cloud/gke_utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	    with open(config_name) as input_file:
43	        config_content = yaml.safe_load(input_file.read())
44	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/google/cloud/operators/bigquery.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	
16	BIGQUERY_JOB_DETAILS_LINK_FMT = "https://console.cloud.google.com/bigquery?j={job_id}"
17	
18	
19	class BigQueryInsertJobOperatorAsync(BigQueryInsertJobOperator):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	PEM_FILENAME = os.getenv("PEM_FILENAME", "providers_team_keypair")
27	PRIVATE_KEY = Variable.get("providers_team_keypair")
28	INBOUND_SECURITY_GROUP = os.getenv("INBOUND_SECURITY_GROUP", "security-group")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	COMMAND_TO_CREATE_TABLE_DATA_FILE: List[str] = [
38	    "curl https://raw.githubusercontent.com/astronomer/astronomer-providers/\
39	main/astronomer/providers/apache/hive/example_dags/zipcodes.csv \
40	 >> zipcodes.csv",
41	    "mv zipcodes.csv /home/ubuntu/",
42	]
43	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	    client = boto3.client("ec2", **AWS_S3_CREDS)
132	    current_docker_ip = get("https://api.ipify.org").text
133	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	    client = boto3.client("ec2", **AWS_S3_CREDS)
132	    current_docker_ip = get("https://api.ipify.org").text
133	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	    except ClientError as error:
148	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
149	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	    except ClientError as error:
148	        if error.response.get("Error", {}).get("Code", "") == BOTO_DUPLICATE_PERMISSION_ERROR:
149	            logging.error(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	
161	    current_docker_ip = get("https://api.ipify.org").text
162	    ip_range = str(current_docker_ip) + "/32"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	
161	    current_docker_ip = get("https://api.ipify.org").text
162	    ip_range = str(current_docker_ip) + "/32"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186	    with open(f"/tmp/{PEM_FILENAME}.pem", "w+") as fh:
187	        fh.write(PRIVATE_KEY)
188	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
189	    # write private key to file with 400 permissions
190	    os.chmod(f"/tmp/{PEM_FILENAME}.pem", 0o400)
191	    # Check if the PEM file exists or not.

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:190
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
189	    # write private key to file with 400 permissions
190	    os.chmod(f"/tmp/{PEM_FILENAME}.pem", 0o400)
191	    # Check if the PEM file exists or not.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/sftp/example_dags/example_sftp.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
209	        stdin, stdout, stderr = client.exec_command(command)
210	        stdout.read()
211	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/snowflake_sql_api.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	
97	        private_key_file = conn.extra_dejson.get(
98	            "extra__snowflake__private_key_file"
99	        ) or conn.extra_dejson.get("private_key_file")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/snowflake_sql_api.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	            "extra__snowflake__private_key_file"
99	        ) or conn.extra_dejson.get("private_key_file")
100	        private_key_content = conn.extra_dejson.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/snowflake_sql_api.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	        ) or conn.extra_dejson.get("private_key_file")
100	        private_key_content = conn.extra_dejson.get(
101	            "extra__snowflake__private_key_content"
102	        ) or conn.extra_dejson.get("private_key_content")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/snowflake_sql_api.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	            "extra__snowflake__private_key_content"
102	        ) or conn.extra_dejson.get("private_key_content")
103	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/snowflake_sql_api.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
140	        req_id = uuid.uuid4()
141	        url = "https://{}.snowflakecomputing.com/api/v2/statements".format(conn_config["account"])
142	        params: dict[str, Any] | None = {"requestId": str(req_id), "async": True, "pageSize": 10}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/snowflake_sql_api.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
158	        }
159	        response = requests.post(url, json=data, headers=headers, params=params)
160	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/snowflake_sql_api.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	            try:
224	                response = requests.get(url, headers=header, params=params)
225	                response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/snowflake_sql_api.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	        async with aiohttp.ClientSession(headers=header) as session:
272	            async with session.get(url, params=params) as response:
273	                status_code = response.status

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/sql_api_generate_jwt.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
151	        # Base64-encode the value and prepend the prefix 'SHA256:'.
152	        public_key_fp = "SHA256:" + base64.b64encode(sha256hash.digest()).decode("utf-8")
153	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/astronomer_providers-1.19.4/astronomer_providers-1.19.4/astronomer/providers/snowflake/hooks/sql_api_generate_jwt.py:152
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
151	        # Base64-encode the value and prepend the prefix 'SHA256:'.
152	        public_key_fp = "SHA256:" + base64.b64encode(sha256hash.digest()).decode("utf-8")
153	

--------------------------------------------------

Code scanned:
	Total lines of code: 15101
	Total lines skipped (#nosec): 5

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 45.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 59.0
		High: 5.0
Files skipped (0):
