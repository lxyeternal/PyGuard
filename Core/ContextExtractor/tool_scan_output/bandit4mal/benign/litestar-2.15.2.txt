Run started:2025-04-12 11:29:45.716528

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/cli/_utils.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
529	    with certfile_path.open("wb") as cert_file:
530	        cert_file.write(cert.public_bytes(serialization.Encoding.PEM))
531	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/cli/_utils.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
532	    with keyfile_path.open("wb") as key_file:
533	        key_file.write(
534	            key.private_bytes(
535	                encoding=serialization.Encoding.PEM,
536	                format=serialization.PrivateFormat.TraditionalOpenSSL,
537	                encryption_algorithm=serialization.NoEncryption(),
538	            )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/cli/commands/core.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
173	@click.option(
174	    "-H", "--host", help="Server under this host", default="127.0.0.1", show_default=True, envvar="LITESTAR_HOST"
175	)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/connection/websocket.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
74	            if self.connection_state == "disconnect":
75	                raise WebSocketDisconnect(detail=DISCONNECT_MESSAGE)
76	            message = await receive()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/connection/websocket.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
98	            if self.connection_state == "disconnect":
99	                raise WebSocketDisconnect(detail=DISCONNECT_MESSAGE)  # pragma: no cover
100	            await send(message)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/connection/websocket.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
99	                raise WebSocketDisconnect(detail=DISCONNECT_MESSAGE)  # pragma: no cover
100	            await send(message)
101	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/connection/websocket.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
132	            }
133	            await self.send(event)
134	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/connection/websocket.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
145	        event: WebSocketCloseEvent = {"type": "websocket.close", "code": code, "reason": reason or ""}
146	        await self.send(event)
147	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/connection/websocket.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
166	        if event["type"] == "websocket.disconnect":
167	            raise WebSocketDisconnect(detail="disconnect event", code=event["code"])
168	        return event.get("text") or "" if mode == "text" else event.get("bytes") or b""

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/connection/websocket.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
265	            event["text"] = data if isinstance(data, str) else data.decode(encoding)
266	        await self.send(event)
267	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/datastructures/upload_file.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
39	        if file_data:
40	            self.file.write(file_data)
41	            self.file.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/datastructures/upload_file.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
62	            return await sync_to_thread(self.file.write, data)
63	        return self.file.write(data)
64	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/dto/_codegen_backend.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
218	        ctx: dict[str, Any] = {**self._fn_locals}
219	        exec(source, ctx)  # noqa: S102
220	        return ctx["func"]  # type: ignore[no-any-return]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/file_system.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
79	                if is_async_callable(self.file_system.info)
80	                else sync_to_thread(self.file_system.info, str(path))
81	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/file_system.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
115	                )
116	            return AsyncFile(await sync_to_thread(self.file_system.open, file, mode=mode, buffering=buffering))  # type: ignore[arg-type]
117	        except PermissionError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/handlers/http_handlers/base.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
311	            if self.sync_to_thread is None:
312	                warn_implicit_sync_to_thread(fn, stacklevel=3)
313	        elif self.sync_to_thread is not None:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/handlers/websocket_handlers/_utils.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
113	                if handle_send:
114	                    await handle_send(socket, data)
115	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/handlers/websocket_handlers/listener.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
308	            if self.on_disconnect:
309	                await self.on_disconnect(**(on_disconnect_dependencies or {}))
310	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/handlers/websocket_handlers/listener.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
317	        if self._send_handler is Empty:
318	            self._send_handler = create_handle_send(self)
319	        return self._send_handler

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/handlers/websocket_handlers/stream.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
122	    if close and socket.connection_state != "disconnect":
123	        await socket.close()
124	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/middleware/session/client_side.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
89	        encrypted = self.aesgcm.encrypt(nonce, serialized, associated_data=associated_data)
90	        encoded = b64encode(nonce + encrypted + AAD + associated_data)
91	        return [encoded[i : i + CHUNK_SIZE] for i in range(0, len(encoded), CHUNK_SIZE)]

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/middleware/session/client_side.py:90
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
89	        encrypted = self.aesgcm.encrypt(nonce, serialized, associated_data=associated_data)
90	        encoded = b64encode(nonce + encrypted + AAD + associated_data)
91	        return [encoded[i : i + CHUNK_SIZE] for i in range(0, len(encoded), CHUNK_SIZE)]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/middleware/session/client_side.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
101	        """
102	        decoded = b64decode(b"".join(data))
103	        nonce = decoded[:NONCE_SIZE]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/middleware/session/client_side.py:102
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
101	        """
102	        decoded = b64decode(b"".join(data))
103	        nonce = decoded[:NONCE_SIZE]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/controller.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    """
52	    redoc_js_url: str = f"https://cdn.jsdelivr.net/npm/redoc@{redoc_version}/bundles/redoc.standalone.js"
53	    """Download url for the Redoc JS bundle."""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/controller.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	    """Download url for the Redoc JS bundle."""
54	    swagger_css_url: str = f"https://cdn.jsdelivr.net/npm/swagger-ui-dist@{swagger_ui_version}/swagger-ui.css"
55	    """Download url for the Swagger UI CSS bundle."""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/controller.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    swagger_ui_bundle_js_url: str = (
57	        f"https://cdn.jsdelivr.net/npm/swagger-ui-dist@{swagger_ui_version}/swagger-ui-bundle.js"
58	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/controller.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	    swagger_ui_standalone_preset_js_url: str = (
61	        f"https://cdn.jsdelivr.net/npm/swagger-ui-dist@{swagger_ui_version}/swagger-ui-standalone-preset.js"
62	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/controller.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	    stoplight_elements_css_url: str = (
72	        f"https://unpkg.com/@stoplight/elements@{stoplight_elements_version}/styles.min.css"
73	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/controller.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    stoplight_elements_js_url: str = (
76	        f"https://unpkg.com/@stoplight/elements@{stoplight_elements_version}/web-components.min.js"
77	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/controller.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	    """Download url for the Stoplight Elements JS bundle."""
79	    rapidoc_js_url: str = f"https://unpkg.com/rapidoc@{rapidoc_version}/dist/rapidoc-min.js"
80	    """Download url for the RapiDoc JS bundle."""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/controller.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
543	        if self.redoc_google_fonts:
544	            head += """
545	            <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:300,400,700" rel="stylesheet">

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	_favicon_url = "https://cdn.jsdelivr.net/gh/litestar-org/branding@main/assets/Branding%20-%20PNG%20-%20Transparent/Badge%20-%20Blue%20and%20Yellow.png"
30	_default_favicon = f"<link rel='icon' type='image/png' href='{_favicon_url}'>"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
213	        """
214	        self.js_url = js_url or f"https://unpkg.com/rapidoc@{version}/dist/rapidoc-min.js"
215	        super().__init__(path=path, **kwargs)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	        """
297	        self.js_url = js_url or f"https://cdn.jsdelivr.net/npm/redoc@{version}/bundles/redoc.standalone.js"
298	        self.google_fonts = google_fonts

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
322	        if self.google_fonts:
323	            head += """
324	            <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:300,400,700" rel="stylesheet">

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
356	
357	    _default_css_url = "https://cdn.jsdelivr.net/gh/litestar-org/branding@main/assets/openapi/scalar.css"
358	
359	    def __init__(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
379	        """
380	        self.js_url = js_url or f"https://cdn.jsdelivr.net/npm/@scalar/api-reference@{version}"
381	        self.css_url = css_url or self._default_css_url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
449	        """
450	        self.js_url = js_url or f"https://unpkg.com/@stoplight/elements@{version}/web-components.min.js"
451	        self.css_url = css_url or f"https://unpkg.com/@stoplight/elements@{version}/styles.min.css"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
450	        self.js_url = js_url or f"https://unpkg.com/@stoplight/elements@{version}/web-components.min.js"
451	        self.css_url = css_url or f"https://unpkg.com/@stoplight/elements@{version}/styles.min.css"
452	        super().__init__(path=path, **kwargs)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
525	        """
526	        self.js_url = js_url or f"https://cdn.jsdelivr.net/npm/swagger-ui-dist@{version}/swagger-ui-bundle.js"
527	        self.css_url = css_url or f"https://cdn.jsdelivr.net/npm/swagger-ui-dist@{version}/swagger-ui.css"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
526	        self.js_url = js_url or f"https://cdn.jsdelivr.net/npm/swagger-ui-dist@{version}/swagger-ui-bundle.js"
527	        self.css_url = css_url or f"https://cdn.jsdelivr.net/npm/swagger-ui-dist@{version}/swagger-ui.css"
528	        self.standalone_preset_js_url = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/openapi/plugins.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
529	            standalone_preset_js_url
530	            or f"https://cdn.jsdelivr.net/npm/swagger-ui-dist@{version}/swagger-ui-standalone-preset.js"
531	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/response/file.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	    async with await adapter.open(file_path) as file:
69	        while chunk := await file.read(chunk_size):
70	            yield chunk

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/response/file.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
228	                "type": "http.response.body",
229	                "body": await file.read(),
230	                "more_body": False,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/routes/http.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
80	        try:
81	            response = await self._get_response_for_request(
82	                scope=scope, request=request, route_handler=route_handler, parameter_model=parameter_model
83	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/routes/http.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
148	
149	        if before_request_handler := route_handler.resolve_before_request():
150	            response_data = await before_request_handler(request)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/stores/file.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	                try:
74	                    os.write(tmp_file_fd, storage_obj.to_bytes())
75	                finally:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/stores/file.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
73	                try:
74	                    os.write(tmp_file_fd, storage_obj.to_bytes())
75	                finally:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/stores/file.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	    async def _write(self, target_file: Path, storage_obj: StorageObject) -> None:
87	        await sync_to_thread(self._write_sync, target_file, storage_obj)
88	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/stores/file.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	        storage_obj = StorageObject.new(data=value, expires_in=expires_in)
106	        await self._write(path, storage_obj)
107	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/stores/file.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
105	        storage_obj = StorageObject.new(data=value, expires_in=expires_in)
106	        await self._write(path, storage_obj)
107	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/stores/file.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
153	
154	        await sync_to_thread(shutil.rmtree, self.path)
155	        await self.path.mkdir(exist_ok=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/async_client.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        app: T,
38	        base_url: str = "http://testserver.local",
39	        raise_server_exceptions: bool = True,
40	        root_path: str = "",
41	        backend: AnyIOBackend = "asyncio",
42	        backend_options: Mapping[str, Any] | None = None,
43	        session_config: BaseBackendConfig | None = None,
44	        timeout: float | None = None,
45	        cookies: CookieTypes | None = None,
46	    ) -> None:
47	        """An Async client implementation providing a context manager for testing applications asynchronously.
48	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/async_client.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
102	    async def __aexit__(self, *args: Any) -> None:
103	        await self.exit_stack.aclose()
104	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/async_client.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
133	        try:
134	            await self.send(
135	                self._prepare_ws_connect_request(
136	                    url=url,
137	                    subprotocols=subprotocols,
138	                    params=params,
139	                    headers=headers,
140	                    cookies=cookies,
141	                    extensions=extensions,
142	                    timeout=timeout,
143	                ),
144	                auth=auth,
145	                follow_redirects=follow_redirects,
146	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/async_client.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
134	            await self.send(
135	                self._prepare_ws_connect_request(
136	                    url=url,
137	                    subprotocols=subprotocols,
138	                    params=params,
139	                    headers=headers,
140	                    cookies=cookies,
141	                    extensions=extensions,
142	                    timeout=timeout,
143	                ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/base.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	        app: T,
113	        base_url: str = "http://testserver.local",
114	        backend: AnyIOBackend = "asyncio",
115	        backend_options: Mapping[str, Any] | None = None,
116	        session_config: BaseBackendConfig | None = None,
117	        cookies: CookieTypes | None = None,
118	    ) -> None:
119	        if "." not in base_url:
120	            warn(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/base.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
205	            default_headers.setdefault("sec-websocket-protocol", ", ".join(subprotocols))
206	        return self.build_request(
207	            "GET",
208	            self.base_url.copy_with(scheme="ws").join(url),
209	            headers={**dict(headers or {}), **default_headers},  # type: ignore[misc]
210	            params=params,
211	            cookies=cookies,
212	            extensions=None if extensions is None else dict(extensions),
213	            timeout=timeout,
214	        )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/subprocess_client.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
15	def _get_available_port() -> int:
16	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
17	        # Bind to a free port provided by the host

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/subprocess_client.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    ) as proc:
37	        url = f"http://127.0.0.1:{port}"
38	        for _ in range(100):  # pragma: no cover

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/sync_client.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        app: T,
38	        base_url: str = "http://testserver.local",
39	        raise_server_exceptions: bool = True,
40	        root_path: str = "",
41	        backend: AnyIOBackend = "asyncio",
42	        backend_options: Mapping[str, Any] | None = None,
43	        session_config: BaseBackendConfig | None = None,
44	        timeout: float | None = None,
45	        cookies: CookieTypes | None = None,
46	    ) -> None:
47	        """A client implementation providing a context manager for testing applications.
48	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/sync_client.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
104	    def __exit__(self, *args: Any) -> None:
105	        self.exit_stack.close()
106	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/sync_client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
135	        try:
136	            self.send(
137	                self._prepare_ws_connect_request(
138	                    url=url,
139	                    subprotocols=subprotocols,
140	                    params=params,
141	                    headers=headers,
142	                    cookies=cookies,
143	                    extensions=extensions,
144	                    timeout=timeout,
145	                ),
146	                auth=auth,
147	                follow_redirects=follow_redirects,
148	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/client/sync_client.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
136	            self.send(
137	                self._prepare_ws_connect_request(
138	                    url=url,
139	                    subprotocols=subprotocols,
140	                    params=params,
141	                    headers=headers,
142	                    cookies=cookies,
143	                    extensions=extensions,
144	                    timeout=timeout,
145	                ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/helpers.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    backend_options: Mapping[str, Any] | None = None,
64	    base_url: str = "http://testserver.local",
65	    before_request: BeforeRequestHookHandler | None = None,
66	    before_send: Sequence[BeforeMessageSendHookHandler] | None = None,
67	    cache_control: CacheControlHeader | None = None,
68	    compression_config: CompressionConfig | None = None,
69	    cors_config: CORSConfig | None = None,
70	    csrf_config: CSRFConfig | None = None,
71	    debug: bool = True,
72	    dependencies: Dependencies | None = None,
73	    dto: type[AbstractDTO] | None | EmptyType = Empty,
74	    etag: ETag | None = None,
75	    event_emitter_backend: type[BaseEventEmitterBackend] = SimpleEventEmitter,
76	    exception_handlers: ExceptionHandlersMap | None = None,
77	    guards: Sequence[Guard] | None = None,
78	    include_in_schema: bool | EmptyType = Empty,
79	    listeners: Sequence[EventListener] | None = None,
80	    logging_config: BaseLoggingConfig | EmptyType | None = Empty,
81	    middleware: Sequence[Middleware] | None = None,
82	    multipart_form_part_limit: int = 1000,
83	    on_app_init: Sequence[OnAppInitHandler] | None = None,
84	    on_shutdown: Sequence[LifespanHook] | None = None,
85	    on_startup: Sequence[LifespanHook] | None = None,
86	    openapi_config: OpenAPIConfig | None = DEFAULT_OPENAPI_CONFIG,
87	    opt: Mapping[str, Any] | None = None,
88	    parameters: ParametersMap | None = None,
89	    path: str | None = None,
90	    plugins: Sequence[PluginProtocol] | None = None,
91	    lifespan: list[Callable[[Litestar], AbstractAsyncContextManager] | AbstractAsyncContextManager] | None = None,
92	    raise_server_exceptions: bool = True,
93	    pdb_on_exception: bool | None = None,
94	    request_class: type[Request] | None = None,
95	    response_cache_config: ResponseCacheConfig | None = None,
96	    response_class: type[Response] | None = None,
97	    response_cookies: ResponseCookies | None = None,
98	    response_headers: ResponseHeaders | None = None,
99	    return_dto: type[AbstractDTO] | None | EmptyType = Empty,
100	    root_path: str = "",
101	    security: Sequence[SecurityRequirement] | None = None,
102	    session_config: BaseBackendConfig | None = None,
103	    signature_namespace: Mapping[str, Any] | None = None,
104	    signature_types: Sequence[Any] | None = None,
105	    state: State | None = None,
106	    static_files_config: Sequence[StaticFilesConfig] | None = None,
107	    stores: StoreRegistry | dict[str, Store] | None = None,
108	    tags: Sequence[str] | None = None,
109	    template_config: TemplateConfig | None = None,
110	    timeout: float | None = None,
111	    type_encoders: TypeEncodersMap | None = None,
112	    websocket_class: type[WebSocket] | None = None,
113	    experimental_features: list[ExperimentalFeatures] | None = None,
114	) -> TestClient[Litestar]:
115	    """Create a Litestar app instance and initializes it.
116	
117	    :class:`TestClient <litestar.testing.TestClient>` with it.
118	
119	    Notes:
120	        - This function should be called as a context manager to ensure async startup and shutdown are
121	            handled correctly.
122	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/helpers.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
324	    backend_options: Mapping[str, Any] | None = None,
325	    base_url: str = "http://testserver.local",
326	    before_request: BeforeRequestHookHandler | None = None,
327	    before_send: Sequence[BeforeMessageSendHookHandler] | None = None,
328	    cache_control: CacheControlHeader | None = None,
329	    compression_config: CompressionConfig | None = None,
330	    cors_config: CORSConfig | None = None,
331	    csrf_config: CSRFConfig | None = None,
332	    debug: bool = True,
333	    dependencies: Dependencies | None = None,
334	    dto: type[AbstractDTO] | None | EmptyType = Empty,
335	    etag: ETag | None = None,
336	    event_emitter_backend: type[BaseEventEmitterBackend] = SimpleEventEmitter,
337	    exception_handlers: ExceptionHandlersMap | None = None,
338	    guards: Sequence[Guard] | None = None,
339	    include_in_schema: bool | EmptyType = Empty,
340	    lifespan: list[Callable[[Litestar], AbstractAsyncContextManager] | AbstractAsyncContextManager] | None = None,
341	    listeners: Sequence[EventListener] | None = None,
342	    logging_config: BaseLoggingConfig | EmptyType | None = Empty,
343	    middleware: Sequence[Middleware] | None = None,
344	    multipart_form_part_limit: int = 1000,
345	    on_app_init: Sequence[OnAppInitHandler] | None = None,
346	    on_shutdown: Sequence[LifespanHook] | None = None,
347	    on_startup: Sequence[LifespanHook] | None = None,
348	    openapi_config: OpenAPIConfig | None = DEFAULT_OPENAPI_CONFIG,
349	    opt: Mapping[str, Any] | None = None,
350	    parameters: ParametersMap | None = None,
351	    pdb_on_exception: bool | None = None,
352	    path: str | None = None,
353	    plugins: Sequence[PluginProtocol] | None = None,
354	    raise_server_exceptions: bool = True,
355	    request_class: type[Request] | None = None,
356	    response_cache_config: ResponseCacheConfig | None = None,
357	    response_class: type[Response] | None = None,
358	    response_cookies: ResponseCookies | None = None,
359	    response_headers: ResponseHeaders | None = None,
360	    return_dto: type[AbstractDTO] | None | EmptyType = Empty,
361	    root_path: str = "",
362	    security: Sequence[SecurityRequirement] | None = None,
363	    session_config: BaseBackendConfig | None = None,
364	    signature_namespace: Mapping[str, Any] | None = None,
365	    signature_types: Sequence[Any] | None = None,
366	    state: State | None = None,
367	    static_files_config: Sequence[StaticFilesConfig] | None = None,
368	    stores: StoreRegistry | dict[str, Store] | None = None,
369	    tags: Sequence[str] | None = None,
370	    template_config: TemplateConfig | None = None,
371	    timeout: float | None = None,
372	    type_encoders: TypeEncodersMap | None = None,
373	    websocket_class: type[WebSocket] | None = None,
374	    experimental_features: list[ExperimentalFeatures] | None = None,
375	) -> AsyncTestClient[Litestar]:
376	    """Create a Litestar app instance and initializes it.
377	
378	    :class:`AsyncTestClient <litestar.testing.AsyncTestClient>` with it.
379	
380	    Notes:
381	        - This function should be called as a context manager to ensure async startup and shutdown are
382	            handled correctly.
383	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/transport.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
69	                try:
70	                    chunk = body.send(None)
71	                    request_event["body"] = chunk if isinstance(chunk, bytes) else chunk.encode("utf-8")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/transport.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
141	    def handle_request(self, request: Request) -> Response:
142	        scope = self.parse_request(request=request)
143	        if scope["type"] == "websocket":

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/transport.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
168	                    self.create_receive(request=request, context=context),
169	                    self.create_send(request=request, context=context),
170	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/litestar-2.15.2/litestar-2.15.2/litestar/testing/transport.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
191	    async def handle_async_request(self, request: Request) -> Response:
192	        return self.handle_request(request=request)

--------------------------------------------------

Code scanned:
	Total lines of code: 39340
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 41.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 67.0
		High: 4.0
Files skipped (0):
