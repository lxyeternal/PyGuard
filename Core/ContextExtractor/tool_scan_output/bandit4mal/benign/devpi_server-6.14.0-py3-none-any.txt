Run started:2025-04-12 15:47:27.801008

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/auth.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
148	def newsalt():
149	    return base64.b64encode(secrets.token_bytes(16)).decode("ascii")
150	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/auth.py:149
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
148	def newsalt():
149	    return base64.b64encode(secrets.token_bytes(16)).decode("ascii")
150	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/config.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
461	    with open(config_file, 'rb') as f:
462	        content = f.read().decode('utf-8')
463	        config = strictyaml.load(content)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/config.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
628	def new_secret():
629	    return base64.b64encode(secrets.token_bytes(32))
630	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/config.py:629
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
628	def new_secret():
629	    return base64.b64encode(secrets.token_bytes(32))
630	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/config.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
667	                kwargs.setdefault("listen", []).append(listen)
668	                addresses.append("http://%s" % listen)
669	        if host or port:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/config.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
671	            kwargs['port'] = port
672	            hostaddr = "http://%s:%s" % (host, port)
673	            hostaddr6 = "http://[%s]:%s" % (host, port)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/config.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
672	            hostaddr = "http://%s:%s" % (host, port)
673	            hostaddr6 = "http://[%s]:%s" % (host, port)
674	            addresses.append("%s (might be %s for IPv6)" % (hostaddr, hostaddr6))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/config.py:779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
778	        with NamedTemporaryFile(prefix=prefix, delete=False, dir=nodeinfo_dir) as f:
779	            f.write(json.dumps(self.nodeinfo, indent=2).encode('utf-8'))
780	        fileutil.rename(f.name, self.nodeinfo_path)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/config.py:779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
778	        with NamedTemporaryFile(prefix=prefix, delete=False, dir=nodeinfo_dir) as f:
779	            f.write(json.dumps(self.nodeinfo, indent=2).encode('utf-8'))
780	        fileutil.rename(f.name, self.nodeinfo_path)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/config.py:1129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1128	                if mode & stat.S_IRWXG or mode & stat.S_IRWXO:
1129	                    config.secret_path.chmod(0o600)
1130	                    log.info("Changed file mode to 0600 to adjust access permissions.")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/filestore_fs.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	        # use hash of path, pid and thread id to prevent conflicts
22	        key = f"{path}{os.getpid()}{threading.current_thread().ident}"
23	        digest = sha256(key.encode('utf-8')).hexdigest()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/filestore_fs.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	                if isinstance(content_or_file, bytes):
48	                    f.write(content_or_file)
49	                else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	    def _load_collection(type_):
49	        length = _from_bytes(read(4), byteorder="big", signed=True)
50	        if length:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
58	    while True:
59	        opcode = read(1)
60	        if not opcode:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	        elif opcode == b'A':  # bytes
65	            stack_append(read(_from_bytes(read(4), byteorder="big", signed=True)))
66	        elif opcode == b'B':  # Channel

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	        elif opcode == b'A':  # bytes
65	            stack_append(read(_from_bytes(read(4), byteorder="big", signed=True)))
66	        elif opcode == b'B':  # Channel

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
70	        elif opcode == b'D':  # float
71	            stack_append(_unpack("!d", read(8))[0])
72	        elif opcode == b'E':  # frozenset

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
74	        elif opcode in (b'F', b'G'):  # int, long
75	            stack_append(_from_bytes(read(4), byteorder="big", signed=True))
76	        elif opcode in (b'H', b'I'):  # longint, longlong

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	        elif opcode in (b'H', b'I'):  # longint, longlong
77	            stack_append(int(read(_from_bytes(read(4), byteorder="big", signed=True))))
78	        elif opcode == b'J':  # dict

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	        elif opcode in (b'H', b'I'):  # longint, longlong
77	            stack_append(int(read(_from_bytes(read(4), byteorder="big", signed=True))))
78	        elif opcode == b'J':  # dict

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        elif opcode == b'K':  # list
81	            stack_append([None] * _from_bytes(read(4), byteorder="big", signed=True))
82	        elif opcode == b'L':  # None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
84	        elif opcode == b'M':  # Python 2 string
85	            stack_append(read(_from_bytes(read(4), byteorder="big", signed=True)))
86	        elif opcode in (b'N', b'S'):  # Python 3 string, unicode

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
84	        elif opcode == b'M':  # Python 2 string
85	            stack_append(read(_from_bytes(read(4), byteorder="big", signed=True)))
86	        elif opcode in (b'N', b'S'):  # Python 3 string, unicode

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	        elif opcode in (b'N', b'S'):  # Python 3 string, unicode
87	            stack_append(read(_from_bytes(read(4), byteorder="big", signed=True)).decode('utf-8'))
88	        elif opcode == b'O':  # set

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	        elif opcode in (b'N', b'S'):  # Python 3 string, unicode
87	            stack_append(read(_from_bytes(read(4), byteorder="big", signed=True)).decode('utf-8'))
88	        elif opcode == b'O':  # set

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	        elif opcode == b'T':  # complex
103	            stack_append(complex(_unpack("!d", read(8))[0], _unpack("!d", read(8))[0]))
104	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	        elif opcode == b'T':  # complex
103	            stack_append(complex(_unpack("!d", read(8))[0], _unpack("!d", read(8))[0]))
104	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	        _dispatch[item.__class__](write, item)
121	    write(b'@')
122	    write(_pack("!i", len(obj)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
121	    write(b'@')
122	    write(_pack("!i", len(obj)))
123	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
125	def _dump_bytes(write, obj, _pack=pack):
126	    write(b'A')
127	    write(_pack("!i", len(obj)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
126	    write(b'A')
127	    write(_pack("!i", len(obj)))
128	    write(obj)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	    write(_pack("!i", len(obj)))
128	    write(obj)
129	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	    if obj:
133	        write(b'R')
134	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
134	    else:
135	        write(b'C')
136	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	def _dump_float(write, obj, _pack=pack):
139	    write(b'D')
140	    write(_pack("!d", obj))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
139	    write(b'D')
140	    write(_pack("!d", obj))
141	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
145	        _dispatch[item.__class__](write, item)
146	    write(b'E')
147	    write(_pack("!i", len(obj)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
146	    write(b'E')
147	    write(_pack("!i", len(obj)))
148	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
151	    if obj > FOUR_BYTE_INT_MAX:
152	        write(b'H')
153	        s = f"{obj}".encode("ascii")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	        s = f"{obj}".encode("ascii")
154	        write(_pack("!i", len(s)))
155	        write(s)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
154	        write(_pack("!i", len(s)))
155	        write(s)
156	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	    else:
157	        write(b'F')
158	        write(_pack("!i", obj))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
157	        write(b'F')
158	        write(_pack("!i", obj))
159	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
161	def _dump_dict(write, obj):
162	    write(b'J')
163	    for k, v in obj.items():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
165	        _dispatch[v.__class__](write, v)
166	        write(b'P')
167	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
169	def _dump_list(write, obj, _pack=pack):
170	    write(b'K')
171	    write(_pack("!i", len(obj)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	    write(b'K')
171	    write(_pack("!i", len(obj)))
172	    for i, v in enumerate(obj):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
174	        _dispatch[v.__class__](write, v)
175	        write(b'P')
176	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
178	def _dump_none(write, obj):
179	    write(b'L')
180	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186	        raise DumpError("strings must be utf-8 encodable")
187	    write(b'N')
188	    write(_pack("!i", len(obj)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
187	    write(b'N')
188	    write(_pack("!i", len(obj)))
189	    write(obj)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
188	    write(_pack("!i", len(obj)))
189	    write(obj)
190	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
194	        _dispatch[item.__class__](write, item)
195	    write(b'O')
196	    write(_pack("!i", len(obj)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
195	    write(b'O')
196	    write(_pack("!i", len(obj)))
197	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
199	def _dump_complex(write, obj, _pack=pack):
200	    write(b'T')
201	    write(_pack("!d", obj.real))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
200	    write(b'T')
201	    write(_pack("!d", obj.real))
202	    write(_pack("!d", obj.imag))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
201	    write(_pack("!d", obj.real))
202	    write(_pack("!d", obj.imag))
203	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
235	        raise DumpError(f"can't serialize {e.args[0]}")
236	    write(b'Q')
237	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
277	        with open(path, "rb") as f:
278	            return int(f.read())
279	    except IOError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/fileutil.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
285	    with get_write_file_ensure_dir(tmp_path) as f:
286	        f.write(str(val).encode("utf-8"))
287	    rename(tmp_path, path)

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/genconfig.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
47	        server_args=subprocess.list2cmdline(argv),
48	        user=getpass.getuser(),
49	        devpibin=devpibin)

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/genconfig.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
47	        server_args=subprocess.list2cmdline(argv),
48	        user=getpass.getuser(),
49	        devpibin=devpibin)

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/genconfig.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
58	        "crontab",
59	        user=getpass.getuser())
60	    writer("crontab", content)

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/genconfig.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
58	        "crontab",
59	        user=getpass.getuser())
60	    writer("crontab", content)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/genconfig.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    if outside_url is None:  # default
66	        outside_url = "http://localhost:80"
67	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/genconfig.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	    if outside_url is None:  # default
90	        outside_url = "http://localhost:80"
91	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/genconfig.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
144	        server_args=subprocess.list2cmdline(argv),
145	        user=getpass.getuser(),
146	        devpibin=devpibin,

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/genconfig.py:145
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
144	        server_args=subprocess.list2cmdline(argv),
145	        user=getpass.getuser(),
146	        devpibin=devpibin,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/importexport.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
171	            with open(dest.strpath, 'wb') as df:
172	                with entry.file_open_read() as sf:
173	                    shutil.copyfileobj(sf, df)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/importexport.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
208	            f"writing {path.relto(self.basepath)}, length {len(writedata)}")
209	        path.write(writedata)
210	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/importexport.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
320	        self.tw.line(f"reading json: {path}")
321	        return json.loads(path.read())
322	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/interfaces.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
190	            content_or_file.seek(0)
191	            content_or_file = content_or_file.read()
192	        if len(content_or_file) > 1048576:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
257	        if isinstance(content_or_file, bytes):
258	            f.write(content_or_file)
259	            f.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
257	        if isinstance(content_or_file, bytes):
258	            f.write(content_or_file)
259	            f.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	            f.seek(0)
288	            content = f.read()
289	            f.seek(pos)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
323	        f.seek(0)
324	        content = f.read()
325	        f.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
344	            else:
345	                self._file_write(path, f)
346	                files_commit.append(path)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
344	            else:
345	                self._file_write(path, f)
346	                files_commit.append(path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
453	            start_time = time.monotonic()
454	            thread = current_thread()
455	            while 1:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite_fs.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	        key = "%s%i%i" % (
27	            path, os.getpid(), threading.current_thread().ident)
28	        digest = sha256(key.encode('utf-8')).hexdigest()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite_fs.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	                if isinstance(content_or_file, bytes):
56	                    f.write(content_or_file)
57	                else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/keyfs_sqlite_fs.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
117	        with open(path, "rb") as f:
118	            data = f.read()
119	            if len(data) > 1048576:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
214	    log.info("using %s threads", kwargs['threads'])
215	    log.info("bug tracker: https://github.com/devpi/devpi/issues")
216	    if "WEBTRACE" in os.environ and xom.config.args.debug:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
282	        self.thread_pool = mythread.ThreadPool()
283	        self.async_thread = AsyncioLoopThread(self)
284	        self.async_tasks = set()

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
282	        self.thread_pool = mythread.ThreadPool()
283	        self.async_thread = AsyncioLoopThread(self)
284	        self.async_tasks = set()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
306	            if not self.config.requests_only:
307	                self.replica_thread = ReplicaThread(self)
308	                self.thread_pool.register(self.replica_thread)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
306	            if not self.config.requests_only:
307	                self.replica_thread = ReplicaThread(self)
308	                self.thread_pool.register(self.replica_thread)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
446	        cafile = (
447	            os.environ.get("REQUESTS_CA_BUNDLE")
448	            or os.environ.get("CURL_CA_BUNDLE")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	            os.environ.get("REQUESTS_CA_BUNDLE")
448	            or os.environ.get("CURL_CA_BUNDLE")
449	            or DEFAULT_CA_BUNDLE_PATH

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
469	            ) as client:
470	                response = await client.get(url, headers=extra_headers)
471	                if response.status_code < 300:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
497	        try:
498	            resp = self._httpsession.get(
499	                url, stream=True,
500	                allow_redirects=allow_redirects,
501	                headers=headers,
502	                timeout=timeout or self.config.args.request_timeout)
503	        except OSError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
525	        if self.is_replica():
526	            if info.options.get('is_mutating', True):
527	                from .model import ensure_list

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
714	def get_remote_ip(request):
715	    return request.headers.get("X-REAL-IP", request.client_addr)
716	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
759	        threadlog.info("created root user")
760	    userconfig = root_user.key.get(readonly=False)
761	    indexes = userconfig["indexes"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
770	    "title": "PyPI",
771	    "mirror_url": "https://pypi.org/simple/",
772	    "mirror_web_url_fmt": "https://pypi.org/project/{name}/"}
773	
774	
775	def tween_request_profiling(handler, registry):
776	    from cProfile import Profile

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/main.py:772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
771	    "mirror_url": "https://pypi.org/simple/",
772	    "mirror_web_url_fmt": "https://pypi.org/project/{name}/"}
773	
774	
775	def tween_request_profiling(handler, registry):
776	    from cProfile import Profile
777	    req = [0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/model.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
493	    def get_principals_for_pkg_read(self, restrict_modify=None):
494	        principals = self.hooks.devpiserver_stage_get_principals_for_pkg_read(
495	            ixconfig=self.stage.ixconfig)
496	        if principals is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/model.py:843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
842	        for reflink in linkstore.get_links(rel="toxresult", for_entrypath=link):
843	            with reflink.entry.file_open_read() as f:
844	                l.append(json.load(f))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/replica.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
356	        for i in range(num_threads):
357	            frt = FileReplicationThread(xom, self.shared_data)
358	            self.file_replication_threads.append(frt)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/replica.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
359	            xom.thread_pool.register(frt)
360	        self.initial_queue_thread = InitialQueueThread(xom, self.shared_data)
361	        xom.thread_pool.register(self.initial_queue_thread)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/replica.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
599	                    while True:
600	                        serial = load(stream)
601	                        (changes, rel_renames) = load(stream)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/replica.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
600	                        serial = load(stream)
601	                        (changes, rel_renames) = load(stream)
602	                        self.xom.keyfs.import_changes(serial, changes)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/replica.py:1285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1284	                body = request.body
1285	            return http.request(request.method, url,
1286	                                data=body,
1287	                                headers=headers,
1288	                                stream=stream,
1289	                                allow_redirects=False,
1290	                                timeout=xom.config.args.proxy_timeout)
1291	        except http.Errors as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	    request.headers.setdefault("Accept", "*/*")
104	    if "application/json" in request.headers.get("Accept", ""):
105	        apireturn(code, body)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	    # XXX do proper "best" matching
164	    return "application/json" in request.headers.get("Accept", "")
165	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
202	            rheaders = response.headers
203	            serial = rheaders.get("X-DEVPI-SERIAL")
204	            rheaders.update(meta_headers)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	                      serial,
214	                      rheaders.get("content-length"),
215	                      rheaders.get("content-type"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	                      rheaders.get("content-length"),
215	                      rheaders.get("content-type"))
216	        finally:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	def make_uuid_headers(nodeinfo):
223	    uuid = primary_uuid = nodeinfo.get("uuid")
224	    if uuid is not None and nodeinfo["role"] == "replica":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	                stacklevel=2)
230	            primary_uuid = nodeinfo.get("master-uuid", "")
231	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	        else:
232	            primary_uuid = nodeinfo.get("primary-uuid", "")
233	    return uuid, primary_uuid

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
565	        request_extensions = request.registry.queryUtility(IRequestExtensions)
566	        url = request.headers.get('x-original-uri', request.url)
567	        orig_request = Request.blank(url, headers=request.headers)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
580	        with RequestContext(orig_request):
581	            return self._auth_check_request(orig_request)
582	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
580	        with RequestContext(orig_request):
581	            return self._auth_check_request(orig_request)
582	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
690	        if stage.ixconfig['type'] == 'mirror':
691	            serial = stage.key_projsimplelinks(project).get().get("serial")
692	            if serial is not None and serial > 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
690	        if stage.ixconfig['type'] == 'mirror':
691	            serial = stage.key_projsimplelinks(project).get().get("serial")
692	            if serial is not None and serial > 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
831	            h2 = stage.name
832	            bases = getattr(stage, "ixconfig", {}).get("bases")
833	            if bases:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
942	        if isinstance(json, list):
943	            ixconfig = stage.get()
944	            for op, key, value in get_actions(json):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
966	            json = ixconfig
967	        if json.get('type') == 'indexconfig' and 'result' in json:
968	            json = json['result']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1008	        request = self.request
1009	        if request.POST.get(':action'):
1010	            # this is actually a submit

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1089
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1088	                    try:
1089	                        r = session.post(posturl, data=metadata, auth=pypiauth)
1090	                        r.close()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1100	                if proceed:
1101	                    for link in links.get("releasefile", ()):
1102	                        entry = link.entry

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1114	                        try:
1115	                            r = session.post(
1116	                                posturl, data=file_metadata, auth=pypiauth,
1117	                                files={"content": (basename, content)})
1118	                        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1127	                            r.close()
1128	                    if links.get("doczip", ()):
1129	                        doc_metadata = metadata.copy()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1132	                        try:
1133	                            r = session.post(
1134	                                posturl, data=doc_metadata, auth=pypiauth,
1135	                                files={"content": (name + ".zip", doczip)})
1136	                            r.close()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1149	        stage = self.context.stage
1150	        for link in links.get("releasefile", ()):
1151	            entry = link.entry

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1159	                entry = self.xom.filestore.get_file_entry(entry.relpath)
1160	            with entry.file_open_read() as f:
1161	                new_link = target_stage.store_releasefile(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1166	                x for x in logs
1167	                if x.get('what') != 'overwrite')
1168	            new_link.add_log(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1179	                    ref_link = tstore.get_links(entrypath=new_entry.relpath)[0]
1180	                    with toxlink.entry.file_open_read() as f:
1181	                        tlink = target_stage.store_toxresult(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1184	                        x for x in toxlink.get_logs()
1185	                        if x.get('what') != 'overwrite')
1186	                    tlink.add_log(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1191	                    yield (200, "store_toxresult", tlink.entrypath)
1192	        for link in links.get("doczip", ()):
1193	            with link.entry.file_open_read() as doczip:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1192	        for link in links.get("doczip", ()):
1193	            with link.entry.file_open_read() as doczip:
1194	                new_link = target_stage.store_doczip(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1216	                response = HTTPUnauthorized()
1217	                response.headers.update(forget(request))
1218	                return response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1238	        # version may be empty on plain doczip uploads
1239	        version = ensure_unicode(request.POST.get("version") or "")
1240	        project = normalize_name(name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1309	            else:
1310	                val = form.get(key, "")
1311	                if val == "UNKNOWN":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1499	            return Response(
1500	                app_iter=FileIter(entry.file_open_read()), headers=headers)
1501	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1503	    def mirror_pkgserv(self):
1504	        relpath = self._relpath_from_request()
1505	        # when a release is deleted from a mirror, we update the metadata,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1503	    def mirror_pkgserv(self):
1504	        relpath = self._relpath_from_request()
1505	        # when a release is deleted from a mirror, we update the metadata,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1517	    def stage_pkgserv(self):
1518	        relpath = self._relpath_from_request()
1519	        entry = self.xom.filestore.get_file_entry(relpath)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1517	    def stage_pkgserv(self):
1518	        relpath = self._relpath_from_request()
1519	        entry = self.xom.filestore.get_file_entry(relpath)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1570	        dict = getjson(request)
1571	        user = dict.get("user", None)
1572	        password = dict.get("password", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1571	        user = dict.get("user", None)
1572	        password = dict.get("password", None)
1573	        if user is None or password is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1602	        user = self.context.user
1603	        password = kvdict.get("password")
1604	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1634	                apireturn(400, message=", ".join(e.messages))
1635	            apireturn(201, type="userconfig", result=user.get())
1636	        apireturn(400, "password needs to be set")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1647	            abort(self.request, 404, "required user %r does not exist" % context.username)
1648	        userconfig = context.user.get()
1649	        if not userconfig:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1650	            apireturn(404, "user %r does not exist" % context.username)
1651	        for name, ixconfig in userconfig.get("indexes", {}).items():
1652	            if not ixconfig["volatile"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1662	            apireturn(404, "user %r does not exist" % self.context.username)
1663	        userconfig = self.context.user.get()
1664	        apireturn(200, type="userconfig", result=userconfig)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1669	        for user in self.model.get_userlist():
1670	            d[user.name] = user.get()
1671	        apireturn(200, type="list:userconfig", result=d)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1679	def _headers_from_response(r):
1680	    content_type = r.headers.get('content-type')
1681	    if not content_type:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1708	        running_hashes.start()
1709	        content_size = self.response.headers.get("content-length")
1710	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1713	        while 1:
1714	            data = self.response.raw.read(10240)
1715	            if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1719	                rh.update(data)
1720	            self.f.write(data)
1721	            yield data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1738	    url = URL(url)
1739	    r = stage.httpget(url, allow_redirects=True)
1740	    if r.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1774	                    f,
1775	                    last_modified=r.headers.get("last-modified", None),
1776	                    hash_spec=entry._hash_spec,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1815	        threadlog.info("replica doesn't have file: %s", entry.relpath)
1816	    r = stage.httpget(
1817	        primary_url, allow_redirects=True,
1818	        extra_headers={xom.replica_thread.H_REPLICA_FILEREPL: "YES"})
1819	    if r.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/devpi_server/views.py:1834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1833	            headers["Authorization"] = f"Basic {b64encode(auth).decode()}"
1834	        r = xom.httpget(url, allow_redirects=True, extra_headers=headers)
1835	        if r.status_code != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	
75	def make_file_url(basename, content, stagename=None, baseurl="http://localhost/", add_hash=True):
76	    from devpi_server.filestore import get_hashes

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
90	    def get(self, timeout=2):
91	        return BaseQueue.get(self, timeout=timeout)
92	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	            msgrex = re.compile(msgrex, re.DOTALL)
137	        minlevelno = {"DEBUG": 10, "INFO": 20, "WARNING": 30,
138	                      "ERROR": 40, "FATAL": 50}.get(minlevel)
139	        recs = []

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
202	    write = bool(request.node.get_closest_marker("writetransaction"))
203	    keyfs.begin_transaction_in_thread(write=write)
204	    yield

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
205	    try:
206	        keyfs.rollback_transaction_in_thread()
207	    except AttributeError:  # already finished within the test

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
316	        if request.node.get_closest_marker("with_replica_thread"):
317	            fullopts.append("--primary-url=http://localhost")
318	        if not request.node.get_closest_marker("no_storage_option"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
325	                info = config._storage_info()
326	                markers = info.get("_test_markers", [])
327	                if marker not in markers:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	    from devpi_server.replica import register_key_subscribers
362	    primary_url = "http://localhost:3111"
363	    xom = makexom(["--primary-url", primary_url, "--secretfile", secretfile])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
415	                def __init__(xself, url):
416	                    fakeresponse = self.url2response.get(url)
417	                    from_list = False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
435	                        xself.raw = BytesIO(fakeresponse["content"])
436	                    xself.headers.setdefault('content-type', fakeresponse.get(
437	                        'content_type', 'text/html'))
438	                    if "etag" in fakeresponse:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
473	            kw.setdefault("reason", getattr(
474	                status_map.get(kw["status_code"]),
475	                "title",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
636	        if code == 200:
637	            password = r.json.get("result", r.json)["password"]
638	            self.testapp.set_auth(user, password)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
658	        result = {}
659	        for index, data in r.json["result"].get("indexes", {}).items():
660	            result["%s/%s" % (name, index)] = data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
682	    def downloadrelease(self, code, url):
683	        r = self.testapp.get(url, expect_errors=True)
684	        if isinstance(code, tuple):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
706	            assert res["username"] == user
707	            assert res.get("email") == email
708	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
748	        if code in (200,201):
749	            assert r.json["result"]["type"] == indexconfig.get("type", "stage")
750	            if use:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
765	            if isinstance(indexconfig, dict):
766	                assert r.json["result"]["type"] == indexconfig.get("type", "stage")
767	            return r.json["result"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:827
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
826	        r = self.testapp.get_json("/%s" % indexname)
827	        return r.json["result"].get("acl_" + acltype, None)
828	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:853
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
852	        metadata[":action"] = "submit"
853	        r = self.testapp.post("/%s/" % indexname, metadata,
854	                              expect_errors=True)
855	        assert r.status_code == code

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
872	                dict(name=name, version=version), set_whitelist=set_whitelist)
873	        r = self.testapp.post("/%s/" % indexname,
874	            {":action": "file_upload", "name": name, "version": version,
875	             "content": Upload(basename, content)}, expect_errors=True)
876	        assert r.status_code == code

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:875
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
874	            {":action": "file_upload", "name": name, "version": version,
875	             "content": Upload(basename, content)}, expect_errors=True)
876	        assert r.status_code == code

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
905	        form = {":action": "doc_upload", "name": name,
906	                "content": Upload(basename, content)}
907	        if version:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
908	            form["version"] = version
909	        r = self.testapp.post("/%s/" % indexname, form, expect_errors=True)
910	        assert r.status_code == code

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
922	    def upload_toxresult(self, path, content, code=200, waithooks=False):
923	        r = self.testapp.post(path, content, expect_errors=True)
924	        assert r.status_code == code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:930
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
929	    def get_simple(self, project, code=200):
930	        r = self.testapp.get(self.api.simpleindex + project + '/',
931	                             expect_errors=True)
932	        assert r.status_code == code

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
951	    for x in l:
952	        x.close()
953	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
981	            kw["params"] = params
982	        return super(MyTestApp, self)._gen_request(method, url, **kw)
983	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
981	            kw["params"] = params
982	        return super(MyTestApp, self)._gen_request(method, url, **kw)
983	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
987	            kwargs.setdefault("expect_errors", True)
988	        r = self._gen_request("POST", *args, **kwargs)
989	        if code is not None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
987	            kwargs.setdefault("expect_errors", True)
988	        r = self._gen_request("POST", *args, **kwargs)
989	        if code is not None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:995
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
994	        kw.setdefault("expect_errors", True)
995	        return self._gen_request("POST", url, params=params, **kw)
996	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:995
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
994	        kw.setdefault("expect_errors", True)
995	        return self._gen_request("POST", url, params=params, **kw)
996	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1003	        follow = kwargs.pop("follow", True)
1004	        response = self._gen_request("GET", *args, **kwargs)
1005	        if follow and response.status_code == 302:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1003	        follow = kwargs.pop("follow", True)
1004	        response = self._gen_request("GET", *args, **kwargs)
1005	        if follow and response.status_code == 302:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1006	            assert response.location != args[0]
1007	            return self.get(response.location, *args[1:], **kwargs)
1008	        return response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1012	            kwargs["follow"] = False
1013	        r = self.get(*args, **kwargs)
1014	        assert r.status_code == code

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1019
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1018	        kwargs.setdefault("expect_errors", True)
1019	        r = self._gen_request("DELETE", *args, **kwargs)
1020	        assert r.status_code == code

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1019
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1018	        kwargs.setdefault("expect_errors", True)
1019	        r = self._gen_request("DELETE", *args, **kwargs)
1020	        assert r.status_code == code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1025	        headers["Accept"] = "application/json"
1026	        return self.get(*args, **kwargs)
1027	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1049
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1048	        import json
1049	        self.base_url = "http://%s:%s" % host_port
1050	        self.headers = {}

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1084
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1083	def get_open_port(host):
1084	    with closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:
1085	        s.bind((host, 0))

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1093
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1092	    while timeout > 0:
1093	        with closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:
1094	            s.settimeout(1)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
1093	        with closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:
1094	            s.settimeout(1)
1095	            if s.connect_ex((host, port)) == 0:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1108	    yield srvdir
1109	    shutil.rmtree(srvdir, ignore_errors=True)
1110	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1191	    if not secretfile.exists():
1192	        secretfile.write_bytes(base64.b64encode(secrets.token_bytes(32)))
1193	        if sys.platform != "win32":

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1192
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1191	    if not secretfile.exists():
1192	        secretfile.write_bytes(base64.b64encode(secrets.token_bytes(32)))
1193	        if sys.platform != "win32":

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1193	        if sys.platform != "win32":
1194	            secretfile.chmod(0o600)
1195	    return str(secretfile)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1261	            "--role", "replica",
1262	            "--primary-url", "http://%s:%s" % primary_host_port])
1263	    p = subprocess.Popen(args)

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
1378	    port = get_open_port(host)
1379	    server = httpserver.HTTPServer((host, port), SimPyPIRequestHandler)
1380	    thread = threading.Thread(target=server.serve_forever)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1379	    server = httpserver.HTTPServer((host, port), SimPyPIRequestHandler)
1380	    thread = threading.Thread(target=server.serve_forever)
1381	    thread.daemon = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1404	    def pypi_package_link(self, pkgname, md5=True):
1405	        link = "https://pypi.org/package/some/%s" % pkgname
1406	        if md5 is True:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1460	    import warnings
1461	    hash_type = os.environ.get("DEVPI_SERVER_TEST_DEFAULT_HASH_TYPE")
1462	    if hash_type:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/plugin.py:1467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1466	    filestore.DEFAULT_HASH_TYPES = filestore._get_default_hash_types()
1467	    hash_types = os.environ.get("DEVPI_SERVER_TEST_ADDITIONAL_HASH_TYPES")
1468	    if hash_types:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/reqmock.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
11	def reqmock(monkeypatch):
12	    mr = mocked_request()
13	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/reqmock.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
23	    def patch_reqsessionmock(session):
24	        mr = mocked_request()
25	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/reqmock.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
39	    def send(self, request, **kwargs):
40	        return self.mock_request.process_request(request, kwargs)
41	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/reqmock.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	        url = request.url
49	        response = self.url2reply.get((url, request.method))
50	        if response is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/reqmock.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	        if response is None:
51	            response = self.url2reply.get((url, None))
52	            if response is None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/reqmock.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
58	                    raise Exception("not mocked call to %s" % url)  # noqa: TRY002
59	        response.add_request(request)
60	        r = HTTPAdapter().build_response(request, response.make())

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/reqmock.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
90	        if self.on_request:
91	            self.on_request(request)
92	        self.requests.append(request)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/simpypi.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	    def __init__(self, address):
108	        self.baseurl = "http://%s:%s" % address
109	        self.simpleurl = "%s/simple" % self.baseurl

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    testapp.xget(
23	        401, 'http://localhost/+authcheck',
24	        headers=ResponseHeaders({
25	            'X-Original-URI': 'http://localhost/'}))
26	    basic_auth = '%s:%s' % ('user1', '1')
27	    testapp.xget(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        headers=ResponseHeaders({
25	            'X-Original-URI': 'http://localhost/'}))
26	    basic_auth = '%s:%s' % ('user1', '1')
27	    testapp.xget(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    testapp.xget(
28	        200, 'http://localhost/+authcheck',
29	        headers=ResponseHeaders({
30	            'Authorization': 'Basic %s' % b64encode(basic_auth).decode('ascii'),
31	            'X-Original-URI': 'http://localhost/'}))
32	
33	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	            'Authorization': 'Basic %s' % b64encode(basic_auth).decode('ascii'),
31	            'X-Original-URI': 'http://localhost/'}))
32	
33	
34	def test_authcheck_devpi_auth(makemapp, maketestapp, makexom):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    testapp.xget(
40	        401, 'http://localhost/+authcheck',
41	        headers=ResponseHeaders({
42	            'X-Original-URI': 'http://localhost/'}))
43	    testapp.set_auth('user1', '1')
44	    testapp.xget(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	        headers=ResponseHeaders({
42	            'X-Original-URI': 'http://localhost/'}))
43	    testapp.set_auth('user1', '1')
44	    testapp.xget(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    testapp.xget(
45	        200, 'http://localhost/+authcheck',
46	        headers=ResponseHeaders({
47	            'X-Original-URI': 'http://localhost/'}))
48	
49	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        headers=ResponseHeaders({
47	            'X-Original-URI': 'http://localhost/'}))
48	
49	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    testapp.xget(
52	        200, 'http://localhost/+authcheck',
53	        headers=ResponseHeaders({
54	            'X-Original-URI': 'http://localhost/+api'}))
55	    testapp.xget(
56	        200, 'http://localhost/+authcheck',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        headers=ResponseHeaders({
54	            'X-Original-URI': 'http://localhost/+api'}))
55	    testapp.xget(
56	        200, 'http://localhost/+authcheck',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    testapp.xget(
56	        200, 'http://localhost/+authcheck',
57	        headers=ResponseHeaders({
58	            'X-Original-URI': 'http://localhost/+login'}))
59	
60	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	        headers=ResponseHeaders({
58	            'X-Original-URI': 'http://localhost/+login'}))
59	
60	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	    testapp.xget(
63	        403, 'http://localhost/+authcheck',
64	        headers=ResponseHeaders({
65	            'X-Original-URI': 'http://localhost/+unavailable_route/'}))
66	    testapp.xget(
67	        403, 'http://localhost/+authcheck',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        headers=ResponseHeaders({
65	            'X-Original-URI': 'http://localhost/+unavailable_route/'}))
66	    testapp.xget(
67	        403, 'http://localhost/+authcheck',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	    testapp.xget(
67	        403, 'http://localhost/+authcheck',
68	        headers=ResponseHeaders({
69	            'X-Original-URI': 'http://localhost/user/+unavailable_route/'}))
70	    testapp.xget(
71	        403, 'http://localhost/+authcheck',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	        headers=ResponseHeaders({
69	            'X-Original-URI': 'http://localhost/user/+unavailable_route/'}))
70	    testapp.xget(
71	        403, 'http://localhost/+authcheck',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	    testapp.xget(
71	        403, 'http://localhost/+authcheck',
72	        headers=ResponseHeaders({
73	            'X-Original-URI': 'http://localhost/user/index/+unavailable_route/'}))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_authcheck.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        headers=ResponseHeaders({
73	            'X-Original-URI': 'http://localhost/user/index/+unavailable_route/'}))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_config.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	    def test_role_permanence_replica(self, tmpdir):
222	        config = make_config(["devpi-server", "--primary-url", "http://qwe",
223	                               "--serverdir", str(tmpdir)])
224	        config.init_nodeinfo()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_config.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
285	        config = make_config([
286	            "devpi-server", "--primary-url=http://foo:pass@localhost", "--role=replica",
287	            "--serverdir", str(tmpdir)])
288	        with pytest.deprecated_call():
289	            assert config.master_auth == ('foo', 'pass')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_config.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
290	        with pytest.deprecated_call():
291	            assert config.master_url.url == "http://localhost"
292	        assert caplog.getrecords('--master-url') == []

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_config.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
400	            "devpi-server",
401	            "--trusted-proxy", "127.0.0.1",
402	            "--trusted-proxy-count", "2",
403	            "--trusted-proxy-headers", "x-forwarded-for x-forwarded-host x-forwarded-proto x-forwarded-port"))
404	        kwargs = config.waitress_info['kwargs']
405	        assert kwargs["trusted_proxy"] == "127.0.0.1"
406	        assert kwargs["trusted_proxy_count"] == 2

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_config.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
404	        kwargs = config.waitress_info['kwargs']
405	        assert kwargs["trusted_proxy"] == "127.0.0.1"
406	        assert kwargs["trusted_proxy_count"] == 2

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
60	def test_import_wrong_dumpversion(tmpdir, terminalwriter, xom):
61	    tmpdir.join("dataindex.json").write('{"dumpversion": "0"}')
62	    with pytest.raises(Fatal):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
69	    assert not ret
70	    data = json.loads(tmpdir.join("dataindex.json").read())
71	    assert data["dumpversion"] == Exporter.DUMPVERSION

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
543	            assert stage.ixconfig['title'] == 'Modified PyPI'
544	            assert stage.ixconfig['mirror_url'] == 'https://example.com/simple/'
545	            assert stage.ixconfig['mirror_web_url_fmt'] == 'https://example.com/project/{name}/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
544	            assert stage.ixconfig['mirror_url'] == 'https://example.com/simple/'
545	            assert stage.ixconfig['mirror_web_url_fmt'] == 'https://example.com/project/{name}/'
546	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:916
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
915	            assert 'index.html' in archive.namelist()
916	            assert archive.read("index.html").decode('utf-8') == "<html/>"
917	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
976	            assert 'index.html' in archive.namelist()
977	            assert archive.read("index.html").decode('utf-8') == "<html/>"
978	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:1016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1015	            assert 'index.html' in archive.namelist()
1016	            assert archive.read("index.html").decode('utf-8') == "<html/>"
1017	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:1111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1110	            type="mirror",
1111	            mirror_url="http://localhost:6543/index/",
1112	            mirror_cache_expiry="600")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:1126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1125	            volatile=True,
1126	            mirror_url="http://localhost:6543/index/",
1127	            mirror_cache_expiry=600,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1133	            type="mirror",
1134	            mirror_url="http://localhost:6543/index/")
1135	        api = mapp1.create_and_use(indexconfig=indexconfig)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_importexport.py:1157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1156	            volatile=True,
1157	            mirror_url="http://localhost:6543/index/",
1158	            projects=[])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
11	        file1_tmp = file1 + "-tmp"
12	        file1.write("hello")
13	        file1_tmp.write("this")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
12	        file1.write("hello")
13	        file1_tmp.write("this")
14	        pending_renames = [(str(file1_tmp), str(file1))]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
17	        assert file1.check()
18	        assert file1.read() == "this"
19	        assert not file1_tmp.exists()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	        assert file1.check()
22	        assert file1.read() == "this"
23	        assert not file1_tmp.exists()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
27	        file1_tmp = file1 + "-tmp"
28	        file1.write("hello")
29	        file1_tmp.write("this")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
28	        file1.write("hello")
29	        file1_tmp.write("this")
30	        pending_renames = [(str(file1_tmp), str(file1))]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	        # we don't call perform_pending_renames, simulating a crash
33	        assert file1.read() == "hello"
34	        assert file1_tmp.exists()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
36	        assert file1.check()
37	        assert file1.read() == "this"
38	        assert not file1_tmp.exists()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
42	        file1 = tmpdir.join("file1")
43	        file1.write("hello")
44	        pending_renames = [(None, str(file1))]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_keyfs_sqlite_fs.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
52	        file1 = tmpdir.join("file1")
53	        file1.write("hello")
54	        pending_renames = [(None, str(file1))]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_main.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	
107	    xom = makexom(opts=["--requests-only", "--primary-url=http://localhost:3140"])
108	    xom.create_app()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_main.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
237	@pytest.mark.parametrize("url", [
238	    "http://someserver/path",
239	    "https://pypi.org/simple/package/",
240	])
241	@pytest.mark.parametrize("allowRedirect", [True, False])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_main.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	    "http://someserver/path",
239	    "https://pypi.org/simple/package/",
240	])
241	@pytest.mark.parametrize("allowRedirect", [True, False])
242	def test_offline_mode_httpget_returns_server_error(makexom, url, allowRedirect):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_main.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
261	    xom = makexom(["--replica-max-retries=2"])
262	    monkeypatch.setenv("HTTP_PROXY", "http://this")
263	    monkeypatch.setenv("HTTPS_PROXY", "http://that")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_main.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
262	    monkeypatch.setenv("HTTP_PROXY", "http://this")
263	    monkeypatch.setenv("HTTPS_PROXY", "http://that")
264	    monkeypatch.setattr("devpi_server.main.new_requests_session", new_requests_session)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_main.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	
266	    r = xom.httpget("http://example.com", allow_redirects=False,
267	                              timeout=1.2)
268	    assert r.status_code == -1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_main.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	
266	    r = xom.httpget("http://example.com", allow_redirects=False,
267	                              timeout=1.2)
268	    assert r.status_code == -1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_main.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
282	
283	    xom.httpget("http://whatever", allow_redirects=False, timeout=input_set['kwarg'])
284	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_main.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
282	
283	    xom.httpget("http://whatever", allow_redirects=False, timeout=input_set['kwarg'])
284	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	class TestIndexParsing:
18	    simplepy = URL("https://pypi.org/simple/py/")
19	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    def test_parse_index_simple_nocase(self):
46	        simplepy = URL("https://pypi.org/simple/Py/")
47	        result = parse_index(simplepy,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	    def test_parse_index_normalized_name(self):
54	        simplepy = URL("https://pypi.org/simple/ndg-httpsclient/")
55	        result = parse_index(simplepy, """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	    def test_parse_index_with_rel(self, rel):
68	        result = parse_index(self.simplepy, """
69	               <a href="http://pylib.org" rel="%s">whatever</a>
70	               <a href="http://pylib2.org" rel="%s">whatever2</a>
71	               <a href="http://pylib3.org">py-1.0.zip</a>
72	               <a href="http://pylib2.org/py-1.0.zip" rel="%s">whatever2</a>
73	        """ % (rel,rel, rel))
74	        assert len(result.releaselinks) == 1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	        link, = result.releaselinks
76	        assert link == "http://pylib2.org/py-1.0.zip"
77	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	    def test_parse_index_with_num_in_project(self):
181	        simple = URL("https://pypi.org/simple/py-4chan/")
182	        result = parse_index(simple, '<a href="pkg/py-4chan-1.0.zip"/>')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	    def test_parse_index_unparseable_url(self):
187	        simple = URL("https://pypi.org/simple/x123/")
188	        result = parse_index(simple, '<a href="http:" />')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	        result = parse_index(self.simplepy,
193	            """<a href="http://bb.org/download/py-1.0.zip" />
194	               <a href="ftp://bb.org/download/py-1.0.tar.gz" />
195	               <a rel="download" href="ftp://bb.org/download/py-1.1.tar.gz" />

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
202	        result = parse_index(self.simplepy,
203	            """<a href="http://bb.org/download/p.zip" />
204	            <a href="http://bb.org/download/py-1.0.zip" />""")
205	        assert len(result.releaselinks) == 1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	        result = parse_index(self.simplepy,
209	            """<a href="qlkwje 1lk23j123123" />
210	            <a href="http://bb.org/download/py-1.0.zip" />""")
211	        assert len(result.releaselinks) == 1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
214	        result = parse_index(self.simplepy,
215	            """<a href="../../pkg/py-1.4.12.zip#md5=12ab">qwe</a>
216	               <a href="http://pylib.org" rel="homepage">whatever</a>
217	               <a href="http://pylib2.org" rel="download">whatever2</a>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	        assert len(result.releaselinks) == 1
220	        result.parse_index(URL("http://pylib.org"), """
221	               <a href="http://pylib.org/py-1.1-py27.egg" />

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	        assert len(result.releaselinks) == 1
220	        result.parse_index(URL("http://pylib.org"), """
221	               <a href="http://pylib.org/py-1.1-py27.egg" />

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
225	        links = list(result.releaselinks)
226	        assert links[0].url == "https://pypi.org/pkg/py-1.4.12.zip#md5=12ab"
227	        assert links[1].url == "http://pylib.org/py-1.1-py27.egg"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
226	        assert links[0].url == "https://pypi.org/pkg/py-1.4.12.zip#md5=12ab"
227	        assert links[1].url == "http://pylib.org/py-1.1-py27.egg"
228	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
239	        result = parse_index(self.simplepy,
240	            """<a href="../../pkg/py-1.4.12.zip#md5=12ab">qwe</a>
241	               <a href="../../pkg/py-1.4.11.zip">qwe</a>
242	               <a href="../../pkg/py-1.4.10.zip#md5=2222">qwe</a>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	        assert len(result.releaselinks) == 3
247	        result.parse_index(URL("http://pylib.org"), """
248	               <a href="http://pylib.org/py-1.4.12.zip" />

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	        assert len(result.releaselinks) == 3
247	        result.parse_index(URL("http://pylib.org"), """
248	               <a href="http://pylib.org/py-1.4.12.zip" />

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	        link1, link2, link3 = result.releaselinks
254	        assert link1.url == "https://pypi.org/pkg/py-1.4.12.zip#md5=12ab"
255	        assert link2.url == "http://pylib.org/py-1.4.11.zip#md5=1111"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
254	        assert link1.url == "https://pypi.org/pkg/py-1.4.12.zip#md5=12ab"
255	        assert link2.url == "http://pylib.org/py-1.4.11.zip#md5=1111"
256	        assert link3.url == "https://pypi.org/pkg/py-1.4.10.zip#md5=2222"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
255	        assert link2.url == "http://pylib.org/py-1.4.11.zip#md5=1111"
256	        assert link3.url == "https://pypi.org/pkg/py-1.4.10.zip#md5=2222"
257	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	            content_type="application/vnd.pypi.simple.v1+json",
271	            text="""{
272	                "meta": {"api-version": "1.0"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
291	            content_type="application/vnd.pypi.simple.v1+json",
292	            text="""{
293	                "meta": {"api-version": "1.0"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
313	            content_type="application/vnd.pypi.simple.v1+json",
314	            text="""{
315	                "meta": {"api-version": "1.0"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
334	        assert link.version == "1.0"
335	        assert link.entry.url == "https://pypi.org/pytest/pytest-1.0.zip"
336	        assert not link.hash_spec

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
367	        md5 = getmd5("123")
368	        pypistage.mock_simple("pytest", text='''
369	                <a href="../../pkg/pytest-1.0.zip#md5={md5}" />

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
375	        assert len(links) == 1
376	        assert links[0].entry.url == "https://pypi.org/pkg/pytest-1.0.zip"
377	        assert links[0].entrypath.endswith("/pytest-1.0.zip")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
386	        hashdir_b = getmd5("456")
387	        pypistage.mock_simple("pytest", text='''
388	                <a href="../../pkg/pytest-1.0.1.zip#md5={hashdir_b}" />

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
393	        assert len(links) == 2
394	        assert links[0].entry.url == "https://pypi.org/pkg/pytest-1.0.1.zip"
395	        assert links[0].entrypath.endswith("/pytest-1.0.1.zip")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
395	        assert links[0].entrypath.endswith("/pytest-1.0.1.zip")
396	        assert links[1].entry.url == "https://pypi.org/pkg/pytest-1.0.zip"
397	        assert links[1].entrypath.endswith("/pytest-1.0.zip")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
399	    def test_parse_and_scrape_non_html_ignored(self, pypistage):
400	        pypistage.mock_simple("pytest", text='''
401	                <a href="../../pkg/pytest-1.0.zip#md5={md5}" />
402	                <a rel="download" href="https://download.com/index.html" />
403	            ''', pypiserial=20)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
403	            ''', pypiserial=20)
404	        pypistage.url2response["https://download.com/index.html"] = dict(
405	            status_code=200, text = '''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
439	    def test_get_releaselinks_cache_refresh_on_lower_serial(self, pypistage, caplog):
440	        pypistage.mock_simple("pytest", text='''
441	                <a href="../../pkg/pytest-1.0.zip#md5={md5}" />
442	                <a rel="download" href="https://download.com/index.html" />
443	            ''', pypiserial=10)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
452	    def test_get_releaselinks_cache_no_fresh_write(self, pypistage):
453	        pypistage.mock_simple("pytest", text='''
454	                <a href="../../pkg/pytest-1.0.zip#md5={md5}" />
455	                <a rel="download" href="https://download.com/index.html" />
456	            ''', pypiserial=10)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
473	    def test_parse_and_scrape_error(self, pypistage, errorcode):
474	        pypistage.mock_simple("pytest", text='''
475	                <a href="../../pkg/pytest-1.0.zip#md5={md5}" />

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
477	            ''')
478	        pypistage.url2response["https://download.com/index.html"] = dict(
479	            status_code=errorcode, text = 'not found')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
482	        assert links[0].entry.url == \
483	                "https://pypi.org/pkg/pytest-1.0.zip"
484	
485	    def test_parse_with_outdated_links_issue165(self, pypistage, caplog):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
497	    def test_basic_auth_mirror(self, pypistage):
498	        pypistage.ixconfig["mirror_url"] = "https://foo:bar@example.com/simple/"
499	        pypistage.xom.httpget.mockresponse(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
499	        pypistage.xom.httpget.mockresponse(
500	            pypistage.mirror_url_without_auth, code=200, text="""
501	            <html><head><title>Simple Index</title>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
517	            code=200,
518	            url="https://pypi.org/simple/hello-world/")
519	        l = pypistage.get_releaselinks("Hello_World")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
561	        simpypi.add_file('/pkg/pkg-0.5.zip', content)
562	        r = testapp.xget(200, '/root/pypi/+simple/pkg/')
563	        (link0, link1) = getlinks(r.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
564	        assert link0.text == 'pkg-1.0.zip'
565	        assert link0.get('data-requires-python') is None
566	        assert link1.text == 'pkg-0.5.zip'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
566	        assert link1.text == 'pkg-0.5.zip'
567	        assert link1.get('data-requires-python') == '<3'
568	        testapp.xget(200, link1['href'].replace('../../', '/root/pypi/'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
567	        assert link1.get('data-requires-python') == '<3'
568	        testapp.xget(200, link1['href'].replace('../../', '/root/pypi/'))
569	        # turn on offline mode for test

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
570	        xom.config.args.offline_mode = True
571	        r = testapp.get('/root/pypi/+simple/pkg/')
572	        (link,) = getlinks(r.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
573	        assert link.text == 'pkg-0.5.zip'
574	        assert link.get('data-requires-python') == '<3'
575	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
586	        simpypi.add_file('/pkg/pkg-0.5.zip', content)
587	        r = testapp.xget(200, '/root/pypi/+simple/pkg/')
588	        (link0, link1) = getlinks(r.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
589	        assert link0.text == 'pkg-1.0.zip'
590	        assert link0.get('data-yanked') is None
591	        assert link1.text == 'pkg-0.5.zip'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
591	        assert link1.text == 'pkg-0.5.zip'
592	        assert link1.get('data-yanked') == ""
593	        testapp.xget(200, link1['href'].replace('../../', '/root/pypi/'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
592	        assert link1.get('data-yanked') == ""
593	        testapp.xget(200, link1['href'].replace('../../', '/root/pypi/'))
594	        # turn on offline mode for test

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
595	        xom.config.args.offline_mode = True
596	        r = testapp.get('/root/pypi/+simple/pkg/')
597	        (link,) = getlinks(r.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
598	        assert link.text == 'pkg-0.5.zip'
599	        assert link.get('data-yanked') == ""
600	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
634	        pypistage.mock_simple("foo", text='<a href="foo-1.0.tar.gz"</a>')
635	        r = testapp.xget(200, '/root/pypi/+simple/foo/')
636	        assert 'Cache-Control' not in r.headers

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
639	        pypistage.mock_simple("foo", status_code=502)
640	        r = testapp.xget(200, '/root/pypi/+simple/foo/')
641	        assert 'max-age=0' in r.headers['Cache-Control']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
648	        pypistage.mock_simple("foo", text='<a href="foo-1.0.tar.gz"</a>')
649	        r = testapp.xget(200, f'{api.index}/+simple/foo/')
650	        assert 'Cache-Control' not in r.headers

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
653	        pypistage.mock_simple("foo", status_code=502)
654	        r = testapp.xget(200, f'{api.index}/+simple/foo/')
655	        assert 'max-age=0' in r.headers['Cache-Control']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
803	        pypistage.mock_simple("proj2", pkgver="proj2-1.0.zip")
804	        pypistage.url2response["https://pypi.org/simple/proj3/"] = dict(
805	            status_code=404)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
842	            await asyncio.sleep(0.2)
843	            return await orig_async_httpget(*args, **kw)
844	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
898	        assert kind.lower() == "basic"
899	        assert base64.b64decode(data) == b"foo:bar"
900	        simpypi.clear_requests()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:899
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
898	        assert kind.lower() == "basic"
899	        assert base64.b64decode(data) == b"foo:bar"
900	        simpypi.clear_requests()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
901	        assert not simpypi.requests
902	        r = testapp.xget(200, f"/{link.href}")
903	        assert r.body == content

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:907
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
906	        assert kind.lower() == "basic"
907	        assert base64.b64decode(data) == b"foo:bar"
908	        msgs = [x.getMessage() for x in caplog.getrecords()]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:907
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
906	        assert kind.lower() == "basic"
907	        assert base64.b64decode(data) == b"foo:bar"
908	        msgs = [x.getMessage() for x in caplog.getrecords()]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
939	        assert kind.lower() == "basic"
940	        assert base64.b64decode(data) == b"foo:bar"
941	        simpypi.clear_requests()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:940
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
939	        assert kind.lower() == "basic"
940	        assert base64.b64decode(data) == b"foo:bar"
941	        simpypi.clear_requests()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
942	        assert not simpypi.requests
943	        r = testapp.xget(200, f"/{link.href}")
944	        assert r.body == content

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:948
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
947	        assert kind.lower() == "basic"
948	        assert base64.b64decode(data) == b"foo:bar"
949	        msgs = [x.getMessage() for x in caplog.getrecords()]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:948
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
947	        assert kind.lower() == "basic"
948	        assert base64.b64decode(data) == b"foo:bar"
949	        msgs = [x.getMessage() for x in caplog.getrecords()]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:958
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
957	    def test_auth_mirror_url_hidden_in_logs(self, caplog, pypistage):
958	        pypistage.ixconfig["mirror_url"] = "https://foo:bar@example.com/simple/"
959	        pypistage.get_releaselinks("pkg")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
964	    def test_auth_mirror_url_user_only(self, caplog, pypistage):
965	        pypistage.ixconfig["mirror_url"] = "https://foo@example.com/simple/"
966	        pypistage.get_releaselinks("pkg")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:971
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
970	    def test_auth_mirror_url_password_only(self, caplog, pypistage):
971	        pypistage.ixconfig["mirror_url"] = "https://:bar@example.com/simple/"
972	        pypistage.get_releaselinks("pkg")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
990	        mapp = makemapp(testapp)
991	        httpget.add('https://pypi.org/simple/', status_code=401, headers={
992	            'WWW-Authenticate': 'Basic realm=pypi'})
993	        httpget.add('https://pypi.org/simple/', text='')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
992	            'WWW-Authenticate': 'Basic realm=pypi'})
993	        httpget.add('https://pypi.org/simple/', text='')
994	        mapp.getpkglist(indexname="root/pypi")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1033	    monkeypatch.setattr(xom._httpsession, "get", httpget)
1034	    r = xom.httpget("http://notexists.qwe", allow_redirects=False,
1035	                              timeout=1.2)
1036	    assert r.status_code == -1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1034
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1033	    monkeypatch.setattr(xom._httpsession, "get", httpget)
1034	    r = xom.httpget("http://notexists.qwe", allow_redirects=False,
1035	                              timeout=1.2)
1036	    assert r.status_code == -1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1047	    monkeypatch.setattr(xom._httpsession, "get", httpget)
1048	    r = xom.httpget("http://notexists.qwe", allow_redirects=False)
1049	    assert r.status_code == -1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1047	    monkeypatch.setattr(xom._httpsession, "get", httpget)
1048	    r = xom.httpget("http://notexists.qwe", allow_redirects=False)
1049	    assert r.status_code == -1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1063
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1062	    monkeypatch.setattr(httpx.AsyncClient, "get", async_httpget)
1063	    r = await xom.async_httpget("http://notexists.qwe", allow_redirects=False)
1064	    assert r.status_code == -1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1063
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1062	    monkeypatch.setattr(httpx.AsyncClient, "get", async_httpget)
1063	    r = await xom.async_httpget("http://notexists.qwe", allow_redirects=False)
1064	    assert r.status_code == -1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1166	    def test_get_set(self, cache):
1167	        assert cache.get() == dict()
1168	        s = {1: 1, 2: 2, 3: 3}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1170	        s[4] = 4
1171	        assert cache.get() == s
1172	        cache.add('Foo')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1172	        cache.add('Foo')
1173	        assert 'foo' in cache.get()
1174	        cache.discard('foo')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1174	        cache.discard('foo')
1175	        assert 'foo' not in cache.get()
1176	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_mirror.py:1186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1185	        assert cache.is_expired(expiry_time)
1186	        assert cache.get() == s
1187	        assert cache.get_etag() == '"foo"'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_model.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
140	    mapp.xom.httpget.mockresponse(
141	        "https://pypi.org/simple/", text='<a href="pkg1"></a>')
142	    mapp.xom.httpget.mock_simple("pkg1", text="")
143	    mapp.get_simple("pkg1")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_model.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
623	        mirror1 = user.create_stage("mirror1", **udict(
624	            mirror_url="http://pypi.org/simple", type="mirror"))
625	        mirror2 = user.create_stage("mirror2", **udict(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_model.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
625	        mirror2 = user.create_stage("mirror2", **udict(
626	            mirror_url="http://example.com/simple", type="mirror"))
627	        httpget.mockresponse(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_model.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
627	        httpget.mockresponse(
628	            "http://pypi.org/simple/", text='<a href="someproject"></a>')
629	        httpget.mock_simple(
630	            "someproject", "<a href='someproject-1.1.zip' /a>",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_model.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
632	        httpget.mockresponse(
633	            "http://example.com/simple/", text='<a href="someproject"></a>')
634	        httpget.mock_simple(
635	            "someproject", "<a href='someproject-1.1-py2.py3-none-any.whl' /a>",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_model.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
703	        mirror1 = user.create_stage("mirror1", **udict(
704	            mirror_url="http://pypi.org/simple", type="mirror"))
705	        mirror2 = user.create_stage("mirror2", **udict(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_model.py:706
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
705	        mirror2 = user.create_stage("mirror2", **udict(
706	            mirror_url="http://example.com/simple", type="mirror"))
707	        httpget.mockresponse(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_model.py:708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
707	        httpget.mockresponse(
708	            "http://pypi.org/simple/", text='<a href="someproject"></a>')
709	        httpget.mock_simple(
710	            "someproject", "<a href='someproject-1.1.zip' /a>",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_model.py:713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
712	        httpget.mockresponse(
713	            "http://example.com/simple/", text='<a href="someproject"></a>')
714	        httpget.mock_simple(
715	            "someproject", "<a href='someproject-1.1-py2.py3-none-any.whl' /a>",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_nginx.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	        {"Host": "outside3.com"}, "",
36	        "http://outside3.com"),
37	    (
38	        {"Host": "outside3.com:3141"}, "",
39	        "http://outside3.com:3141")])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_nginx.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	        {"Host": "outside3.com:3141"}, "",
39	        "http://outside3.com:3141")])
40	def test_outside_url_nginx(headers, path, expected, nginx_host_port):
41	    (host, port) = nginx_host_port
42	    headers = dict((str(k), str(v)) for k, v in headers.items())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_nginx.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	        r = fetch(f'http://{host}:{port}/+api')
64	        assert r.json['result']['login'] == "http://outside.com/+login"
65	        r = fetch(f'http://{host}:{port}')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_nginx.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	        r = fetch(f'http://{host}:{port}/+api')
86	        assert r.json['result']['login'] == "http://outside.com/foo/+login"
87	        r = fetch(f'http://{host}:{port}/foo')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_nginx.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        if r.status == 302:
93	            assert r.headers['location'] == 'http://outside.com/foo'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_nginx_replica.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    app = makemapp(options=[
12	        '--primary-url', 'http://%s:%s' % nginx_host_port,
13	        '--secretfile', secretfile])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    replica_uuid = "111"
47	    replica_url = "http://qwe"
48	
49	    @pytest.fixture(params=[False, True])
50	    def reqchangelog(self, request, auth_serializer, testapp):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
93	        mapp.create_user("this", password="p")
94	        req = blank_request()
95	        req.registry = {"xom": xom}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	    replica_uuid = "111"
124	    replica_url = "http://qwe"
125	
126	    @pytest.fixture
127	    def reqchangelogs(self, auth_serializer, testapp):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
178	    def rt(self, makexom):
179	        xom = makexom(["--primary-url=http://localhost"])
180	        return xom.replica_thread

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
194	                del headers["x-devpi-serial"]
195	            url = "http://localhost/+changelog/%s" % num
196	            if num == 0:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
220	        # get the result
221	        orig_req = reqmock.url2reply[("http://localhost/+changelog/0?initial_fetch", None)]
222	        # setup so the first attempt fails, then the second succeeds

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
235	            rt.thread_run()
236	        msgs = [x.msg for x in caplog.getrecords(r".*http://localhost/\+changelog/0")]
237	        assert msgs == [

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
362	    from devpi_server.replica import clean_request_headers
363	    request = blank_request()
364	    request.headers['Foo'] = 'bar'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
387	    def test_write_proxies(self, makexom, blank_request, reqmock, monkeypatch):
388	        xom = makexom(["--primary-url", "http://localhost"])
389	        reqmock.mock("http://localhost/blankpath",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
388	        xom = makexom(["--primary-url", "http://localhost"])
389	        reqmock.mock("http://localhost/blankpath",
390	                     code=200, headers={"X-DEVPI-SERIAL": "10"})
391	        l = []

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
393	                            lambda x: l.append(x))
394	        request = blank_request(method="PUT")
395	        request.registry = dict(xom=xom)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
402	    def test_preserve_reason(self, makexom, blank_request, reqmock, monkeypatch):
403	        xom = makexom(["--primary-url", "http://localhost"])
404	        reqmock.mock("http://localhost/blankpath",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
403	        xom = makexom(["--primary-url", "http://localhost"])
404	        reqmock.mock("http://localhost/blankpath",
405	                     code=200, reason="GOOD", headers={"X-DEVPI-SERIAL": "10"})
406	        l = []

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
408	                            lambda x: l.append(x))
409	        request = blank_request(method="PUT")
410	        request.registry = dict(xom=xom)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
416	    def test_write_proxies_redirect(self, makexom, blank_request, reqmock, monkeypatch):
417	        xom = makexom(["--primary-url", "http://localhost",
418	                       "--outside-url=http://my.domain"])
419	        reqmock.mock("http://localhost/blankpath",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
417	        xom = makexom(["--primary-url", "http://localhost",
418	                       "--outside-url=http://my.domain"])
419	        reqmock.mock("http://localhost/blankpath",
420	                     code=302, headers={"X-DEVPI-SERIAL": "10",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
418	                       "--outside-url=http://my.domain"])
419	        reqmock.mock("http://localhost/blankpath",
420	                     code=302, headers={"X-DEVPI-SERIAL": "10",
421	                                        "location": "http://localhost/hello"})
422	        l = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
420	                     code=302, headers={"X-DEVPI-SERIAL": "10",
421	                                        "location": "http://localhost/hello"})
422	        l = []
423	        monkeypatch.setattr(xom.keyfs, "wait_tx_serial",

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
426	        # not the case here, we have to set the host explicitly
427	        request = blank_request(method="PUT", headers=dict(host='my.domain'))
428	        request.registry = dict(xom=xom)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
432	        assert response.headers.get("X-DEVPI-SERIAL") == "10"
433	        assert response.headers.get("location") == "http://my.domain/hello"
434	        assert l == [10]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
436	    def test_hop_headers(self, makexom, blank_request, reqmock, monkeypatch):
437	        xom = makexom(["--primary-url", "http://localhost"])
438	        reqmock.mock(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
438	        reqmock.mock(
439	            "http://localhost/blankpath",
440	            code=200, headers={
441	                "Connection": "Keep-Alive, Foo",
442	                "Foo": "abc",
443	                "Keep-Alive": "timeout=30",
444	                "X-DEVPI-SERIAL": "0"})
445	        monkeypatch.setattr(xom.keyfs, "wait_tx_serial",
446	                            lambda x: x)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
446	                            lambda x: x)
447	        request = blank_request(method="PUT")
448	        request.registry = dict(xom=xom)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
489	        replica_xom = makexom([
490	            "--primary-url", "http://localhost",
491	            "--file-replication-threads", "1",
492	            "--secretfile", secretfile] + list(options))
493	        # shorten error delay for tests
494	        replica_xom.replica_thread.shared_data.ERROR_QUEUE_MAX_DELAY = 0.1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
609	        frt_reqmock = patch_reqsessionmock(frthread.session)
610	        frt_reqmock.mockresponse("http://localhost" + path, 200, data=content1)
611	        # now sync the replica, if the file is not found there will be an error

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
649	        frt_reqmock = patch_reqsessionmock(frthread.session)
650	        frt_reqmock.mockresponse("http://localhost" + path, 200, data=content1)
651	        # now sync the replica, if the file is not found there will be an error

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
956	    # now check
957	    pypiurls.simple = 'http://localhost:3111/root/pypi/+simple/'
958	    serial = xom.keyfs.get_current_serial()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:961
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
960	        'pytest',
961	        text='<a href="https://pypi.org/pytest/pytest-1.0.zip">pytest-1.0.zip</a>',
962	        headers={'X-DEVPI-SERIAL': str(serial)})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1004	    monkeypatch.setattr(replica_xom.keyfs, 'wait_tx_serial', wait_tx_serial)
1005	    pypiurls.simple = 'http://localhost:3111/root/pypi/+simple/'
1006	    pypistage.mock_simple(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:1008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1007	        'pytest',
1008	        text='<a href="https://pypi.org/pkg/pytest-1.1.zip">pytest-1.1.zip</a>',
1009	        pypiserial=10001,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:1053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1052	    from devpi_server.mythread import Shutdown
1053	    replica_xom = makexom(opts=["--primary-url=http://foo:pass@localhost"])
1054	    assert replica_xom.config.primary_auth == ("foo", "pass")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:1055
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1054	    assert replica_xom.config.primary_auth == ("foo", "pass")
1055	    assert replica_xom.config.primary_url.url == "http://localhost"
1056	    replica_xom.create_app()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:1071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1070	def test_primary_url_auth_with_port(makexom):
1071	    replica_xom = makexom(opts=["--primary-url=http://foo:pass@localhost:3140"])
1072	    assert replica_xom.config.primary_auth == ("foo", "pass")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1072	    assert replica_xom.config.primary_auth == ("foo", "pass")
1073	    assert replica_xom.config.primary_url.url == "http://localhost:3140"
1074	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_replica_functional.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    app = makemapp(options=[
12	        '--primary-url', 'http://%s:%s' % primary_host_port,
13	        '--secretfile', secretfile])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	def test_req(reqmock, method):
7	    mr = reqmock.mockresponse("http://heise.de/", 201, data="hello",
8	                         method=method,
9	                         headers={"content-type": "text/plain"})
10	    r = requests.request(method or "GET", "http://heise.de")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
9	                         headers={"content-type": "text/plain"})
10	    r = requests.request(method or "GET", "http://heise.de")
11	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	                         headers={"content-type": "text/plain"})
10	    r = requests.request(method or "GET", "http://heise.de")
11	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	def test_req_diff(reqmock):
17	    mr = reqmock.mockresponse("http://heise.de/", 201, data="hello",
18	                         method="GET",
19	                         headers={"content-type": "text/plain"})
20	    mr2 = reqmock.mockresponse("http://heise.de/", 200, data="world",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	                         headers={"content-type": "text/plain"})
20	    mr2 = reqmock.mockresponse("http://heise.de/", 200, data="world",
21	                         method="POST",
22	                         headers={"content-type": "text/plain"})
23	    r = requests.request("GET", "http://heise.de")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
22	                         headers={"content-type": "text/plain"})
23	    r = requests.request("GET", "http://heise.de")
24	    assert r.content == b"hello"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	                         headers={"content-type": "text/plain"})
23	    r = requests.request("GET", "http://heise.de")
24	    assert r.content == b"hello"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
25	    assert r.status_code == 201
26	    r = requests.request("POST", "http://heise.de")
27	    assert r.content == b"world"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    assert r.status_code == 201
26	    r = requests.request("POST", "http://heise.de")
27	    assert r.content == b"world"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    l = []
35	    mr = reqmock.mockresponse("http://heise.de/", 201, data="hello",
36	                         method="GET", on_request=lambda x: l.append(x),
37	                         headers={"content-type": "text/plain"})
38	    r = requests.get("http://heise.de/")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	                         headers={"content-type": "text/plain"})
38	    r = requests.get("http://heise.de/")
39	    assert l == mr.requests

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	                         headers={"content-type": "text/plain"})
38	    r = requests.get("http://heise.de/")
39	    assert l == mr.requests

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	def test_req_glob(reqmock):
44	    mr = reqmock.mockresponse("http://heise.de*", 201, data="hello",
45	                         headers={"content-type": "text/plain"})
46	    r = requests.get("http://heise.de/index.html")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	                         headers={"content-type": "text/plain"})
46	    r = requests.get("http://heise.de/index.html")
47	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	                         headers={"content-type": "text/plain"})
46	    r = requests.get("http://heise.de/index.html")
47	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_reqmock.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	    assert r.status_code == 201
48	    assert mr.requests[0].url == "http://heise.de/index.html"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_stage_customizer.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	        200, '/+authcheck',
282	        headers=ResponseHeaders({'X-Original-URI': 'http://localhost' + path}))
283	    # and push should work

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_stage_customizer.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
294	        200, '/+authcheck',
295	        headers=ResponseHeaders({'X-Original-URI': 'http://localhost' + path}))
296	    # and push should work

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_stage_customizer.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
313	        200, '/+authcheck',
314	        headers=ResponseHeaders({'X-Original-URI': 'http://localhost' + path}))
315	    # and push

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_stage_customizer.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
323	        403, '/+authcheck',
324	        headers=ResponseHeaders({'X-Original-URI': 'http://localhost' + path}))
325	    # and push should be forbidden as well

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_stage_customizer.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
359	            result = None
360	            request = get_current_request()
361	            if not request.has_permission("pkg_read", base_stage):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_stage_customizer.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
392	        (
393	            'http://localhost/someuser/dev/+simple/package/',
394	            'someuser/dev',
395	            'root/pypi',
396	            None),
397	        (
398	            'http://localhost/someuser/dev/+simple/package/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_stage_customizer.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
397	        (
398	            'http://localhost/someuser/dev/+simple/package/',
399	            'someuser/dev',
400	            'root/pypi',
401	            None)]
402	    plugin.calls.clear()
403	    api2 = mapp.create_and_use(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_stage_customizer.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
412	        (
413	            'http://localhost/otheruser/dev/+simple/package/',
414	            'otheruser/dev',
415	            'someuser/dev',
416	            True),
417	        (
418	            'http://localhost/otheruser/dev/+simple/package/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_stage_customizer.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
417	        (
418	            'http://localhost/otheruser/dev/+simple/package/',
419	            'otheruser/dev',
420	            'someuser/dev',
421	            True)]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    s.headers = {'Accept': 'application/json', 'Content-Type': 'application/json'}
25	    url = 'http://%s:%s/' % host_port
26	    r = s.post(url + '+login', json.dumps({'user': 'root', 'password': ''})).json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
25	    url = 'http://%s:%s/' % host_port
26	    r = s.post(url + '+login', json.dumps({'user': 'root', 'password': ''})).json()
27	    auth = '%s:%s' % ('root', r['result']['password'])

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
27	    auth = '%s:%s' % ('root', r['result']['password'])
28	    s.headers['X-Devpi-Auth'] = base64.b64encode(auth.encode('utf-8'))
29	    existing = s.get(url).json()['result']

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
27	    auth = '%s:%s' % ('root', r['result']['password'])
28	    s.headers['X-Devpi-Auth'] = base64.b64encode(auth.encode('utf-8'))
29	    existing = s.get(url).json()['result']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	    s.headers['X-Devpi-Auth'] = base64.b64encode(auth.encode('utf-8'))
29	    existing = s.get(url).json()['result']
30	    if 'mirror' not in existing['root']['indexes']:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	        from time import sleep
63	        if "storage_with_filesystem" not in storage_info.get('_test_markers', []):
64	            pytest.skip("The storage doesn't have marker 'storage_with_filesystem'.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	            f"/{pkg_name}/{pkgzip}", content, stream=True, length=length)
71	        with contextlib.closing(s.get(url + f"root/mirror/{pkg_name}")) as r:
72	            r = r.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	        href = r['result'][pkg_version]['+links'][0]['href']
75	        r = requests.get(href, stream=True)
76	        with contextlib.closing(r):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	        from requests.exceptions import ChunkedEncodingError
101	        if "storage_with_filesystem" not in storage_info.get('_test_markers', []):
102	            pytest.skip("The storage doesn't have marker 'storage_with_filesystem'.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	            f"/{pkg_name}/{pkgzip}", content, stream=True, length=length)
110	        with contextlib.closing(s.get(url + f"root/mirror/{pkg_name}")) as r:
111	            r = r.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_streaming.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	        href = r['result'][pkg_version]['+links'][0]['href']
114	        r = requests.get(href, stream=True)
115	        with contextlib.closing(r):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	    assert "html" in r.headers['content-type']
148	    assert not parse_index("http://localhost", r.text).releaselinks
149	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
240	
241	@pytest.mark.parametrize("outside_url", ['', 'http://localhost/devpi'])
242	def test_simple_project_outside_url_subpath(mapp, outside_url, pypistage, testapp):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
276	    assert links == [
277	        'http://localhost/root/pypi/+e/https_pypi.org/qpwoei-1.0.zip',
278	        'http://localhost/user1/dev/+f/%s/qpwoei-1.0.tar.gz#%s' % (hashdir, hash_spec)]
279	    testapp.xget(200, links[1], headers=headers)
280	    # we also test in combination with X-outside-url where devpi is "mounted"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
277	        'http://localhost/root/pypi/+e/https_pypi.org/qpwoei-1.0.zip',
278	        'http://localhost/user1/dev/+f/%s/qpwoei-1.0.tar.gz#%s' % (hashdir, hash_spec)]
279	    testapp.xget(200, links[1], headers=headers)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	    # in a sub path
282	    headers.update({'X-outside-url': "http://localhost/devpi"})
283	    r = testapp.get("/%s/+simple/qpwoei/" % api.stagename, headers=headers)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
289	    assert links == [
290	        'http://localhost/devpi/root/pypi/+e/https_pypi.org/qpwoei-1.0.zip',
291	        'http://localhost/devpi/user1/dev/+f/%s/qpwoei-1.0.tar.gz#%s' % (hashdir, hash_spec)]
292	    # the internal url is always without the "devpi" part, as that is removed
293	    # by the webserver in front

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
290	        'http://localhost/devpi/root/pypi/+e/https_pypi.org/qpwoei-1.0.zip',
291	        'http://localhost/devpi/user1/dev/+f/%s/qpwoei-1.0.tar.gz#%s' % (hashdir, hash_spec)]
292	    # the internal url is always without the "devpi" part, as that is removed

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
294	    testapp.xget(
295	        200, links[1].replace("http://localhost/devpi", "http://localhost"),
296	        headers=headers)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
294	    testapp.xget(
295	        200, links[1].replace("http://localhost/devpi", "http://localhost"),
296	        headers=headers)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
548	    pypistage.mock_simple("py",
549	        """<a href="http://bb.org/download/py.zip#egg=py-dev" />""")
550	    r = testapp.get("/root/pypi/+simple/py/")
551	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
858	def test_apiconfig_with_outside_url(testapp):
859	    testapp.xom.config.args.outside_url = u = "http://outside.com"
860	    r = testapp.get_json("/root/pypi/+api")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:1242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1241	    basic_auth = '%s:%s' % (api.user, api.password)
1242	    basic_auth = b"Basic " + b64encode(basic_auth.encode("ascii"))
1243	    basic_auth = basic_auth.decode("ascii")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:1242
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1241	    basic_auth = '%s:%s' % (api.user, api.password)
1242	    basic_auth = b"Basic " + b64encode(basic_auth.encode("ascii"))
1243	    basic_auth = basic_auth.decode("ascii")

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:1268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1267	        {":action": "file_upload", "name": name, "version": version,
1268	         "content": Upload(basename, content)}, expect_errors=True)
1269	    assert r.status_int == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:1346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1345	    assert "error 502 getting" in r.json["message"]
1346	    assert "https://pypi.org/simple/hello/hello-1.0.tar.gz" in r.json["message"]
1347	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:1562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1561	
1562	@pytest.mark.parametrize("outside_url", ['', 'http://localhost/devpi'])
1563	def test_upload_and_push_with_toxresults(mapp, testapp, outside_url, tox_result_data):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:1719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1718	    assert plugin.results == [
1719	        ('http://localhost', 'user1/dev', 'pkg1', '2.6')]
1720	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2436	    (
2437	        {"X-outside-url": "http://outside.com"}, {}, "",
2438	        None, "http://outside.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2437	        {"X-outside-url": "http://outside.com"}, {}, "",
2438	        None, "http://outside.com"),
2439	    (
2440	        {"X-outside-url": "http://outside.com/foo"}, {}, "/foo",
2441	        None, "http://outside.com/foo"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2439	    (
2440	        {"X-outside-url": "http://outside.com/foo"}, {}, "/foo",
2441	        None, "http://outside.com/foo"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2440	        {"X-outside-url": "http://outside.com/foo"}, {}, "/foo",
2441	        None, "http://outside.com/foo"),
2442	    (
2443	        {"Host": "outside3.com"}, {}, "",
2444	        None, "http://outside3.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2443	        {"Host": "outside3.com"}, {}, "",
2444	        None, "http://outside3.com"),
2445	    (
2446	        {"Host": "outside3.com"}, {'wsgi.url_scheme': 'https'}, "",
2447	        None, "https://outside3.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2446	        {"Host": "outside3.com"}, {'wsgi.url_scheme': 'https'}, "",
2447	        None, "https://outside3.com"),
2448	    (
2449	        {"Host": "outside3.com:3141"}, {}, "",
2450	        None, "http://outside3.com:3141"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2449	        {"Host": "outside3.com:3141"}, {}, "",
2450	        None, "http://outside3.com:3141"),
2451	    (
2452	        {"Host": "outside3.com:3141"}, {'wsgi.url_scheme': 'https'}, "",
2453	        None, "https://outside3.com:3141"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2452	        {"Host": "outside3.com:3141"}, {'wsgi.url_scheme': 'https'}, "",
2453	        None, "https://outside3.com:3141"),
2454	    # x-outside-url header takes precedence over outside url option
2455	    (
2456	        {"X-outside-url": "http://outside.com"}, {}, "",
2457	        "http://outside2.com", "http://outside.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2455	    (
2456	        {"X-outside-url": "http://outside.com"}, {}, "",
2457	        "http://outside2.com", "http://outside.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2456	        {"X-outside-url": "http://outside.com"}, {}, "",
2457	        "http://outside2.com", "http://outside.com"),
2458	    (
2459	        {"X-outside-url": "http://outside.com"}, {}, "",
2460	        "http://outside2.com/foo", "http://outside.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2456	        {"X-outside-url": "http://outside.com"}, {}, "",
2457	        "http://outside2.com", "http://outside.com"),
2458	    (
2459	        {"X-outside-url": "http://outside.com"}, {}, "",
2460	        "http://outside2.com/foo", "http://outside.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2458	    (
2459	        {"X-outside-url": "http://outside.com"}, {}, "",
2460	        "http://outside2.com/foo", "http://outside.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2459	        {"X-outside-url": "http://outside.com"}, {}, "",
2460	        "http://outside2.com/foo", "http://outside.com"),
2461	    # outside url option takes precedence over host and environ
2462	    (
2463	        {"Host": "outside3.com"}, {}, "",
2464	        "http://out.com", "http://out.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2459	        {"X-outside-url": "http://outside.com"}, {}, "",
2460	        "http://outside2.com/foo", "http://outside.com"),
2461	    # outside url option takes precedence over host and environ
2462	    (
2463	        {"Host": "outside3.com"}, {}, "",
2464	        "http://out.com", "http://out.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2463	        {"Host": "outside3.com"}, {}, "",
2464	        "http://out.com", "http://out.com"),
2465	    (
2466	        {"Host": "outside3.com"}, {'wsgi.url_scheme': 'https'}, "",
2467	        "http://out.com", "http://out.com")])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2463	        {"Host": "outside3.com"}, {}, "",
2464	        "http://out.com", "http://out.com"),
2465	    (
2466	        {"Host": "outside3.com"}, {'wsgi.url_scheme': 'https'}, "",
2467	        "http://out.com", "http://out.com")])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2466	        {"Host": "outside3.com"}, {'wsgi.url_scheme': 'https'}, "",
2467	        "http://out.com", "http://out.com")])
2468	def test_outside_url_middleware(headers, environ, path, outsideurl, expected, testapp):
2469	    headers = dict((str(k), str(v)) for k, v in headers.items())
2470	    environ = dict((str(k), str(v)) for k, v in environ.items())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2466	        {"Host": "outside3.com"}, {'wsgi.url_scheme': 'https'}, "",
2467	        "http://out.com", "http://out.com")])
2468	def test_outside_url_middleware(headers, environ, path, outsideurl, expected, testapp):
2469	    headers = dict((str(k), str(v)) for k, v in headers.items())
2470	    environ = dict((str(k), str(v)) for k, v in environ.items())

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2573	        handler = tween_keyfs_transaction(wrapped_handler, {"xom": xom})
2574	        response = handler(blank_request())
2575	        assert response.headers.get("X-DEVPI-SERIAL") == str(cur_serial)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2585	        handler = tween_keyfs_transaction(wrapped_handler, {"xom": xom})
2586	        response = handler(blank_request(method="PUT"))
2587	        assert response.headers.get("X-DEVPI-SERIAL") == str(cur_serial + 1)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views.py:2599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2598	        handler = tween_keyfs_transaction(wrapped_handler, {"xom": xom})
2599	        response = handler(blank_request())
2600	        assert response.headers.get("X-DEVPI-SERIAL") == str(cur_serial + 1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_patch.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	        type='mirror',
81	        mirror_url='https://pypi.org/simple/'))
82	    r = testapp.get("/foo/dev")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_patch.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	    assert r.json['result'] == {
85	        'mirror_url': 'https://pypi.org/simple/',
86	        'projects': [],
87	        'type': 'mirror',
88	        'volatile': True}
89	    # set volatile
90	    r = testapp.patch_json("/foo/dev", ["volatile=False"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_patch.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	    assert r.json['result'] == {
92	        'mirror_url': 'https://pypi.org/simple/',
93	        'type': 'mirror',
94	        'volatile': False}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	
27	    r = testapp.xget(200, api.simpleindex + "pkg1/")
28	    a = getfirstlink(r.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	    a = getfirstlink(r.text)
29	    assert "pkg1-2.6.tgz" in a.get("href")
30	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	    # get root index page
32	    r = testapp.xget(200, api.index)
33	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    # push OK
35	    req = dict(name="pkg1", version="2.6", posturl="http://whatever.com/",
36	               username="user", password="password", register_project=True)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
38	    body = json.dumps(req).encode("utf-8")
39	    r = testapp.request(api.index, method="POST", body=body,
40	                        expect_errors=True)
41	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
56	    rec = reqmock.mockresponse(url=None, code=410, method="POST", data="msg")
57	    r = testapp.request(api.index, method="POST", body=body,
58	                        expect_errors=True)
59	    assert r.status_code == 502

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
67	    reqmock.mockresponse(url=None, code=500, method="POST")
68	    r = testapp.request(api.index, method="POST", body=body, expect_errors=True)
69	    assert r.status_code == 502

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	    mapp.upload_doc("pkg1.zip", zipcontent, "pkg1", "")
84	    req = dict(name="pkg1", version="2.6", posturl="http://whatever.com/",
85	               username="user", password="password", no_docs=True)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
87	    body = json.dumps(req).encode()
88	    r = testapp.request(api.index, method="POST", body=body)
89	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	    mapp.upload_doc("pkg1.zip", zipcontent, "pkg1", "")
101	    req = dict(name="pkg1", version="2.6", posturl="http://whatever.com/",
102	               username="user", password="password", only_docs=True)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
104	    body = json.dumps(req).encode()
105	    r = testapp.request(api.index, method="POST", body=body)
106	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	    # first test should fail during register
126	    req = dict(name="pkg1", version="2.6", posturl="http://whatever.com/",
127	               username="user", password="password", register_project=True)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
128	    body = json.dumps(req).encode("utf-8")
129	    r = testapp.request(api.index, method="POST", body=body,
130	                        expect_errors=True)
131	    assert r.status_code == 502

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
142	        reason="Project pre-registration is no longer required or supported, so continue directly to uploading files."))
143	    req = dict(name="pkg1", version="2.6", posturl="http://whatever.com/",
144	               username="user", password="password", register_project=True)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
145	    body = json.dumps(req).encode("utf-8")
146	    r = testapp.request(api.index, method="POST", body=body,
147	                        expect_errors=True)
148	    assert r.status_code == 502

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	    assert verdata['requires_python'] == ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*"
168	    req = dict(name="pkg1", version="2.6", posturl="http://whatever.com/",
169	               username="user", password="password")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
171	    body = json.dumps(req).encode("utf-8")
172	    r = testapp.request(api.index, method="POST", body=body,
173	                        expect_errors=True)
174	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	    assert verdata['description_content_type'] == "text/plain"
196	    req = dict(name="pkg1", version="2.6", posturl="http://whatever.com/",
197	               username="user", password="password")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
199	    body = json.dumps(req).encode("utf-8")
200	    r = testapp.request(api.index, method="POST", body=body,
201	                        expect_errors=True)
202	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	
223	    r = testapp.xget(200, api.simpleindex + "pkg1/")
224	    a = getfirstlink(r.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
224	    a = getfirstlink(r.text)
225	    assert "pkg1-2.6.tgz" in a.get("href")
226	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	    # get root index page
228	    r = testapp.xget(200, api.index)
229	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	    # push OK
254	    req = dict(name="pkg1", version="2.6", posturl="http://whatever.com/",
255	               username="user", password="password", register_project=True)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
256	    body = json.dumps(req).encode("utf-8")
257	    r = testapp.request(api.index, method="POST", body=body,
258	                        expect_errors=True)
259	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	    mapp.upload_file_pypi("pkg2-1.0-py27.egg", b"123", "pkg2", "1.0")
277	    r = testapp.xget(200, api.simpleindex + "pkg2/")
278	    a = getfirstlink(r.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
278	    a = getfirstlink(r.text)
279	    assert "pkg2-1.0-py27.egg" in a.get("href")
280	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_push_external.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	    # push
282	    req = dict(name="pkg2", version="1.0", posturl="http://whatever.com/",
283	               username="user", password="password")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_status.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	        now = time.time()
149	        xom = makexom(["--primary-url=http://localhost"])
150	        request = self._xomrequest(xom)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_status.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	        now = time.time()
176	        xom = makexom(["--primary-url=http://localhost"])
177	        request = self._xomrequest(xom)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/devpi_server-6.14.0-py3-none-any/test_devpi_server/test_views_status.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
226	        now = time.time()
227	        xom = makexom(["--primary=http://localhost"])
228	        request = self._xomrequest(xom)

--------------------------------------------------

Code scanned:
	Total lines of code: 24833
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 225.0
		High: 287.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 498.0
		High: 14.0
Files skipped (0):
