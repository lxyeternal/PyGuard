Run started:2025-04-13 06:59:03.138515

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/python/deptry/cli.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	    type=COMMA_SEPARATED_TUPLE,
140	    help="""A comma-separated list of error codes to ignore. e.g. `deptry --ignore DEP001,DEP002`
141	    For more information regarding the error codes, see https://deptry.com/issue-codes/""",
142	    default=(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/python/deptry/cli.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	    type=COMMA_SEPARATED_MAPPING,
148	    help="""A comma-separated mapping of packages or modules to be ignored per error code.
149	    . e.g. ``deptry . --per-rule-ignores DEP001=matplotlib,DEP002=pandas|numpy``
150	    For more information regarding the error codes, see https://deptry.com/issue-codes/""",
151	    default={},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/python/deptry/cli.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	    is_flag=True,
242	    help="Enable experimental support for namespace package (PEP 420) when detecting local modules (https://peps.python.org/pep-0420/).",
243	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/python/deptry/reporters/text.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	            )
45	            logging.info("\nFor more information, see the documentation: https://deptry.com/")
46	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/scripts/generate_stdlibs.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	OUTPUT_PATH = Path("python/deptry/stdlibs.py")
13	STDLIB_MODULES_URL = "https://docs.python.org/{}.{}/py-modindex.html"
14	
15	# Starting from Python 3.10, https://docs.python.org/3/library/sys.html#sys.stdlib_module_names is available.
16	PYTHON_VERSIONS = ((3, 9),)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/scripts/generate_stdlibs.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	DOCSTRING_GENERATED_FILES = """
22	DO NOT EDIT THIS FILE MANUALLY.
23	It is generated from `scripts/generate_stdlibs.py` script and contains the stdlib modules for Python versions that does
24	not support https://docs.python.org/3/library/sys.html#sys.stdlib_module_names (< 3.10).
25	The file can be generated again using `python scripts/generate_stdlibs.py`.
26	"""
27	
28	
29	class PythonStdlibHTMLParser(HTMLParser):

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/scripts/generate_stdlibs.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
48	def get_standard_library_modules_for_python_version(python_version: tuple[int, int]) -> list[str]:
49	    with urllib.request.urlopen(  # noqa: S310
50	        STDLIB_MODULES_URL.format(python_version[0], python_version[1])
51	    ) as response:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/functional/cli/test_cli.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
487	            "",
488	            "For more information, see the documentation: https://deptry.com/",
489	            "",
490	        ]
491	
492	        assert result.returncode == 1
493	        assert result.stderr == "\n".join(expected_output)
494	
495	
496	@pytest.mark.xdist_group(name=Project.EXAMPLE)
497	def test_cli_with_not_json_output(poetry_venv_factory: PoetryVenvFactory) -> None:
498	    with poetry_venv_factory(Project.EXAMPLE) as virtual_env:
499	        json_files_count = len(list(Path().glob("*.json")))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/functional/cli/test_cli.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
527	            "",
528	            "For more information, see the documentation: https://deptry.com/",
529	            "",
530	        ]
531	
532	        assert result.returncode == 1
533	        # Assert that we have the same number of JSON files as before running the command.
534	        assert len(list(Path().glob("*.json"))) == json_files_count
535	        assert result.stderr == "\n".join(expected_output)
536	
537	
538	@pytest.mark.xdist_group(name=Project.EXAMPLE)
539	def test_cli_with_json_output(poetry_venv_factory: PoetryVenvFactory) -> None:
540	    with poetry_venv_factory(Project.EXAMPLE) as virtual_env:
541	        issue_report = f"{uuid.uuid4()}.json"
542	        result = virtual_env.run(f"deptry . -o {issue_report}")
543	
544	        expected_output = [
545	            "Scanning 2 files...",
546	            "",
547	            stylize(
548	                "{BOLD}{file}{RESET}{CYAN}:{RESET} {BOLD}{RED}DEP002{RESET} 'isort' defined as a dependency but not"
549	                " used in the codebase",
550	                file=Path("pyproject.toml"),
551	            ),
552	            stylize(
553	                "{BOLD}{file}{RESET}{CYAN}:{RESET} {BOLD}{RED}DEP002{RESET} 'requests' defined as a dependency but"
554	                " not used in the codebase",
555	                file=Path("pyproject.toml"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/functional/cli/test_cli.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
568	            "",
569	            "For more information, see the documentation: https://deptry.com/",
570	            "",
571	        ]
572	
573	        # Assert that we still write to console when generating a JSON report.
574	        assert result.stderr == "\n".join(expected_output)
575	        assert get_issues_report(Path(issue_report)) == [
576	            {
577	                "error": {
578	                    "code": "DEP002",
579	                    "message": "'isort' defined as a dependency but not used in the codebase",
580	                },
581	                "module": "isort",
582	                "location": {
583	                    "file": str(Path("pyproject.toml")),
584	                    "line": None,
585	                    "column": None,
586	                },
587	            },
588	            {
589	                "error": {
590	                    "code": "DEP002",
591	                    "message": "'requests' defined as a dependency but not used in the codebase",
592	                },
593	                "module": "requests",
594	                "location": {
595	                    "file": str(Path("pyproject.toml")),
596	                    "line": None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/unit/dependency_getter/test_pdm.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	def test_dependency_getter(tmp_path: Path) -> None:
10	    fake_pyproject_toml = """\
11	[project]
12	# PEP 621 project metadata
13	# See https://www.python.org/dev/peps/pep-0621/
14	dependencies = [
15	    "qux",
16	    "bar>=20.9",
17	    "optional-foo[option]>=0.12.11",
18	    "conditional-bar>=1.1.0; python_version < '3.11'",
19	    "fox-python",  # top level module is called "fox"
20	]
21	
22	[dependency-groups]
23	dev-group = ["foo", "baz"]
24	all = [{include-group = "dev-group"}, "foobaz"]
25	
26	[tool.pdm.dev-dependencies]
27	test = [
28	    "qux",
29	    "bar; python_version < '3.11'"
30	]
31	tox = ["foo-bar"]
32	"""
33	
34	    with run_within_dir(tmp_path):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/unit/dependency_getter/test_poetry.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	def test_dependency_getter_pep_621(tmp_path: Path) -> None:
77	    fake_pyproject_toml = """
78	[project]
79	name = "foo"
80	requires-python = ">=3.7,<4.0"
81	dependencies = [
82	    "bar>=2.5.1,<4.0.0",
83	    "fox-python",
84	]
85	
86	[project.optional-dependencies]
87	an-extra = ["foobar>=2.5.1,<4.0.0"]
88	
89	[tool.poetry.dependencies]
90	fox-python = { git = "https://example.com/foo/bar.git", tag = "v1.2.3" }
91	# This dependency will not be used by Poetry nor extracted by deptry, as `[project.dependencies]` defines at least once
92	# dependency, and in this case, dependencies in `[tool.poetry.dependencies]` only enrich existing dependencies from
93	# `[project.dependencies]`, so deptry will completely skip `[tool.poetry.dependencies]`.
94	skipped-dependency = "1.2.3"
95	
96	[tool.poetry.dev-dependencies]
97	toml = "^0.10.2"
98	qux =  { version = ">=2.5.1,<4.0.0", optional = true }
99	
100	[tool.poetry.group.lint.dependencies]
101	black = "^22.6.0"
102	mypy = "^1.3.0"
103	
104	[tool.poetry.group.test.dependencies]
105	pytest = "^7.3.0"
106	pytest-cov = "^4.0.0"
107	"""
108	
109	    with run_within_dir(tmp_path):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/unit/dependency_getter/test_requirements_txt.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	def test_parse_requirements_files_urls(tmp_path: Path) -> None:
60	    fake_requirements_files = """urllib3 @ https://github.com/urllib3/urllib3/archive/refs/tags/1.26.8.zip
61	https://github.com/urllib3/urllib3/archive/refs/tags/1.26.8.zip
62	git+https://github.com/baz/foo-bar.git@asd#egg=foo-bar
63	git+https://github.com/baz/foo-bar.git@asd
64	git+https://github.com/abc123/bar-foo@xyz789#egg=bar-fooo
65	https://unsupported-specification.com"""
66	
67	    with run_within_dir(tmp_path):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/unit/dependency_getter/test_uv.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	def test_dependency_getter(tmp_path: Path) -> None:
10	    fake_pyproject_toml = """\
11	[project]
12	# PEP 621 project metadata
13	# See https://www.python.org/dev/peps/pep-0621/
14	dependencies = [
15	    "qux",
16	    "bar>=20.9",
17	    "optional-foo[option]>=0.12.11",
18	    "conditional-bar>=1.1.0; python_version < '3.11'",
19	    "fox-python",  # top level module is called "fox"
20	]
21	
22	[dependency-groups]
23	dev-group = ["foo", "baz"]
24	all = [{include-group = "dev-group"}, "foobaz"]
25	
26	[tool.uv]
27	dev-dependencies = [
28	    "qux",
29	    "bar; python_version < '3.11'",
30	    "foo-bar",
31	]
32	"""
33	
34	    with run_within_dir(tmp_path):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/unit/reporters/test_text.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	        stylize("{BOLD}{RED}Found 4 dependency issues.{RESET}"),
67	        "\nFor more information, see the documentation: https://deptry.com/",
68	    ]
69	
70	
71	def test_logging_number_single(caplog: LogCaptureFixture) -> None:
72	    with caplog.at_level(logging.INFO):
73	        TextReporter([
74	            DEP001MissingDependencyViolation(Module("foo", package="foo-package"), Location(Path("foo.py"), 1, 2))
75	        ]).report()
76	
77	    assert caplog.messages == [
78	        "",
79	        stylize(
80	            "{BOLD}{file}{RESET}{CYAN}:{RESET}1{CYAN}:{RESET}2{CYAN}:{RESET} {BOLD}{RED}DEP001{RESET} 'foo'"
81	            " imported but missing from the dependency definitions",
82	            file=Path("foo.py"),
83	        ),
84	        stylize("{BOLD}{RED}Found 1 dependency issue.{RESET}"),
85	        "\nFor more information, see the documentation: https://deptry.com/",
86	    ]
87	
88	
89	def test_logging_number_none(caplog: LogCaptureFixture) -> None:
90	    with caplog.at_level(logging.INFO):
91	        TextReporter([]).report()
92	
93	    assert caplog.messages == [
94	        "",
95	        stylize("{BOLD}{GREEN}Success! No dependency issues found.{RESET}"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/unit/reporters/test_text.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	        stylize("{BOLD}{RED}Found 1 dependency issue.{RESET}"),
85	        "\nFor more information, see the documentation: https://deptry.com/",
86	    ]
87	
88	
89	def test_logging_number_none(caplog: LogCaptureFixture) -> None:
90	    with caplog.at_level(logging.INFO):
91	        TextReporter([]).report()
92	
93	    assert caplog.messages == [
94	        "",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/deptry-0.23.0/deptry-0.23.0/tests/unit/reporters/test_text.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	        "Found 4 dependency issues.",
124	        "\nFor more information, see the documentation: https://deptry.com/",
125	    ]
126	
127	
128	@pytest.mark.parametrize(
129	    ("use_ansi", "expected"),
130	    [
131	        (True, COLORS),
132	        (False, COLORS_NOOP),
133	    ],
134	)
135	def test__get_colors(use_ansi: bool, expected: dict[str, str]) -> None:
136	    assert TextReporter([], use_ansi)._get_colors() == expected

--------------------------------------------------

Code scanned:
	Total lines of code: 6846
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 1.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 0.0
Files skipped (0):
