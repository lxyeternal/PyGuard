Run started:2025-04-12 16:44:36.521081

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/geoip2_tools-0.1.1-py2.py3-none-any/geoip2_tools/database.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	DEFAULT_GEOIP2_TOOLS_DIRECTORY = os.path.expanduser('~/.config/geoip2-tools/')
18	GEOIP2_TOOLS_DIRECTORY = os.environ.get('GEOIP2_TOOLS_DIRECTORY', DEFAULT_GEOIP2_TOOLS_DIRECTORY)
19	GEOIP2_DOWNLOAD_URL = 'https://download.maxmind.com/app/geoip_download'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/geoip2_tools-0.1.1-py2.py3-none-any/geoip2_tools/database.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	GEOIP2_TOOLS_DIRECTORY = os.environ.get('GEOIP2_TOOLS_DIRECTORY', DEFAULT_GEOIP2_TOOLS_DIRECTORY)
19	GEOIP2_DOWNLOAD_URL = 'https://download.maxmind.com/app/geoip_download'
20	GEOIP2_MAXMIND_LICENSE_KEY_ENVNAME = 'GEOIP2_MAXMIND_LICENSE_KEY'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/geoip2_tools-0.1.1-py2.py3-none-any/geoip2_tools/database.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	                 license_key: Union[str, None] = None):
27	        self.edition_id = DATABASE_ALIASES.get(edition_id, edition_id)
28	        self.directory = directory or GEOIP2_TOOLS_DIRECTORY

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/geoip2_tools-0.1.1-py2.py3-none-any/geoip2_tools/database.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	        self.directory = directory or GEOIP2_TOOLS_DIRECTORY
29	        self.license_key = license_key or os.environ.get(GEOIP2_MAXMIND_LICENSE_KEY_ENVNAME)
30	        self._reader = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/geoip2_tools-0.1.1-py2.py3-none-any/geoip2_tools/database.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	        tar_path = f'{self.path}.tar.gz'
49	        r = requests.get(GEOIP2_DOWNLOAD_URL, params=self.download_params(), stream=True)
50	        if self.directory:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/geoip2_tools-0.1.1-py2.py3-none-any/geoip2_tools/database.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
52	
53	        with open(tar_path, 'wb') as f:
54	            for chunk in r.iter_content(chunk_size=DOWNLOAD_CHUNK_SIZE):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/geoip2_tools-0.1.1-py2.py3-none-any/geoip2_tools/database.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	                if chunk:  # filter out keep-alive new chunks
56	                    f.write(chunk)
57	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/geoip2_tools-0.1.1-py2.py3-none-any/geoip2_tools/database.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
57	
58	        tar = tarfile.open(tar_path, "r:gz")
59	        member_path = next(filter(lambda x: x.endswith('.mmdb'), tar.getnames()))

--------------------------------------------------

Code scanned:
	Total lines of code: 154
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 7.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 0.0
Files skipped (0):
