Run started:2025-04-12 13:20:39.925571

Test results:
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:144
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
143	        try:
144	            sock = socket.socket(family, socket_type, socket_proto)
145	            got_socket = True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
165	                    pass
166	                sock.close()
167	        if return_socket is not None and family == return_family:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
283	                    # to wait on before returning. (cl/427587550)
284	                    os.close(sys.stdin.fileno())
285	                    os.close(sys.stdout.fileno())

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
284	                    os.close(sys.stdin.fileno())
285	                    os.close(sys.stdout.fileno())
286	                    os.close(sys.stderr.fileno())

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
285	                    os.close(sys.stdout.fileno())
286	                    os.close(sys.stderr.fileno())
287	                    time.sleep(timeout)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
288	                    for held_socket in bound_sockets:
289	                        held_socket.close()
290	                finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
328	            for held_socket in bound_sockets:
329	                held_socket.close()
330	            del bound_sockets[:]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
343	                for held_socket in bound_sockets:
344	                    held_socket.close()
345	                del bound_sockets[:]

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:362
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
361	        if hasattr(socket, 'AF_UNIX'):
362	            sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
363	        else:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:365
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
364	            # fallback to AF_INET if this is not unix
365	            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
366	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
367	            # Connect to portserver.
368	            sock.connect(portserver_address)
369	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
370	            # Write request.
371	            sock.sendall(('%d\n' % pid).encode('ascii'))
372	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
374	            # 1K should be ample buffer space.
375	            return sock.recv(1024)
376	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portpicker.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
376	        finally:
377	            sock.close()
378	    except socket.error as error:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portserver.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
79	        try:
80	            sock = socket.socket(family, socket_type, socket_proto)
81	            got_socket = True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portserver.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
92	        finally:
93	            sock.close()
94	    return port if got_socket else None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portserver.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
245	        self._handle_port_request(client_data, writer)
246	        writer.close()
247	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portserver.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
401	
402	    server.close()
403	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/portserver.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
408	
409	    event_loop.close()
410	    request_handler.dump_stats()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portpicker_test.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
79	                try:
80	                    ps_sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
81	                    ps_sock.connect(linux_addr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portpicker_test.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
80	                    ps_sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
81	                    ps_sock.connect(linux_addr)
82	                except socket.error as err:  # pylint: disable=unused-variable

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portpicker_test.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
83	                    continue
84	                ps_sock.close()
85	                break

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portpicker_test.py:375
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
374	            try:
375	                sock = socket.socket(sock_family, sock_type, 0)
376	            except socket.error:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portpicker_test.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
405	            self.assertFalse(portpicker.is_port_free(port))
406	            sock.close()
407	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:85
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
84	            try:
85	                sock = socket.socket(sock_family, sock_type, 0)
86	            except socket.error:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
106	            self.assertFalse(portserver._is_port_free(self.port))
107	            sock.close()
108	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
121	
122	        p = Process(target=exit_immediately)
123	        p.start()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:183
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
182	
183	        conn = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
184	        with self.assertRaises(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
186	                msg=f'{self._test_socket_addr} should not listen yet.'):
187	            conn.connect(anon_addr)
188	            conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
187	            conn.connect(anon_addr)
188	            conn.close()
189	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
200	                try:
201	                    conn.connect(anon_addr)
202	                    conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
201	                    conn.connect(anon_addr)
202	                    conn.close()
203	                except ConnectionRefusedError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
211	                                  f'{delta} seconds. STDERR:\n' +
212	                                  server.stderr.read().decode('utf-8'))
213	                else:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
236	            # Check statistics from portserver
237	            server.send_signal(signal.SIGUSR1)
238	            # TODO implement an I/O timeout

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
255	            # Done.  shutdown gracefully.
256	            server.send_signal(signal.SIGINT)
257	            server.communicate(timeout=2)

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/portpicker-1.6.0/portpicker-1.6.0/src/tests/portserver_test.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
269	    def setUp(self):
270	        self.pool = portserver._PortPool()
271	

--------------------------------------------------

Code scanned:
	Total lines of code: 1333
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 8.0
Files skipped (0):
