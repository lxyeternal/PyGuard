Run started:2025-04-12 11:28:35.976820

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
171	    digest = digester.finalize()
172	    return {"alg": alg, "value": base64.b64encode(digest).decode()}
173	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:172
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
171	    digest = digester.finalize()
172	    return {"alg": alg, "value": base64.b64encode(digest).decode()}
173	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
188	
189	    msg._signature = base64.urlsafe_b64decode(signature)
190	    return msg.encode(sign=False)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	
261	_SIGN_DESCRIPTION = """Create and sign a COSE Sign1 message for CCF governance
262	
263	Note that this tool writes binary COSE Sign1 to standard output.
264	
265	This is done intentionally to facilitate passing the output directly to curl,
266	without having to create and read a temporary file on disk. For example:
267	
268	ccf_cose_sign1 --content ... | curl http://... -H 'Content-Type: application/cose' --data-binary @-
269	"""
270	
271	_PREPARE_DESCRIPTION = """Create the pre-hashed, to-be-signed digest for a CCF governance COSE Sign1 message.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
278	
279	_FINISH_DESCRIPTION = """Create a COSE Sign1 message for CCF governance with an externally provided signature.
280	
281	Note that this tool writes binary COSE Sign1 to standard output.
282	
283	This is done intentionally to facilitate passing the output directly to curl,
284	without having to create and read a temporary file on disk. For example:
285	
286	ccf_cose_sign1_finish --content ... | curl http://... -H 'Content-Type: application/cose' --data-binary @-
287	"""
288	
289	
290	def _common_parser(description):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
363	    ) as content_:
364	        content = content_.read()
365	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
366	    with open(args.signing_key, "r", encoding="utf-8") as signing_key_:
367	        signing_key = signing_key_.read()
368	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
369	    with open(args.signing_cert, "r", encoding="utf-8") as signing_cert_:
370	        signing_cert = signing_cert_.read()
371	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
379	    cose_sign1 = create_cose_sign1(content, signing_key, signing_cert, protected_header)
380	    sys.stdout.buffer.write(cose_sign1)
381	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
393	    ) as content_:
394	        content = content_.read()
395	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
396	    with open(args.signing_cert, "r", encoding="utf-8") as signing_cert_:
397	        signing_cert = signing_cert_.read()
398	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
420	    ) as content_:
421	        content = content_.read()
422	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
423	    with open(args.signing_cert, "r", encoding="utf-8") as signing_cert_:
424	        signing_cert = signing_cert_.read()
425	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/cose.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
438	    )
439	    sys.stdout.buffer.write(cose_sign1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
95	    size = struct.calcsize(fmt)
96	    buf = stream.read(size)
97	    if not buf:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	        self._tables = {}
195	        self._read()
196	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
334	    offset = file.tell()
335	    ret = file.read(num_of_bytes)
336	    if len(ret) != num_of_bytes:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
355	        file.seek(pos)
356	    buffer = file.read()
357	    file.seek(save_pos)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
479	                existing_root = bytes.fromhex(signature["root"])
480	                sig = base64.b64decode(signature["sig"])
481	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:480
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
479	                existing_root = bytes.fromhex(signature["root"])
480	                sig = base64.b64decode(signature["sig"])
481	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
528	            signature = json.loads(cose_signature)
529	            cose_sign1 = base64.b64decode(signature)
530	            self._verify_root_cose_signature(self.merkle.get_merkle_root(), cose_sign1)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:529
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
528	            signature = json.loads(cose_signature)
529	            cose_sign1 = base64.b64decode(signature)
530	            self._verify_root_cose_signature(self.merkle.get_merkle_root(), cose_sign1)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
578	                + f"\nCertificate: {tx_info.node_cert.decode()}"
579	                + f"\nSignature: {base64.b64encode(tx_info.signature).decode()}"
580	                + f"\nRoot: {tx_info.existing_root.hex()}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:579
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
578	                + f"\nCertificate: {tx_info.node_cert.decode()}"
579	                + f"\nSignature: {base64.b64encode(tx_info.signature).decode()}"
580	                + f"\nRoot: {tx_info.existing_root.hex()}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
662	        with open(filename, mode="rb") as f:
663	            self._buffer = f.read()
664	        self._file = io.BytesIO(self._buffer)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/ledger.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
801	
802	        self._complete_read()
803	        self._read_header()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/receipt.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
29	    """
30	    sig = base64.b64decode(signature)
31	    pk = cert.public_key()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/receipt.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
29	    """
30	    sig = base64.b64decode(signature)
31	    pk = cert.public_key()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/split_ledger.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
19	    ledger_file = open(ledger_file_path, "wb")
20	    ledger_file.write(
21	        int.to_bytes(0, length=ccf.ledger.LEDGER_HEADER_SIZE, byteorder="little")
22	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/split_ledger.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
46	        for pos in entry_positions:
47	            ledger_file.write(int.to_bytes(pos, length=4, byteorder="little"))
48	        ledger_file.seek(0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/split_ledger.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	        ledger_file.seek(0)
49	        ledger_file.write(
50	            int.to_bytes(
51	                positions_offset,
52	                length=ccf.ledger.LEDGER_HEADER_SIZE,
53	                byteorder="little",
54	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ccf-6.0.1-py3-none-any/ccf/split_ledger.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
109	        entry_positions.append(ledger_file_output.tell())
110	        ledger_file_output.write(entry.get_raw_tx())
111	

--------------------------------------------------

Code scanned:
	Total lines of code: 2131
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 25.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 5.0
Files skipped (0):
