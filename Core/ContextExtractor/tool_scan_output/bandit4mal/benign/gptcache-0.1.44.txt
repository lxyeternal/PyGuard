Run started:2025-04-12 12:28:28.130911

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/diffusers.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
57	            img.save(buffered, format="PNG")
58	            img_b64 = base64.b64encode(buffered.getvalue())
59	            update_cache_func(Answer(img_b64, DataType.IMAGE_BASE64))

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/diffusers.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
57	            img.save(buffered, format="PNG")
58	            img_b64 = base64.b64encode(buffered.getvalue())
59	            update_cache_func(Answer(img_b64, DataType.IMAGE_BASE64))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/diffusers.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
67	def _construct_resp_from_cache(img_64):
68	    im_bytes = base64.b64decode(img_64)   # im_bytes is a binary image
69	    im_file = BytesIO(im_bytes)  # convert image to file-like object

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/diffusers.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
67	def _construct_resp_from_cache(img_64):
68	    im_bytes = base64.b64decode(img_64)   # im_bytes is a binary image
69	    im_file = BytesIO(im_bytes)  # convert image to file-like object

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/openai.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
518	
519	    img_bytes = base64.b64decode((image_data))
520	    img_file = BytesIO(img_bytes)  # convert image to file-like object

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/openai.py:519
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
518	
519	    img_bytes = base64.b64decode((image_data))
520	    img_file = BytesIO(img_bytes)  # convert image to file-like object

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/openai.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
532	        with open(target_url, "wb") as f:
533	            f.write(buffered.getvalue())
534	        image_data = target_url

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/openai.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
535	    elif response_format == "b64_json":
536	        image_data = base64.b64encode(buffered.getvalue()).decode("ascii")
537	    else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/openai.py:536
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
535	    elif response_format == "b64_json":
536	        image_data = base64.b64encode(buffered.getvalue()).decode("ascii")
537	    else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/stability_sdk.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
87	                        if artifact.type == generation.ARTIFACT_IMAGE:
88	                            img_b64 = base64.b64encode(artifact.binary)
89	                            to_save.append(img_b64)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/stability_sdk.py:88
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
87	                        if artifact.type == generation.ARTIFACT_IMAGE:
88	                            img_b64 = base64.b64encode(artifact.binary)
89	                            to_save.append(img_b64)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/stability_sdk.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
100	def _construct_resp_from_cache(img_64, height, width):
101	    img_bytes = base64.b64decode((img_64))
102	    img_file = BytesIO(img_bytes)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/adapter/stability_sdk.py:101
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
100	def _construct_resp_from_cache(img_64, height, width):
101	    img_bytes = base64.b64decode((img_64))
102	    img_file = BytesIO(img_bytes)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/client.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	
30	    def __init__(self, uri: str = "http://localhost:8000"):
31	        self._uri = uri

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/data_manager.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	            question = question.content
129	        session = kwargs.get("session", None)
130	        session_id = {session.name} if session else set()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/data_manager.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
154	    def get_scalar_data(self, res_data, **kwargs) -> CacheData:
155	        session = kwargs.get("session", None)
156	        if session:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/data_manager.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
272	        """
273	        session = kwargs.get("session", None)
274	        session_id = session.name if session else None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/data_manager.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	                if dep.dep_type == DataType.IMAGE_URL:
295	                    dep.dep_type.data = self.o.put(requests.get(dep.data).content)
296	            return question

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/data_manager.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
340	    def get_scalar_data(self, res_data, **kwargs) -> Optional[CacheData]:
341	        session = kwargs.get("session", None)
342	        cache_data = self.s.get_data_by_id(res_data[1])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/data_manager.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
362	            if ans.answer_type != DataType.STR:
363	                ans.answer = self.o.get(ans.answer)
364	        return cache_data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/data_manager.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
366	    def hit_cache_callback(self, res_data, **kwargs):
367	        self.eviction_base.get(res_data[1])
368	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/data_manager.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
370	        embedding_data = normalize(embedding_data)
371	        top_k = kwargs.get("top_k", -1)
372	        return self.v.search(data=embedding_data, top_k=top_k)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/object_data/local_storage.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
19	        with open(f_path, "wb") as f:
20	            f.write(obj)
21	        return str(f_path.absolute())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/object_data/local_storage.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
25	            with open(obj, "rb") as f:
26	                return f.read()
27	        except Exception: # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/object_data/s3_storage.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	        try:
35	            return self._s3.Bucket(self._bucket).Object(obj).get()["Body"].read()
36	        except Exception:  # pylint: disable=broad-except

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/scalar_data/dynamo_storage.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
207	        # To address this, we're gonna spin up a thread pool and query concurrently
208	        with ThreadPoolExecutor(max_workers = 10) as executor:
209	            futures = []

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/manager/scalar_data/dynamo_storage.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
359	        # concurrently
360	        with ThreadPoolExecutor(max_workers = 10) as executor:
361	            futures = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/utils/response.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
9	def get_stream_message_from_openai_answer(openai_data):
10	    return openai_data["choices"][0]["delta"].get("content", "")
11	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/utils/response.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	    url = openai_resp["data"][0]["url"]
23	    img_content = requests.get(url).content
24	    img_data = base64.b64encode(img_content)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/utils/response.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
23	    img_content = requests.get(url).content
24	    img_data = base64.b64encode(img_content)
25	    return img_data

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/utils/response.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
23	    img_content = requests.get(url).content
24	    img_data = base64.b64encode(img_content)
25	    return img_data

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/utils/response.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
30	    with open(img_path, "rb") as f:
31	        img_data = base64.b64encode(f.read())
32	    return img_data

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache/utils/response.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
30	    with open(img_path, "rb") as f:
31	        img_data = base64.b64encode(f.read())
32	    return img_data

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/gptcache_server/server.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
80	            for file in files:
81	                zipf.write(os.path.join(root, file))
82	    return FileResponse(zip_filename)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12	with open("README.md", "r") as fh:
13	    long_description = fh.read()
14	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
25	    with codecs.open(os.path.join(here, *parts), "r") as fp:
26	        return fp.read()
27	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	def find_version(*file_paths):
30	    version_file = read(*file_paths)
31	    version_match = re.search(r"^__version__ = ['\"]([^'\"]*)['\"]", version_file, re.M)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/setup.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	    install_requires=parse_requirements('requirements.txt'),
49	    url="https://github.com/zilliztech/GPTCache",
50	    license='https://opensource.org/license/mit/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gptcache-0.1.44/gptcache-0.1.44/setup.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    url="https://github.com/zilliztech/GPTCache",
50	    license='https://opensource.org/license/mit/',
51	    python_requires='>=3.8.1',

--------------------------------------------------

Code scanned:
	Total lines of code: 8772
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 8.0
Files skipped (0):
