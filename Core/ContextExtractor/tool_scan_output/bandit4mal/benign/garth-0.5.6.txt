Run started:2025-04-12 11:22:54.230811

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/data/_base.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
37	        dates = date_range(end, days)
38	        with ThreadPoolExecutor(max_workers=max_workers) as executor:
39	            data = list(executor.map(fetch_date, dates))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
134	            headers["Authorization"] = str(self.oauth2_token)
135	        self.last_resp = self.sess.request(
136	            method,
137	            url,
138	            headers=headers,
139	            timeout=self.timeout,
140	            **kwargs,
141	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
151	    def get(self, *args, **kwargs) -> Response:
152	        return self.request("GET", *args, **kwargs)
153	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
154	    def post(self, *args, **kwargs) -> Response:
155	        return self.request("POST", *args, **kwargs)
156	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
157	    def delete(self, *args, **kwargs) -> Response:
158	        return self.request("DELETE", *args, **kwargs)
159	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
160	    def put(self, *args, **kwargs) -> Response:
161	        return self.request("PUT", *args, **kwargs)
162	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
183	    ) -> Dict[str, Any] | None:
184	        resp = self.request(method, "connectapi", path, api=True, **kwargs)
185	        if resp.status_code == 204:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	    def download(self, path: str, **kwargs) -> bytes:
190	        resp = self.get("connectapi", path, api=True, **kwargs)
191	        return resp.content

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
220	        s = json.dumps(r)
221	        return base64.b64encode(s.encode()).decode()
222	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:221
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
220	        s = json.dumps(r)
221	        return base64.b64encode(s.encode()).decode()
222	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
233	    def loads(self, s: str):
234	        oauth1, oauth2 = json.loads(base64.b64decode(s))
235	        self.configure(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:234
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
233	    def loads(self, s: str):
234	        oauth1, oauth2 = json.loads(base64.b64decode(s))
235	        self.configure(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/http.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
237	            oauth2_token=OAuth2Token(**oauth2),
238	            domain=oauth1.get("domain"),
239	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	TITLE_RE = re.compile(r"<title>(.+?)</title>")
18	OAUTH_CONSUMER_URL = "https://thegarth.s3.amazonaws.com/oauth_consumer.json"
19	OAUTH_CONSUMER: Dict[str, str] = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	        if not OAUTH_CONSUMER:
32	            OAUTH_CONSUMER = requests.get(OAUTH_CONSUMER_URL).json()
33	        super().__init__(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	    # Define params based on domain
99	    SSO = f"https://sso.{client.domain}/sso"
100	    SSO_EMBED = f"{SSO}/embed"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	    # Set cookies
118	    client.get("sso", "/sso/embed", params=SSO_EMBED_PARAMS)
119	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	    # Get CSRF token
121	    client.get(
122	        "sso",
123	        "/sso/signin",
124	        params=SIGNIN_PARAMS,
125	        referrer=True,
126	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
129	    # Submit login form with email and password
130	    client.post(
131	        "sso",
132	        "/sso/signin",
133	        params=SIGNIN_PARAMS,
134	        referrer=True,
135	        data=dict(
136	            username=email,
137	            password=password,
138	            embed="true",
139	            _csrf=csrf_token,
140	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	    sess = GarminOAuth1Session(parent=client.sess)
163	    base_url = f"https://connectapi.{client.domain}/oauth-service/oauth/"
164	    login_url = f"https://sso.{client.domain}/sso/embed"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
163	    base_url = f"https://connectapi.{client.domain}/oauth-service/oauth/"
164	    login_url = f"https://sso.{client.domain}/sso/embed"
165	    url = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	    )
169	    resp = sess.get(
170	        url,
171	        headers=USER_AGENT,
172	        timeout=client.timeout,
173	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	    data = dict(mfa_token=oauth1.mfa_token) if oauth1.mfa_token else {}
187	    base_url = f"https://connectapi.{client.domain}/oauth-service/oauth/"
188	    url = f"{base_url}exchange/user/2.0"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
192	    }
193	    resp = sess.post(
194	        url,
195	        headers=headers,
196	        data=data,
197	        timeout=client.timeout,
198	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
211	        mfa_code = prompt_mfa()
212	    client.post(
213	        "sso",
214	        "/sso/verifyMFA/loginEnterMfaCode",
215	        params=signin_params,
216	        referrer=True,
217	        data={
218	            "mfa-code": mfa_code,
219	            "embed": "true",
220	            "_csrf": csrf_token,
221	            "fromPage": "setupEnterMfaCode",
222	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/garth/sso.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
263	
264	    client.post(
265	        "sso",
266	        "/sso/verifyMFA/loginEnterMfaCode",
267	        params=signin_params,
268	        referrer=True,
269	        data={
270	            "mfa-code": mfa_code,
271	            "embed": "true",
272	            "_csrf": csrf_token,
273	            "fromPage": "setupEnterMfaCode",
274	        },

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/conftest.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
69	    try:
70	        client.load(os.environ["GARTH_HOME"])
71	    except KeyError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/conftest.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	            try:
117	                body = gzip.GzipFile(fileobj=buffer).read()
118	            except gzip.BadGzipFile:  # pragma: no cover

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/test_http.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
17	        new_client = Client()
18	        new_client.load(tempdir)
19	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/test_http.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    assert client.sess.proxies == {}
46	    proxy = {"https": "http://localhost:8888"}
47	    client.configure(proxies=proxy)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/test_http.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
122	def test_client_request(client: Client):
123	    resp = client.request("GET", "connect", "/")
124	    assert resp.ok

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/test_http.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
122	def test_client_request(client: Client):
123	    resp = client.request("GET", "connect", "/")
124	    assert resp.ok

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/test_http.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
126	    with pytest.raises(GarthHTTPError) as e:
127	        client.request("GET", "connectapi", "/")
128	    assert "404" in str(e.value)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/test_http.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
126	    with pytest.raises(GarthHTTPError) as e:
127	        client.request("GET", "connectapi", "/")
128	    assert "404" in str(e.value)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/test_http.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
193	def test_download(authed_client: Client):
194	    downloaded = authed_client.download(
195	        "/download-service/files/activity/11998957007"
196	    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/garth-0.5.6/garth-0.5.6/tests/test_http.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
205	    with open(fpath, "rb") as f:
206	        uploaded = authed_client.upload(f)
207	    assert uploaded

--------------------------------------------------

Code scanned:
	Total lines of code: 1833
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 2.0
Files skipped (0):
