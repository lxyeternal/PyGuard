Run started:2025-04-12 19:00:18.142831

Test results:
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_oci.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
99	
100	        with tarfile.open(
101	            fileobj=tarutil.FilelikeProxy(generator=blob.iter_content(chunk_size=4096)),
102	            mode='r|*',
103	        ) as tf:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_oci.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
144	
145	        with tarfile.open(
146	            fileobj=tarutil.FilelikeProxy(generator=blob.iter_content(chunk_size=4096)),
147	            mode='r|*',
148	        ) as tf:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_oci.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
161	            else:
162	                outfile = open(outfile, 'wb')
163	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_oci.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
166	                read = min(octects_left, 4096)
167	                outfile.write(tf.fileobj.read(read))
168	                octects_left -= read

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_oci.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
189	    oci_client = ccc.oci.oci_client()
190	    pool = concurrent.futures.ThreadPoolExecutor(
191	        max_workers=8,
192	    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_oci.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
374	    tmp = tempfile.NamedTemporaryFile()
375	    tmp.write(manifest_pretty)
376	    tmp.flush()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_oci.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
458	    else:
459	        outfh = open(outfile, 'wb')
460	        write = outfh.write

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_oci.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
467	    for chunk in blob.iter_content(chunk_size=4096):
468	        write(chunk)
469	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_oci.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
544	        )
545	        tf = tarfile.open(fileobj=fileproxy, mode='r|*')
546	        if (os_info := us.determine_osinfo(tf)):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
77	
78	    tar = tarfile.open(
79	        fileobj=tarutil.FilelikeProxy(
80	            component_descriptor_blob.iter_content(chunk_size=tarfile.BLOCKSIZE)
81	        ),
82	        mode='r|*',
83	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
91	
92	        while chunk := reader.read(tarfile.BLOCKSIZE):
93	            tf.write(chunk)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	        while chunk := reader.read(tarfile.BLOCKSIZE):
93	            tf.write(chunk)
94	            digest.update(chunk)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
92	        while chunk := reader.read(tarfile.BLOCKSIZE):
93	            tf.write(chunk)
94	            digest.update(chunk)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
103	    # vi (re)creates files on write (with default backup/write settings), -> (re)open filehandle
104	    with open(tf.name, 'rb') as tf:
105	        raw = tf.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
104	    with open(tf.name, 'rb') as tf:
105	        raw = tf.read()
106	        if (content_digest := hashlib.sha256(raw).hexdigest()) == old_content_digest:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
116	    buf = io.BytesIO()
117	    tar = tarfile.open(fileobj=buf, mode='w')
118	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
125	    # prefix w/ algorithm, as expected by oci-registry
126	    content_digest = f'sha256:{hashlib.sha256(buf.read()).hexdigest()}'
127	    buf.seek(0)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
236	    else:
237	        fh = open(out, 'wb')
238	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
265	        if decompressor:
266	            chunk = decompressor.decompress(chunk)
267	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
267	
268	        fh.write(chunk)
269	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
267	
268	        fh.write(chunk)
269	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
270	    if decompressor:
271	        fh.write(decompressor.flush())
272	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
270	    if decompressor:
271	        fh.write(decompressor.flush())
272	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
279	):
280	    with open(file) as f:
281	        component_descriptor = ocm.ComponentDescriptor.from_dict(

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
407	    )
408	    with open(schema_file) as f:
409	        schema_dict = yaml.safe_load(f)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
410	
411	    with open(component_descriptor) as f:
412	        comp_dict = yaml.safe_load(f)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/_ocm.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
439	    if component_descriptor_out_file:
440	        outfh = open(component_descriptor_out_file, 'w')
441	    else:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/cd.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
169	
170	    pool = concurrent.futures.ThreadPoolExecutor(max_workers=threads)
171	    oci_client = ccc.oci.oci_client(

--------------------------------------------------

Code scanned:
	Total lines of code: 2681
	Total lines skipped (#nosec): 6

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 0.0
Files skipped (1):
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/gardener_cicd_cli-1.2614.0-py3-none-any/gardener_ci/pipeline.py (syntax error while parsing AST from file)
