Run started:2025-04-12 17:14:50.718158

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/__init__.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	def init(writekey="", dataset="", sample_rate=1,
31	         api_host="https://api.honeycomb.io", max_concurrent_batches=10,
32	         max_batch_size=100, send_frequency=0.25,
33	         block_on_send=False, block_on_response=False, transmission_impl=None,
34	         debug=False):
35	    '''Initialize libhoney and prepare it to send events to Honeycomb. This creates
36	    a global Client object that is configured with the supplied parameters. For some

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/builder.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	            self.dataset = None
26	            self.api_host = 'https://api.honeycomb.io'
27	            self.sample_rate = 1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	    def __init__(self, writekey="", dataset="", sample_rate=1,
72	                 api_host="https://api.honeycomb.io",
73	                 max_concurrent_batches=10, max_batch_size=100,
74	                 send_frequency=0.25, block_on_send=False,
75	                 block_on_response=False, transmission_impl=None,
76	                 user_agent_addition='', debug=False):
77	
78	        self.xmit = transmission_impl

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/event.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	            self.dataset = None
26	            self.api_host = 'https://api.honeycomb.io'
27	            self.sample_rate = 1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_client.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	        c = client.Client(writekey="foo", dataset="bar")
76	        self.assertEqual(c.api_host, "https://api.honeycomb.io")
77	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_tornado.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	                ev = mock.Mock(metadata=None, writekey="abc123",
57	                               dataset="blargh", api_host="https://example.com",
58	                               sample_rate=1, created_at=datetime.datetime.now())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_tornado.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	                ev = mock.Mock(metadata=None, writekey="abc123",
93	                               dataset="blargh", api_host="https://example.com",
94	                               sample_rate=1, created_at=datetime.datetime.now())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	            httpretty.POST,
109	            "http://urlme/1/batch/datame",
110	            responses=[
111	                httpretty.Response(
112	                    body='{"message": "Timeout"}',
113	                    status=500,
114	                ),
115	                httpretty.Response(
116	                    body=json.dumps([{"status": 202}]),
117	                    status=200,
118	                ),
119	            ]
120	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	        ev.dataset = "datame"
127	        ev.api_host = "http://urlme/"
128	        ev.metadata = "metadaaata"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
134	        while not t.responses.empty():
135	            resp = t.responses.get()
136	            if resp is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
145	        with requests_mock.Mocker() as m:
146	            m.post("http://urlme/1/batch/datame",
147	                   text=json.dumps([{"status": 202}]), status_code=200,
148	                   request_headers={"X-Honeycomb-Team": "writeme"})
149	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        with requests_mock.Mocker() as m:
146	            m.post("http://urlme/1/batch/datame",
147	                   text=json.dumps([{"status": 202}]), status_code=200,
148	                   request_headers={"X-Honeycomb-Team": "writeme"})
149	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	            ev.dataset = "datame"
155	            ev.api_host = "http://urlme/"
156	            ev.metadata = "metadaaata"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	            while not resp_received:
165	                resp = t.responses.get()
166	                if resp is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
203	        with requests_mock.Mocker() as m:
204	            m.post("http://urlme/1/batch/datame",
205	                   text=json.dumps(200 * [{"status": 202}]), status_code=200,
206	                   request_headers={"X-Honeycomb-Team": "writeme"})
207	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
203	        with requests_mock.Mocker() as m:
204	            m.post("http://urlme/1/batch/datame",
205	                   text=json.dumps(200 * [{"status": 202}]), status_code=200,
206	                   request_headers={"X-Honeycomb-Team": "writeme"})
207	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
213	                ev.dataset = "datame"
214	                ev.api_host = "http://urlme/"
215	                ev.metadata = "metadaaata"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	            while not t.responses.empty():
224	                resp = t.responses.get()
225	                if resp is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
240	        with requests_mock.Mocker() as m:
241	            m.post("http://urlme/1/batch/dataset",
242	                   text=json.dumps(100 * [{"status": 202}]), status_code=200,
243	                   request_headers={"X-Honeycomb-Team": "writeme"})
244	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
240	        with requests_mock.Mocker() as m:
241	            m.post("http://urlme/1/batch/dataset",
242	                   text=json.dumps(100 * [{"status": 202}]), status_code=200,
243	                   request_headers={"X-Honeycomb-Team": "writeme"})
244	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
244	
245	            m.post("http://urlme/1/batch/alt_dataset",
246	                   text=json.dumps(100 * [{"status": 202}]), status_code=200,
247	                   request_headers={"X-Honeycomb-Team": "writeme"})
248	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	
245	            m.post("http://urlme/1/batch/alt_dataset",
246	                   text=json.dumps(100 * [{"status": 202}]), status_code=200,
247	                   request_headers={"X-Honeycomb-Team": "writeme"})
248	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
255	            builder.dataset = "dataset"
256	            builder.api_host = "http://urlme/"
257	            for i in range(100):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
272	            while not t.responses.empty():
273	                resp = t.responses.get()
274	                if resp is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
280	            assert ({h.url for h in m.request_history} ==
281	                    {"http://urlme/1/batch/dataset", "http://urlme/1/batch/alt_dataset"})
282	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
280	            assert ({h.url for h in m.request_history} ==
281	                    {"http://urlme/1/batch/dataset", "http://urlme/1/batch/alt_dataset"})
282	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
285	        with requests_mock.Mocker() as m:
286	            m.post("http://urlme/1/batch/dataset",
287	                   text=json.dumps(100 * [{"status": 202}]), status_code=200,
288	                   request_headers={"X-Honeycomb-Team": "writeme"})
289	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
285	        with requests_mock.Mocker() as m:
286	            m.post("http://urlme/1/batch/dataset",
287	                   text=json.dumps(100 * [{"status": 202}]), status_code=200,
288	                   request_headers={"X-Honeycomb-Team": "writeme"})
289	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
297	            ev.add_field("key", "value")
298	            ev.api_host = "http://urlme/"
299	
300	            t.send(ev)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/test_transmission.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
302	            time.sleep(0.2)
303	            resp = t.responses.get()
304	            assert resp["status_code"] == 202

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/transmission.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
142	        last_flush = time.time()
143	        with concurrent.futures.ThreadPoolExecutor(max_workers=self.max_concurrent_batches) as pool:
144	            while True:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/transmission.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	                try:
146	                    ev = self.pending.get(timeout=self.send_frequency)
147	                    if ev is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/transmission.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
200	            self.log("firing batch, size = %d", len(payload))
201	            resp = self.session.post(
202	                url,
203	                headers={"X-Honeycomb-Team": destination.writekey,
204	                         "Content-Type": "application/json"},
205	                data=data,
206	                timeout=10.0,
207	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/transmission.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	            resp.raise_for_status()
210	            statuses = [{"status": d.get("status"), "error": d.get(
211	                "error")} for d in resp.json()]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/transmission.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	            resp.raise_for_status()
210	            statuses = [{"status": d.get("status"), "error": d.get(
211	                "error")} for d in resp.json()]
212	            for ev, status in zip(events, statuses):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/transmission.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	            for ev, status in zip(events, statuses):
213	                self._enqueue_response(status.get(
214	                    "status"), "", status.get("error"), start, ev.metadata)
215	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/transmission.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	                self._enqueue_response(status.get(
214	                    "status"), "", status.get("error"), start, ev.metadata)
215	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/libhoney-2.4.0/libhoney-2.4.0/libhoney/transmission.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
341	                try:
342	                    ev = yield self.pending.get(timeout=self.send_frequency)
343	                    if ev is None:

--------------------------------------------------

Code scanned:
	Total lines of code: 1906
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 38.0
		High: 0.0
Files skipped (0):
