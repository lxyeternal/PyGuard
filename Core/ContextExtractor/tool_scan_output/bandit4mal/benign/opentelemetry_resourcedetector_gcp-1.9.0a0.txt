Run started:2025-04-12 16:54:39.053000

Test results:
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/setup.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
28	with open(VERSION_FILENAME) as f:
29	    exec(f.read(), PACKAGE_INFO)
30	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/setup.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	with open(VERSION_FILENAME) as f:
29	    exec(f.read(), PACKAGE_INFO)
30	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/src/opentelemetry/resourcedetector/gcp_resource_detector/__init__.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	_GCP_METADATA_URL = (
23	    "http://metadata.google.internal/computeMetadata/v1/?recursive=true"
24	)
25	_GCP_METADATA_URL_HEADER = {"Metadata-Flavor": "Google"}
26	_TIMEOUT_SEC = 5

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/src/opentelemetry/resourcedetector/gcp_resource_detector/__init__.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	    token = attach(set_value("suppress_instrumentation", True))
33	    all_metadata = requests.get(
34	        _GCP_METADATA_URL,
35	        headers=_GCP_METADATA_URL_HEADER,
36	        timeout=_TIMEOUT_SEC,
37	    ).json()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/src/opentelemetry/resourcedetector/gcp_resource_detector/__init__.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	            ) as namespace_file:
87	                pod_namespace = namespace_file.read().strip()
88	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/src/opentelemetry/resourcedetector/gcp_resource_detector/_metadata.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	_GCP_METADATA_URL = "http://metadata.google.internal/computeMetadata/v1/"
25	_INSTANCE = "instance"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/src/opentelemetry/resourcedetector/gcp_resource_detector/_metadata.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	    try:
69	        res = requests.get(
70	            f"{_GCP_METADATA_URL}",
71	            params=_RECURSIVE_PARAMS,
72	            headers=_GCP_METADATA_URL_HEADER,
73	            timeout=_TIMEOUT,
74	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/src/opentelemetry/resourcedetector/gcp_resource_detector/_metadata.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	    try:
85	        requests.get(
86	            f"{_GCP_METADATA_URL}{_INSTANCE}/",
87	            headers=_GCP_METADATA_URL_HEADER,
88	            timeout=_TIMEOUT,
89	        ).raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/tests/test_detector.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
41	    json = {"instance": {}, "project": {}}
42	    fake_get().json.return_value = json
43	    return json

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/tests/test_gcp_resource_detector.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
115	    def test_missing_container_name(self, getter):
116	        os.environ[KUBERNETES_SERVICE_HOST] = "10.0.0.1"
117	        pop_environ_key(CONTAINER_NAME)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/tests/test_gcp_resource_detector.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
134	    def test_environment_empty_strings(self, getter):
135	        os.environ[KUBERNETES_SERVICE_HOST] = "10.0.0.1"
136	        os.environ[CONTAINER_NAME] = ""

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/tests/test_gcp_resource_detector.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
154	    def test_missing_namespace_file(self, getter):
155	        os.environ[KUBERNETES_SERVICE_HOST] = "10.0.0.1"
156	        os.environ[CONTAINER_NAME] = "container_name"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/tests/test_gcp_resource_detector.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
173	    def test_finding_gke_resources(self, getter):
174	        os.environ[KUBERNETES_SERVICE_HOST] = "10.0.0.1"
175	        os.environ[NAMESPACE] = "namespace"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/tests/test_gcp_resource_detector.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
195	    def test_finding_gke_resources_with_pod_name(self, getter):
196	        os.environ[KUBERNETES_SERVICE_HOST] = "10.0.0.1"
197	        os.environ[NAMESPACE] = "namespace"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opentelemetry_resourcedetector_gcp-1.9.0a0/opentelemetry_resourcedetector_gcp-1.9.0a0/tests/test_gcp_resource_detector.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
415	        # to succeed. No GCE resource info should be extracted
416	        os.environ[KUBERNETES_SERVICE_HOST] = "10.0.0.1"
417	        os.environ[NAMESPACE] = "namespace"

--------------------------------------------------

Code scanned:
	Total lines of code: 1702
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 1.0
Files skipped (0):
