Run started:2025-04-12 17:33:47.783152

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/cli/autocompletion.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	            with open(filepath, 'ab+') as fw:
54	                fw.write(f'\n{write_string}\n'.encode())
55	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/cli/autocompletion.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
179	            with open(completion_filepath, 'w', encoding='utf-8') as fw:
180	                fw.write(autocomplete_script_str)
181	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/cli/validations.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	            raise click.BadParameter(
94	                f'Invalid version scheme.\n'
95	                f'Received: "{value}"\n'
96	                'Documentation: https://docs.espressif.com/projects/idf-component-manager/en/'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
237	
238	        response = requests.get(example_url['url'], stream=True)  # noqa: S113
239	        with tarfile.open(fileobj=response.raw, mode='r|gz') as tar:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
238	        response = requests.get(example_url['url'], stream=True)  # noqa: S113
239	        with tarfile.open(fileobj=response.raw, mode='r|gz') as tar:
240	            tar.extractall(project_path)  # noqa: S202

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
299	        yaml = YAML()
300	        with open(manifest_filepath, 'r', encoding='utf-8') as file:
301	            manifest_data = yaml.load(file) or CommentedMap()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
322	
323	        with open(manifest_filepath, 'w', encoding='utf-8') as file:
324	            yaml.dump(manifest_data, file)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
331	        notice(
332	            f'If you want to make additional changes to the manifest file at path {manifest_filepath} manually, '
333	            'please refer to the documentation: '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
357	                raise FatalError(
358	                    'Version parameter must be either "git" or a valid version.\n'
359	                    f'Received: "{version}"\n'
360	                    'Documentation: https://docs.espressif.com/projects/idf-component-manager/en/'

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
476	                validate_managed_component_hash(str(managed_components_dir / component_dir))
477	                shutil.rmtree(str(managed_components_dir / component_dir))
478	            except (HashNotEqualError, HashNotSHA256Error):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
486	        elif any(managed_components_dir.iterdir()) == 0:
487	            shutil.rmtree(str(managed_components_dir))
488	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
529	            finally:
530	                shutil.rmtree(tempdir)
531	        else:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
733	
734	        with open(managed_components_list_file, mode='w', encoding='utf-8') as file:
735	            # Set versions for manifests in requierements too

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
739	                if requirement.version:
740	                    file.write(
741	                        f'idf_component_set_property({requirement.name} COMPONENT_VERSION "{requirement.version}")\n'
742	                    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
739	                if requirement.version:
740	                    file.write(
741	                        f'idf_component_set_property({requirement.name} COMPONENT_VERSION "{requirement.version}")\n'
742	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
745	                for downloaded_component in group:
746	                    file.write(
747	                        f'idf_build_component("{downloaded_component.abs_posix_path}" "{"idf_components" if is_root == 1 else "project_managed_components"}")\n'
748	                    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
745	                for downloaded_component in group:
746	                    file.write(
747	                        f'idf_build_component("{downloaded_component.abs_posix_path}" "{"idf_components" if is_root == 1 else "project_managed_components"}")\n'
748	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
749	
750	                    file.write(
751	                        f'idf_component_set_property({downloaded_component.name} COMPONENT_VERSION "{downloaded_component.version}")\n'
752	                    )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
749	
750	                    file.write(
751	                        f'idf_component_set_property({downloaded_component.name} COMPONENT_VERSION "{downloaded_component.version}")\n'
752	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
754	                    if downloaded_component.targets:
755	                        file.write(
756	                            f'idf_component_set_property({downloaded_component.name} REQUIRED_IDF_TARGETS "{" ".join(downloaded_component.targets)}")\n'
757	                        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
754	                    if downloaded_component.targets:
755	                        file.write(
756	                            f'idf_component_set_property({downloaded_component.name} REQUIRED_IDF_TARGETS "{" ".join(downloaded_component.targets)}")\n'
757	                        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
758	
759	            file.write(
760	                'set(managed_components "%s")\n'
761	                % ';'.join(component.name for component in all_managed_components)
762	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
758	
759	            file.write(
760	                'set(managed_components "%s")\n'
761	                % ';'.join(component.name for component in all_managed_components)
762	            )

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
769	        )
770	        with open(component_list_file, mode='w', encoding='utf-8') as file:
771	            file.write('\n'.join(all_components))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
770	        with open(component_list_file, mode='w', encoding='utf-8') as file:
771	            file.write('\n'.join(all_components))
772	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
770	        with open(component_list_file, mode='w', encoding='utf-8') as file:
771	            file.write('\n'.join(all_components))
772	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/core.py:784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
783	        try:
784	            with open(component_list_file, encoding='utf-8') as f:
785	                components_with_manifests = f.readlines()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_manager/dependencies.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
80	            notice(f' {unused_component_name}')
81	            shutil.rmtree(os.path.join(managed_components_path, unused_component_name))
82	    if unused_files and not ComponentManagerSettings().SUPPRESS_UNKNOWN_FILE_WARNINGS:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/archive_tools.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
67	    try:
68	        tar = tarfile.open(file)
69	        prepare_empty_directory(destination_directory)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/archive_tools.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
103	    try:
104	        with tarfile.open(archive_filepath, 'w:gz') as archive:
105	            archive.add(source_dir, arcname='')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/constants.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	DEFAULT_NAMESPACE = 'espressif'
19	IDF_COMPONENT_REGISTRY_URL = 'https://components.espressif.com/'
20	IDF_COMPONENT_STORAGE_URL = 'https://components-file.espressif.com/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/constants.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	IDF_COMPONENT_REGISTRY_URL = 'https://components.espressif.com/'
20	IDF_COMPONENT_STORAGE_URL = 'https://components-file.espressif.com/'
21	IDF_COMPONENT_STAGING_REGISTRY_URL = 'https://components-staging.espressif.com'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/constants.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	IDF_COMPONENT_STORAGE_URL = 'https://components-file.espressif.com/'
21	IDF_COMPONENT_STAGING_REGISTRY_URL = 'https://components-staging.espressif.com'
22	
23	UPDATE_SUGGESTION = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/errors.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        err = (
25	            'This is an internal error. Please report on '
26	            '`https://github.com/espressif/idf-component-manager/issues '
27	            'with your operating system, idf-component-manager version, '
28	            'and the traceback log. Thanks for reporting! '
29	        )
30	
31	        if extra_msg:
32	            err = extra_msg + '\n' + err

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/file_cache.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
61	        """Clear cache directory"""
62	        shutil.rmtree(self.path())
63	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/file_tools.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
154	    if dir_exist and os.listdir(directory):
155	        rmtree(directory)
156	        dir_exist = False

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/file_tools.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
168	    if os.path.exists(destination_directory):
169	        rmtree(destination_directory)
170	    copytree(source_directory, destination_directory)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/hash_tools/validate_managed_component.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	    with open(hash_file_path, encoding='utf-8') as f:
48	        hash_from_file = f.read().strip()
49	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/hash_tools/validate_managed_component.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	    with open(hash_file_path, encoding='utf-8') as f:
67	        hash_from_file = f.read().strip()
68	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/lock/manager.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	                new_lock.seek(0)
77	                new_lock_content = new_lock.read()
78	        except ValidationError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/lock/manager.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
83	            not self.exists()
84	            or new_lock_content != open(self._path, mode='r', encoding='utf-8').read()
85	        ):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/lock/manager.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
86	            with open(self._path, mode='w', encoding='utf-8') as fw:
87	                fw.write(new_lock_content)
88	                notice('Updating lock file at {}'.format(self._path))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/api_client.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
80	
81	                return base_request(
82	                    self.registry_url,
83	                    session,
84	                    method,
85	                    path,
86	                    data=data,
87	                    json=json,
88	                    headers=headers,
89	                    schema=schema,
90	                    timeout=timeout,
91	                    do_not_cache=do_not_cache,
92	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/api_client.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
100	        """Get information about API status, including storage URL"""
101	        return request('get', [], schema=ApiInformation)
102	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/api_client.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
106	        """Get information about current token"""
107	        return request('get', ['tokens', 'current'], schema=ApiToken)
108	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/api_client.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
112	        """Revoke current token"""
113	        request('delete', ['tokens', 'current'])
114	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/api_client.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
123	            try:
124	                return request(
125	                    'post',
126	                    endpoint,
127	                    data=data,
128	                    headers=headers,
129	                    schema=VersionUpload,
130	                    timeout=UPLOAD_COMPONENT_TIMEOUT,
131	                )['job_id']

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/api_client.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
171	    ) -> None:
172	        request('delete', ['components', component_name.lower(), component_version])
173	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/api_client.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
182	    ) -> None:
183	        request(
184	            'post',
185	            ['components', component_name.lower(), component_version, 'yank'],
186	            json={'message': yank_message},
187	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/api_client.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
191	        return TaskStatus.model_validate(
192	            request(
193	                'get',
194	                ['tasks', job_id],
195	                do_not_cache=True,
196	            )

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/base_client.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
50	    environment_info = [
51	        f'{platform.system()}/{platform.release()} {platform.machine()}',
52	        f'python/{platform.python_version()}',

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/base_client.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
50	    environment_info = [
51	        f'{platform.system()}/{platform.release()} {platform.machine()}',
52	        f'python/{platform.python_version()}',

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/base_client.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
120	
121	        component_response = ComponentResponse(**request('get', ['components', component_name]))
122	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/request_processor.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	            ComponentManagerSettings().CACHE_HTTP_REQUESTS,
70	            kwargs.get('method', '').lower() in ['get', 'head'],
71	            do_not_cache is False,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/request_processor.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
92	        debug(f'HTTP request: {method.upper()} {endpoint}')
93	        response = session.request(
94	            method,
95	            endpoint,
96	            data=data,
97	            json=json,
98	            headers=headers,
99	            timeout=timeout,
100	            allow_redirects=True,
101	            verify=ComponentManagerSettings().VERIFY_SSL,
102	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/request_processor.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
92	        debug(f'HTTP request: {method.upper()} {endpoint}')
93	        response = session.request(
94	            method,
95	            endpoint,
96	            data=data,
97	            json=json,
98	            headers=headers,
99	            timeout=timeout,
100	            allow_redirects=True,
101	            verify=ComponentManagerSettings().VERIFY_SSL,
102	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/request_processor.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	
168	    exception = KNOWN_API_ERRORS.get(name, APIClientError)
169	    if isinstance(messages, list):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/request_processor.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
200	
201	    response = make_request(
202	        session,
203	        endpoint,
204	        data,
205	        json,
206	        headers,
207	        request_timeout,
208	        method=method,
209	        do_not_cache=do_not_cache,
210	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/registry/request_processor.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
200	
201	    response = make_request(
202	        session,
203	        endpoint,
204	        data,
205	        json,
206	        headers,
207	        request_timeout,
208	        method=method,
209	        do_not_cache=do_not_cache,
210	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/fetcher.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	                with open(hash_file, mode='w+', encoding='utf-8') as f:
78	                    f.write(f'{component_hash}')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/git.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
112	            if os.path.isdir(download_path):
113	                shutil.rmtree(download_path)
114	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/git.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
131	        finally:
132	            shutil.rmtree(temp_dir)
133	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/git.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
185	        finally:
186	            shutil.rmtree(temp_dir)
187	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/local.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	            raise SourcePathError(
101	                f'The "{field_name}" field in the manifest file "{path / MANIFEST_FILENAME}" '
102	                'does not point to a directory. '

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/web_service.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	
41	CANONICAL_IDF_COMPONENT_REGISTRY_API_URL = 'https://api.components.espressif.com/'
42	
43	
44	def download_archive(url: str, download_dir: str, save_original_filename: bool = False) -> str:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/web_service.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	    try:
52	        with session.get(url, stream=True, allow_redirects=True) as r:  # type: requests.Response
53	            # Trying to get extension from url

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/web_service.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	            # If didn't find anything useful, trying content disposition
65	            content_disposition = r.headers.get('content-disposition')
66	            if not extension and content_disposition:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/web_service.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
81	                    if chunk:
82	                        f.write(chunk)
83	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/web_service.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
81	                    if chunk:
82	                        f.write(chunk)
83	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/web_service.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
172	        if not versions:
173	            debugger = DEBUG_INFO_COLLECTOR.get()
174	            if pre_release_versions:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/idf_component_tools/sources/web_service.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
277	        finally:
278	            shutil.rmtree(tempdir)
279	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	def registry_url():
31	    return 'http://localhost:5000'
32	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	def storage_url():
36	    return 'http://localhost:9000/test-public'
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	                'in': ['http://', 'test.com', 'asdfasdf'],
61	                'out': 'http://test.com/asdfasdf',
62	            },
63	            {
64	                'in': ['https://test.com:4323/api', 'a/a'],
65	                'out': 'https://test.com:4323/api/a/a',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	            {
64	                'in': ['https://test.com:4323/api', 'a/a'],
65	                'out': 'https://test.com:4323/api/a/a',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	                'in': ['https://test.com:4323/api', 'a/a'],
65	                'out': 'https://test.com:4323/api/a/a',
66	            },
67	            {
68	                'in': ['https://test.com:4323/api/', 'a/a/'],
69	                'out': 'https://test.com:4323/api/a/a',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	            {
68	                'in': ['https://test.com:4323/api/', 'a/a/'],
69	                'out': 'https://test.com:4323/api/a/a',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	                'in': ['https://test.com:4323/api/', 'a/a/'],
69	                'out': 'https://test.com:4323/api/a/a',
70	            },
71	            {'in': ['', 'a/a/'], 'out': '/a/a'},
72	        ]
73	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	        information = client.api_information()
108	        assert information['components_base_url'] == 'http://localhost:9000/test-public'
109	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	    def test_no_registry_token_error(self, monkeypatch, tmp_path):
120	        monkeypatch.setenv('IDF_COMPONENT_REGISTRY_URL', 'http://localhost:9000')
121	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
125	        with open(file_path, 'w+') as f:
126	            f.write('a')
127	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
142	    def test_no_registry_url_use_static(self, monkeypatch):
143	        monkeypatch.setenv('IDF_COMPONENT_STORAGE_URL', 'http://localhost:9000/test-public')
144	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
224	            m.delete(
225	                'http://localhost:5000/api/tokens/current',
226	                status_code=204,
227	            )
228	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
232	            assert m.request_history[0].method == 'DELETE'
233	            assert m.request_history[0].url == 'http://localhost:5000/api/tokens/current'
234	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
237	        storage_file_path = f'file://{fixtures_path}/'
238	        storage_urls = [storage_file_path, 'https://components-file.espressif.com']
239	        client = MultiStorageClient(storage_urls=storage_urls)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	        result = client.component(component_name='espressif/mdns')
245	        assert result['download_url'].startswith('https://components-file.espressif.com')
246	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_api_client.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
257	        with open(file_path, 'w+') as f:
258	            f.write('a')
259	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_archive_tools.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
77	        finally:
78	            shutil.rmtree(tempdir)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	            'in_office': {
31	                'registry_url': 'http://api.localserver.local:5000/',
32	                'api_token': 'asdf',
33	                'default_namespace': 'asdf',
34	            },
35	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	            'in_office': {
71	                'registry_url': 'http://api.localserver.local:5000/',
72	                'api_token': 'asdf',
73	                'default_namespace': 'asdf',
74	            },
75	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	    })
106	    config.profiles['in_office'] = ProfileItem(registry_url='http://api.localserver.local:5000/')
107	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	    loaded_config = ConfigManager(path=config_path).load()
111	    assert loaded_config.profiles['in_office'].registry_url == 'http://api.localserver.local:5000/'
112	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	def test_component_registry_url_storage_env(monkeypatch):
121	    monkeypatch.setenv('IDF_COMPONENT_STORAGE_URL', 'https://storage.com/')
122	    assert ['https://storage.com/'] == get_storage_urls()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	    monkeypatch.setenv('IDF_COMPONENT_STORAGE_URL', 'https://storage.com/')
122	    assert ['https://storage.com/'] == get_storage_urls()
123	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	def test_component_registry_url_multiple_storage_env(monkeypatch):
126	    monkeypatch.setenv('IDF_COMPONENT_STORAGE_URL', 'https://storage.com/;https://test.com/')
127	    assert ['https://storage.com/', 'https://test.com/'] == get_storage_urls()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	    monkeypatch.setenv('IDF_COMPONENT_STORAGE_URL', 'https://storage.com/;https://test.com/')
127	    assert ['https://storage.com/', 'https://test.com/'] == get_storage_urls()
128	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	    monkeypatch.setenv('IDF_COMPONENT_STORAGE_URL', 'https://storage.com/;https://test.com/')
127	    assert ['https://storage.com/', 'https://test.com/'] == get_storage_urls()
128	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	def test_component_registry_url_registry_api_env(monkeypatch):
131	    monkeypatch.setenv('DEFAULT_COMPONENT_SERVICE_URL', 'https://registry.com/api/')
132	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
132	
133	    assert 'https://registry.com/api/' == get_registry_url()
134	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	def test_component_registry_url_registry_env(monkeypatch):
137	    monkeypatch.setenv('IDF_COMPONENT_REGISTRY_URL', 'https://registry.com/')
138	    assert 'https://registry.com/' == get_registry_url()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
137	    monkeypatch.setenv('IDF_COMPONENT_REGISTRY_URL', 'https://registry.com/')
138	    assert 'https://registry.com/' == get_registry_url()
139	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	            {},
146	            'https://components.espressif.com/',
147	            [],
148	        ),
149	        (
150	            None,
151	            'https://components.espressif.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	            None,
151	            'https://components.espressif.com/',
152	            [],
153	        ),
154	        (
155	            {'registry_url': 'default'},
156	            'https://components.espressif.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	            {'registry_url': 'default'},
156	            'https://components.espressif.com/',
157	            [],
158	        ),
159	        (
160	            {'registry_url': 'default', 'storage_url': 'default'},
161	            'https://components.espressif.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	            {'registry_url': 'default', 'storage_url': 'default'},
161	            'https://components.espressif.com/',
162	            ['https://components-file.espressif.com/'],
163	        ),
164	        (
165	            {'storage_url': 'default'},
166	            'https://components.espressif.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
161	            'https://components.espressif.com/',
162	            ['https://components-file.espressif.com/'],
163	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	            {'storage_url': 'default'},
166	            'https://components.espressif.com/',
167	            ['https://components-file.espressif.com/'],
168	        ),
169	        (
170	            {'registry_url': 'http://example.com'},
171	            'http://example.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	            'https://components.espressif.com/',
167	            ['https://components-file.espressif.com/'],
168	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	        (
170	            {'registry_url': 'http://example.com'},
171	            'http://example.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	            {'registry_url': 'http://example.com'},
171	            'http://example.com/',
172	            [],
173	        ),
174	        (
175	            {'storage_url': 'http://example.com/'},
176	            'https://components.espressif.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	        (
175	            {'storage_url': 'http://example.com/'},
176	            'https://components.espressif.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	            {'storage_url': 'http://example.com/'},
176	            'https://components.espressif.com/',
177	            ['http://example.com/'],
178	        ),
179	        (
180	            {'registry_url': 'http://example.com', 'storage_url': 'http://example.com'},
181	            'http://example.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	            'https://components.espressif.com/',
177	            ['http://example.com/'],
178	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
179	        (
180	            {'registry_url': 'http://example.com', 'storage_url': 'http://example.com'},
181	            'http://example.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
179	        (
180	            {'registry_url': 'http://example.com', 'storage_url': 'http://example.com'},
181	            'http://example.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	            {'registry_url': 'http://example.com', 'storage_url': 'http://example.com'},
181	            'http://example.com/',
182	            ['http://example.com/'],
183	        ),
184	        (
185	            {
186	                'registry_url': None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
181	            'http://example.com/',
182	            ['http://example.com/'],
183	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	                'registry_url': None,
187	                'storage_url': ['http://example.com', 'https://test.com'],
188	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	                'registry_url': None,
187	                'storage_url': ['http://example.com', 'https://test.com'],
188	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	            },
189	            'https://components.espressif.com/',
190	            ['http://example.com/', 'https://test.com/'],
191	        ),
192	    ],
193	)
194	def test_component_registry_url_profile(profile, registry_url, storage_urls):
195	    profile = ProfileItem(**profile) if profile else None
196	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	            'https://components.espressif.com/',
190	            ['http://example.com/', 'https://test.com/'],
191	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	            'https://components.espressif.com/',
190	            ['http://example.com/', 'https://test.com/'],
191	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
202	    # Create a temporary YAML file with comments
203	    yaml_content = """
204	    # Start
205	    profiles:
206	      # Comment for default
207	      default:
208	        default_namespace: namespace  # Inline comment for namespace
209	        registry_url: http://localhost:5000/ # Comment to be removed
210	        api_token: token
211	    # End
212	    """
213	    config_file = tmp_path / 'idf_component_manager.yml'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
214	    with config_file.open('w', encoding='utf-8') as f:
215	        f.write(yaml_content)
216	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
229	    with config_file.open('r', encoding='utf-8') as f:
230	        modified_data = f.read()
231	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_config.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
234	    assert 'default_namespace: new_namespace  # Inline comment for namespace' in modified_data
235	    assert 'registry_url: http://localhost:5000/ # Comment to be removed' not in modified_data
236	    assert '# End' in modified_data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_fetcher.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    components_folder_path = os.path.join(fixtures_path, 'components')
18	    source = WebServiceSource(registry_url='https://repo.example.com')
19	    component = SolvedComponent(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_fetcher.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
43	        with open(hash_file, mode='w+', encoding='utf-8') as f:
44	            f.write('Wrong hash')
45	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_file_tools.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	    f = folder1.mkdir('folder1_1').mkdir('folder1_1_1').join('test_file')
128	    f.write('Test file')
129	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_file_tools.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
130	    f = folder1.mkdir('folder1_2').join('test_file')
131	    f.write('Test file')
132	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_file_tools.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
133	    f = folders_with_subdirectories.mkdir('folder2').join('test_file')
134	    f.write('Test file')
135	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_git_client.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	    f = temp_dir.mkdir('component1').join('test_file')
24	    f.write('component1')
25	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_git_client.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	    f = git_repository.mkdir('component2').join('test_file')
41	    f.write('component2')
42	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_git_client.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
70	        with open(config_file, encoding='utf-8') as f:
71	            config = f.read()
72	            assert 'bare = true' in config

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_git_client.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
139	        ('v1.2.3', '1.2.3'),
140	        ('1.2.3.4', '1.2.3~4'),
141	        ('v1.2.3.4', '1.2.3~4'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_lock.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	        test_cmp = [cmp for cmp in lock.dependencies if cmp.name == 'espressif/test_cmp'][0]
84	        assert test_cmp.source.registry_url == 'https://repo.example.com'
85	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_lock.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	                version=ComponentVersion('1.2.7'),
102	                source=WebServiceSource(registry_url='https://repo.example.com'),
103	                # pragma: allowlist nextline secret

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_lock.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	                version=ComponentVersion('1.2.7'),
132	                source=WebServiceSource(registry_url='https://repo.example.com'),
133	                # pragma: allowlist nextline secret

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_lock.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
311	        with open(lock_path) as f:
312	            assert f.read().strip() == file_str
313	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_lock.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
336	                    'source': {
337	                        'service_url': 'https://ohnoIdonthaveinternetconnection.com',
338	                        'type': 'service',
339	                    },
340	                    'version': '3.3.7',
341	                },

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_lock.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
511	        with open(os.path.join(project_dir, 'cmp.c'), 'w') as f:
512	            f.write('File Changed')
513	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_manifest_common_cases.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    assert dep_by_name(manifest, 'espressif/test-4').version == '*'
46	    assert manifest.links.url == 'https://test.com/homepage'
47	    assert manifest.links.documentation == 'https://test.com/documentation'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_manifest_common_cases.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    assert manifest.links.url == 'https://test.com/homepage'
47	    assert manifest.links.documentation == 'https://test.com/documentation'
48	    assert manifest.links.repository == 'git@github.com:test_project/test.git'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_manifest_common_cases.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	    assert manifest.links.repository == 'git@github.com:test_project/test.git'
49	    assert manifest.links.issues == 'https://test.com/tracker'
50	    assert manifest.links.discussion == 'https://discuss.com/discuss'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_manifest_common_cases.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    assert manifest.links.issues == 'https://test.com/tracker'
50	    assert manifest.links.discussion == 'https://discuss.com/discuss'
51	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_manifest_common_cases.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	                'description': 'Some description',
76	                'url': 'https://github.com/espressif/esp-insights/tree/main/components/esp_insights',
77	                'dependencies': {
78	                    'espressif/rmaker_common': {
79	                        'version': '~1.4.0',
80	                        'override_path': '../rmaker/common/',
81	                    },
82	                    'espressif/esp_diag_data_store': {
83	                        'version': '.1.0',
84	                        'override_path': '../esp_diag_data_store/',
85	                        'service_url': '',
86	                    },
87	                    'espressif/esp_diagnostics': {
88	                        'version': '.1.0',
89	                        'override_path': '../esp_diagnostics/',
90	                    },
91	                    'espressif/cbor': {
92	                        'version': '~0.6',
93	                        'rules': [{'if': 'idf_version >=5.0'}],
94	                    },
95	                    'invalid_slug---': {
96	                        'version': '~0.6',
97	                    },
98	                },
99	            },
100	            [
101	                'Invalid field "dependencies:espressif/esp_diag_data_store:service_url": String should have at least 1 character',
102	            ],
103	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_manifest_common_cases.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	                'description': None,
108	                'url': 'https://github.com/espressif/esp-insights/tree/main/components/esp_insights',
109	            },
110	            ['Invalid field "description": Input should be a valid string'],
111	        ),
112	        (
113	            'str',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_mirror_sync.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	def test_prepare_component_all_versions():
76	    client = MultiStorageClient(storage_urls=['http://localhost:9000/test-public/'])
77	    reqs = [ComponentRequirement(name='espressif/test', version='*')]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_mirror_sync.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	def test_prepare_component_versions_with_dependency1():
87	    client = MultiStorageClient(storage_urls=['http://localhost:9000/test-public/'])
88	    reqs = [ComponentRequirement(name='espressif/test', version='==1.0.2')]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_mirror_sync.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	def test_prepare_component_versions_with_dependency2():
98	    client = MultiStorageClient(storage_urls=['http://localhost:9000/test-public/'])
99	    reqs = [ComponentRequirement(name='espressif/test', version='<1.0.2')]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_mirror_sync.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	def test_prepare_component_versions_with_multi_dependencies():
109	    client = MultiStorageClient(storage_urls=['http://localhost:9000/test-public/'])
110	    reqs = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_mirror_sync.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	def test_prepare_component_versions_with_unknown_component(caplog):
122	    client = MultiStorageClient(storage_urls=['http://localhost:9000/test-public/'])
123	    reqs = [ComponentRequirement(name='unknown/component', version='*')]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_misc.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
33	
34	    open(os.path.join(tempdir, 'CMakeLists.txt'), 'w').write('\n')
35	    assert is_component(tmp_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_misc.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
36	
37	    open(os.path.join(tempdir, 'idf_component.yml'), 'w').write('\n')
38	    assert is_component(tmp_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_misc.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	    # CMakeLists.txt with CMAKE_PROJECT_LINE is a project
48	    open(os.path.join(tempdir, 'CMakeLists.txt'), 'w').write(CMAKE_PROJECT_LINE)
49	    assert not is_component(tmp_path)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_prepare_dep_dirs.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        tmp_path,
45	        """
46	        dependencies:
47	            jason-mao/esp_jpeg:  # this one does not exists on production
48	                version: "*"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_prepare_dep_dirs.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	        lock_data['dependencies']['jason-mao/esp_jpeg']['source']['registry_url']
60	        == 'https://components-staging.espressif.com'
61	    )
62	    assert lock_data['dependencies']['jason-mao/esp_jpeg']['source']['type'] == 'service'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_prepare_dep_dirs.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        tmp_path,
89	        """
90	        dependencies:
91	            hfudev/test_comp:  # this one does not exists on production
92	                version: "f1c676d941c560655117382c914adc49f3fe3935"  # pragma: allowlist secret

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_prepare_dep_dirs.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
115	        # Requires BUILD_BOARD env var to be set
116	        """
117	        dependencies:
118	          hfudev/sdl:
119	            version: '57987dd831bb1f7f022eb364f88886a115d053d8'  # pragma: allowlist secret
120	            git: https://github.com/hfudev/esp-idf-component-SDL.git

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_prepare_dep_dirs.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	                'tmp_profile': ProfileItem(
145	                    registry_url='https://notexist.me',
146	                    storage_url='https://notexist.me',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_prepare_dep_dirs.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	                    registry_url='https://notexist.me',
146	                    storage_url='https://notexist.me',
147	                    local_storage_url='file:///tmp/cache',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	def service_config():
28	    return Config().profiles.get('default', {})
29	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
34	    with open(config_path, 'w+') as f:
35	        f.write(
36	            json.dumps({
37	                'profiles': {
38	                    'default': {
39	                        'registry_url': 'https://default.com/',
40	                        'default_namespace': 'default_ns',
41	                        'api_token': None,
42	                    },
43	                    'test': {
44	                        'registry_url': 'https://example.com/',
45	                        'default_namespace': 'test',
46	                        'api_token': 'token',
47	                    },
48	                    'test2': {
49	                        'registry_url': 'https://example2.com/',
50	                        'default_namespace': 'test2',
51	                        'api_token': 'token',
52	                    },
53	                    'test3': {
54	                        'registry_url': 'https://example3.com/',
55	                        'default_namespace': 'test3',
56	                        'api_token': 'token',
57	                    },
58	                    'emptyprofile': None,
59	                }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	                    'default': {
39	                        'registry_url': 'https://default.com/',
40	                        'default_namespace': 'default_ns',
41	                        'api_token': None,
42	                    },
43	                    'test': {
44	                        'registry_url': 'https://example.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	                    'test': {
44	                        'registry_url': 'https://example.com/',
45	                        'default_namespace': 'test',
46	                        'api_token': 'token',
47	                    },
48	                    'test2': {
49	                        'registry_url': 'https://example2.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	                    'test2': {
49	                        'registry_url': 'https://example2.com/',
50	                        'default_namespace': 'test2',
51	                        'api_token': 'token',
52	                    },
53	                    'test3': {
54	                        'registry_url': 'https://example3.com/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	                    'test3': {
54	                        'registry_url': 'https://example3.com/',
55	                        'default_namespace': 'test3',
56	                        'api_token': 'token',
57	                    },
58	                    'emptyprofile': None,
59	                }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        profile = get_profile('test', config_path)
68	        assert profile.registry_url == 'https://example.com/'
69	        assert profile.default_namespace == 'test'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        profile = get_profile('default', config_path)
95	        assert profile.registry_url == 'https://default.com/'
96	        assert profile.default_namespace == 'default_ns'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
101	        with open(config_path, 'w+') as f:
102	            f.write(
103	                json.dumps({
104	                    'profiles': {
105	                        'default': {
106	                            'registry_url': 'foo',
107	                            'storage_url': [
108	                                'http://test.me',
109	                                'bar',
110	                            ],
111	                            'local_storage_url': 'foo',
112	                        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	                            'storage_url': [
108	                                'http://test.me',
109	                                'bar',
110	                            ],
111	                            'local_storage_url': 'foo',
112	                        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	        client = get_storage_client(profile_name='test', namespace='test', config_path=config_path)
168	        assert client.registry_url == 'https://example.com/'
169	        assert client.default_namespace == 'test'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	
184	        assert client.registry_url == 'https://example.com/'
185	        assert client.storage_urls == []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	            client.registry_storage_client.storage_url
192	            == requests.get(IDF_COMPONENT_STAGING_REGISTRY_URL + '/api').json()[
193	                'components_base_url'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
199	            registry_url=IDF_COMPONENT_STAGING_REGISTRY_URL,
200	            storage_urls=['https://something.else'],
201	            local_storage_urls=['file://local1', 'file://local2'],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	        assert client.storage_clients[1].storage_url == 'file://local2'
206	        assert client.storage_clients[2].storage_url == 'https://something.else'
207	        assert (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/idf_component_manager-2.1.2/idf_component_manager-2.1.2/tests/test_profile.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
208	            client.storage_clients[3].storage_url
209	            == requests.get(IDF_COMPONENT_STAGING_REGISTRY_URL + '/api').json()[
210	                'components_base_url'

--------------------------------------------------

Code scanned:
	Total lines of code: 13496
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 94.0
		High: 83.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 176.0
		High: 1.0
Files skipped (0):
