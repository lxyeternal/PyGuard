Run started:2025-04-12 18:14:38.770011

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/__version__.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	__url__ = "https://opendatalab.org.cn"
11	__version__ = "0.0.10"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/__version__.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	odl_clientId = "kmz3bkwzlaa3wrq8pvwa"
14	uaa_url_prefix = "https://sso.openxlab.org.cn/gw/uaa-be"
15	# clientSecret: 97gdrvwwzob86q2rneq2x95w6bnxkpqj5oak1ype

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/cli/utility.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	        self.latest_version = None
39	        self.warning = "[red]WARNING[/red]:This CLI tool is deprecated and will be removed in a future release.\nThe [bold yellow]opendatalab(odl)[/bold yellow] pkg has been deprecated and will no longer be supported in few weeks.\nWe recommend that you switch to the [bold yellow]openxlab[/bold yellow] pkg, which accept same username/password,\nprovides the same functionality and other enhanced AI friendly features.\nMore details please refer to [blue]https://openxlab.org.cn/datasets[/blue]\n"
40	        rprint(self.warning)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	                "prefix":prefix}
41	        resp = requests.get(
42	            url = f"{self.host}/api/datasets/{dataset_name}/files",
43	            params = data,
44	            headers = header_dict
45	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
73	        """
74	        resp = requests.post(
75	            f"{self.host}/api/track/datasets/download/{dataset_id}",
76	            data = json.dumps(dataset_list),
77	            headers={
78	                    "Content-Type": "application/json",
79	                    "Cookie": f"opendatalab_session={self.odl_cookie}",
80	                    "User-Agent": f"opendatalab-python-sdk/{__version__}",
81	                    "accept": "application/json"
82	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	        """
101	        resp = requests.get(
102	            f"{self.host}/api/datasets/{dataset_id}/downloadAuth",
103	            headers= {
104	                "X-OPENDATALAB-API-TOKEN": self.token,
105	                "Cookie": f"opendatalab_session={self.odl_cookie}",
106	                "User-Agent": UUID,
107	                "accept" : "application/json"
108	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	        data = {"expires": expires, }
132	        resp = requests.get(
133	            url=f"{self.host}/api/datasets/{dataset}/sts",
134	            params=data,
135	            headers={
136	                "X-OPENDATALAB-API-TOKEN": self.token,
137	                "Cookie": f"opendatalab_session={self.odl_cookie}",
138	                "User-Agent": UUID,
139	            }, )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
157	    def search_dataset(self, keywords):
158	        resp = requests.post(  # f"{self.host}/api/datasets/?pageSize=25&keywords={keywords}",
159	            f"{self.host}/api/datasets/list",
160	            headers={"X-OPENDATALAB-API-TOKEN": self.token,
161	                     "Cookie": f"opendatalab_session={self.odl_cookie}",
162	                     "User-Agent": f"opendatalab-python-sdk/{__version__}",
163	                     "Content-Type": "application/json"
164	                     },
165	            data=json.dumps({
166	                "backend": False,
167	                "keywords": keywords,
168	                "pageSize": 25,
169	                "state": ["online"],
170	            })

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	        dataset_id = int(self.get_info(dataset)['id'])
186	        resp = requests.get(
187	            f"{self.host}/api/datasets/{dataset_id}/similar",
188	            headers={"X-OPENDATALAB-API-TOKEN": self.token,
189	                     "Cookie": f"opendatalab_session={self.odl_cookie}",
190	                     "User-Agent": f"opendatalab-python-sdk/{__version__}",
191	                     "Content-Type": "application/json"
192	                     },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	    def get_info(self, dataset):
201	        resp = requests.get(
202	            f"{self.host}/api/datasets/{dataset}?backend=false",
203	            headers={"X-OPENDATALAB-API-TOKEN": self.token,
204	                     "Cookie": f"opendatalab_session={self.odl_cookie}",
205	                     "User-Agent": f"opendatalab-python-sdk/{__version__}",
206	                     "Content-Type": "application/json"
207	                     },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
223	
224	        resp = requests.post(
225	            f"{self.host}/api/track/datasets/download/{dataset_id}",
226	            data=data,
227	            headers={"Content-Type": "application/json",
228	                     "Cookie": f"opendatalab_session={self.odl_cookie}",
229	                     "User-Agent": f"opendatalab-python-sdk/{__version__}",
230	                     "Content-Type": "application/json"
231	                     },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	        dataset_id = int(self.get_info(dataset)['id'])
239	        resp = requests.get(
240	            f"{self.host}/api/datasets/{dataset_id}/download",
241	            headers={"Content-Type": "application/json",
242	                     "Cookie": f"opendatalab_session={self.odl_cookie}",
243	                     "User-Agent": f"opendatalab-python-sdk/{__version__}",
244	                     "Content-Type": "application/json"
245	                     },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
287	
288	        resp = requests.post(
289	            f"{self.host}/api/users/auth",
290	            data=data,
291	            headers={"Content-Type": "application/json"},
292	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/api.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
304	    def check_version(self):
305	        resp = requests.get(
306	            f"{self.host}/api/sdk/checkVersion",
307	            headers={"Content-Type": "application/json"},
308	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	        }
29	        req = requests.get(self.url, stream=True, headers=header)
30	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
35	                        break
36	                    cache.write(chunk)
37	                    self.range_curser += len(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
43	    def start(self):
44	        threading.Thread(target=self.__run).start()
45	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	            self.__download_record = []
108	            threading.Thread(target=self.__supervise).start()
109	            # main

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	            # content_length = req.headers["Content-Length"]
121	            resp = requests.get(self.url,stream=True)
122	            content_length = resp.headers["Content-Length"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
345	                with open(cache_filename, "rb") as cache_file:
346	                    data = cache_file.read(chunk_size)
347	                    while data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
347	                    while data:
348	                        f.write(data)
349	                        f.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
349	                        f.flush()
350	                        data = cache_file.read(chunk_size)
351	        self.clear()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
355	    def __whistleblower(self, saying: str):
356	        sys.stdout.write(saying)
357	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
362	        with open(filename, "rb") as f:
363	            data = f.read(chunk_size)
364	            while data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/downloader.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
365	                md5.update(data)
366	                data = f.read(chunk_size)
367	        return md5.hexdigest()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/uaa.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
28	    data = json.dumps(public_param)
29	    resp = requests.post(url=public_key_url,
30	                         data=data,
31	                         headers={"Content-Type": "application/json"}
32	                         )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/uaa.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
42	    public_key = get_public_key()
43	    key = b64decode(public_key)
44	    key = RSA.importKey(key)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/uaa.py:43
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
42	    public_key = get_public_key()
43	    key = b64decode(public_key)
44	    key = RSA.importKey(key)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/uaa.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
46	    cipher = PKCS1_v1_5.new(key)
47	    cipher_text = b64encode(cipher.encrypt(bytes(content, 'utf-8')))
48	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/uaa.py:47
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
46	    cipher = PKCS1_v1_5.new(key)
47	    cipher_text = b64encode(cipher.encrypt(bytes(content, 'utf-8')))
48	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/uaa.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
61	
62	    resp = requests.post(url=login_url,
63	                         data=data,
64	                         headers={"Content-Type": "application/json"}
65	                         )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/uaa.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
85	    if authorization:
86	        resp = requests.post(url=user_info_url,
87	                             headers={
88	                                 "Authorization": f"{authorization}",
89	                             }

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/opendatalab/client/uaa.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
103	
104	        resp = requests.post(url=auth_url,
105	                             data=data,
106	                             headers={
107	                                 "Content-Type": "application/json",
108	                                 "Cookie": f"ssouid={sso_uid}",
109	                             }

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/setup.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
9	) as f:
10	    exec(f.read(), about)
11	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/setup.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
9	) as f:
10	    exec(f.read(), about)
11	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12	with open("README.md", "r", encoding="utf-8") as fh:
13	    long_description = fh.read()
14	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/opendatalab-0.0.10/opendatalab-0.0.10/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    project_urls={
18	        "Bug Tracker": "https://github.com/opendatalab/opendatalab-python-sdk/issues",
19	    },
20	)

--------------------------------------------------

Code scanned:
	Total lines of code: 1590
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 30.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 3.0
Files skipped (0):
