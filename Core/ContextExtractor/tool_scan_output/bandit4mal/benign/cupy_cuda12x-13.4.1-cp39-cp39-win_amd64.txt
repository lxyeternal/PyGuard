Run started:2025-04-12 18:28:32.766275

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/__init__.py:899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
898	    """Prints the current runtime configuration to standard output."""
899	    _sys.stdout.write(str(_cupyx.get_runtime_info(full=_full)))
900	    _sys.stdout.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/_environment.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	    if _debug:
71	        sys.stderr.write(f'[CUPY_DEBUG_LIBRARY_LOAD] {msg}\n')
72	        sys.stderr.flush()

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/_environment.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
360	                # Keep reference to the preloaded module.
361	                _preload_libs[lib][libpath] = ctypes.CDLL(libpath)
362	                _log('Loaded')

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/_environment.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
377	            try:
378	                _preload_libs[lib][filename] = ctypes.CDLL(filename)
379	                _log('Loaded')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/_environment.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
540	        cupy_packages_list = ', '.join(sorted(cupy_installed))
541	        warnings.warn(f'''
542	--------------------------------------------------------------------------------
543	
544	  CuPy may not function correctly because multiple CuPy packages are installed
545	  in your environment:
546	
547	    {cupy_packages_list}
548	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/_environment.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
570	    # TODO(kmaehashi): provide better diagnostics.
571	    msg = '''\
572	Failed to import CuPy.
573	
574	If you installed CuPy via wheels (cupy-cudaXXX or cupy-rocm-X-X), make sure that the package matches with the version of CUDA or ROCm installed.
575	
576	On Linux, you may need to set LD_LIBRARY_PATH environment variable depending on how you installed CUDA/ROCm.
577	On Windows, try setting CUDA_PATH environment variable.
578	
579	Check the Installation Guide for details:
580	  https://docs.cupy.dev/en/latest/install.html'''  # NOQA
581	
582	    if sys.platform == 'win32':

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/_environment.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
599	    from ctypes import wintypes
600	    kernel32 = ctypes.CDLL('kernel32')
601	    kernel32.GetModuleFileNameW.argtypes = [

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/_environment.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
614	        try:
615	            dll = ctypes.CDLL(name)
616	            kernel32.GetModuleFileNameW(dll._handle, filepath, len(filepath))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	        if log_stream is not None:
70	            log_stream.write(log)
71	        return log

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
69	        if log_stream is not None:
70	            log_stream.write(log)
71	        return log

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
374	            with open(cu_path, 'w') as cu_file:
375	                cu_file.write(source)
376	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
374	            with open(cu_path, 'w') as cu_file:
375	                cu_file.write(source)
376	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
412	        with open(cu_path, 'w') as cu_file:
413	            cu_file.write(source)
414	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
412	        with open(cu_path, 'w') as cu_file:
413	            cu_file.write(source)
414	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
464	            with open(result_path, 'rb') as ptx_file:
465	                return ptx_file.read()
466	        elif code_type == 'cubin':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
467	            with open(result_path, 'rb') as bin_file:
468	                return bin_file.read()
469	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
606	            with open(path, 'rb') as file:
607	                data = file.read()
608	            if len(data) >= _hash_length:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
652	        with tempfile.NamedTemporaryFile(dir=cache_dir, delete=False) as tf:
653	            tf.write(cubin_hash)
654	            tf.write(cubin)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
652	        with tempfile.NamedTemporaryFile(dir=cache_dir, delete=False) as tf:
653	            tf.write(cubin_hash)
654	            tf.write(cubin)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
653	            tf.write(cubin_hash)
654	            tf.write(cubin)
655	            temp_path = tf.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
653	            tf.write(cubin_hash)
654	            tf.write(cubin)
655	            temp_path = tf.name

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
660	            with open(path + '.cu', 'w') as f:
661	                f.write(source)
662	    else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
660	            with open(path + '.cu', 'w') as f:
661	                f.write(source)
662	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
696	        linum_fmt = '{{:0{}d}} '.format(digits)
697	        f.write('{} '.format(self.backend.upper()))
698	        f.write('compilation error: {}\n'.format(self))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
696	        linum_fmt = '{{:0{}d}} '.format(digits)
697	        f.write('{} '.format(self.backend.upper()))
698	        f.write('compilation error: {}\n'.format(self))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:698
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
697	        f.write('{} '.format(self.backend.upper()))
698	        f.write('compilation error: {}\n'.format(self))
699	        f.write('-----\n')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:698
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
697	        f.write('{} '.format(self.backend.upper()))
698	        f.write('compilation error: {}\n'.format(self))
699	        f.write('-----\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
698	        f.write('compilation error: {}\n'.format(self))
699	        f.write('-----\n')
700	        f.write('Name: {}\n'.format(self.name))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
698	        f.write('compilation error: {}\n'.format(self))
699	        f.write('-----\n')
700	        f.write('Name: {}\n'.format(self.name))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
699	        f.write('-----\n')
700	        f.write('Name: {}\n'.format(self.name))
701	        f.write('Options: {}\n'.format(' '.join(self.options)))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
699	        f.write('-----\n')
700	        f.write('Name: {}\n'.format(self.name))
701	        f.write('Options: {}\n'.format(' '.join(self.options)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
700	        f.write('Name: {}\n'.format(self.name))
701	        f.write('Options: {}\n'.format(' '.join(self.options)))
702	        f.write('CUDA source:\n')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
700	        f.write('Name: {}\n'.format(self.name))
701	        f.write('Options: {}\n'.format(' '.join(self.options)))
702	        f.write('CUDA source:\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
701	        f.write('Options: {}\n'.format(' '.join(self.options)))
702	        f.write('CUDA source:\n')
703	        for i, line in enumerate(lines):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
701	        f.write('Options: {}\n'.format(' '.join(self.options)))
702	        f.write('CUDA source:\n')
703	        for i, line in enumerate(lines):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
703	        for i, line in enumerate(lines):
704	            f.write(linum_fmt.format(i + 1) + line.rstrip() + '\n')
705	        f.write('-----\n')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
703	        for i, line in enumerate(lines):
704	            f.write(linum_fmt.format(i + 1) + line.rstrip() + '\n')
705	        f.write('-----\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
704	            f.write(linum_fmt.format(i + 1) + line.rstrip() + '\n')
705	        f.write('-----\n')
706	        f.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
704	            f.write(linum_fmt.format(i + 1) + line.rstrip() + '\n')
705	        f.write('-----\n')
706	        f.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
743	            if log_stream is not None:
744	                log_stream.write(nvrtc.getProgramLog(self.ptr))
745	            # This is to ensure backwards compatibility with nvrtc

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
743	            if log_stream is not None:
744	                log_stream.write(nvrtc.getProgramLog(self.ptr))
745	            # This is to ensure backwards compatibility with nvrtc

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
775	        with open(in_path, 'w') as f:
776	            f.write(source)
777	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
775	        with open(in_path, 'w') as f:
776	            f.write(source)
777	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
798	        with open(out_path, 'rb') as f:
799	            return f.read()
800	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
810	        with open(cu_path, 'w') as cu_file:
811	            cu_file.write(source)
812	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
810	        with open(cu_path, 'w') as cu_file:
811	            cu_file.write(source)
812	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
945	            with open(path, 'rb') as f:
946	                data = f.read()
947	            if len(data) >= _hash_length:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
976	        with tempfile.NamedTemporaryFile(dir=cache_dir, delete=False) as tf:
977	            tf.write(binary_hash)
978	            tf.write(binary)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
976	        with tempfile.NamedTemporaryFile(dir=cache_dir, delete=False) as tf:
977	            tf.write(binary_hash)
978	            tf.write(binary)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
977	            tf.write(binary_hash)
978	            tf.write(binary)
979	            temp_path = tf.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
977	            tf.write(binary_hash)
978	            tf.write(binary)
979	            temp_path = tf.name

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:985
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
984	            with open(path + '.cpp', 'w') as f:
985	                f.write(source)
986	    else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/compiler.py:985
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
984	            with open(path + '.cpp', 'w') as f:
985	                f.write(source)
986	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/memory_hooks/line_profile.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	        line = '_root (%s, %s)\n' % self._root.humanized_bytes()
100	        file.write(line)
101	        for child in self._root.children:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupy/cuda/memory_hooks/line_profile.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	            used_bytes, acquired_bytes)
112	        file.write(line)
113	        for child in memory_frame.children:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/_runtime.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
339	        for k, v in records:
340	            s.write(fmt.format(k, v))
341	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/cusparse.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
156	    if isinstance(x, dict):
157	        os_name = _platform.system()
158	        if os_name not in x:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/cusparse.py:157
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
156	    if isinstance(x, dict):
157	        os_name = _platform.system()
158	        if os_name not in x:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
11	
12	_DEFAULT_HOST = '127.0.0.1'
13	_DEFAULT_PORT = 13333

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
32	            super().run()
33	            self._child_p.send(None)
34	        except Exception as e:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
34	        except Exception as e:
35	            self._child_p.send(e)
36	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
39	        if self._parent_p.poll():
40	            exception = self._parent_p.recv()
41	            if exception is not None:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
66	            # Receive in KLV format
67	            action_bytes = c_socket.recv(sizeof(_klv_utils.action_t))
68	            if len(action_bytes) > 0:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
74	                if r is not None:
75	                    c_socket.sendall(r.klv())
76	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
79	        # a single connection allows to implement locking mechanics easily
80	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
81	            s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
83	            s.listen()
84	            s.settimeout(0.5)
85	            while self._run.value == 1:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
97	        # Run the TCP store in a different process
98	        p = ExceptionAwareProcess(
99	            target=self._server_loop, args=(host, port))
100	        p.start()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:127
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
126	            try:
127	                with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
128	                    # TODO retry connects

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
128	                    # TODO retry connects
129	                    s.connect((self.host, self.port))
130	                    s.sendall(action.klv())

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
129	                    s.connect((self.host, self.port))
130	                    s.sendall(action.klv())
131	                    result_bytes = s.recv(sizeof(

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
130	                    s.sendall(action.klv())
131	                    result_bytes = s.recv(sizeof(
132	                        _klv_utils.result_action_t))
133	                    if len(result_bytes) > 0:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
145	    def __getitem__(self, key):
146	        return self._send_recv(_store_actions.Get(key))
147	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
148	    def __setitem__(self, key, value):
149	        self._send_recv(_store_actions.Set(key, value))
150	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/distributed/_store.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
152	        # Barrier has special semantics
153	        self._send_recv(_store_actions.Barrier())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/jit/_builtin_funcs.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	        self._dtypes = dtypes
229	        doc = f"""Calls the ``{self._name}`` function to operate atomically on
230	        ``array[index]``. Please refer to `Atomic Functions`_ for detailed

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/jit/_builtin_funcs.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
355	        self._dtypes = dtypes
356	        doc = f"""Calls the ``{self._name}`` function. Please refer to
357	        `Warp Shuffle Functions`_ for detailed explanation.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/optimizing/_optimize.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	        raise RuntimeError(
87	            'Optuna is required to run optimization. '
88	            'See https://optuna.org/ for the installation instructions.')
89	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/scipy/special/_basic.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
102	
103	cosm1_implementation = """
104	//Define from npy_math.h
105	//https://github.com/numpy/numpy/blob/main/numpy/core/include/numpy/npy_math.h
106	#define NPY_PI_4      0.785398163397448309615660845819875721  /* pi/4 */
107	__constant__ double coscof[] = {
108	    4.7377507964246204691685E-14,
109	    -1.1470284843425359765671E-11,
110	    2.0876754287081521758361E-9,
111	    -2.7557319214999787979814E-7,
112	    2.4801587301570552304991E-5,
113	    -1.3888888888888872993737E-3,
114	    4.1666666666666666609054E-2,
115	};
116	
117	__device__ static double polevl(double x, const double coef[], int N)
118	{
119	    double ans;
120	    int i;
121	    const double *p;
122	
123	    p = coef;
124	    ans = *p++;
125	    i = N;
126	
127	    do
128	        ans = ans * x + *p++;
129	    while (--i);
130	
131	    return (ans);
132	}
133	
134	__device__ static double cosm1(double x)
135	{
136	    double xx;
137	
138	    if ((x < -NPY_PI_4) || (x > NPY_PI_4))
139	        return (cos(x) - 1.0);
140	    xx = x * x;
141	    xx = -0.5 * xx + xx * xx * polevl(xx, coscof, 6);
142	    return xx;
143	}
144	"""
145	
146	cosm1 = _core.create_ufunc(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/scipy/special/_lpmv.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	
33	lpmv_definition = """
34	
35	// include for CUDART_NAN, CUDART_INF
36	#include <cupy/math_constants.h>
37	
38	// CUDA C++ translation of code from:
39	// https://github.com/scipy/scipy/blob/master/scipy/special/specfun/specfun.f
40	
41	/*
42	 *  Purpose: Compute Psi function
43	 *   Input :  x  --- Argument of psi(x)
44	 */
45	__device__ double psi_spec(double x)
46	{
47	    double xa = fabs(x);
48	    double PI = 3.1415926535897930;
49	    double EL = 0.5772156649015329;  // Euler-Mascheroni constant
50	    double s = 0.;
51	    double ps;
52	    int n = 0;
53	    if ((x - (int)x == 0.) && (x <= 0.))
54	    {
55	        return CUDART_INF;
56	    } else if (xa - (int)xa == 0.) {
57	        n = (int) xa;
58	        for (int k=1; k <= n - 1; k++)
59	        {
60	           s += 1.0/k;
61	        }
62	        ps = -EL + s;
63	    } else if ((xa - 0.5) - (int)(xa - 0.5) == 0.) {
64	        n = (int)(xa - 0.5);
65	        for (int k=1; k <= n; k++)
66	        {
67	           s += 1.0/(2.0*k - 1.0);
68	        }
69	        ps = -EL + 2.0 * s - 1.386294361119891;
70	    } else {
71	        if (xa < 10.0)
72	        {
73	            n = 10 - (int)(xa);
74	            for (int k=1; k < n; k++)
75	            {
76	               s += 1.0/(xa + k);
77	            }
78	            xa += (double)n;
79	        }
80	        double x2 = 1.0 / (xa*xa);
81	        double a1 = -.8333333333333e-01;
82	        double a2 = .83333333333333333e-02;
83	        double a3 = -.39682539682539683e-02;
84	        double a4 = .41666666666666667e-02;
85	        double a5 = -.75757575757575758e-02;
86	        double a6 = .21092796092796093e-01;
87	        double a7 = -.83333333333333333e-01;
88	        double a8 = .44325980392156860;
89	        ps = log(xa) - 0.5/xa + x2*(((((((a8*x2 + a7)*x2 +
90	             a6)*x2 + a5)*x2 + a4)*x2 + a3)*x2 + a2)*x2 + a1);
91	        ps -= s;
92	    }
93	    if (x < 0.) {
94	        ps = ps - PI*cos(PI*x)/sin(PI*x) - 1.0/x;
95	    }
96	    return ps;
97	}
98	
99	
100	/*
101	 *       Purpose: Compute gamma function Gamma(x)
102	 *       Input :  x  --- Argument of Gamma(x)
103	 *                      ( x is not equal to 0,-1,-2,...)
104	 *       Output:  GA --- Gamma(x)
105	 */
106	__device__ double gamma2(double x)
107	{
108	    double ga;
109	    double G[26] = {1.0, 0.5772156649015329,
110	                   -0.6558780715202538, -0.420026350340952e-1,
111	                    0.1665386113822915,-.421977345555443e-1,
112	                    -.96219715278770e-2, .72189432466630e-2,
113	                    -.11651675918591e-2, -.2152416741149e-3,
114	                     .1280502823882e-3, -.201348547807e-4,
115	                    -.12504934821e-5, .11330272320e-5,
116	                    -.2056338417e-6, .61160950e-8,
117	                     .50020075e-8, -.11812746e-8,
118	                     .1043427e-9, .77823e-11,
119	                    -.36968e-11, .51e-12,
120	                    -.206e-13, -.54e-14, .14e-14, .1e-15};
121	    double PI = 3.141592653589793;
122	    int k;
123	    if ((x - (int)x) == 0.)
124	    {
125	        if (x > 0.)
126	        {
127	            ga = 1.0;
128	            for (k=2; k < x; k++)
129	            {
130	                ga *= k;
131	            }
132	        } else
133	        {
134	            ga = CUDART_INF;
135	        }
136	    }
137	    else
138	    {
139	        double r = 1.0;
140	        double z = fabs(x);
141	        if (z > 1.0){
142	            int m = (int)z;
143	            for (k=1; k<=m; k++)
144	            {
145	                r *= (z - k);
146	            }
147	            z -= m;
148	        } else {
149	            z = x;
150	        }
151	        double gr = G[24];
152	        for (k=25; k>=1; k--)
153	        {
154	            gr = gr*z + G[k];
155	        }
156	        ga = 1.0 / (gr * z);
157	        if (fabs(x) > 1.0)
158	        {
159	            ga *= r;
160	            if (x < 0.0)
161	            {
162	                ga = -PI / (x*ga*sin(PI*x));
163	            }
164	        }
165	    }
166	    return ga;
167	}
168	
169	
170	/*
171	 *     Purpose: Compute the associated Legendre function
172	 *              Pmv(x) with an integer order and an arbitrary
173	 *              nonnegative degree v
174	 *     Input :  x   --- Argument of Pm(x)  ( -1 <= x <= 1 )
175	 *              m   --- Order of Pmv(x)
176	 *              v   --- Degree of Pmv(x)
177	 */
178	__device__ double lpmv0(double v, double m, double x)
179	{
180	    double pmv, r;
181	    int j, k;
182	
183	    double PI = 3.141592653589793;
184	    double EL = .5772156649015329;  // Euler-Mascheroni constant
185	    double EPS = 1.0e-14;
186	    int nv = (int)v;
187	    double v0 = v - nv;
188	    if ((x == -1.0) && (v != nv))
189	    {
190	        if (m == 0)
191	            return -CUDART_INF;
192	        else
193	            return CUDART_INF;
194	    }
195	    double c0 = 1.0;
196	    if (m != 0)
197	    {
198	        double rg = v*(v + m);
199	        for (j=1; j < m; j++)
200	        {
201	            rg *= (v*v - j*j);
202	        }
203	        double xq = sqrt(1.0 - x*x);
204	
205	        double r0 = 1.0;
206	        for (j=1; j <= m; j++)
207	        {
208	            r0 *= 0.5*xq/j;
209	        }
210	        c0 = r0*rg;
211	    }
212	    if (v0 == 0.)
213	    {
214	        // DLMF 14.3.4, 14.7.17, 15.2.4
215	        pmv = 1.0;
216	        r = 1.0;
217	        for (k=1; k <= nv - m; k++)
218	        {
219	            r *= 0.5*(-nv + m + k - 1.0)*(nv + m + k)/(k*(k + m))*(1.0 + x);
220	            pmv += r;
221	        }
222	        pmv *= c0;
223	        if ((nv % 2) == 1)
224	        {
225	            pmv = -pmv;
226	        }
227	    }
228	    else
229	    {
230	        if (x >= -0.35)
231	        {
232	            // DLMF 14.3.4, 15.2.1
233	            pmv = 1.0;
234	            r = 1.0;
235	            for (k = 1; k <= 100; k++)
236	            {
237	                 r *= 0.5*(-v + m + k - 1.0)*(v + m + k)/(k*(m + k))*(1.0 - x);
238	                 pmv += r;
239	                 if ((k > 12) & (fabs(r/pmv) < EPS)){
240	                    break;
241	                 }
242	
243	            }
244	            pmv *= c0;
245	            if (((int)m % 2) == 1)
246	            {
247	                pmv = -pmv;
248	            }
249	        }
250	        else
251	        {
252	            // DLMF 14.3.5, 15.8.10
253	            double vs = sin(v * PI) / PI;
254	            double pv0 = 0.0;
255	            double r2;
256	            if (m != 0)
257	            {
258	                double qr = sqrt((1.0 - x)/(1.0 + x));
259	                r2 = 1.0;
260	                for (j = 1; j <= m; j++)
261	                {
262	                    r2 *= qr*j;
263	                }
264	                double s0 = 1.0;
265	                double r1 = 1.0;
266	                for (k = 1; k < m; k++)
267	                {
268	                    r1=0.5*r1*(-v + k - 1)*(v + k)/(k*(k - m))*(1.0 + x);
269	                    s0 += r1;
270	                }
271	                pv0 = -vs*r2/m*s0;
272	            }
273	            double psv = psi_spec(v);
274	            double pa = 2.0*(psv + EL) + PI/tan(PI*v) + 1.0/v;
275	            double s1 = 0.0;
276	            for (j = 1; j <= m; j++)
277	            {
278	                s1 += (j*j + v*v)/(j*(j*j - v*v));
279	            }
280	            pmv = pa + s1 - 1.0/(m - v) + log(0.5*(1.0 + x));
281	            r = 1.0;
282	            for (k = 1; j <= 100; k++)
283	            {
284	                r *= 0.5*(-v + m + k-1.0)*(v + m + k)/(k*(k + m))*(1.0 + x);
285	                double s = 0.0;
286	                for (j = 1; j <= m; j++)
287	                {
288	                    double kjsq = (k + j) * (k + j);
289	                    s += (kjsq + v*v)/((k + j)*(kjsq - v*v));
290	                }
291	                double s2 = 0.0;
292	                for (j = 1; j <= k; j++)
293	                {
294	                    s2 += 1.0/(j*(j*j - v*v));
295	                }
296	                double pss = pa + s + 2.0*v*v*s2 - 1.0/(m + k - v)
297	                             + log(0.5*(1.0 + x));
298	                r2 = pss*r;
299	                pmv += r2;
300	                if (fabs(r2/pmv) < EPS)
301	                {
302	                    break;
303	                }
304	            }
305	            pmv = pv0 + pmv*vs*c0;
306	        }
307	    }
308	    return pmv;
309	}
310	
311	
312	/*       Purpose: Compute the associated Legendre function
313	 *                Pmv(x) with an integer order and an arbitrary
314	 *                degree v, using recursion for large degrees
315	 *       Input :  x   --- Argument of Pm(x)  ( -1 <= x <= 1 )
316	 *                m   --- Order of Pmv(x)
317	 *                v   --- Degree of Pmv(x)
318	 *       Output:  PMV --- Pmv(x)
319	 */
320	__device__ double lpmv(double v, int m, double x)
321	{
322	    double pmv;
323	    int j;
324	
325	    if ((x == -1.0) && (v != (int)v))
326	    {
327	        if (m == 0)
328	        {
329	            return -CUDART_INF;
330	        } else
331	        {
332	            return CUDART_INF;
333	        }
334	    }
335	
336	    double vx = v;
337	    double mx = m;
338	    // DLMF 14.9.5
339	    if (v < 0)
340	    {
341	        vx = -vx - 1;
342	    }
343	    int neg_m = 0;
344	    if (m < 0)
345	    {
346	        if (((vx + m + 1) > 0) || (vx != (int)vx))
347	        {
348	            neg_m = 1;
349	            mx = -m;
350	        }
351	        else
352	        {
353	            // We don't handle cases where DLMF 14.9.3 doesn't help
354	            return CUDART_NAN;
355	        }
356	    }
357	
358	    int nv = (int)vx;
359	    double v0 = vx - nv;
360	    if ((nv > 2) && (nv > mx))
361	    {
362	        // Up-recursion on degree, AMS 8.5.3 / DLMF 14.10.3
363	        double p0 = lpmv0(v0 + mx, mx, x);
364	        double p1 = lpmv0(v0 + mx + 1, mx, x);
365	        pmv = p1;
366	        for (j = mx + 2; j <= nv; j++)
367	        {
368	          pmv = ((2*(v0 + j) - 1)*x*p1 - (v0 + j - 1 + mx)*p0) / (v0 + j - mx);
369	          p0 = p1;
370	          p1 = pmv;
371	        }
372	    }
373	    else
374	    {
375	        pmv = lpmv0(vx, mx, x);
376	    }
377	
378	    if ((neg_m != 0) && (fabs(pmv) < 1.0e300))
379	    {
380	        double g1 = gamma2(vx - mx + 1);
381	        double g2 = gamma2(vx + mx + 1);
382	        pmv = pmv * g1/g2 * pow(-1, mx);
383	    }
384	    return pmv;
385	}
386	
387	
388	// pmv_wrap as in
389	// https://github.com/scipy/scipy/blob/master/scipy/special/specfun_wrappers.c
390	
391	__device__  double pmv_wrap(double m, double v, double x){
392	  int int_m;
393	  double out;
394	
395	  if (m != floor(m))
396	  {
397	      return CUDART_NAN;
398	  }
399	  int_m = (int) m;
400	  out = lpmv(v, int_m, x);
401	  // should raise an overflow warning here on INF
402	  return out;
403	}
404	
405	"""
406	
407	lpmv = _core.create_ufunc(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/scipy/special/_zeta.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	
14	zeta_definition = '''
15	/* Expansion coefficients
16	 * for Euler-Maclaurin summation formula
17	 * (2k)! / B2k
18	 * where B2k are Bernoulli numbers
19	 */
20	__constant__ double A[] = {
21	    12.0,
22	    -720.0,
23	    30240.0,
24	    -1209600.0,
25	    47900160.0,
26	    -1.8924375803183791606e9,	/*1.307674368e12/691 */
27	    7.47242496e10,
28	    -2.950130727918164224e12,	/*1.067062284288e16/3617 */
29	    1.1646782814350067249e14,	/*5.109094217170944e18/43867 */
30	    -4.5979787224074726105e15,	/*8.028576626982912e20/174611 */
31	    1.8152105401943546773e17,	/*1.5511210043330985984e23/854513 */
32	    -7.1661652561756670113e18	/*1.6938241367317436694528e27/236364091 */
33	};
34	
35	__constant__ double MACHEP = 1.11022302462515654042E-16;
36	
37	/* 30 Nov 86 -- error in third coefficient fixed */
38	
39	
40	double __device__ zeta(double x, double q)
41	{
42	    int i;
43	    double a, b, k, s, t, w;
44	
45	    if (x == 1.0){
46	        return 1.0/0.0;
47	    }
48	
49	    if (x < 1.0) {
50	        return nan("");
51	    }
52	
53	    if (q <= 0.0) {
54	        if (q == floor(q)) {
55	            return 1.0/0.0;
56	        }
57	        if (x != floor(x)){
58	            return nan("");	/* because q^-x not defined */
59	        }
60	    }
61	
62	    /* Asymptotic expansion
63	     * http://dlmf.nist.gov/25.11#E43
64	     */
65	    if (q > 1e8) {
66	        return (1/(x - 1) + 1/(2*q)) * pow(q, 1 - x);
67	    }
68	
69	    /* Euler-Maclaurin summation formula */
70	
71	    /* Permit negative q but continue sum until n+q > +9 .
72	     * This case should be handled by a reflection formula.
73	     * If q<0 and x is an integer, there is a relation to
74	     * the polyGamma function.
75	     */
76	    s = pow(q, -x);
77	    a = q;
78	    i = 0;
79	    b = 0.0;
80	    while ((i < 9) || (a <= 9.0)) {
81	        i += 1;
82	        a += 1.0;
83	        b = pow(a, -x);
84	        s += b;
85	        if (fabs(b / s) < MACHEP){
86	            return s;
87	        }
88	    }
89	
90	    w = a;
91	    s += b * w / (x - 1.0);
92	    s -= 0.5 * b;
93	    a = 1.0;
94	    k = 0.0;
95	    for (i = 0; i < 12; i++) {
96	        a *= x + k;
97	        b /= w;
98	        t = a * b / A[i];
99	        s = s + t;
100	        t = fabs(t / s);
101	        if (t < MACHEP){
102	            return s;
103	        }
104	        k += 1.0;
105	        a *= x + k;
106	        b /= w;
107	        k += 1.0;
108	    }
109	    return s;
110	}
111	'''
112	
113	
114	zeta = _core.create_ufunc(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/_hipsparse_stub_mapper.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	
31	hipsparse_url = ('https://raw.githubusercontent.com/ROCmSoftwarePlatform/'
32	                 'hipSPARSE/rocm-{0}/library/include/hipsparse.h')
33	hip_versions = ("3.5.0", "3.7.0", "3.8.0", "3.9.0", "4.0.0", "4.2.0")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/_hipsparse_stub_mapper.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
382	
383	            req = urllib.request.urlopen(hipsparse_url.format(hip_ver))
384	            with req as f:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    return (
32	        'https://developer.download.nvidia.com/compute/cudnn/redist/cudnn/' +
33	        f'{platform}/{filename}')
34	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    return (
80	        'https://developer.download.nvidia.com/compute/cutensor/' +
81	        f'redist/libcutensor/{platform}-x86_64/{filename}')
82	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	    return (
117	        'https://developer.download.nvidia.com/compute/redist/nccl/' +
118	        'v{}/{}'.format(public_version, filename))
119	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
181	
182	    target_platform = platform.system()
183	    asset = record['assets'].get(target_platform, None)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
181	
182	    target_platform = platform.system()
183	    asset = record['assets'].get(target_platform, None)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:182
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
181	
182	    target_platform = platform.system()
183	    asset = record['assets'].get(target_platform, None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
190	              ' conditions of the NVIDIA cuDNN Software License Agreement:')
191	        print('  https://docs.nvidia.com/deeplearning/cudnn/sla/index.html')
192	        print()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	              ' conditions of the NVIDIA cuTENSOR Software License Agreement:')
196	        print('  https://docs.nvidia.com/cuda/cutensor/license.html')
197	        print()

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
209	        with open(os.path.join(tmpdir, os.path.basename(url)), 'wb') as f:
210	            with urllib.request.urlopen(url) as response:
211	                f.write(response.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
210	            with urllib.request.urlopen(url) as response:
211	                f.write(response.read())
212	        print('Extracting...')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
210	            with urllib.request.urlopen(url) as response:
211	                f.write(response.read())
212	        print('Extracting...')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cupy_cuda12x-13.4.1-cp39-cp39-win_amd64/cupyx/tools/install_library.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
210	            with urllib.request.urlopen(url) as response:
211	                f.write(response.read())
212	        print('Extracting...')

--------------------------------------------------

Code scanned:
	Total lines of code: 81786
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 75.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 90.0
		High: 4.0
Files skipped (0):
