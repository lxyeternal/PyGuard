Run started:2025-04-12 12:59:50.880850

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	            try:
37	                resp = await session.get(f"http://localhost:{debug_port}/json")
38	                data = await resp.json()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
53	
54	        async with session.ws_connect(
55	            page_url, receive_timeout=10, max_msg_size=0
56	        ) as ws:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
78	                pdf_data = await handler(ws, data, "data")
79	                pdf_data = base64.b64decode(pdf_data)
80	                if len(pdf_data) > 1000 and len(pdf_data) == prev_len:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:79
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
78	                pdf_data = await handler(ws, data, "data")
79	                pdf_data = base64.b64decode(pdf_data)
80	                if len(pdf_data) > 1000 and len(pdf_data) == prev_len:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
102	            os.environ.get("NO_SANDBOX", False)
103	            or platform.system().lower() != "windows"
104	            and os.geteuid() == 0

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
102	            os.environ.get("NO_SANDBOX", False)
103	            or platform.system().lower() != "windows"
104	            and os.geteuid() == 0

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:103
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
102	            os.environ.get("NO_SANDBOX", False)
103	            or platform.system().lower() != "windows"
104	            and os.geteuid() == 0

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:121
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
120	def get_free_port():
121	    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
122	    s.bind(("localhost", 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
123	    _, port = s.getsockname()
124	    s.close()
125	    return port

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
134	
135	    with concurrent.futures.ThreadPoolExecutor(max_workers=5) as executor:
136	        future = executor.submit(run, main(file_name, p, debug_port))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
165	        data = response["result"]["data"]
166	        pdf_data = base64.b64decode(data)
167	        return pdf_data

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:166
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
165	        data = response["result"]["data"]
166	        pdf_data = base64.b64decode(data)
167	        return pdf_data

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
184	        with open(fd, "w", encoding="utf-8") as f:
185	            f.write(html_data)
186	        tf_path = Path(tf_name)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_browser_pdf.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
184	        with open(fd, "w", encoding="utf-8") as f:
185	            f.write(html_data)
186	        tf_path = Path(tf_name)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_bundler.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
89	        app_type = "pdf"
90	        s = base64.b64encode(data["pdf_data"]).decode()
91	    else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_bundler.py:90
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
89	        app_type = "pdf"
90	        s = base64.b64encode(data["pdf_data"]).decode()
91	    else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_bundler.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
105	        with open(f"{fn}.zip", "rb") as zf:
106	            s = base64.b64encode(zf.read()).decode()
107	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_bundler.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
105	        with open(f"{fn}.zip", "rb") as zf:
106	            s = base64.b64encode(zf.read()).decode()
107	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_command_line.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	HELP = """\n\n
10	          ========================================================
11	
12	                              dataframe_image
13	        
14	          ========================================================
15	
16	Embed pandas DataFrames as images when converting Jupyter Notebooks to 
17	pdf or markdown documents. 
18	
19	Required Positional Arguments
20	=============================
21	filename
22	    The filename of the notebook you wish to convert
23	
24	Optional Keyword Arguments
25	==========================
26	--to
27	    Type of document to create - either pdf or markdown. Possible values 
28	    are 'pdf', 'markdown', and 'md'. (default: pdf)
29	
30	--use 
31	    Possible options are 'latex' or 'browser'.
32	    Choose to convert using latex or chrome web browser when converting 
33	    to pdf. Output is significantly different for each. Use 'latex' when
34	    you desire a formal report. Use 'browser' to get output similar to
35	    that when printing to pdf within a chrome web browser.
36	    (default: latex)
37	
38	--center-df
39	    Choose whether to center the DataFrames or not in the image. By 
40	    default, this is True, though in Jupyter Notebooks, they are 
41	    left-aligned. Use False to make left-aligned. (default: True)
42	
43	--max-rows
44	    Maximum number of rows to output from DataFrame. This is forwarded to 
45	    the `to_html` DataFrame method. (default: 30)
46	
47	--max-cols
48	    Maximum number of columns to output from DataFrame. This is forwarded 
49	    to the `to_html` DataFrame method. (deault: 10)
50	
51	--execute
52	    Whether or not to execute the notebook first. (default: False)
53	
54	--save-notebook
55	    Whether or not to save the notebook with DataFrames as images as a new 
56	    notebook. The filename will be '{notebook_name}_dataframe_image.ipynb'
57	    (default: False)
58	
59	--limit
60	    Limit the number of cells in the notebook for conversion. This is 
61	    useful to test conversion of a large notebook on a smaller subset.
62	
63	--document-name
64	    Name of newly created pdf/markdown document without the extension. 
65	    If not provided, the name of the notebook will be used.
66	
67	--table-conversion
68	    DataFrames (and other tables) will be inserted in your document
69	    as an image using a screenshot from Chrome. If this doesn't
70	    work, use matplotlib, which will always work and produce
71	    similar results.
72	    Valid values are 'chrome' or 'matplotlib' (default: 'chrome')
73	
74	--chrome-path
75	    Path to your machine's chrome executable. By default, it is 
76	    automatically found. Use this when chrome is not automatically found.
77	
78	--latex-command
79	    Pass in a list of commands that nbconvert will use to convert the 
80	    latex document to pdf. The latex document is created temporarily when
81	    converting to pdf with the `use` option set to 'latex'.
82	
83	    If the xelatex command is not found on your machine, then pdflatex 
84	    will be substituted for it. You must have latex installed on your 
85	    machine for this to work. Get more info on how to install latex -
86	    https://nbconvert.readthedocs.io/en/latest/install.html#installing-tex
87	    (default: ['xelatex', {filename}, 'quiet'])
88	
89	--output-dir
90	    Directory where new pdf and/or markdown files will be saved. By default,
91	    this will be in the same directory where the notebook is. The directory 
92	    for images will also be created in here. If --save-notebook is set to
93	    True, it will be saved here as well. Provide a relative path to the 
94	    current working directory or an absolute path.
95	
96	
97	Examples
98	========
99	
100	dataframe_image my_notebook.ipynb --to=pdf --save-notebook=True --execute=True
101	
102	dataframe_image path/to/my_notebook.ipynb --to=md --output-dir="some other/directory/"
103	
104	Created by Ted Petrou (https://www.dunderdata.com)
105	
106	"""
107	
108	parser = argparse.ArgumentParser(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	                    raise OSError(
150	                        'No latex installation found. Try setting `use="browser" to '
151	                        "convert via browser (without latex).\n"
152	                        "Find out how to install latex here: "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	        with open(self.filename) as f:
162	            nb = nbformat.read(f, as_version=4)
163	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
272	            if image_dir.is_dir():
273	                shutil.rmtree(image_dir)
274	            image_dir.mkdir()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
277	                with open(image_dir / filename, "wb") as f:
278	                    f.write(value)
279	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
277	                with open(image_dir / filename, "wb") as f:
278	                    f.write(value)
279	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
281	            with open(fn, mode="w", encoding="utf-8") as f:
282	                f.write(md_data)
283	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
281	            with open(fn, mode="w", encoding="utf-8") as f:
282	                f.write(md_data)
283	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
313	                with open(new_filename, "wb") as f:
314	                    f.write(image_data)
315	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
313	                with open(new_filename, "wb") as f:
314	                    f.write(image_data)
315	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
334	            with open("notebook.tex", "w", encoding="utf-8") as f:
335	                f.write(latex)
336	            raise ex

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
334	            with open("notebook.tex", "w", encoding="utf-8") as f:
335	                f.write(latex)
336	            raise ex

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
340	            with open(fn, mode="wb") as f:
341	                f.write(pdf_data)
342	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
340	            with open(fn, mode="wb") as f:
341	                f.write(pdf_data)
342	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
352	            with open(fn, mode="wb") as f:
353	                f.write(pdf_data)
354	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
352	            with open(fn, mode="wb") as f:
353	                f.write(pdf_data)
354	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
369	            file = self.final_nb_home / name
370	            nbformat.write(nb, file)
371	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_convert.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
369	            file = self.final_nb_home / name
370	            nbformat.write(nb, file)
371	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_latex_pdf.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        raise OSError(
22	            "No latex installation found. "
23	            "Try downloading as pdf via browser instead.\n"
24	            "Find out how to install latex here: "

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_preprocessors.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
71	        html = "<div>" + html + "</div>"
72	        image_data = base64.b64decode(converter(html))
73	        new_image_name = f"markdown_{cell_index}_table_{i}.png"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_preprocessors.py:72
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
71	        html = "<div>" + html + "</div>"
72	        image_data = base64.b64decode(converter(html))
73	        new_image_name = f"markdown_{cell_index}_table_{i}.png"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_preprocessors.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	        # find images attached to markdown through dragging and dropping
132	        attachments = cell.get("attachments", {})
133	        for i, (image_name, data) in enumerate(attachments.items()):

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_preprocessors.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
141	                new_image_name = f"markdown_{cell_index}_attachment_{i}_{j}.{ext}"
142	                image_data = base64.b64decode(base64_data)
143	                image_data_dict[new_image_name] = image_data

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_preprocessors.py:142
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
141	                new_image_name = f"markdown_{cell_index}_attachment_{i}_{j}.{ext}"
142	                image_data = base64.b64decode(base64_data)
143	                image_data_dict[new_image_name] = image_data

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_preprocessors.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
188	        if cell["cell_type"] == "code":
189	            outputs = cell.get("outputs", [])
190	            for output in outputs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_preprocessors.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	    def preprocess_cell(self, cell, resources, cell_index):
218	        outputs = cell.get("outputs", [])
219	        for output in outputs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_preprocessors.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
242	
243	                image_data = requests.get(image_file).content
244	                new_image_name = f"markdown_{cell_index}_normal_http_image_{i}{ext}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/_preprocessors.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	
257	                image_data = requests.get(src).content
258	                new_image_name = f"markdown_{cell_index}_html_image_tag_{i}{ext}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/base.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	
69	        page = f"""
70	        <!DOCTYPE html>
71	        <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
72	        <head>
73	        <meta charset="UTF-8"/>
74	        {css_str}
75	        </head>
76	        <body>
77	        {table_div}
78	        </body>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/base.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	        if self.use_mathjax:
97	            script = """<script>
98	            MathJax = {
99	            tex: {
100	                inlineMath: [['$', '$'], ['\\(', '\\)']]
101	            },
102	            svg: {
103	                fontCache: 'global'
104	            }
105	            };
106	            </script>
107	            <script type="text/javascript" id="MathJax-script" async
108	            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
109	            </script>
110	            <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> 
111	            <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>"""
112	            css += script

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/base.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
216	        if self.encode_base64:
217	            img_str = base64.b64encode(img_str).decode()
218	        return img_str

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/base.py:217
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
216	        if self.encode_base64:
217	            img_str = base64.b64encode(img_str).decode()
218	        return img_str

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
15	def get_system():
16	    system = platform.system().lower()
17	    if system in ["darwin", "linux", "windows"]:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
15	def get_system():
16	    system = platform.system().lower()
17	    if system in ["darwin", "linux", "windows"]:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
15	def get_system():
16	    system = platform.system().lower()
17	    if system in ["darwin", "linux", "windows"]:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
23	def get_chrome_path(chrome_path=None):
24	    system = get_system()
25	    if chrome_path:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
23	def get_chrome_path(chrome_path=None):
24	    system = get_system()
25	    if chrome_path:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	            with open(temp_html, "w", encoding="utf-8") as f:
117	                f.write(html_css)
118	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
116	            with open(temp_html, "w", encoding="utf-8") as f:
117	                f.write(html_css)
118	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
129	                os.environ.get("NO_SANDBOX", False)
130	                or platform.system().lower() != "windows"
131	                and os.geteuid() == 0

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
129	                os.environ.get("NO_SANDBOX", False)
130	                or platform.system().lower() != "windows"
131	                and os.geteuid() == 0

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:130
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
129	                os.environ.get("NO_SANDBOX", False)
130	                or platform.system().lower() != "windows"
131	                and os.geteuid() == 0

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/chrome_converter.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
147	            with open(temp_img, "rb") as f:
148	                bio = io.BytesIO(f.read())
149	            im = Image.open(bio)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/browser/selenium_converter.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
39	        with open(temp_html, "w", encoding="utf-8") as f:
40	            f.write(self.get_css() + html)
41	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/matplotlib_table.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
332	        if self.encode_base64:
333	            img_str = base64.b64encode(img_str).decode()
334	        return img_str

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/converter/matplotlib_table.py:333
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
332	        if self.encode_base64:
333	            img_str = base64.b64encode(img_str).decode()
334	        return img_str

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	
32	CHROME_LAST_KNOWN_GOOD_VERSION = "https://googlechromelabs.github.io/chrome-for-testing/last-known-good-versions.json"
33	CHROME_FOR_TESTING_PUBLIC_BASE_URL = "https://storage.googleapis.com/chrome-for-testing-public"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	CHROME_LAST_KNOWN_GOOD_VERSION = "https://googlechromelabs.github.io/chrome-for-testing/last-known-good-versions.json"
33	CHROME_FOR_TESTING_PUBLIC_BASE_URL = "https://storage.googleapis.com/chrome-for-testing-public"
34	
35	
36	def ensure_directory_exists(directory: str):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
64	        """
65	        system = platform.system()
66	        machine = platform.machine().lower()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
64	        """
65	        system = platform.system()
66	        machine = platform.machine().lower()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
64	        """
65	        system = platform.system()
66	        machine = platform.machine().lower()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
154	                while True:
155	                    chunk = await response.content.read(1024)
156	                    if not chunk:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
157	                        break
158	                    download_file.write(chunk)
159	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
157	                        break
158	                    download_file.write(chunk)
159	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
178	
179	    if platform.system() != "Windows":
180	        for root, _, files in os.walk(extract_to):

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
178	
179	    if platform.system() != "Windows":
180	        for root, _, files in os.walk(extract_to):

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:179
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
178	
179	    if platform.system() != "Windows":
180	        for root, _, files in os.walk(extract_to):

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
182	                file_path = os.path.join(root, file)
183	                os.chmod(file_path, os.stat(file_path).st_mode | stat.S_IEXEC)
184	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/dataframe_image/download-chrome-headless-shell.py:183
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
182	                file_path = os.path.join(root, file)
183	                os.chmod(file_path, os.stat(file_path).st_mode | stat.S_IEXEC)
184	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/tests/test_df_image.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
113	def test_latex(document_name, converter):
114	    if platform.system() == "Windows" and sys.version_info[:2] == (3, 12):
115	        # I don't know why this test fails on Windows with Python 3.12

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataframe_image-0.2.7-py3-none-any/tests/test_df_image.py:114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
113	def test_latex(document_name, converter):
114	    if platform.system() == "Windows" and sys.version_info[:2] == (3, 12):
115	        # I don't know why this test fails on Windows with Python 3.12

--------------------------------------------------

Code scanned:
	Total lines of code: 2832
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 55.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 63.0
		High: 16.0
Files skipped (0):
