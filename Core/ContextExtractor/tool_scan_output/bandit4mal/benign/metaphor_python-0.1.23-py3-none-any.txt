Run started:2025-04-12 19:43:51.000270

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_python-0.1.23-py3-none-any/metaphor_python/api.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
231	
232	    def __init__(self, api_key: str, base_url: str = "https://api.metaphor.systems", user_agent: str = "metaphor-python 0.1.23"):
233	        """Initialize the Metaphor client with the provided API key and optional base URL and user agent.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_python-0.1.23-py3-none-any/metaphor_python/api.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
268	        request.update(to_camel_case(options))
269	        response = requests.post(f"{self.base_url}/search", json=request, headers=self.headers)
270	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_python-0.1.23-py3-none-any/metaphor_python/api.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
301	        request.update(to_camel_case(options))
302	        response = requests.post(f"{self.base_url}/findSimilar", json=request, headers=self.headers)
303	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_python-0.1.23-py3-none-any/metaphor_python/api.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	            return GetContentsResponse([])
321	        response = requests.get(f"{self.base_url}/contents", params=to_camel_case({"ids": ids}), headers=self.headers)
322	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_python-0.1.23-py3-none-any/metaphor_python/metaphor.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	    def __init__(self, api_key: str):
71	        self.base_url = 'https://api.metaphor.systems'
72	        self.headers = {'x-api-key': api_key}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_python-0.1.23-py3-none-any/metaphor_python/metaphor.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
74	    def search(self, request: SearchRequest) -> SearchResponse:
75	        response = requests.post(f'{self.base_url}/search', json=to_camel_case(request.__dict__), headers=self.headers)
76	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_python-0.1.23-py3-none-any/metaphor_python/metaphor.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
79	    def find_similar(self, request: FindSimilarRequest) -> SearchResponse:
80	        response = requests.post(f'{self.base_url}/findSimilar', json=to_camel_case(request.__dict__), headers=self.headers)
81	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metaphor_python-0.1.23-py3-none-any/metaphor_python/metaphor.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	    def get_contents(self, request: GetContentsRequest) -> GetContentsResponse:
85	        response = requests.get(f'{self.base_url}/contents', params=to_camel_case(request.__dict__), headers=self.headers)
86	        response.raise_for_status()

--------------------------------------------------

Code scanned:
	Total lines of code: 356
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 0.0
Files skipped (0):
