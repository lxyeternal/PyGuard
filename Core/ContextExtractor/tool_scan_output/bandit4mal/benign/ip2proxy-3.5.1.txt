Run started:2025-04-12 17:10:07.662906

Test results:
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
35	                conn = httplib.HTTPConnection("api.ip2proxy.com")
36	            conn.request("GET", "/?" + x)
37	            res = conn.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
36	            conn.request("GET", "/?" + x)
37	            res = conn.getresponse()
38	            return json.loads(res.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	            res = conn.getresponse()
38	            return json.loads(res.read())
39	        except:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
55	                conn = http.client.HTTPConnection("api.ip2proxy.com")
56	            conn.request("GET", "/?" + x)
57	            res = conn.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
56	            conn.request("GET", "/?" + x)
57	            res = conn.getresponse()
58	            return json.loads(res.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	            res = conn.getresponse()
58	            return json.loads(res.read())
59	        except:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
147	    def __exit__(self, exc_type, exc_value, traceback):
148	        self.close()
149	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
152	        # Ensure old file is closed before opening a new one
153	        self.close()
154	        

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
160	        self._f.seek(0)
161	        header_row = self._f.read(32)
162	        self._dbtype = struct.unpack('B', header_row[0:1])[0]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
177	            if (self._dbyear > 20 and self._productcode != 0) :
178	                self._f.close()
179	                del self._f

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
184	            # If there is file close it.
185	            self._f.close()
186	            del self._f

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
399	        self._f.seek(offset - 1)
400	        data = self._f.read(257)
401	        char_count = struct.unpack('B', data[0:1])[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
406	        self._f.seek(offset - 1)
407	        return struct.unpack('<I', self._f.read(4))[0]
408	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
575	        self._f.seek(offset - 1)
576	        data = self._f.read(8)
577	        return struct.unpack('<L', data[0:4])[0], struct.unpack('<L', data[4:8])[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
581	        self._f.seek(offset - 1)
582	        raw_data = self._f.read(data_length)
583	        ip_from = struct.unpack('<L', raw_data[0:4])[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
589	        self._f.seek(offset - 1)
590	        raw_data = self._f.read(data_length)
591	        return ((struct.unpack('<L', raw_data[12:16])[0] << 96) | (struct.unpack('<L', raw_data[8:12])[0] << 64) | (struct.unpack('<L', raw_data[4:8])[0] << 32) | struct.unpack('<L', raw_data[0:4])[0], (struct.unpack('<L', raw_data[data_length-4:data_length])[0] << 96) | (struct.unpack('<L', raw_data[data_length-8:data_length-4])[0] << 64) | (struct.unpack('<L', raw_data[data_length-12:data_length-8])[0] << 32) | struct.unpack('<L', raw_data[data_length-16:data_length-12])[0])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
708	        parameters = urlencode((("ip", ip), ("key", self.apikey), ("package", self.package)))
709	        response = httprequest(parameters, self.usessl)
710	        if (response == None):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/IP2Proxy.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
718	        parameters = urlencode((("key", self.apikey), ("check", True)))
719	        response = httprequest(parameters, self.usessl)
720	        if (response == None):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    py_modules=['IP2Proxy'],
15	    url="https://github.com/ip2location/ip2proxy-python",
16	    packages=setuptools.find_packages(),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
31	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
32	    rec = db.get_all("1.0.0.8")
33	    assert rec['country_short'] == "US", "Test failed because country code not same."

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
36	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
37	    rec = db.get_all("1.0.0.8")
38	    assert rec['country_long'] == "United States of America", "Test failed because country name not same."

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
41	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
42	    rec = db.get_country_short("1.0.0.8")
43	    assert rec == "US", "Test failed because country code not same."

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
46	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
47	    rec = db.get_country_long("1.0.0.8")
48	    assert rec == "United States of America", "Test failed because country name not same."

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
51	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
52	    rec = db.get_region("1.0.0.8")
53	    assert rec == "California"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
56	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
57	    rec = db.get_city("1.0.0.8")
58	    assert rec == "Los Angeles"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
61	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
62	    rec = db.get_isp("1.0.0.8")
63	    assert rec == "APNIC and CloudFlare DNS Resolver Project"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
66	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
67	    rec = db.get_domain("1.0.0.8")
68	    assert rec == "cloudflare.com"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
71	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
72	    rec = db.get_usage_type("1.0.0.8")
73	    assert rec == "CDN"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
76	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
77	    rec = db.get_asn("1.0.0.8")
78	    assert rec == "13335"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
81	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
82	    rec = db.get_as_name("1.0.0.8")
83	    assert rec == "CLOUDFLARENET"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
86	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
87	    rec = db.get_last_seen("1.0.0.8")
88	    assert rec == "22"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
91	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
92	    rec = db.get_threat("1.0.0.8")
93	    assert rec == "-"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
96	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
97	    rec = db.is_proxy("1.0.0.8")
98	    assert rec == 2

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_database.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
101	    db.open(os.path.join("data", "PX10.SAMPLE.BIN"))
102	    rec = db.get_proxy_type("1.0.0.8")
103	    assert rec == "DCH"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ip2proxy-3.5.1/ip2proxy-3.5.1/tests/test_webservice.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
14	    # ws = IP2Proxy.IP2ProxyWebService(apikey,package,usessl)
15	    rec = ws.lookup("8.8.8.8")
16	    assert rec['country_code'] == "US", "Test failed because country code not same."

--------------------------------------------------

Code scanned:
	Total lines of code: 758
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 0.0
Files skipped (0):
