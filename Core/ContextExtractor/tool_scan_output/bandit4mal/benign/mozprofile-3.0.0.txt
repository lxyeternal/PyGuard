Run started:2025-04-12 10:54:26.718057

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/addons.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
256	                    if "install.rdf" in filenames:
257	                        manifest = compressed_file.read("install.rdf")
258	                    elif "manifest.json" in filenames:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/addons.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
259	                        is_webext = True
260	                        manifest = compressed_file.read("manifest.json").decode()
261	                        manifest = json.loads(manifest)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/addons.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
276	                        if "install.rdf" in filenames:
277	                            manifest = compressed_file.read("install.rdf")
278	                        elif "manifest.json" in filenames:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/addons.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
279	                            is_webext = True
280	                            manifest = compressed_file.read("manifest.json").decode()
281	                            manifest = json.loads(manifest)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/addons.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	                        with open(os.path.join(addon_path, "install.rdf")) as f:
288	                            manifest = f.read()
289	                    except IOError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/addons.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
290	                        with open(os.path.join(addon_path, "manifest.json")) as f:
291	                            manifest = json.loads(f.read())
292	                            is_webext = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/addons.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
318	                # Get the namespaces abbreviations
319	                em = get_namespace_id(doc, "http://www.mozilla.org/2004/em-rdf#")
320	                rdf = get_namespace_id(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/addons.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
320	                rdf = get_namespace_id(
321	                    doc, "http://www.w3.org/1999/02/22-rdf-syntax-ns#"
322	                )
323	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/permissions.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
130	        if filename:
131	            self.read(filename)
132	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/permissions.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
225	            elif os.path.exists(locations):
226	                self._locations.read(locations)
227	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/permissions.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
242	                user_prefs.append(("network.trr.mode", 3))
243	                trrUri = "https://foo.example.com:{}/dns-query".format(dohServerPort)
244	                user_prefs.append(("network.trr.uri", trrUri))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/permissions.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
244	                user_prefs.append(("network.trr.uri", trrUri))
245	                user_prefs.append(("network.trr.bootstrapAddr", "127.0.0.1"))
246	                user_prefs.append(("network.dns.force_use_https_rr", True))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/prefs.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	        """
63	        self.add(self.read(path))
64	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/prefs.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	
151	        prefs = json.loads(mozfile.load(path).read())
152	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
255	            # lists, so we handle these specially.
256	            if platform.system() == "Darwin":
257	                assert len(self._allowlistpaths) <= 2

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
255	            # lists, so we handle these specially.
256	            if platform.system() == "Darwin":
257	                assert len(self._allowlistpaths) <= 2

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:256
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
255	            # lists, so we handle these specially.
256	            if platform.system() == "Darwin":
257	                assert len(self._allowlistpaths) <= 2

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
318	            # opening delimeter
319	            f.write(unicode("\n%s\n" % self.delimeters[0]))
320	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
318	            # opening delimeter
319	            f.write(unicode("\n%s\n" % self.delimeters[0]))
320	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
320	
321	            Preferences.write(f, preferences)
322	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
320	
321	            Preferences.write(f, preferences)
322	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
323	            # closing delimeter
324	            f.write(unicode("%s\n" % self.delimeters[1]))
325	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
323	            # closing delimeter
324	            f.write(unicode("%s\n" % self.delimeters[1]))
325	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
353	        with open(path, "r", encoding="utf-8") as f:
354	            lines = f.read().splitlines()
355	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
391	        with open(path, "w") as f:
392	            f.write(cleaned_prefs)
393	        return True

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
391	        with open(path, "w") as f:
392	            f.write(cleaned_prefs)
393	        return True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
559	            if six.PY2:
560	                fh.write(unicode(prefstr))
561	            else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
559	            if six.PY2:
560	                fh.write(unicode(prefstr))
561	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
561	            else:
562	                fh.write(prefstr)
563	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/mozprofile/profile.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
561	            else:
562	                fh.write(prefstr)
563	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    description="Library to create and modify Mozilla application profiles",
20	    long_description="see https://firefox-source-docs.mozilla.org/mozbase/index.html",
21	    classifiers=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/setup.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    author_email="tools@lists.mozilla.org",
34	    url="https://wiki.mozilla.org/Auto-tools/Projects/Mozbase",
35	    license="MPL 2.0",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_addonid.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	ADDON_ID_TESTS = [
16	    """
17	<RDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
18	     xmlns:em="http://www.mozilla.org/2004/em-rdf#">
19	   <Description about="urn:mozilla:install-manifest">
20	     <em:id>winning</em:id>
21	     <em:name>MozMill</em:name>
22	     <em:version>2.0a</em:version>
23	     <em:creator>Adam Christian</em:creator>
24	     <em:description>A testing extension based on the
25	            Windmill Testing Framework client source</em:description>
26	     <em:unpack>true</em:unpack>
27	     <em:targetApplication>
28	       <!-- Firefox -->
29	       <Description>
30	         <em:id>{ec8030f7-c20a-464f-9b0e-13a3a9e97384}</em:id>
31	         <em:minVersion>3.5</em:minVersion>
32	         <em:maxVersion>8.*</em:maxVersion>
33	       </Description>
34	     </em:targetApplication>
35	     <em:targetApplication>
36	       <!-- Thunderbird -->
37	       <Description>
38	         <em:id>{3550f703-e582-4d05-9a08-453d09bdfdc6}</em:id>
39	         <em:minVersion>3.0a1pre</em:minVersion>
40	         <em:maxVersion>3.2*</em:maxVersion>
41	       </Description>
42	     </em:targetApplication>
43	     <em:targetApplication>
44	       <!-- Sunbird -->
45	       <Description>
46	         <em:id>{718e30fb-e89b-41dd-9da7-e25a45638b28}</em:id>
47	         <em:minVersion>0.6a1</em:minVersion>
48	         <em:maxVersion>1.0pre</em:maxVersion>
49	       </Description>
50	     </em:targetApplication>
51	     <em:targetApplication>
52	       <!-- SeaMonkey -->
53	       <Description>
54	         <em:id>{92650c4d-4b8e-4d2a-b7eb-24ecf4f6b63a}</em:id>
55	         <em:minVersion>2.0a1</em:minVersion>
56	         <em:maxVersion>2.1*</em:maxVersion>
57	       </Description>
58	     </em:targetApplication>
59	    <em:targetApplication>
60	       <!-- Songbird -->
61	       <Description>
62	         <em:id>songbird@songbirdnest.com</em:id>
63	         <em:minVersion>0.3pre</em:minVersion>
64	         <em:maxVersion>1.3.0a</em:maxVersion>
65	       </Description>
66	    </em:targetApplication>
67	    <em:targetApplication>
68	         <Description>
69	          <em:id>toolkit@mozilla.org</em:id>
70	          <em:minVersion>1.9.1</em:minVersion>
71	          <em:maxVersion>2.0*</em:maxVersion>
72	         </Description>
73	     </em:targetApplication>
74	   </Description>
75	</RDF>""",
76	    """
77	<RDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
78	     xmlns:em="http://www.mozilla.org/2004/em-rdf#">
79	   <Description about="urn:mozilla:install-manifest">
80	     <em:targetApplication>
81	       <!-- Firefox -->
82	       <Description>
83	         <em:id>{ec8030f7-c20a-464f-9b0e-13a3a9e97384}</em:id>
84	         <em:minVersion>3.5</em:minVersion>
85	         <em:maxVersion>8.*</em:maxVersion>
86	       </Description>
87	     </em:targetApplication>
88	     <em:id>winning</em:id>
89	     <em:name>MozMill</em:name>
90	     <em:version>2.0a</em:version>
91	     <em:creator>Adam Christian</em:creator>
92	     <em:description>A testing extension based on the
93	            Windmill Testing Framework client source</em:description>
94	     <em:unpack>true</em:unpack>
95	    </Description>
96	 </RDF>""",
97	    """
98	<RDF xmlns="http://www.mozilla.org/2004/em-rdf#"
99	        xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
100	   <rdf:Description about="urn:mozilla:install-manifest">
101	     <id>winning</id>
102	     <name>foo</name>
103	     <version>42</version>
104	     <description>A testing extension based on the
105	            Windmill Testing Framework client source</description>
106	 </rdf:Description>
107	</RDF>""",
108	    """
109	<RDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
110	     xmlns:foobar="http://www.mozilla.org/2004/em-rdf#">

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_addonid.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	</RDF>""",
76	    """
77	<RDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
78	     xmlns:em="http://www.mozilla.org/2004/em-rdf#">
79	   <Description about="urn:mozilla:install-manifest">
80	     <em:targetApplication>
81	       <!-- Firefox -->
82	       <Description>
83	         <em:id>{ec8030f7-c20a-464f-9b0e-13a3a9e97384}</em:id>
84	         <em:minVersion>3.5</em:minVersion>
85	         <em:maxVersion>8.*</em:maxVersion>
86	       </Description>
87	     </em:targetApplication>
88	     <em:id>winning</em:id>
89	     <em:name>MozMill</em:name>
90	     <em:version>2.0a</em:version>
91	     <em:creator>Adam Christian</em:creator>
92	     <em:description>A testing extension based on the
93	            Windmill Testing Framework client source</em:description>
94	     <em:unpack>true</em:unpack>
95	    </Description>
96	 </RDF>""",
97	    """
98	<RDF xmlns="http://www.mozilla.org/2004/em-rdf#"
99	        xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
100	   <rdf:Description about="urn:mozilla:install-manifest">
101	     <id>winning</id>
102	     <name>foo</name>
103	     <version>42</version>
104	     <description>A testing extension based on the
105	            Windmill Testing Framework client source</description>
106	 </rdf:Description>
107	</RDF>""",
108	    """
109	<RDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
110	     xmlns:foobar="http://www.mozilla.org/2004/em-rdf#">
111	   <Description about="urn:mozilla:install-manifest">
112	     <foobar:targetApplication>
113	       <!-- Firefox -->
114	       <Description>
115	         <foobar:id>{ec8030f7-c20a-464f-9b0e-13a3a9e97384}</foobar:id>
116	         <foobar:minVersion>3.5</foobar:minVersion>
117	         <foobar:maxVersion>8.*</foobar:maxVersion>
118	       </Description>
119	     </foobar:targetApplication>
120	     <foobar:id>winning</foobar:id>
121	     <foobar:name>MozMill</foobar:name>
122	     <foobar:version>2.0a</foobar:version>
123	     <foobar:creator>Adam Christian</foobar:creator>
124	     <foobar:description>A testing extension based on the
125	            Windmill Testing Framework client source</foobar:description>
126	     <foobar:unpack>true</foobar:unpack>
127	    </Description>
128	 </RDF>""",
129	]
130	
131	
132	@pytest.fixture(
133	    params=ADDON_ID_TESTS, ids=[str(i) for i in range(0, len(ADDON_ID_TESTS))]
134	)
135	def profile(request, tmpdir):
136	    test = request.param
137	    path = tmpdir.mkdtemp().strpath
138	
139	    with open(os.path.join(path, "install.rdf"), "w") as fh:
140	        fh.write(test)
141	    return path
142	
143	
144	def test_addonID(profile):
145	    a = addons.AddonManager(os.path.join(profile, "profile"))
146	    addon_id = a.addon_details(profile)["id"]
147	    assert addon_id == "winning"
148	
149	
150	def test_addonID_xpi():
151	    a = addons.AddonManager("profile")
152	    addon = a.addon_details(os.path.join(here, "addons", "empty.xpi"))
153	    assert addon["id"] == "test-empty@quality.mozilla.org"
154	
155	
156	if __name__ == "__main__":
157	    mozunit.main()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_addonid.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	 </RDF>""",
97	    """
98	<RDF xmlns="http://www.mozilla.org/2004/em-rdf#"
99	        xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
100	   <rdf:Description about="urn:mozilla:install-manifest">
101	     <id>winning</id>
102	     <name>foo</name>
103	     <version>42</version>
104	     <description>A testing extension based on the
105	            Windmill Testing Framework client source</description>
106	 </rdf:Description>
107	</RDF>""",
108	    """
109	<RDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
110	     xmlns:foobar="http://www.mozilla.org/2004/em-rdf#">
111	   <Description about="urn:mozilla:install-manifest">
112	     <foobar:targetApplication>
113	       <!-- Firefox -->
114	       <Description>
115	         <foobar:id>{ec8030f7-c20a-464f-9b0e-13a3a9e97384}</foobar:id>
116	         <foobar:minVersion>3.5</foobar:minVersion>
117	         <foobar:maxVersion>8.*</foobar:maxVersion>
118	       </Description>
119	     </foobar:targetApplication>
120	     <foobar:id>winning</foobar:id>
121	     <foobar:name>MozMill</foobar:name>
122	     <foobar:version>2.0a</foobar:version>
123	     <foobar:creator>Adam Christian</foobar:creator>
124	     <foobar:description>A testing extension based on the
125	            Windmill Testing Framework client source</foobar:description>
126	     <foobar:unpack>true</foobar:unpack>
127	    </Description>
128	 </RDF>""",
129	]
130	
131	
132	@pytest.fixture(
133	    params=ADDON_ID_TESTS, ids=[str(i) for i in range(0, len(ADDON_ID_TESTS))]
134	)
135	def profile(request, tmpdir):
136	    test = request.param
137	    path = tmpdir.mkdtemp().strpath
138	
139	    with open(os.path.join(path, "install.rdf"), "w") as fh:
140	        fh.write(test)
141	    return path
142	
143	
144	def test_addonID(profile):
145	    a = addons.AddonManager(os.path.join(profile, "profile"))
146	    addon_id = a.addon_details(profile)["id"]
147	    assert addon_id == "winning"
148	
149	
150	def test_addonID_xpi():
151	    a = addons.AddonManager("profile")
152	    addon = a.addon_details(os.path.join(here, "addons", "empty.xpi"))
153	    assert addon["id"] == "test-empty@quality.mozilla.org"
154	
155	
156	if __name__ == "__main__":
157	    mozunit.main()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_addonid.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	</RDF>""",
108	    """
109	<RDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
110	     xmlns:foobar="http://www.mozilla.org/2004/em-rdf#">
111	   <Description about="urn:mozilla:install-manifest">
112	     <foobar:targetApplication>
113	       <!-- Firefox -->
114	       <Description>
115	         <foobar:id>{ec8030f7-c20a-464f-9b0e-13a3a9e97384}</foobar:id>
116	         <foobar:minVersion>3.5</foobar:minVersion>
117	         <foobar:maxVersion>8.*</foobar:maxVersion>
118	       </Description>
119	     </foobar:targetApplication>
120	     <foobar:id>winning</foobar:id>
121	     <foobar:name>MozMill</foobar:name>
122	     <foobar:version>2.0a</foobar:version>
123	     <foobar:creator>Adam Christian</foobar:creator>
124	     <foobar:description>A testing extension based on the
125	            Windmill Testing Framework client source</foobar:description>
126	     <foobar:unpack>true</foobar:unpack>
127	    </Description>
128	 </RDF>""",
129	]
130	
131	
132	@pytest.fixture(
133	    params=ADDON_ID_TESTS, ids=[str(i) for i in range(0, len(ADDON_ID_TESTS))]
134	)
135	def profile(request, tmpdir):
136	    test = request.param
137	    path = tmpdir.mkdtemp().strpath
138	
139	    with open(os.path.join(path, "install.rdf"), "w") as fh:
140	        fh.write(test)
141	    return path
142	
143	
144	def test_addonID(profile):
145	    a = addons.AddonManager(os.path.join(profile, "profile"))
146	    addon_id = a.addon_details(profile)["id"]
147	    assert addon_id == "winning"
148	
149	
150	def test_addonID_xpi():
151	    a = addons.AddonManager("profile")
152	    addon = a.addon_details(os.path.join(here, "addons", "empty.xpi"))
153	    assert addon["id"] == "test-empty@quality.mozilla.org"
154	
155	
156	if __name__ == "__main__":
157	    mozunit.main()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_addonid.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
139	    with open(os.path.join(path, "install.rdf"), "w") as fh:
140	        fh.write(test)
141	    return path

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_bug758250.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
26	    # because we are testing data loss, let's make sure we make a copy
27	    shutil.rmtree(tmpdir)
28	    shutil.copytree(addon, tmpdir)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_permissions.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	
11	LOCATIONS = """http://mochi.test:8888  primary,privileged
12	http://127.0.0.1:8888           privileged
13	"""
14	
15	
16	@pytest.fixture
17	def locations_file(tmpdir):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_permissions.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    origins_decl = (
40	        "var knownOrigins = (function () {  return ['http://mochi.test:8888', "
41	        "'http://127.0.0.1:8888'].reduce"
42	    )
43	    assert origins_decl in user_prefs[1][1]
44	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_permissions.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	    assert user_prefs[1] == ("network.trr.mode", 3)
58	    assert user_prefs[2] == ("network.trr.uri", "https://foo.example.com:443/dns-query")
59	    assert user_prefs[3] == ("network.trr.bootstrapAddr", "127.0.0.1")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_permissions.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
58	    assert user_prefs[2] == ("network.trr.uri", "https://foo.example.com:443/dns-query")
59	    assert user_prefs[3] == ("network.trr.bootstrapAddr", "127.0.0.1")
60	    assert user_prefs[4] == ("network.dns.force_use_https_rr", True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	_prefs_with_comments = {
24	    "browser.startup.homepage": "http://planet.mozilla.org",
25	    "zoom.minPercent": 30,
26	    "zoom.maxPercent": 300,
27	    "webgl.verbose": "false",
28	}
29	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
67	        assert prefs == read
68	        shutil.rmtree(profile)
69	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	
76	    _prefs = {"browser.startup.homepage": "http://planet.mozilla.org/"}
77	    commandline = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	    _prefs = [
86	        ("browser.startup.homepage", "http://planet.mozilla.org/"),
87	        ("zoom.minPercent", 30),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	    # write the .ini file
100	    _ini = """[DEFAULT]
101	browser.startup.homepage = http://planet.mozilla.org/
102	
103	[foo]
104	browser.startup.homepage = http://github.com/
105	"""
106	    try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
107	        fd, name = tempfile.mkstemp(suffix=".ini", text=True)
108	        os.write(fd, _ini.encode())
109	        os.close(fd)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
107	        fd, name = tempfile.mkstemp(suffix=".ini", text=True)
108	        os.write(fd, _ini.encode())
109	        os.close(fd)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	        # test the [DEFAULT] section
113	        _prefs = {"browser.startup.homepage": "http://planet.mozilla.org/"}
114	        compare_generated(_prefs, commandline)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	        # test a specific section
117	        _prefs = {"browser.startup.homepage": "http://github.com/"}
118	        commandline[-1] = commandline[-1] + ":foo"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
136	        fd, name = tempfile.mkstemp(suffix=".ini", text=True)
137	        os.write(fd, _ini.encode())
138	        os.close(fd)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
136	        fd, name = tempfile.mkstemp(suffix=".ini", text=True)
137	        os.write(fd, _ini.encode())
138	        os.close(fd)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	    assert not initial_prefs
158	    initial_prefs = open(prefs_file).read().strip()
159	    assert not initial_prefs

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
164	    assert prefs1 == Preferences.read_prefs(prefs_file)
165	    lines = open(prefs_file).read().strip().splitlines()
166	    assert any(line.startswith("#MozRunner Prefs Start") for line in lines)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
180	    assert not initial_prefs
181	    initial_prefs = open(prefs_file).read().strip()
182	    assert not initial_prefs

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
187	    assert prefs1 == Preferences.read_prefs(prefs_file)
188	    lines = open(prefs_file).read().strip().splitlines()
189	    assert any(line.startswith("#MozRunner Prefs Start") for line in lines)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
204	    assert not initial_prefs
205	    initial_prefs = open(prefs_file).read().strip()
206	    assert not initial_prefs

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	    prefs1 = [
210	        ("browser.startup.homepage", "http://planet.mozilla.org/"),
211	        ("zoom.minPercent", 30),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
214	    assert prefs1 == Preferences.read_prefs(prefs_file)
215	    lines = open(prefs_file).read().strip().splitlines()
216	    assert bool([line for line in lines if line.startswith("#MozRunner Prefs Start")])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
222	    assert prefs1 + prefs2 == Preferences.read_prefs(prefs_file)
223	    lines = open(prefs_file).read().strip().splitlines()
224	    assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
232	    assert not final_prefs
233	    lines = open(prefs_file).read().strip().splitlines()
234	    assert "#MozRunner Prefs Start" not in lines

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
251	        f = open(user_js, "w")
252	        f.write(contents)
253	        f.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
251	        f = open(user_js, "w")
252	        f.write(contents)
253	        f.close()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
280	    finally:
281	        shutil.rmtree(tempdir)
282	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
291	        with user_js:
292	            user_js.write(
293	                """
294	# Mozilla User Preferences

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
291	        with user_js:
292	            user_js.write(
293	                """
294	# Mozilla User Preferences

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
316	def test_json(compare_generated):
317	    _prefs = {"browser.startup.homepage": "http://planet.mozilla.org/"}
318	    json = '{"browser.startup.homepage": "http://planet.mozilla.org/"}'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
317	    _prefs = {"browser.startup.homepage": "http://planet.mozilla.org/"}
318	    json = '{"browser.startup.homepage": "http://planet.mozilla.org/"}'
319	
320	    # just repr it...could use the json module but we don't need it here
321	    with mozfile.NamedTemporaryFile(suffix=".json") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
321	    with mozfile.NamedTemporaryFile(suffix=".json") as f:
322	        f.write(json.encode())
323	        f.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
321	    with mozfile.NamedTemporaryFile(suffix=".json") as f:
322	        f.write(json.encode())
323	        f.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
333	    with mozfile.NamedTemporaryFile(suffix=".json") as f:
334	        f.write(json.encode())
335	        f.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
333	    with mozfile.NamedTemporaryFile(suffix=".json") as f:
334	        f.write(json.encode())
335	        f.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
344	    _prefs = {
345	        "browser.startup.homepage": "http://planet.mozilla.org",
346	        "zoom.minPercent": 30,
347	        "zoom.maxPercent": 300,
348	    }
349	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
358	            path = f.name
359	            preferences.write(f, _prefs)
360	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
358	            path = f.name
359	            preferences.write(f, _prefs)
360	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
383	    expected_prefs = {
384	        "browser.foo": "http://server-name",
385	        "zoom.minPercent": 30,
386	        "webgl.verbose": "false",
387	        "browser.bar": "somethingxyz",
388	    }
389	    values = {"server": "server-name", "abc": "something"}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
408	    docroot = os.path.join(here, "files")
409	    host = "127.0.0.1"
410	    port = 8888

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_preferences.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
420	        # read preferences through the web
421	        read = prefs.read_prefs("http://%s:%d/prefs_with_comments.js" % (host, port))
422	        assert dict(read) == _prefs_with_comments

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_server_locations.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	LOCATIONS = """# This is the primary location from which tests run.
18	#
19	http://mochi.test:8888          primary,privileged
20	
21	# a few test locations
22	http://127.0.0.1:80             privileged
23	http://127.0.0.1:8888           privileged
24	https://test:80                 privileged
25	http://example.org:80           privileged
26	http://test1.example.org        privileged
27	
28	"""
29	
30	LOCATIONS_NO_PRIMARY = """http://secondary.test:80        privileged

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_server_locations.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	
30	LOCATIONS_NO_PRIMARY = """http://secondary.test:80        privileged
31	http://tertiary.test:8888       privileged
32	"""
33	
34	LOCATIONS_BAD_PORT = """http://mochi.test:8888  primary,privileged

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_server_locations.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	
34	LOCATIONS_BAD_PORT = """http://mochi.test:8888  primary,privileged
35	http://127.0.0.1:80             privileged
36	http://127.0.0.1:8888           privileged
37	http://test:badport             privileged
38	http://example.org:80           privileged
39	"""
40	
41	
42	def compare_location(location, scheme, host, port, options):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_server_locations.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
69	    compare_location(next(i), "http", "mochi.test", "8888", ["primary", "privileged"])
70	    compare_location(next(i), "http", "127.0.0.1", "80", ["privileged"])
71	    compare_location(next(i), "http", "127.0.0.1", "8888", ["privileged"])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_server_locations.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
70	    compare_location(next(i), "http", "127.0.0.1", "80", ["privileged"])
71	    compare_location(next(i), "http", "127.0.0.1", "8888", ["privileged"])
72	    compare_location(next(i), "https", "test", "80", ["privileged"])

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_server_locations.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
84	    # assert we don't throw DuplicateLocationError
85	    locations.add_host("127.0.0.1")
86	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mozprofile-3.0.0/mozprofile-3.0.0/tests/test_server_locations.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
87	    with pytest.raises(BadPortLocationError):
88	        locations.add_host("127.0.0.1", port="abc")
89	

--------------------------------------------------

Code scanned:
	Total lines of code: 2475
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 51.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 85.0
		High: 1.0
Files skipped (0):
