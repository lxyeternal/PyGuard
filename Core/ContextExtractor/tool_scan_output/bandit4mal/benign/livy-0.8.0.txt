Run started:2025-04-12 10:23:45.064392

Test results:
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
69	    def get(self, endpoint: str = "", params: dict = None) -> dict:
70	        return self._request("GET", endpoint, params=params)
71	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
72	    def post(self, endpoint: str, data: dict = None) -> dict:
73	        return self._request("POST", endpoint, data)
74	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
75	    def delete(self, endpoint: str = "") -> dict:
76	        return self._request("DELETE", endpoint)
77	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
85	        url = self.url.rstrip("/") + endpoint
86	        response = self.session.request(
87	            method,
88	            url,
89	            auth=self.auth,
90	            verify=self.verify,
91	            json=data,
92	            params=params,
93	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	        if self._server_version_cache is None:
128	            data = self._client.get("/version")
129	            self._server_version_cache = Version(data["version"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	        """List all the active sessions in Livy."""
143	        data = self._client.get("/sessions")
144	        return [Session.from_json(item) for item in data["sessions"]]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
237	
238	        data = self._client.post("/sessions", data=body)
239	        return Session.from_json(data)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	        try:
247	            data = self._client.get(f"/sessions/{session_id}")
248	        except requests.HTTPError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
266	        """
267	        response = self._client.get(f"/sessions/{session_id}/statements")
268	        return [

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
289	
290	        response = self._client.post(
291	            f"/sessions/{session_id}/statements", data=data
292	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
300	        """
301	        response = self._client.get(
302	            f"/sessions/{session_id}/statements/{statement_id}"
303	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
388	
389	        data = self._client.post("/batches", data=body)
390	        return Batch.from_json(data)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
404	        try:
405	            data = self._client.get(f"/batches/{batch_id}")
406	        except requests.HTTPError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
427	        try:
428	            data = self._client.get(f"/batches/{batch_id}/log", params=params)
429	        except requests.HTTPError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/livy/client.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
437	        """List all the active batches in Livy."""
438	        response = self._client.get("/batches")
439	        return [Batch.from_json(data) for data in response["sessions"]]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/setup.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    packages=["livy"],
13	    url="https://github.com/acroz/pylivy",
14	    author="Andrew Crozier",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/conftest.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	        nargs="?",
9	        const="http://localhost:8998",
10	        help="Run integration tests against the specified Livy server URL "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/conftest.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        help="Run integration tests against the specified Livy server URL "
11	        + "(default: http://localhost:8998)",
12	    )
13	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	def test_auth(requests_mock, mocker):
42	    requests_mock.get("http://example.com/sessions", json={"sessions": []})
43	    mocker.patch.object(Session, "from_json")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	
49	    client = LivyClient("http://example.com", auth=dummy_auth)
50	    client.list_sessions()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	def test_verify(requests_mock, mocker, verify):
58	    requests_mock.get("http://example.com/sessions", json={"sessions": []})
59	    mocker.patch.object(Session, "from_json")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	
61	    client = LivyClient("http://example.com", verify=verify)
62	    client.list_sessions()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	    client = LivyClient(
77	        "http://example.com", requests_session=mock_requests_session
78	    )
79	    client.list_sessions()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	    requests_mock.get(
90	        "http://example.com/sessions", json={"sessions": [MOCK_SESSION_JSON]}
91	    )
92	    mocker.patch.object(Session, "from_json")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	
94	    client = LivyClient("http://example.com")
95	    sessions = client.list_sessions()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
102	    requests_mock.get(
103	        f"http://example.com/sessions/{MOCK_SESSION_ID}",
104	        json=MOCK_SESSION_JSON,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	
108	    client = LivyClient("http://example.com")
109	    session = client.get_session(MOCK_SESSION_ID)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	    requests_mock.get(
117	        "http://example.com/version", json={"version": "0.5.0-incubating"}
118	    )
119	    requests_mock.post("http://example.com/sessions", json=MOCK_SESSION_JSON)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	    )
119	    requests_mock.post("http://example.com/sessions", json=MOCK_SESSION_JSON)
120	    mocker.patch.object(Session, "from_json")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	
122	    client = LivyClient("http://example.com")
123	    session = client.create_session(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
163	    requests_mock.delete(
164	        f"http://example.com/sessions/{MOCK_SESSION_ID}",
165	        json={"msg": "deleted"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	
168	    client = LivyClient("http://example.com")
169	    client.delete_session(MOCK_SESSION_ID)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	    requests_mock.get(
176	        f"http://example.com/sessions/{MOCK_SESSION_ID}/statements",
177	        json={"statements": [MOCK_STATEMENT_JSON]},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
180	
181	    client = LivyClient("http://example.com")
182	    statements = client.list_statements(MOCK_SESSION_ID)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
191	    requests_mock.get(
192	        f"http://example.com/sessions/{MOCK_SESSION_ID}"
193	        + f"/statements/{MOCK_STATEMENT_ID}",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
197	
198	    client = LivyClient("http://example.com")
199	    statement = client.get_statement(MOCK_SESSION_ID, MOCK_STATEMENT_ID)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	    requests_mock.get(
209	        "http://example.com/version", json={"version": "0.5.0-incubating"}
210	    )
211	    requests_mock.post(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
211	    requests_mock.post(
212	        f"http://example.com/sessions/{MOCK_SESSION_ID}/statements",
213	        json=MOCK_STATEMENT_JSON,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
216	
217	    client = LivyClient("http://example.com")
218	    statement = client.create_statement(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	    requests_mock.get(
234	        "http://example.com/version", json={"version": "0.5.0-incubating"}
235	    )
236	    requests_mock.post("http://example.com/batches", json=MOCK_BATCH_JSON)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
235	    )
236	    requests_mock.post("http://example.com/batches", json=MOCK_BATCH_JSON)
237	    mocker.patch.object(Batch, "from_json")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	
239	    client = LivyClient("http://example.com")
240	    batch = client.create_batch(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
282	    requests_mock.get(
283	        f"http://example.com/batches/{MOCK_BATCH_ID}",
284	        json=MOCK_BATCH_JSON,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
287	
288	    client = LivyClient("http://example.com")
289	    batch = client.get_batch(MOCK_BATCH_ID)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	    requests_mock.get(
297	        f"http://example.com/batches/{MOCK_BATCH_ID}/log",
298	        json=MOCK_BATCH_LOG_JSON,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_client.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
301	
302	    client = LivyClient("http://example.com")
303	    batch = client.get_batch_log(MOCK_BATCH_ID)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_integration.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	        file=(
196	            "https://repo.typesafe.com/typesafe/maven-releases/org/apache/"
197	            "spark/spark-examples_2.11/1.6.0-typesafe-001/"
198	            "spark-examples_2.11-1.6.0-typesafe-001.jar"
199	        ),
200	        class_name="org.apache.spark.examples.SparkPi",
201	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_integration.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	def _livy_available(livy_url):
215	    return requests.get(livy_url).status_code == 200
216	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/livy-0.8.0/livy-0.8.0/tests/test_integration.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	def _session_stopped(livy_url, session_id):
219	    response = requests.get(f"{livy_url}/session/{session_id}")
220	    if response.status_code == 404:

--------------------------------------------------

Code scanned:
	Total lines of code: 1788
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 32.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 49.0
		High: 0.0
Files skipped (0):
