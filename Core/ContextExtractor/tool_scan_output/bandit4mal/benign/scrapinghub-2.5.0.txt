Run started:2025-04-12 17:29:13.616703

Test results:
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/__init__.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
18	    def _request(self, *args, **kwargs):
19	        return super(Connection, self)._request(*args, **kwargs)
20	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/__init__.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
25	    def request(self, *args, **kwargs):
26	        return super(HubstorageClient, self).request(*args, **kwargs)
27	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/exceptions.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
16	        if payload and isinstance(payload, dict):
17	            message = payload.get('message')
18	            if message:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/jobs.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	            params['spider'] = self.spider.name
80	        return next(self._project.jobq.apiget(('count',), params=params))
81	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/jobs.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	        update_kwargs(params, count=count, keys=keys)
106	        keys = params.get('keys')
107	        count = params.get('count')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/jobs.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	        keys = params.get('keys')
107	        count = params.get('count')
108	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/jobs.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
130	            # may raise BadRequest if JobQ doesn't validate
131	            return list(self._project.jobq.apipost("cancel",
132	                                                   data=json.dumps(data)))[0]
133	        elif count:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/jobs.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
137	            # may raise Forbidden
138	            return self._project.jobq.apipost("cancel?count=%s" % count)
139	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/jobs.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
297	        try:
298	            response = self._client._connection._post('run', 'json', params)
299	        except BadRequest as exc:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/jobs.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
401	            project = self._client.get_project(self.project_id)
402	            spider_id = project.spiders.get(spider)._id
403	            if self.spider and spider_id != self.spider._id:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/jobs.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
443	        params.update({'project': self.project_id, 'spider': spider})
444	        result = self._client._connection._post('jobs_update', 'json', params)
445	        return result['count']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/jobs.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
502	        params.update({'project': self.project_id, 'job': self.key})
503	        self._client._connection._post('jobs_update', 'json', params)
504	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/spiders.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	        url = urljoin(self._client._connection.url, path)
129	        response = self._client._connection._session.get(url)
130	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/client/spiders.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	        response.raise_for_status()
131	        return response.json().get('tags', [])

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/batchuploader.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
105	            if self.closed and not w.closed:
106	                w.close(block=False)
107	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/batchuploader.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
188	        headers = {'content-encoding': batch['content-encoding']}
189	        return self.client.session.request(
190	            method='POST',
191	            url=batch['url'],
192	            data=batch['data'],
193	            auth=batch['auth'],
194	            timeout=self.client.connection_timeout,
195	            params=params,
196	            headers=headers,
197	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/client.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	
50	    DEFAULT_ENDPOINT = 'https://storage.scrapinghub.com/'
51	    DEFAULT_USER_AGENT = 'python-scrapinghub/{version}'.format(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/client.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
105	        def invoke_request():
106	            r = self.session.request(**kwargs)
107	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/client.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
117	        else:
118	            return invoke_request()
119	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/client.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	    def push_job(self, projectid, spidername, auth=None, **jobparams):
168	        project = self.projects.get(projectid, auth=auth)
169	        return project.push_job(spidername, **jobparams)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/client.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	    def get_project(self, *args, **kwargs):
172	        return self.projects.get(*args, **kwargs)
173	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/client.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	        tsurl = urlpathjoin(self.endpoint, 'system/ts')
176	        return self.session.get(tsurl).json()
177	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/client.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	        auth = xauth(auth) or self.auth
192	        return next(self.apiget('jobsummaries', params=params, auth=auth))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/collectionsrt.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	        try:
43	            r = self.apiget((_type, _name, _key), params=params)
44	            return r if _key is None else next(r)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/collectionsrt.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
54	        try:
55	            return self.apipost((_type, _name), is_idempotent=True, jl=_values)
56	        except HTTPError as exc:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/collectionsrt.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
62	    def delete(self, _type, _name, _keys):
63	        return self.apipost((_type, _name, 'deleted'), is_idempotent=True, jl=_keys)
64	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/collectionsrt.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
65	    def truncate(self, _name):
66	        return self.apipost('delete', params={'name': _name}, is_idempotent=True)
67	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/collectionsrt.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
117	            while True:
118	                r = next(self.apirequest(
119	                    path, method=method, params=getparams,
120	                    is_idempotent=method == 'GET',
121	                ))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/collectionsrt.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	                total += r[total_param]
123	                next_start = r.get('nextstart')
124	                if next_start is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/collectionsrt.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	    def get(self, *args, **kwargs):
153	        return self._collections.get(self.coltype, self.colname, *args, **kwargs)
154	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/jobq.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
22	        try:
23	            for o in self.apipost('push', jl=jobparams):
24	                if 'error' in o:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/jobq.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	            raise TypeError("jobkeys must be a list or a tuple")
38	        return self.apiget(('jobsummary',),
39	                           params={'key': jobkeys, 'jobmeta': jobmeta})
40	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/jobq.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	
50	        r = list(self.apiget((spiderid, 'summary', _queuename), params=params))
51	        return (r and r[0] or None) if _queuename else r

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/jobq.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	            params['lacks_tag'] = lacks_tag
75	        return self.apiget(('list',), params=params)
76	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/jobq.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	
93	        jobs = self.apiget(('list',), params=params)
94	        if only_finished_outcome:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/jobq.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        if only_finished_outcome:
95	            return (x for x in jobs if x.get('close_reason') == 'finished')
96	        return jobs

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/jobq.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
111	            return self.update(job, state='running', **start_params)
112	        for o in self.apipost('startjob', jl=start_params):
113	            return o

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/jobq.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
116	        """Cancel a running job"""
117	        self.apipost("%s/cancel" % job.key[job.key.index('/') + 1:])
118	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/jobq.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
138	        data = [dict(extra_args, key=k) for k in self._jobkeys(job)]
139	        return self.apipost('update', jl=data)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
56	        kwargs.setdefault('auth', self.auth)
57	        return self.client.request(**kwargs).iter_content(CHUNK_SIZE)
58	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
67	
68	        r = self.client.request(**kwargs)
69	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	    def apirequest(self, _path=None, **kwargs):
76	        if self._allows_mpack(_path) and kwargs.get('method').upper() == 'GET':
77	            kwargs = self._enforce_msgpack(**kwargs)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
81	    def apipost(self, _path=None, **kwargs):
82	        return self.apirequest(_path, method='POST', **kwargs)
83	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
85	        kwargs.setdefault('is_idempotent', True)
86	        return self.apirequest(_path, method='GET', **kwargs)
87	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
89	        kwargs.setdefault('is_idempotent', True)
90	        return self.apirequest(_path, method='DELETE', **kwargs)
91	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	        """Adds meta=_key to ensure a key is returned"""
100	        meta = params.get('meta', [])
101	        if '_key' not in meta:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
214	        if self._writer is not None:
215	            self._writer.close(block=block)
216	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	    def list(self, _key=None, **params):
221	        return self.apiget(_key, params=params)
222	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
228	    def stats(self):
229	        return next(self.apiget('stats', chunk_size=STATS_CHUNK_SIZE))
230	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
250	        if self._cached is None:
251	            r = self.apiget()
252	            try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
267	            if not self.ignore_fields:
268	                self.apipost(jl=self._data, is_idempotent=True)
269	            else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
269	            else:
270	                self.apipost(jl={k: v for k, v in six.iteritems(self._data)
271	                                 if k not in self.ignore_fields},
272	                             is_idempotent=True)
273	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/hubstorage/resourcetype.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	    def liveget(self, key):
292	        for o in self.apiget(key):
293	            return o

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	
33	    DEFAULT_ENDPOINT = 'https://app.zyte.com/api/'
34	
35	    API_METHODS = {

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
114	            url = "{0}?{1}".format(url, urlencode(params, True))
115	        return self._request(url, None, headers, format, raw)
116	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
114	            url = "{0}?{1}".format(url, urlencode(params, True))
115	        return self._request(url, None, headers, format, raw)
116	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
119	        url = self._build_url(method, format)
120	        return self._request(url, params, headers, format, raw, files)
121	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
119	        url = self._build_url(method, format)
120	        return self._request(url, params, headers, format, raw, files)
121	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	        if data is None and files is None:
137	            response = self._session.get(url, headers=headers,
138	                                         timeout=self._connection_timeout)
139	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
139	        else:
140	            response = self._session.post(url, headers=headers,
141	                                          data=data, files=files,
142	                                          timeout=self._connection_timeout)
143	        return self._decode_response(response, format, raw)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
188	        """
189	        result = self._get('listprojects', 'json')
190	        return result['projects']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	        params = self._add_params(params or {})
204	        return self._request_proxy._get(method, format, params, headers, raw)
205	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
207	        params = self._add_params(params or {})
208	        return self._request_proxy._post(method, format, params, headers, raw, files)
209	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
225	        params['spider'] = spider
226	        result = self._post('schedule', 'json', params)
227	        return result['jobid']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	    def spiders(self, **params):
237	        result = self._get('spiders', 'json', params)
238	        return result['spiders']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	            params['spider'] = spiders
254	        r = self._get('as_project_slybot', 'zip', params, raw=True)
255	        return r if outputfile is None else copyfileobj(r, outputfile)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
260	            params['start_url'] = start_urls
261	            return self._post('as_spider_properties', 'json', params)
262	        return self._get('as_spider_properties', 'json', params)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	            return self._post('as_spider_properties', 'json', params)
262	        return self._get('as_spider_properties', 'json', params)
263	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
284	        """
285	        result = self._get('jobs_count', 'json')
286	        return result['total']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
290	        params.update(modifiers)
291	        result = self._post('jobs_update', 'json', params)
292	        return result['count']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
304	        if self._jobs is None:
305	            result = self._get('jobs_list', 'jl', self.params)
306	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
311	                # jl status expected is only "ok"
312	                status = status_line.get('status', '')
313	                if status != 'ok':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	            try:
359	                for item in self._get('items', 'jl', params=params):
360	                    yield item

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
370	                             self.RETRY_INTERVAL, self._id, params['offset'],
371	                             params.get('count'), attempt, self.MAX_RETRIES, exc)
372	                time.sleep(self.RETRY_INTERVAL)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
378	        # XXX: only allow add_tag/remove_tag
379	        result = self._post('jobs_update', 'json', modifiers)
380	        return result['count']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
382	    def stop(self):
383	        result = self._post('jobs_stop', 'json')
384	        return result['status'] == 'ok'

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
386	    def delete(self):
387	        result = self._post('jobs_delete', 'json')
388	        return result['count']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
398	        files = {'content': ('report', StringIO(content))}
399	        self._post('reports_add', 'json', params, files=files)
400	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/scrapinghub/legacy.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
401	    def log(self, **params):
402	        return self._get('log', 'jl', params)
403	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/setup.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
10	with open(join(dirname(__file__), 'scrapinghub/VERSION'), 'rb') as f:
11	    version = f.read().decode('ascii').strip()
12	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scrapinghub-2.5.0/scrapinghub-2.5.0/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    author_email='info@scrapinghub.com',
25	    url='http://github.com/scrapinghub/python-scrapinghub',
26	    platforms=['Any'],

--------------------------------------------------

Code scanned:
	Total lines of code: 3545
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 78.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 81.0
		High: 0.0
Files skipped (0):
