Run started:2025-04-12 13:11:24.994985

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
55	        # explore further.
56	        return "127.0.0.1"
57	    try:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
57	    try:
58	        with makesock(AF_INET6, SOCK_STREAM) as sock:
59	            sock.bind(("::1", 0))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
64	        if e.errno in IP6_IS.NO:
65	            return "127.0.0.1"
66	        if e.errno in IP6_IS.YES:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
44	@public
45	def get_localhost() -> Literal["::1", "127.0.0.1"]:
46	    """Returns numeric address to localhost depending on IPv6 availability"""

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
250	        assert self.server is not None
251	        self.server.close()
252	        self.loop.run_until_complete(self.server.wait_closed())

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
252	        self.loop.run_until_complete(self.server.wait_closed())
253	        self.loop.close()
254	        self.server = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
263	        ready_event = threading.Event()
264	        self._thread = threading.Thread(target=self._run, args=(ready_event,))
265	        self._thread.daemon = True

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
263	        ready_event = threading.Event()
264	        self._thread = threading.Thread(target=self._run, args=(ready_event,))
265	        self._thread.daemon = True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
358	        assert server is not None
359	        server.close()
360	        await server.wait_closed()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
362	        # TODO: Where does .close() come from...?
363	        self.server_coro.close()  # type: ignore[attr-defined]
364	        self._cleanup()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
427	                s = stk.enter_context(client_ctx.wrap_socket(s))
428	            s.recv(1024)
429	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:466
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
465	        with ExitStack() as stk:
466	            s: makesock = stk.enter_context(makesock(AF_UNIX, SOCK_STREAM))
467	            s.connect(self.unix_socket)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
466	            s: makesock = stk.enter_context(makesock(AF_UNIX, SOCK_STREAM))
467	            s.connect(self.unix_socket)
468	            if self.ssl_context:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/controller.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
470	                s = stk.enter_context(client_ctx.wrap_socket(s))
471	            s.recv(1024)
472	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/docs/_exts/autoprogramm.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
168	                with open(f[0]) as fobj:
169	                    codestring = fobj.read()
170	                foo = imp.new_module("foo")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/docs/conf.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	intersphinx_mapping = {
153	    "python": ("https://docs.python.org/3", None),
154	}

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
538	        if self._original_transport is not None:
539	            self._original_transport.close()
540	        super().connection_lost(error)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
571	        assert self.transport is not None
572	        self.transport.close()
573	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
596	        assert isinstance(response, bytes)
597	        self._writer.write(response + b"\r\n")
598	        assert self.session is not None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
630	                assert self.transport is not None
631	                self.transport.close()
632	                return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
651	                    # Line too long. Read until end of line before sending 500.
652	                    await self._reader.read(error.consumed)
653	                    while True:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
651	                    # Line too long. Read until end of line before sending 500.
652	                    await self._reader.read(error.consumed)
653	                    while True:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
658	                            # Line is even longer...
659	                            await self._reader.read(e.consumed)
660	                            continue

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
658	                            # Line is even longer...
659	                            await self._reader.read(e.consumed)
660	                            continue

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
733	                        )
734	                        self.transport.close()
735	                        continue

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
746	                        )
747	                        self.transport.close()
748	                        continue

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
762	                         self.session.peer)
763	                self._writer.close()
764	                raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
767	                         self.session.peer)
768	                self._writer.close()
769	                raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
786	                        # still complains, so silence that error.
787	                        self.transport.close()  # pytype: disable=attribute-error
788	                        self.connection_lost(error)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
901	            assert self.transport is not None
902	            self.transport.close()
903	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1044	        #   - https://tools.ietf.org/html/rfc4954#page-13 "continue-req"
1045	        challenge = b"334 " + (b64encode(challenge) if encode_to_b64 else challenge)
1046	        assert self.session is not None

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1044	        #   - https://tools.ietf.org/html/rfc4954#page-13 "continue-req"
1045	        challenge = b"334 " + (b64encode(challenge) if encode_to_b64 else challenge)
1046	        assert self.session is not None

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1060	        try:
1061	            decoded_blob = b64decode(blob, validate=True)
1062	        except binascii.Error:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1060	        try:
1061	            decoded_blob = b64decode(blob, validate=True)
1062	        except binascii.Error:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1129	            try:
1130	                login_and_password = b64decode(args[1].encode(), validate=True)
1131	            except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1130
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1129	            try:
1130	                login_and_password = b64decode(args[1].encode(), validate=True)
1131	            except Exception:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1156	            try:
1157	                login = b64decode(args[1].encode(), validate=True)
1158	            except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1157
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1156	            try:
1157	                login = b64decode(args[1].encode(), validate=True)
1158	            except Exception:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1438	                log.info('Connection lost during DATA')
1439	                self._writer.close()
1440	                raise

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1450	                # Drain the stream anyways
1451	                line = await self._reader.read(e.consumed)
1452	                assert not line.endswith(b'\r\n')

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/smtp.py:1451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1450	                # Drain the stream anyways
1451	                line = await self._reader.read(e.consumed)
1452	                assert not line.endswith(b'\r\n')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/testing/helpers.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
46	    )
47	    client.close()
48	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/testing/helpers.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
70	) -> bytes:
71	    sock.send(data + end)
72	    slist = [sock]

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/testing/helpers.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
77	            # We can use sock instead of read_s because slist only contains sock
78	            result.append(sock.recv(1024))
79	        else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/conftest.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
214	    #
215	    new_loop.close()
216	    if default_loop is not None:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_main.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
127	    retq = MP.Queue()
128	    proc = MP.Process(target=func, args=(redy, retq))
129	    proc.start()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
61	# This has a tail which is not part of PROXYv2
62	TEST_V2_DATA1_XTRA = b64decode(
63	    "DQoNCgANClFVSVQKIREAcn8AAAF/AAABsFJipQMABFT9xv8CAAlBVVRIT1JJVFkFAAlVTklRVUVf\n"
64	    "SUQgAEQBAAAAACEAB1RMU3YxLjIlAAdSU0E0MDk2JAAKUlNBLVNIQTI1NiMAG0VDREhFLVJTQS1B\n"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:62
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
61	# This has a tail which is not part of PROXYv2
62	TEST_V2_DATA1_XTRA = b64decode(
63	    "DQoNCgANClFVSVQKIREAcn8AAAF/AAABsFJipQMABFT9xv8CAAlBVVRIT1JJVFkFAAlVTklRVUVf\n"
64	    "SUQgAEQBAAAAACEAB1RMU3YxLjIlAAdSU0E0MDk2JAAKUlNBLVNIQTI1NiMAG0VDREhFLVJTQS1B\n"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
71	# This same as the above but no extraneous tail
72	TEST_V2_DATA1_EXACT = b64decode(
73	    "DQoNCgANClFVSVQKIREAcn8AAAF/AAABsFJipQMABFT9xv8CAAlBVVRIT1JJVFkFAAlVTklRVUVf\n"
74	    "SUQgAEQBAAAAACEAB1RMU3YxLjIlAAdSU0E0MDk2JAAKUlNBLVNIQTI1NiMAG0VDREhFLVJTQS1B\n"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:72
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
71	# This same as the above but no extraneous tail
72	TEST_V2_DATA1_EXACT = b64decode(
73	    "DQoNCgANClFVSVQKIREAcn8AAAF/AAABsFJipQMABFT9xv8CAAlBVVRIT1JJVFkFAAlVTklRVUVf\n"
74	    "SUQgAEQBAAAAACEAB1RMU3YxLjIlAAdSU0E0MDk2JAAKUlNBLVNIQTI1NiMAG0VDREhFLVJTQS1B\n"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
508	    def test_tcp4(self, setup_proxy_protocol):
509	        srcip = "1.2.3.4"
510	        dstip = "5.6.7.8"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
509	        srcip = "1.2.3.4"
510	        dstip = "5.6.7.8"
511	        srcport = 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
621	    def test_malformed_notproxy(self, setup_proxy_protocol):
622	        srcip = "1.2.3.4"
623	        dstip = "5.6.7.8"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
622	        srcip = "1.2.3.4"
623	        dstip = "5.6.7.8"
624	        srcport = 65535

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
630	    def test_malformed_wrongtype_64(self, setup_proxy_protocol):
631	        srcip = "1.2.3.4"
632	        dstip = "5.6.7.8"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
631	        srcip = "1.2.3.4"
632	        dstip = "5.6.7.8"
633	        srcport = 65535

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
648	    def test_malformed_wrongtype_6mixed(self, setup_proxy_protocol):
649	        srcip = "1.2.3.4"
650	        dstip = "2021:cafe::0002"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
696	        srcip = "1.2.3.a"
697	        dstip = "5.6.7.8"
698	        srcport = 65535

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
704	    def test_ports_oob(self, setup_proxy_protocol):
705	        srcip = "1.2.3.4"
706	        dstip = "5.6.7.8"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:706
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
705	        srcip = "1.2.3.4"
706	        dstip = "5.6.7.8"
707	        srcport = 65536

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
736	            family=1,
737	            src_addr=IPv4Address("127.0.0.1"),
738	            dst_addr=IPv4Address("127.0.0.1"),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
737	            src_addr=IPv4Address("127.0.0.1"),
738	            dst_addr=IPv4Address("127.0.0.1"),
739	            src_port=45138,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
793	        setup_proxy_protocol(self)
794	        src_addr = IPv4Address("10.212.4.33")
795	        dst_addr = IPv4Address("10.11.12.13")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
794	        src_addr = IPv4Address("10.212.4.33")
795	        dst_addr = IPv4Address("10.11.12.13")
796	        src_port = 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:963
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
962	        setup_proxy_protocol(self)
963	        src_addr = IPv4Address("192.168.0.11")
964	        dst_addr = IPv4Address("172.16.0.22")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
963	        src_addr = IPv4Address("192.168.0.11")
964	        dst_addr = IPv4Address("172.16.0.22")
965	        src_port = 65534

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:982
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
981	    def _okay(self, handshake: bytes):
982	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
983	            sock.connect(Global.SrvAddr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
982	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
983	            sock.connect(Global.SrvAddr)
984	            sock.sendall(handshake)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:984
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
983	            sock.connect(Global.SrvAddr)
984	            sock.sendall(handshake)
985	            resp = sock.makefile("rb").readline()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1002
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1001	        assert plain_controller.smtpd._proxy_timeout > 0.0
1002	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
1003	            sock.connect(Global.SrvAddr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1002	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
1003	            sock.connect(Global.SrvAddr)
1004	            sock.sendall(handshake[0:20])

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
1003	            sock.connect(Global.SrvAddr)
1004	            sock.sendall(handshake[0:20])
1005	            time.sleep(0.1)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
1005	            time.sleep(0.1)
1006	            sock.sendall(handshake[20:])
1007	            resp = sock.makefile("rb").readline()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1019
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1018	        assert plain_controller.smtpd._proxy_timeout > 0.0
1019	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
1020	            sock.connect(Global.SrvAddr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1019	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
1020	            sock.connect(Global.SrvAddr)
1021	            time.sleep(plain_controller.smtpd._proxy_timeout * TIMEOUT_MULTIPLIER)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1024
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1023	            with pytest.raises(ConnectionError):
1024	                sock.send(handshake)
1025	                resp = sock.recv(4096)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1024	                sock.send(handshake)
1025	                resp = sock.recv(4096)
1026	                if resp == b"":

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1032
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1031	            with pytest.raises(OSError) as exc_info:  # noqa: PT011
1032	                sock.send(handshake)
1033	                resp = sock.recv(4096)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1033
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1032	                sock.send(handshake)
1033	                resp = sock.recv(4096)
1034	                if resp == b"":

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1055
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1054	        assert plain_controller.smtpd._proxy_timeout > 0.0
1055	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
1056	            sock.connect(Global.SrvAddr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1055	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
1056	            sock.connect(Global.SrvAddr)
1057	            sock.send(handshake[:-1])

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1057
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1056	            sock.connect(Global.SrvAddr)
1057	            sock.send(handshake[:-1])
1058	            time.sleep(plain_controller.smtpd._proxy_timeout * TIMEOUT_MULTIPLIER)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1060	            with pytest.raises(ConnectionError):
1061	                sock.send(b"\n")
1062	                resp = sock.recv(4096)  # On Windows, this line raises

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1062
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1061	                sock.send(b"\n")
1062	                resp = sock.recv(4096)  # On Windows, this line raises
1063	                if resp == b"":  # On Linux, no raise, just "EOF"

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1069
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1068	            with pytest.raises(OSError) as exc_info:  # noqa: PT011
1069	                sock.send(handshake)
1070	                resp = sock.recv(4096)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1070
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1069	                sock.send(handshake)
1070	                resp = sock.recv(4096)
1071	                if resp == b"":

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1114	            expect = pytest.raises(SMTPServerDisconnected)
1115	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
1116	            sock.connect(Global.SrvAddr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1115	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
1116	            sock.connect(Global.SrvAddr)
1117	            sock.sendall(handshake)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
1116	            sock.connect(Global.SrvAddr)
1117	            sock.sendall(handshake)
1118	            resp = sock.recv(4096)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_proxyprotocol.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1117	            sock.sendall(handshake)
1118	            resp = sock.recv(4096)
1119	            assert oper(resp, b"")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
65	def in_win32():
66	    return platform.system().casefold() == "windows"
67	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
65	def in_win32():
66	    return platform.system().casefold() == "windows"
67	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
65	def in_win32():
66	    return platform.system().casefold() == "windows"
67	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
79	def in_cygwin():
80	    return platform.system().casefold().startswith("cygwin")
81	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
79	def in_cygwin():
80	    return platform.system().casefold().startswith("cygwin")
81	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
79	def in_cygwin():
80	    return platform.system().casefold().startswith("cygwin")
81	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
96	        if p.is_dir():
97	            p.rmdir()
98	        else:

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
99	            p.unlink()
100	    tmpdir.rmdir()
101	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:112
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
111	        sock: socket.socket = stk.enter_context(
112	            socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
113	        )

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
113	        )
114	        sock.settimeout(AUTOSTOP_DELAY)
115	        sock.connect(str(sockfile))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
114	        sock.settimeout(AUTOSTOP_DELAY)
115	        sock.connect(str(sockfile))
116	        if ssl_context:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
119	        try:
120	            resp = sock.recv(1024)
121	        except socket.timeout:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
126	        assert resp.endswith(b"\r\n")
127	        sock.send(b"EHLO socket.test\r\n")
128	        # We need to "build" resparr because, especially when socket is wrapped

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
126	        assert resp.endswith(b"\r\n")
127	        sock.send(b"EHLO socket.test\r\n")
128	        # We need to "build" resparr because, especially when socket is wrapped

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
133	            catchup_delay()
134	            resp = sock.recv(1024)
135	            if not resp:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
138	        assert resparr.endswith(b"250 HELP\r\n")
139	        sock.send(b"QUIT\r\n")
140	        catchup_delay()

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
138	        assert resparr.endswith(b"250 HELP\r\n")
139	        sock.send(b"QUIT\r\n")
140	        catchup_delay()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
140	        catchup_delay()
141	        resp = sock.recv(1024)
142	        assert resp.startswith(b"221")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
311	    def test_getlocalhost(self):
312	        assert get_localhost() in ("127.0.0.1", "::1")
313	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
315	        mock_hasip6 = mocker.patch("aiosmtpd.controller._has_ipv6", return_value=False)
316	        assert get_localhost() == "127.0.0.1"
317	        assert mock_hasip6.called

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
334	        )
335	        assert get_localhost() == "127.0.0.1"
336	        mock_makesock.assert_called_with(socket.AF_INET6, socket.SOCK_STREAM)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
406	            nonlocal thread
407	            thread = Thread(target=_runner, args=(loop,))
408	            thread.daemon = True

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_server.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
406	            nonlocal thread
407	            thread = Thread(target=_runner, args=(loop,))
408	            thread.daemon = True

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
55	MAIL_LOG.setLevel(logging.DEBUG)
56	B64EQUALS = b64encode(b"=").decode()
57	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
55	MAIL_LOG.setLevel(logging.DEBUG)
56	B64EQUALS = b64encode(b"=").decode()
57	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
75	    """
76	    passwd_b64 = b64encode(passwd.encode("ascii")).decode("ascii")
77	    for _logname, _loglevel, logmsg in record_tuples:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
75	    """
76	    passwd_b64 = b64encode(passwd.encode("ascii")).decode("ascii")
77	    for _logname, _loglevel, logmsg in record_tuples:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
538	    def test_binary(self, client, data):
539	        client.sock.send(data)
540	        assert client.getreply() == S.S500_BAD_SYNTAX

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
547	        self._helo(client)
548	        client.close()
549	        client.connect(*Global.SrvAddr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
548	        client.close()
549	        client.connect(*Global.SrvAddr)
550	        resp = client.docmd("MAIL FROM: <anne@example.com>")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
881	        # LimitOverrunError code path in _handle_client.
882	        client.send("a" * 1_000_000)
883	        response = client.docmd("a" * 1001)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
920	        resp = client.docmd(
921	            "AUTH PLAIN " + b64encode(b"\0goodlogin\0" + PW.encode("ascii")).decode()
922	        )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:921
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
920	        resp = client.docmd(
921	            "AUTH PLAIN " + b64encode(b"\0goodlogin\0" + PW.encode("ascii")).decode()
922	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1060
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1059	    def test_plain1_bad_base64_length(self, do_auth_plain1):
1060	        resp = do_auth_plain1(b64encode(b"\0onlylogin").decode())
1061	        assert resp == S.S501_AUTH_CANTSPLIT

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1060
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1059	    def test_plain1_bad_base64_length(self, do_auth_plain1):
1060	        resp = do_auth_plain1(b64encode(b"\0onlylogin").decode())
1061	        assert resp == S.S501_AUTH_CANTSPLIT

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1067	    def test_plain1_bad_username(self, do_auth_plain1):
1068	        resp = do_auth_plain1(b64encode(b"\0badlogin\0goodpasswd").decode())
1069	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1067	    def test_plain1_bad_username(self, do_auth_plain1):
1068	        resp = do_auth_plain1(b64encode(b"\0badlogin\0goodpasswd").decode())
1069	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1071	    def test_plain1_bad_password(self, do_auth_plain1):
1072	        resp = do_auth_plain1(b64encode(b"\0goodlogin\0badpasswd").decode())
1073	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1072
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1071	    def test_plain1_bad_password(self, do_auth_plain1):
1072	        resp = do_auth_plain1(b64encode(b"\0goodlogin\0badpasswd").decode())
1073	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1084
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1083	        PWb = PW.encode("ascii")
1084	        resp = do_auth_plain1(b64encode(b"\0goodlogin\0" + PWb).decode())
1085	        assert resp == S.S235_AUTH_SUCCESS

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1084
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1083	        PWb = PW.encode("ascii")
1084	        resp = do_auth_plain1(b64encode(b"\0goodlogin\0" + PWb).decode())
1085	        assert resp == S.S235_AUTH_SUCCESS

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1100	        code, response = client.docmd(
1101	            "AUTH PLAIN " + b64encode(b"\0goodlogin\0" + PWb).decode()
1102	        )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1100	        code, response = client.docmd(
1101	            "AUTH PLAIN " + b64encode(b"\0goodlogin\0" + PWb).decode()
1102	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1122	        PWb = PW.encode("ascii")
1123	        resp = client_auth_plain2.docmd(b64encode(b"\0goodlogin\0" + PWb).decode())
1124	        assert resp == S.S235_AUTH_SUCCESS

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1123
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1122	        PWb = PW.encode("ascii")
1123	        resp = client_auth_plain2.docmd(b64encode(b"\0goodlogin\0" + PWb).decode())
1124	        assert resp == S.S235_AUTH_SUCCESS

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1133	    def test_plain2_bad_credentials(self, client_auth_plain2):
1134	        resp = client_auth_plain2.docmd(b64encode(b"\0badlogin\0badpasswd").decode())
1135	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1133	    def test_plain2_bad_credentials(self, client_auth_plain2):
1134	        resp = client_auth_plain2.docmd(b64encode(b"\0badlogin\0badpasswd").decode())
1135	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1157	        PWb = PW.encode("ascii")
1158	        line = "AUTH LOGIN " + b64encode(b"goodlogin").decode()
1159	        resp = client.docmd(line)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1157	        PWb = PW.encode("ascii")
1158	        line = "AUTH LOGIN " + b64encode(b"goodlogin").decode()
1159	        resp = client.docmd(line)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1161	        assert resp == S.S334_AUTH_PASSWORD
1162	        resp = client.docmd(b64encode(PWb).decode())
1163	        assert resp == S.S235_AUTH_SUCCESS

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1162
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1161	        assert resp == S.S334_AUTH_PASSWORD
1162	        resp = client.docmd(b64encode(PWb).decode())
1163	        assert resp == S.S235_AUTH_SUCCESS

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1176	        PWb = PW.encode("ascii")
1177	        resp = do_auth_login3(b64encode(b"goodlogin").decode())
1178	        assert resp == S.S334_AUTH_PASSWORD

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1177
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1176	        PWb = PW.encode("ascii")
1177	        resp = do_auth_login3(b64encode(b"goodlogin").decode())
1178	        assert resp == S.S334_AUTH_PASSWORD

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1178	        assert resp == S.S334_AUTH_PASSWORD
1179	        resp = do_auth_login3(b64encode(PWb).decode())
1180	        assert resp == S.S235_AUTH_SUCCESS

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1179
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1178	        assert resp == S.S334_AUTH_PASSWORD
1179	        resp = do_auth_login3(b64encode(PWb).decode())
1180	        assert resp == S.S235_AUTH_SUCCESS

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1194	    def test_login3_bad_username(self, do_auth_login3):
1195	        resp = do_auth_login3(b64encode(b"badlogin").decode())
1196	        assert resp == S.S334_AUTH_PASSWORD

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1195
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1194	    def test_login3_bad_username(self, do_auth_login3):
1195	        resp = do_auth_login3(b64encode(b"badlogin").decode())
1196	        assert resp == S.S334_AUTH_PASSWORD

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1196	        assert resp == S.S334_AUTH_PASSWORD
1197	        resp = do_auth_login3(b64encode(b"goodpasswd").decode())
1198	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1197
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1196	        assert resp == S.S334_AUTH_PASSWORD
1197	        resp = do_auth_login3(b64encode(b"goodpasswd").decode())
1198	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1200	    def test_login3_bad_password(self, do_auth_login3):
1201	        resp = do_auth_login3(b64encode(b"goodlogin").decode())
1202	        assert resp == S.S334_AUTH_PASSWORD

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1200	    def test_login3_bad_password(self, do_auth_login3):
1201	        resp = do_auth_login3(b64encode(b"goodlogin").decode())
1202	        assert resp == S.S334_AUTH_PASSWORD

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1202	        assert resp == S.S334_AUTH_PASSWORD
1203	        resp = do_auth_login3(b64encode(b"badpasswd").decode())
1204	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1202	        assert resp == S.S334_AUTH_PASSWORD
1203	        resp = do_auth_login3(b64encode(b"badpasswd").decode())
1204	        assert resp == S.S535_AUTH_INVALID

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1247	        assert isinstance(auth_peeker, PeekerHandler)
1248	        assert auth_peeker.sess.peer[0] in {"::1", "127.0.0.1", "localhost"}
1249	        assert auth_peeker.sess.peer[1] > 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1264	        assert isinstance(auth_peeker, PeekerHandler)
1265	        assert auth_peeker.sess.peer[0] in {"::1", "127.0.0.1", "localhost"}
1266	        assert auth_peeker.sess.peer[1] > 0

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1435	        self._ehlo(client)
1436	        client.send(f"MAIL FROM: <{sender}> SMTPUTF8\r\n".encode("utf-8"))
1437	        assert client.getreply() == S.S250_OK

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1437	        assert client.getreply() == S.S250_OK
1438	        client.send(f"RCPT TO: <{recipient}>\r\n".encode("utf-8"))
1439	        assert client.getreply() == S.S250_OK

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1572	        self._ehlo(client, "test")
1573	        client.send(b"MAIL FROM:" + mail_from + b"\r\n")
1574	        assert client.getreply() == S.S250_OK

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1574	        assert client.getreply() == S.S250_OK
1575	        client.send(b"RCPT TO:" + mail_to + b"\r\n")
1576	        assert client.getreply() == S.S250_OK

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1626
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1625	    def test_too_long_body_delay_error(self, plain_controller):
1626	        with socket.socket() as sock:
1627	            sock.connect((plain_controller.hostname, plain_controller.port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1626	        with socket.socket() as sock:
1627	            sock.connect((plain_controller.hostname, plain_controller.port))
1628	            rslt = send_recv(sock, b"EHLO example.com")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1627	            sock.connect((plain_controller.hostname, plain_controller.port))
1628	            rslt = send_recv(sock, b"EHLO example.com")
1629	            assert rslt.startswith(b"220")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1629	            assert rslt.startswith(b"220")
1630	            rslt = send_recv(sock, b"MAIL FROM: <anne@example.com>")
1631	            assert rslt.startswith(b"250")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1631	            assert rslt.startswith(b"250")
1632	            rslt = send_recv(sock, b"RCPT TO: <bruce@example.com>")
1633	            assert rslt.startswith(b"250")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1633	            assert rslt.startswith(b"250")
1634	            rslt = send_recv(sock, b"DATA")
1635	            assert rslt.startswith(b"354")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1635	            assert rslt.startswith(b"354")
1636	            rslt = send_recv(sock, b"a" * (20 + 3))
1637	            # Must NOT receive status code here even if data is too much

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1638	            assert rslt == b""
1639	            rslt = send_recv(sock, b"\r\n.")
1640	            # *NOW* we must receive status code

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1654
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1653	    def test_too_long_line_delay_error(self, plain_controller):
1654	        with socket.socket() as sock:
1655	            sock.connect((plain_controller.hostname, plain_controller.port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1655
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1654	        with socket.socket() as sock:
1655	            sock.connect((plain_controller.hostname, plain_controller.port))
1656	            rslt = send_recv(sock, b"EHLO example.com")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1655	            sock.connect((plain_controller.hostname, plain_controller.port))
1656	            rslt = send_recv(sock, b"EHLO example.com")
1657	            assert rslt.startswith(b"220")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1657	            assert rslt.startswith(b"220")
1658	            rslt = send_recv(sock, b"MAIL FROM: <anne@example.com>")
1659	            assert rslt.startswith(b"250")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1659	            assert rslt.startswith(b"250")
1660	            rslt = send_recv(sock, b"RCPT TO: <bruce@example.com>")
1661	            assert rslt.startswith(b"250")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1661	            assert rslt.startswith(b"250")
1662	            rslt = send_recv(sock, b"DATA")
1663	            assert rslt.startswith(b"354")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1663	            assert rslt.startswith(b"354")
1664	            rslt = send_recv(sock, b"a" * (Server.line_length_limit + 3))
1665	            # Must NOT receive status code here even if data is too much

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
1666	            assert rslt == b""
1667	            rslt = send_recv(sock, b"\r\n.")
1668	            # *NOW* we must receive status code

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1690	        controller = plain_controller
1691	        code, mesg = client.connect(controller.hostname, controller.port)
1692	        assert code == 220

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1698	        controller = plain_controller
1699	        code, mesg = client.connect(controller.hostname, controller.port)
1700	        assert code == 220

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1738	            # completes, i.e. before the .\r\n
1739	            client.send(b"From: <anne@example.com>")
1740	            reset_connection(client)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1758	        # completes, i.e. before the \r\n
1759	        client.send("MAIL FROM: <anne")
1760	        reset_connection(client)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1767	    def test_connection_reset_in_long_command(self, plain_controller, client):
1768	        client.send("F" + 5555 * "O")  # without CRLF
1769	        reset_connection(client)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1780	        # Don't include the CRLF.
1781	        client.send("FOO")
1782	        client.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1781	        client.send("FOO")
1782	        client.close()
1783	        catchup_delay()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1798	        # Don't include the CRLF.
1799	        client.send("FOO")
1800	        client.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1799	        client.send("FOO")
1800	        client.close()
1801	        catchup_delay()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1809
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1808	    def test_close_in_long_command(self, plain_controller, client):
1809	        client.send("F" + 5555 * "O")  # without CRLF
1810	        client.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1809	        client.send("F" + 5555 * "O")  # without CRLF
1810	        client.close()
1811	        catchup_delay()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1834	            # Don't include the CRLF.
1835	            client.send("FOO")
1836	            client.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1835	            client.send("FOO")
1836	            client.close()
1837	            catchup_delay()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1847
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1846	    def test_sockclose_after_helo(self, mocker: MockFixture, plain_controller, client):
1847	        client.send("HELO example.com\r\n")
1848	        catchup_delay()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1870	        self._ehlo(client)
1871	        client.send(b"MAIL FROM: <anne\xFF@example.com>\r\n")
1872	        assert client.getreply() == S.S500_STRICT_ASCII

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:1903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1902	        #
1903	        client.send("HELO example.com\r\n")
1904	        client.sock.shutdown(socket.SHUT_WR)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:2003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2002	
2003	        client.connect(*srv_ip_port)
2004	        self._consume_budget(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:2008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2007	
2008	        client.connect(*srv_ip_port)
2009	        self._consume_budget(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:2026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2025	
2026	        client.connect(*srv_ip_port)
2027	        self._consume_budget(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/aiosmtpd/tests/test_smtp.py:2031
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2030	
2031	        client.connect(*srv_ip_port)
2032	        self._consume_budget(

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/housekeep.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
76	        elif pp.is_file():
77	            pp.chmod(0o600)
78	            pp.unlink()

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/housekeep.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
79	        elif pp.is_dir():
80	            pp.chmod(0o700)
81	            pp.rmdir()

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/housekeep.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
80	            pp.chmod(0o700)
81	            pp.rmdir()
82	        else:

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aiosmtpd-1.4.6/aiosmtpd-1.4.6/housekeep.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
85	            print(".", end="", flush=True)
86	    targ.rmdir()
87	

--------------------------------------------------

Code scanned:
	Total lines of code: 8503
	Total lines skipped (#nosec): 3

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 61.0
		High: 138.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 163.0
		High: 36.0
Files skipped (0):
