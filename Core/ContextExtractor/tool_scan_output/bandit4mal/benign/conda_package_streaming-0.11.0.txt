Run started:2025-04-12 15:54:41.086581

Test results:
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/create.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
160	
161	            with conda_file.open(
162	                f"pkg-{stem}.tar.zst",
163	                "w",
164	                force_zip64=(pkg_size > CONDA_ZIP64_LIMIT),
165	            ) as pkg_file_zip, data_compress.stream_writer(

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/create.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
169	
170	            with conda_file.open(
171	                f"info-{stem}.tar.zst",
172	                "w",
173	                force_zip64=(info_size > CONDA_ZIP64_LIMIT),
174	            ) as info_file_zip, data_compress.stream_writer(

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/extract.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
80	    if not fileobj:
81	        fileobj = open(filename, "rb")
82	        closefd = True

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/lazy_wheel.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
69	            for chunk in tail.iter_content(self._chunk_size):
70	                self._file.write(chunk)
71	        self._left: list[int] = [self._length - content_length]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/lazy_wheel.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	        self._request_count += 1
190	        response = self._session.get(self._url, headers=headers, stream=True)
191	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/lazy_wheel.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
224	                for chunk in response.iter_content(self._chunk_size):
225	                    self._file.write(chunk)
226	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/package_streaming.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
63	        try:
64	            os.chmod(targetpath, tarinfo.mode & (-1 & (~self.umask)))
65	        except OSError as e:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/package_streaming.py:64
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
63	        try:
64	            os.chmod(targetpath, tarinfo.mode & (-1 & (~self.umask)))
65	        except OSError as e:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/package_streaming.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
82	    try:
83	        with tarfile_open(fileobj=fileobj, mode="r|", encoding=encoding) as tar:
84	            for member in tar:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/package_streaming.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
144	        reader = zstandard.ZstdDecompressor().stream_reader(
145	            zf.open(component_filename[0])
146	        )

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/package_streaming.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
147	    elif str(filename).endswith(".tar.bz2"):
148	        reader = bz2.open(fileobj or filename, mode="rb")
149	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/s3.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	    def iter_content(self, n: int):
43	        return iter(lambda: self.raw.read(n), b"")
44	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/transmute.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
151	
152	    with open(package, "rb") as fileobj, tarfile.open(output_path, "x:bz2") as pkg_tar:
153	        for component in components:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/transmute.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
151	
152	    with open(package, "rb") as fileobj, tarfile.open(output_path, "x:bz2") as pkg_tar:
153	        for component in components:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/conda_package_streaming/url.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	    elif filename.endswith(".tar.bz2"):
78	        response = session.get(url, stream=True, headers={"Connection": "close"})
79	        conda = response.raw

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/docs/conf.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	
38	intersphinx_mapping = {"python": ("https://docs.python.org/3", None)}
39	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/conftest.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	def package_server(pkgs_dir, conda_paths):
52	    thread = server.get_server_thread(pkgs_dir)
53	    thread.start()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/server.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
62	    app = get_app(pkgs_dir)
63	    server = wsgiref.simple_server.make_server("127.0.0.1", 0, app)
64	    log.info(f"serving {app.pkgs_dir} on {server.server_address}/pkgs")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_degraded.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
28	        testtar = Path(tmpdir, "test.tar.bz2")
29	        with tarfile.open(testtar, "w:bz2") as tar:
30	            tar.addfile(tarfile.TarInfo(name="jim"))

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_extract.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
15	        print(package)
16	        with open(package, "rb") as fileobj:
17	            stream = package_streaming.stream_conda_component(

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_extract.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
41	    tar = io.BytesIO()
42	    t = tarfile.open(mode=tar_mode, fileobj=tar)
43	    tarinfo = tarfile.TarInfo(name=name)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_extract.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
117	        print(package)
118	        with open(package, "rb") as fileobj:
119	            stream = package_streaming.stream_conda_component(

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_transmute.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
28	    buffer = io.BytesIO()
29	    with tarfile.open("test.tar.bz2", "w:bz2", fileobj=buffer) as tar:
30	        symlink = tarfile.TarInfo(name="symlink")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_transmute.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
96	
97	    with open(Path(tmpdir, "test.conda"), "rb") as fileobj:
98	        for component, expected in (

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_transmute.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
155	        tmp_tar = tmp_path / f"{test_size}.tar.bz2"
156	        with tarfile.open(tmp_tar, "w:bz2") as tar:
157	            pkg = tarfile.TarInfo(name="packagedata")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_url.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    with pytest.raises(ValueError):
53	        next(stream_conda_info("https://localhost/notaconda.rar"))
54	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_url.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	                filename = filename[: -len(".conda")]
90	                zf.open(f"info-{filename}.tar.zst").read()
91	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_url.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	        def get(self, *args, **kwargs):
115	            response = super().get(*args, **kwargs)
116	            response.status_code = 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_url.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
161	    lzoh = lazy_wheel.LazyZipOverHTTP(
162	        "https://repodata.fly.dev/repo.anaconda.com/pkgs/main/win-32/current_repodata.jlap",
163	        session,
164	    )
165	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_url.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
166	    lzoh.seek(1024)
167	    lzoh.read(768)
168	    lzoh.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_url.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
173	        while buf:
174	            buf = lzoh.read(1024 * 10)
175	            print(list(zip(lzoh._left, lzoh._right)), lzoh._length)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_url.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
177	                break
178	            out.write(buf)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/conda_package_streaming-0.11.0/conda_package_streaming-0.11.0/tests/test_url.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
177	                break
178	            out.write(buf)

--------------------------------------------------

Code scanned:
	Total lines of code: 1498
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 32.0
		High: 1.0
Files skipped (0):
