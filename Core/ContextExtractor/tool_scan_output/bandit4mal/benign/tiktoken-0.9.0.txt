Run started:2025-04-12 12:39:48.887604

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/core.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
171	        encoder = functools.partial(self.encode_ordinary)
172	        with ThreadPoolExecutor(num_threads) as e:
173	            return list(e.map(encoder, text))

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/core.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
201	        )
202	        with ThreadPoolExecutor(num_threads) as e:
203	            return list(e.map(encoder, text))

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/core.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
338	        decoder = functools.partial(self.decode, errors=errors)
339	        with ThreadPoolExecutor(num_threads) as e:
340	            return list(e.map(decoder, batch))

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/core.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
345	        """Decodes a batch (list of lists of tokens) into a list of bytes."""
346	        with ThreadPoolExecutor(num_threads) as e:
347	            return list(e.map(self.decode_bytes, batch))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
16	        with blobfile.BlobFile(blobpath, "rb") as f:
17	            return f.read()
18	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	
22	    resp = requests.get(blobpath)
23	    resp.raise_for_status()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
52	        with open(cache_path, "rb") as f:
53	            data = f.read()
54	        if expected_hash is None or check_hash(data, expected_hash):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
75	        with open(tmp_filename, "wb") as f:
76	            f.write(contents)
77	        os.rename(tmp_filename, cache_path)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
75	        with open(tmp_filename, "wb") as f:
76	            f.write(contents)
77	        os.rename(tmp_filename, cache_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
142	        for token, rank in sorted(bpe_ranks.items(), key=lambda x: x[1]):
143	            f.write(base64.b64encode(token) + b" " + str(rank).encode() + b"\n")
144	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
142	        for token, rank in sorted(bpe_ranks.items(), key=lambda x: x[1]):
143	            f.write(base64.b64encode(token) + b" " + str(rank).encode() + b"\n")
144	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
142	        for token, rank in sorted(bpe_ranks.items(), key=lambda x: x[1]):
143	            f.write(base64.b64encode(token) + b" " + str(rank).encode() + b"\n")
144	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:143
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
142	        for token, rank in sorted(bpe_ranks.items(), key=lambda x: x[1]):
143	            f.write(base64.b64encode(token) + b" " + str(rank).encode() + b"\n")
144	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
154	            token, rank = line.split()
155	            ret[base64.b64decode(token)] = int(rank)
156	        except Exception as e:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken/load.py:155
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
154	            token, rank = line.split()
155	            ret[base64.b64decode(token)] = int(rank)
156	        except Exception as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken_ext/openai_public.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    mergeable_ranks = data_gym_to_mergeable_bpe_ranks(
19	        vocab_bpe_file="https://openaipublic.blob.core.windows.net/gpt-2/encodings/main/vocab.bpe",
20	        encoder_json_file="https://openaipublic.blob.core.windows.net/gpt-2/encodings/main/encoder.json",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken_ext/openai_public.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        vocab_bpe_file="https://openaipublic.blob.core.windows.net/gpt-2/encodings/main/vocab.bpe",
20	        encoder_json_file="https://openaipublic.blob.core.windows.net/gpt-2/encodings/main/encoder.json",
21	        vocab_bpe_hash="1ce1664773c50f3e0cc8842619a93edc4624525b728b188a9e0be33b7726adc5",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken_ext/openai_public.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    mergeable_ranks = load_tiktoken_bpe(
35	        "https://openaipublic.blob.core.windows.net/encodings/r50k_base.tiktoken",
36	        expected_hash="306cd27f03c1a714eca7108e03d66b7dc042abe8c258b44c199a7ed9838dd930",
37	    )
38	    return {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken_ext/openai_public.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	    mergeable_ranks = load_tiktoken_bpe(
49	        "https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken",
50	        expected_hash="94b5ca7dff4d00767bc256fdd1b27e5b17361d7b8a5f968547f9f23eb70d2069",
51	    )
52	    return {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken_ext/openai_public.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	    mergeable_ranks = load_tiktoken_bpe(
63	        "https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken",
64	        expected_hash="94b5ca7dff4d00767bc256fdd1b27e5b17361d7b8a5f968547f9f23eb70d2069",
65	    )
66	    special_tokens = {ENDOFTEXT: 50256, FIM_PREFIX: 50281, FIM_MIDDLE: 50282, FIM_SUFFIX: 50283}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken_ext/openai_public.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	    mergeable_ranks = load_tiktoken_bpe(
77	        "https://openaipublic.blob.core.windows.net/encodings/cl100k_base.tiktoken",
78	        expected_hash="223921b76ee99bde995b7ff738513eef100fb51d18c93597a113bcffe865b2a7",
79	    )
80	    special_tokens = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tiktoken-0.9.0/tiktoken-0.9.0/tiktoken_ext/openai_public.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	    mergeable_ranks = load_tiktoken_bpe(
97	        "https://openaipublic.blob.core.windows.net/encodings/o200k_base.tiktoken",
98	        expected_hash="446a9538cb6c348e3516120d7c08b09f57c36495e2acfffe59a5bf8b0cfb1a2d",
99	    )
100	    special_tokens = {ENDOFTEXT: 199999, ENDOFPROMPT: 200018}

--------------------------------------------------

Code scanned:
	Total lines of code: 1282
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 2.0
Files skipped (0):
