Run started:2025-04-12 17:00:38.115791

Test results:
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/build_debian_packages.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
131	                "-e",
132	                "TARGET_USERID=%i" % (os.getuid(),),
133	                "-e",

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/build_debian_packages.py:132
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
131	                "-e",
132	                "TARGET_USERID=%i" % (os.getuid(),),
133	                "-e",

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/build_debian_packages.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
174	
175	    signal.signal(signal.SIGINT, sig)
176	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/build_debian_packages.py:175
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
174	
175	    signal.signal(signal.SIGINT, sig)
176	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/build_debian_packages.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
176	
177	    with ThreadPoolExecutor(max_workers=jobs) as e:
178	        res = e.map(lambda dist: builder.run_build(dist, skip_tests), dists)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/check_pydantic_models.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
263	    globals_ = locals_ = {}
264	    exec(textwrap.dedent(source), globals_, locals_)
265	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/check_schema_delta.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
39	    locals: Dict[str, Any] = {}
40	    exec(r, locals)
41	    current_schema_version = locals["SCHEMA_VERSION"]

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/check_schema_delta.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
48	    new_locals: Dict[str, Any] = {}
49	    exec(local_schema, new_locals)
50	    local_schema_version = new_locals["SCHEMA_VERSION"]

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/federation_client.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
67	    output_len = 4 * ((input_len + 2) // 3) + (input_len + 2) % 3 - 2
68	    output_bytes = base64.b64encode(input_bytes)
69	    output_string = output_bytes[:output_len].decode("ascii")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/federation_client.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
67	    output_len = 4 * ((input_len + 2) // 3) + (input_len + 2) % 3 - 2
68	    output_bytes = base64.b64encode(input_bytes)
69	    output_string = output_bytes[:output_len].decode("ascii")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/federation_client.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
156	
157	    return s.request(
158	        method=method,
159	        url=dest,
160	        headers=headers,
161	        verify=verify_tls,
162	        data=content,
163	        stream=True,
164	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/federation_client.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
234	
235	    result = request(
236	        args.method,
237	        args.server_name,
238	        key,
239	        args.destination,
240	        args.path,
241	        content=args.body,
242	        verify_tls=not args.insecure,
243	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/federation_client.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
381	        try:
382	            resp = requests.get(uri)
383	            if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
312	    click.launch(
313	        f"https://github.com/element-hq/synapse/blob/{synapse_repo.active_branch.name}/CHANGES.md"
314	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
383	        print("or one of the GH_TOKEN or GITHUB_TOKEN env vars.)")
384	        click.launch(f"https://github.com/element-hq/synapse/releases/edit/{tag_name}")
385	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
388	            click.launch(
389	                f"https://github.com/element-hq/synapse/actions?query=branch%3A{tag_name}"
390	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
407	    click.launch(
408	        f"https://github.com/element-hq/synapse/actions?query=branch%3A{tag_name}"
409	    )

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
515	            click.echo(f"Downloading {name} into {filename}")
516	            urllib.request.urlretrieve(asset_download_url, filename=filename)
517	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
576	    # but use a token if we have one to reduce the chance of being rate-limited.
577	    url = f"https://api.github.com/repos/element-hq/synapse/actions/runs?branch={tag_name}"
578	    headers = {"Accept": "application/vnd.github+json"}

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
585	        time.sleep(5 * 60)
586	        response = urllib.request.urlopen(req)
587	        resp = json.loads(response.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
586	        response = urllib.request.urlopen(req)
587	        resp = json.loads(response.read())
588	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
694	    click.echo(
695	        f"""
696	Hi everyone. Synapse {current_version} has just been released.
697	
698	[notes](https://github.com/element-hq/synapse/releases/tag/{tag_name}) | \
699	[docker](https://hub.docker.com/r/matrixdotorg/synapse/tags?name={tag_name}) | \
700	[debs](https://packages.matrix.org/debian/) | \
701	[pypi](https://pypi.org/project/matrix-synapse/{current_version}/)"""
702	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
694	    click.echo(
695	        f"""
696	Hi everyone. Synapse {current_version} has just been released.
697	
698	[notes](https://github.com/element-hq/synapse/releases/tag/{tag_name}) | \
699	[docker](https://hub.docker.com/r/matrixdotorg/synapse/tags?name={tag_name}) | \
700	[debs](https://packages.matrix.org/debian/) | \
701	[pypi](https://pypi.org/project/matrix-synapse/{current_version}/)"""
702	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
694	    click.echo(
695	        f"""
696	Hi everyone. Synapse {current_version} has just been released.
697	
698	[notes](https://github.com/element-hq/synapse/releases/tag/{tag_name}) | \
699	[docker](https://hub.docker.com/r/matrixdotorg/synapse/tags?name={tag_name}) | \
700	[debs](https://packages.matrix.org/debian/) | \
701	[pypi](https://pypi.org/project/matrix-synapse/{current_version}/)"""
702	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
733	    click.echo("2. Check for any release blockers before proceeding.")
734	    click.echo("    https://github.com/element-hq/synapse/labels/X-Release-Blocker")
735	    click.echo(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
843	    with open("CHANGES.md") as f:
844	        changes = f.read()
845	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
917	    with open("CHANGES.md", "r+") as f:
918	        existing_content = f.read()
919	        f.seek(0, 0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
919	        f.seek(0, 0)
920	        f.write(new_changes)
921	        f.write("\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
919	        f.seek(0, 0)
920	        f.write(new_changes)
921	        f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
920	        f.write(new_changes)
921	        f.write("\n")
922	        f.write(existing_content)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
920	        f.write(new_changes)
921	        f.write("\n")
922	        f.write(existing_content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
921	        f.write("\n")
922	        f.write(existing_content)
923	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
921	        f.write("\n")
922	        f.write(existing_content)
923	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/release.py:954
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
953	        number = match.group(2)
954	        return f"* {desc}. ([\\#{number}](https://github.com/element-hq/synapse/issues/{number}))"
955	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/scripts-dev/schema_versions.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
84	            locals: Dict[str, Any] = {}
85	            exec(schema_file.data_stream.read().decode("utf-8"), {}, locals)
86	            schema_version = locals["SCHEMA_VERSION"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/setup.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	    'description': 'Homeserver for the Matrix decentralised comms protocol',
254	    'long_description': '.. image:: ./docs/element_logo_white_bg.svg\n   :height: 60px\n\n**Element Synapse - Matrix homeserver implementation**\n\n|support| |development| |documentation| |license| |pypi| |python|\n\nSynapse is an open source `Matrix <https://matrix.org>`__ homeserver\nimplementation, written and maintained by `Element <https://element.io>`_.\n`Matrix <https://github.com/matrix-org>`__ is the open standard for\nsecure and interoperable real time communications. You can directly run\nand manage the source code in this repository, available under an AGPL\nlicense (or alternatively under a commercial license from Element).\nThere is no support provided by Element unless you have a\nsubscription from Element.\n\nSubscription\n============\n\nFor those that need an enterprise-ready solution, Element\nServer Suite (ESS) is `available via subscription <https://element.io/pricing>`_.\nESS builds on Synapse to offer a complete Matrix-based backend including the full\n`Admin Console product <https://element.io/enterprise-functionality/admin-console>`_,\ngiving admins the power to easily manage an organization-wide\ndeployment. It includes advanced identity management, auditing,\nmoderation and data retention options as well as Long Term Support and\nSLAs. ESS can be used to support any Matrix-based frontend client.\n\n.. contents::\n\nüõ†Ô∏è Installing and configuration\n===============================\n\nThe Synapse documentation describes `how to install Synapse <https://element-hq.github.io/synapse/latest/setup/installation.html>`_. We recommend using\n`Docker images <https://element-hq.github.io/synapse/latest/setup/installation.html#docker-images-and-ansible-playbooks>`_ or `Debian packages from Matrix.org\n<https://element-hq.github.io/synapse/latest/setup/installation.html#matrixorg-packages>`_.\n\n.. _federation:\n\nSynapse has a variety of `config options\n<https://element-hq.github.io/synapse/latest/usage/configuration/config_documentation.html>`_\nwhich can be used to customise its behaviour after installation.\nThere are additional details on how to `configure Synapse for federation here\n<https://element-hq.github.io/synapse/latest/federate.html>`_.\n\n.. _reverse-proxy:\n\nUsing a reverse proxy with Synapse\n----------------------------------\n\nIt is recommended to put a reverse proxy such as\n`nginx <https://nginx.org/en/docs/http/ngx_http_proxy_module.html>`_,\n`Apache <https://httpd.apache.org/docs/current/mod/mod_proxy_http.html>`_,\n`Caddy <https://caddyserver.com/docs/quick-starts/reverse-proxy>`_,\n`HAProxy <https://www.haproxy.org/>`_ or\n`relayd <https://man.openbsd.org/relayd.8>`_ in front of Synapse. One advantage of\ndoing so is that it means that you can expose the default https port (443) to\nMatrix clients without needing to run Synapse with root privileges.\nFor information on configuring one, see `the reverse proxy docs\n<https://element-hq.github.io/synapse/latest/reverse_proxy.html>`_.\n\nUpgrading an existing Synapse\n-----------------------------\n\nThe instructions for upgrading Synapse are in `the upgrade notes`_.\nPlease check these instructions as upgrading may require extra steps for some\nversions of Synapse.\n\n.. _the upgrade notes: https://element-hq.github.io/synapse/develop/upgrade.html\n\n\nPlatform dependencies\n---------------------\n\nSynapse uses a number of platform dependencies such as Python and PostgreSQL,\nand aims to follow supported upstream versions. See the\n`deprecation policy <https://element-hq.github.io/synapse/latest/deprecation_policy.html>`_\nfor more details.\n\n\nSecurity note\n-------------\n\nMatrix serves raw, user-supplied data in some APIs -- specifically the `content\nrepository endpoints`_.\n\n.. _content repository endpoints: https://matrix.org/docs/spec/client_server/latest.html#get-matrix-media-r0-download-servername-mediaid\n\nWhilst we make a reasonable effort to mitigate against XSS attacks (for\ninstance, by using `CSP`_), a Matrix homeserver should not be hosted on a\ndomain hosting other web applications. This especially applies to sharing\nthe domain with Matrix web clients and other sensitive applications like\nwebmail. See\nhttps://developer.github.com/changes/2014-04-25-user-content-security for more\ninformation.\n\n.. _CSP: https://github.com/matrix-org/synapse/pull/1021\n\nIdeally, the homeserver should not simply be on a different subdomain, but on\na completely different `registered domain`_ (also known as top-level site or\neTLD+1). This is because `some attacks`_ are still possible as long as the two\napplications share the same registered domain.\n\n.. _registered domain: https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-03#section-2.3\n\n.. _some attacks: https://en.wikipedia.org/wiki/Session_fixation#Attacks_using_cross-subdomain_cookie\n\nTo illustrate this with an example, if your Element Web or other sensitive web\napplication is hosted on ``A.example1.com``, you should ideally host Synapse on\n``example2.com``. Some amount of protection is offered by hosting on\n``B.example1.com`` instead, so this is also acceptable in some scenarios.\nHowever, you should *not* host your Synapse on ``A.example1.com``.\n\nNote that all of the above refers exclusively to the domain used in Synapse\'s\n``public_baseurl`` setting. In particular, it has no bearing on the domain\nmentioned in MXIDs hosted on that server.\n\nFollowing this advice ensures that even if an XSS is found in Synapse, the\nimpact to other applications will be minimal.\n\n\nüß™ Testing a new installation\n=============================\n\nThe easiest way to try out your new Synapse installation is by connecting to it\nfrom a web client.\n\nUnless you are running a test instance of Synapse on your local machine, in\ngeneral, you will need to enable TLS support before you can successfully\nconnect from a client: see\n`TLS certificates <https://element-hq.github.io/synapse/latest/setup/installation.html#tls-certificates>`_.\n\nAn easy way to get started is to login or register via Element at\nhttps://app.element.io/#/login or https://app.element.io/#/register respectively.\nYou will need to change the server you are logging into from ``matrix.org``\nand instead specify a Homeserver URL of ``https://<server_name>:8448``\n(or just ``https://<server_name>`` if you are using a reverse proxy).\nIf you prefer to use another client, refer to our\n`client breakdown <https://matrix.org/ecosystem/clients/>`_.\n\nIf all goes well you should at least be able to log in, create a room, and\nstart sending messages.\n\n.. _`client-user-reg`:\n\nRegistering a new user from a client\n------------------------------------\n\nBy default, registration of new users via Matrix clients is disabled. To enable\nit:\n\n1. In the\n   `registration config section <https://element-hq.github.io/synapse/latest/usage/configuration/config_documentation.html#registration>`_\n   set ``enable_registration: true`` in ``homeserver.yaml``.\n2. Then **either**:\n\n   a. set up a `CAPTCHA <https://element-hq.github.io/synapse/latest/CAPTCHA_SETUP.html>`_, or\n   b. set ``enable_registration_without_verification: true`` in ``homeserver.yaml``.\n\nWe **strongly** recommend using a CAPTCHA, particularly if your homeserver is exposed to\nthe public internet. Without it, anyone can freely register accounts on your homeserver.\nThis can be exploited by attackers to create spambots targeting the rest of the Matrix\nfederation.\n\nYour new user name will be formed partly from the ``server_name``, and partly\nfrom a localpart you specify when you create the account. Your name will take\nthe form of::\n\n    @localpart:my.domain.name\n\n(pronounced "at localpart on my dot domain dot name").\n\nAs when logging in, you will need to specify a "Custom server".  Specify your\ndesired ``localpart`` in the \'User name\' box.\n\nüéØ Troubleshooting and support\n==============================\n\nüöÄ Professional support\n-----------------------\n\nEnterprise quality support for Synapse including SLAs is available as part of an\n`Element Server Suite (ESS) <https://element.io/pricing>`_ subscription.\n\nIf you are an existing ESS subscriber then you can raise a `support request <https://ems.element.io/support>`_\nand access the `knowledge base <https://ems-docs.element.io>`_.\n\nü§ù Community support\n--------------------\n\nThe `Admin FAQ <https://element-hq.github.io/synapse/latest/usage/administration/admin_faq.html>`_\nincludes tips on dealing with some common problems. For more details, see\n`Synapse\'s wider documentation <https://element-hq.github.io/synapse/latest/>`_.\n\nFor additional support installing or managing Synapse, please ask in the community\nsupport room |room|_ (from a matrix.org account if necessary). We do not use GitHub\nissues for support requests, only for bug reports and feature requests.\n\n.. |room| replace:: ``#synapse:matrix.org``\n.. _room: https://matrix.to/#/#synapse:matrix.org\n\n.. |docs| replace:: ``docs``\n.. _docs: docs\n\n\U0001faaa Identity Servers\n===================\n\nIdentity servers have the job of mapping email addresses and other 3rd Party\nIDs (3PIDs) to Matrix user IDs, as well as verifying the ownership of 3PIDs\nbefore creating that mapping.\n\n**They are not where accounts or credentials are stored - these live on home\nservers. Identity Servers are just for mapping 3rd party IDs to matrix IDs.**\n\nThis process is very security-sensitive, as there is obvious risk of spam if it\nis too easy to sign up for Matrix accounts or harvest 3PID data. In the longer\nterm, we hope to create a decentralised system to manage it (`matrix-doc #712\n<https://github.com/matrix-org/matrix-doc/issues/712>`_), but in the meantime,\nthe role of managing trusted identity in the Matrix ecosystem is farmed out to\na cluster of known trusted ecosystem partners, who run \'Matrix Identity\nServers\' such as `Sydent <https://github.com/matrix-org/sydent>`_, whose role\nis purely to authenticate and track 3PID logins and publish end-user public\nkeys.\n\nYou can host your own copy of Sydent, but this will prevent you reaching other\nusers in the Matrix ecosystem via their email address, and prevent them finding\nyou. We therefore recommend that you use one of the centralised identity servers\nat ``https://matrix.org`` or ``https://vector.im`` for now.\n\nTo reiterate: the Identity server will only be used if you choose to associate\nan email address with your account, or send an invite to another user via their\nemail address.\n\n\nüõ†Ô∏è Development\n==============\n\nWe welcome contributions to Synapse from the community!\nThe best place to get started is our\n`guide for contributors <https://element-hq.github.io/synapse/latest/development/contributing_guide.html>`_.\nThis is part of our larger `documentation <https://element-hq.github.io/synapse/latest>`_, which includes\n\ninformation for Synapse developers as well as Synapse administrators.\nDevelopers might be particularly interested in:\n\n* `Synapse\'s database schema <https://element-hq.github.io/synapse/latest/development/database_schema.html>`_,\n* `notes on Synapse\'s implementation details <https://element-hq.github.io/synapse/latest/development/internal_documentation/index.html>`_, and\n* `how we use git <https://element-hq.github.io/synapse/latest/development/git.html>`_.\n\nAlongside all that, join our developer community on Matrix:\n`#synapse-dev:matrix.org <https://matrix.to/#/#synapse-dev:matrix.org>`_, featuring real humans!\n\nCopyright and Licensing\n=======================\n\nCopyright 2014-2017 OpenMarket Ltd\nCopyright 2017 Vector Creations Ltd\nCopyright 2017-2025 New Vector Ltd \n\nThis software is dual-licensed by New Vector Ltd (Element). It can be used either:\n  \n(1) for free under the terms of the GNU Affero General Public License (as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version); OR\n  \n(2) under the terms of a paid-for Element Commercial License agreement between you and Element (the terms of which may vary depending on what you and Element have agreed to).\nUnless required by applicable law or agreed to in writing, software distributed under the Licenses is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the Licenses for the specific language governing permissions and limitations under the Licenses.\n\n\n.. |support| image:: https://img.shields.io/badge/matrix-community%20support-success\n  :alt: (get community support in #synapse:matrix.org)\n  :target: https://matrix.to/#/#synapse:matrix.org\n\n.. |development| image:: https://img.shields.io/matrix/synapse-dev:matrix.org?label=development&logo=matrix\n  :alt: (discuss development on #synapse-dev:matrix.org)\n  :target: https://matrix.to/#/#synapse-dev:matrix.org\n\n.. |documentation| image:: https://img.shields.io/badge/documentation-%E2%9C%93-success\n  :alt: (Rendered documentation on GitHub Pages)\n  :target: https://element-hq.github.io/synapse/latest/\n\n.. |license| image:: https://img.shields.io/github/license/element-hq/synapse\n  :alt: (check license in LICENSE file)\n  :target: LICENSE\n\n.. |pypi| image:: https://img.shields.io/pypi/v/matrix-synapse\n  :alt: (latest version released on PyPi)\n  :target: https://pypi.org/project/matrix-synapse\n\n.. |python| image:: https://img.shields.io/pypi/pyversions/matrix-synapse\n  :alt: (supported python versions)\n  :target: https://pypi.org/project/matrix-synapse\n',
255	    'author': 'Matrix.org Team and Contributors',
256	    'author_email': 'packages@matrix.org',
257	    'maintainer': 'None',
258	    'maintainer_email': 'None',
259	    'url': 'https://github.com/element-hq/synapse',
260	    'packages': packages,
261	    'package_data': package_data,
262	    'install_requires': install_requires,
263	    'extras_require': extras_require,
264	    'entry_points': entry_points,
265	    'python_requires': '>=3.9.0,<4.0.0',
266	}
267	from build_rust import *
268	build(setup_kwargs)
269	
270	setup(**setup_kwargs)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/setup.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	    'maintainer_email': 'None',
259	    'url': 'https://github.com/element-hq/synapse',
260	    'packages': packages,
261	    'package_data': package_data,
262	    'install_requires': install_requires,
263	    'extras_require': extras_require,
264	    'entry_points': entry_points,
265	    'python_requires': '>=3.9.0,<4.0.0',
266	}
267	from build_rust import *
268	build(setup_kwargs)
269	
270	setup(**setup_kwargs)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/generate_workers_map.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
246	    # Load, process and sanity-check the config.
247	    hs_config = yaml.safe_load(args.config_path)
248	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	
43	_DEFAULT_SERVER_URL = "http://localhost:8008"
44	
45	
46	def request_registration(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	    # Get the nonce
60	    r = requests.get(url)
61	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
97	    _print("Sending registration request...")
98	    r = requests.post(url, json=data)
99	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
126	        try:
127	            default_user: Optional[str] = getpass.getuser()
128	        except Exception:

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:127
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
126	        try:
127	            default_user: Optional[str] = getpass.getuser()
128	        except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	
264	        secret = config.get("registration_shared_secret")
265	        secret_file = config.get("registration_shared_secret_path")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
264	        secret = config.get("registration_shared_secret")
265	        secret_file = config.get("registration_shared_secret_path")
266	        if secret_file:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
338	    # try to find a listener in the config. Returns a host:port pair
339	    for listener in config.get("listeners", []):
340	        if listener.get("type") != "http" or listener.get("tls", False):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	    for listener in config.get("listeners", []):
340	        if listener.get("type") != "http" or listener.get("tls", False):
341	            continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	    for listener in config.get("listeners", []):
340	        if listener.get("type") != "http" or listener.get("tls", False):
341	            continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
344	            name == "client"
345	            for resource in listener.get("resources", [])
346	            for name in resource.get("names", [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
345	            for resource in listener.get("resources", [])
346	            for name in resource.get("names", [])
347	        ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/register_new_matrix_user.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
350	        # TODO: consider bind_addresses
351	        return f"http://localhost:{listener['port']}"
352	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synapse_port_db.py:1457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1456	    if not os.path.isfile(args.sqlite_database):
1457	        sys.stderr.write(
1458	            "The sqlite database you specified does not exist, please check that you have the"
1459	            "correct path."

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synapse_port_db.py:1476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1475	    if "database" not in hs_config:
1476	        sys.stderr.write("The configuration file must have a 'database' section.\n")
1477	        sys.exit(4)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synapse_port_db.py:1482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1481	    if "name" not in postgres_config:
1482	        sys.stderr.write("Malformed database config: no 'name'\n")
1483	        sys.exit(2)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synapse_port_db.py:1485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1484	    if postgres_config["name"] != "psycopg2":
1485	        sys.stderr.write("Database must use the 'psycopg2' connector.\n")
1486	        sys.exit(3)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synapse_port_db.py:1527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1526	
1527	        sys.stderr.write(end_error)
1528	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	        with open(f"/proc/{pid}/status") as status_file:
67	            if "zombie" in status_file.read():
68	                return False

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	    if not should_colour:
88	        stream.write(message + "\n")
89	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	    else:
90	        stream.write(colour + message + NORMAL + "\n")
91	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
93	def abort(message: str, colour: str = RED, stream: TextIO = sys.stderr) -> NoReturn:
94	    write(message, colour, stream)
95	    sys.exit(1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
110	
111	    if os.path.exists(pidfile) and pid_running(int(open(pidfile).read())):
112	        print(app + " already running")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
122	        subprocess.check_call(args)
123	        write("started %s(%s)" % (app, ",".join(config_files)), colour=GREEN)
124	        return True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
133	        err += "."
134	        write(err, colour=RED, stream=sys.stderr)
135	        return False

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
148	    if os.path.exists(pidfile):
149	        pid = int(open(pidfile).read())
150	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
151	            os.kill(pid, signal.SIGTERM)
152	            write("stopped %s" % (app,), colour=GREEN)
153	            return pid

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	            if err.errno == errno.ESRCH:
156	                write("%s not running" % (app,), colour=YELLOW)
157	            elif err.errno == errno.EPERM:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
161	    else:
162	        write(
163	            "No running worker of %s found (from %s)\nThe process might be managed by another controller (e.g. systemd)"
164	            % (app, pidfile),
165	            colour=YELLOW,
166	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
210	    if options.worker and options.all_processes:
211	        write('Cannot use "--worker" with "--all-processes"', stream=sys.stderr)
212	        sys.exit(1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
213	    if not options.daemonize and options.all_processes:
214	        write('Cannot use "--no-daemonize" with "--all-processes"', stream=sys.stderr)
215	        sys.exit(1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
219	    if not os.path.exists(configfile):
220	        write(
221	            f"Config file {configfile} does not exist.\n"
222	            f"To generate a config file, run:\n"
223	            f"    {sys.executable} -m {MAIN_PROCESS}"
224	            f" -c {configfile} --generate-config"
225	            f" --server-name=<server name> --report-stats=<yes/no>\n",
226	            stream=sys.stderr,
227	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
242	    if cache_factor:
243	        write(SYNCTL_CACHE_FACTOR_WARNING)
244	        os.environ["SYNAPSE_CACHE_FACTOR"] = str(cache_factor)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
254	        if not os.path.exists(worker_configfile):
255	            write(
256	                "No worker config found at %r" % (worker_configfile,), stream=sys.stderr
257	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
266	        if not os.path.isdir(worker_configdir):
267	            write(
268	                "No worker config directory found at %r" % (worker_configdir,),
269	                stream=sys.stderr,
270	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
326	        if len(running_pids) > 0:
327	            write("Waiting for processes to exit...")
328	            for running_pid in running_pids:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/_scripts/synctl.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
330	                    time.sleep(0.2)
331	            write("All processes exited")
332	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/api/auth/base.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
375	            user_agent = get_request_user_agent(request)
376	            access_token = self.get_access_token_from_request(request)
377	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/api/auth/internal.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
150	        try:
151	            access_token = self.get_access_token_from_request(request)
152	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/api/auth/internal.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
186	
187	            await self._record_request(request, requester)
188	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/api/auth/msc3861_delegated.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
318	        try:
319	            response = await self._http_client.request(
320	                method="POST",
321	                uri=uri,
322	                data=body.encode("utf-8"),
323	                headers=headers,
324	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/api/auth/msc3861_delegated.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
364	    ) -> Requester:
365	        access_token = self.get_access_token_from_request(request)
366	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/api/auth/msc3861_delegated.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
374	        if access_token != self._admin_token():
375	            await self._record_request(request, requester)
376	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/api/filtering.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	USER_FILTER_SCHEMA = {
122	    "$schema": "http://json-schema.org/draft-04/schema#",
123	    "description": "schema for a Sync filter",
124	    "type": "object",
125	    "definitions": {
126	        "room_id_array": ROOM_ID_ARRAY_SCHEMA,
127	        "user_id_array": USER_ID_ARRAY_SCHEMA,
128	        "filter": FILTER_SCHEMA,
129	        "room_filter": ROOM_FILTER_SCHEMA,
130	        "room_event_filter": ROOM_EVENT_FILTER_SCHEMA,
131	    },
132	    "properties": {
133	        "presence": {"$ref": "#/definitions/filter"},
134	        "account_data": {"$ref": "#/definitions/filter"},
135	        "room": {"$ref": "#/definitions/room_filter"},
136	        "event_format": {"type": "string", "enum": ["client", "federation"]},
137	        "event_fields": {"type": "array", "items": {"type": "string"}},
138	    },
139	    "additionalProperties": True,  # Allow new fields for forward compatibility
140	}
141	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/__init__.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
54	    """
55	    if address == "0.0.0.0" and "::" in bind_addresses:
56	        logger.warning(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/_base.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
209	    line_length = min(max(len(line) for line in message_lines), 80) + 2
210	    sys.stderr.write("*" * line_length + "\n")
211	    for line in message_lines:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/_base.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
211	    for line in message_lines:
212	        sys.stderr.write(" %s\n" % (line.rstrip(),))
213	    sys.stderr.write("*" * line_length + "\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/_base.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
212	        sys.stderr.write(" %s\n" % (line.rstrip(),))
213	    sys.stderr.write("*" * line_length + "\n")
214	    sys.exit(1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/_base.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
562	            # safe.
563	            reactor.callFromThread(handle_sighup, *args, **kwargs)
564	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/_base.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
564	
565	        signal.signal(signal.SIGHUP, run_sighup)
566	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/_base.py:565
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
564	
565	        signal.signal(signal.SIGHUP, run_sighup)
566	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/_base.py:732
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
731	    try:
732	        with socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM) as sock:
733	            sock.connect(addr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/_base.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
732	        with socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM) as sock:
733	            sock.connect(addr)
734	            sock.sendall(state)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/_base.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
733	            sock.connect(addr)
734	            sock.sendall(state)
735	    except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/admin_cmd.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
286	    except ConfigError as e:
287	        sys.stderr.write("\n" + str(e) + "\n")
288	        sys.exit(1)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/admin_cmd.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
286	    except ConfigError as e:
287	        sys.stderr.write("\n" + str(e) + "\n")
288	        sys.exit(1)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/complement_fork_starter.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
90	    for sig, handler in _original_signal_handlers.items():
91	        signal.signal(sig, handler)
92	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/complement_fork_starter.py:91
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
90	    for sig, handler in _original_signal_handlers.items():
91	        signal.signal(sig, handler)
92	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/complement_fork_starter.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
151	
152	    update_proc = multiprocessing.Process(
153	        target=_worker_entrypoint,
154	        args=(
155	            update_synapse_database.main,
156	            proxy_reactor,
157	            [
158	                "update_synapse_database",
159	                "--database-config",
160	                ns.db_config,
161	                "--run-background-updates",
162	            ],

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/complement_fork_starter.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
184	    for sig in (signal.SIGINT, signal.SIGTERM):
185	        _original_signal_handlers[sig] = signal.signal(sig, handle_signal)
186	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/complement_fork_starter.py:185
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
184	    for sig in (signal.SIGINT, signal.SIGTERM):
185	        _original_signal_handlers[sig] = signal.signal(sig, handle_signal)
186	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/complement_fork_starter.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
193	    for func, worker_args in zip(worker_functions, args_by_worker):
194	        process = multiprocessing.Process(
195	            target=_worker_entrypoint, args=(func, proxy_reactor, worker_args)
196	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/generic_worker.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
310	    except ConfigError as e:
311	        sys.stderr.write("\n" + str(e) + "\n")
312	        sys.exit(1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/homeserver.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
321	    except ConfigError as e:
322	        sys.stderr.write("\n")
323	        for f in format_config_error(e):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/homeserver.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
323	        for f in format_config_error(e):
324	            sys.stderr.write(f)
325	        sys.stderr.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/app/homeserver.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
324	            sys.stderr.write(f)
325	        sys.stderr.write("\n")
326	        sys.exit(1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/_base.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	
126	CONFIG_FILE_HEADER = """\
127	# Configuration file for Synapse.
128	#
129	# This is a YAML file: see [1] for a quick introduction. Note in particular
130	# that *indentation is important*: all the elements of a list or dictionary
131	# should have the same indentation.
132	#
133	# [1] https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html
134	#
135	# For more information on how to configure Synapse, including a complete accounting of
136	# each option, go to docs/usage/configuration/config_documentation.md or
137	# https://element-hq.github.io/synapse/latest/usage/configuration/config_documentation.html
138	"""
139	
140	
141	def path_exists(file_path: str) -> bool:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/_base.py:808
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
807	                with open(config_path, "w") as config_file:
808	                    config_file.write(config_str)
809	                    config_file.write("\n\n# vim:ft=yaml")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/_base.py:809
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
808	                    config_file.write(config_str)
809	                    config_file.write("\n\n# vim:ft=yaml")
810	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/_base.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
810	
811	                config_dict = yaml.safe_load(config_str)
812	                obj.generate_missing_files(config_dict, config_dir_path)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/_base.py:923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
922	        with open(config_file) as file_stream:
923	            yaml_config = yaml.safe_load(file_stream)
924	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/_base.py:1070
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1069	        with open(file_path) as file_stream:
1070	            return file_stream.read()
1071	    except OSError as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/account_validity.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	LEGACY_TEMPLATE_DIR_WARNING = """
30	This server's configuration file is using the deprecated 'template_dir' setting in the
31	'account_validity' section. Support for this setting has been deprecated and will be
32	removed in a future version of Synapse. Server admins should instead use the new
33	'custom_template_directory' setting documented here:
34	https://element-hq.github.io/synapse/latest/templates.html
35	---------------------------------------------------------------------------------------"""
36	
37	
38	class AccountValidityConfig(Config):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/api.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	
79	_ROOM_INVITE_STATE_TYPES_WARNING = """\
80	WARNING: The 'room_invite_state_types' configuration setting is now deprecated,
81	and replaced with 'room_prejoin_state'. New features may not work correctly
82	unless 'room_invite_state_types' is removed. See the config documentation at
83	    https://element-hq.github.io/synapse/latest/usage/configuration/config_documentation.html#room_prejoin_state
84	for details of 'room_prejoin_state'.
85	--------------------------------------------------------------------------------
86	"""
87	
88	_DEFAULT_PREJOIN_STATE_TYPES_AND_STATE_KEYS = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/captcha.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	            "recaptcha_siteverify_api",
64	            "https://www.recaptcha.net/recaptcha/api/siteverify",
65	        )
66	        self.recaptcha_template = self.read_template("recaptcha.html")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/emailconfig.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	
58	LEGACY_TEMPLATE_DIR_WARNING = """
59	This server's configuration file is using the deprecated 'template_dir' setting in the
60	'email' section. Support for this setting has been deprecated and will be removed in a
61	future version of Synapse. Server admins should instead use the new
62	'custom_template_directory' setting documented here:
63	https://element-hq.github.io/synapse/latest/templates.html
64	---------------------------------------------------------------------------------------"""
65	
66	
67	@attr.s(slots=True, frozen=True, auto_attribs=True)
68	class EmailSubjectConfig:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/key.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
371	TRUSTED_KEY_SERVERS_SCHEMA = {
372	    "$schema": "http://json-schema.org/draft-04/schema#",
373	    "description": "schema for the trusted_key_servers setting",
374	    "type": "array",
375	    "items": {
376	        "type": "object",
377	        "properties": {
378	            "server_name": {"type": "string"},
379	            "verify_keys": {
380	                "type": "object",
381	                # each key must be a base64 string
382	                "additionalProperties": {"type": "string"},
383	            },
384	        },
385	        "required": ["server_name"],
386	    },
387	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/logger.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	DEFAULT_LOG_CONFIG = Template(
55	    """\
56	# Log configuration for Synapse.
57	#

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/logger.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	
140	STRUCTURED_ERROR = """\
141	Support for the structured configuration option was removed in Synapse 1.54.0.
142	You should instead use the standard logging configuration. See
143	https://element-hq.github.io/synapse/v1.54/structured_logging.html
144	"""
145	
146	
147	class LoggingConfig(Config):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/logger.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
196	            with open(log_config, "w") as log_config_file:
197	                log_config_file.write(DEFAULT_LOG_CONFIG.substitute(log_file=log_file))
198	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/logger.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
290	    with open(log_config_path, "rb") as f:
291	        log_config = yaml.safe_load(f.read())
292	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/logger.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
359	    logging.warning(
360	        "Licensed under the AGPL 3.0 license. Website: https://github.com/element-hq/synapse"
361	    )
362	    logging.info("Server hostname: %s", config.server.server_name)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/metrics.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	        self.report_stats_endpoint = config.get(
55	            "report_stats_endpoint", "https://matrix.org/report-usage-stats/push"
56	        )
57	        self.metrics_port = config.get("metrics_port")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/metrics.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
57	        self.metrics_port = config.get("metrics_port")
58	        self.metrics_bind_host = config.get("metrics_bind_host", "127.0.0.1")
59	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/repository.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
243	                config["url_preview_ip_range_blacklist"],
244	                ["0.0.0.0", "::"],
245	                config_path=("url_preview_ip_range_blacklist",),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/server.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	
46	DIRECT_TCP_ERROR = """
47	Using direct TCP replication for workers is no longer supported.
48	
49	Please see https://element-hq.github.io/synapse/latest/upgrade.html#direct-tcp-replication-is-no-longer-supported-migrate-to-redis
50	"""
51	
52	# by default, we attempt to listen on both '::' *and* '0.0.0.0' because some OSes
53	# (Windows, macOS, other BSD/Linux where net.ipv6.bindv6only is set) will only listen
54	# on IPv6 when '::' is set.
55	#
56	# We later check for errors when binding to 0.0.0.0 and ignore them if :: is also in
57	# in the list.
58	DEFAULT_BIND_ADDRESSES = ["::", "0.0.0.0"]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/server.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
57	# in the list.
58	DEFAULT_BIND_ADDRESSES = ["::", "0.0.0.0"]
59	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/server.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	
169	METRICS_PORT_WARNING = """\
170	The metrics_port configuration option is deprecated in Synapse 0.31 in favour of
171	a listener. Please see
172	https://element-hq.github.io/synapse/latest/metrics-howto.html
173	on how to configure the new listener.
174	--------------------------------------------------------------------------------"""
175	
176	
177	KNOWN_LISTENER_TYPES = {

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/server.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
536	        self.ip_range_blocklist = generate_ip_set(
537	            ip_range_blocklist, ["0.0.0.0", "::"], config_path=("ip_range_blacklist",)
538	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/server.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
548	                config["federation_ip_range_blacklist"],
549	                ["0.0.0.0", "::"],
550	                config_path=("federation_ip_range_blacklist",),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/server.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
665	                    port=manhole,
666	                    bind_addresses=["127.0.0.1"],
667	                    type="manhole",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/server.py:713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
712	                    port=metrics_port,
713	                    bind_addresses=[config.get("metrics_bind_host", "127.0.0.1")],
714	                    type="http",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/server.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
819	        unsecure_listeners = []
820	        private_addresses = ["::1", "127.0.0.1"]
821	        if listeners:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/server.py:1031
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1030	                # the metrics listener doesn't support IPv6
1031	                bind_addresses.append("0.0.0.0")
1032	            else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/spam_checker.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	
32	LEGACY_SPAM_CHECKER_WARNING = """
33	This server is using a spam checker module that is implementing the deprecated spam
34	checker interface. Please check with the module's maintainer to see if a new version
35	supporting Synapse's generic modules system is available. For more information, please
36	see https://element-hq.github.io/synapse/latest/modules/index.html
37	---------------------------------------------------------------------------------------"""
38	
39	
40	class SpamCheckerConfig(Config):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/sso.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	
32	LEGACY_TEMPLATE_DIR_WARNING = """
33	This server's configuration file is using the deprecated 'template_dir' setting in the
34	'sso' section. Support for this setting has been deprecated and will be removed in a
35	future version of Synapse. Server admins should instead use the new
36	'custom_template_directory' setting documented here:
37	https://element-hq.github.io/synapse/latest/templates.html
38	---------------------------------------------------------------------------------------"""
39	
40	
41	@attr.s(frozen=True, auto_attribs=True)
42	class SsoAttributeRequirement:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/workers.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	
56	_MISSING_MAIN_PROCESS_INSTANCE_MAP_DATA = """
57	Missing data for a worker to connect to main process. Please include '%s' in the
58	`instance_map` declared in your shared yaml configuration as defined in configuration
59	documentation here:
60	`https://element-hq.github.io/synapse/latest/usage/configuration/config_documentation.html#instance_map`
61	"""
62	
63	WORKER_REPLICATION_SETTING_DEPRECATED_MESSAGE = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/workers.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	
63	WORKER_REPLICATION_SETTING_DEPRECATED_MESSAGE = """
64	'%s' is no longer a supported worker setting, please place '%s' onto your shared
65	configuration under `main` inside the `instance_map`. See workers documentation here:
66	`https://element-hq.github.io/synapse/latest/workers.html#worker-configuration`
67	"""
68	
69	CONFLICTING_WORKER_REPLICATION_SECRET_OPTS_ERROR = """\

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/config/workers.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
288	                    port=manhole,
289	                    bind_addresses=["127.0.0.1"],
290	                    type="manhole",

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/federation_server.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
226	
227	            pdus = await self.handler.on_backfill_request(
228	                origin, room_id, versions, limit
229	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/federation_server.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
686	        )
687	        pdu = await self.handler.on_make_join_request(origin, room_id, user_id)
688	        return {"event": pdu.get_templated_pdu_json(), "room_version": room_version}

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/federation_server.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
709	            raise SynapseError(403, errmsg, Codes.FORBIDDEN)
710	        ret_pdu = await self.handler.on_invite_request(origin, pdu, room_version)
711	        time_now = self._clock.time_msec()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/federation_server.py:784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
783	        await self.check_server_matches_acl(origin_host, room_id)
784	        pdu = await self.handler.on_make_leave_request(origin, room_id, user_id)
785	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/federation_server.py:845
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
844	
845	        pdu = await self.handler.on_make_knock_request(origin, room_id, user_id)
846	        return {

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/federation_server.py:1019
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1018	    ) -> Tuple[int, Dict[str, Any]]:
1019	        return await self.on_query_request("client_keys", content)
1020	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/federation_server.py:1341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1340	    async def on_exchange_third_party_invite_request(self, event_dict: Dict) -> None:
1341	        await self.handler.on_exchange_third_party_invite_request(event_dict)
1342	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/_base.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
307	                # TODO: Handle other method types? other content types?
308	                content = parse_json_object_from_request(request)
309	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/_base.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
311	                with start_active_span("authenticate_request"):
312	                    origin: Optional[str] = await authenticator.authenticate_request(
313	                        request, content
314	                    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/_base.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
332	            if origin and whitelisted_homeserver(origin):
333	                context = span_context_from_request(request)
334	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
163	    ) -> Tuple[int, Union[JsonDict, str]]:
164	        return await self.handler.on_pdu_request(origin, event_id)
165	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
178	    ) -> Tuple[int, JsonDict]:
179	        return await self.handler.on_room_state_request(
180	            origin,
181	            room_id,
182	            parse_string_from_args(query, "event_id", None, required=True),
183	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
196	    ) -> Tuple[int, JsonDict]:
197	        return await self.handler.on_state_ids_request(
198	            origin,
199	            room_id,
200	            parse_string_from_args(query, "event_id", None, required=True),
201	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
220	
221	        return await self.handler.on_backfill_request(origin, room_id, versions, limit)
222	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
259	
260	        return await self.handler.on_timestamp_to_event_request(
261	            origin, room_id, timestamp, direction
262	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
278	        args["origin"] = origin
279	        return await self.handler.on_query_request(query_type, args)
280	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
311	
312	        result = await self.handler.on_make_join_request(
313	            origin, room_id, user_id, supported_versions=supported_versions
314	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
329	    ) -> Tuple[int, JsonDict]:
330	        result = await self.handler.on_make_leave_request(origin, room_id, user_id)
331	        return 200, result

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
345	    ) -> Tuple[int, Tuple[int, JsonDict]]:
346	        result = await self.handler.on_send_leave_request(origin, content, room_id)
347	        return 200, (200, result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
363	    ) -> Tuple[int, JsonDict]:
364	        result = await self.handler.on_send_leave_request(origin, content, room_id)
365	        return 200, result

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
384	
385	        result = await self.handler.on_make_knock_request(
386	            origin, room_id, user_id, supported_versions=supported_versions
387	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
402	    ) -> Tuple[int, JsonDict]:
403	        result = await self.handler.on_send_knock_request(origin, content, room_id)
404	        return 200, result

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
435	        #   match those given in content
436	        result = await self.handler.on_send_join_request(origin, content, room_id)
437	        return 200, (200, result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
458	
459	        result = await self.handler.on_send_join_request(
460	            origin, content, room_id, caller_supports_partial_state=partial_state
461	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
480	        # invites
481	        result = await self.handler.on_invite_request(
482	            origin, content, room_version_id=RoomVersions.V1.identifier
483	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
518	
519	        result = await self.handler.on_invite_request(
520	            origin, event, room_version_id=room_version
521	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/federation/transport/server/federation.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
540	    ) -> Tuple[int, JsonDict]:
541	        await self.handler.on_exchange_third_party_invite_request(content)
542	        return 200, {}

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/auth.py:1726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1725	
1726	        redirect_url = await sso_auth_provider.handle_redirect_request(
1727	            request, None, session_id
1728	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/auth.py:1809
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1808	            request.redirect(redirect_url)
1809	            finish_request(request)
1810	            return

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/cas.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
317	        if session:
318	            return await self._sso_handler.complete_sso_ui_auth_request(
319	                self.idp_id,
320	                cas_response.username,
321	                session,
322	                request,
323	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/cas.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
403	
404	        await self._sso_handler.complete_sso_login_request(
405	            self.idp_id,
406	            cas_response.username,
407	            request,
408	            client_redirect_url,
409	            cas_response_to_user_attributes,
410	            grandfather_existing_users,
411	            registration_enabled=self._cas_enable_registration,
412	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/identity.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	        bind_data = {"sid": sid, "client_secret": client_secret, "mxid": mxid}
201	        bind_url = "https://%s/_matrix/identity/v2/3pid/bind" % (id_server,)
202	        headers = {"Authorization": create_id_access_token_header(id_access_token)}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/identity.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
294	
295	        url = "https://%s/_matrix/identity/v2/3pid/unbind" % (id_server,)
296	        url_bytes = b"/_matrix/identity/v2/3pid/unbind"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/oidc.py:761
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
760	        # check the HTTP status code and we do the body encoding ourself.
761	        response = await self._http_client.request(
762	            method="POST",
763	            uri=uri,
764	            data=body.encode("utf-8"),
765	            headers=headers,
766	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/oidc.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
845	
846	        resp = await self._http_client.request(
847	            "GET",
848	            metadata["userinfo_endpoint"],
849	            headers=Headers(
850	                {"Authorization": ["Bearer {}".format(token["access_token"])]}
851	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/oidc.py:1169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1168	
1169	            return await self._sso_handler.complete_sso_ui_auth_request(
1170	                self.idp_id, remote_user_id, session_data.ui_auth_session_id, request
1171	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/oidc.py:1307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1306	
1307	        await self._sso_handler.complete_sso_login_request(
1308	            self.idp_id,
1309	            remote_user_id,
1310	            request,
1311	            client_redirect_url,
1312	            oidc_response_to_user_attributes,
1313	            grandfather_existing_users,
1314	            extra_attributes,
1315	            auth_provider_session_id=sid,
1316	            registration_enabled=self._config.enable_registration,
1317	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/oidc.py:1428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1427	        request.setHeader(b"Pragma", b"no-cache")
1428	        finish_request(request)
1429	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/oidc.py:1469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1468	
1469	        if "http://schemas.openid.net/event/backchannel-logout" not in events:
1470	            raise InvalidClaimError("events")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/saml.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
237	
238	            return await self._sso_handler.complete_sso_ui_auth_request(
239	                self.idp_id,
240	                remote_user_id,
241	                current_session.ui_auth_session_id,
242	                request,
243	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/saml.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
331	
332	        await self._sso_handler.complete_sso_login_request(
333	            self.idp_id,
334	            remote_user_id,
335	            request,
336	            client_redirect_url,
337	            saml_response_to_remapped_user_attributes,
338	            grandfather_existing_users,
339	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/handlers/sso.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
336	        if idp:
337	            return await idp.handle_redirect_request(request, client_redirect_url)
338	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
324	
325	        return self._agent.request(
326	            method, uri, headers=headers, bodyProducer=bodyProducer
327	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
415	
416	                request_deferred: defer.Deferred = treq.request(
417	                    method,
418	                    uri,
419	                    agent=self.agent,
420	                    data=body_producer,
421	                    headers=headers,
422	                    # Avoid buffering the body in treq since we do not reuse
423	                    # response bodies.
424	                    unbuffered=True,
425	                    **self._extra_treq_args,
426	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
499	
500	        response = await self.request(
501	            "POST", uri, headers=Headers(actual_headers), data=query_bytes
502	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
546	
547	        response = await self.request(
548	            "POST", uri, headers=Headers(actual_headers), data=json_str
549	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
628	
629	        response = await self.request(
630	            "PUT", uri, headers=Headers(actual_headers), data=json_str
631	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
671	
672	        response = await self.request("GET", uri, headers=Headers(actual_headers))
673	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
720	
721	        response = await self.request("GET", url, headers=Headers(actual_headers))
722	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:1106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1105	                    try:
1106	                        self.stream.write(data[start:end])
1107	                    except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:1130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1129	        try:
1130	            self.parser.write(incoming_data)
1131	        except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/client.py:1167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1166	        try:
1167	            self.stream.write(data)
1168	        except Exception:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/connectproxyclient.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
68	        # Encode as base64 and prepend the authorization type
69	        return b"Basic " + base64.b64encode(self.username_password)
70	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/connectproxyclient.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
68	        # Encode as base64 and prepend the authorization type
69	        return b"Basic " + base64.b64encode(self.username_password)
70	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/federation/matrix_federation_agent.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
222	        res = yield make_deferred_yieldable(
223	            self._agent.request(method, uri, request_headers, bodyProducer)
224	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/federation/well_known_resolver.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
187	        # errors (such as getting a 404 response).
188	        response, body = await self._make_well_known_request(
189	            server_name, retry=had_valid_well_known
190	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/federation/well_known_resolver.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
262	                response = await make_deferred_yieldable(
263	                    self._well_known_agent.request(
264	                        b"GET", uri, headers=Headers(headers)
265	                    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/matrixfederationclient.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
509	        try:
510	            response = await self._send_request(request, **send_request_args)
511	        except HttpResponseException as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/matrixfederationclient.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
527	
528	            response = await self._send_request(request, **send_request_args)
529	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/matrixfederationclient.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
754	
755	                        return await self._send_request(
756	                            attr.evolve(request, uri=new_uri, generate_uri=False),
757	                            retry_on_dns_fail,
758	                            timeout,
759	                            long_retries,
760	                            ignore_backoff,
761	                            backoff_on_404,
762	                            backoff_on_all_error_codes,
763	                            # Do not continue following redirects.
764	                            follow_redirects=False,
765	                        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/matrixfederationclient.py:1124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1123	
1124	        response = await self._send_request(
1125	            request,
1126	            long_retries=long_retries,
1127	            timeout=timeout,
1128	            ignore_backoff=ignore_backoff,
1129	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/matrixfederationclient.py:1403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1402	
1403	        response = await self._send_request(
1404	            request,
1405	            long_retries=long_retries,
1406	            timeout=timeout,
1407	            ignore_backoff=ignore_backoff,
1408	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/matrixfederationclient.py:1482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1481	
1482	        response = await self._send_request(
1483	            request,
1484	            retry_on_dns_fail=retry_on_dns_fail,
1485	            ignore_backoff=ignore_backoff,
1486	            follow_redirects=follow_redirects,
1487	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/matrixfederationclient.py:1643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1642	
1643	        response = await self._send_request(
1644	            request,
1645	            retry_on_dns_fail=retry_on_dns_fail,
1646	            ignore_backoff=ignore_backoff,
1647	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/server.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
521	    async def _async_render(self, request: "SynapseRequest") -> Tuple[int, Any]:
522	        callback, servlet_classname, group_dict = self._get_handler_for_request(request)
523	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/server.py:838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
837	
838	    _write_bytes_to_request(request, json_bytes)
839	    return NOT_DONE_YET

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/server.py:873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
872	
873	    _write_bytes_to_request(request, json_str)
874	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/server.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
982	    request.write(html_bytes)
983	    finish_request(request)
984	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/server.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1019	    request.setHeader(b"location", url)
1020	    finish_request(request)
1021	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/servlet.py:870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
869	    """
870	    content = parse_json_value_from_request(request, allow_empty_body=allow_empty_body)
871	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/servlet.py:924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
923	    """
924	    content = parse_json_object_from_request(request, allow_empty_body=False)
925	    return validate_json_object(content, model_type)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/site.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
499	
500	        log_level = logging.INFO if self._should_log_request() else logging.DEBUG
501	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/http/site.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
499	
500	        log_level = logging.INFO if self._should_log_request() else logging.DEBUG
501	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/logging/_remote.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
90	                # Send it as a new line over the transport.
91	                self.transport.write(msg.encode("utf8"))
92	                self.transport.write(b"\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/logging/_remote.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
91	                self.transport.write(msg.encode("utf8"))
92	                self.transport.write(b"\n")
93	            except Exception:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/logging/opentracing.py:1078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1077	    request_name = request.request_metrics.name
1078	    context = span_context_from_request(request) if extract_context else None
1079	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/_base.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
154	
155	        finish_request(request)
156	    else:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/_base.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
392	
393	    finish_request(request)
394	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/_base.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
438	
439	    finish_request(request)
440	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/_base.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
787	
788	            chunk = self.file.read(self.CHUNK_SIZE)
789	            if not chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/_base.py:792
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
791	
792	            self.reactor.callFromThread(self._write, chunk)
793	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/_base.py:799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
798	        if self.consumer:
799	            self.consumer.write(chunk)
800	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_repository.py:1080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1079	        with thumbnailer:
1080	            t_byte_source = await defer_to_thread(
1081	                self.hs.get_reactor(),
1082	                self._generate_thumbnail,
1083	                thumbnailer,
1084	                t_width,
1085	                t_height,
1086	                t_method,
1087	                t_type,
1088	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_repository.py:1157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1156	        with thumbnailer:
1157	            t_byte_source = await defer_to_thread(
1158	                self.hs.get_reactor(),
1159	                self._generate_thumbnail,
1160	                thumbnailer,
1161	                t_width,
1162	                t_height,
1163	                t_method,
1164	                t_type,
1165	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_repository.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1264	            if thumbnailer.transpose_method is not None:
1265	                m_width, m_height = await defer_to_thread(
1266	                    self.hs.get_reactor(), thumbnailer.transpose
1267	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_repository.py:1292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1291	                if t_method == "crop":
1292	                    t_byte_source = await defer_to_thread(
1293	                        self.hs.get_reactor(),
1294	                        thumbnailer.crop,
1295	                        t_width,
1296	                        t_height,
1297	                        t_type,
1298	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_repository.py:1300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1299	                elif t_method == "scale":
1300	                    t_byte_source = await defer_to_thread(
1301	                        self.hs.get_reactor(),
1302	                        thumbnailer.scale,
1303	                        t_width,
1304	                        t_height,
1305	                        t_type,
1306	                    )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_repository.py:1452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1451	                )
1452	                shutil.rmtree(thumbnail_dir, ignore_errors=True)
1453	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_repository.py:1531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1530	            thumbnail_dir = self.filepaths.local_media_thumbnail_dir(media_id)
1531	            shutil.rmtree(thumbnail_dir, ignore_errors=True)
1532	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
93	        """
94	        res = self._source.write(buffer)
95	        self._hash.update(buffer)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	        """
135	        bytes = self._source.read(n)
136	        self._hash.update(bytes)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
201	        """Asynchronously write the `source` to `output`."""
202	        await defer_to_thread(self.reactor, _write_file_synchronously, source, output)
203	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
457	            while True:
458	                chunk = file.read(self.CHUNK_SIZE)
459	                if not chunk:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
542	        """
543	        self.wrapped_consumer.write(CRLF + b"--" + self.boundary + b"--" + CRLF)
544	        self.wrapped_consumer.unregisterProducer()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
556	        if not self.json_field_written:
557	            self.wrapped_consumer.write(CRLF + b"--" + self.boundary + CRLF)
558	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
559	            content_type = Header(b"Content-Type", b"application/json")
560	            self.wrapped_consumer.write(bytes(content_type) + CRLF)
561	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
563	            json_bytes = json_field.encode("utf-8")
564	            self.wrapped_consumer.write(CRLF + json_bytes)
565	            self.wrapped_consumer.write(CRLF + b"--" + self.boundary + CRLF)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
564	            self.wrapped_consumer.write(CRLF + json_bytes)
565	            self.wrapped_consumer.write(CRLF + b"--" + self.boundary + CRLF)
566	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
572	            content_type = Header(b"Content-Type", type)
573	            self.wrapped_consumer.write(bytes(content_type) + CRLF)
574	            disp_header = Header(b"Content-Disposition", self.disposition)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
574	            disp_header = Header(b"Content-Disposition", self.disposition)
575	            self.wrapped_consumer.write(bytes(disp_header) + CRLF + CRLF)
576	            self.file_headers_written = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
577	
578	        self.wrapped_consumer.write(data)
579	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
687	        with closing(BytesIO()) as h:
688	            h.write(self.name + b": " + escape(self.value).encode("us-ascii"))
689	            if self.params:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
690	                for name, val in self.params:
691	                    h.write(b"; ")
692	                    h.write(escape(name).encode("us-ascii"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
691	                    h.write(b"; ")
692	                    h.write(escape(name).encode("us-ascii"))
693	                    h.write(b"=")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
692	                    h.write(escape(name).encode("us-ascii"))
693	                    h.write(b"=")
694	                    h.write(b'"' + escape(val).encode("utf-8") + b'"')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
693	                    h.write(b"=")
694	                    h.write(b'"' + escape(val).encode("utf-8") + b'"')
695	            h.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/media_storage.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
695	            h.seek(0)
696	            return h.read()
697	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/storage_provider.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
167	        with start_active_span("shutil_copyfile"):
168	            await defer_to_thread(
169	                self.reactor,
170	                shutil_copyfile,
171	                primary_fname,
172	                backup_fname,
173	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/url_previewer.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
296	            with open(media_info.filename, "rb") as file:
297	                body = file.read()
298	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/url_previewer.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
467	                    b"User-Agent": [
468	                        "Synapse (bot; +https://github.com/matrix-org/synapse)"
469	                    ],
470	                },

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/url_previewer.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
532	            logger.debug("Trying to parse data url '%s'", url)
533	            with urlopen(url) as url_info:
534	                # TODO Can this be more efficient.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/url_previewer.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
534	                # TODO Can this be more efficient.
535	                output_stream.write(url_info.read())
536	        except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/url_previewer.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
534	                # TODO Can this be more efficient.
535	                output_stream.write(url_info.read())
536	        except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/url_previewer.py:718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
717	        with open(media_info.filename, "rb") as file:
718	            body = file.read()
719	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/media/url_previewer.py:823
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
822	            try:
823	                shutil.rmtree(thumbnail_dir)
824	            except FileNotFoundError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/metrics/__init__.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
363	        with open("/proc/self/stat") as s:
364	            line = s.read()
365	            raw_stats = line.split(") ", 1)[1].split(" ")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/metrics/__init__.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
426	    SYNAPSE_VERSION,
427	    " ".join([platform.system(), platform.release()]),
428	).set(1)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/metrics/__init__.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
426	    SYNAPSE_VERSION,
427	    " ".join([platform.system(), platform.release()]),
428	).set(1)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/metrics/__init__.py:427
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
426	    SYNAPSE_VERSION,
427	    " ".join([platform.system(), platform.release()]),
428	).set(1)

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/metrics/jemalloc.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
179	
180	    jemalloc_dll = ctypes.CDLL(jemalloc_path)
181	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/push/mailer.py:892
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
891	            # need /beta for Universal Links to work on iOS
892	            base_url = "https://vector.im/beta/#/room"
893	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/push/mailer.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
893	        else:
894	            base_url = "https://matrix.to/#"
895	        return "%s/%s" % (base_url, room_id)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/push/mailer.py:915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
914	            # need /beta for Universal Links to work on iOS
915	            return "https://vector.im/beta/#/room/%s/%s" % (
916	                notif.room_id,
917	                notif.event_id,
918	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/push/mailer.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
919	        else:
920	            return "https://matrix.to/#/%s/%s" % (notif.room_id, notif.event_id)
921	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/replication/http/_base.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
232	
233	                data = await cls._serialize_payload(**kwargs)
234	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/replication/http/_base.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
399	        else:
400	            content = parse_json_object_from_request(request)
401	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/replication/http/_base.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
432	
433	            code, response = await self._handle_request(request, content, **kwargs)
434	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/__init__.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
154	
155	        body = parse_json_object_from_request(request, allow_empty_body=True)
156	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/background_updates.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
61	
62	        body = parse_json_object_from_request(request)
63	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/background_updates.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
126	
127	        body = parse_json_object_from_request(request)
128	        assert_params_in_dict(body, ["job_name"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/devices.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
108	
109	        body = parse_json_object_from_request(request, allow_empty_body=True)
110	        await self.device_handler.update_device(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/devices.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
162	
163	        body = parse_json_object_from_request(request)
164	        device_id = body.get("device_id")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/devices.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
205	
206	        body = parse_json_object_from_request(request, allow_empty_body=False)
207	        assert_params_in_dict(body, ["devices"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/experimental_features.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
107	
108	        body = parse_json_object_from_request(request)
109	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/registration_tokens.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
137	        await assert_requester_is_admin(self.auth, request)
138	        body = parse_json_object_from_request(request)
139	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/registration_tokens.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
298	        await assert_requester_is_admin(self.auth, request)
299	        body = parse_json_object_from_request(request)
300	        new_attributes = {}

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/rooms.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
94	
95	        content = parse_json_object_from_request(request)
96	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/rooms.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
358	
359	        content = parse_json_object_from_request(request)
360	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/rooms.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
506	
507	        content = parse_json_object_from_request(request)
508	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/rooms.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
595	        await assert_user_is_admin(self.auth, requester)
596	        content = parse_json_object_from_request(request, allow_empty_body=True)
597	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/rooms.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
883	
884	        content = parse_json_object_from_request(request)
885	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/rooms.py:928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
927	
928	        pagination_config = await PaginationConfig.from_request(
929	            self._store, request, default_limit=10
930	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/server_notice_servlet.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
85	        await assert_user_is_admin(self.auth, requester)
86	        body = parse_json_object_from_request(request)
87	        assert_params_in_dict(body, ("user_id", "content"))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/server_notice_servlet.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
129	        set_tag("txn_id", txn_id)
130	        return await self.txns.fetch_or_execute_request(
131	            request, requester, self._do, request, requester, txn_id
132	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
255	        target_user = UserID.from_string(user_id)
256	        body = parse_json_object_from_request(request)
257	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
555	
556	        body = parse_json_object_from_request(request)
557	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
718	
719	        body = parse_json_object_from_request(request, allow_empty_body=True)
720	        erase = body.get("erase", False)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
761	
762	        body = parse_and_validate_json_object_from_request(request, self.PutBody)
763	        suspend = body.suspend

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
786	        else:
787	            body = parse_json_object_from_request(request)
788	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
837	
838	        params = parse_json_object_from_request(request)
839	        assert_params_in_dict(params, ["new_password"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
963	
964	        body = parse_json_object_from_request(request)
965	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:1083
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1082	
1083	        body = parse_json_object_from_request(request, allow_empty_body=True)
1084	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:1235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1234	
1235	        body = parse_json_object_from_request(request, allow_empty_body=True)
1236	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/admin/users.py:1439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1438	
1439	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
1440	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
99	
100	        body = parse_and_validate_json_object_from_request(
101	            request, EmailRequestTokenBody
102	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
99	
100	        body = parse_and_validate_json_object_from_request(
101	            request, EmailRequestTokenBody
102	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
169	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
170	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
171	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
169	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
170	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
171	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
269	
270	        logout_devices = params.get("logout_devices", True)
271	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
296	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
297	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
298	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
296	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
297	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
298	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
354	
355	        body = parse_and_validate_json_object_from_request(
356	            request, EmailRequestTokenBody
357	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
354	
355	        body = parse_and_validate_json_object_from_request(
356	            request, EmailRequestTokenBody
357	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
413	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
414	        body = parse_and_validate_json_object_from_request(
415	            request, MsisdnRequestTokenBody
416	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
413	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
414	        body = parse_and_validate_json_object_from_request(
415	            request, MsisdnRequestTokenBody
416	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
519	                request.setHeader("Location", next_link)
520	                finish_request(request)
521	                return None

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
519	                request.setHeader("Location", next_link)
520	                finish_request(request)
521	                return None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
564	
565	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
566	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
564	
565	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
566	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
612	        user_id = requester.user.to_string()
613	        body = parse_json_object_from_request(request)
614	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
612	        user_id = requester.user.to_string()
613	        body = parse_json_object_from_request(request)
614	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
614	
615	        threepid_creds = body.get("threePidCreds") or body.get("three_pid_creds")
616	        if threepid_creds is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
614	
615	        threepid_creds = body.get("threePidCreds") or body.get("three_pid_creds")
616	        if threepid_creds is None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
666	        user_id = requester.user.to_string()
667	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
668	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
666	        user_id = requester.user.to_string()
667	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
668	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
708	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
709	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
710	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
708	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
709	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
710	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
740	        requester = await self.auth.get_user_by_req(request)
741	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
742	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
740	        requester = await self.auth.get_user_by_req(request)
741	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
742	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
770	
771	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
772	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
770	
771	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
772	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
883	
884	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
885	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
883	
884	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
885	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account_data.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
85	
86	        body = parse_json_object_from_request(request)
87	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/account_data.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
208	
209	        body = parse_json_object_from_request(request)
210	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/appservice_ping.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
81	
82	        content = parse_json_object_from_request(request)
83	        txn_id = content.get("transaction_id", None)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/delayed_events.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
57	
58	        body = parse_json_object_from_request(request)
59	        try:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/devices.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
106	        try:
107	            body = parse_and_validate_json_object_from_request(request, self.PostBody)
108	        except errors.SynapseError as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/devices.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
184	        try:
185	            body = parse_and_validate_json_object_from_request(request, self.DeleteBody)
186	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/devices.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
227	
228	        body = parse_and_validate_json_object_from_request(request, self.PutBody)
229	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/devices.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
323	    async def on_PUT(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
324	        submission = parse_and_validate_json_object_from_request(request, self.PutBody)
325	        requester = await self.auth.get_user_by_req(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/devices.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
372	
373	        submission = parse_and_validate_json_object_from_request(request, self.PostBody)
374	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/devices.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
376	            requester.user.to_string(),
377	            self.auth.get_access_token_from_request(request),
378	            submission.device_id,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/devices.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
403	
404	        next_batch = parse_and_validate_json_object_from_request(
405	            request, self.PostBody
406	        ).next_batch

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/devices.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
550	    async def on_PUT(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
551	        submission = parse_and_validate_json_object_from_request(request, self.PutBody)
552	        requester = await self.auth.get_user_by_req(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/directory.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
83	
84	        content = parse_and_validate_json_object_from_request(request, self.PutBody)
85	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/directory.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
158	
159	        content = parse_and_validate_json_object_from_request(request, self.PutBody)
160	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/directory.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
184	    ) -> Tuple[int, JsonDict]:
185	        content = parse_and_validate_json_object_from_request(request, self.PutBody)
186	        return await self._edit(request, network_id, room_id, content.visibility)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/events.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
61	
62	        pagin_config = await PaginationConfig.from_request(
63	            self.store, request, default_limit=10
64	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/filter.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
99	
100	        content = parse_json_object_from_request(request)
101	        set_timeline_upper_limit(content, self.hs.config.server.filter_timeline_limit)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/initial_sync.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
49	        as_client_event = b"raw" not in args
50	        pagination_config = await PaginationConfig.from_request(
51	            self.store, request, default_limit=10
52	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/keys.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
117	        user_id = requester.user.to_string()
118	        body = parse_json_object_from_request(request)
119	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/keys.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
205	        timeout = parse_integer(request, "timeout", 10 * 1000)
206	        body = parse_json_object_from_request(request)
207	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/keys.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
302	        timeout = parse_integer(request, "timeout", 10 * 1000)
303	        body = parse_json_object_from_request(request)
304	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/keys.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
350	        timeout = parse_integer(request, "timeout", 10 * 1000)
351	        body = parse_json_object_from_request(request)
352	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/keys.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
386	        user_id = requester.user.to_string()
387	        body = parse_json_object_from_request(request)
388	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/keys.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
491	        user_id = requester.user.to_string()
492	        body = parse_json_object_from_request(request)
493	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/knock.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
63	
64	        content = parse_json_object_from_request(request)
65	        event_content = None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/login.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
192	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, LoginResponse]:
193	        login_submission = parse_json_object_from_request(request)
194	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/login.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
592	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
593	        refresh_submission = parse_json_object_from_request(request)
594	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/login.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
670	            request.redirect(new_uri)
671	            finish_request(request)
672	            return

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/login.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
675	        client_redirect_url = parse_bytes_from_args(args, "redirectUrl", required=True)
676	        sso_url = await self._sso_handler.handle_redirect_request(
677	            request,
678	            client_redirect_url,
679	            idp_id,
680	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/login.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
682	        request.redirect(sso_url)
683	        finish_request(request)
684	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/login_token_request.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
93	        requester = await self.auth.get_user_by_req(request)
94	        body = parse_json_object_from_request(request)
95	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/logout.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
56	            # Just delete the access token
57	            access_token = self.auth.get_access_token_from_request(request)
58	            await self._auth_handler.delete_access_token(access_token)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/openid.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
89	        # for now.
90	        parse_json_object_from_request(request)
91	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/presence.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
106	
107	        content = parse_json_object_from_request(request)
108	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/profile.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
106	
107	        content = parse_json_object_from_request(request)
108	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/profile.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
184	
185	        content = parse_json_object_from_request(request)
186	        try:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/profile.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
322	
323	        content = parse_json_object_from_request(request)
324	        try:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/push_rule.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
89	
90	        content = parse_json_value_from_request(request)
91	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/pusher.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
95	
96	        content = parse_json_object_from_request(request)
97	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/read_marker.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
65	
66	        body = parse_json_object_from_request(request)
67	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/receipts.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
75	
76	        body = parse_json_object_from_request(request)
77	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
109	            )
110	        body = parse_json_object_from_request(request)
111	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
109	            )
110	        body = parse_json_object_from_request(request)
111	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	        send_attempt = body["send_attempt"]
127	        next_link = body.get("next_link")  # Optional param
128	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
182	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
183	        body = parse_json_object_from_request(request)
184	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
182	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
183	        body = parse_json_object_from_request(request)
184	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	        send_attempt = body["send_attempt"]
193	        next_link = body.get("next_link")  # Optional param
194	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
303	                    request.setHeader("Location", next_link)
304	                    finish_request(request)
305	                    return None

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
303	                    request.setHeader("Location", next_link)
304	                    finish_request(request)
305	                    return None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
448	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
449	        body = parse_json_object_from_request(request)
450	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
448	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
449	        body = parse_json_object_from_request(request)
450	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
466	        # token.
467	        client_requested_refresh_tokens = body.get("refresh_token", False)
468	        if not isinstance(client_requested_refresh_tokens, bool):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
486	        # == Application Service Registration ==
487	        if body.get("type") == APP_SERVICE_REGISTRATION_TYPE:
488	            if not self.auth.has_access_token(request):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
498	
499	            access_token = self.auth.get_access_token_from_request(request)
500	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
498	
499	            access_token = self.auth.get_access_token_from_request(request)
500	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
533	        # Check if this account is upgrading from a guest account.
534	        guest_access_token = body.get("guest_access_token", None)
535	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
650	            if desired_username is None:
651	                desired_username = params.get("username", None)
652	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
652	
653	            guest_access_token = params.get("guest_access_token", None)
654	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
659	            if auth_result:
660	                threepid = auth_result.get(LoginType.EMAIL_IDENTITY)
661	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
755	                auth_result=auth_result,
756	                access_token=return_dict.get("access_token"),
757	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
813	        # they need to be approved first.
814	        if not params.get("inhibit_login", False) and not self._require_approval:
815	            device_id = params.get("device_id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
814	        if not params.get("inhibit_login", False) and not self._require_approval:
815	            device_id = params.get("device_id")
816	            initial_display_name = params.get("initial_device_display_name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
815	            device_id = params.get("device_id")
816	            initial_display_name = params.get("initial_device_display_name")
817	            (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
853	        device_id = synapse.api.auth.GUEST_DEVICE_ID
854	        initial_display_name = params.get("initial_device_display_name")
855	        (

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
904	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
905	        body = parse_json_object_from_request(request)
906	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
904	    async def on_POST(self, request: SynapseRequest) -> Tuple[int, JsonDict]:
905	        body = parse_json_object_from_request(request)
906	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
911	        # Allow only ASes to use this API.
912	        if body.get("type") != APP_SERVICE_REGISTRATION_TYPE:
913	            raise SynapseError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:930
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
929	        # the auth layer will store these in sessions.
930	        desired_username = body.get("username")
931	        if not isinstance(desired_username, str) or len(desired_username) > 512:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:945
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
944	
945	        as_token = self.auth.get_access_token_from_request(request)
946	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/register.py:945
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
944	
945	        as_token = self.auth.get_access_token_from_request(request)
946	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/relations.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
68	
69	        pagination_config = await PaginationConfig.from_request(
70	            self._store, request, default_limit=5, default_dir=Direction.BACKWARDS
71	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/reporting.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
63	
64	        body = parse_json_object_from_request(request)
65	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/reporting.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
136	
137	        body = parse_and_validate_json_object_from_request(request, self.PostBody)
138	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
166	        set_tag("txn_id", txn_id)
167	        return await self.txns.fetch_or_execute_request(
168	            request, requester, self._do, request, requester
169	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
184	    def get_room_config(self, request: Request) -> JsonDict:
185	        user_supplied_config = parse_json_object_from_request(request)
186	        return user_supplied_config

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
289	
290	        content = parse_json_object_from_request(request)
291	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
378	    ) -> Tuple[int, JsonDict]:
379	        content = parse_json_object_from_request(request)
380	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
439	
440	        return await self.txns.fetch_or_execute_request(
441	            request,
442	            requester,
443	            self._do,
444	            request,
445	            requester,
446	            room_id,
447	            event_type,
448	            txn_id,
449	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
515	    ) -> Tuple[int, JsonDict]:
516	        content = parse_json_object_from_request(request, allow_empty_body=True)
517	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
557	
558	        return await self.txns.fetch_or_execute_request(
559	            request, requester, self._do, request, requester, room_identifier, txn_id
560	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
625	        server = parse_string(request, "server")
626	        content = parse_json_object_from_request(request)
627	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:792
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
791	        requester = await self.auth.get_user_by_req(request, allow_guest=True)
792	        pagination_config = await PaginationConfig.from_request(
793	            self.store, request, default_limit=10
794	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:863
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
862	        requester = await self.auth.get_user_by_req(request, allow_guest=True)
863	        pagination_config = await PaginationConfig.from_request(
864	            self.store, request, default_limit=10
865	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:1057
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1056	
1057	        return await self.txns.fetch_or_execute_request(
1058	            request, requester, self._do, requester, room_id
1059	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:1093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1092	
1093	        content = parse_json_object_from_request(request, allow_empty_body=True)
1094	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:1166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1165	
1166	        return await self.txns.fetch_or_execute_request(
1167	            request,
1168	            requester,
1169	            self._do,
1170	            request,
1171	            requester,
1172	            room_id,
1173	            membership_action,
1174	            txn_id,
1175	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1200	    ) -> Tuple[int, JsonDict]:
1201	        content = parse_json_object_from_request(request)
1202	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:1296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1295	
1296	        return await self.txns.fetch_or_execute_request(
1297	            request, requester, self._do, request, requester, room_id, event_id, txn_id
1298	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:1330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1329	
1330	        content = parse_json_object_from_request(request)
1331	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room.py:1399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1398	
1399	        content = parse_json_object_from_request(request)
1400	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room_keys.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
135	        user_id = requester.user.to_string()
136	        body = parse_json_object_from_request(request)
137	        version = parse_string(request, "version", required=True)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room_keys.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
327	        user_id = requester.user.to_string()
328	        info = parse_json_object_from_request(request)
329	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room_keys.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
416	        user_id = requester.user.to_string()
417	        info = parse_json_object_from_request(request)
418	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/room_upgrade_rest_servlet.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
77	
78	        content = parse_json_object_from_request(request)
79	        assert_params_in_dict(content, ("new_version",))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/sendtodevice.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
58	        set_tag("txn_id", txn_id)
59	        return await self.txns.fetch_or_execute_request(
60	            request,
61	            requester,
62	            self._put,
63	            request,
64	            requester,
65	            message_type,
66	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/sendtodevice.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
73	    ) -> Tuple[int, JsonDict]:
74	        content = parse_json_object_from_request(request)
75	        assert_params_in_dict(content, ("messages",))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/sync.py:955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
954	        # in.
955	        body = parse_and_validate_json_object_from_request(request, SlidingSyncBody)
956	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/tags.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
95	
96	        body = parse_json_object_from_request(request)
97	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/user_directory.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
71	
72	        body = parse_json_object_from_request(request)
73	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/voip.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
66	            # same result as the TURN server.
67	            password = base64.b64encode(mac.digest()).decode("ascii")
68	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/client/voip.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
66	            # same result as the TURN server.
67	            password = base64.b64encode(mac.digest()).decode("ascii")
68	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/key/v2/remote_key_resource.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
171	    async def on_POST(self, request: Request) -> Tuple[int, JsonDict]:
172	        content = parse_and_validate_json_object_from_request(request, self.PostBody)
173	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/media/upload_resource.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
153	        async with lock:
154	            await self.media_repo.verify_can_upload(media_id, requester.user)
155	            content_length, upload_name, media_type = self._get_file_metadata(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/synapse/client/new_user_consent.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
66	        try:
67	            session_id = get_username_mapping_session_cookie_from_request(request)
68	            session = self._sso_handler.get_mapping_session(session_id)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/synapse/client/new_user_consent.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
100	        try:
101	            session_id = get_username_mapping_session_cookie_from_request(request)
102	        except SynapseError as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/synapse/client/pick_idp.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
78	        request.redirect(sso_login_redirect_url)
79	        finish_request(request)
80	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/synapse/client/pick_username.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
70	
71	        session_id = get_username_mapping_session_cookie_from_request(request)
72	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/synapse/client/pick_username.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
94	        try:
95	            session_id = get_username_mapping_session_cookie_from_request(request)
96	            session = self._sso_handler.get_mapping_session(session_id)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/synapse/client/pick_username.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
128	        try:
129	            session_id = get_username_mapping_session_cookie_from_request(request)
130	        except SynapseError as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/synapse/client/pick_username.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
150	
151	        await self._sso_handler.handle_submit_username_request(
152	            request, session_id, localpart, use_display_name, use_avatar, emails_to_use
153	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/rest/synapse/client/sso_register.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
50	        try:
51	            session_id = get_username_mapping_session_cookie_from_request(request)
52	        except SynapseError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/storage/databases/main/event_push_actions.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
651	            summarised_threads.add(thread_id)
652	            counts = _get_thread(thread_id)
653	            counts.notify_count += notif_count

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/storage/databases/main/event_push_actions.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
687	        for highlight_count, thread_id in txn:
688	            _get_thread(thread_id).highlight_count += highlight_count
689	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/storage/databases/main/event_push_actions.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
766	        for notif_count, unread_count, thread_id in txn:
767	            counts = _get_thread(thread_id)
768	            counts.notify_count += notif_count

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/storage/databases/main/event_push_actions.py:1022
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1021	            for event_id, room_id, thread_id, stream_ordering, actions, highlight in push_actions
1022	            if receipts_by_room.get(room_id, MISSING_ROOM_RECEIPT).is_unread(
1023	                thread_id, stream_ordering
1024	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/storage/databases/main/event_push_actions.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1113	            for event_id, room_id, thread_id, stream_ordering, actions, highlight, received_ts in push_actions
1114	            if receipts_by_room.get(room_id, MISSING_ROOM_RECEIPT).is_unread(
1115	                thread_id, stream_ordering
1116	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/storage/util/sequence.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	
39	_INCONSISTENT_STREAM_ERROR = """
40	Postgres sequence '%(seq)s' is inconsistent with associated stream position
41	of '%(stream_name)s' in the 'stream_positions' table.
42	
43	This is likely a programming error and should be reported at
44	https://github.com/matrix-org/synapse.
45	
46	A temporary workaround to fix this error is to shut down Synapse (including
47	any and all workers) and run the following SQL:
48	
49	    DELETE FROM stream_positions WHERE stream_name = '%(stream_name)s';
50	
51	This will need to be done every time the server is restarted.
52	"""
53	
54	
55	class SequenceGenerator(metaclass=abc.ABCMeta):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/util/daemonize.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
43	        with open(pid_file) as pid_fh:
44	            old_pid = pid_fh.read()
45	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/util/daemonize.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
63	        with open(pid_file, "w") as pid_fh:
64	            pid_fh.write(old_pid)
65	        sys.exit(1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/util/daemonize.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
126	    try:
127	        lock_fh.write("%s" % (os.getpid()))
128	        lock_fh.flush()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/util/daemonize.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
138	
139	    signal.signal(signal.SIGTERM, sigterm)
140	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/util/daemonize.py:139
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
138	
139	    signal.signal(signal.SIGTERM, sigterm)
140	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synapse/util/rust.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	        with open(os.path.join(directory, path), "rb") as f:
78	            hasher.update(f.read())
79	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/synmark/suites/logging.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
71	    logger_factory.on_done = Deferred()
72	    port = reactor.listenTCP(0, logger_factory, backlog=50, interface="127.0.0.1")
73	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_auth.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
117	        request = Mock(args={})
118	        request.getClientAddress.return_value.host = "127.0.0.1"
119	        request.args[b"access_token"] = [self.test_token]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_auth.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
136	        request = Mock(args={})
137	        request.getClientAddress.return_value.host = "192.168.10.10"
138	        request.args[b"access_token"] = [self.test_token]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_auth.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
155	        request = Mock(args={})
156	        request.getClientAddress.return_value.host = "131.111.8.42"
157	        request.args[b"access_token"] = [self.test_token]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_auth.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
205	        request = Mock(args={})
206	        request.getClientAddress.return_value.host = "127.0.0.1"
207	        request.args[b"access_token"] = [self.test_token]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_auth.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
224	        request = Mock(args={})
225	        request.getClientAddress.return_value.host = "127.0.0.1"
226	        request.args[b"access_token"] = [self.test_token]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_auth.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
251	        request = Mock(args={})
252	        request.getClientAddress.return_value.host = "127.0.0.1"
253	        request.args[b"access_token"] = [self.test_token]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_auth.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
283	        request = Mock(args={})
284	        request.getClientAddress.return_value.host = "127.0.0.1"
285	        request.args[b"access_token"] = [self.test_token]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_auth.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
307	        request = Mock(args={})
308	        request.getClientAddress.return_value.host = "127.0.0.1"
309	        request.args[b"access_token"] = [self.test_token]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_auth.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
328	        request = Mock(args={})
329	        request.getClientAddress.return_value.host = "127.0.0.1"
330	        request.args[b"access_token"] = [self.test_token]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_urls.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	# a (valid) url with some annoying characters in.  %3D is =, %26 is &, %2B is +
25	TRICKY_TEST_CLIENT_REDIRECT_URL = 'https://x?<ab c>&q"+%3D%2B"="f√∂%26=o"'
26	
27	
28	class LoginSSORedirectURIBuilderTestCase(HomeserverTestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_urls.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	            self.login_sso_redirect_url_builder.build_login_sso_redirect_uri(
35	                idp_id=None, client_redirect_url="http://example.com/redirect"
36	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_urls.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	            ),
37	            "https://test/_matrix/client/v3/login/sso/redirect?redirectUrl=http%3A%2F%2Fexample.com%2Fredirect",
38	        )
39	
40	    def test_explicit_idp_id(self) -> None:
41	        self.assertEqual(
42	            self.login_sso_redirect_url_builder.build_login_sso_redirect_uri(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_urls.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	            self.login_sso_redirect_url_builder.build_login_sso_redirect_uri(
43	                idp_id="oidc-github", client_redirect_url="http://example.com/redirect"
44	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_urls.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	            ),
45	            "https://test/_matrix/client/v3/login/sso/redirect/oidc-github?redirectUrl=http%3A%2F%2Fexample.com%2Fredirect",
46	        )
47	
48	    def test_tricky_redirect_uri(self) -> None:
49	        self.assertEqual(
50	            self.login_sso_redirect_url_builder.build_login_sso_redirect_uri(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/api/test_urls.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	            ),
54	            "https://test/_matrix/client/v3/login/sso/redirect/oidc-github?redirectUrl=https%3A%2F%2Fx%3F%3Cab+c%3E%26q%22%2B%253D%252B%22%3D%22f%C3%B6%2526%3Do%22",
55	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/app/test_openid_listener.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
48	        conf["worker_app"] = "yes"
49	        conf["instance_map"] = {"main": {"host": "127.0.0.1", "port": 0}}
50	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/app/test_openid_listener.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
69	            "type": "http",
70	            "bind_addresses": ["0.0.0.0"],
71	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/app/test_openid_listener.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
117	            "type": "http",
118	            "bind_addresses": ["0.0.0.0"],
119	            "resources": [{"names": names}],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/appservice/test_api.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	TOKEN = "myastoken"
36	URL = "http://mytestservice"
37	
38	
39	class ApplicationServiceApiTestCase(unittest.HomeserverTestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_base.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        root = Mock()
37	        root.server.public_baseurl = "http://test"
38	        self.config = Config(root)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_base.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	                contents = b"{{ test_variable }}"
70	                tmp_template.write(contents)
71	                tmp_template.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_base.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
69	                contents = b"{{ test_variable }}"
70	                tmp_template.write(contents)
71	                tmp_template.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_base.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	            with open(template_path, "w") as fp:
107	                fp.write(str(i))
108	                fp.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_base.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
106	            with open(template_path, "w") as fp:
107	                fp.write(str(i))
108	                fp.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_base.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	        with open(other_template_path, "w") as fp:
128	            fp.write("hello world")
129	            fp.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_base.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
127	        with open(other_template_path, "w") as fp:
128	            fp.write("hello world")
129	            fp.flush()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_generate.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
39	    def tearDown(self) -> None:
40	        shutil.rmtree(self.dir)
41	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_generate.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	        with open(log_config_file) as f:
68	            config = f.read()
69	            # find the 'filename' line

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_load.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
201	        with tempfile.NamedTemporaryFile(buffering=0) as secret_file:
202	            secret_file.write(b"53C237")
203	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_load.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
251	            # Only used for less mocking with admin_token
252	            secret_file.write(b"53C237")
253	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_load.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
274	        with tempfile.NamedTemporaryFile(buffering=0) as secret_file:
275	            secret_file.write(b"53C237")
276	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_oauth_delegation.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	SERVER_NAME = "test"
36	ISSUER = "https://issuer/"
37	CLIENT_ID = "test-client-id"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_oauth_delegation.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	CLIENT_SECRET = "test-client-secret"
39	BASE_URL = "https://synapse/"
40	
41	
42	class CustomAuthModule:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_oauth_delegation.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
194	                "idp_name": "Microsoft",
195	                "issuer": "https://login.microsoftonline.com/<tenant id>/v2.0",
196	                "client_id": "<client id>",
197	                "client_secret": "<client secret>",
198	                "scopes": ["openid", "profile"],
199	                "authorization_endpoint": "https://login.microsoftonline.com/<tenant id>/oauth2/v2.0/authorize",
200	                "token_endpoint": "https://login.microsoftonline.com/<tenant id>/oauth2/v2.0/token",
201	                "userinfo_endpoint": "https://graph.microsoft.com/oidc/userinfo",
202	            }
203	        ]
204	
205	        with self.assertRaises(ConfigError):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_oauth_delegation.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
198	                "scopes": ["openid", "profile"],
199	                "authorization_endpoint": "https://login.microsoftonline.com/<tenant id>/oauth2/v2.0/authorize",
200	                "token_endpoint": "https://login.microsoftonline.com/<tenant id>/oauth2/v2.0/token",
201	                "userinfo_endpoint": "https://graph.microsoft.com/oidc/userinfo",
202	            }
203	        ]
204	
205	        with self.assertRaises(ConfigError):
206	            self.parse_config()
207	
208	    def test_cas_sso_cannot_be_enabled(self) -> None:
209	        self.config_dict["cas_config"] = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_oauth_delegation.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
199	                "authorization_endpoint": "https://login.microsoftonline.com/<tenant id>/oauth2/v2.0/authorize",
200	                "token_endpoint": "https://login.microsoftonline.com/<tenant id>/oauth2/v2.0/token",
201	                "userinfo_endpoint": "https://graph.microsoft.com/oidc/userinfo",
202	            }
203	        ]
204	
205	        with self.assertRaises(ConfigError):
206	            self.parse_config()
207	
208	    def test_cas_sso_cannot_be_enabled(self) -> None:
209	        self.config_dict["cas_config"] = {
210	            "enabled": True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_oauth_delegation.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	                "token_endpoint": "https://login.microsoftonline.com/<tenant id>/oauth2/v2.0/token",
201	                "userinfo_endpoint": "https://graph.microsoft.com/oidc/userinfo",
202	            }
203	        ]
204	
205	        with self.assertRaises(ConfigError):
206	            self.parse_config()
207	
208	    def test_cas_sso_cannot_be_enabled(self) -> None:
209	        self.config_dict["cas_config"] = {
210	            "enabled": True,
211	            "server_url": "https://cas-server.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_oauth_delegation.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
210	            "enabled": True,
211	            "server_url": "https://cas-server.com",
212	            "displayname_attribute": "name",
213	            "required_attributes": {"userGroup": "staff", "department": "None"},
214	        }
215	
216	        with self.assertRaises(ConfigError):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_server.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
53	                "x_forwarded": True,
54	                "bind_addresses": ["::1", "127.0.0.1"],
55	                "resources": [{"names": ["client", "federation"], "compress": False}],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_server.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
127	        expected_listeners = listeners.copy()
128	        expected_listeners[1]["bind_addresses"] = ["::1", "127.0.0.1"]
129	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_server.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
149	        # IPv4 address
150	        ip_set = generate_ip_set(("1.2.3.4",))
151	        self.assertEqual(len(ip_set.iter_cidrs()), 4)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_server.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
165	        # The addresses can overlap OK.
166	        ip_set = generate_ip_set(("1.2.3.4", "::1.2.3.4"))
167	        self.assertEqual(len(ip_set.iter_cidrs()), 4)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_server.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
170	        """Extra IP addresses are treated the same."""
171	        ip_set = generate_ip_set((), ("1.2.3.4",))
172	        self.assertEqual(len(ip_set.iter_cidrs()), 4)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_server.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
173	
174	        ip_set = generate_ip_set(("1.1.1.1",), ("1.2.3.4",))
175	        self.assertEqual(len(ip_set.iter_cidrs()), 8)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_server.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
173	
174	        ip_set = generate_ip_set(("1.1.1.1",), ("1.2.3.4",))
175	        self.assertEqual(len(ip_set.iter_cidrs()), 8)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_server.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
177	        # They can duplicate without error.
178	        ip_set = generate_ip_set(("1.2.3.4",), ("1.2.3.4",))
179	        self.assertEqual(len(ip_set.iter_cidrs()), 4)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_server.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
177	        # They can duplicate without error.
178	        ip_set = generate_ip_set(("1.2.3.4",), ("1.2.3.4",))
179	        self.assertEqual(len(ip_set.iter_cidrs()), 4)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_workers.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
103	                "notify_appservices": False,
104	                "instance_map": {"main": {"host": "127.0.0.1", "port": 0}},
105	            },

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_workers.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
150	            worker_name=None,
151	            extras={"instance_map": {"main": {"host": "127.0.0.1", "port": 0}}},
152	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_workers.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
215	                "notify_appservices": False,
216	                "instance_map": {"main": {"host": "127.0.0.1", "port": 0}},
217	            },

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_workers.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
251	            worker_name=None,
252	            extras={"instance_map": {"main": {"host": "127.0.0.1", "port": 0}}},
253	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_workers.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
279	            worker_name="worker1",
280	            extras={"instance_map": {"main": {"host": "127.0.0.1", "port": 0}}},
281	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_workers.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
315	                "update_user_directory_from_worker": "worker1",
316	                "instance_map": {"main": {"host": "127.0.0.1", "port": 0}},
317	            },

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/test_workers.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
327	                "update_user_directory_from_worker": "worker1",
328	                "instance_map": {"main": {"host": "127.0.0.1", "port": 0}},
329	            },

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/utils.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
37	    def tearDown(self) -> None:
38	        shutil.rmtree(self.dir)
39	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/utils.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	        with open(self.config_file, "w") as f:
62	            f.write("".join(contents))
63	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/utils.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
61	        with open(self.config_file, "w") as f:
62	            f.write("".join(contents))
63	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/utils.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	            for line in lines:
67	                f.write(line + "\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/config/utils.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
66	            for line in lines:
67	                f.write(line + "\n")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/events/test_auto_accept_invites.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
199	        self.get_success(
200	            self.handler.on_invite_request(
201	                remote_server,
202	                invite_event,
203	                invite_event.room_version,
204	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/events/test_auto_accept_invites.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
325	            self.get_success(
326	                self.handler.on_invite_request(
327	                    remote_server,
328	                    invite_event,
329	                    invite_event.room_version,
330	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/events/test_auto_accept_invites.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
406	
407	        channel = self.make_request(
408	            "PUT",
409	            "/_synapse/admin/v2/users/%s" % invited_user_id,
410	            {"deactivated": True},
411	            access_token=inviting_user_tok,
412	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/events/test_auto_accept_invites.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
449	
450	        channel = self.make_request(
451	            "PUT",
452	            f"/_synapse/admin/v1/suspend/{invited_user_id}",
453	            {"suspend": True},
454	            access_token=inviting_user_tok,
455	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/events/test_auto_accept_invites.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
492	
493	        channel = self.make_request(
494	            "PUT",
495	            f"/_synapse/admin/v2/users/{invited_user_id}",
496	            {"locked": True},
497	            access_token=inviting_user_tok,
498	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_out_of_band_membership.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
167	
168	        channel = self.make_request(
169	            method="POST",
170	            path=sync_path,
171	            content=sync_body,
172	            access_token=tok,
173	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_out_of_band_membership.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
256	        )
257	        channel = self.make_signed_federation_request(
258	            "PUT",
259	            f"/_matrix/federation/v2/invite/{remote_room_id}/{user1_invite_membership_event.event_id}",
260	            content={
261	                "event": user1_invite_membership_event.get_dict(),
262	                "invite_room_state": [
263	                    strip_event(room_create_event),
264	                ],
265	                "room_version": room_version.identifier,
266	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_out_of_band_membership.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
570	        )
571	        channel = self.make_signed_federation_request(
572	            "PUT",
573	            f"/_matrix/federation/v2/invite/{remote_room_id}/{user2_invite_membership_event.event_id}",
574	            content={
575	                "event": user2_invite_membership_event.get_dict(),
576	                "invite_room_state": [
577	                    strip_event(
578	                        remote_room_join_result.state_map[(EventTypes.Create, "")]
579	                    ),
580	                ],
581	                "room_version": room_version.identifier,
582	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
68	
69	        channel = self.make_request(
70	            "POST",
71	            "/_matrix/federation/v1/get_missing_events/%s" % (room_1,),
72	            query_content,
73	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
86	
87	        channel = self.make_signed_federation_request(
88	            "PUT",
89	            "/_matrix/federation/v1/send/txn",
90	            {"edus": [{"edu_type": "FAIL_EDU_TYPE", "content": {}}]},
91	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
272	
273	        self.assertFalse(server_acl_evalutor.server_matches_acl_event("1.2.3.4"))
274	        self.assertTrue(server_acl_evalutor.server_matches_acl_event("1a.2.3.4"))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
314	
315	        channel = self.make_signed_federation_request(
316	            "GET", "/_matrix/federation/v1/state/%s?event_id=xyz" % (room_1,)
317	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
346	    def _make_join(self, user_id: str) -> JsonDict:
347	        channel = self.make_signed_federation_request(
348	            "GET",
349	            f"/_matrix/federation/v1/make_join/{self._room_id}/{user_id}"
350	            f"?ver={DEFAULT_ROOM_VERSION}",
351	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
364	        )
365	        channel = self.make_signed_federation_request(
366	            "PUT",
367	            f"/_matrix/federation/v2/send_join/{self._room_id}/x",
368	            content=join_event_dict,
369	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
418	        )
419	        channel = self.make_signed_federation_request(
420	            "PUT",
421	            f"/_matrix/federation/v2/send_join/{self._room_id}/x?omit_members=true",
422	            content=join_event_dict,
423	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
474	        joining_user = "@ronniebarker:" + self.OTHER_SERVER_NAME
475	        channel = self.make_signed_federation_request(
476	            "GET",
477	            f"/_matrix/federation/v1/make_join/{self._room_id}/{joining_user}"
478	            f"?ver={DEFAULT_ROOM_VERSION}",
479	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
498	        # count is 3, the first send_join should be accepted...
499	        channel = self.make_signed_federation_request(
500	            "PUT",
501	            f"/_matrix/federation/v2/send_join/{self._room_id}/join0",
502	            content=join_event_dicts[0],
503	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/test_federation_server.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
506	        # ... but the second should be denied.
507	        channel = self.make_signed_federation_request(
508	            "PUT",
509	            f"/_matrix/federation/v2/send_join/{self._room_id}/join1",
510	            content=join_event_dicts[1],
511	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/transport/server/test__base.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
88	        """Test that handlers with the `@cancellable` flag can be cancelled."""
89	        channel = self.make_signed_federation_request(
90	            "GET", self.path, await_result=False
91	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/federation/transport/server/test__base.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
105	        """Test that handlers without the `@cancellable` flag cannot be cancelled."""
106	        channel = self.make_signed_federation_request(
107	            "POST",
108	            self.path,
109	            content={},
110	            await_result=False,
111	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_cas.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	# These are a few constants that are used as config parameters in the tests.
33	BASE_URL = "https://synapse/"
34	SERVER_URL = "https://issuer/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_cas.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	BASE_URL = "https://synapse/"
34	SERVER_URL = "https://issuer/"
35	
36	
37	class CasHandlerTestCase(HomeserverTestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	SERVER_NAME = "test"
61	ISSUER = "https://issuer/"
62	CLIENT_ID = "test-client-id"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	CLIENT_SECRET = "test-client-secret"
64	BASE_URL = "https://synapse/"
65	SCOPES = ["openid"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
611	        keys_upload_body = self.make_device_keys(USER_ID, DEVICE)
612	        channel = self.make_request(
613	            "POST",
614	            "/_matrix/client/v3/keys/device_signing/upload",
615	            keys_upload_body,
616	            access_token="mockAccessToken",
617	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
622	        keys_upload_body = self.make_device_keys(USER_ID, DEVICE)
623	        channel = self.make_request(
624	            "POST",
625	            "/_matrix/client/v3/keys/device_signing/upload",
626	            keys_upload_body,
627	            access_token="mockAccessToken",
628	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
634	    ) -> None:
635	        channel = self.make_request(method, path, content, shorthand=False)
636	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
645	    ) -> None:
646	        channel = self.make_request(
647	            method, path, content, access_token="token" if auth else None
648	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
657	    ) -> None:
658	        channel = self.make_request(method, path, content)
659	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
738	        # This is still available for AS registrations
739	        channel = self.make_request(
740	            "POST",
741	            "/_matrix/client/v3/register",
742	            {"username": "alice", "type": "m.login.application_service"},
743	            shorthand=False,
744	            access_token="i_am_an_app_service",
745	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
867	
868	        EXAMPLE_IPV4_ADDR = "123.123.123.123"
869	        EXAMPLE_USER_AGENT = "httprettygood"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oauth_delegation.py:902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
901	        # Now test MAS making a request using the special __oidc_admin token
902	        MAS_IPV4_ADDR = "127.0.0.1"
903	        MAS_USER_AGENT = "masmasmas"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	# These are a few constants that are used as config parameters in the tests.
55	ISSUER = "https://issuer/"
56	CLIENT_ID = "test-client-id"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	CLIENT_SECRET = "test-client-secret"
58	BASE_URL = "https://synapse/"
59	CALLBACK_URL = BASE_URL + "_synapse/client/oidc/callback"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	CALLBACK_URL = BASE_URL + "_synapse/client/oidc/callback"
60	TEST_REDIRECT_URI = "https://test/oidc/callback"
61	SCOPES = ["openid"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
203	        userinfo: dict,
204	        client_redirect_url: str = "http://client/redirect",
205	        scope: str = "openid",
206	        with_sid: bool = False,
207	    ) -> Tuple[SynapseRequest, FakeAuthorizationGrant]:
208	        """Start an authorization request, and get the callback request back."""
209	        nonce = random_string(10)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
220	        session = self._generate_oidc_session_token(state, nonce, client_redirect_url)
221	        return _build_callback_request(code, state, session), grant
222	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
357	
358	            return get_awaitable_result(force_load())
359	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
365	
366	        with self.metadata_edit({"issuer": "http://insecure/"}):
367	            self.assertRaisesRegex(ValueError, "issuer", force_load_metadata)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
368	
369	        with self.metadata_edit({"issuer": "https://invalid/?because=query"}):
370	            self.assertRaisesRegex(ValueError, "issuer", force_load_metadata)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
376	
377	        with self.metadata_edit({"authorization_endpoint": "http://insecure/auth"}):
378	            self.assertRaisesRegex(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
384	
385	        with self.metadata_edit({"token_endpoint": "http://insecure/token"}):
386	            self.assertRaisesRegex(ValueError, "token_endpoint", force_load_metadata)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
390	
391	        with self.metadata_edit({"jwks_uri": "http://insecure/jwks.json"}):
392	            self.assertRaisesRegex(ValueError, "jwks_uri", force_load_metadata)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
434	        """Provider metadata validation can be disabled by config."""
435	        with self.metadata_edit({"issuer": "http://insecure"}):
436	            # This should not throw

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
446	            self.get_success(
447	                self.provider.handle_redirect_request(req, b"http://client/redirect")
448	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
484	        self.assertEqual(code_verifier, "")
485	        self.assertEqual(redirect, "http://client/redirect")
486	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
495	                self.get_success(
496	                    self.provider.handle_redirect_request(
497	                        req, b"http://client/redirect"
498	                    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
529	            self.get_success(
530	                self.provider.handle_redirect_request(req, b"http://client/redirect")
531	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
563	                self.get_success(
564	                    self.provider.handle_redirect_request(
565	                        req, b"http://client/redirect"
566	                    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
599	            self.get_success(
600	                self.provider.handle_redirect_request(req, b"http://client/redirect")
601	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
645	
646	        client_redirect_url = "http://client/redirect"
647	        request, _ = self.start_authorization(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
676	        request, _ = self.start_authorization(userinfo)
677	        with self.fake_server.id_token_override({"iss": "https://bad.issuer/"}):
678	            self.get_success(self.handler.handle_oidc_callback(request))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
761	            nonce="nonce",
762	            client_redirect_url="http://client/redirect",
763	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
921	        with open(_public_key_file_path()) as f:
922	            key = f.read()
923	        claims = jwt.decode(secret, key)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_oidc.py:1510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1509	    session: str,
1510	    ip_address: str = "10.0.0.1",
1511	) -> Mock:
1512	    """Builds a fake SynapseRequest to mock the browser callback
1513	
1514	    Returns a Mock object which looks like the SynapseRequest we get from a browser

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
718	
719	        channel = self.make_request(
720	            "POST",
721	            "/_matrix/client/v3/logout",
722	            {},
723	            access_token=tok,
724	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
737	        username = "rin"
738	        channel = self.make_request(
739	            "POST",
740	            "/register",
741	            {
742	                "username": username,
743	                "password": "bar",
744	                "auth": {"type": LoginType.DUMMY},
745	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
790	        username = "rin"
791	        channel = self.make_request(
792	            "POST",
793	            "/register",
794	            {
795	                "username": username,
796	                "password": "bar",
797	                "auth": {"type": LoginType.DUMMY},
798	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
854	
855	        channel = self.make_request(
856	            "POST",
857	            url,
858	            {
859	                "client_secret": "foo",
860	                "email": "foo@test.com",
861	                "send_attempt": 0,
862	            },
863	            access_token=tok,
864	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
876	
877	        channel = self.make_request(
878	            "POST",
879	            url,
880	            {
881	                "client_secret": "foo",
882	                "email": "bar@test.com",
883	                "send_attempt": 0,
884	            },
885	            access_token=tok,
886	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
911	        # Initiate the UIA flow.
912	        channel = self.make_request(
913	            "POST",
914	            "register",
915	            {"username": username, "type": "m.login.password", "password": "bar"},
916	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:925
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
924	        session = channel.json_body["session"]
925	        channel = self.make_request(
926	            "POST",
927	            "register",
928	            {"auth": {"session": session, "type": LoginType.DUMMY}},
929	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
933	    def _get_login_flows(self) -> JsonDict:
934	        channel = self.make_request("GET", "/_matrix/client/r0/login")
935	        self.assertEqual(channel.code, HTTPStatus.OK, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
943	        params.update(extra_params)
944	        channel = self.make_request("POST", "/_matrix/client/r0/login", params)
945	        return channel

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_password_providers.py:984
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
983	        """Delete an individual device."""
984	        channel = self.make_request(
985	            "DELETE", "devices/" + device, body, access_token=access_token
986	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
179	        self.get_success(
180	            self.store.set_profile_avatar_url(self.frank, "http://my.server/me.png")
181	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	
184	        self.assertEqual("http://my.server/me.png", avatar_url)
185	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	        self.get_success(
189	            self.store.set_profile_avatar_url(self.frank, "http://my.server/me.png")
190	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
193	
194	        self.assertEqual("http://my.server/me.png", profile["avatar_url"])
195	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	                synapse.types.create_requester(self.frank),
201	                "http://my.server/pic.gif",
202	            )
203	        )
204	
205	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	            (self.get_success(self.store.get_profile_avatar_url(self.frank))),
207	            "http://my.server/pic.gif",
208	        )
209	
210	        # Set avatar again

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
214	                synapse.types.create_requester(self.frank),
215	                "http://my.server/me.png",
216	            )
217	        )
218	
219	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
220	            (self.get_success(self.store.get_profile_avatar_url(self.frank))),
221	            "http://my.server/me.png",
222	        )
223	
224	        # Set avatar to an empty string

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	        self.get_success(
242	            self.store.set_profile_avatar_url(self.frank, "http://my.server/me.png")
243	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	            (self.get_success(self.store.get_profile_avatar_url(self.frank))),
247	            "http://my.server/me.png",
248	        )
249	
250	        # Set avatar a second time is forbidden

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_profile.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
254	                synapse.types.create_requester(self.frank),
255	                "http://my.server/pic.gif",
256	            ),
257	            SynapseError,
258	        )
259	
260	    def test_avatar_constraints_no_config(self) -> None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_register.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
549	            "form_secret": "53cr3t",
550	            "public_baseurl": "http://test",
551	            "auto_join_rooms": ["#room:test"],
552	        },
553	    )
554	    def test_auto_create_auto_join_where_no_consent(self) -> None:
555	        """Test to ensure that the first user is not auto-joined to a room if
556	        they have not given general consent.
557	        """
558	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_room_list.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
23	        room_id = self.helper.create_room_as(tok=tok, extra_content=extra_content)
24	        channel = self.make_request(
25	            "PUT",
26	            f"/_matrix/client/v3/directory/list/room/{room_id}?access_token={tok}",
27	            content={
28	                "visibility": "public",
29	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_saml.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	# These are a few constants that are used as config parameters in the tests.
57	BASE_URL = "https://synapse/"
58	
59	
60	@attr.s
61	class FakeAuthnResponse:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_send_email.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
110	        super().setUp()
111	        self.reactor.lookups["localhost"] = "127.0.0.1"
112	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_sliding_sync.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	                "wildcard",
146	                """
147	                Test that a wildcard (*) for both the `event_type` and `state_key` will override
148	                all other values.
149	
150	                Note: MSC3575 describes different behavior to how we're handling things here but
151	                since it's not wrong to return more state than requested (`required_state` is
152	                just the minimum requested), it doesn't matter if we include things that the
153	                client wanted excluded. This complexity is also under scrutiny, see
154	                https://github.com/matrix-org/matrix-spec-proposals/pull/3575#discussion_r1185109050
155	
156	                > One unique exception is when you request all state events via ["*", "*"]. When used,
157	                > all state events are returned by default, and additional entries FILTER OUT the returned set
158	                > of state events. These additional entries cannot use '*' themselves.
159	                > For example, ["*", "*"], ["m.room.member", "@alice:example.com"] will _exclude_ every m.room.member
160	                > event _except_ for @alice:example.com, and include every other state event.
161	                > In addition, ["*", "*"], ["m.space.child", "*"] is an error, the m.space.child filter is not
162	                > required as it would have been returned anyway.
163	                >
164	                > -- MSC3575 (https://github.com/matrix-org/matrix-spec-proposals/pull/3575)
165	                """,
166	                # Input
167	                SlidingSyncConfig.SlidingSyncList(
168	                    timeline_limit=10,
169	                    required_state=[
170	                        (EventTypes.Name, ""),
171	                        (StateValues.WILDCARD, StateValues.WILDCARD),
172	                        (EventTypes.Member, "@foo"),
173	                        (EventTypes.CanonicalAlias, ""),
174	                    ],
175	                ),
176	                # Expected
177	                RoomSyncConfig(
178	                    timeline_limit=10,
179	                    required_state_map={
180	                        StateValues.WILDCARD: {StateValues.WILDCARD},
181	                    },
182	                ),
183	            ),
184	            (
185	                "wildcard_type",
186	                """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_sso.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	        self.assertTrue(
55	            self.get_success(handler.set_avatar(user_id, "http://my.server/me.png"))
56	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_sso.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        self.assertFalse(
73	            self.get_success(handler.set_avatar(user_id, "http://my.server/me.png"))
74	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_sso.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	        self.assertFalse(
85	            self.get_success(handler.set_avatar(user_id, "http://my.server/me.png"))
86	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_sso.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	        self.assertTrue(
99	            self.get_success(handler.set_avatar(user_id, "http://my.server/me.png"))
100	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_sso.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	        self.assertTrue(
109	            self.get_success(handler.set_avatar(user_id, "http://my.server/me.png"))
110	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_sso.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	    fake_response = FakeResponse(code=404)
125	    if url == "http://my.server/me.png":
126	        fake_response = FakeResponse(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_sync.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
190	        )
191	        channel = self.make_request(
192	            "POST",
193	            "/_matrix/client/r0/knock/%s" % (knock_room,),
194	            b"{}",
195	            tok,
196	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_typing.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
269	
270	        channel = self.make_request(
271	            "PUT",
272	            "/_matrix/federation/v1/send/1000000",
273	            _make_edu_transaction_json(
274	                EduTypes.TYPING,
275	                content={
276	                    "room_id": ROOM_ID,
277	                    "user_id": U_ONION.to_string(),
278	                    "typing": True,
279	                },
280	            ),
281	            federation_auth_origin=b"farm",
282	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/handlers/test_typing.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
310	
311	        channel = self.make_request(
312	            "PUT",
313	            "/_matrix/federation/v1/send/1000000",
314	            _make_edu_transaction_json(
315	                EduTypes.TYPING,
316	                content={
317	                    "room_id": OTHER_ROOM_ID,
318	                    "user_id": U_ONION.to_string(),
319	                    "typing": True,
320	                },
321	            ),
322	            federation_auth_origin=b"farm",
323	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/__init__.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
49	    with open(ca_file) as stream:
50	        content = stream.read()
51	    cert = Certificate.loadPEM(content)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/__init__.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
49	    with open(ca_file) as stream:
50	        content = stream.read()
51	    cert = Certificate.loadPEM(content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/__init__.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	    with open(cnf_filename, "wb") as f:
121	        f.write(CONFIG_TEMPLATE % {b"sanentries": sanentries})
122	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/__init__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
196	# packets are going to/coming from.
197	dummy_address = IPv4Address("TCP", "127.0.0.1", 80)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
197	        with LoggingContext("one") as context:
198	            fetch_d: Deferred[IResponse] = self.agent.request(b"GET", uri)
199	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
260	            request.setHeader(k, v)
261	        request.write(content)
262	        request.finish()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
296	
297	        self.reactor.lookups["testserv"] = "1.2.3.4"
298	        test_d = self._make_get_request(b"matrix-federation://testserv:8448/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
297	        self.reactor.lookups["testserv"] = "1.2.3.4"
298	        test_d = self._make_get_request(b"matrix-federation://testserv:8448/foo/bar")
299	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
306	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
307	        self.assertEqual(host, "1.2.3.4")
308	        self.assertEqual(port, 8448)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
322	        )
323	        content = request.content.read()
324	        self.assertEqual(content, b"")

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
322	        )
323	        content = request.content.read()
324	        self.assertEqual(content, b"")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
330	        request.responseHeaders.setRawHeaders(b"Content-Type", [b"application/json"])
331	        request.write("")
332	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
340	        # Send the body
341	        request.write(b'{ "a": 1 }')
342	        request.finish()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
350	    @patch.dict(
351	        os.environ, {"https_proxy": "http://proxy.com", "no_proxy": "unused.com"}
352	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
358	        os.environ,
359	        {"https_proxy": "http://user:pass@proxy.com", "no_proxy": "unused.com"},
360	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
367	    @patch.dict(
368	        os.environ, {"https_proxy": "https://proxy.com", "no_proxy": "unused.com"}
369	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
375	        os.environ,
376	        {"https_proxy": "https://user:pass@proxy.com", "no_proxy": "unused.com"},
377	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
396	
397	        self.reactor.lookups["testserv"] = "1.2.3.4"
398	        self.reactor.lookups["proxy.com"] = "9.9.9.9"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
397	        self.reactor.lookups["testserv"] = "1.2.3.4"
398	        self.reactor.lookups["proxy.com"] = "9.9.9.9"
399	        test_d = self._make_get_request(b"matrix-federation://testserv:8448/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
398	        self.reactor.lookups["proxy.com"] = "9.9.9.9"
399	        test_d = self._make_get_request(b"matrix-federation://testserv:8448/foo/bar")
400	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
408	        # make sure we are connecting to the proxy
409	        self.assertEqual(host, "9.9.9.9")
410	        self.assertEqual(port, 1080)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
435	            # Compute the correct header value for Proxy-Authorization
436	            encoded_credentials = base64.b64encode(expected_auth_credentials)
437	            expected_header_value = b"Basic " + encoded_credentials

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:436
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
435	            # Compute the correct header value for Proxy-Authorization
436	            encoded_credentials = base64.b64encode(expected_auth_credentials)
437	            expected_header_value = b"Basic " + encoded_credentials

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
509	        self.assertIsNone(request.requestHeaders.getRawHeaders(b"Proxy-Authorization"))
510	        content = request.content.read()
511	        self.assertEqual(content, b"")

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
509	        self.assertIsNone(request.requestHeaders.getRawHeaders(b"Proxy-Authorization"))
510	        content = request.content.read()
511	        self.assertEqual(content, b"")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
517	        request.responseHeaders.setRawHeaders(b"Content-Type", [b"application/json"])
518	        request.write("")
519	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
527	        # Send the body
528	        request.write(b'{ "a": 1 }')
529	        request.finish()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
543	        # there will be a getaddrinfo on the IP
544	        self.reactor.lookups["1.2.3.4"] = "1.2.3.4"
545	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
543	        # there will be a getaddrinfo on the IP
544	        self.reactor.lookups["1.2.3.4"] = "1.2.3.4"
545	
546	        test_d = self._make_get_request(b"matrix-federation://1.2.3.4/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
545	
546	        test_d = self._make_get_request(b"matrix-federation://1.2.3.4/foo/bar")
547	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
554	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
555	        self.assertEqual(host, "1.2.3.4")
556	        self.assertEqual(port, 8448)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
581	
582	        test_d = self._make_get_request(b"matrix-federation://[::1]/foo/bar")
583	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
617	
618	        test_d = self._make_get_request(b"matrix-federation://[::1]:80/foo/bar")
619	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
650	        self.mock_resolver.resolve_service.return_value = []
651	        self.reactor.lookups["testserv1"] = "1.2.3.4"
652	
653	        test_d = self._make_get_request(b"matrix-federation://testserv1/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
652	
653	        test_d = self._make_get_request(b"matrix-federation://testserv1/foo/bar")
654	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
664	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
665	        self.assertEqual(host, "1.2.3.4")
666	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
682	        (host, port, client_factory, _timeout, _bindAddress) = clients[1]
683	        self.assertEqual(host, "1.2.3.4")
684	        self.assertEqual(port, 8448)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
704	        # there will be a getaddrinfo on the IP
705	        self.reactor.lookups["1.2.3.5"] = "1.2.3.5"
706	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
704	        # there will be a getaddrinfo on the IP
705	        self.reactor.lookups["1.2.3.5"] = "1.2.3.5"
706	
707	        test_d = self._make_get_request(b"matrix-federation://1.2.3.5/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
706	
707	        test_d = self._make_get_request(b"matrix-federation://1.2.3.5/foo/bar")
708	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
715	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
716	        self.assertEqual(host, "1.2.3.5")
717	        self.assertEqual(port, 8448)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
736	        self.mock_resolver.resolve_service.return_value = []
737	        self.reactor.lookups["testserv"] = "1.2.3.4"
738	
739	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
738	
739	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
740	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
750	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
751	        self.assertEqual(host, "1.2.3.4")
752	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
768	        (host, port, client_factory, _timeout, _bindAddress) = clients[1]
769	        self.assertEqual(host, "1.2.3.4")
770	        self.assertEqual(port, 8448)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
790	        self.mock_resolver.resolve_service.return_value = []
791	        self.reactor.lookups["testserv"] = "1.2.3.4"
792	        self.reactor.lookups["target-server"] = "1::f"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
793	
794	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
795	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:803
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
802	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
803	        self.assertEqual(host, "1.2.3.4")
804	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
857	        self.mock_resolver.resolve_service.return_value = []
858	        self.reactor.lookups["testserv"] = "1.2.3.4"
859	        self.reactor.lookups["target-server"] = "1::f"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:861
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
860	
861	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
862	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
869	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop()
870	        self.assertEqual(host, "1.2.3.4")
871	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
888	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop()
889	        self.assertEqual(host, "1.2.3.4")
890	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
899	        self.assertEqual(request.path, b"/even_better_known")
900	        request.write(b'{ "m.server": "target-server" }')
901	        request.finish()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:951
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
950	        self.mock_resolver.resolve_service.return_value = []
951	        self.reactor.lookups["testserv"] = "1.2.3.4"
952	
953	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:953
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
952	
953	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
954	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
964	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop()
965	        self.assertEqual(host, "1.2.3.4")
966	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
979	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop()
980	        self.assertEqual(host, "1.2.3.4")
981	        self.assertEqual(port, 8448)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1006	        self.mock_resolver.resolve_service.return_value = []
1007	        self.reactor.lookups["testserv"] = "1.2.3.4"
1008	
1009	        config = default_config("test", parse=True)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1028	
1029	        test_d = agent.request(b"GET", b"matrix-federation://testserv/foo/bar")
1030	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1037	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
1038	        self.assertEqual(host, "1.2.3.4")
1039	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1060
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1059	        ]
1060	        self.reactor.lookups["srvtarget"] = "1.2.3.4"
1061	
1062	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1062
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1061	
1062	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
1063	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1075	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
1076	        self.assertEqual(host, "1.2.3.4")
1077	        self.assertEqual(port, 8443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1103	        ]
1104	        self.reactor.lookups["srvtarget"] = "1.2.3.4"
1105	
1106	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1105	
1106	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
1107	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1119	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
1120	        self.assertEqual(host, "1.2.3.4")
1121	        self.assertEqual(port, 8443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1142	
1143	        self.reactor.lookups["testserv"] = "1.2.3.4"
1144	        self.reactor.lookups["srvtarget"] = "5.6.7.8"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1143	        self.reactor.lookups["testserv"] = "1.2.3.4"
1144	        self.reactor.lookups["srvtarget"] = "5.6.7.8"
1145	
1146	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1145	
1146	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
1147	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1154	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
1155	        self.assertEqual(host, "1.2.3.4")
1156	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1175	        (host, port, client_factory, _timeout, _bindAddress) = clients[1]
1176	        self.assertEqual(host, "5.6.7.8")
1177	        self.assertEqual(port, 8443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1202	
1203	        self.reactor.lookups["testserv"] = "1.2.3.4"
1204	        self.reactor.lookups["srvtarget"] = "5.6.7.8"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1203	        self.reactor.lookups["testserv"] = "1.2.3.4"
1204	        self.reactor.lookups["srvtarget"] = "5.6.7.8"
1205	
1206	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1205	
1206	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
1207	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1214	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
1215	        self.assertEqual(host, "1.2.3.4")
1216	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1240	        (host, port, client_factory, _timeout, _bindAddress) = clients[1]
1241	        self.assertEqual(host, "5.6.7.8")
1242	        self.assertEqual(port, 8443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1268	        # the resolver is always called with the IDNA hostname as a native string.
1269	        self.reactor.lookups["xn--bcher-kva.com"] = "1.2.3.4"
1270	
1271	        # this is idna for b√ºcher.com
1272	        test_d = self._make_get_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1271	        # this is idna for b√ºcher.com
1272	        test_d = self._make_get_request(
1273	            b"matrix-federation://xn--bcher-kva.com/foo/bar"
1274	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1285	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
1286	        self.assertEqual(host, "1.2.3.4")
1287	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1307	        (host, port, client_factory, _timeout, _bindAddress) = clients[1]
1308	        self.assertEqual(host, "1.2.3.4")
1309	        self.assertEqual(port, 8448)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1335	        ]  # t√¢rget.com
1336	        self.reactor.lookups["xn--trget-3qa.com"] = "1.2.3.4"
1337	
1338	        test_d = self._make_get_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1337	
1338	        test_d = self._make_get_request(
1339	            b"matrix-federation://xn--bcher-kva.com/foo/bar"
1340	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1352	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
1353	        self.assertEqual(host, "1.2.3.4")
1354	        self.assertEqual(port, 8443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1382	        ]  # t√¢rget.com
1383	        self.reactor.lookups["xn--trget-3qa.com"] = "1.2.3.4"
1384	
1385	        test_d = self._make_get_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1384	
1385	        test_d = self._make_get_request(
1386	            b"matrix-federation://xn--bcher-kva.com/foo/bar"
1387	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1402	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
1403	        self.assertEqual(host, "1.2.3.4")
1404	        self.assertEqual(port, 8443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1424	    def test_well_known_cache(self) -> None:
1425	        self.reactor.lookups["testserv"] = "1.2.3.4"
1426	
1427	        fetch_d = defer.ensureDeferred(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1434	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
1435	        self.assertEqual(host, "1.2.3.4")
1436	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1467	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
1468	        self.assertEqual(host, "1.2.3.4")
1469	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1484	
1485	        self.reactor.lookups["testserv"] = "1.2.3.4"
1486	
1487	        fetch_d = defer.ensureDeferred(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1494	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
1495	        self.assertEqual(host, "1.2.3.4")
1496	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1560	        """A well-known query that returns a result which is too large should be rejected."""
1561	        self.reactor.lookups["testserv"] = "1.2.3.4"
1562	
1563	        fetch_d = defer.ensureDeferred(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1570	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
1571	        self.assertEqual(host, "1.2.3.4")
1572	        self.assertEqual(port, 443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1592	        ]
1593	        self.reactor.lookups["target.com"] = "1.2.3.4"
1594	
1595	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1594	
1595	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
1596	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1607	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
1608	        self.assertEqual(host, "1.2.3.4")
1609	        self.assertEqual(port, 8443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1623	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
1624	        self.assertEqual(host, "1.2.3.4")
1625	        self.assertEqual(port, 8444)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1652	        ]
1653	        self.reactor.lookups["target.com"] = "1.2.3.4"
1654	
1655	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1655
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1654	
1655	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
1656	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1667	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
1668	        self.assertEqual(host, "1.2.3.4")
1669	        self.assertEqual(port, 8443)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1683	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
1684	        self.assertEqual(host, "1.2.3.4")
1685	        self.assertEqual(port, 8444)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1709	        ]
1710	        self.reactor.lookups["target.com"] = "1.2.3.4"
1711	
1712	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1711	
1712	        test_d = self._make_get_request(b"matrix-federation://testserv/foo/bar")
1713	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/federation/test_matrix_federation_agent.py:1726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1725	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
1726	        self.assertEqual(host, "1.2.3.4")
1727	        self.assertEqual(port, 8443)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/server/_base.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
212	
213	    _log_for_request(
214	        0, f"Running make_request_with_cancellation_test for {test_name}..."
215	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/server/_base.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
225	                    # Start the request.
226	                    channel = make_request(
227	                        reactor,
228	                        site,
229	                        method,
230	                        path,
231	                        content,
232	                        await_result=False,
233	                        access_token=token,
234	                    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/server/_base.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
256	                if respond_mock.called:
257	                    _log_for_request(request_number, "--- response finished ---")
258	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/server/_base.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
271	
272	                _log_for_request(request_number, "--- disconnected ---")
273	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/server/_base.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
539	        message = f"{'  ' * i}{frame}"
540	        _log_for_request(request_number, message)
541	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/server/_base.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
549	    message = f"{'  ' * i}> *{note}* at {frame}"
550	    _log_for_request(request_number, message)
551	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_additional_resource.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
59	
60	        channel = make_request(
61	            self.reactor, FakeSite(resource, self.reactor), "GET", "/"
62	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_additional_resource.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
70	
71	        channel = make_request(
72	            self.reactor, FakeSite(resource, self.reactor), "GET", "/"
73	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_client.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
347	            self.failureResultOf(
348	                agent.request(b"GET", b"http://" + domain), DNSLookupError
349	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_client.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
357	        ):
358	            d = agent.request(b"GET", b"http://" + domain)
359	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_client.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
390	        self.failureResultOf(
391	            agent.request(b"GET", b"http://" + self.unsafe_ip), SynapseError
392	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_client.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
401	        ):
402	            d = agent.request(b"GET", b"http://" + domain)
403	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_endpoint.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
29	            "my-example.com:1234": ("my-example.com", 1234),
30	            "1.2.3.4": ("1.2.3.4", None),
31	            "[0abc:1def::1234]": ("[0abc:1def::1234]", None),
32	            "1.2.3.4:1": ("1.2.3.4", 1),
33	            "[0abc:1def::1234]:8080": ("[0abc:1def::1234]", 8080),
34	            ":80": ("", 80),
35	            "": ("", None),
36	        }
37	
38	        for i, o in test_data.items():
39	            self.assertEqual(parse_server_name(i), o)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_endpoint.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
29	            "my-example.com:1234": ("my-example.com", 1234),
30	            "1.2.3.4": ("1.2.3.4", None),
31	            "[0abc:1def::1234]": ("[0abc:1def::1234]", None),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_endpoint.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
31	            "[0abc:1def::1234]": ("[0abc:1def::1234]", None),
32	            "1.2.3.4:1": ("1.2.3.4", 1),
33	            "[0abc:1def::1234]:8080": ("[0abc:1def::1234]", 8080),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
73	        self.cl = MatrixFederationHttpClient(self.hs, None)
74	        self.reactor.lookups["testserv"] = "1.2.3.4"
75	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
99	
100	        test_d = do_request()
101	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
110	        (host, port, factory, _timeout, _bindAddress) = clients[0]
111	        self.assertEqual(host, "1.2.3.4")
112	        self.assertEqual(port, 8008)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
169	        (host, port, factory, _timeout, _bindAddress) = clients[0]
170	        self.assertEqual(host, "1.2.3.4")
171	        self.assertEqual(port, 8008)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
197	        self.assertEqual(len(clients), 1)
198	        self.assertEqual(clients[0][0], "1.2.3.4")
199	        self.assertEqual(clients[0][1], 8008)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
229	        self.assertEqual(len(clients), 1)
230	        self.assertEqual(clients[0][0], "1.2.3.4")
231	        self.assertEqual(clients[0][1], 8008)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
253	        )
254	        self.reactor.lookups["internal"] = "127.0.0.1"
255	        self.reactor.lookups["internalv6"] = "fe80:0:0:0:0:8a2e:370:7337"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
255	        self.reactor.lookups["internalv6"] = "fe80:0:0:0:0:8a2e:370:7337"
256	        self.reactor.lookups["fine"] = "10.20.30.40"
257	        cl = MatrixFederationHttpClient(self.hs, None)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
323	        )
324	        d = defer.ensureDeferred(self.cl._send_request(request, timeout=10000))
325	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
358	            self.cl.federation_get_file(
359	                "testserv:8008", "path", output_stream, limiter, "127.0.0.1", 10000
360	            )
361	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
367	        (host, port, factory, _timeout, _bindAddress) = clients[0]
368	        self.assertEqual(host, "1.2.3.4")
369	        self.assertEqual(port, 8008)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
394	        (host, port, factory, _timeout, _bindAddress) = clients[1]
395	        self.assertEqual(host, "1.2.3.4")
396	        self.assertEqual(port, 8008)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
571	        request = server.requests[0]
572	        content = request.content.read()
573	        self.assertEqual(content, b'{"a":"b"}')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
630	        (host, port, factory, _timeout, _bindAddress) = clients[0]
631	        self.assertEqual(host, "1.2.3.4")
632	        self.assertEqual(port, 8008)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_matrixfederationclient.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
676	        (host, port, factory, _timeout, _bindAddress) = clients[0]
677	        self.assertEqual(host, "1.2.3.4")
678	        self.assertEqual(port, 8008)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
238	        self.assertEqual(
239	            base64.b64decode(basic_auth_payload),
240	            b"looooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooonguser:pass",

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:239
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
238	        self.assertEqual(
239	            base64.b64decode(basic_auth_payload),
240	            b"looooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooonguser:pass",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
342	
343	        self.reactor.lookups[hostname.decode()] = "1.2.3.4"
344	        d = agent.request(b"GET", scheme + b"://" + hostname + b"/" + path)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
343	        self.reactor.lookups[hostname.decode()] = "1.2.3.4"
344	        d = agent.request(b"GET", scheme + b"://" + hostname + b"/" + path)
345	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
349	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
350	        self.assertEqual(host, "1.2.3.4")
351	        self.assertEqual(port, 443 if is_https else 80)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
371	        self.assertEqual(request.requestHeaders.getRawHeaders(b"host"), [hostname])
372	        request.write(b"result")
373	        request.finish()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	    @patch.dict(
452	        os.environ, {"http_proxy": "https://proxy.com:8888", "no_proxy": "unused.com"}
453	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
461	        {
462	            "http_proxy": "https://bob:pinkponies@proxy.com:8888",
463	            "no_proxy": "unused.com",
464	        },
465	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
488	    @patch.dict(
489	        os.environ, {"https_proxy": "https://proxy.com", "no_proxy": "unused.com"}
490	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
498	        os.environ,
499	        {"https_proxy": "https://bob:pinkponies@proxy.com", "no_proxy": "unused.com"},
500	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
524	
525	        self.reactor.lookups["proxy.com"] = "1.2.3.5"
526	        d = agent.request(b"GET", b"http://test.com")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
525	        self.reactor.lookups["proxy.com"] = "1.2.3.5"
526	        d = agent.request(b"GET", b"http://test.com")
527	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
531	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
532	        self.assertEqual(host, "1.2.3.5")
533	        self.assertEqual(port, 8888)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
559	            # Compute the correct header value for Proxy-Authorization
560	            encoded_credentials = base64.b64encode(expected_auth_credentials)
561	            expected_header_value = b"Basic " + encoded_credentials

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:560
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
559	            # Compute the correct header value for Proxy-Authorization
560	            encoded_credentials = base64.b64encode(expected_auth_credentials)
561	            expected_header_value = b"Basic " + encoded_credentials

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
571	        self.assertEqual(request.requestHeaders.getRawHeaders(b"host"), [b"test.com"])
572	        request.write(b"result")
573	        request.finish()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
597	
598	        self.reactor.lookups["proxy.com"] = "1.2.3.5"
599	        d = agent.request(b"GET", b"https://test.com/abc")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
598	        self.reactor.lookups["proxy.com"] = "1.2.3.5"
599	        d = agent.request(b"GET", b"https://test.com/abc")
600	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
604	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
605	        self.assertEqual(host, "1.2.3.5")
606	        self.assertEqual(port, 1080)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
631	            # Compute the correct header value for Proxy-Authorization
632	            encoded_credentials = base64.b64encode(expected_auth_credentials)
633	            expected_header_value = b"Basic " + encoded_credentials

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:632
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
631	            # Compute the correct header value for Proxy-Authorization
632	            encoded_credentials = base64.b64encode(expected_auth_credentials)
633	            expected_header_value = b"Basic " + encoded_credentials

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
702	
703	        request.write(b"result")
704	        request.finish()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
722	
723	        self.reactor.lookups["proxy.com"] = "1.2.3.5"
724	        d = agent.request(b"GET", b"http://test.com")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
723	        self.reactor.lookups["proxy.com"] = "1.2.3.5"
724	        d = agent.request(b"GET", b"http://test.com")
725	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
729	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
730	        self.assertEqual(host, "1.2.3.5")
731	        self.assertEqual(port, 8888)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
748	        self.assertEqual(request.requestHeaders.getRawHeaders(b"host"), [b"test.com"])
749	        request.write(b"result")
750	        request.finish()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
769	
770	        self.reactor.lookups["proxy.com"] = "1.2.3.5"
771	        d = agent.request(b"GET", b"https://test.com/abc")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
770	        self.reactor.lookups["proxy.com"] = "1.2.3.5"
771	        d = agent.request(b"GET", b"https://test.com/abc")
772	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
776	        (host, port, client_factory, _timeout, _bindAddress) = clients[0]
777	        self.assertEqual(host, "1.2.3.5")
778	        self.assertEqual(port, 1080)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
843	        self.assertEqual(request.requestHeaders.getRawHeaders(b"host"), [b"test.com"])
844	        request.write(b"result")
845	        request.finish()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
864	
865	    @patch.dict(os.environ, {"http_proxy": "http://proxy.com:8888"})
866	    def test_proxy_with_http_scheme(self) -> None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_proxyagent.py:872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
871	
872	    @patch.dict(os.environ, {"http_proxy": "https://proxy.com:8888"})
873	    def test_proxy_with_https_scheme(self) -> None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
60	        obj = {"foo": 1}
61	        result1 = parse_json_value_from_request(make_request(obj))
62	        self.assertEqual(result1, obj)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
60	        obj = {"foo": 1}
61	        result1 = parse_json_value_from_request(make_request(obj))
62	        self.assertEqual(result1, obj)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
64	        # Results don't have to be objects.
65	        result2 = parse_json_value_from_request(make_request(b'["foo"]'))
66	        self.assertEqual(result2, ["foo"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
64	        # Results don't have to be objects.
65	        result2 = parse_json_value_from_request(make_request(b'["foo"]'))
66	        self.assertEqual(result2, ["foo"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
69	        with self.assertRaises(SynapseError):
70	            parse_json_value_from_request(make_request(b""))
71	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
69	        with self.assertRaises(SynapseError):
70	            parse_json_value_from_request(make_request(b""))
71	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
71	
72	        result3 = parse_json_value_from_request(
73	            make_request(b""), allow_empty_body=True
74	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
72	        result3 = parse_json_value_from_request(
73	            make_request(b""), allow_empty_body=True
74	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
78	        with self.assertRaises(SynapseError):
79	            parse_json_value_from_request(make_request(b"\xff\x00"))
80	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
78	        with self.assertRaises(SynapseError):
79	            parse_json_value_from_request(make_request(b"\xff\x00"))
80	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
82	        with self.assertRaises(SynapseError):
83	            parse_json_value_from_request(make_request(b"foo"))
84	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
82	        with self.assertRaises(SynapseError):
83	            parse_json_value_from_request(make_request(b"foo"))
84	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
85	        with self.assertRaises(SynapseError):
86	            parse_json_value_from_request(make_request(b'{"foo": Infinity}'))
87	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
85	        with self.assertRaises(SynapseError):
86	            parse_json_value_from_request(make_request(b'{"foo": Infinity}'))
87	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
90	        # Test empty.
91	        result = parse_json_object_from_request(
92	            make_request(b""), allow_empty_body=True
93	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
91	        result = parse_json_object_from_request(
92	            make_request(b""), allow_empty_body=True
93	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
97	        with self.assertRaises(SynapseError):
98	            parse_json_object_from_request(make_request(b'["foo"]'))
99	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
97	        with self.assertRaises(SynapseError):
98	            parse_json_object_from_request(make_request(b'["foo"]'))
99	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
128	        """Test that handlers with the `@cancellable` flag can be cancelled."""
129	        channel = self.make_request("GET", "/sleep", await_result=False)
130	        test_disconnect(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_servlet.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
138	        """Test that handlers without the `@cancellable` flag cannot be cancelled."""
139	        channel = self.make_request("POST", "/sleep", await_result=False)
140	        test_disconnect(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
39	        # Add a DNS entry for a test server
40	        self.reactor.lookups["testserv"] = "1.2.3.4"
41	
42	        self.cl = hs.get_simple_http_client()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        """
48	        d = defer.ensureDeferred(self.cl.get_json("http://testserv2:8008/foo/bar"))
49	        self.pump()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    def test_client_connection_refused(self) -> None:
55	        d = defer.ensureDeferred(self.cl.get_json("http://testserv:8008/foo/bar"))
56	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
64	        (host, port, factory, _timeout, _bindAddress) = clients[0]
65	        self.assertEqual(host, "1.2.3.4")
66	        self.assertEqual(port, 8008)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        """
80	        d = defer.ensureDeferred(self.cl.get_json("http://testserv:8008/foo/bar"))
81	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
89	        self.assertEqual(len(clients), 1)
90	        self.assertEqual(clients[0][0], "1.2.3.4")
91	        self.assertEqual(clients[0][1], 8008)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	        """
107	        d = defer.ensureDeferred(self.cl.get_json("http://testserv:8008/foo/bar"))
108	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
116	        self.assertEqual(len(clients), 1)
117	        self.assertEqual(clients[0][0], "1.2.3.4")
118	        self.assertEqual(clients[0][1], 8008)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
136	        # Add some DNS entries we'll block
137	        self.reactor.lookups["internal"] = "127.0.0.1"
138	        self.reactor.lookups["internalv6"] = "fe80:0:0:0:0:8a2e:370:7337"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        # Make the request
146	        d = defer.ensureDeferred(cl.get_json("http://internal:8008/foo/bar"))
147	        self.pump(1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	        d = defer.ensureDeferred(
159	            cl.post_json_get_json("http://internalv6:8008/foo/bar", {})
160	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/http/test_simple_client.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	        # Make the request
175	        d = defer.ensureDeferred(cl.get_json("http://testserv:8008/foo/bar"))
176	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/logging/test_remote_handler.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
57	        """
58	        handler = RemoteHandler("127.0.0.1", 9000, _reactor=self.reactor)
59	        logger = self.get_logger(handler)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/logging/test_remote_handler.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
82	        handler = RemoteHandler(
83	            "127.0.0.1", 9000, maximum_buffer=10, _reactor=self.reactor
84	        )
85	        logger = self.get_logger(handler)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/logging/test_remote_handler.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
112	        handler = RemoteHandler(
113	            "127.0.0.1", 9000, maximum_buffer=10, _reactor=self.reactor
114	        )
115	        logger = self.get_logger(handler)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/logging/test_remote_handler.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
148	        handler = RemoteHandler(
149	            "127.0.0.1", 9000, maximum_buffer=10, _reactor=self.reactor
150	        )
151	        logger = self.get_logger(handler)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/logging/test_remote_handler.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
175	        handler = RemoteHandler(
176	            "127.0.0.1", 9000, maximum_buffer=10, _reactor=self.reactor
177	        )
178	        logger = self.get_logger(handler)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/logging/test_terse_json.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
205	        self.assertTrue(log["request"].startswith("POST-"))
206	        self.assertEqual(log["ip_address"], "127.0.0.1")
207	        self.assertEqual(log["site_tag"], "test-site")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_filepath.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
267	                "matrix-federation.matrix.org:8448",
268	                "10.1.12.123",
269	                "10.1.12.123:8448",
270	                "[fd00:abcd::ffff]",
271	                "[fd00:abcd::ffff]:8448",
272	            ],
273	            invalid_values=[
274	                "/matrix.org",
275	                "matrix.org/..",
276	                "matrix.org\x00",
277	                "",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	
169	        tree = decode_body(html, "http://example.com/test.html")
170	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	
186	        tree = decode_body(html, "http://example.com/test.html")
187	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	
206	        tree = decode_body(html, "http://example.com/test.html")
207	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	
229	        tree = decode_body(html, "http://example.com/test.html")
230	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
243	
244	        tree = decode_body(html, "http://example.com/test.html")
245	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
259	
260	        tree = decode_body(html, "http://example.com/test.html")
261	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
275	
276	        tree = decode_body(html, "http://example.com/test.html")
277	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	
297	        tree = decode_body(html, "http://example.com/test.html")
298	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
312	
313	        tree = decode_body(html, "http://example.com/test.html")
314	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
321	        html = b""
322	        tree = decode_body(html, "http://example.com/test.html")
323	        self.assertIsNone(tree)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
327	        html = b"\x00"
328	        tree = decode_body(html, "http://example.com/test.html")
329	        self.assertIsNone(tree)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
341	        """.strip()
342	        tree = decode_body(html, "http://example.com/test.html")
343	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
356	        """
357	        tree = decode_body(html, "http://example.com/test.html", "invalid-encoding")
358	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
372	        """
373	        tree = decode_body(html, "http://example.com/test.html")
374	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
387	        """
388	        tree = decode_body(html, "http://example.com/test.html")
389	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
401	        """
402	        tree = decode_body(html, "http://example.com/test.html")
403	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
423	        """
424	        tree = decode_body(html, "http://example.com/test.html")
425	        assert tree is not None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_html_preview.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
442	        """
443	        tree = decode_body(html, "http://example.com/test.html")
444	        assert tree is not None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	        with open(secondary_path, "w") as f:
99	            f.write(test_body)
100	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
98	        with open(secondary_path, "w") as f:
99	            f.write(test_body)
100	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	        # Hotloop until the threadpool does its job...
112	        self.wait_on_thread(x)
113	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
124	        with open(local_path) as f:
125	            body = f.read()
126	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
328	                data, response = r
329	                output_stream.write(data)
330	                return response

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
328	                data, response = r
329	                output_stream.write(data)
330	                return response

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
333	                f.trap(HttpResponseException)
334	                output_stream.write(f.value.response)
335	                return f

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
333	                f.trap(HttpResponseException)
334	                output_stream.write(f.value.response)
335	                return f

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
382	    ) -> FakeChannel:
383	        channel = self.make_request(
384	            "GET",
385	            f"/_matrix/media/v3/download/{self.media_id}",
386	            shorthand=False,
387	            await_result=False,
388	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
611	        params = "?width=32&height=32&method=scale"
612	        channel = self.make_request(
613	            "GET",
614	            f"/_matrix/media/r0/thumbnail/{self.media_id}{params}",
615	            shorthand=False,
616	            await_result=False,
617	        )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
637	        )
638	        shutil.rmtree(thumbnail_dir, ignore_errors=True)
639	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
639	
640	        channel = self.make_request(
641	            "GET",
642	            f"/_matrix/media/r0/thumbnail/{self.media_id}{params}",
643	            shorthand=False,
644	            await_result=False,
645	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
675	        params = "?width=32&height=32&method=" + method
676	        channel = self.make_request(
677	            "GET",
678	            f"/_matrix/media/r0/thumbnail/{self.media_id}{params}",
679	            shorthand=False,
680	            await_result=False,
681	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
814	        """
815	        channel = self.make_request(
816	            "GET",
817	            f"/_matrix/media/v3/download/{self.media_id}",
818	            shorthand=False,
819	            await_result=False,
820	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1075	        # first request should go through
1076	        channel = self.make_request(
1077	            "GET",
1078	            "/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxyz",
1079	            shorthand=False,
1080	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1085
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1084	        for i in range(15):
1085	            channel2 = self.make_request(
1086	                "GET",
1087	                f"/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxy{i}",
1088	                shorthand=False,
1089	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1092	        # 17th will hit ratelimit
1093	        channel3 = self.make_request(
1094	            "GET",
1095	            "/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxyx",
1096	            shorthand=False,
1097	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1100	        # however, a request from a different IP will go through
1101	        channel4 = self.make_request(
1102	            "GET",
1103	            "/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxyz",
1104	            shorthand=False,
1105	            client_ip="187.233.230.159",
1106	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1104	            shorthand=False,
1105	            client_ip="187.233.230.159",
1106	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1117	        # enough has drained and next request goes through
1118	        channel5 = self.make_request(
1119	            "GET",
1120	            "/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxyb",
1121	            shorthand=False,
1122	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1151	        # first request should go through
1152	        channel = self.make_request(
1153	            "GET",
1154	            "/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxyz",
1155	            shorthand=False,
1156	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1159	        # immediate second request should fail
1160	        channel = self.make_request(
1161	            "GET",
1162	            "/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxy1",
1163	            shorthand=False,
1164	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1170	        # request still fails
1171	        channel = self.make_request(
1172	            "GET",
1173	            "/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxy2",
1174	            shorthand=False,
1175	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1181	        # enough has drained from bucket and request is successful
1182	        channel = self.make_request(
1183	            "GET",
1184	            "/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxy3",
1185	            shorthand=False,
1186	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1218	        for i in range(3):
1219	            channel = self.make_request(
1220	                "GET",
1221	                f"/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxy{i}",
1222	                shorthand=False,
1223	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1226	        # 4th will hit ratelimit
1227	        channel2 = self.make_request(
1228	            "GET",
1229	            "/_matrix/media/v3/download/remote.org/abcdefghijklmnopqrstuvwxyx",
1230	            shorthand=False,
1231	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1255	
1256	        channel = self.make_request(
1257	            "GET", "/_matrix/media/v3/download/remote.org/abcd", shorthand=False
1258	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1266	    d: Deferred = defer.Deferred()
1267	    stream.write(SMALL_PNG)
1268	    d.callback(len(SMALL_PNG))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1266	    d: Deferred = defer.Deferred()
1267	    stream.write(SMALL_PNG)
1268	    d.callback(len(SMALL_PNG))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_media_storage.py:1350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1349	        # first request should go through
1350	        channel = self.make_request(
1351	            "GET",
1352	            "/_matrix/media/v3/download/remote.org/abc",
1353	            shorthand=False,
1354	            access_token=self.tok,
1355	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_oembed.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	        return self.oembed.parse_oembed_response(
51	            "https://test", json.dumps(response).encode("utf-8")
52	        )
53	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
45	        config["url_preview_ip_range_blacklist"] = (
46	            "192.168.1.1",
47	            "1.0.0.0/8",
48	            "3fff:ffff:ffff:ffff:ffff:ffff:ffff:ffff",
49	            "2001:800::/21",
50	        )
51	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    def test_all_urls_allowed(self) -> None:
76	        self.assertFalse(self.url_previewer._is_url_blocked("http://matrix.org"))
77	        self.assertFalse(self.url_previewer._is_url_blocked("https://matrix.org"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        self.assertFalse(self.url_previewer._is_url_blocked("http://matrix.org"))
77	        self.assertFalse(self.url_previewer._is_url_blocked("https://matrix.org"))
78	        self.assertFalse(self.url_previewer._is_url_blocked("http://localhost:8000"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	        self.assertFalse(self.url_previewer._is_url_blocked("https://matrix.org"))
78	        self.assertFalse(self.url_previewer._is_url_blocked("http://localhost:8000"))
79	        self.assertFalse(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        self.assertFalse(
80	            self.url_previewer._is_url_blocked("http://user:pass@matrix.org")
81	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        # Blocked via scheme and URL.
93	        self.assertTrue(self.url_previewer._is_url_blocked("http://matrix.org"))
94	        # Not blocked because all components must match.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        # Not blocked because all components must match.
95	        self.assertFalse(self.url_previewer._is_url_blocked("https://matrix.org"))
96	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	        self.assertTrue(
99	            self.url_previewer._is_url_blocked("http://user:pass@example.com")
100	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	        )
101	        self.assertTrue(self.url_previewer._is_url_blocked("http://user@example.com"))
102	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	        # All subdomains are blocked.
106	        self.assertTrue(self.url_previewer._is_url_blocked("http://foo.example.com"))
107	        self.assertTrue(self.url_previewer._is_url_blocked("http://.example.com"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	        self.assertTrue(self.url_previewer._is_url_blocked("http://foo.example.com"))
107	        self.assertTrue(self.url_previewer._is_url_blocked("http://.example.com"))
108	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	        # The TLD is not blocked.
110	        self.assertFalse(self.url_previewer._is_url_blocked("https://example.com"))
111	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	        # All subdomains are blocked.
115	        self.assertTrue(self.url_previewer._is_url_blocked("http://foo.example.com"))
116	        # Requires a non-empty subdomain.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	        # Requires a non-empty subdomain.
117	        self.assertFalse(self.url_previewer._is_url_blocked("http://.example.com"))
118	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/media/test_url_previewer.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	        # The TLD is not blocked.
120	        self.assertFalse(self.url_previewer._is_url_blocked("https://example.com"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/module_api/test_api.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
800	                lang=None,
801	                data={"url": "http://example.com/_matrix/push/v1/notify"},
802	            )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_email.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
70	            "notif_template_text": "notif_mail.txt",
71	            "smtp_host": "127.0.0.1",
72	            "smtp_port": 20,
73	            "require_transport_security": False,
74	            "smtp_user": None,
75	            "smtp_pass": None,
76	            "app_name": "Matrix",
77	            "notif_from": "test@example.com",
78	            "riot_base_url": None,
79	        }
80	        config["public_baseurl"] = "http://aaa"
81	
82	        hs = self.setup_test_homeserver(config=config)
83	
84	        # List[Tuple[Deferred, args, kwargs]]
85	        self.email_attempts: List[Tuple[Deferred, Sequence, Dict]] = []
86	
87	        def sendmail(*args: Any, **kwargs: Any) -> Deferred:
88	            # This mocks out synapse.reactor.send_email._sendmail.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_email.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        }
80	        config["public_baseurl"] = "http://aaa"
81	
82	        hs = self.setup_test_homeserver(config=config)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_email.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
211	        # as a Message.
212	        txt_message = multipart_msg.get_payload(i=0)
213	        assert isinstance(txt_message, email.message.Message)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_email.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
215	        # Extract the actual bytes from the Message object, and decode them to a `str`.
216	        txt_bytes = txt_message.get_payload(decode=True)
217	        assert isinstance(txt_bytes, bytes)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_email.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
220	        # Do the same for the HTML portion of the multipart Message.
221	        html_message = multipart_msg.get_payload(i=1)
222	        assert isinstance(html_message, email.message.Message)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_email.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
222	        assert isinstance(html_message, email.message.Message)
223	        html_bytes = html_message.get_payload(decode=True)
224	        assert isinstance(html_bytes, bytes)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_email.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
236	        unsubscribe_resource = UnsubscribeResource(self.hs)
237	        channel = make_request(
238	            self.reactor,
239	            FakeSite(unsubscribe_resource, self.reactor),
240	            "POST" if use_post else "GET",
241	            unsubscribe_link,
242	            shorthand=False,
243	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_email.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
369	        # We need the asserts to convince mypy that this is OK.
370	        html_message = email.message_from_bytes(msg).get_payload(i=1)
371	        assert isinstance(html_message, email.message.Message)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_email.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
373	        # Extract the `bytes` from the html Message object, and decode to a `str`.
374	        html = html_message.get_payload(decode=True)
375	        assert isinstance(html, bytes)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	        # A URL without a path isn't accepted.
105	        test_data({"url": "http://example.com"})
106	        # A url with an incorrect path isn't accepted.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
106	        # A url with an incorrect path isn't accepted.
107	        test_data({"url": "http://example.com/foo"})
108	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
138	                lang=None,
139	                data={"url": "http://example.com/_matrix/push/v1/notify"},
140	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	        self.assertEqual(
177	            self.push_attempts[0][1], "http://example.com/_matrix/push/v1/notify"
178	        )
179	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
199	        self.assertEqual(
200	            self.push_attempts[1][1], "http://example.com/_matrix/push/v1/notify"
201	        )
202	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
259	                lang=None,
260	                data={"url": "http://example.com/_matrix/push/v1/notify"},
261	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	        self.assertEqual(
297	            self.push_attempts[0][1], "http://example.com/_matrix/push/v1/notify"
298	        )
299	        self.assertEqual(self.push_attempts[0][2]["notification"]["prio"], "high")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
336	        self.assertEqual(
337	            self.push_attempts[1][1], "http://example.com/_matrix/push/v1/notify"
338	        )
339	        self.assertEqual(self.push_attempts[1][2]["notification"]["prio"], "high")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
380	                lang=None,
381	                data={"url": "http://example.com/_matrix/push/v1/notify"},
382	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
397	        self.assertEqual(
398	            self.push_attempts[0][1], "http://example.com/_matrix/push/v1/notify"
399	        )
400	        self.assertEqual(self.push_attempts[0][2]["notification"]["prio"], "high")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
418	        self.assertEqual(
419	            self.push_attempts[1][1], "http://example.com/_matrix/push/v1/notify"
420	        )
421	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
467	                lang=None,
468	                data={"url": "http://example.com/_matrix/push/v1/notify"},
469	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
484	        self.assertEqual(
485	            self.push_attempts[0][1], "http://example.com/_matrix/push/v1/notify"
486	        )
487	        self.assertEqual(self.push_attempts[0][2]["notification"]["prio"], "high")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
495	        self.assertEqual(
496	            self.push_attempts[1][1], "http://example.com/_matrix/push/v1/notify"
497	        )
498	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
545	                lang=None,
546	                data={"url": "http://example.com/_matrix/push/v1/notify"},
547	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
566	        self.assertEqual(
567	            self.push_attempts[0][1], "http://example.com/_matrix/push/v1/notify"
568	        )
569	        self.assertEqual(self.push_attempts[0][2]["notification"]["prio"], "high")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
579	        self.assertEqual(
580	            self.push_attempts[1][1], "http://example.com/_matrix/push/v1/notify"
581	        )
582	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
652	                lang=None,
653	                data={"url": "http://example.com/_matrix/push/v1/notify"},
654	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
721	            push_url,
722	            "http://example.com/_matrix/push/v1/notify",
723	        )
724	        # Check that the unread count for the room is 0
725	        #

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
788	                lang=None,
789	                data={"url": "http://example.com/_matrix/push/v1/notify"},
790	                enabled=enabled,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:956
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
955	                "lang": "en",
956	                "data": {"url": "http://example.com/_matrix/push/v1/notify"},
957	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
995	                "lang": "en",
996	                "data": {"url": "http://example.com/_matrix/push/v1/notify"},
997	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:1122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1121	        push_data: Dict[str, Any] = {
1122	            "url": "http://example.com/_matrix/push/v1/notify",
1123	        }
1124	        if disable_badge_count:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/push/test_http.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1157	        self.assertEqual(
1158	            self.push_attempts[0][1], "http://example.com/_matrix/push/v1/notify"
1159	        )
1160	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
72	        self.server: ServerReplicationStreamProtocol = server_factory.buildProtocol(
73	            IPv4Address("TCP", "127.0.0.1", 0)
74	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
76	        # Make a new HomeServer object for the worker
77	        self.reactor.lookups["testserv"] = "1.2.3.4"
78	        self.worker_hs = self.setup_test_homeserver(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
167	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop(0)
168	        self.assertEqual(host, "1.2.3.4")
169	        self.assertEqual(port, 8765)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
171	        # Set up client side protocol
172	        client_address = IPv4Address("TCP", "127.0.0.1", 1234)
173	        client_protocol = client_factory.buildProtocol(("127.0.0.1", 1234))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
172	        client_address = IPv4Address("TCP", "127.0.0.1", 1234)
173	        client_protocol = client_factory.buildProtocol(("127.0.0.1", 1234))
174	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
275	
276	        self.reactor.lookups["testserv"] = "1.2.3.4"
277	        self.reactor.lookups["localhost"] = "127.0.0.1"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
276	        self.reactor.lookups["testserv"] = "1.2.3.4"
277	        self.reactor.lookups["localhost"] = "127.0.0.1"
278	
279	        # A map from a HS instance to the associated HTTP Site to use for
280	        # handling inbound HTTP requests to that instance.
281	        self._hs_to_site = {self.hs: self.site}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
298	        self.reactor.add_tcp_client_callback(
299	            "1.2.3.4",
300	            8765,
301	            lambda: self._handle_http_replication_attempt(self.hs, 8765),
302	        )
303	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
421	        (host, port, client_factory, _timeout, _bindAddress) = clients.pop()
422	        self.assertEqual(host, "1.2.3.4")
423	        self.assertEqual(port, repl_port)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
425	        # Set up client side protocol
426	        client_address = IPv4Address("TCP", "127.0.0.1", 1234)
427	        client_protocol = client_factory.buildProtocol(("127.0.0.1", 1234))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
426	        client_address = IPv4Address("TCP", "127.0.0.1", 1234)
427	        client_protocol = client_factory.buildProtocol(("127.0.0.1", 1234))
428	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/_base.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
459	
460	            client_address = IPv4Address("TCP", "127.0.0.1", 6379)
461	            client_protocol = client_factory.buildProtocol(client_address)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/http/test__base.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
95	        path = f"{REPLICATION_PREFIX}/{CancellableReplicationEndpoint.NAME}/"
96	        channel = self.make_request("POST", path, await_result=False, content={})
97	        test_disconnect(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/http/test__base.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
106	        path = f"{REPLICATION_PREFIX}/{UncancellableReplicationEndpoint.NAME}/"
107	        channel = self.make_request("POST", path, await_result=False, content={})
108	        test_disconnect(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_federation_ack.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
41	        config["federation_sender_instances"] = ["federation_sender1"]
42	        config["instance_map"] = {"main": {"host": "127.0.0.1", "port": 0}}
43	        return config

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
61	
62	        self.reactor.lookups["example.com"] = "1.2.3.4"
63	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
90	        """
91	        channel = make_request(
92	            self.reactor,
93	            self._hs_to_site[hs],
94	            "GET",
95	            f"/_matrix/media/r0/download/{target}/{media_id}",
96	            shorthand=False,
97	            access_token=self.access_token,
98	            await_result=False,
99	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	        request.responseHeaders.setRawHeaders(b"Content-Type", [b"text/plain"])
161	        request.write(b"Hello!")
162	        request.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186	        request1.responseHeaders.setRawHeaders(b"Content-Type", [b"text/plain"])
187	        request1.write(b"Hello!")
188	        request1.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
197	        request2.responseHeaders.setRawHeaders(b"Content-Type", [b"text/plain"])
198	        request2.write(b"Hello!")
199	        request2.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
225	        request1.responseHeaders.setRawHeaders(b"Content-Type", [b"image/png"])
226	        request1.write(SMALL_PNG)
227	        request1.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
235	        request2.responseHeaders.setRawHeaders(b"Content-Type", [b"image/png"])
236	        request2.write(SMALL_PNG)
237	        request2.finish()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
276	
277	        self.reactor.lookups["example.com"] = "1.2.3.4"
278	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
305	        """
306	        channel = make_request(
307	            self.reactor,
308	            self._hs_to_site[hs],
309	            "GET",
310	            f"/_matrix/client/v1/media/download/{target}/{media_id}",
311	            shorthand=False,
312	            access_token=self.access_token,
313	            await_result=False,
314	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
377	        )
378	        request.write(self.file_data)
379	        request.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
405	        )
406	        request1.write(self.file_data)
407	        request1.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
419	        )
420	        request2.write(self.file_data)
421	        request2.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
450	        img_data = b"\r\n\r\n--6067d4698f8d40a0a794ea7d7379d53a\r\nContent-Type: application/json\r\n\r\n{}\r\n--6067d4698f8d40a0a794ea7d7379d53a\r\nContent-Type: image/png\r\nContent-Disposition: inline; filename=test_img\r\n\r\n"
451	        request1.write(img_data)
452	        request1.write(SMALL_PNG)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
451	        request1.write(img_data)
452	        request1.write(SMALL_PNG)
453	        request1.write(b"\r\n--6067d4698f8d40a0a794ea7d7379d53a--\r\n\r\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
452	        request1.write(SMALL_PNG)
453	        request1.write(b"\r\n--6067d4698f8d40a0a794ea7d7379d53a--\r\n\r\n")
454	        request1.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
465	        )
466	        request2.write(img_data)
467	        request2.write(SMALL_PNG)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
466	        request2.write(img_data)
467	        request2.write(SMALL_PNG)
468	        request2.write(b"\r\n--6067d4698f8d40a0a794ea7d7379d53a--\r\n\r\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_multi_media_repo.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
467	        request2.write(SMALL_PNG)
468	        request2.write(b"\r\n--6067d4698f8d40a0a794ea7d7379d53a--\r\n\r\n")
469	        request2.finish()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_pusher_shard.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	                lang=None,
73	                data={"url": "https://push.example.com/_matrix/push/v1/notify"},
74	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_pusher_shard.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	            http_client_mock.post_json_get_json.call_args[0][0],
114	            "https://push.example.com/_matrix/push/v1/notify",
115	        )
116	        self.assertEqual(
117	            event_id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_pusher_shard.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	            http_client_mock1.post_json_get_json.call_args[0][0],
163	            "https://push.example.com/_matrix/push/v1/notify",
164	        )
165	        self.assertEqual(
166	            event_id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/replication/test_pusher_shard.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
184	            http_client_mock2.post_json_get_json.call_args[0][0],
185	            "https://push.example.com/_matrix/push/v1/notify",
186	        )
187	        self.assertEqual(
188	            event_id,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
50	    def test_version_string(self) -> None:
51	        channel = self.make_request("GET", self.url, shorthand=False)
52	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
76	        """Ensure a piece of media is quarantined when trying to access it."""
77	        channel = self.make_request(
78	            "GET",
79	            f"/_matrix/client/v1/media/download/{server_and_media_id}",
80	            shorthand=False,
81	            access_token=admin_user_tok,
82	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
105	
106	        channel = self.make_request(
107	            "POST",
108	            url.encode("ascii"),
109	            access_token=non_admin_user_tok,
110	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
133	        # Attempt to access the media
134	        channel = self.make_request(
135	            "GET",
136	            f"/_matrix/client/v1/media/download/{server_name_and_media_id}",
137	            shorthand=False,
138	            access_token=non_admin_user_tok,
139	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
148	        )
149	        channel = self.make_request(
150	            "POST",
151	            url,
152	            access_token=admin_user_tok,
153	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
201	
202	        channel = self.make_request(
203	            "POST",
204	            url % urllib.parse.quote(room_id),
205	            access_token=admin_user_tok,
206	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
254	        )
255	        channel = self.make_request(
256	            "POST",
257	            url.encode("ascii"),
258	            access_token=admin_user_tok,
259	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
289	        url = "/_synapse/admin/v1/media/protect/%s" % (urllib.parse.quote(media_id_2),)
290	        channel = self.make_request("POST", url, access_token=admin_user_tok)
291	        self.pump(1.0)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
297	        )
298	        channel = self.make_request(
299	            "POST",
300	            url.encode("ascii"),
301	            access_token=admin_user_tok,
302	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
313	        # Attempt to access each piece of media
314	        channel = self.make_request(
315	            "GET",
316	            f"/_matrix/client/v1/media/download/{server_and_media_id_2}",
317	            shorthand=False,
318	            access_token=non_admin_user_tok,
319	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
357	
358	        channel = self.make_request(
359	            "POST",
360	            self.url,
361	            content={"delete_local_events": True, "purge_up_to_ts": 0},
362	            access_token=self.admin_user_tok,
363	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
369	        # get status
370	        channel = self.make_request(
371	            "GET",
372	            self.url_status + purge_id,
373	            access_token=self.admin_user_tok,
374	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
400	        url = f"{self.url}/{self.other_user}"
401	        channel = self.make_request(
402	            "PUT",
403	            url,
404	            content={
405	                "features": {"msc3881": True},
406	            },
407	            access_token=self.admin_user_tok,
408	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
413	        url = f"{self.url}/{self.other_user}"
414	        channel = self.make_request(
415	            "GET",
416	            url,
417	            access_token=self.admin_user_tok,
418	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
426	        url = f"{self.url}/{self.other_user}"
427	        channel = self.make_request(
428	            "PUT",
429	            url,
430	            content={"features": {"msc3881": False}},
431	            access_token=self.admin_user_tok,
432	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
437	        url = f"{self.url}/{self.other_user}"
438	        channel = self.make_request(
439	            "GET",
440	            url,
441	            access_token=self.admin_user_tok,
442	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
450	        url = f"{self.url}/{self.other_user}"
451	        channel = self.make_request(
452	            "PUT",
453	            url,
454	            content={"features": {"msc3881": False}},
455	            access_token=self.admin_user_tok,
456	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
460	        url = f"{self.url}/f{self.other_user}"
461	        channel = self.make_request(
462	            "PUT",
463	            url,
464	            content={"features": {"msc3881": True}},
465	            access_token=self.other_user_tok,
466	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_admin.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
474	        url = f"{self.url}/{self.other_user}"
475	        channel = self.make_request(
476	            "PUT",
477	            url,
478	            content={"features": {"msc6666": True}},
479	            access_token=self.admin_user_tok,
480	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_jwks.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	                    "enabled": True,
52	                    "issuer": "https://issuer/",
53	                    "client_id": "test-client-id",
54	                    "client_auth_method": "client_secret_post",
55	                    "client_secret": "secret",
56	                },
57	            },
58	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_jwks.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	                    "enabled": True,
72	                    "issuer": "https://issuer/",
73	                    "client_id": "test-client-id",
74	                    "client_auth_method": "private_key_jwt",
75	                    "jwk": {
76	                        "p": "-frVdP_tZ-J_nIR6HNMDq1N7aunwm51nAqNnhqIyuA8ikx7LlQED1tt2LD3YEvYyW8nxE2V95HlCRZXQPMiRJBFOsbmYkzl2t-MpavTaObB_fct_JqcRtdXddg4-_ihdjRDwUOreq_dpWh6MIKsC3UyekfkHmeEJg5YpOTL15j8",
77	                        "kty": "RSA",
78	                        "q": "oFw-Enr_YozQB1ab-kawn4jY3yHi8B1nSmYT0s8oTCflrmps5BFJfCkHL5ij3iY15z0o2m0N-jjB1oSJ98O4RayEEYNQlHnTNTl0kRIWzpoqblHUIxVcahIpP_xTovBJzwi8XXoLGqHOOMA-r40LSyVgP2Ut8D9qBwV6_UfT0LU",
79	                        "d": "WFkDPYo4b4LIS64D_QtQfGGuAObPvc3HFfp9VZXyq3SJR58XZRHE0jqtlEMNHhOTgbMYS3w8nxPQ_qVzY-5hs4fIanwvB64mAoOGl0qMHO65DTD_WsGFwzYClJPBVniavkLE2Hmpu8IGe6lGliN8vREC6_4t69liY-XcN_ECboVtC2behKkLOEASOIMuS7YcKAhTJFJwkl1dqDlliEn5A4u4xy7nuWQz3juB1OFdKlwGA5dfhDNglhoLIwNnkLsUPPFO-WB5ZNEW35xxHOToxj4bShvDuanVA6mJPtTKjz0XibjB36bj_nF_j7EtbE2PdGJ2KevAVgElR4lqS4ISgQ",
80	                        "e": "AQAB",
81	                        "kid": "test",
82	                        "qi": "cPfNk8l8W5exVNNea4d7QZZ8Qr8LgHghypYAxz8PQh1fNa8Ya1SNUDVzC2iHHhszxxA0vB9C7jGze8dBrvnzWYF1XvQcqNIVVgHhD57R1Nm3dj2NoHIKe0Cu4bCUtP8xnZQUN4KX7y4IIcgRcBWG1hT6DEYZ4BxqicnBXXNXAUI",
83	                        "dp": "dKlMHvslV1sMBQaKWpNb3gPq0B13TZhqr3-E2_8sPlvJ3fD8P4CmwwnOn50JDuhY3h9jY5L06sBwXjspYISVv8hX-ndMLkEeF3lrJeA5S70D8rgakfZcPIkffm3tlf1Ok3v5OzoxSv3-67Df4osMniyYwDUBCB5Oq1tTx77xpU8",
84	                        "dq": "S4ooU1xNYYcjl9FcuJEEMqKsRrAXzzSKq6laPTwIp5dDwt2vXeAm1a4eDHXC-6rUSZGt5PbqVqzV4s-cjnJMI8YYkIdjNg4NSE1Ac_YpeDl3M3Colb5CQlU7yUB7xY2bt0NOOFp9UJZYJrOo09mFMGjy5eorsbitoZEbVqS3SuE",
85	                        "n": "nJbYKqFwnURKimaviyDFrNLD3gaKR1JW343Qem25VeZxoMq1665RHVoO8n1oBm4ClZdjIiZiVdpyqzD5-Ow12YQgQEf1ZHP3CCcOQQhU57Rh5XvScTe5IxYVkEW32IW2mp_CJ6WfjYpfeL4azarVk8H3Vr59d1rSrKTVVinVdZer9YLQyC_rWAQNtHafPBMrf6RYiNGV9EiYn72wFIXlLlBYQ9Fx7bfe1PaL6qrQSsZP3_rSpuvVdLh1lqGeCLR0pyclA9uo5m2tMyCXuuGQLbA_QJm5xEc7zd-WFdux2eXF045oxnSZ_kgQt-pdN7AxGWOVvwoTf9am6mSkEdv6iw",
86	                    },
87	                },
88	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	        consent_uri_builder = Mock()
71	        consent_uri_builder.build_user_consent_uri.return_value = "http://example.com"
72	        self.event_creation_handler._consent_uri_builder = consent_uri_builder

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
94	
95	        channel = self.make_request(
96	            "DELETE",
97	            self.url,
98	            {},
99	            access_token=self.other_user_tok,
100	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
110	
111	        channel = self.make_request(
112	            "DELETE",
113	            url,
114	            {},
115	            access_token=self.admin_user_tok,
116	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
125	
126	        channel = self.make_request(
127	            "DELETE",
128	            url,
129	            {},
130	            access_token=self.admin_user_tok,
131	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
143	
144	        channel = self.make_request(
145	            "DELETE",
146	            self.url,
147	            content={"new_room_user_id": "@unknown:test"},
148	            access_token=self.admin_user_tok,
149	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
161	
162	        channel = self.make_request(
163	            "DELETE",
164	            self.url,
165	            content={"new_room_user_id": "@not:exist.bla"},
166	            access_token=self.admin_user_tok,
167	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
179	
180	        channel = self.make_request(
181	            "DELETE",
182	            self.url,
183	            content={"block": "NotBool"},
184	            access_token=self.admin_user_tok,
185	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
194	
195	        channel = self.make_request(
196	            "DELETE",
197	            self.url,
198	            content={"purge": "NotBool"},
199	            access_token=self.admin_user_tok,
200	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
218	
219	        channel = self.make_request(
220	            "DELETE",
221	            self.url.encode("ascii"),
222	            content={"block": True, "purge": True},
223	            access_token=self.admin_user_tok,
224	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
249	
250	        channel = self.make_request(
251	            "DELETE",
252	            self.url.encode("ascii"),
253	            content={"block": False, "purge": True},
254	            access_token=self.admin_user_tok,
255	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
295	
296	        channel = self.make_request(
297	            "DELETE",
298	            self.url.encode("ascii"),
299	            content={"block": False, "purge": True},
300	            access_token=self.admin_user_tok,
301	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
330	
331	        channel = self.make_request(
332	            "DELETE",
333	            self.url.encode("ascii"),
334	            content={"block": True, "purge": False},
335	            access_token=self.admin_user_tok,
336	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
360	        # Request the room be blocked.
361	        channel = self.make_request(
362	            "DELETE",
363	            f"/_synapse/admin/v1/rooms/{room_id}",
364	            {"block": True, "purge": purge},
365	            access_token=self.admin_user_tok,
366	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
402	        # Test that the admin can still send shutdown
403	        channel = self.make_request(
404	            "DELETE",
405	            self.url,
406	            {"new_room_user_id": self.admin_user},
407	            access_token=self.admin_user_tok,
408	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
432	        url = "rooms/%s/state/m.room.history_visibility" % (self.room_id,)
433	        channel = self.make_request(
434	            "PUT",
435	            url.encode("ascii"),
436	            {"history_visibility": "world_readable"},
437	            access_token=self.other_user_tok,
438	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
448	        # Test that the admin can still send shutdown
449	        channel = self.make_request(
450	            "DELETE",
451	            self.url,
452	            {"new_room_user_id": self.admin_user},
453	            access_token=self.admin_user_tok,
454	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
474	        """Test that sending into a deleted room returns a 403"""
475	        channel = self.make_request(
476	            "DELETE",
477	            self.url,
478	            content={},
479	            access_token=self.admin_user_tok,
480	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
523	        url = "rooms/%s/initialSync" % (room_id,)
524	        channel = self.make_request(
525	            "GET", url.encode("ascii"), access_token=self.admin_user_tok
526	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
529	        url = "events?timeout=0&room_id=" + room_id
530	        channel = self.make_request(
531	            "GET", url.encode("ascii"), access_token=self.admin_user_tok
532	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
550	        consent_uri_builder = Mock()
551	        consent_uri_builder.build_user_consent_uri.return_value = "http://example.com"
552	        self.event_creation_handler._consent_uri_builder = consent_uri_builder

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
588	
589	        channel = self.make_request(
590	            method,
591	            url % self.room_id,
592	            content={},
593	            access_token=self.other_user_tok,
594	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
606	        room_id = "!unknown:test"
607	        channel = self.make_request(
608	            "DELETE",
609	            f"/_synapse/admin/v2/rooms/{room_id}",
610	            content={},
611	            access_token=self.admin_user_tok,
612	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
618	        # get status
619	        channel = self.make_request(
620	            "GET",
621	            f"/_synapse/admin/v2/rooms/{room_id}/delete_status",
622	            access_token=self.admin_user_tok,
623	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
640	
641	        channel = self.make_request(
642	            method,
643	            url % "invalidroom",
644	            content={},
645	            access_token=self.admin_user_tok,
646	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
658	
659	        channel = self.make_request(
660	            "DELETE",
661	            self.url,
662	            content={"new_room_user_id": "@unknown:test"},
663	            access_token=self.admin_user_tok,
664	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
676	
677	        channel = self.make_request(
678	            "DELETE",
679	            self.url,
680	            content={"new_room_user_id": "@not:exist.bla"},
681	            access_token=self.admin_user_tok,
682	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
694	
695	        channel = self.make_request(
696	            "DELETE",
697	            self.url,
698	            content={"block": "NotBool"},
699	            access_token=self.admin_user_tok,
700	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
709	
710	        channel = self.make_request(
711	            "DELETE",
712	            self.url,
713	            content={"purge": "NotBool"},
714	            access_token=self.admin_user_tok,
715	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
723	        # first task, do not purge, that we can create a second task
724	        channel = self.make_request(
725	            "DELETE",
726	            self.url.encode("ascii"),
727	            content={"purge": False},
728	            access_token=self.admin_user_tok,
729	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
738	        # second task
739	        channel = self.make_request(
740	            "DELETE",
741	            self.url.encode("ascii"),
742	            content={"purge": True},
743	            access_token=self.admin_user_tok,
744	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
750	        # get status
751	        channel = self.make_request(
752	            "GET",
753	            self.url_status_by_room_id,
754	            access_token=self.admin_user_tok,
755	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
769	
770	        channel = self.make_request(
771	            "GET",
772	            self.url_status_by_room_id,
773	            access_token=self.admin_user_tok,
774	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
783	
784	        channel = self.make_request(
785	            "GET",
786	            self.url_status_by_room_id,
787	            access_token=self.admin_user_tok,
788	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
806	        # and do not wait for finish the task
807	        first_channel = self.make_request(
808	            "DELETE",
809	            self.url.encode("ascii"),
810	            content=body,
811	            access_token=self.admin_user_tok,
812	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
814	        # second call to delete room
815	        second_channel = self.make_request(
816	            "DELETE",
817	            self.url.encode("ascii"),
818	            content=body,
819	            access_token=self.admin_user_tok,
820	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
857	
858	        channel = self.make_request(
859	            "DELETE",
860	            self.url.encode("ascii"),
861	            content={"block": True, "purge": True},
862	            access_token=self.admin_user_tok,
863	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
888	
889	        channel = self.make_request(
890	            "DELETE",
891	            self.url.encode("ascii"),
892	            content={"block": False, "purge": True},
893	            access_token=self.admin_user_tok,
894	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
920	
921	        channel = self.make_request(
922	            "DELETE",
923	            self.url.encode("ascii"),
924	            content={"block": True, "purge": False},
925	            access_token=self.admin_user_tok,
926	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
969	        # Test that the admin can still send shutdown
970	        channel = self.make_request(
971	            "DELETE",
972	            self.url,
973	            content={"new_room_user_id": self.admin_user},
974	            access_token=self.admin_user_tok,
975	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
982	
983	        channel = self.make_request(
984	            "GET",
985	            self.url_status_by_room_id,
986	            access_token=self.admin_user_tok,
987	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1008	        url = "rooms/%s/state/m.room.history_visibility" % (self.room_id,)
1009	        channel = self.make_request(
1010	            "PUT",
1011	            url.encode("ascii"),
1012	            content={"history_visibility": "world_readable"},
1013	            access_token=self.other_user_tok,
1014	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1024	        # Test that the admin can still send shutdown
1025	        channel = self.make_request(
1026	            "DELETE",
1027	            self.url,
1028	            content={"new_room_user_id": self.admin_user},
1029	            access_token=self.admin_user_tok,
1030	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1037	
1038	        channel = self.make_request(
1039	            "GET",
1040	            self.url_status_by_room_id,
1041	            access_token=self.admin_user_tok,
1042	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1148	        # Retrieve delete results
1149	        result = self.make_request(
1150	            "GET",
1151	            self.url_status_by_delete_id + delete_id,
1152	            access_token=self.admin_user_tok,
1153	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1202	        url = f"rooms/{room_id}/initialSync"
1203	        channel = self.make_request(
1204	            "GET", url.encode("ascii"), access_token=self.admin_user_tok
1205	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1208	        url = "events?timeout=0&room_id=" + room_id
1209	        channel = self.make_request(
1210	            "GET", url.encode("ascii"), access_token=self.admin_user_tok
1211	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1229	        # get information by room_id
1230	        channel_room_id = self.make_request(
1231	            "GET",
1232	            self.url_status_by_room_id,
1233	            access_token=self.admin_user_tok,
1234	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1241	        # get information by delete_id
1242	        channel_delete_id = self.make_request(
1243	            "GET",
1244	            self.url_status_by_delete_id + delete_id,
1245	            access_token=self.admin_user_tok,
1246	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1302	        url = "/_synapse/admin/v1/rooms"
1303	        channel = self.make_request(
1304	            "GET",
1305	            url.encode("ascii"),
1306	            access_token=self.admin_user_tok,
1307	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1390	            )
1391	            channel = self.make_request(
1392	                "GET",
1393	                url.encode("ascii"),
1394	                access_token=self.admin_user_tok,
1395	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1430	        url = "/_synapse/admin/v1/rooms?from=%d&limit=%d" % (start, limit)
1431	        channel = self.make_request(
1432	            "GET",
1433	            url.encode("ascii"),
1434	            access_token=self.admin_user_tok,
1435	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1456	        url = "/_matrix/client/r0/directory/room/%s" % (urllib.parse.quote(test_alias),)
1457	        channel = self.make_request(
1458	            "PUT",
1459	            url.encode("ascii"),
1460	            {"room_id": room_id},
1461	            access_token=self.admin_user_tok,
1462	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1489	        url = "/_synapse/admin/v1/rooms"
1490	        channel = self.make_request(
1491	            "GET",
1492	            url.encode("ascii"),
1493	            access_token=self.admin_user_tok,
1494	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1545	                url += "&dir=b"
1546	            channel = self.make_request(
1547	                "GET",
1548	                url.encode("ascii"),
1549	                access_token=self.admin_user_tok,
1550	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1707	            url = "/_synapse/admin/v1/rooms?search_term=%s" % (search_term,)
1708	            channel = self.make_request(
1709	                "GET",
1710	                url.encode("ascii"),
1711	                access_token=self.admin_user_tok,
1712	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1789	        url = "/_synapse/admin/v1/rooms?search_term=%s" % (search_term,)
1790	        channel = self.make_request(
1791	            "GET",
1792	            url.encode("ascii"),
1793	            access_token=self.admin_user_tok,
1794	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1810	
1811	        response = self.make_request(
1812	            "GET",
1813	            "/_synapse/admin/v1/rooms",
1814	            access_token=self.admin_user_tok,
1815	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1819	
1820	        response = self.make_request(
1821	            "GET",
1822	            "/_synapse/admin/v1/rooms?public_rooms=true",
1823	            access_token=self.admin_user_tok,
1824	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1828	
1829	        response = self.make_request(
1830	            "GET",
1831	            "/_synapse/admin/v1/rooms?public_rooms=false",
1832	            access_token=self.admin_user_tok,
1833	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1849	
1850	        response = self.make_request(
1851	            "GET",
1852	            "/_synapse/admin/v1/rooms",
1853	            access_token=self.admin_user_tok,
1854	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1858	
1859	        response = self.make_request(
1860	            "GET",
1861	            "/_synapse/admin/v1/rooms?empty_rooms=false",
1862	            access_token=self.admin_user_tok,
1863	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1867	
1868	        response = self.make_request(
1869	            "GET",
1870	            "/_synapse/admin/v1/rooms?empty_rooms=true",
1871	            access_token=self.admin_user_tok,
1872	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1905	        url = "/_synapse/admin/v1/rooms/%s" % (room_id_1,)
1906	        channel = self.make_request(
1907	            "GET",
1908	            url.encode("ascii"),
1909	            access_token=self.admin_user_tok,
1910	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1941	        url = "/_synapse/admin/v1/rooms/%s" % (room_id_1,)
1942	        channel = self.make_request(
1943	            "GET",
1944	            url.encode("ascii"),
1945	            access_token=self.admin_user_tok,
1946	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1956
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1955	        url = "/_synapse/admin/v1/rooms/%s" % (room_id_1,)
1956	        channel = self.make_request(
1957	            "GET",
1958	            url.encode("ascii"),
1959	            access_token=self.admin_user_tok,
1960	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1967	        url = "/_synapse/admin/v1/rooms/%s" % (room_id_1,)
1968	        channel = self.make_request(
1969	            "GET",
1970	            url.encode("ascii"),
1971	            access_token=self.admin_user_tok,
1972	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:1999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1998	        url = "/_synapse/admin/v1/rooms/%s/members" % (room_id_1,)
1999	        channel = self.make_request(
2000	            "GET",
2001	            url.encode("ascii"),
2002	            access_token=self.admin_user_tok,
2003	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2011	        url = "/_synapse/admin/v1/rooms/%s/members" % (room_id_2,)
2012	        channel = self.make_request(
2013	            "GET",
2014	            url.encode("ascii"),
2015	            access_token=self.admin_user_tok,
2016	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2029	        url = "/_synapse/admin/v1/rooms/%s/state" % (room_id,)
2030	        channel = self.make_request(
2031	            "GET",
2032	            url.encode("ascii"),
2033	            access_token=self.admin_user_tok,
2034	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2044	
2045	        channel = self.make_request(
2046	            "GET",
2047	            f"/_synapse/admin/v1/rooms/{room_id}/state?type=m.room.member",
2048	            access_token=self.admin_user_tok,
2049	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2062
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2061	
2062	        channel = self.make_request(
2063	            "GET",
2064	            f"/_synapse/admin/v1/rooms/{room_id}/state?type=",
2065	            access_token=self.admin_user_tok,
2066	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2077	
2078	        channel = self.make_request(
2079	            "GET",
2080	            f"/_synapse/admin/v1/rooms/{room_id}/state?type=m.room.custom",
2081	            access_token=self.admin_user_tok,
2082	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2092
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2091	        url = "/_matrix/client/r0/directory/room/%s" % (urllib.parse.quote(test_alias),)
2092	        channel = self.make_request(
2093	            "PUT",
2094	            url.encode("ascii"),
2095	            {"room_id": room_id},
2096	            access_token=admin_user_tok,
2097	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2125	        url = f"/_matrix/client/r0/rooms/{room_id}/joined_members"
2126	        channel = self.make_request("GET", url.encode("ascii"), access_token=user_tok)
2127	        self.assertEqual(403, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2153	
2154	        channel = self.make_request(
2155	            "GET",
2156	            "/_synapse/admin/v1/rooms/%s/timestamp_to_event?dir=b&ts=%s"
2157	            % (self.room_id, ts),
2158	            access_token=self.admin_user_tok,
2159	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2166	        token = "t1-0_0_0_0_0_0_0_0_0_0"
2167	        channel = self.make_request(
2168	            "GET",
2169	            "/_synapse/admin/v1/rooms/%s/messages?from=%s" % (self.room_id, token),
2170	            access_token=self.admin_user_tok,
2171	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2180	        token = "s0_0_0_0_0_0_0_0_0_0"
2181	        channel = self.make_request(
2182	            "GET",
2183	            "/_synapse/admin/v1/rooms/%s/messages?from=%s" % (self.room_id, token),
2184	            access_token=self.admin_user_tok,
2185	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2198	        # Check that we get the first and second message when querying /messages.
2199	        channel = self.make_request(
2200	            "GET",
2201	            "/_synapse/admin/v1/rooms/%s/messages?dir=b" % (self.room_id,),
2202	            access_token=self.admin_user_tok,
2203	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2218	        # Check that we get the first and second message when querying /messages.
2219	        channel = self.make_request(
2220	            "GET",
2221	            "/_synapse/admin/v1/rooms/%s/messages?dir=f" % (self.room_id,),
2222	            access_token=self.admin_user_tok,
2223	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2260	        # Check that we get the first and second message when querying /messages.
2261	        channel = self.make_request(
2262	            "GET",
2263	            "/_synapse/admin/v1/rooms/%s/messages?from=%s&dir=b&filter=%s"
2264	            % (
2265	                self.room_id,
2266	                second_token_str,
2267	                json.dumps({"types": [EventTypes.Message]}),
2268	            ),
2269	            access_token=self.admin_user_tok,
2270	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2286	        # has been purged.
2287	        channel = self.make_request(
2288	            "GET",
2289	            "/_synapse/admin/v1/rooms/%s/messages?from=%s&dir=b&filter=%s"
2290	            % (
2291	                self.room_id,
2292	                second_token_str,
2293	                json.dumps({"types": [EventTypes.Message]}),
2294	            ),
2295	            access_token=self.admin_user_tok,
2296	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2304	        # anymore.
2305	        channel = self.make_request(
2306	            "GET",
2307	            "/_synapse/admin/v1/rooms/%s/messages?from=%s&dir=b&filter=%s"
2308	            % (
2309	                self.room_id,
2310	                first_token_str,
2311	                json.dumps({"types": [EventTypes.Message]}),
2312	            ),
2313	            access_token=self.admin_user_tok,
2314	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2325	        valid_filter_str = '{"types": ["m.room.message"]}'
2326	        channel = self.make_request(
2327	            "GET",
2328	            f"/_synapse/admin/v1/rooms/{self.room_id}/messages?dir=b&filter={valid_filter_str}",
2329	            access_token=self.admin_user_tok,
2330	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2335	        invalid_filter_str = "}}}{}"
2336	        channel = self.make_request(
2337	            "GET",
2338	            f"/_synapse/admin/v1/rooms/{self.room_id}/messages?dir=b&filter={invalid_filter_str}",
2339	            access_token=self.admin_user_tok,
2340	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2374	
2375	        channel = self.make_request(
2376	            "POST",
2377	            self.url,
2378	            content={"user_id": self.second_user_id},
2379	            access_token=self.second_tok,
2380	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2389	
2390	        channel = self.make_request(
2391	            "POST",
2392	            self.url,
2393	            content={"unknown_parameter": "@unknown:test"},
2394	            access_token=self.admin_user_tok,
2395	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2404	
2405	        channel = self.make_request(
2406	            "POST",
2407	            self.url,
2408	            content={"user_id": "@unknown:test"},
2409	            access_token=self.admin_user_tok,
2410	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2419	
2420	        channel = self.make_request(
2421	            "POST",
2422	            self.url,
2423	            content={"user_id": "@not:exist.bla"},
2424	            access_token=self.admin_user_tok,
2425	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2438	
2439	        channel = self.make_request(
2440	            "POST",
2441	            url,
2442	            content={"user_id": self.second_user_id},
2443	            access_token=self.admin_user_tok,
2444	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2457	
2458	        channel = self.make_request(
2459	            "POST",
2460	            url,
2461	            content={"user_id": self.second_user_id},
2462	            access_token=self.admin_user_tok,
2463	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2475	
2476	        channel = self.make_request(
2477	            "POST",
2478	            self.url,
2479	            content={"user_id": self.second_user_id},
2480	            access_token=self.admin_user_tok,
2481	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2487	
2488	        channel = self.make_request(
2489	            "GET",
2490	            "/_matrix/client/r0/joined_rooms",
2491	            access_token=self.second_tok,
2492	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2505	
2506	        channel = self.make_request(
2507	            "POST",
2508	            url,
2509	            content={"user_id": self.second_user_id},
2510	            access_token=self.admin_user_tok,
2511	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2535	
2536	        channel = self.make_request(
2537	            "GET",
2538	            "/_matrix/client/r0/joined_rooms",
2539	            access_token=self.admin_user_tok,
2540	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2547	
2548	        channel = self.make_request(
2549	            "POST",
2550	            url,
2551	            content={"user_id": self.second_user_id},
2552	            access_token=self.admin_user_tok,
2553	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2558	
2559	        channel = self.make_request(
2560	            "GET",
2561	            "/_matrix/client/r0/joined_rooms",
2562	            access_token=self.second_tok,
2563	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2576	
2577	        channel = self.make_request(
2578	            "POST",
2579	            url,
2580	            content={"user_id": self.second_user_id},
2581	            access_token=self.admin_user_tok,
2582	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2588	
2589	        channel = self.make_request(
2590	            "GET",
2591	            "/_matrix/client/r0/joined_rooms",
2592	            access_token=self.second_tok,
2593	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2621	        for tok in [user_tok, user_tok_2]:
2622	            channel = self.make_request(
2623	                "GET",
2624	                "/_synapse/admin/v1/rooms/%s/context/%s"
2625	                % (room_id, events[midway]["event_id"]),
2626	                access_token=tok,
2627	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2651	        midway = (len(events) - 1) // 2
2652	        channel = self.make_request(
2653	            "GET",
2654	            "/_synapse/admin/v1/rooms/%s/context/%s"
2655	            % (room_id, events[midway]["event_id"]),
2656	            access_token=self.admin_user_tok,
2657	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2690	        valid_filter_str = '{"types": ["m.room.message"]}'
2691	        channel = self.make_request(
2692	            "GET",
2693	            f"/_synapse/admin/v1/rooms/{room_id}/context/{event_id}?filter={valid_filter_str}",
2694	            access_token=self.admin_user_tok,
2695	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2700	        invalid_filter_str = "}}}{}"
2701	        channel = self.make_request(
2702	            "GET",
2703	            f"/_synapse/admin/v1/rooms/{room_id}/context/{event_id}?filter={invalid_filter_str}",
2704	            access_token=self.admin_user_tok,
2705	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2742	
2743	        channel = self.make_request(
2744	            "POST",
2745	            f"/_synapse/admin/v1/rooms/{room_id}/make_room_admin",
2746	            content={},
2747	            access_token=self.admin_user_tok,
2748	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2769	
2770	        channel = self.make_request(
2771	            "POST",
2772	            f"/_synapse/admin/v1/rooms/{room_id}/make_room_admin",
2773	            content={},
2774	            access_token=self.admin_user_tok,
2775	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2795	
2796	        channel = self.make_request(
2797	            "POST",
2798	            f"/_synapse/admin/v1/rooms/{room_id}/make_room_admin",
2799	            content={"user_id": self.second_user_id},
2800	            access_token=self.admin_user_tok,
2801	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2829	
2830	        channel = self.make_request(
2831	            "POST",
2832	            f"/_synapse/admin/v1/rooms/{room_id}/make_room_admin",
2833	            content={},
2834	            access_token=self.admin_user_tok,
2835	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2873
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2872	
2873	        channel = self.make_request(
2874	            method,
2875	            self.url % self.room_id,
2876	            content={},
2877	            access_token=self.other_user_tok,
2878	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2886	
2887	        channel = self.make_request(
2888	            method,
2889	            self.url % "invalidroom",
2890	            content={},
2891	            access_token=self.admin_user_tok,
2892	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2903	        # `block` is not valid
2904	        channel = self.make_request(
2905	            "PUT",
2906	            self.url % self.room_id,
2907	            content={"block": "NotBool"},
2908	            access_token=self.admin_user_tok,
2909	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2914	        # `block` is not set
2915	        channel = self.make_request(
2916	            "PUT",
2917	            self.url % self.room_id,
2918	            content={},
2919	            access_token=self.admin_user_tok,
2920	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2925	        # no content is send
2926	        channel = self.make_request(
2927	            "PUT",
2928	            self.url % self.room_id,
2929	            access_token=self.admin_user_tok,
2930	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2939	            self._is_blocked(room_id, expect=False)
2940	            channel = self.make_request(
2941	                "PUT",
2942	                self.url % room_id,
2943	                content={"block": True},
2944	                access_token=self.admin_user_tok,
2945	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2963	        for _ in range(2):
2964	            channel = self.make_request(
2965	                "PUT",
2966	                self.url % self.room_id,
2967	                content={"block": True},
2968	                access_token=self.admin_user_tok,
2969	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:2980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2979	
2980	            channel = self.make_request(
2981	                "PUT",
2982	                self.url % room_id,
2983	                content={"block": False},
2984	                access_token=self.admin_user_tok,
2985	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:3004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3003	        for _ in range(2):
3004	            channel = self.make_request(
3005	                "PUT",
3006	                self.url % self.room_id,
3007	                content={"block": False},
3008	                access_token=self.admin_user_tok,
3009	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:3020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3019	
3020	            channel = self.make_request(
3021	                "GET",
3022	                self.url % room_id,
3023	                access_token=self.admin_user_tok,
3024	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_room.py:3044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3043	
3044	            channel = self.make_request(
3045	                "GET",
3046	                self.url % room_id,
3047	                access_token=self.admin_user_tok,
3048	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
100	
101	        channel = self.make_request("POST", self.url, b"{}")
102	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
116	
117	            channel = self.make_request("GET", self.url)
118	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
125	        """
126	        channel = self.make_request("GET", self.url)
127	        nonce = channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
132	        body = {"nonce": nonce}
133	        channel = self.make_request("POST", self.url, body)
134	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
140	
141	        channel = self.make_request("POST", self.url, body)
142	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
149	        """
150	        channel = self.make_request("GET", self.url)
151	        nonce = channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
163	        }
164	        channel = self.make_request("POST", self.url, body)
165	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
173	        """
174	        channel = self.make_request("GET", self.url)
175	        nonce = channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
190	        }
191	        channel = self.make_request("POST", self.url, body)
192	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
199	        """
200	        channel = self.make_request("GET", self.url)
201	        nonce = channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
213	        }
214	        channel = self.make_request("POST", self.url, body)
215	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
219	        # Now, try and reuse it
220	        channel = self.make_request("POST", self.url, body)
221	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
232	        def nonce() -> str:
233	            channel = self.make_request("GET", self.url)
234	            return channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
240	        # Must be an empty body present
241	        channel = self.make_request("POST", self.url, {})
242	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
250	        # Must be present
251	        channel = self.make_request("POST", self.url, {"nonce": nonce()})
252	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
257	        body = {"nonce": nonce(), "username": 1234}
258	        channel = self.make_request("POST", self.url, body)
259	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
264	        body = {"nonce": nonce(), "username": "abcd\u0000"}
265	        channel = self.make_request("POST", self.url, body)
266	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
271	        body = {"nonce": nonce(), "username": "a" * 1000}
272	        channel = self.make_request("POST", self.url, body)
273	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
282	        body = {"nonce": nonce(), "username": "a"}
283	        channel = self.make_request("POST", self.url, body)
284	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
289	        body = {"nonce": nonce(), "username": "a", "password": 1234}
290	        channel = self.make_request("POST", self.url, body)
291	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
296	        body = {"nonce": nonce(), "username": "a", "password": "abcd\u0000"}
297	        channel = self.make_request("POST", self.url, body)
298	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
303	        body = {"nonce": nonce(), "username": "a", "password": "A" * 1000}
304	        channel = self.make_request("POST", self.url, body)
305	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
319	        }
320	        channel = self.make_request("POST", self.url, body)
321	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
330	        # set no displayname
331	        channel = self.make_request("GET", self.url)
332	        nonce = channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
344	
345	        channel = self.make_request("POST", self.url, body)
346	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
349	
350	        channel = self.make_request("GET", "/profile/@bob1:test/displayname")
351	        self.assertEqual(200, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
354	        # displayname is None
355	        channel = self.make_request("GET", self.url)
356	        nonce = channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
368	        }
369	        channel = self.make_request("POST", self.url, body)
370	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
373	
374	        channel = self.make_request("GET", "/profile/@bob2:test/displayname")
375	        self.assertEqual(200, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
378	        # displayname is empty
379	        channel = self.make_request("GET", self.url)
380	        nonce = channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
392	        }
393	        channel = self.make_request("POST", self.url, body)
394	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
397	
398	        channel = self.make_request("GET", "/profile/@bob3:test/displayname")
399	        self.assertEqual(404, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
401	        # set displayname
402	        channel = self.make_request("GET", self.url)
403	        nonce = channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
415	        }
416	        channel = self.make_request("POST", self.url, body)
417	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
420	
421	        channel = self.make_request("GET", "/profile/@bob4:test/displayname")
422	        self.assertEqual(200, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
446	        # Register new user with admin API
447	        channel = self.make_request("GET", self.url)
448	        nonce = channel.json_body["nonce"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
463	        }
464	        channel = self.make_request("POST", self.url, body)
465	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
487	        """
488	        channel = self.make_request("GET", self.url, b"{}")
489	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
499	
500	        channel = self.make_request("GET", self.url, access_token=other_user_token)
501	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
510	
511	        channel = self.make_request(
512	            "GET",
513	            f"{self.url}?deactivated=true",
514	            {},
515	            access_token=self.admin_user_tok,
516	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
544	
545	        channel = self.make_request(
546	            "GET",
547	            self.url,
548	            access_token=self.admin_user_tok,
549	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
569	
570	        channel = self.make_request(
571	            "GET",
572	            self.url + "/" + user1,
573	            access_token=self.admin_user_tok,
574	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
602	            )
603	            channel = self.make_request(
604	                "GET",
605	                url,
606	                access_token=self.admin_user_tok,
607	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
674	        # negative limit
675	        channel = self.make_request(
676	            "GET",
677	            self.url + "?limit=-5",
678	            access_token=self.admin_user_tok,
679	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
684	        # negative from
685	        channel = self.make_request(
686	            "GET",
687	            self.url + "?from=-5",
688	            access_token=self.admin_user_tok,
689	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
694	        # invalid guests
695	        channel = self.make_request(
696	            "GET",
697	            self.url + "?guests=not_bool",
698	            access_token=self.admin_user_tok,
699	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
704	        # invalid deactivated
705	        channel = self.make_request(
706	            "GET",
707	            self.url + "?deactivated=not_bool",
708	            access_token=self.admin_user_tok,
709	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
714	        # invalid approved
715	        channel = self.make_request(
716	            "GET",
717	            self.url + "?approved=not_bool",
718	            access_token=self.admin_user_tok,
719	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
724	        # unknown order_by
725	        channel = self.make_request(
726	            "GET",
727	            self.url + "?order_by=bar",
728	            access_token=self.admin_user_tok,
729	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
734	        # invalid search order
735	        channel = self.make_request(
736	            "GET",
737	            self.url + "?dir=bar",
738	            access_token=self.admin_user_tok,
739	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
752	
753	        channel = self.make_request(
754	            "GET",
755	            self.url + "?limit=5",
756	            access_token=self.admin_user_tok,
757	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
773	
774	        channel = self.make_request(
775	            "GET",
776	            self.url + "?from=5",
777	            access_token=self.admin_user_tok,
778	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
794	
795	        channel = self.make_request(
796	            "GET",
797	            self.url + "?from=5&limit=10",
798	            access_token=self.admin_user_tok,
799	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
817	        # Number of results is the number of entries
818	        channel = self.make_request(
819	            "GET",
820	            self.url + "?limit=20",
821	            access_token=self.admin_user_tok,
822	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
830	        # Number of max results is larger than the number of entries
831	        channel = self.make_request(
832	            "GET",
833	            self.url + "?limit=21",
834	            access_token=self.admin_user_tok,
835	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
843	        # Number of max results is smaller than the number of entries
844	        channel = self.make_request(
845	            "GET",
846	            self.url + "?limit=19",
847	            access_token=self.admin_user_tok,
848	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
857	        #  `next_token` does not appear
858	        channel = self.make_request(
859	            "GET",
860	            self.url + "?from=19",
861	            access_token=self.admin_user_tok,
862	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
963	        # Query all users
964	        channel = self.make_request(
965	            "GET",
966	            f"{self.url}",
967	            access_token=self.admin_user_tok,
968	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:973
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
972	        # Query only admin users
973	        channel = self.make_request(
974	            "GET",
975	            f"{self.url}?admins=true",
976	            access_token=self.admin_user_tok,
977	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
982	        # Query only non admin users
983	        channel = self.make_request(
984	            "GET",
985	            f"{self.url}?admins=false",
986	            access_token=self.admin_user_tok,
987	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1010	        # Query all users
1011	        channel = self.make_request(
1012	            "GET",
1013	            users_url_v3,
1014	            access_token=self.admin_user_tok,
1015	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1020	        # Query deactivated users
1021	        channel = self.make_request(
1022	            "GET",
1023	            f"{users_url_v3}?deactivated=true",
1024	            access_token=self.admin_user_tok,
1025	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1032
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1031	        # Query non-deactivated users
1032	        channel = self.make_request(
1033	            "GET",
1034	            f"{users_url_v3}?deactivated=false",
1035	            access_token=self.admin_user_tok,
1036	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1058
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1057	        # Get the list of users.
1058	        channel = self.make_request(
1059	            "GET",
1060	            self.url,
1061	            access_token=self.admin_user_tok,
1062	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1078	
1079	        channel = self.make_request(
1080	            "PUT",
1081	            f"/_synapse/admin/v2/users/{not_approved_user}",
1082	            {"approved": False},
1083	            access_token=self.admin_user_tok,
1084	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1087	        # Now get the list of users again, this time filtering out approved users.
1088	        channel = self.make_request(
1089	            "GET",
1090	            self.url + "?approved=false",
1091	            access_token=self.admin_user_tok,
1092	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1110	        bot_user_id = self.register_user("robo", "secret")
1111	        self.make_request(
1112	            "PUT",
1113	            "/_synapse/admin/v2/users/" + urllib.parse.quote(bot_user_id),
1114	            {"user_type": UserTypes.BOT},
1115	            access_token=self.admin_user_tok,
1116	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1118	        support_user_id = self.register_user("foo", "secret")
1119	        self.make_request(
1120	            "PUT",
1121	            "/_synapse/admin/v2/users/" + urllib.parse.quote(support_user_id),
1122	            {"user_type": UserTypes.SUPPORT},
1123	            access_token=self.admin_user_tok,
1124	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1142	            test_url = f"{self.url}?{user_type_query}"
1143	            channel = self.make_request(
1144	                "GET",
1145	                test_url,
1146	                access_token=self.admin_user_tok,
1147	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1187	        # They should appear in the list users API, marked as not erased.
1188	        channel = self.make_request(
1189	            "GET",
1190	            f"{self.url}?deactivated=true",
1191	            access_token=self.admin_user_tok,
1192	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1204	        # Repeat the list users query. They should now be marked as erased.
1205	        channel = self.make_request(
1206	            "GET",
1207	            self.url + "?deactivated=true",
1208	            access_token=self.admin_user_tok,
1209	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1220	        # Locked user should appear in list users API
1221	        channel = self.make_request(
1222	            "GET",
1223	            self.url + "?locked=true",
1224	            access_token=self.admin_user_tok,
1225	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1230	        # Locked user should not appear in list users API
1231	        channel = self.make_request(
1232	            "GET",
1233	            self.url + "?locked=false",
1234	            access_token=self.admin_user_tok,
1235	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1258	            url += "dir=%s" % (dir,)
1259	        channel = self.make_request(
1260	            "GET",
1261	            url,
1262	            access_token=self.admin_user_tok,
1263	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1323	        self.other_user_device_display_name = "My Test Device"
1324	        self.other_user_client_ip = "1.2.3.4"
1325	        self.other_user_user_agent = "EquestriaTechnology/123.0"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1338	        # populated in the tests below.
1339	        channel = self.make_request(
1340	            "GET",
1341	            "/_matrix/client/v3/sync",
1342	            access_token=self.other_user_token,
1343	            client_ip=self.other_user_client_ip,
1344	            custom_headers=[
1345	                ("User-Agent", self.other_user_user_agent),
1346	            ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1354	        # Request all devices of "other user"
1355	        channel = self.make_request(
1356	            "GET",
1357	            f"/_synapse/admin/v2/users/{self.other_user_id}/devices",
1358	            access_token=self.admin_user_token,
1359	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1370	        # Request just a single device for "other user" by its ID
1371	        channel = self.make_request(
1372	            "GET",
1373	            f"/_synapse/admin/v2/users/{self.other_user_id}/devices/"
1374	            f"{self.other_user_device_id}",
1375	            access_token=self.admin_user_token,
1376	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1427	        """
1428	        channel = self.make_request("POST", self.url, b"{}")
1429	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1438	
1439	        channel = self.make_request("POST", url, access_token=self.other_user_token)
1440	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1443	
1444	        channel = self.make_request(
1445	            "POST",
1446	            url,
1447	            access_token=self.other_user_token,
1448	            content=b"{}",
1449	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1458	
1459	        channel = self.make_request(
1460	            "POST",
1461	            "/_synapse/admin/v1/deactivate/@unknown_person:test",
1462	            access_token=self.admin_user_tok,
1463	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1472	
1473	        channel = self.make_request(
1474	            "POST",
1475	            self.url,
1476	            content={"erase": "False"},
1477	            access_token=self.admin_user_tok,
1478	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1488	
1489	        channel = self.make_request("POST", url, access_token=self.admin_user_tok)
1490	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1499	        # Get user
1500	        channel = self.make_request(
1501	            "GET",
1502	            self.url_other_user,
1503	            access_token=self.admin_user_tok,
1504	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1514	        # Deactivate and erase user
1515	        channel = self.make_request(
1516	            "POST",
1517	            self.url,
1518	            access_token=self.admin_user_tok,
1519	            content={"erase": True},
1520	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1524	        # Get user
1525	        channel = self.make_request(
1526	            "GET",
1527	            self.url_other_user,
1528	            access_token=self.admin_user_tok,
1529	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1552	        # Check we can still erase them.
1553	        channel = self.make_request(
1554	            "POST",
1555	            self.url,
1556	            access_token=self.admin_user_tok,
1557	            content={"erase": True},
1558	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1567	        # Get user
1568	        channel = self.make_request(
1569	            "GET",
1570	            self.url_other_user,
1571	            access_token=self.admin_user_tok,
1572	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1581	        # Deactivate user
1582	        channel = self.make_request(
1583	            "POST",
1584	            self.url,
1585	            access_token=self.admin_user_tok,
1586	            content={"erase": False},
1587	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1591	        # Get user
1592	        channel = self.make_request(
1593	            "GET",
1594	            self.url_other_user,
1595	            access_token=self.admin_user_tok,
1596	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1621	        # Get user
1622	        channel = self.make_request(
1623	            "GET",
1624	            self.url_other_user,
1625	            access_token=self.admin_user_tok,
1626	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1635	        # Deactivate and erase user
1636	        channel = self.make_request(
1637	            "POST",
1638	            self.url,
1639	            access_token=self.admin_user_tok,
1640	            content={"erase": True},
1641	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1645	        # Get user
1646	        channel = self.make_request(
1647	            "GET",
1648	            self.url_other_user,
1649	            access_token=self.admin_user_tok,
1650	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1716	
1717	        channel = self.make_request(
1718	            "GET",
1719	            url,
1720	            access_token=self.other_user_token,
1721	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1725	
1726	        channel = self.make_request(
1727	            "PUT",
1728	            url,
1729	            access_token=self.other_user_token,
1730	            content=b"{}",
1731	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1740	
1741	        channel = self.make_request(
1742	            "GET",
1743	            self.url_prefix % "@unknown_person:test",
1744	            access_token=self.admin_user_tok,
1745	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1755	        # admin not bool
1756	        channel = self.make_request(
1757	            "PUT",
1758	            self.url_other_user,
1759	            access_token=self.admin_user_tok,
1760	            content={"admin": "not_bool"},
1761	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1765	        # deactivated not bool
1766	        channel = self.make_request(
1767	            "PUT",
1768	            self.url_other_user,
1769	            access_token=self.admin_user_tok,
1770	            content={"deactivated": "not_bool"},
1771	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1775	        # password not str
1776	        channel = self.make_request(
1777	            "PUT",
1778	            self.url_other_user,
1779	            access_token=self.admin_user_tok,
1780	            content={"password": True},
1781	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1785	        # password not length
1786	        channel = self.make_request(
1787	            "PUT",
1788	            self.url_other_user,
1789	            access_token=self.admin_user_tok,
1790	            content={"password": "x" * 513},
1791	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1795	        # user_type not valid
1796	        channel = self.make_request(
1797	            "PUT",
1798	            self.url_other_user,
1799	            access_token=self.admin_user_tok,
1800	            content={"user_type": "new type"},
1801	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1805	        # external_ids not valid
1806	        channel = self.make_request(
1807	            "PUT",
1808	            self.url_other_user,
1809	            access_token=self.admin_user_tok,
1810	            content={
1811	                "external_ids": {"auth_provider": "prov", "wrong_external_id": "id"}
1812	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1816	
1817	        channel = self.make_request(
1818	            "PUT",
1819	            self.url_other_user,
1820	            access_token=self.admin_user_tok,
1821	            content={"external_ids": {"external_id": "id"}},
1822	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1827
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1826	        # threepids not valid
1827	        channel = self.make_request(
1828	            "PUT",
1829	            self.url_other_user,
1830	            access_token=self.admin_user_tok,
1831	            content={"threepids": {"medium": "email", "wrong_address": "id"}},
1832	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1835	
1836	        channel = self.make_request(
1837	            "PUT",
1838	            self.url_other_user,
1839	            access_token=self.admin_user_tok,
1840	            content={"threepids": {"address": "value"}},
1841	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1848	        """
1849	        channel = self.make_request(
1850	            "GET",
1851	            self.url_other_user,
1852	            access_token=self.admin_user_tok,
1853	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1863	        """
1864	        channel = self.make_request(
1865	            "GET",
1866	            self.url_non_ascii_user,
1867	            access_token=self.admin_user_tok,
1868	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1888	
1889	        channel = self.make_request(
1890	            "PUT",
1891	            url,
1892	            access_token=self.admin_user_tok,
1893	            content=body,
1894	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1905	        # Get user
1906	        channel = self.make_request(
1907	            "GET",
1908	            url,
1909	            access_token=self.admin_user_tok,
1910	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1943	
1944	        channel = self.make_request(
1945	            "PUT",
1946	            url,
1947	            access_token=self.admin_user_tok,
1948	            content=body,
1949	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:1969
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1968	        # Get user
1969	        channel = self.make_request(
1970	            "GET",
1971	            url,
1972	            access_token=self.admin_user_tok,
1973	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2000	        # before limit of monthly active users is reached
2001	        channel = self.make_request("GET", "/sync", access_token=self.admin_user_tok)
2002	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2022
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2021	        # Create user
2022	        channel = self.make_request(
2023	            "PUT",
2024	            url,
2025	            access_token=self.admin_user_tok,
2026	            content={"password": "abc123", "admin": False},
2027	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2059
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2058	        # Create user
2059	        channel = self.make_request(
2060	            "PUT",
2061	            url,
2062	            access_token=self.admin_user_tok,
2063	            content={"password": "abc123", "admin": False},
2064	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2095
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2094	
2095	        channel = self.make_request(
2096	            "PUT",
2097	            url,
2098	            access_token=self.admin_user_tok,
2099	            content=body,
2100	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2077	            },
2078	            "public_baseurl": "https://example.com",
2079	        }
2080	    )
2081	    def test_create_user_email_notif_for_new_users(self) -> None:
2082	        """
2083	        Check that a new regular user is created successfully and
2084	        got an email pusher.
2085	        """

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2135	
2136	        channel = self.make_request(
2137	            "PUT",
2138	            url,
2139	            access_token=self.admin_user_tok,
2140	            content=body,
2141	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2119	            },
2120	            "public_baseurl": "https://example.com",
2121	        }
2122	    )
2123	    def test_create_user_email_no_notif_for_new_users(self) -> None:
2124	        """
2125	        Check that a new regular user is created successfully and
2126	        got not an email pusher.
2127	        """

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2175	
2176	        channel = self.make_request(
2177	            "PUT",
2178	            url,
2179	            access_token=self.admin_user_tok,
2180	            content=body,
2181	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2159	            },
2160	            "public_baseurl": "https://example.com",
2161	        }
2162	    )
2163	    def test_create_user_email_notif_for_new_users_with_msisdn_threepid(self) -> None:
2164	        """
2165	        Check that a new regular user is created successfully when they have a msisdn
2166	        threepid and email notif_for_new_users is set to True.
2167	        """

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2193	        # Change password
2194	        channel = self.make_request(
2195	            "PUT",
2196	            self.url_other_user,
2197	            access_token=self.admin_user_tok,
2198	            content={"password": "hahaha"},
2199	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2209	        # Modify user
2210	        channel = self.make_request(
2211	            "PUT",
2212	            self.url_other_user,
2213	            access_token=self.admin_user_tok,
2214	            content={"displayname": "foobar"},
2215	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2221	        # Get user
2222	        channel = self.make_request(
2223	            "GET",
2224	            self.url_other_user,
2225	            access_token=self.admin_user_tok,
2226	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2237	        # Add two threepids to user
2238	        channel = self.make_request(
2239	            "PUT",
2240	            self.url_other_user,
2241	            access_token=self.admin_user_tok,
2242	            content={
2243	                "threepids": [
2244	                    {"medium": "email", "address": "bob1@bob.bob"},
2245	                    {"medium": "email", "address": "bob2@bob.bob"},
2246	                ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2263	        # Set a new and remove a threepid
2264	        channel = self.make_request(
2265	            "PUT",
2266	            self.url_other_user,
2267	            access_token=self.admin_user_tok,
2268	            content={
2269	                "threepids": [
2270	                    {"medium": "email", "address": "bob2@bob.bob"},
2271	                    {"medium": "email", "address": "bob3@bob.bob"},
2272	                ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2285	        # Get user
2286	        channel = self.make_request(
2287	            "GET",
2288	            self.url_other_user,
2289	            access_token=self.admin_user_tok,
2290	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2301	        # Remove threepids
2302	        channel = self.make_request(
2303	            "PUT",
2304	            self.url_other_user,
2305	            access_token=self.admin_user_tok,
2306	            content={"threepids": []},
2307	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2323	        # Add threepid to first user
2324	        channel = self.make_request(
2325	            "PUT",
2326	            url_first_user,
2327	            access_token=self.admin_user_tok,
2328	            content={
2329	                "threepids": [
2330	                    {"medium": "email", "address": "bob1@bob.bob"},
2331	                ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2342	        # Add threepids to other user
2343	        channel = self.make_request(
2344	            "PUT",
2345	            self.url_other_user,
2346	            access_token=self.admin_user_tok,
2347	            content={
2348	                "threepids": [
2349	                    {"medium": "email", "address": "bob2@bob.bob"},
2350	                ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2362	        # one is used by first_user
2363	        channel = self.make_request(
2364	            "PUT",
2365	            self.url_other_user,
2366	            access_token=self.admin_user_tok,
2367	            content={
2368	                "threepids": [
2369	                    {"medium": "email", "address": "bob1@bob.bob"},
2370	                    {"medium": "email", "address": "bob3@bob.bob"},
2371	                ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2389	        # first_user has no threepid anymore
2390	        channel = self.make_request(
2391	            "GET",
2392	            url_first_user,
2393	            access_token=self.admin_user_tok,
2394	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2405	        # Add two external_ids
2406	        channel = self.make_request(
2407	            "PUT",
2408	            self.url_other_user,
2409	            access_token=self.admin_user_tok,
2410	            content={
2411	                "external_ids": [
2412	                    {
2413	                        "external_id": "external_id1",
2414	                        "auth_provider": "auth_provider1",
2415	                    },
2416	                    {
2417	                        "external_id": "external_id2",
2418	                        "auth_provider": "auth_provider2",
2419	                    },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2437	        # Set a new and remove an external_id
2438	        channel = self.make_request(
2439	            "PUT",
2440	            self.url_other_user,
2441	            access_token=self.admin_user_tok,
2442	            content={
2443	                "external_ids": [
2444	                    {
2445	                        "external_id": "external_id2",
2446	                        "auth_provider": "auth_provider2",
2447	                    },
2448	                    {
2449	                        "external_id": "external_id3",
2450	                        "auth_provider": "auth_provider3",
2451	                    },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2468	        # Get user
2469	        channel = self.make_request(
2470	            "GET",
2471	            self.url_other_user,
2472	            access_token=self.admin_user_tok,
2473	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2487	        # Remove external_ids
2488	        channel = self.make_request(
2489	            "PUT",
2490	            self.url_other_user,
2491	            access_token=self.admin_user_tok,
2492	            content={"external_ids": []},
2493	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2508	        # Add an external id to first user
2509	        channel = self.make_request(
2510	            "PUT",
2511	            url_first_user,
2512	            access_token=self.admin_user_tok,
2513	            content={
2514	                "external_ids": [
2515	                    {
2516	                        "external_id": "external_id1",
2517	                        "auth_provider": "auth_provider",
2518	                    },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2534	        # Add an external id to other user
2535	        channel = self.make_request(
2536	            "PUT",
2537	            self.url_other_user,
2538	            access_token=self.admin_user_tok,
2539	            content={
2540	                "external_ids": [
2541	                    {
2542	                        "external_id": "external_id2",
2543	                        "auth_provider": "auth_provider",
2544	                    },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2561	        # one is used by first
2562	        channel = self.make_request(
2563	            "PUT",
2564	            self.url_other_user,
2565	            access_token=self.admin_user_tok,
2566	            content={
2567	                "external_ids": [
2568	                    {
2569	                        "external_id": "external_id1",
2570	                        "auth_provider": "auth_provider",
2571	                    },
2572	                    {
2573	                        "external_id": "external_id3",
2574	                        "auth_provider": "auth_provider",
2575	                    },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2585	        # other user must not changed
2586	        channel = self.make_request(
2587	            "GET",
2588	            self.url_other_user,
2589	            access_token=self.admin_user_tok,
2590	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2603	        # first user must not changed
2604	        channel = self.make_request(
2605	            "GET",
2606	            url_first_user,
2607	            access_token=self.admin_user_tok,
2608	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2636	        # Get user
2637	        channel = self.make_request(
2638	            "GET",
2639	            self.url_other_user,
2640	            access_token=self.admin_user_tok,
2641	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2650	        # Deactivate user
2651	        channel = self.make_request(
2652	            "PUT",
2653	            self.url_other_user,
2654	            access_token=self.admin_user_tok,
2655	            content={"deactivated": True},
2656	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2670	        # Get user
2671	        channel = self.make_request(
2672	            "GET",
2673	            self.url_other_user,
2674	            access_token=self.admin_user_tok,
2675	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2688	        # User can sync
2689	        channel = self.make_request(
2690	            "GET",
2691	            "/_matrix/client/v3/sync",
2692	            access_token=self.other_user_token,
2693	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2696	        # Lock user
2697	        channel = self.make_request(
2698	            "PUT",
2699	            self.url_other_user,
2700	            access_token=self.admin_user_tok,
2701	            content={"locked": True},
2702	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2704	        # User is not authorized to sync anymore
2705	        channel = self.make_request(
2706	            "GET",
2707	            "/_matrix/client/v3/sync",
2708	            access_token=self.other_user_token,
2709	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2716	        # User is available in the user dir
2717	        channel = self.make_request(
2718	            "POST",
2719	            "/_matrix/client/v3/user_directory/search",
2720	            {"search_term": self.other_user},
2721	            access_token=self.admin_user_tok,
2722	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2727	        # Lock user
2728	        channel = self.make_request(
2729	            "PUT",
2730	            self.url_other_user,
2731	            access_token=self.admin_user_tok,
2732	            content={"locked": True},
2733	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2735	        # User is not available anymore in the user dir
2736	        channel = self.make_request(
2737	            "POST",
2738	            "/_matrix/client/v3/user_directory/search",
2739	            {"search_term": self.other_user},
2740	            access_token=self.admin_user_tok,
2741	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2756	        # User is available in the user dir
2757	        channel = self.make_request(
2758	            "POST",
2759	            "/_matrix/client/v3/user_directory/search",
2760	            {"search_term": self.other_user},
2761	            access_token=self.admin_user_tok,
2762	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2767	        # Lock user
2768	        channel = self.make_request(
2769	            "PUT",
2770	            self.url_other_user,
2771	            access_token=self.admin_user_tok,
2772	            content={"locked": True},
2773	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2775	        # User is still available in the user dir
2776	        channel = self.make_request(
2777	            "POST",
2778	            "/_matrix/client/v3/user_directory/search",
2779	            {"search_term": self.other_user},
2780	            access_token=self.admin_user_tok,
2781	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2798	        # Deactivate user
2799	        channel = self.make_request(
2800	            "PUT",
2801	            self.url_other_user,
2802	            access_token=self.admin_user_tok,
2803	            content={"deactivated": True},
2804	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2814	        # Set new displayname user
2815	        channel = self.make_request(
2816	            "PUT",
2817	            self.url_other_user,
2818	            access_token=self.admin_user_tok,
2819	            content={"displayname": "Foobar"},
2820	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2839	        # Reactivate the user with password.
2840	        channel = self.make_request(
2841	            "PUT",
2842	            self.url_other_user,
2843	            access_token=self.admin_user_tok,
2844	            content={"deactivated": False, "password": "foo"},
2845	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2863	        # Reactivate the user without a password.
2864	        channel = self.make_request(
2865	            "PUT",
2866	            self.url_other_user,
2867	            access_token=self.admin_user_tok,
2868	            content={"deactivated": False},
2869	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2887	        # Reactivate the user with a password.
2888	        channel = self.make_request(
2889	            "PUT",
2890	            self.url_other_user,
2891	            access_token=self.admin_user_tok,
2892	            content={"deactivated": False, "password": "foo"},
2893	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2898
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2897	        # Reactivate the user without a password.
2898	        channel = self.make_request(
2899	            "PUT",
2900	            self.url_other_user,
2901	            access_token=self.admin_user_tok,
2902	            content={"deactivated": False},
2903	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2921	        # Reactivate the user with a password.
2922	        channel = self.make_request(
2923	            "PUT",
2924	            self.url_other_user,
2925	            access_token=self.admin_user_tok,
2926	            content={"deactivated": False, "password": "foo"},
2927	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2932
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2931	        # Reactivate the user without a password.
2932	        channel = self.make_request(
2933	            "PUT",
2934	            self.url_other_user,
2935	            access_token=self.admin_user_tok,
2936	            content={"deactivated": False},
2937	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2951	        # Set a user as an admin
2952	        channel = self.make_request(
2953	            "PUT",
2954	            self.url_other_user,
2955	            access_token=self.admin_user_tok,
2956	            content={"admin": True},
2957	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2963	        # Get user
2964	        channel = self.make_request(
2965	            "GET",
2966	            self.url_other_user,
2967	            access_token=self.admin_user_tok,
2968	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2979	        # Set to support type
2980	        channel = self.make_request(
2981	            "PUT",
2982	            self.url_other_user,
2983	            access_token=self.admin_user_tok,
2984	            content={"user_type": UserTypes.SUPPORT},
2985	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:2992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2991	        # Get user
2992	        channel = self.make_request(
2993	            "GET",
2994	            self.url_other_user,
2995	            access_token=self.admin_user_tok,
2996	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3002	        # Change back to a regular user
3003	        channel = self.make_request(
3004	            "PUT",
3005	            self.url_other_user,
3006	            access_token=self.admin_user_tok,
3007	            content={"user_type": None},
3008	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3014	        # Get user
3015	        channel = self.make_request(
3016	            "GET",
3017	            self.url_other_user,
3018	            access_token=self.admin_user_tok,
3019	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3033
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3032	        # Create user
3033	        channel = self.make_request(
3034	            "PUT",
3035	            url,
3036	            access_token=self.admin_user_tok,
3037	            content={"password": "abc123"},
3038	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3044	        # Get user
3045	        channel = self.make_request(
3046	            "GET",
3047	            url,
3048	            access_token=self.admin_user_tok,
3049	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3057
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3056	        # Change password (and use a str for deactivate instead of a bool)
3057	        channel = self.make_request(
3058	            "PUT",
3059	            url,
3060	            access_token=self.admin_user_tok,
3061	            content={"password": "abc123", "deactivated": "false"},
3062	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3067
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3066	        # Check user is not deactivated
3067	        channel = self.make_request(
3068	            "GET",
3069	            url,
3070	            access_token=self.admin_user_tok,
3071	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3096
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3095	        # marked as approved automatically.
3096	        channel = self.make_request(
3097	            "POST",
3098	            "register",
3099	            {
3100	                "username": "bob",
3101	                "password": "test",
3102	                "auth": {"type": LoginType.DUMMY},
3103	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3111	        # Get user
3112	        channel = self.make_request(
3113	            "GET",
3114	            url,
3115	            access_token=self.admin_user_tok,
3116	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3121	        # Approve user
3122	        channel = self.make_request(
3123	            "PUT",
3124	            url,
3125	            access_token=self.admin_user_tok,
3126	            content={"approved": True},
3127	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3132	        # Check that the user is now approved
3133	        channel = self.make_request(
3134	            "GET",
3135	            url,
3136	            access_token=self.admin_user_tok,
3137	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3155	        # Create user
3156	        channel = self.make_request(
3157	            "PUT",
3158	            url,
3159	            access_token=self.admin_user_tok,
3160	            content={"password": "abc123", "approved": True},
3161	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3167	        # Get user
3168	        channel = self.make_request(
3169	            "GET",
3170	            url,
3171	            access_token=self.admin_user_tok,
3172	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3189	        # Deactivate the user.
3190	        channel = self.make_request(
3191	            "PUT",
3192	            self.url_prefix % urllib.parse.quote(user_id),
3193	            access_token=self.admin_user_tok,
3194	            content={"deactivated": True},
3195	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3251	        """
3252	        channel = self.make_request("GET", self.url, b"{}")
3253	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3262	
3263	        channel = self.make_request(
3264	            "GET",
3265	            self.url,
3266	            access_token=other_user_token,
3267	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3276	        url = "/_synapse/admin/v1/users/@unknown_person:test/joined_rooms"
3277	        channel = self.make_request(
3278	            "GET",
3279	            url,
3280	            access_token=self.admin_user_tok,
3281	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3292	
3293	        channel = self.make_request(
3294	            "GET",
3295	            url,
3296	            access_token=self.admin_user_tok,
3297	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3308	        # Get rooms
3309	        channel = self.make_request(
3310	            "GET",
3311	            self.url,
3312	            access_token=self.admin_user_tok,
3313	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3329	        # Get rooms
3330	        channel = self.make_request(
3331	            "GET",
3332	            self.url,
3333	            access_token=self.admin_user_tok,
3334	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3379	        url = "/_synapse/admin/v1/users/@joiner:remote_hs/joined_rooms"
3380	        channel = self.make_request(
3381	            "GET",
3382	            url,
3383	            access_token=self.admin_user_tok,
3384	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3411	        """
3412	        channel = self.make_request("GET", self.url, b"{}")
3413	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3422	
3423	        channel = self.make_request(
3424	            "GET",
3425	            self.url,
3426	            access_token=other_user_token,
3427	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3436	        url = "/_synapse/admin/v1/users/@unknown_person:test/pushers"
3437	        channel = self.make_request(
3438	            "GET",
3439	            url,
3440	            access_token=self.admin_user_tok,
3441	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3451	
3452	        channel = self.make_request(
3453	            "GET",
3454	            url,
3455	            access_token=self.admin_user_tok,
3456	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3466	        # Get pushers
3467	        channel = self.make_request(
3468	            "GET",
3469	            self.url,
3470	            access_token=self.admin_user_tok,
3471	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3493	                lang=None,
3494	                data={"url": "https://example.com/_matrix/push/v1/notify"},
3495	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3498	        # Get pushers
3499	        channel = self.make_request(
3500	            "GET",
3501	            self.url,
3502	            access_token=self.admin_user_tok,
3503	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3545	        """Try to list media of an user without authentication."""
3546	        channel = self.make_request(method, self.url, {})
3547	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3555	
3556	        channel = self.make_request(
3557	            method,
3558	            self.url,
3559	            access_token=other_user_token,
3560	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3568	        url = "/_synapse/admin/v1/users/@unknown_person:test/media"
3569	        channel = self.make_request(
3570	            method,
3571	            url,
3572	            access_token=self.admin_user_tok,
3573	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3582	
3583	        channel = self.make_request(
3584	            method,
3585	            url,
3586	            access_token=self.admin_user_tok,
3587	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3598	
3599	        channel = self.make_request(
3600	            "GET",
3601	            self.url + "?limit=5",
3602	            access_token=self.admin_user_tok,
3603	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3617	
3618	        channel = self.make_request(
3619	            "DELETE",
3620	            self.url + "?limit=5",
3621	            access_token=self.admin_user_tok,
3622	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3634	
3635	        channel = self.make_request(
3636	            "GET",
3637	            self.url + "?from=5",
3638	            access_token=self.admin_user_tok,
3639	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3653	
3654	        channel = self.make_request(
3655	            "DELETE",
3656	            self.url + "?from=5",
3657	            access_token=self.admin_user_tok,
3658	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3670	
3671	        channel = self.make_request(
3672	            "GET",
3673	            self.url + "?from=5&limit=10",
3674	            access_token=self.admin_user_tok,
3675	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3689	
3690	        channel = self.make_request(
3691	            "DELETE",
3692	            self.url + "?from=5&limit=10",
3693	            access_token=self.admin_user_tok,
3694	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3703	        # unknown order_by
3704	        channel = self.make_request(
3705	            method,
3706	            self.url + "?order_by=bar",
3707	            access_token=self.admin_user_tok,
3708	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3713	        # invalid search order
3714	        channel = self.make_request(
3715	            method,
3716	            self.url + "?dir=bar",
3717	            access_token=self.admin_user_tok,
3718	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3723	        # negative limit
3724	        channel = self.make_request(
3725	            method,
3726	            self.url + "?limit=-5",
3727	            access_token=self.admin_user_tok,
3728	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3733	        # negative from
3734	        channel = self.make_request(
3735	            method,
3736	            self.url + "?from=-5",
3737	            access_token=self.admin_user_tok,
3738	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3756	        # Number of results is the number of entries
3757	        channel = self.make_request(
3758	            "GET",
3759	            self.url + "?limit=20",
3760	            access_token=self.admin_user_tok,
3761	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3769	        # Number of max results is larger than the number of entries
3770	        channel = self.make_request(
3771	            "GET",
3772	            self.url + "?limit=21",
3773	            access_token=self.admin_user_tok,
3774	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3782	        # Number of max results is smaller than the number of entries
3783	        channel = self.make_request(
3784	            "GET",
3785	            self.url + "?limit=19",
3786	            access_token=self.admin_user_tok,
3787	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3796	        #  `next_token` does not appear
3797	        channel = self.make_request(
3798	            "GET",
3799	            self.url + "?from=19",
3800	            access_token=self.admin_user_tok,
3801	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3813	
3814	        channel = self.make_request(
3815	            "GET",
3816	            self.url,
3817	            access_token=self.admin_user_tok,
3818	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3828	
3829	        channel = self.make_request(
3830	            "DELETE",
3831	            self.url,
3832	            access_token=self.admin_user_tok,
3833	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3845	
3846	        channel = self.make_request(
3847	            "GET",
3848	            self.url,
3849	            access_token=self.admin_user_tok,
3850	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:3872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3871	
3872	        channel = self.make_request(
3873	            "DELETE",
3874	            self.url,
3875	            access_token=self.admin_user_tok,
3876	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4027	        # Try to access a media and to create `last_access_ts`
4028	        channel = self.make_request(
4029	            "GET",
4030	            f"/_matrix/client/v1/media/download/{server_and_media_id}",
4031	            shorthand=False,
4032	            access_token=user_token,
4033	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4079	            url += f"dir={dir}"
4080	        channel = self.make_request(
4081	            "GET",
4082	            url,
4083	            access_token=self.admin_user_tok,
4084	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4117	    def _get_token(self) -> str:
4118	        channel = self.make_request(
4119	            "POST", self.url, b"{}", access_token=self.admin_user_tok
4120	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4125	        """Try to login as a user without authentication."""
4126	        channel = self.make_request("POST", self.url, b"{}")
4127	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4132	        """Try to login as a user as a non-admin user."""
4133	        channel = self.make_request(
4134	            "POST", self.url, b"{}", access_token=self.other_user_tok
4135	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4158	        # Check that we don't see a new device in our devices list
4159	        channel = self.make_request(
4160	            "GET", "devices", b"{}", access_token=self.other_user_tok
4161	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4172	        # Test that we can successfully make a request
4173	        channel = self.make_request("GET", "devices", b"{}", access_token=puppet_token)
4174	        self.assertEqual(200, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4176	        # Logout with the puppet token
4177	        channel = self.make_request("POST", "logout", b"{}", access_token=puppet_token)
4178	        self.assertEqual(200, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4180	        # The puppet token should no longer work
4181	        channel = self.make_request("GET", "devices", b"{}", access_token=puppet_token)
4182	        self.assertEqual(401, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4184	        # .. but the real user's tokens should still work
4185	        channel = self.make_request(
4186	            "GET", "devices", b"{}", access_token=self.other_user_tok
4187	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4197	        # Test that we can successfully make a request
4198	        channel = self.make_request("GET", "devices", b"{}", access_token=puppet_token)
4199	        self.assertEqual(200, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4201	        # Logout all with the real user token
4202	        channel = self.make_request(
4203	            "POST", "logout/all", b"{}", access_token=self.other_user_tok
4204	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4207	        # The puppet token should still work
4208	        channel = self.make_request("GET", "devices", b"{}", access_token=puppet_token)
4209	        self.assertEqual(200, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4211	        # .. but the real user's tokens shouldn't
4212	        channel = self.make_request(
4213	            "GET", "devices", b"{}", access_token=self.other_user_tok
4214	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4224	        # Test that we can successfully make a request
4225	        channel = self.make_request("GET", "devices", b"{}", access_token=puppet_token)
4226	        self.assertEqual(200, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4228	        # Logout all with the admin user token
4229	        channel = self.make_request(
4230	            "POST", "logout/all", b"{}", access_token=self.admin_user_tok
4231	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4234	        # The puppet token should no longer work
4235	        channel = self.make_request("GET", "devices", b"{}", access_token=puppet_token)
4236	        self.assertEqual(401, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4238	        # .. but the real user's tokens should still work
4239	        channel = self.make_request(
4240	            "GET", "devices", b"{}", access_token=self.other_user_tok
4241	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4245	        {
4246	            "public_baseurl": "https://example.org/",
4247	            "user_consent": {
4248	                "version": "1.0",
4249	                "policy_name": "My Cool Privacy Policy",
4250	                "template_dir": "/",
4251	                "require_at_registration": True,
4252	                "block_events_error": "You should accept the policy",
4253	            },
4254	            "form_secret": "123secret",
4255	        }
4256	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4326	        """
4327	        channel = self.make_request("GET", self.url, b"{}")
4328	        self.assertEqual(401, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4337	
4338	        channel = self.make_request(
4339	            "GET",
4340	            self.url,
4341	            access_token=other_user2_token,
4342	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4351	
4352	        channel = self.make_request(
4353	            "GET",
4354	            url,
4355	            access_token=self.admin_user_tok,
4356	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4363	        """
4364	        channel = self.make_request(
4365	            "GET",
4366	            self.url,
4367	            access_token=self.admin_user_tok,
4368	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4378	
4379	        channel = self.make_request(
4380	            "GET",
4381	            self.url,
4382	            access_token=other_user_token,
4383	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4411	        """
4412	        channel = self.make_request(method, self.url)
4413	        self.assertEqual(401, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4422	
4423	        channel = self.make_request(method, self.url, access_token=other_user_token)
4424	        self.assertEqual(403, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4433	
4434	        channel = self.make_request(method, url, access_token=self.admin_user_tok)
4435	        self.assertEqual(400, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4446	
4447	        channel = self.make_request("POST", self.url, access_token=self.admin_user_tok)
4448	        self.assertEqual(200, channel.code, msg=channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4456	        # Un-shadow-ban the user.
4457	        channel = self.make_request(
4458	            "DELETE", self.url, access_token=self.admin_user_tok
4459	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4491	        """
4492	        channel = self.make_request(method, self.url, b"{}")
4493	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4503	
4504	        channel = self.make_request(
4505	            method,
4506	            self.url,
4507	            access_token=other_user_token,
4508	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4519	
4520	        channel = self.make_request(
4521	            method,
4522	            url,
4523	            access_token=self.admin_user_tok,
4524	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4543	
4544	        channel = self.make_request(
4545	            method,
4546	            url,
4547	            access_token=self.admin_user_tok,
4548	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4557	        # messages_per_second is a string
4558	        channel = self.make_request(
4559	            "POST",
4560	            self.url,
4561	            access_token=self.admin_user_tok,
4562	            content={"messages_per_second": "string"},
4563	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4568	        # messages_per_second is negative
4569	        channel = self.make_request(
4570	            "POST",
4571	            self.url,
4572	            access_token=self.admin_user_tok,
4573	            content={"messages_per_second": -1},
4574	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4579	        # burst_count is a string
4580	        channel = self.make_request(
4581	            "POST",
4582	            self.url,
4583	            access_token=self.admin_user_tok,
4584	            content={"burst_count": "string"},
4585	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4590	        # burst_count is negative
4591	        channel = self.make_request(
4592	            "POST",
4593	            self.url,
4594	            access_token=self.admin_user_tok,
4595	            content={"burst_count": -1},
4596	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4617	        # request status
4618	        channel = self.make_request(
4619	            "GET",
4620	            self.url,
4621	            access_token=self.admin_user_tok,
4622	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4631	        # request status
4632	        channel = self.make_request(
4633	            "GET",
4634	            self.url,
4635	            access_token=self.admin_user_tok,
4636	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4641	        # set ratelimit
4642	        channel = self.make_request(
4643	            "POST",
4644	            self.url,
4645	            access_token=self.admin_user_tok,
4646	            content={"messages_per_second": 10, "burst_count": 11},
4647	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4652	        # update ratelimit
4653	        channel = self.make_request(
4654	            "POST",
4655	            self.url,
4656	            access_token=self.admin_user_tok,
4657	            content={"messages_per_second": 20, "burst_count": 21},
4658	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4663	        # request status
4664	        channel = self.make_request(
4665	            "GET",
4666	            self.url,
4667	            access_token=self.admin_user_tok,
4668	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4673	        # delete ratelimit
4674	        channel = self.make_request(
4675	            "DELETE",
4676	            self.url,
4677	            access_token=self.admin_user_tok,
4678	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4683	        # request status
4684	        channel = self.make_request(
4685	            "GET",
4686	            self.url,
4687	            access_token=self.admin_user_tok,
4688	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4710	        """Try to get information of a user without authentication."""
4711	        channel = self.make_request("GET", self.url, {})
4712	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4719	
4720	        channel = self.make_request(
4721	            "GET",
4722	            self.url,
4723	            access_token=other_user_token,
4724	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4732	
4733	        channel = self.make_request(
4734	            "GET",
4735	            url,
4736	            access_token=self.admin_user_tok,
4737	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4745	
4746	        channel = self.make_request(
4747	            "GET",
4748	            url,
4749	            access_token=self.admin_user_tok,
4750	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4767	
4768	        channel = self.make_request(
4769	            "GET",
4770	            self.url,
4771	            access_token=self.admin_user_tok,
4772	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4812	
4813	        channel = self.make_request(
4814	            "GET",
4815	            url,
4816	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4824	
4825	        channel = self.make_request(
4826	            "GET",
4827	            url,
4828	            access_token=self.admin_user_tok,
4829	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4839	
4840	        channel = self.make_request(
4841	            "GET",
4842	            url,
4843	            access_token=self.admin_user_tok,
4844	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4856
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4855	
4856	        channel = self.make_request(
4857	            "GET",
4858	            url,
4859	            access_token=self.admin_user_tok,
4860	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4895
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4894	
4895	        channel = self.make_request(
4896	            "GET",
4897	            url,
4898	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4908	
4909	        channel = self.make_request(
4910	            "GET",
4911	            url,
4912	            access_token=self.admin_user_tok,
4913	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4920	
4921	        channel = self.make_request(
4922	            "GET",
4923	            url,
4924	            access_token=self.admin_user_tok,
4925	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4934	
4935	        channel = self.make_request(
4936	            "GET",
4937	            url,
4938	            access_token=self.admin_user_tok,
4939	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4950
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4949	
4950	        channel = self.make_request(
4951	            "GET",
4952	            url,
4953	            access_token=self.admin_user_tok,
4954	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4985	        fake_user = "@bums:other"
4986	        channel = self.make_request(
4987	            "POST", self.url(fake_user), access_token=self.admin_user_tok
4988	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:4992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4991	
4992	        channel = self.make_request(
4993	            "POST", self.url(self.other_user), access_token=self.admin_user_tok
4994	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5004	
5005	        channel = self.make_request(
5006	            "POST", self.url(self.other_user), access_token=self.admin_user_tok
5007	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5037
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5036	        # test that suspending user works
5037	        channel = self.make_request(
5038	            "PUT",
5039	            f"/_synapse/admin/v1/suspend/{self.bad_user}",
5040	            {"suspend": True},
5041	            access_token=self.admin_tok,
5042	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5049	        # test that un-suspending user works
5050	        channel2 = self.make_request(
5051	            "PUT",
5052	            f"/_synapse/admin/v1/suspend/{self.bad_user}",
5053	            {"suspend": False},
5054	            access_token=self.admin_tok,
5055	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5063
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5062	        # test that trying to un-suspend user who isn't suspended doesn't cause problems
5063	        channel3 = self.make_request(
5064	            "PUT",
5065	            f"/_synapse/admin/v1/suspend/{self.bad_user}",
5066	            {"suspend": False},
5067	            access_token=self.admin_tok,
5068	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5075	        # test that trying to suspend user who is already suspended doesn't cause problems
5076	        channel4 = self.make_request(
5077	            "PUT",
5078	            f"/_synapse/admin/v1/suspend/{self.bad_user}",
5079	            {"suspend": True},
5080	            access_token=self.admin_tok,
5081	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5087	
5088	        channel5 = self.make_request(
5089	            "PUT",
5090	            f"/_synapse/admin/v1/suspend/{self.bad_user}",
5091	            {"suspend": True},
5092	            access_token=self.admin_tok,
5093	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5147	        # redact all events in all rooms
5148	        channel = self.make_request(
5149	            "POST",
5150	            f"/_synapse/admin/v1/user/{self.bad_user}/redact",
5151	            content={"rooms": []},
5152	            access_token=self.admin_tok,
5153	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5158	            filter = json.dumps({"types": [EventTypes.Redaction]})
5159	            channel = self.make_request(
5160	                "GET",
5161	                f"rooms/{rm}/messages?filter={filter}&limit=50",
5162	                access_token=self.admin_tok,
5163	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5191	        # redact messages in rooms 1 and 3
5192	        channel = self.make_request(
5193	            "POST",
5194	            f"/_synapse/admin/v1/user/{self.bad_user}/redact",
5195	            content={"rooms": [self.rm1, self.rm3]},
5196	            access_token=self.admin_tok,
5197	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5202	            filter = json.dumps({"types": [EventTypes.Redaction]})
5203	            channel = self.make_request(
5204	                "GET",
5205	                f"rooms/{rm}/messages?filter={filter}&limit=50",
5206	                access_token=self.admin_tok,
5207	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5220	
5221	        channel = self.make_request(
5222	            "GET", f"rooms/{self.rm2}/messages?limit=50", access_token=self.admin_tok
5223	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5245	        # redact messages in rooms 1 and 3
5246	        channel = self.make_request(
5247	            "POST",
5248	            f"/_synapse/admin/v1/user/{self.bad_user}/redact",
5249	            content={"rooms": [self.rm1, self.rm3]},
5250	            access_token=self.admin_tok,
5251	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5254	
5255	        channel2 = self.make_request(
5256	            "GET",
5257	            f"/_synapse/admin/v1/user/redact_status/{id}",
5258	            access_token=self.admin_tok,
5259	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5269	
5270	        channel3 = self.make_request(
5271	            "POST",
5272	            f"/_synapse/admin/v1/user/{self.bad_user}/redact",
5273	            content={"rooms": [self.rm2]},
5274	            access_token=self.admin_tok,
5275	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5278	
5279	        channel4 = self.make_request(
5280	            "GET",
5281	            f"/_synapse/admin/v1/user/redact_status/{id}",
5282	            access_token=self.admin_tok,
5283	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5314	        for r in [self.rm1, self.rm3]:
5315	            channel = self.make_request(
5316	                "POST",
5317	                f"/_matrix/client/r0/rooms/{r}/kick",
5318	                content={"reason": "being a bummer", "user_id": self.bad_user},
5319	                access_token=self.admin_tok,
5320	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5323	        # redact messages in room 1 and 3
5324	        channel1 = self.make_request(
5325	            "POST",
5326	            f"/_synapse/admin/v1/user/{self.bad_user}/redact",
5327	            content={"rooms": [self.rm1, self.rm3]},
5328	            access_token=self.admin_tok,
5329	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5333	        # check that there were no failed redactions in room 1 and 3
5334	        channel2 = self.make_request(
5335	            "GET",
5336	            f"/_synapse/admin/v1/user/redact_status/{id}",
5337	            access_token=self.admin_tok,
5338	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5346	            filter = json.dumps({"types": [EventTypes.Redaction]})
5347	            channel3 = self.make_request(
5348	                "GET",
5349	                f"rooms/{rm}/messages?filter={filter}&limit=50",
5350	                access_token=self.admin_tok,
5351	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5365	        # ban user from room 2
5366	        channel4 = self.make_request(
5367	            "POST",
5368	            f"/_matrix/client/r0/rooms/{self.rm2}/ban",
5369	            content={"reason": "being a bummer", "user_id": self.bad_user},
5370	            access_token=self.admin_tok,
5371	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5374	        # make a request to ban all user's messages
5375	        channel5 = self.make_request(
5376	            "POST",
5377	            f"/_synapse/admin/v1/user/{self.bad_user}/redact",
5378	            content={"rooms": []},
5379	            access_token=self.admin_tok,
5380	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5384	        # check that there were no failed redactions in room 2
5385	        channel6 = self.make_request(
5386	            "GET",
5387	            f"/_synapse/admin/v1/user/redact_status/{id2}",
5388	            access_token=self.admin_tok,
5389	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5396	        filter = json.dumps({"types": [EventTypes.Redaction]})
5397	        channel7 = self.make_request(
5398	            "GET",
5399	            f"rooms/{self.rm2}/messages?filter={filter}&limit=50",
5400	            access_token=self.admin_tok,
5401	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5433	        # the server admin created this room and has admin privilege in room
5434	        channel = self.make_request(
5435	            "POST",
5436	            "/_synapse/admin/v1/user/@remote:remote_server/redact",
5437	            content={"rooms": [self.rm1]},
5438	            access_token=self.admin_tok,
5439	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5443	        # check that there were no failed redactions
5444	        channel = self.make_request(
5445	            "GET",
5446	            f"/_synapse/admin/v1/user/redact_status/{id}",
5447	            access_token=self.admin_tok,
5448	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5454	        filter = json.dumps({"types": [EventTypes.Redaction]})
5455	        channel = self.make_request(
5456	            "GET",
5457	            f"rooms/{self.rm1}/messages?filter={filter}&limit=50",
5458	            access_token=self.admin_tok,
5459	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5523	        # redact all events in all rooms
5524	        channel = self.make_request(
5525	            "POST",
5526	            f"/_synapse/admin/v1/user/{self.bad_user}/redact",
5527	            content={"rooms": []},
5528	            access_token=self.admin_tok,
5529	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5539	
5540	            channel2 = self.make_request(
5541	                "GET",
5542	                f"/_synapse/admin/v1/user/redact_status/{id}",
5543	                access_token=self.admin_tok,
5544	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5551	            filter = json.dumps({"types": [EventTypes.Redaction]})
5552	            channel = self.make_request(
5553	                "GET",
5554	                f"rooms/{rm}/messages?filter={filter}&limit=50",
5555	                access_token=self.admin_tok,
5556	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5604	        # fetch using timestamp, all should be returned
5605	        channel = self.make_request(
5606	            "GET",
5607	            f"/_synapse/admin/v1/users/{self.bad_user}/sent_invite_count?from_ts={before_invites_sent_ts}",
5608	            access_token=self.admin_tok,
5609	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5618	
5619	        channel = self.make_request(
5620	            "GET",
5621	            f"/_synapse/admin/v1/users/{self.bad_user}/sent_invite_count?from_ts={before_invites_sent_ts}",
5622	            access_token=self.admin_tok,
5623	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5639	        # fetch invites with timestamp, none should be returned
5640	        channel = self.make_request(
5641	            "GET",
5642	            f"/_synapse/admin/v1/users/{self.bad_user}/sent_invite_count?from_ts={after_invites_sent_ts}",
5643	            access_token=self.admin_tok,
5644	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5667	        # fetch using timestamp, all invites sent should be counted
5668	        channel = self.make_request(
5669	            "GET",
5670	            f"/_synapse/admin/v1/users/{self.bad_user}/sent_invite_count?from_ts={before_invites_sent_ts}",
5671	            access_token=self.admin_tok,
5672	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5681	
5682	        channel = self.make_request(
5683	            "POST",
5684	            f"/_matrix/client/v3/rooms/{self.room1}/kick",
5685	            content={"user_id": to_kick_user_id},
5686	            access_token=self.bad_user_tok,
5687	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5689	
5690	        channel = self.make_request(
5691	            "GET",
5692	            f"/_synapse/admin/v1/users/{self.bad_user}/sent_invite_count?from_ts={before_invites_sent_ts}",
5693	            access_token=self.admin_tok,
5694	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5733	        # before provided timestamp
5734	        channel = self.make_request(
5735	            "GET",
5736	            f"/_synapse/admin/v1/users/{self.bad_user}/cumulative_joined_room_count?from_ts={int(after_room_creation)}",
5737	            access_token=self.admin_tok,
5738	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5743	        # return the rooms
5744	        channel = self.make_request(
5745	            "GET",
5746	            f"/_synapse/admin/v1/users/{self.bad_user}/cumulative_joined_room_count?from_ts={int(before_room_creation_timestamp)}",
5747	            access_token=self.admin_tok,
5748	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5770	        # fetch rooms with the older timestamp before they were created and joined
5771	        channel = self.make_request(
5772	            "GET",
5773	            f"/_synapse/admin/v1/users/{self.bad_user}/cumulative_joined_room_count?from_ts={int(before_room_creation_timestamp)}",
5774	            access_token=self.admin_tok,
5775	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/admin/test_user.py:5806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5805	        # fetch the joined room count again, the number should remain the same as the collected joined rooms
5806	        channel = self.make_request(
5807	            "GET",
5808	            f"/_synapse/admin/v1/users/{self.bad_user}/cumulative_joined_room_count?from_ts={int(before_room_creation_timestamp)}",
5809	            access_token=self.admin_tok,
5810	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
66	            ),
67	            "smtp_host": "127.0.0.1",
68	            "smtp_port": 20,
69	            "require_transport_security": False,
70	            "smtp_user": None,
71	            "smtp_pass": None,
72	            "notif_from": "test@example.com",
73	        }
74	        config["public_baseurl"] = "https://example.com"
75	
76	        hs = self.setup_test_homeserver(config=config)
77	
78	        async def sendmail(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	        }
74	        config["public_baseurl"] = "https://example.com"
75	
76	        hs = self.setup_test_homeserver(config=config)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
104	
105	        channel = self.make_request("POST", "/_matrix/client/r0/login", body)
106	        self.assertEqual(channel.code, HTTPStatus.FORBIDDEN, channel.result)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
196	        # same IP
197	        reset("127.0.0.1")
198	        reset("127.0.0.2")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
197	        reset("127.0.0.1")
198	        reset("127.0.0.2")
199	        reset("127.0.0.3")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
198	        reset("127.0.0.2")
199	        reset("127.0.0.3")
200	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
201	        with self.assertRaises(HttpResponseException) as cm:
202	            reset("127.0.0.4")
203	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
352	        client_secret = "foobar"
353	        next_link = "http://example.com"
354	        self._request_token(email, client_secret, "127.0.0.1", next_link)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
353	        next_link = "http://example.com"
354	        self._request_token(email, client_secret, "127.0.0.1", next_link)
355	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
364	        client_secret: str,
365	        ip: str = "127.0.0.1",
366	        next_link: Optional[str] = None,
367	    ) -> str:
368	        body = {"client_secret": client_secret, "email": email, "send_attempt": 1}
369	        if next_link is not None:
370	            body["next_link"] = next_link

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
370	            body["next_link"] = next_link
371	        channel = self.make_request(
372	            "POST",
373	            b"account/password/email/requestToken",
374	            body,
375	            client_ip=ip,
376	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
388	        # Remove the host
389	        path = link.replace("https://example.com", "")
390	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
391	        # Load the password reset confirmation page
392	        channel = make_request(
393	            self.reactor,
394	            FakeSite(self.submit_token_resource, self.reactor),
395	            "GET",
396	            path,
397	            shorthand=False,
398	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
405	        # Confirm the password reset
406	        channel = make_request(
407	            self.reactor,
408	            FakeSite(self.submit_token_resource, self.reactor),
409	            "POST",
410	            path,
411	            content=b"",
412	            shorthand=False,
413	            content_is_form=True,
414	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
429	            if part.get_content_type() == "text/plain":
430	                text = part.get_payload(decode=True)
431	                if text is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
446	
447	        match = re.search(r"https://example.com\S+", text)
448	        assert match, "Could not find link in email"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
458	    ) -> None:
459	        channel = self.make_request(
460	            "POST",
461	            b"account/password",
462	            {
463	                "new_password": new_password,
464	                "auth": {
465	                    "type": LoginType.EMAIL_IDENTITY,
466	                    "threepid_creds": {
467	                        "client_secret": client_secret,
468	                        "sid": session_id,
469	                    },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
499	        # Check that this access token has been invalidated.
500	        channel = self.make_request("GET", "account/whoami", access_token=tok)
501	        self.assertEqual(channel.code, 401)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
709	        }
710	        channel = self.make_request(
711	            "POST", "account/deactivate", request_data, access_token=tok
712	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
744	    def test_GET_whoami_guests(self) -> None:
745	        channel = self.make_request(
746	            b"POST", b"/_matrix/client/r0/register?kind=guest", b"{}"
747	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
784	    def _whoami(self, tok: str) -> JsonDict:
785	        channel = self.make_request("GET", "account/whoami", {}, access_token=tok)
786	        self.assertEqual(channel.code, 200)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
805	            ),
806	            "smtp_host": "127.0.0.1",
807	            "smtp_port": 20,
808	            "require_transport_security": False,
809	            "smtp_user": None,
810	            "smtp_pass": None,
811	            "notif_from": "test@example.com",
812	        }
813	        config["public_baseurl"] = "https://example.com"
814	
815	        self.hs = self.setup_test_homeserver(config=config)
816	
817	        async def sendmail(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
812	        }
813	        config["public_baseurl"] = "https://example.com"
814	
815	        self.hs = self.setup_test_homeserver(config=config)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
912	        client_secret = "foobar"
913	        channel = self.make_request(
914	            "POST",
915	            b"/_matrix/client/unstable/account/3pid/email/requestToken",
916	            {
917	                "client_secret": client_secret,
918	                "email": "test@example.com",
919	                "send_attempt": 1,
920	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
941	
942	        channel = self.make_request(
943	            "POST",
944	            b"account/3pid/delete",
945	            {"medium": "email", "address": self.email},
946	            access_token=self.user_id_tok,
947	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:951
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
950	        # Get user
951	        channel = self.make_request(
952	            "GET",
953	            self.url_3pid,
954	            access_token=self.user_id_tok,
955	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:975
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
974	
975	        channel = self.make_request(
976	            "POST",
977	            b"account/3pid/delete",
978	            {"medium": "email", "address": self.email},
979	            access_token=self.user_id_tok,
980	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
987	        # Get user
988	        channel = self.make_request(
989	            "GET",
990	            self.url_3pid,
991	            access_token=self.user_id_tok,
992	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1005	        # Attempt to add email without clicking the link
1006	        channel = self.make_request(
1007	            "POST",
1008	            b"/_matrix/client/unstable/account/3pid/add",
1009	            {
1010	                "client_secret": client_secret,
1011	                "sid": session_id,
1012	                "auth": {
1013	                    "type": "m.login.password",
1014	                    "user": self.user_id,
1015	                    "password": "test",
1016	                },
1017	            },
1018	            access_token=self.user_id_tok,
1019	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1025	        # Get user
1026	        channel = self.make_request(
1027	            "GET",
1028	            self.url_3pid,
1029	            access_token=self.user_id_tok,
1030	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1042	        # Attempt to add email without even requesting an email
1043	        channel = self.make_request(
1044	            "POST",
1045	            b"/_matrix/client/unstable/account/3pid/add",
1046	            {
1047	                "client_secret": client_secret,
1048	                "sid": session_id,
1049	                "auth": {
1050	                    "type": "m.login.password",
1051	                    "user": self.user_id,
1052	                    "password": "test",
1053	                },
1054	            },
1055	            access_token=self.user_id_tok,
1056	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1063
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1062	        # Get user
1063	        channel = self.make_request(
1064	            "GET",
1065	            self.url_3pid,
1066	            access_token=self.user_id_tok,
1067	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1077	            "some_secret",
1078	            next_link="https://example.com/a/good/site",
1079	            expect_code=HTTPStatus.OK,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1119	            "some_secret",
1120	            next_link="https://example.com/some/good/page",
1121	            expect_code=HTTPStatus.OK,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1126	            "some_secret",
1127	            next_link="https://example.org/some/also/good/page",
1128	            expect_code=HTTPStatus.OK,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1133	            "some_secret",
1134	            next_link="https://bad.example.org/some/bad/page",
1135	            expect_code=HTTPStatus.BAD_REQUEST,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1145	            "some_secret",
1146	            next_link="https://example.com/a/page",
1147	            expect_code=HTTPStatus.BAD_REQUEST,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1172	
1173	        channel = self.make_request(
1174	            "POST",
1175	            b"account/3pid/email/requestToken",
1176	            body,
1177	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1194	    ) -> None:
1195	        channel = self.make_request(
1196	            "POST",
1197	            b"account/3pid/email/requestToken",
1198	            {"client_secret": client_secret, "email": email, "send_attempt": 1},
1199	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1207	        # Remove the host
1208	        path = link.replace("https://example.com", "")
1209	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1209	
1210	        channel = self.make_request("GET", path, shorthand=False)
1211	        self.assertEqual(HTTPStatus.OK, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1221	            if part.get_content_type() == "text/plain":
1222	                text = part.get_payload(decode=True)
1223	                if text is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1238	
1239	        match = re.search(r"https://example.com\S+", text)
1240	        assert match, "Could not find link in email"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1255	
1256	        channel = self.make_request(
1257	            "POST",
1258	            b"/_matrix/client/unstable/account/3pid/add",
1259	            {
1260	                "client_secret": client_secret,
1261	                "sid": session_id,
1262	                "auth": {
1263	                    "type": "m.login.password",
1264	                    "user": self.user_id,
1265	                    "password": "test",
1266	                },
1267	            },
1268	            access_token=self.user_id_tok,
1269	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1273	        # Get user
1274	        channel = self.make_request(
1275	            "GET",
1276	            self.url_3pid,
1277	            access_token=self.user_id_tok,
1278	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_account.py:1524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1523	
1524	        channel = self.make_request(
1525	            method="POST",
1526	            path=self.url,
1527	            content=content,
1528	            access_token=self.requester_tok,
1529	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
83	        """Make a register request."""
84	        channel = self.make_request("POST", "register", body)
85	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
98	
99	        channel = self.make_request(
100	            "GET", "auth/m.login.recaptcha/fallback/web?session=" + session
101	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
103	
104	        channel = self.make_request(
105	            "POST",
106	            "auth/m.login.recaptcha/fallback/web?session="
107	            + post_session
108	            + "&g-recaptcha-response=a",
109	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	        # the public_baseurl stops Synapse trying to redirect to https.
187	        config["public_baseurl"] = "http://synapse.test"
188	
189	        if HAS_OIDC:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
225	        """Delete an individual device."""
226	        channel = self.make_request(
227	            "DELETE",
228	            "devices/" + device,
229	            body,
230	            access_token=access_token,
231	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
241	        # the payload half-way through some tests.
242	        channel = self.make_request(
243	            "POST",
244	            "delete_devices",
245	            body,
246	            access_token=self.user_tok,
247	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
642	        """
643	        return self.make_request(
644	            "POST",
645	            "/_matrix/client/v3/refresh",
646	            {"refresh_token": refresh_token},
647	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
659	
660	        login_without_refresh = self.make_request(
661	            "POST", "/_matrix/client/r0/login", body
662	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
667	
668	        login_with_refresh = self.make_request(
669	            "POST",
670	            "/_matrix/client/r0/login",
671	            {"refresh_token": True, **body},
672	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
682	        """
683	        register_without_refresh = self.make_request(
684	            "POST",
685	            "/_matrix/client/r0/register",
686	            {
687	                "username": "test2",
688	                "password": self.user_pass,
689	                "auth": {"type": LoginType.DUMMY},
690	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
698	
699	        register_with_refresh = self.make_request(
700	            "POST",
701	            "/_matrix/client/r0/register",
702	            {
703	                "username": "test3",
704	                "password": self.user_pass,
705	                "auth": {"type": LoginType.DUMMY},
706	                "refresh_token": True,
707	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
724	        }
725	        login_response = self.make_request(
726	            "POST",
727	            "/_matrix/client/r0/login",
728	            body,
729	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
731	
732	        refresh_response = self.make_request(
733	            "POST",
734	            "/_matrix/client/v3/refresh",
735	            {"refresh_token": login_response.json_body["refresh_token"]},
736	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
762	        }
763	        login_response = self.make_request(
764	            "POST",
765	            "/_matrix/client/r0/login",
766	            body,
767	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
772	
773	        refresh_response = self.make_request(
774	            "POST",
775	            "/_matrix/client/v3/refresh",
776	            {"refresh_token": login_response.json_body["refresh_token"]},
777	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
787	        self.assertEqual(
788	            self.make_request(
789	                "GET", "/_matrix/client/v3/account/whoami", access_token=access_token
790	            ).code,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
797	        self.assertEqual(
798	            self.make_request(
799	                "GET", "/_matrix/client/v3/account/whoami", access_token=access_token
800	            ).code,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
821	        }
822	        login_response1 = self.make_request(
823	            "POST",
824	            "/_matrix/client/r0/login",
825	            {"refresh_token": True, **body},
826	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
832	
833	        login_response2 = self.make_request(
834	            "POST",
835	            "/_matrix/client/r0/login",
836	            body,
837	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
892	        }
893	        login_response = self.make_request(
894	            "POST",
895	            "/_matrix/client/r0/login",
896	            body,
897	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
942	        }
943	        login_response = self.make_request(
944	            "POST",
945	            "/_matrix/client/r0/login",
946	            body,
947	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1001	        }
1002	        login_response = self.make_request(
1003	            "POST",
1004	            "/_matrix/client/r0/login",
1005	            body,
1006	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1010
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1009	        # This first refresh should work properly
1010	        first_refresh_response = self.make_request(
1011	            "POST",
1012	            "/_matrix/client/v3/refresh",
1013	            {"refresh_token": login_response.json_body["refresh_token"]},
1014	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1019	        # This one as well, since the token in the first one was never used
1020	        second_refresh_response = self.make_request(
1021	            "POST",
1022	            "/_matrix/client/v3/refresh",
1023	            {"refresh_token": login_response.json_body["refresh_token"]},
1024	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1029	        # This one should not, since the token from the first refresh is not valid anymore
1030	        third_refresh_response = self.make_request(
1031	            "POST",
1032	            "/_matrix/client/v3/refresh",
1033	            {"refresh_token": first_refresh_response.json_body["refresh_token"]},
1034	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1041	        # The associated access token should also be invalid
1042	        whoami_response = self.make_request(
1043	            "GET",
1044	            "/_matrix/client/r0/account/whoami",
1045	            access_token=first_refresh_response.json_body["access_token"],
1046	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1055	        ]:
1056	            whoami_response = self.make_request(
1057	                "GET", "/_matrix/client/r0/account/whoami", access_token=access_token
1058	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1063	        # Now that the access token from the last valid refresh was used once, refreshing with the N-1 token should fail
1064	        fourth_refresh_response = self.make_request(
1065	            "POST",
1066	            "/_matrix/client/v3/refresh",
1067	            {"refresh_token": login_response.json_body["refresh_token"]},
1068	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1075	        # But refreshing from the last valid refresh token still works
1076	        fifth_refresh_response = self.make_request(
1077	            "POST",
1078	            "/_matrix/client/v3/refresh",
1079	            {"refresh_token": second_refresh_response.json_body["refresh_token"]},
1080	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1135	        }
1136	        login_response = self.make_request(
1137	            "POST",
1138	            "/_matrix/client/v3/login",
1139	            body,
1140	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1161	
1162	        logout_response = self.make_request(
1163	            "POST", "/_matrix/client/v3/logout", {}, access_token=access_token
1164	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1221	        # the public_baseurl stops Synapse trying to redirect to https.
1222	        config["public_baseurl"] = "http://synapse.test"
1223	
1224	        return config

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1231	    def submit_logout_token(self, logout_token: str) -> FakeChannel:
1232	        return self.make_request(
1233	            "POST",
1234	            "/_synapse/client/oidc/backchannel_logout",
1235	            content=f"logout_token={logout_token}",
1236	            content_is_form=True,
1237	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1303	        # Get an authentication, and logout before submitting the logout token
1304	        client_redirect_url = "https://x"
1305	        userinfo = {"sub": user}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1350	        # Get an authentication, and logout before submitting the logout token
1351	        client_redirect_url = "https://x"
1352	        userinfo = {"sub": user}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1471	        """
1472	        first_server = self.helper.fake_oidc_server(issuer="https://first-issuer.com/")
1473	        second_server = self.helper.fake_oidc_server(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1473	        second_server = self.helper.fake_oidc_server(
1474	            issuer="https://second-issuer.com/"
1475	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1454	                    "first",
1455	                    issuer="https://first-issuer.com/",
1456	                    with_localpart_template=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth.py:1461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1460	                    "second",
1461	                    issuer="https://second-issuer.com/",
1462	                    with_localpart_template=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	
28	ISSUER = "https://account.example.com/"
29	
30	
31	class AuthIssuerTestCase(HomeserverTestCase):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
37	        # Make an unauthenticated request for the discovery info.
38	        channel = self.make_request(
39	            "GET",
40	            "/_matrix/client/unstable/org.matrix.msc2965/auth_issuer",
41	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
63	
64	        channel = self.make_request(
65	            "GET",
66	            "/_matrix/client/unstable/org.matrix.msc2965/auth_issuer",
67	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        req_mock.assert_called_with(
73	            "https://account.example.com/.well-known/openid-configuration"
74	        )
75	        req_mock.reset_mock()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
77	        # Second call it should use the cached value
78	        channel = self.make_request(
79	            "GET",
80	            "/_matrix/client/unstable/org.matrix.msc2965/auth_issuer",
81	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
94	        # Make an unauthenticated request for the discovery info.
95	        channel = self.make_request(
96	            "GET",
97	            "/_matrix/client/unstable/org.matrix.msc2965/auth_metadata",
98	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	                "issuer": ISSUER,
121	                "authorization_endpoint": "https://example.com/auth",
122	                "token_endpoint": "https://example.com/token",
123	            }
124	        )
125	        self.hs.get_proxied_http_client().get_json = req_mock  # type: ignore[method-assign]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	                "authorization_endpoint": "https://example.com/auth",
122	                "token_endpoint": "https://example.com/token",
123	            }
124	        )
125	        self.hs.get_proxied_http_client().get_json = req_mock  # type: ignore[method-assign]
126	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
126	
127	        channel = self.make_request(
128	            "GET",
129	            "/_matrix/client/unstable/org.matrix.msc2965/auth_metadata",
130	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	                "issuer": ISSUER,
137	                "authorization_endpoint": "https://example.com/auth",
138	                "token_endpoint": "https://example.com/token",
139	            },
140	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_auth_metadata.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
137	                "authorization_endpoint": "https://example.com/auth",
138	                "token_endpoint": "https://example.com/token",
139	            },
140	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
53	    def test_check_auth_required(self) -> None:
54	        channel = self.make_request("GET", self.url)
55	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
60	
61	        channel = self.make_request("GET", self.url, access_token=access_token)
62	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
75	
76	        channel = self.make_request("GET", self.url, access_token=access_token)
77	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
89	
90	        channel = self.make_request("GET", self.url, access_token=access_token)
91	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
103	
104	        channel = self.make_request("GET", self.url, access_token=access_token)
105	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
113	
114	        channel = self.make_request("GET", self.url, access_token=access_token)
115	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
127	
128	        channel = self.make_request("GET", self.url, access_token=access_token)
129	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
138	
139	        channel = self.make_request("GET", self.url, access_token=access_token)
140	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
156	
157	        channel = self.make_request("GET", self.url, access_token=access_token)
158	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
177	
178	        channel = self.make_request("GET", self.url, access_token=access_token)
179	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
193	
194	        channel = self.make_request("GET", self.url, access_token=access_token)
195	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
207	
208	        channel = self.make_request("GET", self.url, access_token=access_token)
209	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
222	
223	        channel = self.make_request("GET", self.url, access_token=access_token)
224	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
247	
248	        channel = self.make_request("GET", self.url, access_token=access_token)
249	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_capabilities.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
261	
262	        channel = self.make_request("GET", self.url, access_token=access_token)
263	        capabilities = channel.json_body["capabilities"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_consent.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
60	        with open(os.path.join(temp_consent_path, "en/1.html"), "w") as f:
61	            f.write("{{version}},{{has_consented}}")
62	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_consent.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
63	        with open(os.path.join(temp_consent_path, "en/success.html"), "w") as f:
64	            f.write("yay!")
65	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_consent.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
71	        resource = consent_resource.ConsentResource(self.hs)
72	        channel = make_request(
73	            self.reactor,
74	            FakeSite(resource, self.reactor),
75	            "GET",
76	            "/consent?v=1",
77	            shorthand=False,
78	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_consent.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
96	        )
97	        channel = make_request(
98	            self.reactor,
99	            FakeSite(resource, self.reactor),
100	            "GET",
101	            consent_uri,
102	            access_token=access_token,
103	            shorthand=False,
104	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_consent.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
111	        # POST to the consent page, saying we've agreed
112	        channel = make_request(
113	            self.reactor,
114	            FakeSite(resource, self.reactor),
115	            "POST",
116	            consent_uri + "&v=" + version,
117	            access_token=access_token,
118	            shorthand=False,
119	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_consent.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
123	        # changed
124	        channel = make_request(
125	            self.reactor,
126	            FakeSite(resource, self.reactor),
127	            "GET",
128	            consent_uri,
129	            access_token=access_token,
130	            shorthand=False,
131	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
42	    def test_false_by_default(self) -> None:
43	        channel = self.make_request("GET", "/_matrix/client/versions")
44	        self.assertEqual(channel.code, 200, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
48	    def test_true_if_enabled(self) -> None:
49	        channel = self.make_request("GET", "/_matrix/client/versions")
50	        self.assertEqual(channel.code, 200, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
99	        setter_expected = "on_timeout"
100	        channel = self.make_request(
101	            "PUT",
102	            _get_path_for_delayed_state(self.room_id, _EVENT_TYPE, state_key, 900),
103	            {
104	                setter_key: setter_expected,
105	            },
106	            self.user1_access_token,
107	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
136	
137	        channel = self.make_request(*args)
138	        self.assertEqual(HTTPStatus.OK, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
139	
140	        channel = self.make_request(*args)
141	        self.assertEqual(HTTPStatus.TOO_MANY_REQUESTS, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
150	        # Test that the request isn't ratelimited anymore.
151	        channel = self.make_request(*args)
152	        self.assertEqual(HTTPStatus.OK, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
154	    def test_update_delayed_event_without_id(self) -> None:
155	        channel = self.make_request(
156	            "POST",
157	            f"{PATH_PREFIX}/",
158	            access_token=self.user1_access_token,
159	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
162	    def test_update_delayed_event_without_body(self) -> None:
163	        channel = self.make_request(
164	            "POST",
165	            f"{PATH_PREFIX}/abc",
166	            access_token=self.user1_access_token,
167	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
174	    def test_update_delayed_event_without_action(self) -> None:
175	        channel = self.make_request(
176	            "POST",
177	            f"{PATH_PREFIX}/abc",
178	            {},
179	            self.user1_access_token,
180	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
187	    def test_update_delayed_event_with_invalid_action(self) -> None:
188	        channel = self.make_request(
189	            "POST",
190	            f"{PATH_PREFIX}/abc",
191	            {"action": "oops"},
192	            self.user1_access_token,
193	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
201	    def test_update_delayed_event_without_match(self, action: str) -> None:
202	        channel = self.make_request(
203	            "POST",
204	            f"{PATH_PREFIX}/abc",
205	            {"action": action},
206	            self.user1_access_token,
207	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
214	        setter_expected = "none"
215	        channel = self.make_request(
216	            "PUT",
217	            _get_path_for_delayed_state(self.room_id, _EVENT_TYPE, state_key, 1500),
218	            {
219	                setter_key: setter_expected,
220	            },
221	            self.user1_access_token,
222	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
239	
240	        channel = self.make_request(
241	            "POST",
242	            f"{PATH_PREFIX}/{delay_id}",
243	            {"action": "cancel"},
244	            self.user1_access_token,
245	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
263	        for _ in range(2):
264	            channel = self.make_request(
265	                "POST",
266	                _get_path_for_delayed_send(self.room_id, _EVENT_TYPE, 100000),
267	                {},
268	                self.user1_access_token,
269	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
274	
275	        channel = self.make_request(
276	            "POST",
277	            f"{PATH_PREFIX}/{delay_ids.pop(0)}",
278	            {"action": "cancel"},
279	            self.user1_access_token,
280	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
288	        )
289	        channel = self.make_request(*args)
290	        self.assertEqual(HTTPStatus.TOO_MANY_REQUESTS, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
299	        # Test that the request isn't ratelimited anymore.
300	        channel = self.make_request(*args)
301	        self.assertEqual(HTTPStatus.OK, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
307	        setter_expected = "on_send"
308	        channel = self.make_request(
309	            "PUT",
310	            _get_path_for_delayed_state(self.room_id, _EVENT_TYPE, state_key, 100000),
311	            {
312	                setter_key: setter_expected,
313	            },
314	            self.user1_access_token,
315	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
332	
333	        channel = self.make_request(
334	            "POST",
335	            f"{PATH_PREFIX}/{delay_id}",
336	            {"action": "send"},
337	            self.user1_access_token,
338	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
352	        for _ in range(2):
353	            channel = self.make_request(
354	                "POST",
355	                _get_path_for_delayed_send(self.room_id, _EVENT_TYPE, 100000),
356	                {},
357	                self.user1_access_token,
358	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
363	
364	        channel = self.make_request(
365	            "POST",
366	            f"{PATH_PREFIX}/{delay_ids.pop(0)}",
367	            {"action": "send"},
368	            self.user1_access_token,
369	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
377	        )
378	        channel = self.make_request(*args)
379	        self.assertEqual(HTTPStatus.TOO_MANY_REQUESTS, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
388	        # Test that the request isn't ratelimited anymore.
389	        channel = self.make_request(*args)
390	        self.assertEqual(HTTPStatus.OK, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
396	        setter_expected = "on_timeout"
397	        channel = self.make_request(
398	            "PUT",
399	            _get_path_for_delayed_state(self.room_id, _EVENT_TYPE, state_key, 1500),
400	            {
401	                setter_key: setter_expected,
402	            },
403	            self.user1_access_token,
404	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
421	
422	        channel = self.make_request(
423	            "POST",
424	            f"{PATH_PREFIX}/{delay_id}",
425	            {"action": "restart"},
426	            self.user1_access_token,
427	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
458	        for _ in range(2):
459	            channel = self.make_request(
460	                "POST",
461	                _get_path_for_delayed_send(self.room_id, _EVENT_TYPE, 100000),
462	                {},
463	                self.user1_access_token,
464	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
469	
470	        channel = self.make_request(
471	            "POST",
472	            f"{PATH_PREFIX}/{delay_ids.pop(0)}",
473	            {"action": "restart"},
474	            self.user1_access_token,
475	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
483	        )
484	        channel = self.make_request(*args)
485	        self.assertEqual(HTTPStatus.TOO_MANY_REQUESTS, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
494	        # Test that the request isn't ratelimited anymore.
495	        channel = self.make_request(*args)
496	        self.assertEqual(HTTPStatus.OK, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
504	        setter_expected = "on_timeout"
505	        channel = self.make_request(
506	            "PUT",
507	            _get_path_for_delayed_state(self.room_id, _EVENT_TYPE, state_key, 900),
508	            {
509	                setter_key: setter_expected,
510	            },
511	            self.user1_access_token,
512	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
543	        setter_key = "setter"
544	        channel = self.make_request(
545	            "PUT",
546	            _get_path_for_delayed_state(self.room_id, _EVENT_TYPE, state_key, 900),
547	            {
548	                setter_key: "on_timeout",
549	            },
550	            self.user1_access_token,
551	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_delayed_events.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
577	    def _get_delayed_events(self) -> List[JsonDict]:
578	        channel = self.make_request(
579	            "GET",
580	            PATH_PREFIX,
581	            access_token=self.user1_access_token,
582	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
58	        # Sync them so they have a last_seen value.
59	        self.make_request("GET", "/sync", access_token=tok1)
60	        self.make_request("GET", "/sync", access_token=tok2)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
59	        self.make_request("GET", "/sync", access_token=tok1)
60	        self.make_request("GET", "/sync", access_token=tok2)
61	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
65	        self.reactor.advance(43200)
66	        self.make_request("GET", "/sync", access_token=tok1)
67	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
96	        # Have alice update their device list
97	        channel = self.make_request(
98	            "PUT",
99	            "_matrix/client/unstable/org.matrix.msc2697.v2/dehydrated_device",
100	            {
101	                "device_data": {
102	                    "algorithm": "org.matrix.msc2697.v1.dehydration.v1.olm",
103	                    "account": "dehydrated_device",
104	                },
105	                "device_keys": {
106	                    "user_id": "@alice:test",
107	                    "device_id": "device1",
108	                    "valid_until_ts": "80",
109	                    "algorithms": [
110	                        "m.olm.curve25519-aes-sha2",
111	                    ],
112	                    "keys": {
113	                        "<algorithm>:<device_id>": "<key_base64>",
114	                    },
115	                    "signatures": {
116	                        "<user_id>": {"<algorithm>:<device_id>": "<signature_base64>"}
117	                    },
118	                },
119	            },
120	            access_token=token,
121	            shorthand=False,
122	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
164	        }
165	        channel = self.make_request(
166	            "PUT",
167	            "_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device",
168	            content=content,
169	            access_token=token,
170	            shorthand=False,
171	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
178	        # test that we can now GET the dehydrated device info
179	        channel = self.make_request(
180	            "GET",
181	            "_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device",
182	            access_token=token,
183	            shorthand=False,
184	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
194	        # test that the keys are correctly uploaded
195	        channel = self.make_request(
196	            "POST",
197	            "/_matrix/client/r0/keys/query",
198	            {
199	                "device_keys": {
200	                    user: ["device1"],
201	                },
202	            },
203	            token,
204	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
268	        # make sure we can fetch the message with our dehydrated device id
269	        channel = self.make_request(
270	            "POST",
271	            f"_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device/{device_id}/events",
272	            content={},
273	            access_token=token,
274	            shorthand=False,
275	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
280	        # fetch messages again and make sure that the message was not deleted
281	        channel = self.make_request(
282	            "POST",
283	            f"_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device/{device_id}/events",
284	            content={},
285	            access_token=token,
286	            shorthand=False,
287	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
294	        content = {"next_batch": next_batch_token}
295	        channel = self.make_request(
296	            "POST",
297	            f"_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device/{device_id}/events",
298	            content=content,
299	            access_token=token,
300	            shorthand=False,
301	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
305	        # make sure we can delete the dehydrated device
306	        channel = self.make_request(
307	            "DELETE",
308	            "_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device",
309	            access_token=token,
310	            shorthand=False,
311	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
314	        # ...and after deleting it is no longer available
315	        channel = self.make_request(
316	            "GET",
317	            "_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device",
318	            access_token=token,
319	            shorthand=False,
320	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
349	        }
350	        channel = self.make_request(
351	            "PUT",
352	            "_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device",
353	            content=content,
354	            access_token=token,
355	            shorthand=False,
356	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
363	        # ensure that keys were uploaded and available
364	        channel = self.make_request(
365	            "POST",
366	            "/_matrix/client/r0/keys/query",
367	            {
368	                "device_keys": {
369	                    user: ["device2"],
370	                },
371	            },
372	            token,
373	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
381	        # delete the dehydrated device
382	        channel = self.make_request(
383	            "DELETE",
384	            "_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device",
385	            access_token=token,
386	            shorthand=False,
387	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
390	        # ensure that keys are no longer available for deleted device
391	        channel = self.make_request(
392	            "POST",
393	            "/_matrix/client/r0/keys/query",
394	            {
395	                "device_keys": {
396	                    user: ["device2"],
397	                },
398	            },
399	            token,
400	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
406	        content["device_keys"]["device_id"] = "device3"
407	        channel = self.make_request(
408	            "PUT",
409	            "_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device",
410	            content=content,
411	            access_token=token,
412	            shorthand=False,
413	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
422	        content["device_keys"]["device_id"] = "device4"
423	        channel = self.make_request(
424	            "PUT",
425	            "_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device",
426	            content=content,
427	            access_token=token,
428	            shorthand=False,
429	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
436	        # check that the second device that was created is what is returned when we GET
437	        channel = self.make_request(
438	            "GET",
439	            "_matrix/client/unstable/org.matrix.msc3814.v1/dehydrated_device",
440	            access_token=token,
441	            shorthand=False,
442	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
447	        # and that if we query the keys for the first device they are not there
448	        channel = self.make_request(
449	            "POST",
450	            "/_matrix/client/r0/keys/query",
451	            {
452	                "device_keys": {
453	                    user: ["device3"],
454	                },
455	            },
456	            token,
457	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
499	
500	        channel = self.make_request(
501	            "GET",
502	            "/_matrix/client/v3/devices?user_id=@alice:test",
503	            access_token=self.msc4190_service.token,
504	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
507	
508	        channel = self.make_request(
509	            "PUT",
510	            "/_matrix/client/v3/devices/AABBCCDD?user_id=@alice:test",
511	            content={"display_name": "Alice's device"},
512	            access_token=self.msc4190_service.token,
513	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
515	
516	        channel = self.make_request(
517	            "GET",
518	            "/_matrix/client/v3/devices?user_id=@alice:test",
519	            access_token=self.msc4190_service.token,
520	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
525	        # Doing a second time should return a 200 instead of a 201
526	        channel = self.make_request(
527	            "PUT",
528	            "/_matrix/client/v3/devices/AABBCCDD?user_id=@alice:test",
529	            content={"display_name": "Alice's device"},
530	            access_token=self.msc4190_service.token,
531	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
535	        # creation of new devices.
536	        channel = self.make_request(
537	            "PUT",
538	            "/_matrix/client/v3/devices/AABBCCDD?user_id=@bob:test",
539	            content={"display_name": "Bob's device"},
540	            access_token=self.pre_msc_service.token,
541	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
547	        # There should be no device
548	        channel = self.make_request(
549	            "GET",
550	            "/_matrix/client/v3/devices?user_id=@alice:test",
551	            access_token=self.msc4190_service.token,
552	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
556	        # Create a device
557	        channel = self.make_request(
558	            "PUT",
559	            "/_matrix/client/v3/devices/AABBCCDD?user_id=@alice:test",
560	            content={},
561	            access_token=self.msc4190_service.token,
562	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
565	        # There should be one device
566	        channel = self.make_request(
567	            "GET",
568	            "/_matrix/client/v3/devices?user_id=@alice:test",
569	            access_token=self.msc4190_service.token,
570	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
574	        # Delete the device. UIA should not be required.
575	        channel = self.make_request(
576	            "DELETE",
577	            "/_matrix/client/v3/devices/AABBCCDD?user_id=@alice:test",
578	            access_token=self.msc4190_service.token,
579	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
582	        # There should be no device again
583	        channel = self.make_request(
584	            "GET",
585	            "/_matrix/client/v3/devices?user_id=@alice:test",
586	            access_token=self.msc4190_service.token,
587	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
594	        # There should be no device
595	        channel = self.make_request(
596	            "GET",
597	            "/_matrix/client/v3/devices?user_id=@alice:test",
598	            access_token=self.msc4190_service.token,
599	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
603	        # Create a device
604	        channel = self.make_request(
605	            "PUT",
606	            "/_matrix/client/v3/devices/AABBCCDD?user_id=@alice:test",
607	            content={},
608	            access_token=self.msc4190_service.token,
609	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
612	        # There should be one device
613	        channel = self.make_request(
614	            "GET",
615	            "/_matrix/client/v3/devices?user_id=@alice:test",
616	            access_token=self.msc4190_service.token,
617	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
622	        # UIA should not be required.
623	        channel = self.make_request(
624	            "POST",
625	            "/_matrix/client/v3/delete_devices?user_id=@alice:test",
626	            content={"devices": ["AABBCCDD"]},
627	            access_token=self.msc4190_service.token,
628	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_devices.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
631	        # There should be no device again
632	        channel = self.make_request(
633	            "GET",
634	            "/_matrix/client/v3/devices?user_id=@alice:test",
635	            access_token=self.msc4190_service.token,
636	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
104	        request_data = {"room_alias_name": random_string(256 - len(self.hs.hostname))}
105	        channel = self.make_request(
106	            "POST", url, request_data, access_token=self.user_tok
107	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
116	        request_data = {"room_alias_name": random_string(5)}
117	        channel = self.make_request(
118	            "POST", url, request_data, access_token=self.user_tok
119	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
127	        # Then try to remove the alias
128	        channel = self.make_request(
129	            "DELETE",
130	            f"/_matrix/client/r0/directory/room/{alias}",
131	            access_token=self.user_tok,
132	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
150	
151	        channel = self.make_request(
152	            "PUT",
153	            f"/_matrix/client/r0/directory/room/{alias}",
154	            request_data,
155	            access_token=as_token,
156	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
159	        # Then try to remove the alias, as the appservice
160	        channel = self.make_request(
161	            "DELETE",
162	            f"/_matrix/client/r0/directory/room/{alias}",
163	            access_token=as_token,
164	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
169	        alias = "#potato:test"
170	        channel = self.make_request(
171	            "GET",
172	            f"/_matrix/client/r0/directory/room/{alias}",
173	            access_token=self.user_tok,
174	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
179	        # Then try to remove the alias
180	        channel = self.make_request(
181	            "DELETE",
182	            f"/_matrix/client/r0/directory/room/{alias}",
183	            access_token=self.user_tok,
184	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
198	
199	        channel = self.make_request(
200	            "PUT", url, request_data, access_token=self.user_tok
201	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
210	
211	        channel = self.make_request(
212	            "PUT", url, request_data, access_token=self.user_tok
213	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_directory.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
218	        alias = "#potato"
219	        channel = self.make_request(
220	            "GET",
221	            f"/_matrix/client/r0/directory/room/{alias}",
222	            access_token=self.user_tok,
223	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_ephemeral_message.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
108	
109	        channel = self.make_request("GET", url)
110	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_identity.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
52	
53	        channel = self.make_request(b"POST", "/createRoom", b"{}", access_token=tok)
54	        self.assertEqual(channel.code, HTTPStatus.OK, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_identity.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
63	        request_url = ("/rooms/%s/invite" % (room_id)).encode("ascii")
64	        channel = self.make_request(
65	            b"POST", request_url, request_data, access_token=tok
66	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
53	        bob = self.register_user("bob", "uncle")
54	        channel = self.make_request(
55	            "POST",
56	            "/_matrix/client/r0/keys/query",
57	            {
58	                "device_keys": {
59	                    bob: "device_id1",
60	                },
61	            },
62	            alice_token,
63	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
74	        bob = self.register_user("bob", "uncle")
75	        channel = self.make_request(
76	            "POST",
77	            "/_matrix/client/r0/keys/query",
78	            {
79	                "device_keys": {
80	                    bob: {
81	                        "device_id1": True,
82	                    },
83	                },
84	            },
85	            alice_token,
86	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
98	        alice_token = self.login("alice", "wonderland")
99	        channel = self.make_request(
100	            "POST",
101	            "/_matrix/client/r0/keys/query",
102	            {},
103	            alice_token,
104	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
165	        # Initial request should succeed as no existing keys are present.
166	        channel = self.make_request(
167	            "POST",
168	            "/_matrix/client/v3/keys/device_signing/upload",
169	            keys1,
170	            alice_token,
171	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
176	        # Subsequent request should require UIA as keys already exist even though session_timeout is set.
177	        channel = self.make_request(
178	            "POST",
179	            "/_matrix/client/v3/keys/device_signing/upload",
180	            keys2,
181	            alice_token,
182	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
198	        # Request should complete
199	        channel = self.make_request(
200	            "POST",
201	            "/_matrix/client/v3/keys/device_signing/upload",
202	            keys2,
203	            alice_token,
204	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
236	        alice = "@alice:test"
237	        channel = self.make_request(
238	            "PUT",
239	            f"/_synapse/admin/v2/users/{urllib.parse.quote(alice)}",
240	            access_token=self.OIDC_ADMIN_TOKEN,
241	            content={},
242	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
247	        alice_device = "alice_device"
248	        channel = self.make_request(
249	            "POST",
250	            f"/_synapse/admin/v2/users/{urllib.parse.quote(alice)}/devices",
251	            access_token=self.OIDC_ADMIN_TOKEN,
252	            content={"device_id": alice_device},
253	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
298	            # Upload an initial cross-signing key.
299	            channel = self.make_request(
300	                "POST",
301	                "/_matrix/client/v3/keys/device_signing/upload",
302	                access_token=alice_token,
303	                content={
304	                    "master_key": master_key,
305	                },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
309	            # Should not be able to upload another master key.
310	            channel = self.make_request(
311	                "POST",
312	                "/_matrix/client/v3/keys/device_signing/upload",
313	                access_token=alice_token,
314	                content={
315	                    "master_key": master_key2,
316	                },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
320	        # Pretend that MAS did UIA and allowed us to replace the master key.
321	        channel = self.make_request(
322	            "POST",
323	            f"/_synapse/admin/v1/users/{urllib.parse.quote(alice)}/_allow_cross_signing_replacement_without_uia",
324	            access_token=self.OIDC_ADMIN_TOKEN,
325	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
329	            # Should now be able to upload master key2.
330	            channel = self.make_request(
331	                "POST",
332	                "/_matrix/client/v3/keys/device_signing/upload",
333	                access_token=alice_token,
334	                content={
335	                    "master_key": master_key2,
336	                },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
341	            # upload master key 3 immediately after uploading key 2.
342	            channel = self.make_request(
343	                "POST",
344	                "/_matrix/client/v3/keys/device_signing/upload",
345	                access_token=alice_token,
346	                content={
347	                    "master_key": master_key3,
348	                },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
352	        # Pretend that MAS did UIA and allowed us to replace the master key.
353	        channel = self.make_request(
354	            "POST",
355	            f"/_synapse/admin/v1/users/{urllib.parse.quote(alice)}/_allow_cross_signing_replacement_without_uia",
356	            access_token=self.OIDC_ADMIN_TOKEN,
357	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
366	            # expired.
367	            channel = self.make_request(
368	                "POST",
369	                "/_matrix/client/v3/keys/device_signing/upload",
370	                access_token=alice_token,
371	                content={
372	                    "master_key": master_key3,
373	                },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
222	                    "enabled": True,
223	                    "issuer": "https://issuer",
224	                    "account_management_url": "https://my-account.issuer",
225	                    "client_id": "id",
226	                    "client_auth_method": "client_secret_post",
227	                    "client_secret": "secret",
228	                    "admin_token": OIDC_ADMIN_TOKEN,
229	                },
230	            },
231	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_keys.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
223	                    "issuer": "https://issuer",
224	                    "account_management_url": "https://my-account.issuer",
225	                    "client_id": "id",
226	                    "client_auth_method": "client_secret_post",
227	                    "client_secret": "secret",
228	                    "admin_token": OIDC_ADMIN_TOKEN,
229	                },
230	            },
231	        }
232	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	# https://....
85	PUBLIC_BASEURL = "http://%s/" % (SYNAPSE_SERVER_PUBLIC_HOSTNAME,)
86	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	# CAS server used in some tests
88	CAS_SERVER = "https://fake.test"
89	
90	# just enough to tell pysaml2 where to redirect to
91	SAML_SERVER = "https://test.saml.server/idp/sso"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	# just enough to tell pysaml2 where to redirect to
91	SAML_SERVER = "https://test.saml.server/idp/sso"
92	TEST_SAML_METADATA = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	# a (valid) url with some annoying characters in.  %3D is =, %26 is &, %2B is +
106	TEST_CLIENT_REDIRECT_URL = 'https://x?<ab c>&q"+%3D%2B"="f√∂%26=o"'
107	
108	# the query params in TEST_CLIENT_REDIRECT_URL
109	EXPECTED_CLIENT_REDIRECT_URL_PARAMS = [("<ab c>", ""), ('q" =+"', '"f√∂&=o"')]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
227	            }
228	            channel = self.make_request(b"POST", LOGIN_URL, params)
229	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
249	        }
250	        channel = self.make_request(b"POST", LOGIN_URL, params)
251	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
275	            }
276	            channel = self.make_request(b"POST", LOGIN_URL, params)
277	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
297	        }
298	        channel = self.make_request(b"POST", LOGIN_URL, params)
299	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
323	            }
324	            channel = self.make_request(b"POST", LOGIN_URL, params)
325	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
345	        }
346	        channel = self.make_request(b"POST", LOGIN_URL, params)
347	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
354	        # we shouldn't be able to make requests without an access token
355	        channel = self.make_request(b"GET", TEST_URL)
356	        self.assertEqual(channel.code, 401, msg=channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
364	        }
365	        channel = self.make_request(b"POST", LOGIN_URL, params)
366	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
371	        # we should now be able to make requests with the access token
372	        channel = self.make_request(b"GET", TEST_URL, access_token=access_token)
373	        self.assertEqual(channel.code, 200, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
378	        # ... and we should be soft-logouted
379	        channel = self.make_request(b"GET", TEST_URL, access_token=access_token)
380	        self.assertEqual(channel.code, 401, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
392	        self.reactor.advance(3600)
393	        channel = self.make_request(b"GET", TEST_URL, access_token=access_token)
394	        self.assertEqual(channel.code, 401, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
400	
401	        channel = self.make_request(b"GET", TEST_URL, access_token=access_token)
402	        self.assertEqual(channel.code, 401, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
409	        """Perform the UI-Auth to delete a device"""
410	        channel = self.make_request(
411	            b"DELETE", "devices/" + device_id, access_token=access_token
412	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
429	
430	        channel = self.make_request(
431	            b"DELETE",
432	            "devices/" + device_id,
433	            access_token=access_token,
434	            content={"auth": auth},
435	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
445	        # we should now be able to make requests with the access token
446	        channel = self.make_request(b"GET", TEST_URL, access_token=access_token)
447	        self.assertEqual(channel.code, 200, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
452	        # ... and we should be soft-logouted
453	        channel = self.make_request(b"GET", TEST_URL, access_token=access_token)
454	        self.assertEqual(channel.code, 401, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
458	        # Now try to hard logout this session
459	        channel = self.make_request(b"POST", "/logout", access_token=access_token)
460	        self.assertEqual(channel.code, 200, msg=channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
471	        # we should now be able to make requests with the access token
472	        channel = self.make_request(b"GET", TEST_URL, access_token=access_token)
473	        self.assertEqual(channel.code, 200, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
478	        # ... and we should be soft-logouted
479	        channel = self.make_request(b"GET", TEST_URL, access_token=access_token)
480	        self.assertEqual(channel.code, 401, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
484	        # Now try to hard log out all of the user's sessions
485	        channel = self.make_request(b"POST", "/logout/all", access_token=access_token)
486	        self.assertEqual(channel.code, 200, msg=channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
501	        # make a login request with the bad device_id
502	        channel = self.make_request(
503	            "POST",
504	            "/_matrix/client/v3/login",
505	            body,
506	            custom_headers=None,
507	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
523	    def test_require_approval(self) -> None:
524	        channel = self.make_request(
525	            "POST",
526	            "register",
527	            {
528	                "username": "kermit",
529	                "password": "monkey",
530	                "auth": {"type": LoginType.DUMMY},
531	            },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
543	        }
544	        channel = self.make_request("POST", LOGIN_URL, params)
545	        self.assertEqual(403, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
552	        """GET /login should return m.login.token without get_login_token"""
553	        channel = self.make_request("GET", "/_matrix/client/r0/login")
554	        self.assertEqual(channel.code, 200, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
561	        """GET /login should return m.login.token with get_login_token true"""
562	        channel = self.make_request("GET", "/_matrix/client/r0/login")
563	        self.assertEqual(channel.code, 200, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
590	
591	        channel = self.make_request(
592	            "POST",
593	            "/_matrix/client/r0/login",
594	            body,
595	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
615	
616	        channel = self.make_request(
617	            "POST",
618	            "/_matrix/client/r0/login",
619	            body,
620	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
643	            "server_url": CAS_SERVER,
644	            "service_url": "https://matrix.goodserver.com:8448",
645	        }
646	
647	        config["saml2_config"] = {
648	            "sp_config": {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
663	                "discover": False,
664	                "issuer": "https://issuer1",
665	                "client_id": "test-client-id",
666	                "client_secret": "test-client-secret",
667	                "scopes": ["profile"],
668	                "authorization_endpoint": "https://issuer1/auth",
669	                "token_endpoint": "https://issuer1/token",
670	                "userinfo_endpoint": "https://issuer1/userinfo",
671	                "user_mapping_provider": {
672	                    "config": {"localpart_template": "{{ user.sub }}"}
673	                },
674	            }
675	        ]
676	        return config
677	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
667	                "scopes": ["profile"],
668	                "authorization_endpoint": "https://issuer1/auth",
669	                "token_endpoint": "https://issuer1/token",
670	                "userinfo_endpoint": "https://issuer1/userinfo",
671	                "user_mapping_provider": {
672	                    "config": {"localpart_template": "{{ user.sub }}"}
673	                },
674	            }
675	        ]
676	        return config
677	
678	    def prepare(self, reactor: MemoryReactor, clock: Clock, hs: HomeServer) -> None:
679	        self.login_sso_redirect_url_builder = LoginSSORedirectURIBuilder(hs.config)
680	
681	    def create_resource_dict(self) -> Dict[str, Resource]:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
668	                "authorization_endpoint": "https://issuer1/auth",
669	                "token_endpoint": "https://issuer1/token",
670	                "userinfo_endpoint": "https://issuer1/userinfo",
671	                "user_mapping_provider": {
672	                    "config": {"localpart_template": "{{ user.sub }}"}
673	                },
674	            }
675	        ]
676	        return config
677	
678	    def prepare(self, reactor: MemoryReactor, clock: Clock, hs: HomeServer) -> None:
679	        self.login_sso_redirect_url_builder = LoginSSORedirectURIBuilder(hs.config)
680	
681	    def create_resource_dict(self) -> Dict[str, Resource]:
682	        d = super().create_resource_dict()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
669	                "token_endpoint": "https://issuer1/token",
670	                "userinfo_endpoint": "https://issuer1/userinfo",
671	                "user_mapping_provider": {
672	                    "config": {"localpart_template": "{{ user.sub }}"}
673	                },
674	            }
675	        ]
676	        return config
677	
678	    def prepare(self, reactor: MemoryReactor, clock: Clock, hs: HomeServer) -> None:
679	        self.login_sso_redirect_url_builder = LoginSSORedirectURIBuilder(hs.config)
680	
681	    def create_resource_dict(self) -> Dict[str, Resource]:
682	        d = super().create_resource_dict()
683	        d.update(build_synapse_client_resource_tree(self.hs))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
687	        """GET /login should return password and SSO flows"""
688	        channel = self.make_request("GET", "/_matrix/client/r0/login")
689	        self.assertEqual(channel.code, 200, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
715	        # first hit the redirect url, which should redirect to our idp picker
716	        channel = self._make_sso_redirect_request(None)
717	        self.assertEqual(channel.code, 302, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
722	        # hitting that picker should give us some HTML
723	        channel = self.make_request("GET", uri)
724	        self.assertEqual(channel.code, 200, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
745	
746	        channel = self.make_request(
747	            "GET",
748	            "/_synapse/client/pick_idp?redirectUrl="
749	            + urllib.parse.quote_plus(TEST_CLIENT_REDIRECT_URL)
750	            + "&idp=cas",
751	            shorthand=False,
752	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
766	        # follow the redirect
767	        channel = self.make_request(
768	            "GET",
769	            # We have to make this relative to be compatible with `make_request(...)`
770	            get_relative_uri_from_absolute_uri(sso_login_redirect_uri),
771	            # We have to set the Host header to match the `public_baseurl` to avoid
772	            # the extra redirect in the `SsoRedirectServlet` in order for the
773	            # cookies to be visible.
774	            custom_headers=[
775	                ("Host", SYNAPSE_SERVER_PUBLIC_HOSTNAME),
776	            ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
797	        """If SAML is chosen, should redirect to the SAML server"""
798	        channel = self.make_request(
799	            "GET",
800	            "/_synapse/client/pick_idp?redirectUrl="
801	            + urllib.parse.quote_plus(TEST_CLIENT_REDIRECT_URL)
802	            + "&idp=saml",
803	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
817	        # follow the redirect
818	        channel = self.make_request(
819	            "GET",
820	            # We have to make this relative to be compatible with `make_request(...)`
821	            get_relative_uri_from_absolute_uri(sso_login_redirect_uri),
822	            # We have to set the Host header to match the `public_baseurl` to avoid
823	            # the extra redirect in the `SsoRedirectServlet` in order for the
824	            # cookies to be visible.
825	            custom_headers=[
826	                ("Host", SYNAPSE_SERVER_PUBLIC_HOSTNAME),
827	            ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:851
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
850	            # pick the default OIDC provider
851	            channel = self.make_request(
852	                "GET",
853	                f"/_synapse/client/pick_idp?redirectUrl={urllib.parse.quote_plus(TEST_CLIENT_REDIRECT_URL)}&idp=oidc",
854	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
869	            # follow the redirect
870	            channel = self.make_request(
871	                "GET",
872	                # We have to make this relative to be compatible with `make_request(...)`
873	                get_relative_uri_from_absolute_uri(sso_login_redirect_uri),
874	                # We have to set the Host header to match the `public_baseurl` to avoid
875	                # the extra redirect in the `SsoRedirectServlet` in order for the
876	                # cookies to be visible.
877	                custom_headers=[
878	                    ("Host", SYNAPSE_SERVER_PUBLIC_HOSTNAME),
879	                ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
921	        path, query = p.links[0].split("?", 1)
922	        self.assertEqual(path, "https://x")
923	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
933	        login_token = params[2][1]
934	        chan = self.make_request(
935	            "POST",
936	            "/login",
937	            content={"type": "m.login.token", "token": login_token},
938	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
943	        """An unknown IdP should cause a 404"""
944	        channel = self.make_request(
945	            "GET",
946	            "/_synapse/client/pick_idp?redirectUrl=http://x&idp=xyz",
947	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
945	            "GET",
946	            "/_synapse/client/pick_idp?redirectUrl=http://x&idp=xyz",
947	        )
948	        self.assertEqual(channel.code, 302, channel.result)
949	        location_headers = channel.headers.getRawHeaders("Location")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:957
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
956	            self.login_sso_redirect_url_builder.build_login_sso_redirect_uri(
957	                idp_id="xyz", client_redirect_url="http://x"
958	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
961	        # follow the redirect
962	        channel = self.make_request(
963	            "GET",
964	            # We have to make this relative to be compatible with `make_request(...)`
965	            get_relative_uri_from_absolute_uri(sso_login_redirect_uri),
966	            # We have to set the Host header to match the `public_baseurl` to avoid
967	            # the extra redirect in the `SsoRedirectServlet` in order for the
968	            # cookies to be visible.
969	            custom_headers=[
970	                ("Host", SYNAPSE_SERVER_PUBLIC_HOSTNAME),
971	            ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
977	        """If the client tries to pick an unknown IdP, return a 404"""
978	        channel = self._make_sso_redirect_request("xxx")
979	        self.assertEqual(channel.code, 404, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
986	        with fake_oidc_server.patch_homeserver(hs=self.hs):
987	            channel = self._make_sso_redirect_request("oidc")
988	        self.assertEqual(channel.code, 302, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1006	
1007	        return self.make_request(
1008	            "GET",
1009	            endpoint,
1010	            custom_headers=[("Host", SYNAPSE_SERVER_PUBLIC_HOSTNAME)],
1011	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1027	    def make_homeserver(self, reactor: MemoryReactor, clock: Clock) -> HomeServer:
1028	        self.base_url = "https://matrix.goodserver.com/"
1029	        self.redirect_path = "_synapse/client/login/sso/redirect/confirm"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1033
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1032	        config["public_baseurl"] = (
1033	            config.get("public_baseurl") or "https://matrix.goodserver.com:8448"
1034	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1052
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1051	            return (
1052	                """
1053	                <cas:serviceResponse xmlns:cas='http://www.yale.edu/tp/cas'>
1054	                  <cas:authenticationSuccess>
1055	                      <cas:user>%s</cas:user>
1056	                      <cas:proxyGrantingTicket>PGTIOU-84678-8a9d...</cas:proxyGrantingTicket>
1057	                      <cas:proxies>
1058	                          <cas:proxy>https://proxy2/pgtUrl</cas:proxy>
1059	                          <cas:proxy>https://proxy1/pgtUrl</cas:proxy>
1060	                      </cas:proxies>
1061	                  </cas:authenticationSuccess>
1062	                </cas:serviceResponse>
1063	            """
1064	                % cas_user_id
1065	            ).encode("utf-8")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1085
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1084	        base_url = "/_matrix/client/r0/login/cas/ticket?redirectUrl"
1085	        redirect_url = "https://dodgy-site.com/"
1086	
1087	        url_parts = list(urllib.parse.urlparse(base_url))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1095
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1094	        # Get Synapse to call the fake CAS and serve the template.
1095	        channel = self.make_request("GET", cas_ticket_url)
1096	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1122	        """Tests that the SSO login flow serves a redirect to a whitelisted url"""
1123	        self._test_redirect("https://legit-site.com/")
1124	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1114	                "client_whitelist": [
1115	                    "https://legit-site.com/",
1116	                    "https://other-site.com/",
1117	                ]
1118	            }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1115	                    "https://legit-site.com/",
1116	                    "https://other-site.com/",
1117	                ]
1118	            }
1119	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1126	    def test_cas_redirect_login_fallback(self) -> None:
1127	        self._test_redirect("https://example.com/_matrix/static/client/login")
1128	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1124	
1125	    @override_config({"public_baseurl": "https://example.com"})
1126	    def test_cas_redirect_login_fallback(self) -> None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1136	        # Get Synapse to call the fake CAS and serve the template.
1137	        channel = self.make_request("GET", cas_ticket_url)
1138	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1146	        """Logging in as a deactivated account should error."""
1147	        redirect_url = "https://legit-site.com/"
1148	
1149	        # First login (to create the user).
1150	        self._test_redirect(redirect_url)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1165	        # Get Synapse to call the fake CAS and serve the template.
1166	        channel = self.make_request("GET", cas_ticket_url)
1167	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1143	
1144	    @override_config({"sso": {"client_whitelist": ["https://legit-site.com/"]}})
1145	    def test_deactivated_user(self) -> None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1204	        params = {"type": "org.matrix.login.jwt", "token": self.jwt_encode(*args)}
1205	        channel = self.make_request(b"POST", LOGIN_URL, params)
1206	        return channel

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1349	        access_token = channel.json_body["access_token"]
1350	        channel = self.make_request(
1351	            "GET",
1352	            f"/_matrix/client/v3/profile/{user_id}/displayname",
1353	            access_token=access_token,
1354	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1359	        params = {"type": "org.matrix.login.jwt"}
1360	        channel = self.make_request(b"POST", LOGIN_URL, params)
1361	        self.assertEqual(channel.code, 403, msg=channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1453	        params = {"type": "org.matrix.login.jwt", "token": self.jwt_encode(*args)}
1454	        channel = self.make_request(b"POST", LOGIN_URL, params)
1455	        return channel

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1520	        }
1521	        channel = self.make_request(
1522	            b"POST", LOGIN_URL, params, access_token=self.service.token
1523	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1534	        }
1535	        channel = self.make_request(
1536	            b"POST", LOGIN_URL, params, access_token=self.service.token
1537	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1548	        }
1549	        channel = self.make_request(
1550	            b"POST", LOGIN_URL, params, access_token=self.service.token
1551	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1562	        }
1563	        channel = self.make_request(
1564	            b"POST", LOGIN_URL, params, access_token=self.another_service.token
1565	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1578	        }
1579	        channel = self.make_request(b"POST", LOGIN_URL, params)
1580	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1617	        # serving a confirmation page
1618	        config["sso"] = {"client_whitelist": ["https://x"]}
1619	        return config

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1703	        ).encode("utf8")
1704	        chan = self.make_request(
1705	            "POST",
1706	            path=picker_url,
1707	            content=content,
1708	            content_is_form=True,
1709	            custom_headers=[
1710	                ("Cookie", "username_mapping_session=" + session_id),
1711	                # old versions of twisted don't do form-parsing without a valid
1712	                # content-length header.
1713	                ("Content-Length", str(len(content))),
1714	            ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1720	        # send a request to the completion page, which should 302 to the client redirectUrl
1721	        chan = self.make_request(
1722	            "GET",
1723	            path=location_headers[0],
1724	            custom_headers=[("Cookie", "username_mapping_session=" + session_id)],
1725	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1731	        path, query = location_headers[0].split("?", 1)
1732	        self.assertEqual(path, "https://x")
1733	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1745	        # matrix access token, mxid, and device id.
1746	        chan = self.make_request(
1747	            "POST",
1748	            "/login",
1749	            content={"type": "m.login.token", "token": login_token},
1750	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1754	        # ensure the displayname and avatar from the OIDC response have been configured for the user.
1755	        channel = self.make_request(
1756	            "GET", "/profile/" + mxid, access_token=chan.json_body["access_token"]
1757	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1762	        # ensure the email from the OIDC response has been configured for the user.
1763	        channel = self.make_request(
1764	            "GET", "/account/3pid", access_token=chan.json_body["access_token"]
1765	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1793	        ).encode("utf8")
1794	        chan = self.make_request(
1795	            "POST",
1796	            path=picker_url,
1797	            content=content,
1798	            content_is_form=True,
1799	            custom_headers=[
1800	                ("Cookie", "username_mapping_session=" + session_id),
1801	                # old versions of twisted don't do form-parsing without a valid
1802	                # content-length header.
1803	                ("Content-Length", str(len(content))),
1804	            ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1810	        # send a request to the completion page, which should 302 to the client redirectUrl
1811	        chan = self.make_request(
1812	            "GET",
1813	            path=location_headers[0],
1814	            custom_headers=[("Cookie", "username_mapping_session=" + session_id)],
1815	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1821	        path, query = location_headers[0].split("?", 1)
1822	        self.assertEqual(path, "https://x")
1823	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1835	        # matrix access token, mxid, and device id.
1836	        chan = self.make_request(
1837	            "POST",
1838	            "/login",
1839	            content={"type": "m.login.token", "token": login_token},
1840	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1845
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1844	        # ensure the displayname and avatar from the OIDC response have not been configured for the user.
1845	        channel = self.make_request(
1846	            "GET", "/profile/" + mxid, access_token=chan.json_body["access_token"]
1847	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_login.py:1853
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1852	        # ensure the email from the OIDC response has not been configured for the user.
1853	        channel = self.make_request(
1854	            "GET", "/account/3pid", access_token=chan.json_body["access_token"]
1855	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	        (f, fname) = self.get_success(ctx.__aenter__())
128	        f.write(SMALL_PNG)
129	        self.get_success(ctx.__aexit__(None, None, None))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
157	        """
158	        response = self.make_request(
159	            "GET",
160	            f"/_matrix/client/v1/media/thumbnail/evil.com/{self.remote_media_id}?width=100&height=100",
161	            shorthand=False,
162	            content={"width": 100, "height": 100},
163	            access_token=self.tok,
164	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
178	        """
179	        response = self.make_request(
180	            "GET",
181	            f"/_matrix/client/v1/media/thumbnail/evil.com/{self.remote_media_id}?width=100&height=100",
182	            shorthand=False,
183	            access_token=self.tok,
184	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
206	        config["url_preview_ip_range_blacklist"] = (
207	            "192.168.1.1",
208	            "1.0.0.0/8",
209	            "3fff:ffff:ffff:ffff:ffff:ffff:ffff:ffff",
210	            "2001:800::/21",
211	        )
212	        config["url_preview_ip_range_whitelist"] = ("1.1.1.1",)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
211	        )
212	        config["url_preview_ip_range_whitelist"] = ("1.1.1.1",)
213	        config["url_preview_accept_language"] = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
243	            OEmbedEndpointConfig(
244	                api_endpoint="http://publish.twitter.com/oembed",
245	                url_patterns=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
245	                url_patterns=[
246	                    re.compile(r"http://twitter\.com/.+/status/.+"),
247	                ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
250	            OEmbedEndpointConfig(
251	                api_endpoint="http://www.hulu.com/api/oembed.{format}",
252	                url_patterns=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
252	                url_patterns=[
253	                    re.compile(r"http://www\.hulu\.com/watch/.+"),
254	                ],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
297	    def test_cache_returns_correct_type(self) -> None:
298	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
299	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
299	
300	        channel = self.make_request(
301	            "GET",
302	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
303	            shorthand=False,
304	            await_result=False,
305	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
301	            "GET",
302	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
303	            shorthand=False,
304	            await_result=False,
305	        )
306	        self.pump()
307	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
324	        # Check the cache returns the correct response
325	        channel = self.make_request(
326	            "GET",
327	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
328	            shorthand=False,
329	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
326	            "GET",
327	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
328	            shorthand=False,
329	        )
330	
331	        # Check the cache response has the same content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
337	        # Clear the in-memory cache
338	        self.assertIn("http://matrix.org", self.url_previewer._cache)
339	        self.url_previewer._cache.pop("http://matrix.org")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
338	        self.assertIn("http://matrix.org", self.url_previewer._cache)
339	        self.url_previewer._cache.pop("http://matrix.org")
340	        self.assertNotIn("http://matrix.org", self.url_previewer._cache)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
339	        self.url_previewer._cache.pop("http://matrix.org")
340	        self.assertNotIn("http://matrix.org", self.url_previewer._cache)
341	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
342	        # Check the database cache returns the correct response
343	        channel = self.make_request(
344	            "GET",
345	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
346	            shorthand=False,
347	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
344	            "GET",
345	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
346	            shorthand=False,
347	        )
348	
349	        # Check the cache response has the same content

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
355	    def test_non_ascii_preview_httpequiv(self) -> None:
356	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
357	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
365	
366	        channel = self.make_request(
367	            "GET",
368	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
369	            shorthand=False,
370	            await_result=False,
371	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
367	            "GET",
368	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
369	            shorthand=False,
370	            await_result=False,
371	        )
372	        self.pump()
373	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
391	    def test_video_rejected(self) -> None:
392	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
393	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
395	
396	        channel = self.make_request(
397	            "GET",
398	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
399	            shorthand=False,
400	            await_result=False,
401	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
397	            "GET",
398	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
399	            shorthand=False,
400	            await_result=False,
401	        )
402	        self.pump()
403	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
427	    def test_audio_rejected(self) -> None:
428	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
429	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
431	
432	        channel = self.make_request(
433	            "GET",
434	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
435	            shorthand=False,
436	            await_result=False,
437	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
433	            "GET",
434	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
435	            shorthand=False,
436	            await_result=False,
437	        )
438	        self.pump()
439	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
463	    def test_non_ascii_preview_content_type(self) -> None:
464	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
465	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
472	
473	        channel = self.make_request(
474	            "GET",
475	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
476	            shorthand=False,
477	            await_result=False,
478	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
474	            "GET",
475	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
476	            shorthand=False,
477	            await_result=False,
478	        )
479	        self.pump()
480	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
498	    def test_overlong_title(self) -> None:
499	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
500	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
507	
508	        channel = self.make_request(
509	            "GET",
510	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
511	            shorthand=False,
512	            await_result=False,
513	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
509	            "GET",
510	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
511	            shorthand=False,
512	            await_result=False,
513	        )
514	        self.pump()
515	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
538	        """
539	        self.lookups["example.com"] = [(IPv4Address, "10.1.2.3")]
540	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
540	
541	        channel = self.make_request(
542	            "GET",
543	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
544	            shorthand=False,
545	            await_result=False,
546	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
542	            "GET",
543	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
544	            shorthand=False,
545	            await_result=False,
546	        )
547	        self.pump()
548	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
568	        """
569	        self.lookups["example.com"] = [(IPv4Address, "192.168.1.1")]
570	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
570	
571	        channel = self.make_request(
572	            "GET",
573	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
574	            shorthand=False,
575	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
572	            "GET",
573	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
574	            shorthand=False,
575	        )
576	
577	        # No requests made.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
591	        """
592	        self.lookups["example.com"] = [(IPv4Address, "1.1.1.2")]
593	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
593	
594	        channel = self.make_request(
595	            "GET",
596	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
597	            shorthand=False,
598	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
595	            "GET",
596	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
597	            shorthand=False,
598	        )
599	
600	        self.assertEqual(channel.code, 502)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
612	        """
613	        channel = self.make_request(
614	            "GET",
615	            "/_matrix/client/v1/media/preview_url?url=http://192.168.1.1",
616	            shorthand=False,
617	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
614	            "GET",
615	            "/_matrix/client/v1/media/preview_url?url=http://192.168.1.1",
616	            shorthand=False,
617	        )
618	
619	        # No requests made.

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
630	        """
631	        channel = self.make_request(
632	            "GET",
633	            "/_matrix/client/v1/media/preview_url?url=http://1.1.1.2",
634	            shorthand=False,
635	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
632	            "GET",
633	            "/_matrix/client/v1/media/preview_url?url=http://1.1.1.2",
634	            shorthand=False,
635	        )
636	
637	        self.assertEqual(channel.code, 403)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
647	        """
648	        self.lookups["example.com"] = [(IPv4Address, "1.1.1.1")]
649	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
649	
650	        channel = self.make_request(
651	            "GET",
652	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
653	            shorthand=False,
654	            await_result=False,
655	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
651	            "GET",
652	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
653	            shorthand=False,
654	            await_result=False,
655	        )
656	        self.pump()
657	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
682	        self.lookups["example.com"] = [
683	            (IPv4Address, "1.1.1.2"),
684	            (IPv4Address, "10.1.2.3"),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
683	            (IPv4Address, "1.1.1.2"),
684	            (IPv4Address, "10.1.2.3"),
685	        ]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
686	
687	        channel = self.make_request(
688	            "GET",
689	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
690	            shorthand=False,
691	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
688	            "GET",
689	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
690	            shorthand=False,
691	        )
692	        self.assertEqual(channel.code, 502)
693	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
708	
709	        channel = self.make_request(
710	            "GET",
711	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
712	            shorthand=False,
713	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
710	            "GET",
711	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
712	            shorthand=False,
713	        )
714	
715	        # No requests made.

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
731	
732	        channel = self.make_request(
733	            "GET",
734	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
735	            shorthand=False,
736	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
733	            "GET",
734	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
735	            shorthand=False,
736	        )
737	
738	        self.assertEqual(channel.code, 502)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
750	        """
751	        channel = self.make_request(
752	            "OPTIONS",
753	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
754	            shorthand=False,
755	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
752	            "OPTIONS",
753	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
754	            shorthand=False,
755	        )
756	        self.assertEqual(channel.code, 204)
757	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
761	        """
762	        self.lookups["example.com"] = [(IPv4Address, "10.1.2.3")]
763	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
764	        # Build and make a request to the server
765	        channel = self.make_request(
766	            "GET",
767	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
768	            shorthand=False,
769	            await_result=False,
770	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
766	            "GET",
767	            "/_matrix/client/v1/media/preview_url?url=http://example.com",
768	            shorthand=False,
769	            await_result=False,
770	        )
771	        self.pump()
772	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
810	        """An image should be precached if mentioned in the HTML."""
811	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
812	        self.lookups["cdn.matrix.org"] = [(IPv4Address, "10.1.2.4")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
811	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
812	        self.lookups["cdn.matrix.org"] = [(IPv4Address, "10.1.2.4")]
813	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
817	
818	        channel = self.make_request(
819	            "GET",
820	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
821	            shorthand=False,
822	            await_result=False,
823	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
819	            "GET",
820	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
821	            shorthand=False,
822	            await_result=False,
823	        )
824	        self.pump()
825	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:862
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
861	        """If the preview image doesn't exist, ensure some data is returned."""
862	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
863	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
867	
868	        channel = self.make_request(
869	            "GET",
870	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
871	            shorthand=False,
872	            await_result=False,
873	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
869	            "GET",
870	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
871	            shorthand=False,
872	            await_result=False,
873	        )
874	        self.pump()
875	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
902	        """If the preview image doesn't exist, ensure some data is returned."""
903	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
904	        self.lookups["cdn.matrix.org"] = [(IPv4Address, "10.1.2.4")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
903	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
904	        self.lookups["cdn.matrix.org"] = [(IPv4Address, "10.1.2.4")]
905	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
909	
910	        channel = self.make_request(
911	            "GET",
912	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
913	            shorthand=False,
914	            await_result=False,
915	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
911	            "GET",
912	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
913	            shorthand=False,
914	            await_result=False,
915	        )
916	        self.pump()
917	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:941
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
940	        """If the autodiscovered oEmbed URL fails, ensure some data is returned."""
941	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
942	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:950
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
949	
950	        channel = self.make_request(
951	            "GET",
952	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
953	            shorthand=False,
954	            await_result=False,
955	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
951	            "GET",
952	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
953	            shorthand=False,
954	            await_result=False,
955	        )
956	        self.pump()
957	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
980	        """
981	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
982	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
982	
983	        data = base64.b64encode(SMALL_PNG).decode()
984	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:983
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
982	
983	        data = base64.b64encode(SMALL_PNG).decode()
984	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:991
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
990	
991	        channel = self.make_request(
992	            "GET",
993	            f"/_matrix/client/v1/media/preview_url?{query_params}",
994	            shorthand=False,
995	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1003	        """
1004	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
1005	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1005	
1006	        data = base64.b64encode(SMALL_PNG)
1007	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1005	
1006	        data = base64.b64encode(SMALL_PNG)
1007	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1011	
1012	        channel = self.make_request(
1013	            "GET",
1014	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
1015	            shorthand=False,
1016	            await_result=False,
1017	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1013	            "GET",
1014	            "/_matrix/client/v1/media/preview_url?url=http://matrix.org",
1015	            shorthand=False,
1016	            await_result=False,
1017	        )
1018	        self.pump()
1019	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1039
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1038	        """Test an oEmbed endpoint which returns a 'photo' type which redirects the preview to a new URL."""
1039	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1040	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1039	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1040	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1041	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1045
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1044	            "type": "photo",
1045	            "url": "http://cdn.twitter.com/matrixdotorg",
1046	        }
1047	        oembed_content = json.dumps(result).encode("utf-8")
1048	
1049	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1049
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1048	
1049	        channel = self.make_request(
1050	            "GET",
1051	            "/_matrix/client/v1/media/preview_url?url=http://twitter.com/matrixdotorg/status/12345",
1052	            shorthand=False,
1053	            await_result=False,
1054	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1051
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1050	            "GET",
1051	            "/_matrix/client/v1/media/preview_url?url=http://twitter.com/matrixdotorg/status/12345",
1052	            shorthand=False,
1053	            await_result=False,
1054	        )
1055	        self.pump()
1056	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1092	        body = channel.json_body
1093	        self.assertEqual(body["og:url"], "http://twitter.com/matrixdotorg/status/12345")
1094	        self._assert_small_png(body)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1098
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1097	        """Test an oEmbed endpoint which returns HTML content via the 'rich' type."""
1098	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1099	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1108	
1109	        channel = self.make_request(
1110	            "GET",
1111	            "/_matrix/client/v1/media/preview_url?url=http://twitter.com/matrixdotorg/status/12345",
1112	            shorthand=False,
1113	            await_result=False,
1114	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1110	            "GET",
1111	            "/_matrix/client/v1/media/preview_url?url=http://twitter.com/matrixdotorg/status/12345",
1112	            shorthand=False,
1113	            await_result=False,
1114	        )
1115	        self.pump()
1116	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1140	            {
1141	                "og:url": "http://twitter.com/matrixdotorg/status/12345",
1142	                "og:title": "Alice",
1143	                "og:description": "Content Preview",
1144	            },
1145	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1148	        """Test an oEmbed endpoint which requires the format in the URL."""
1149	        self.lookups["www.hulu.com"] = [(IPv4Address, "10.1.2.3")]
1150	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1157	
1158	        channel = self.make_request(
1159	            "GET",
1160	            "/_matrix/client/v1/media/preview_url?url=http://www.hulu.com/watch/12345",
1161	            shorthand=False,
1162	            await_result=False,
1163	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1159	            "GET",
1160	            "/_matrix/client/v1/media/preview_url?url=http://www.hulu.com/watch/12345",
1161	            shorthand=False,
1162	            await_result=False,
1163	        )
1164	        self.pump()
1165	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1190	            {
1191	                "og:url": "http://www.hulu.com/watch/12345",
1192	                "og:description": "Content Preview",
1193	            },
1194	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1200	        """The oEmbed URL should not be downloaded if the oEmbed URL is blocked."""
1201	        self.lookups["twitter.com"] = [(IPv4Address, "10.1.2.3")]
1202	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1202	
1203	        channel = self.make_request(
1204	            "GET",
1205	            "/_matrix/client/v1/media/preview_url?url=http://twitter.com/matrixdotorg/status/12345",
1206	            shorthand=False,
1207	            await_result=False,
1208	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1204	            "GET",
1205	            "/_matrix/client/v1/media/preview_url?url=http://twitter.com/matrixdotorg/status/12345",
1206	            shorthand=False,
1207	            await_result=False,
1208	        )
1209	        self.pump()
1210	        self.assertEqual(channel.code, 403, channel.result)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1221	        # list of oEmbed patterns) to get "raw" HTML response.
1222	        self.lookups["www.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1223	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1222	        self.lookups["www.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1223	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1224	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1223	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1224	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1225	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1231	
1232	        channel = self.make_request(
1233	            "GET",
1234	            "/_matrix/client/v1/media/preview_url?url=http://www.twitter.com/matrixdotorg/status/12345",
1235	            shorthand=False,
1236	            await_result=False,
1237	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1233	            "GET",
1234	            "/_matrix/client/v1/media/preview_url?url=http://www.twitter.com/matrixdotorg/status/12345",
1235	            shorthand=False,
1236	            await_result=False,
1237	        )
1238	        self.pump()
1239	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1257	            "type": "photo",
1258	            "url": "http://cdn.twitter.com/matrixdotorg",
1259	        }
1260	        oembed_content = json.dumps(result2).encode("utf-8")
1261	
1262	        # Ensure a second request is made to the oEmbed URL.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1300	        self.assertEqual(
1301	            body["og:url"], "http://www.twitter.com/matrixdotorg/status/12345"
1302	        )
1303	        self._assert_small_png(body)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1313	        # list of oEmbed patterns) to get "raw" HTML response.
1314	        self.lookups["www.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1315	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.4")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1314	        self.lookups["www.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1315	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.4")]
1316	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1323	
1324	        channel = self.make_request(
1325	            "GET",
1326	            "/_matrix/client/v1/media/preview_url?url=http://www.twitter.com/matrixdotorg/status/12345",
1327	            shorthand=False,
1328	            await_result=False,
1329	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1325	            "GET",
1326	            "/_matrix/client/v1/media/preview_url?url=http://www.twitter.com/matrixdotorg/status/12345",
1327	            shorthand=False,
1328	            await_result=False,
1329	        )
1330	        self.pump()
1331	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1362	        """
1363	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1364	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1364	
1365	        channel = self.make_request(
1366	            "GET",
1367	            "/_matrix/client/v1/media/preview_url?url=http://cdn.twitter.com/matrixdotorg",
1368	            shorthand=False,
1369	            await_result=False,
1370	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1366	            "GET",
1367	            "/_matrix/client/v1/media/preview_url?url=http://cdn.twitter.com/matrixdotorg",
1368	            shorthand=False,
1369	            await_result=False,
1370	        )
1371	        self.pump()
1372	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1406	        # Check fetching
1407	        channel = self.make_request(
1408	            "GET",
1409	            f"/_matrix/client/v1/media/download/{host}/{media_id}",
1410	            shorthand=False,
1411	            await_result=False,
1412	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1419	
1420	        channel = self.make_request(
1421	            "GET",
1422	            f"/_matrix/client/v1/download/{host}/{media_id}",
1423	            shorthand=False,
1424	            await_result=False,
1425	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1454	        # Check fetching
1455	        channel = self.make_request(
1456	            "GET",
1457	            f"/_matrix/client/v1/media/thumbnail/{host}/{media_id}?width=32&height=32&method=scale",
1458	            shorthand=False,
1459	            await_result=False,
1460	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1472	
1473	        channel = self.make_request(
1474	            "GET",
1475	            f"/_matrix/client/v1/media/thumbnail/{host}/{media_id}?width=32&height=32&method=scale",
1476	            shorthand=False,
1477	            await_result=False,
1478	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1517	        """
1518	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
1519	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1519	
1520	        bad_url = quote("http://matrix.org:8888/foo")
1521	        good_url = quote("http://matrix.org/foo")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1520	        bad_url = quote("http://matrix.org:8888/foo")
1521	        good_url = quote("http://matrix.org/foo")
1522	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1522	
1523	        channel = self.make_request(
1524	            "GET",
1525	            "/_matrix/client/v1/media/preview_url?url=" + bad_url,
1526	            shorthand=False,
1527	            await_result=False,
1528	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1531	
1532	        channel = self.make_request(
1533	            "GET",
1534	            "/_matrix/client/v1/media/preview_url?url=" + good_url,
1535	            shorthand=False,
1536	            await_result=False,
1537	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1559	        """
1560	        self.lookups["example.com"] = [(IPv4Address, "10.1.2.3")]
1561	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1561	
1562	        bad_url = quote("http://example.com/foo")
1563	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1563	
1564	        channel = self.make_request(
1565	            "GET",
1566	            "/_matrix/client/v1/media/preview_url?url=" + bad_url,
1567	            shorthand=False,
1568	            await_result=False,
1569	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1608	    def test_media_config(self) -> None:
1609	        channel = self.make_request(
1610	            "GET",
1611	            "/_matrix/client/v1/media/config",
1612	            shorthand=False,
1613	            access_token=self.tok,
1614	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1690	        # first request should go through
1691	        channel = self.make_request(
1692	            "GET",
1693	            "/_matrix/client/v1/media/download/remote.org/abc",
1694	            shorthand=False,
1695	            access_token=self.tok,
1696	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1700	        for i in range(15):
1701	            channel2 = self.make_request(
1702	                "GET",
1703	                f"/_matrix/client/v1/media/download/remote.org/abc{i}",
1704	                shorthand=False,
1705	                access_token=self.tok,
1706	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1709	        # 17th will hit ratelimit
1710	        channel3 = self.make_request(
1711	            "GET",
1712	            "/_matrix/client/v1/media/download/remote.org/abcd",
1713	            shorthand=False,
1714	            access_token=self.tok,
1715	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1718	        # however, a request from a different IP will go through
1719	        channel4 = self.make_request(
1720	            "GET",
1721	            "/_matrix/client/v1/media/download/remote.org/abcde",
1722	            shorthand=False,
1723	            client_ip="187.233.230.159",
1724	            access_token=self.tok,
1725	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1722	            shorthand=False,
1723	            client_ip="187.233.230.159",
1724	            access_token=self.tok,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1736	        # enough has drained and next request goes through
1737	        channel5 = self.make_request(
1738	            "GET",
1739	            "/_matrix/client/v1/media/download/remote.org/abcdef",
1740	            shorthand=False,
1741	            access_token=self.tok,
1742	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1772	        # first request should go through
1773	        channel = self.make_request(
1774	            "GET",
1775	            "/_matrix/client/v1/media/download/remote.org/abc",
1776	            shorthand=False,
1777	            access_token=self.tok,
1778	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1781	        # immediate second request should fail
1782	        channel = self.make_request(
1783	            "GET",
1784	            "/_matrix/client/v1/media/download/remote.org/abcd",
1785	            shorthand=False,
1786	            access_token=self.tok,
1787	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1793	        # request still fails
1794	        channel = self.make_request(
1795	            "GET",
1796	            "/_matrix/client/v1/media/download/remote.org/abcde",
1797	            shorthand=False,
1798	            access_token=self.tok,
1799	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1805	        # enough has drained from bucket and request is successful
1806	        channel = self.make_request(
1807	            "GET",
1808	            "/_matrix/client/v1/media/download/remote.org/abcdef",
1809	            shorthand=False,
1810	            access_token=self.tok,
1811	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1845
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1844	        for i in range(3):
1845	            channel2 = self.make_request(
1846	                "GET",
1847	                f"/_matrix/client/v1/media/download/remote.org/abc{i}",
1848	                shorthand=False,
1849	                access_token=self.tok,
1850	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1853	        # 4th will hit ratelimit
1854	        channel3 = self.make_request(
1855	            "GET",
1856	            "/_matrix/client/v1/media/download/remote.org/abcd",
1857	            shorthand=False,
1858	            access_token=self.tok,
1859	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1885	
1886	        channel = self.make_request(
1887	            "GET",
1888	            "/_matrix/client/v1/media/download/remote.org/abcd",
1889	            shorthand=False,
1890	            access_token=self.tok,
1891	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1907
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1906	        # test with a text file
1907	        channel = self.make_request(
1908	            "GET",
1909	            f"/_matrix/client/v1/media/download/test/{content_uri.media_id}",
1910	            shorthand=False,
1911	            access_token=self.tok,
1912	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1964	                data, response = r
1965	                output_stream.write(data)
1966	                return response

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1969	                f.trap(HttpResponseException)
1970	                output_stream.write(f.value.response)
1971	                return f

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:1999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1998	                data, response = r
1999	                output_stream.write(data)
2000	                return response

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2003	                f.trap(HttpResponseException)
2004	                output_stream.write(f.value.response)
2005	                return f

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2052	    ) -> FakeChannel:
2053	        channel = self.make_request(
2054	            "GET",
2055	            f"/_matrix/client/v1/media/download/{self.remote}/{self.media_id}",
2056	            shorthand=False,
2057	            await_result=False,
2058	            access_token=self.tok,
2059	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2195	        """
2196	        channel = self.make_request(
2197	            "GET",
2198	            f"/_matrix/client/v1/media/download/{self.remote}/{self.media_id}",
2199	            shorthand=False,
2200	            await_result=False,
2201	            access_token=self.tok,
2202	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2311	        params = "?width=32&height=32&method=scale"
2312	        channel = self.make_request(
2313	            "GET",
2314	            f"/_matrix/client/v1/media/thumbnail/{self.remote}/{self.media_id}{params}",
2315	            shorthand=False,
2316	            await_result=False,
2317	            access_token=self.tok,
2318	        )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2339	        )
2340	        shutil.rmtree(thumbnail_dir, ignore_errors=True)
2341	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2341	
2342	        channel = self.make_request(
2343	            "GET",
2344	            f"/_matrix/client/v1/media/thumbnail/{self.remote}/{self.media_id}{params}",
2345	            shorthand=False,
2346	            await_result=False,
2347	            access_token=self.tok,
2348	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2378	        params = "?width=32&height=32&method=" + method
2379	        channel = self.make_request(
2380	            "GET",
2381	            f"/_matrix/client/v1/media/thumbnail/{self.remote}/{self.media_id}{params}",
2382	            shorthand=False,
2383	            await_result=False,
2384	            access_token=self.tok,
2385	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2526	        # upload some local media with authentication on
2527	        channel = self.make_request(
2528	            "POST",
2529	            "_matrix/media/v3/upload?filename=test_png_upload",
2530	            SMALL_PNG,
2531	            self.tok,
2532	            shorthand=False,
2533	            content_type=b"image/png",
2534	            custom_headers=[("Content-Length", str(67))],
2535	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2541	        # request media over authenticated endpoint, should be found
2542	        channel2 = self.make_request(
2543	            "GET",
2544	            f"_matrix/client/v1/media/download/{uri}",
2545	            access_token=self.tok,
2546	            shorthand=False,
2547	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2550	        # request same media over unauthenticated media, should raise 404 not found
2551	        channel3 = self.make_request(
2552	            "GET", f"_matrix/media/v3/download/{uri}", shorthand=False
2553	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2557	        params = "?width=32&height=32&method=crop"
2558	        channel4 = self.make_request(
2559	            "GET",
2560	            f"/_matrix/client/v1/media/thumbnail/{uri}{params}",
2561	            shorthand=False,
2562	            access_token=self.tok,
2563	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2566	        params = "?width=32&height=32&method=crop"
2567	        channel5 = self.make_request(
2568	            "GET",
2569	            f"/_matrix/media/r0/thumbnail/{uri}{params}",
2570	            shorthand=False,
2571	            access_token=self.tok,
2572	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2582	        (f, fname) = self.get_success(ctx.__aenter__())
2583	        f.write(SMALL_PNG)
2584	        self.get_success(ctx.__aexit__(None, None, None))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2608	
2609	        channel6 = self.make_request(
2610	            "GET",
2611	            "_matrix/client/v1/media/download/lonelyIsland/52",
2612	            access_token=self.tok,
2613	            shorthand=False,
2614	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2616	
2617	        channel7 = self.make_request(
2618	            "GET", f"_matrix/media/v3/download/{uri}", shorthand=False
2619	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2622	        params = "?width=32&height=32&method=crop"
2623	        channel8 = self.make_request(
2624	            "GET",
2625	            f"/_matrix/client/v1/media/thumbnail/lonelyIsland/52{params}",
2626	            shorthand=False,
2627	            access_token=self.tok,
2628	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2630	
2631	        channel9 = self.make_request(
2632	            "GET",
2633	            f"/_matrix/media/r0/thumbnail/lonelyIsland/52{params}",
2634	            shorthand=False,
2635	            access_token=self.tok,
2636	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2644	        (f, fname) = self.get_success(ctx.__aenter__())
2645	        f.write(SMALL_PNG)
2646	        self.get_success(ctx.__aexit__(None, None, None))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2665	        # check that unauthenticated media is still available over both endpoints
2666	        channel9 = self.make_request(
2667	            "GET",
2668	            "/_matrix/client/v1/media/download/test/abcdefg123456",
2669	            shorthand=False,
2670	            access_token=self.tok,
2671	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2673	
2674	        channel10 = self.make_request(
2675	            "GET",
2676	            "/_matrix/media/r0/download/test/abcdefg123456",
2677	            shorthand=False,
2678	            access_token=self.tok,
2679	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2686	        # upload some local media with authentication on
2687	        channel = self.make_request(
2688	            "POST",
2689	            "_matrix/media/v3/upload?filename=test_png_upload",
2690	            SMALL_PNG,
2691	            self.tok,
2692	            shorthand=False,
2693	            content_type=b"image/png",
2694	            custom_headers=[("Content-Length", str(67))],
2695	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2715	        (f, fname) = self.get_success(ctx.__aenter__())
2716	        f.write(SMALL_PNG)
2717	        self.get_success(ctx.__aexit__(None, None, None))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2756	        # Request media over authenticated endpoint, should be found
2757	        channel1 = self.make_request(
2758	            "GET",
2759	            f"/_matrix/client/v1/media{path}",
2760	            access_token=self.tok,
2761	            shorthand=False,
2762	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2772	        # Refetching with the etag should result in 304 and empty body.
2773	        channel2 = self.make_request(
2774	            "GET",
2775	            f"/_matrix/client/v1/media{path}",
2776	            access_token=self.tok,
2777	            shorthand=False,
2778	            custom_headers=[("If-None-Match", etag)],
2779	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_media.py:2785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2784	        # Refetching with the etag but no access token should result in 404.
2785	        channel3 = self.make_request(
2786	            "GET",
2787	            f"/_matrix/media/r0{path}",
2788	            shorthand=False,
2789	            custom_headers=[("If-None-Match", etag)],
2790	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_password_policy.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
81	
82	        channel = self.make_request("GET", "/_matrix/client/r0/password_policy")
83	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_password_policy.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
98	        request_data = {"username": "kermit", "password": "shorty"}
99	        channel = self.make_request("POST", self.register_url, request_data)
100	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_password_policy.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
109	        request_data = {"username": "kermit", "password": "longerpassword"}
110	        channel = self.make_request("POST", self.register_url, request_data)
111	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_password_policy.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
120	        request_data = {"username": "kermit", "password": "l0ngerpassword"}
121	        channel = self.make_request("POST", self.register_url, request_data)
122	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_password_policy.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
131	        request_data = {"username": "kermit", "password": "l0ngerpassword!"}
132	        channel = self.make_request("POST", self.register_url, request_data)
133	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_password_policy.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
142	        request_data = {"username": "kermit", "password": "L0NGERPASSWORD!"}
143	        channel = self.make_request("POST", self.register_url, request_data)
144	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_password_policy.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
153	        request_data = {"username": "kermit", "password": "L0ngerpassword!"}
154	        channel = self.make_request("POST", self.register_url, request_data)
155	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_password_policy.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
177	        }
178	        channel = self.make_request(
179	            "POST",
180	            "/_matrix/client/r0/account/password",
181	            request_data,
182	            access_token=tok,
183	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_presence.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
62	        body = {"presence": "here", "status_msg": "beep boop"}
63	        channel = self.make_request(
64	            "PUT", "/presence/%s/status" % (self.user_id,), body
65	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_presence.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
77	        body = {"presence": "here", "status_msg": "beep boop"}
78	        channel = self.make_request(
79	            "PUT", "/presence/%s/status" % (self.user_id,), body
80	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_presence.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
92	        body = {"presence": "here", "status_msg": "beep boop"}
93	        channel = self.make_request(
94	            "PUT", "/presence/%s/status" % (self.user_id,), body
95	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_presence.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
109	        body = {"presence": "here", "status_msg": "beep boop"}
110	        channel = self.make_request(
111	            "PUT", "/presence/%s/status" % (self.user_id,), body
112	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_presence.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
116	        body = {"presence": "here", "status_msg": "beep boop"}
117	        channel = self.make_request(
118	            "PUT", "/presence/%s/status" % (self.user_id,), body
119	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_presence.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
133	        body = {"presence": "here", "status_msg": "beep boop"}
134	        channel = self.make_request(
135	            "PUT", "/presence/%s/status" % (self.user_id,), body
136	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_presence.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
143	        body = {"presence": "here", "status_msg": "beep boop"}
144	        channel = self.make_request(
145	            "PUT", "/presence/%s/status" % (self.user_id,), body
146	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
65	    def test_get_displayname_rejects_bad_username(self) -> None:
66	        channel = self.make_request(
67	            "GET", f"/profile/{urllib.parse.quote('@alice:')}/displayname"
68	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
71	    def test_set_displayname(self) -> None:
72	        channel = self.make_request(
73	            "PUT",
74	            "/profile/%s/displayname" % (self.owner,),
75	            content={"displayname": "test"},
76	            access_token=self.owner_tok,
77	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
83	    def test_set_displayname_with_extra_spaces(self) -> None:
84	        channel = self.make_request(
85	            "PUT",
86	            "/profile/%s/displayname" % (self.owner,),
87	            content={"displayname": "  test  "},
88	            access_token=self.owner_tok,
89	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
95	    def test_set_displayname_noauth(self) -> None:
96	        channel = self.make_request(
97	            "PUT",
98	            "/profile/%s/displayname" % (self.owner,),
99	            content={"displayname": "test"},
100	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
104	        """Attempts to set a stupid displayname should get a 400"""
105	        channel = self.make_request(
106	            "PUT",
107	            "/profile/%s/displayname" % (self.owner,),
108	            content={"displayname": "test" * 100},
109	            access_token=self.owner_tok,
110	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
120	    def test_set_displayname_other(self) -> None:
121	        channel = self.make_request(
122	            "PUT",
123	            "/profile/%s/displayname" % (self.other,),
124	            content={"displayname": "test"},
125	            access_token=self.owner_tok,
126	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
133	    def test_set_avatar_url(self) -> None:
134	        channel = self.make_request(
135	            "PUT",
136	            "/profile/%s/avatar_url" % (self.owner,),
137	            content={"avatar_url": "http://my.server/pic.gif"},
138	            access_token=self.owner_tok,
139	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	            "/profile/%s/avatar_url" % (self.owner,),
137	            content={"avatar_url": "http://my.server/pic.gif"},
138	            access_token=self.owner_tok,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
142	        res = self._get_avatar_url()
143	        self.assertEqual(res, "http://my.server/pic.gif")
144	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
145	    def test_set_avatar_url_noauth(self) -> None:
146	        channel = self.make_request(
147	            "PUT",
148	            "/profile/%s/avatar_url" % (self.owner,),
149	            content={"avatar_url": "http://my.server/pic.gif"},
150	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	            "/profile/%s/avatar_url" % (self.owner,),
149	            content={"avatar_url": "http://my.server/pic.gif"},
150	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
154	        """Attempts to set a stupid avatar_url should get a 400"""
155	        channel = self.make_request(
156	            "PUT",
157	            "/profile/%s/avatar_url" % (self.owner,),
158	            content={"avatar_url": "http://my.server/pic.gif" * 100},
159	            access_token=self.owner_tok,
160	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	            "/profile/%s/avatar_url" % (self.owner,),
158	            content={"avatar_url": "http://my.server/pic.gif" * 100},
159	            access_token=self.owner_tok,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
170	    def test_set_avatar_url_other(self) -> None:
171	        channel = self.make_request(
172	            "PUT",
173	            "/profile/%s/avatar_url" % (self.other,),
174	            content={"avatar_url": "http://my.server/pic.gif"},
175	            access_token=self.owner_tok,
176	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	            "/profile/%s/avatar_url" % (self.other,),
174	            content={"avatar_url": "http://my.server/pic.gif"},
175	            access_token=self.owner_tok,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
179	    def _get_displayname(self, name: Optional[str] = None) -> Optional[str]:
180	        channel = self.make_request(
181	            "GET", "/profile/%s/displayname" % (name or self.owner,)
182	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
189	    def _get_avatar_url(self, name: Optional[str] = None) -> Optional[str]:
190	        channel = self.make_request(
191	            "GET", "/profile/%s/avatar_url" % (name or self.owner,)
192	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
210	
211	        channel = self.make_request(
212	            "PUT",
213	            f"/profile/{self.owner}/avatar_url",
214	            content={"avatar_url": "mxc://test/big"},
215	            access_token=self.owner_tok,
216	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
221	
222	        channel = self.make_request(
223	            "PUT",
224	            f"/profile/{self.owner}/avatar_url",
225	            content={"avatar_url": "mxc://test/small"},
226	            access_token=self.owner_tok,
227	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
243	
244	        channel = self.make_request(
245	            "PUT",
246	            f"/rooms/{room_id}/state/m.room.member/{self.owner}",
247	            content={"membership": "join", "avatar_url": "mxc://test/big"},
248	            access_token=self.owner_tok,
249	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
254	
255	        channel = self.make_request(
256	            "PUT",
257	            f"/rooms/{room_id}/state/m.room.member/{self.owner}",
258	            content={"membership": "join", "avatar_url": "mxc://test/small"},
259	            access_token=self.owner_tok,
260	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
274	
275	        channel = self.make_request(
276	            "PUT",
277	            f"/profile/{self.owner}/avatar_url",
278	            content={"avatar_url": "mxc://test/bad"},
279	            access_token=self.owner_tok,
280	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
285	
286	        channel = self.make_request(
287	            "PUT",
288	            f"/profile/{self.owner}/avatar_url",
289	            content={"avatar_url": "mxc://test/good"},
290	            access_token=self.owner_tok,
291	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
307	
308	        channel = self.make_request(
309	            "PUT",
310	            f"/rooms/{room_id}/state/m.room.member/{self.owner}",
311	            content={"membership": "join", "avatar_url": "mxc://test/bad"},
312	            access_token=self.owner_tok,
313	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
318	
319	        channel = self.make_request(
320	            "PUT",
321	            f"/rooms/{room_id}/state/m.room.member/{self.owner}",
322	            content={"membership": "join", "avatar_url": "mxc://test/good"},
323	            access_token=self.owner_tok,
324	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
334	
335	            channel = self.make_request(
336	                "PUT",
337	                f"/rooms/{room_id}/state/m.room.member/{self.owner}",
338	                content={"membership": "join", prop: "mxc://my.server/existing"},
339	                access_token=self.owner_tok,
340	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
342	
343	            channel = self.make_request(
344	                "PUT",
345	                f"/profile/{self.owner}/{prop}?org.matrix.msc4069.propagate=false",
346	                content={prop: "http://my.server/pic.gif"},
347	                access_token=self.owner_tok,
348	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
345	                f"/profile/{self.owner}/{prop}?org.matrix.msc4069.propagate=false",
346	                content={prop: "http://my.server/pic.gif"},
347	                access_token=self.owner_tok,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
355	            )
356	            self.assertEqual(res, "http://my.server/pic.gif")
357	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
357	
358	            channel = self.make_request(
359	                "GET",
360	                f"/rooms/{room_id}/state/m.room.member/{self.owner}",
361	                access_token=self.owner_tok,
362	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
372	
373	            channel = self.make_request(
374	                "PUT",
375	                f"/rooms/{room_id}/state/m.room.member/{self.owner}",
376	                content={"membership": "join", prop: "mxc://my.server/existing"},
377	                access_token=self.owner_tok,
378	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
380	
381	            channel = self.make_request(
382	                "PUT",
383	                f"/profile/{self.owner}/{prop}?org.matrix.msc4069.propagate=false",
384	                content={prop: "http://my.server/pic.gif"},
385	                access_token=self.owner_tok,
386	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
383	                f"/profile/{self.owner}/{prop}?org.matrix.msc4069.propagate=false",
384	                content={prop: "http://my.server/pic.gif"},
385	                access_token=self.owner_tok,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
393	            )
394	            self.assertEqual(res, "http://my.server/pic.gif")
395	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
395	
396	            channel = self.make_request(
397	                "GET",
398	                f"/rooms/{room_id}/state/m.room.member/{self.owner}",
399	                access_token=self.owner_tok,
400	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
404	            # isn't enabled.
405	            self.assertEqual(channel.json_body.get(prop), "http://my.server/pic.gif")
406	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
411	
412	            channel = self.make_request(
413	                "PUT",
414	                f"/rooms/{room_id}/state/m.room.member/{self.owner}",
415	                content={"membership": "join", prop: "mxc://my.server/existing"},
416	                access_token=self.owner_tok,
417	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
419	
420	            channel = self.make_request(
421	                "PUT",
422	                f"/profile/{self.owner}/{prop}",
423	                content={prop: "http://my.server/pic.gif"},
424	                access_token=self.owner_tok,
425	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
422	                f"/profile/{self.owner}/{prop}",
423	                content={prop: "http://my.server/pic.gif"},
424	                access_token=self.owner_tok,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
432	            )
433	            self.assertEqual(res, "http://my.server/pic.gif")
434	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
434	
435	            channel = self.make_request(
436	                "GET",
437	                f"/rooms/{room_id}/state/m.room.member/{self.owner}",
438	                access_token=self.owner_tok,
439	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
443	            # isn't enabled.
444	            self.assertEqual(channel.json_body.get(prop), "http://my.server/pic.gif")
445	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
453	
454	            channel = self.make_request(
455	                "PUT",
456	                f"/rooms/{room_id}/state/m.room.member/{self.owner}",
457	                content={"membership": "join", prop: "mxc://my.server/existing"},
458	                access_token=self.owner_tok,
459	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
461	
462	            channel = self.make_request(
463	                "PUT",
464	                f"/profile/{self.owner}/{prop}?org.matrix.msc4069.propagate=true",
465	                content={prop: "http://my.server/pic.gif"},
466	                access_token=self.owner_tok,
467	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
464	                f"/profile/{self.owner}/{prop}?org.matrix.msc4069.propagate=true",
465	                content={prop: "http://my.server/pic.gif"},
466	                access_token=self.owner_tok,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
474	            )
475	            self.assertEqual(res, "http://my.server/pic.gif")
476	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
476	
477	            channel = self.make_request(
478	                "GET",
479	                f"/rooms/{room_id}/state/m.room.member/{self.owner}",
480	                access_token=self.owner_tok,
481	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
484	            # The client requested ?propagate=true, so it should have happened.
485	            self.assertEqual(channel.json_body.get(prop), "http://my.server/pic.gif")
486	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
488	    def test_get_missing_custom_field(self) -> None:
489	        channel = self.make_request(
490	            "GET",
491	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/custom_field",
492	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
497	    def test_get_missing_custom_field_invalid_field_name(self) -> None:
498	        channel = self.make_request(
499	            "GET",
500	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/[custom_field]",
501	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
506	    def test_get_custom_field_rejects_bad_username(self) -> None:
507	        channel = self.make_request(
508	            "GET",
509	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{urllib.parse.quote('@alice:')}/custom_field",
510	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
515	    def test_set_custom_field(self) -> None:
516	        channel = self.make_request(
517	            "PUT",
518	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/custom_field",
519	            content={"custom_field": "test"},
520	            access_token=self.owner_tok,
521	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
523	
524	        channel = self.make_request(
525	            "GET",
526	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/custom_field",
527	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
531	        # Overwriting the field should work.
532	        channel = self.make_request(
533	            "PUT",
534	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/custom_field",
535	            content={"custom_field": "new_Value"},
536	            access_token=self.owner_tok,
537	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
539	
540	        channel = self.make_request(
541	            "GET",
542	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/custom_field",
543	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
547	        # Deleting the field should work.
548	        channel = self.make_request(
549	            "DELETE",
550	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/custom_field",
551	            content={},
552	            access_token=self.owner_tok,
553	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
555	
556	        channel = self.make_request(
557	            "GET",
558	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/custom_field",
559	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
574	        for key, value in fields.items():
575	            channel = self.make_request(
576	                "PUT",
577	                f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/{key}",
578	                content={key: value},
579	                access_token=self.owner_tok,
580	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
582	
583	        channel = self.make_request(
584	            "GET",
585	            f"/_matrix/client/v3/profile/{self.owner}",
586	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
591	        for key, value in fields.items():
592	            channel = self.make_request(
593	                "GET",
594	                f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/{key}",
595	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
600	    def test_set_custom_field_noauth(self) -> None:
601	        channel = self.make_request(
602	            "PUT",
603	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/custom_field",
604	            content={"custom_field": "test"},
605	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
614	        # Key is missing.
615	        channel = self.make_request(
616	            "PUT",
617	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/",
618	            content={"": "test"},
619	            access_token=self.owner_tok,
620	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
625	        key = "c" * 500
626	        channel = self.make_request(
627	            "PUT",
628	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/{key}",
629	            content={key: "test"},
630	            access_token=self.owner_tok,
631	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
634	
635	        channel = self.make_request(
636	            "DELETE",
637	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/{key}",
638	            content={key: "test"},
639	            access_token=self.owner_tok,
640	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
644	        # Key doesn't match body.
645	        channel = self.make_request(
646	            "PUT",
647	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/custom_field",
648	            content={"diff_key": "test"},
649	            access_token=self.owner_tok,
650	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
664	        key = "a"
665	        channel = self.make_request(
666	            "PUT",
667	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/{key}",
668	            content={key: "a" * 65498},
669	            access_token=self.owner_tok,
670	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
673	        # Get the entire profile.
674	        channel = self.make_request(
675	            "GET",
676	            f"/_matrix/client/v3/profile/{self.owner}",
677	            access_token=self.owner_tok,
678	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
692	        key = "b"
693	        channel = self.make_request(
694	            "PUT",
695	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/{key}",
696	            content={key: "1" + "a" * ADDITIONAL_CHARS},
697	            access_token=self.owner_tok,
698	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
702	        # Setting an avatar or (longer) display name should not work.
703	        channel = self.make_request(
704	            "PUT",
705	            f"/profile/{self.owner}/displayname",
706	            content={"displayname": "owner12345678" + "a" * ADDITIONAL_CHARS},
707	            access_token=self.owner_tok,
708	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
711	
712	        channel = self.make_request(
713	            "PUT",
714	            f"/profile/{self.owner}/avatar_url",
715	            content={"avatar_url": "mxc://foo/bar"},
716	            access_token=self.owner_tok,
717	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
722	        key = "b"
723	        channel = self.make_request(
724	            "PUT",
725	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/{key}",
726	            content={key: "" + "a" * ADDITIONAL_CHARS},
727	            access_token=self.owner_tok,
728	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
732	        key = "a"
733	        channel = self.make_request(
734	            "PUT",
735	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/{key}",
736	            content={key: ""},
737	            access_token=self.owner_tok,
738	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
742	    def test_set_custom_field_displayname(self) -> None:
743	        channel = self.make_request(
744	            "PUT",
745	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/displayname",
746	            content={"displayname": "test"},
747	            access_token=self.owner_tok,
748	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
755	    def test_set_custom_field_avatar_url(self) -> None:
756	        channel = self.make_request(
757	            "PUT",
758	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.owner}/avatar_url",
759	            content={"avatar_url": "mxc://test/good"},
760	            access_token=self.owner_tok,
761	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
769	        """Setting someone else's profile field should fail"""
770	        channel = self.make_request(
771	            "PUT",
772	            f"/_matrix/client/unstable/uk.tcpip.msc4133/profile/{self.other}/custom_field",
773	            content={"custom_field": "test"},
774	            access_token=self.owner_tok,
775	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
864	    ) -> None:
865	        channel = self.make_request(
866	            "GET", self.profile_url + url_suffix, access_token=access_token
867	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
905	        """
906	        channel = self.make_request(
907	            "GET", "/profile/" + self.requester, access_token=self.requester_tok
908	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
910	
911	        channel = self.make_request(
912	            "GET",
913	            "/profile/" + self.requester + "/displayname",
914	            access_token=self.requester_tok,
915	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_profile.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
917	
918	        channel = self.make_request(
919	            "GET",
920	            "/profile/" + self.requester + "/avatar_url",
921	            access_token=self.requester_tok,
922	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
67	        # Send a read receipt
68	        channel = self.make_request(
69	            "POST",
70	            f"/rooms/{self.room_id}/receipt/{ReceiptTypes.READ}/{res['event_id']}",
71	            {},
72	            access_token=self.tok2,
73	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
79	        # Attempt to send a receipt to an unknown room.
80	        channel = self.make_request(
81	            "POST",
82	            "/rooms/!abc:beep/receipt/m.read/$def",
83	            content={},
84	            access_token=self.tok2,
85	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
89	        # Attempt to send a receipt to an unknown event.
90	        channel = self.make_request(
91	            "POST",
92	            f"/rooms/{self.room_id}/receipt/m.read/$def",
93	            content={},
94	            access_token=self.tok2,
95	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
119	        # Attempt to send a receipt from the wrong user.
120	        channel = self.make_request(
121	            "POST",
122	            f"/rooms/{room_id}/receipt/{ReceiptTypes.READ}/{res['event_id']}",
123	            content={},
124	            access_token=self.tok2,
125	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
131	
132	        channel = self.make_request(
133	            "POST",
134	            f"/rooms/{room_id}/receipt/{ReceiptTypes.READ}/{res['event_id']}",
135	            content={},
136	            access_token=self.tok2,
137	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
140	    def test_send_receipt_invalid_room_id(self) -> None:
141	        channel = self.make_request(
142	            "POST",
143	            "/rooms/not-a-room-id/receipt/m.read/$def",
144	            content={},
145	            access_token=self.tok,
146	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
152	    def test_send_receipt_invalid_event_id(self) -> None:
153	        channel = self.make_request(
154	            "POST",
155	            "/rooms/!abc:beep/receipt/m.read/not-an-event-id",
156	            content={},
157	            access_token=self.tok,
158	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
164	    def test_send_receipt_invalid_receipt_type(self) -> None:
165	        channel = self.make_request(
166	            "POST",
167	            "/rooms/!abc:beep/receipt/invalid-receipt-type/$def",
168	            content={},
169	            access_token=self.tok,
170	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
177	        # Send a private read receipt to tell the server the first user's message was read
178	        channel = self.make_request(
179	            "POST",
180	            f"/rooms/{self.room_id}/receipt/{ReceiptTypes.READ_PRIVATE}/{res['event_id']}",
181	            {},
182	            access_token=self.tok2,
183	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
197	        # Send a private read receipt
198	        channel = self.make_request(
199	            "POST",
200	            f"/rooms/{self.room_id}/receipt/{ReceiptTypes.READ_PRIVATE}/{res['event_id']}",
201	            {},
202	            access_token=self.tok2,
203	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
207	        # Send a public read receipt
208	        channel = self.make_request(
209	            "POST",
210	            f"/rooms/{self.room_id}/receipt/{ReceiptTypes.READ}/{res['event_id']}",
211	            {},
212	            access_token=self.tok2,
213	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
227	        # Send a public read receipt
228	        channel = self.make_request(
229	            "POST",
230	            f"/rooms/{self.room_id}/receipt/{ReceiptTypes.READ}/{res['event_id']}",
231	            {},
232	            access_token=self.tok2,
233	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
237	        # Send a private read receipt
238	        channel = self.make_request(
239	            "POST",
240	            f"/rooms/{self.room_id}/receipt/{ReceiptTypes.READ_PRIVATE}/{res['event_id']}",
241	            {},
242	            access_token=self.tok2,
243	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
253	        # Send a read receipt for this message with an empty body
254	        channel = self.make_request(
255	            "POST",
256	            f"/rooms/{self.room_id}/receipt/m.read/{res['event_id']}",
257	            access_token=self.tok2,
258	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_receipts.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
269	        # Sync
270	        channel = self.make_request(
271	            "GET",
272	            self.url % self.next_batch,
273	            access_token=self.tok,
274	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_register.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
626	        {
627	            "public_baseurl": "https://test_server",
628	            "enable_registration_captcha": True,
629	            "user_consent": {
630	                "version": "1",
631	                "template_dir": "/",
632	                "require_at_registration": True,
633	            },
634	            "account_threepid_delegates": {
635	                "msisdn": "https://id_server",
636	            },
637	            "email": {"notif_from": "Synapse <synapse@example.com>"},
638	        }
639	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_register.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
634	            "account_threepid_delegates": {
635	                "msisdn": "https://id_server",
636	            },
637	            "email": {"notif_from": "Synapse <synapse@example.com>"},
638	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_register.py:662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
661	        {
662	            "public_baseurl": "https://test_server",
663	            "registrations_require_3pid": ["email"],
664	            "disable_msisdn_registration": True,
665	            "email": {
666	                "smtp_host": "mail_server",
667	                "smtp_port": 2525,
668	                "notif_from": "sender@host",
669	            },
670	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_register.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
684	            "request_token_inhibit_3pid_errors": True,
685	            "public_baseurl": "https://test_server",
686	            "email": {
687	                "smtp_host": "mail_server",
688	                "smtp_port": 2525,
689	                "notif_from": "sender@host",
690	            },
691	        }
692	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_register.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
723	        {
724	            "public_baseurl": "https://test_server",
725	            "email": {
726	                "smtp_host": "mail_server",
727	                "smtp_port": 2525,
728	                "notif_from": "sender@host",
729	            },
730	        }

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_register.py:993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
992	            "notif_template_text": "notif_mail.txt",
993	            "smtp_host": "127.0.0.1",
994	            "smtp_port": 20,
995	            "require_transport_security": False,
996	            "smtp_user": None,
997	            "smtp_pass": None,
998	            "notif_from": "test@example.com",
999	        }
1000	
1001	        self.hs = self.setup_test_homeserver(config=config)
1002	
1003	        async def sendmail(*args: Any, **kwargs: Any) -> None:
1004	            self.email_attempts.append((args, kwargs))
1005	
1006	        self.email_attempts: List[Tuple[Any, Any]] = []
1007	        self.hs.get_send_email_handler()._sendmail = sendmail
1008	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rendezvous.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        self.assertEqual(channel.code, 307)
79	        self.assertEqual(channel.headers.getRawHeaders("Location"), ["https://asd"])
80	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rendezvous.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	            "experimental_features": {
64	                "msc4108_delegation_endpoint": "https://asd",
65	                "msc3861": {
66	                    "enabled": True,
67	                    "issuer": "https://issuer",
68	                    "client_id": "client_id",
69	                    "client_auth_method": "client_secret_post",
70	                    "client_secret": "client_secret",
71	                    "admin_token": "admin_token_value",
72	                },
73	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rendezvous.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	                    "enabled": True,
67	                    "issuer": "https://issuer",
68	                    "client_id": "client_id",
69	                    "client_auth_method": "client_secret_post",
70	                    "client_secret": "client_secret",
71	                    "admin_token": "admin_token_value",
72	                },
73	            },
74	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rendezvous.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	                    "enabled": True,
89	                    "issuer": "https://issuer",
90	                    "client_id": "client_id",
91	                    "client_auth_method": "client_secret_post",
92	                    "client_secret": "client_secret",
93	                    "admin_token": "admin_token_value",
94	                },
95	            },
96	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rendezvous.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
232	                    "enabled": True,
233	                    "issuer": "https://issuer",
234	                    "client_id": "client_id",
235	                    "client_auth_method": "client_secret_post",
236	                    "client_secret": "client_secret",
237	                    "admin_token": "admin_token_value",
238	                },
239	            },
240	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rendezvous.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
284	                    "enabled": True,
285	                    "issuer": "https://issuer",
286	                    "client_id": "client_id",
287	                    "client_auth_method": "client_secret_post",
288	                    "client_secret": "client_secret",
289	                    "admin_token": "admin_token_value",
290	                },
291	            },
292	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rendezvous.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
356	                    "enabled": True,
357	                    "issuer": "https://issuer",
358	                    "client_id": "client_id",
359	                    "client_auth_method": "client_secret_post",
360	                    "client_secret": "client_secret",
361	                    "admin_token": "admin_token_value",
362	                },
363	            },
364	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rendezvous.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
420	                    "enabled": True,
421	                    "issuer": "https://issuer",
422	                    "client_id": "client_id",
423	                    "client_auth_method": "client_secret_post",
424	                    "client_secret": "client_secret",
425	                    "admin_token": "admin_token_value",
426	                },
427	            },
428	        }

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
119	        ).encode("ascii")
120	        channel = self.make_request(
121	            "PUT", self.created_rmid_msg_path, b'{"msgtype":"m.text","body":"test msg"}'
122	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
125	        # set topic for public room
126	        channel = self.make_request(
127	            "PUT",
128	            ("rooms/%s/state/m.room.topic" % self.created_public_rmid).encode("ascii"),
129	            b'{"topic":"Public Room Topic"}',
130	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
147	        # send message in uncreated room, expect 403
148	        channel = self.make_request(
149	            "PUT",
150	            "/rooms/%s/send/m.room.message/mid2" % (self.uncreated_rmid,),
151	            msg_content,
152	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
155	        # send message in created room not joined (no state), expect 403
156	        channel = self.make_request("PUT", send_msg_path(), msg_content)
157	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
162	        )
163	        channel = self.make_request("PUT", send_msg_path(), msg_content)
164	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
167	        self.helper.join(room=self.created_rmid, user=self.user_id)
168	        channel = self.make_request("PUT", send_msg_path(), msg_content)
169	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
172	        self.helper.leave(room=self.created_rmid, user=self.user_id)
173	        channel = self.make_request("PUT", send_msg_path(), msg_content)
174	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
180	        # set/get topic in uncreated room, expect 403
181	        channel = self.make_request(
182	            "PUT", "/rooms/%s/state/m.room.topic" % self.uncreated_rmid, topic_content
183	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
184	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])
185	        channel = self.make_request(
186	            "GET", "/rooms/%s/state/m.room.topic" % self.uncreated_rmid
187	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
190	        # set/get topic in created PRIVATE room not joined, expect 403
191	        channel = self.make_request("PUT", topic_path, topic_content)
192	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
192	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])
193	        channel = self.make_request("GET", topic_path)
194	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
199	        )
200	        channel = self.make_request("PUT", topic_path, topic_content)
201	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
203	        # get topic in created PRIVATE room and invited, expect 403
204	        channel = self.make_request("GET", topic_path)
205	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
211	        self.helper.auth_user_id = self.rmcreator_id
212	        channel = self.make_request("PUT", topic_path, topic_content)
213	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
215	
216	        channel = self.make_request("GET", topic_path)
217	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
221	        self.helper.leave(room=self.created_rmid, user=self.user_id)
222	        channel = self.make_request("PUT", topic_path, topic_content)
223	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
223	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])
224	        channel = self.make_request("GET", topic_path)
225	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
227	        # get topic in PUBLIC room, not joined, expect 403
228	        channel = self.make_request(
229	            "GET", "/rooms/%s/state/m.room.topic" % self.created_public_rmid
230	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
233	        # set topic in PUBLIC room, not joined, expect 403
234	        channel = self.make_request(
235	            "PUT",
236	            "/rooms/%s/state/m.room.topic" % self.created_public_rmid,
237	            topic_content,
238	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
245	            path = "/rooms/%s/state/m.room.member/%s" % (room, member)
246	            channel = self.make_request("GET", path)
247	            self.assertEqual(expect_code, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
564	        room_id = self.helper.create_room_as(self.user_id)
565	        channel = self.make_request("GET", "/rooms/%s/members" % room_id)
566	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
568	    def test_get_member_list_no_room(self) -> None:
569	        channel = self.make_request("GET", "/rooms/roomdoesnotexist/members")
570	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
573	        room_id = self.helper.create_room_as("@some_other_guy:red")
574	        channel = self.make_request("GET", "/rooms/%s/members" % room_id)
575	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
584	        # first sync to get an at token
585	        channel = self.make_request("GET", "/sync")
586	        self.assertEqual(HTTPStatus.OK, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
590	        # memberships of @someone.else:red's room.
591	        channel = self.make_request(
592	            "GET",
593	            f"/rooms/{room_id}/members?at={sync_token}",
594	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
606	        # check that the user can see the member list to start with
607	        channel = self.make_request("GET", "/rooms/%s/members" % room_id)
608	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
613	        # check the user can no longer see the member list
614	        channel = self.make_request("GET", "/rooms/%s/members" % room_id)
615	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
627	        # sync to get an at token
628	        channel = self.make_request("GET", "/sync")
629	        self.assertEqual(HTTPStatus.OK, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
632	        # check that the user can see the member list to start with
633	        channel = self.make_request(
634	            "GET", "/rooms/%s/members?at=%s" % (room_id, sync_token)
635	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:647
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
646	        # now, with the original user, sync again to get a new at token
647	        channel = self.make_request("GET", "/sync")
648	        self.assertEqual(HTTPStatus.OK, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
651	        # check the user can no longer see the updated member list
652	        channel = self.make_request(
653	            "GET", "/rooms/%s/members?at=%s" % (room_id, sync_token)
654	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
662	        # can't see list if you're just invited.
663	        channel = self.make_request("GET", room_path)
664	        self.assertEqual(HTTPStatus.FORBIDDEN, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
667	        # can see list now joined
668	        channel = self.make_request("GET", room_path)
669	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
672	        # can see old list once left
673	        channel = self.make_request("GET", room_path)
674	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:706
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
705	        # first sync to get an at token
706	        channel = self.make_request("GET", "/sync")
707	        self.assertEqual(HTTPStatus.OK, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
739	        # POST with no config keys, expect new room id
740	        channel = self.make_request("POST", "/createRoom", "{}")
741	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
748	        # POST with initial_state config key, expect new room id
749	        channel = self.make_request(
750	            "POST",
751	            "/createRoom",
752	            b'{"initial_state":[{"type": "m.bridge", "content": {}}]}',
753	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
761	        # POST with visibility config key, expect new room id
762	        channel = self.make_request("POST", "/createRoom", b'{"visibility":"private"}')
763	        self.assertEqual(HTTPStatus.OK, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
767	        # POST with custom config keys, expect new room id
768	        channel = self.make_request("POST", "/createRoom", b'{"custom":"stuff"}')
769	        self.assertEqual(HTTPStatus.OK, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
773	        # POST with custom + known config keys, expect new room id
774	        channel = self.make_request(
775	            "POST", "/createRoom", b'{"visibility":"private","custom":"things"}'
776	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
781	        # POST with invalid content / paths, expect 400
782	        channel = self.make_request("POST", "/createRoom", b'{"visibili')
783	        self.assertEqual(HTTPStatus.BAD_REQUEST, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
784	
785	        channel = self.make_request("POST", "/createRoom", b'["hello"]')
786	        self.assertEqual(HTTPStatus.BAD_REQUEST, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
790	        # Note the trailing space in the MXID here!
791	        channel = self.make_request(
792	            "POST", "/createRoom", b'{"invite":["@alice:example.com "]}'
793	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
814	        # Test that the invites are correctly ratelimited.
815	        channel = self.make_request("POST", "/createRoom", content)
816	        self.assertEqual(HTTPStatus.BAD_REQUEST, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
827	        # Test that the invites aren't ratelimited anymore.
828	        channel = self.make_request("POST", "/createRoom", content)
829	        self.assertEqual(HTTPStatus.OK, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
849	
850	        channel = self.make_request(
851	            "POST",
852	            "/createRoom",
853	            {},
854	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
877	
878	        channel = self.make_request(
879	            "POST",
880	            "/createRoom",
881	            {},
882	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:898
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
897	
898	        channel = self.make_request(
899	            "POST",
900	            "/createRoom",
901	            {},
902	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
909	        """
910	        channel = self.make_request(
911	            "POST",
912	            "/createRoom",
913	            {},
914	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
954	        # missing keys or invalid json
955	        channel = self.make_request("PUT", self.path, "{}")
956	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
959	
960	        channel = self.make_request("PUT", self.path, '{"_name":"bo"}')
961	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
964	
965	        channel = self.make_request("PUT", self.path, '{"nao')
966	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
969	
970	        channel = self.make_request(
971	            "PUT", self.path, '[{"_name":"bo"},{"_name":"jill"}]'
972	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
976	
977	        channel = self.make_request("PUT", self.path, "text only")
978	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
981	
982	        channel = self.make_request("PUT", self.path, "")
983	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
988	        content = '{"topic":["Topic name"]}'
989	        channel = self.make_request("PUT", self.path, content)
990	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
995	        # nothing should be there
996	        channel = self.make_request("GET", self.path)
997	        self.assertEqual(HTTPStatus.NOT_FOUND, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1000	        content = '{"topic":"Topic name"}'
1001	        channel = self.make_request("PUT", self.path, content)
1002	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1004	        # valid get
1005	        channel = self.make_request("GET", self.path)
1006	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1012
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1011	        content = '{"topic":"Seasons","subtopic":"Summer"}'
1012	        channel = self.make_request("PUT", self.path, content)
1013	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1016
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1015	        # valid get
1016	        channel = self.make_request("GET", self.path)
1017	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1032
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1031	        # missing keys or invalid json
1032	        channel = self.make_request("PUT", path, "{}")
1033	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1037
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1036	
1037	        channel = self.make_request("PUT", path, '{"_name":"bo"}')
1038	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1041	
1042	        channel = self.make_request("PUT", path, '{"nao')
1043	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1047
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1046	
1047	        channel = self.make_request("PUT", path, b'[{"_name":"bo"},{"_name":"jill"}]')
1048	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1052
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1051	
1052	        channel = self.make_request("PUT", path, "text only")
1053	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1057
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1056	
1057	        channel = self.make_request("PUT", path, "")
1058	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1067	        )
1068	        channel = self.make_request("PUT", path, content.encode("ascii"))
1069	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1080	        content = '{"membership":"%s"}' % Membership.JOIN
1081	        channel = self.make_request("PUT", path, content.encode("ascii"))
1082	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1084
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1083	
1084	        channel = self.make_request("GET", path, content=b"")
1085	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1098	        content = '{"membership":"%s"}' % Membership.INVITE
1099	        channel = self.make_request("PUT", path, content)
1100	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1101	
1102	        channel = self.make_request("GET", path, content=b"")
1103	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1117	        )
1118	        channel = self.make_request("PUT", path, content)
1119	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1120	
1121	        channel = self.make_request("GET", path, content=b"")
1122	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1335	
1336	        channel = self.make_request(
1337	            "POST", f"/join/{self.room1}", access_token=self.tok2
1338	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1341	
1342	        channel = self.make_request(
1343	            "POST", f"/rooms/{self.room1}/join", access_token=self.tok2
1344	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1351	
1352	        channel = self.make_request(
1353	            "POST",
1354	            f"/_matrix/client/v3/knock/{self.room1}",
1355	            access_token=self.tok2,
1356	            content={},
1357	            shorthand=False,
1358	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1366	        # first user invites second user
1367	        channel = self.make_request(
1368	            "POST",
1369	            f"/rooms/{self.room1}/invite",
1370	            access_token=self.tok1,
1371	            content={"user_id": self.user2},
1372	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1375	    def test_suspended_user_can_leave_room(self) -> None:
1376	        channel = self.make_request(
1377	            "POST", f"/join/{self.room1}", access_token=self.tok1
1378	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1384	        # leave room
1385	        channel = self.make_request(
1386	            "POST",
1387	            f"/rooms/{self.room1}/leave",
1388	            access_token=self.tok1,
1389	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1409	        }
1410	        channel = self.make_request(
1411	            "POST",
1412	            f"/_matrix/client/r0/createRoom?{urlparse.urlencode(args)}",
1413	            content={"visibility": "public"},
1414	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1447	        }
1448	        channel = self.make_request(
1449	            "PUT",
1450	            path=f"/_matrix/client/r0/rooms/{self.room}/send/m.room.message/1234?"
1451	            + urlparse.urlencode(url_params),
1452	            content={"body": "test", "msgtype": "m.text"},
1453	            access_token=self.appservice.token,
1454	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1469	        }
1470	        channel = self.make_request(
1471	            "PUT",
1472	            path=f"/_matrix/client/r0/rooms/{self.room}/state/m.room.name?"
1473	            + urlparse.urlencode(url_params),
1474	            content={"name": "test"},
1475	            access_token=self.appservice.token,
1476	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1491	        }
1492	        channel = self.make_request(
1493	            "PUT",
1494	            path=f"/_matrix/client/r0/rooms/{self.room}/state/m.room.member/{self.appservice_user}?"
1495	            + urlparse.urlencode(url_params),
1496	            content={"membership": "join", "display_name": "test"},
1497	            access_token=self.appservice.token,
1498	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1588	        path = "/_matrix/client/r0/profile/%s/displayname" % self.user_id
1589	        channel = self.make_request("PUT", path, {"displayname": "John Doe"})
1590	        self.assertEqual(channel.code, HTTPStatus.OK, channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1598	
1599	            channel = self.make_request("GET", path)
1600	            self.assertEqual(channel.code, 200)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1622	            for _ in range(4):
1623	                channel = self.make_request("POST", path % room_id, {})
1624	                self.assertEqual(channel.code, 200)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1653	        # missing keys or invalid json
1654	        channel = self.make_request("PUT", path, b"{}")
1655	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1658	
1659	        channel = self.make_request("PUT", path, b'{"_name":"bo"}')
1660	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1663	
1664	        channel = self.make_request("PUT", path, b'{"nao')
1665	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1668	
1669	        channel = self.make_request("PUT", path, b'[{"_name":"bo"},{"_name":"jill"}]')
1670	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1673	
1674	        channel = self.make_request("PUT", path, b"text only")
1675	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1679
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1678	
1679	        channel = self.make_request("PUT", path, b"")
1680	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1687	        content = b'{"body":"test","msgtype":{"type":"a"}}'
1688	        channel = self.make_request("PUT", path, content)
1689	        self.assertEqual(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1694	        content = b'{"body":"test","msgtype":"test.custom.text"}'
1695	        channel = self.make_request("PUT", path, content)
1696	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1700	        content = b'{"body":"test2","msgtype":"m.text"}'
1701	        channel = self.make_request("PUT", path, content)
1702	        self.assertEqual(HTTPStatus.OK, channel.code, msg=channel.result["body"])

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1782	        content = '{"body":"%s","msgtype":"m.text"}' % body
1783	        channel = self.make_request("PUT", path, content)
1784	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1922	        )
1923	        channel = self.make_request("PUT", path, "{}")
1924	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1936	        )
1937	        channel = self.make_request("PUT", path, "{}")
1938	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1964
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1963	        )
1964	        channel = self.make_request("PUT", path, "{}")
1965	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:1992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1991	        )
1992	        channel = self.make_request("PUT", path, "{}")
1993	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2019	        )
2020	        channel = self.make_request("PUT", path, "{}")
2021	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2049	        )
2050	        channel = self.make_request("PUT", path, "{}")
2051	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2084
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2083	        # When I attempt to create an encrypted private_chat room
2084	        channel = self.make_request(
2085	            "POST",
2086	            "/createRoom",
2087	            '{"creation_content": {"m.federate": false},"name": "Secret Private Room","preset": "private_chat","initial_state": [{"type": "m.room.encryption","state_key": "","content": {"algorithm": "m.megolm.v1.aes-sha2"}}]}',
2088	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2108	    def test_initial_sync(self) -> None:
2109	        channel = self.make_request("GET", "/rooms/%s/initialSync" % self.room_id)
2110	        self.assertEqual(HTTPStatus.OK, channel.code)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2149	        token = "t1-0_0_0_0_0_0_0_0_0_0"
2150	        channel = self.make_request(
2151	            "GET", "/rooms/%s/messages?access_token=x&from=%s" % (self.room_id, token)
2152	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2160	        token = "s0_0_0_0_0_0_0_0_0_0"
2161	        channel = self.make_request(
2162	            "GET", "/rooms/%s/messages?access_token=x&from=%s" % (self.room_id, token)
2163	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2193	        # Check that we get the first and second message when querying /messages.
2194	        channel = self.make_request(
2195	            "GET",
2196	            "/rooms/%s/messages?access_token=x&from=%s&dir=b&filter=%s"
2197	            % (
2198	                self.room_id,
2199	                second_token_str,
2200	                json.dumps({"types": [EventTypes.Message]}),
2201	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2218	        # has been purged.
2219	        channel = self.make_request(
2220	            "GET",
2221	            "/rooms/%s/messages?access_token=x&from=%s&dir=b&filter=%s"
2222	            % (
2223	                self.room_id,
2224	                second_token_str,
2225	                json.dumps({"types": [EventTypes.Message]}),
2226	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2235	        # anymore.
2236	        channel = self.make_request(
2237	            "GET",
2238	            "/rooms/%s/messages?access_token=x&from=%s&dir=b&filter=%s"
2239	            % (
2240	                self.room_id,
2241	                first_token_str,
2242	                json.dumps({"types": [EventTypes.Message]}),
2243	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2255	        valid_filter_str = '{"types": ["m.room.message"]}'
2256	        channel = self.make_request(
2257	            "GET",
2258	            f"/rooms/{self.room_id}/messages?access_token=x&dir=b&filter={valid_filter_str}",
2259	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2264	        invalid_filter_str = "}}}{}"
2265	        channel = self.make_request(
2266	            "GET",
2267	            f"/rooms/{self.room_id}/messages?access_token=x&dir=b&filter={invalid_filter_str}",
2268	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2288	        self.helper.send(self.room_id, "not returned in filter")
2289	        channel = self.make_request(
2290	            "GET",
2291	            "/rooms/%s/messages?access_token=x&dir=b&filter=%s"
2292	            % (
2293	                self.room_id,
2294	                json.dumps({"types": ["f.message.*"]}),
2295	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2313	        """Test sending a delayed event with invalid content."""
2314	        channel = self.make_request(
2315	            "PUT",
2316	            (
2317	                "rooms/%s/send/m.room.message/mid1?org.matrix.msc4140.delay=2000"
2318	                % self.room_id
2319	            ).encode("ascii"),
2320	            {},
2321	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2326	        """Test that sending a delayed event is unsupported with the default config."""
2327	        channel = self.make_request(
2328	            "PUT",
2329	            (
2330	                "rooms/%s/send/m.room.message/mid1?org.matrix.msc4140.delay=2000"
2331	                % self.room_id
2332	            ).encode("ascii"),
2333	            {"body": "test", "msgtype": "m.text"},
2334	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2344	        """Test that sending a delayed event fails if its delay is longer than allowed."""
2345	        channel = self.make_request(
2346	            "PUT",
2347	            (
2348	                "rooms/%s/send/m.room.message/mid1?org.matrix.msc4140.delay=2000"
2349	                % self.room_id
2350	            ).encode("ascii"),
2351	            {"body": "test", "msgtype": "m.text"},
2352	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2362	        """Test that sending a delayed event fails if its delay is negative."""
2363	        channel = self.make_request(
2364	            "PUT",
2365	            (
2366	                "rooms/%s/send/m.room.message/mid1?org.matrix.msc4140.delay=-2000"
2367	                % self.room_id
2368	            ).encode("ascii"),
2369	            {"body": "test", "msgtype": "m.text"},
2370	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2378	        """Test sending a valid delayed message event."""
2379	        channel = self.make_request(
2380	            "PUT",
2381	            (
2382	                "rooms/%s/send/m.room.message/mid1?org.matrix.msc4140.delay=2000"
2383	                % self.room_id
2384	            ).encode("ascii"),
2385	            {"body": "test", "msgtype": "m.text"},
2386	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2391	        """Test sending a valid delayed state event."""
2392	        channel = self.make_request(
2393	            "PUT",
2394	            (
2395	                "rooms/%s/state/m.room.topic/?org.matrix.msc4140.delay=2000"
2396	                % self.room_id
2397	            ).encode("ascii"),
2398	            {"topic": "This is a topic"},
2399	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2422	        )
2423	        channel = self.make_request(*args)
2424	        self.assertEqual(HTTPStatus.OK, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2424	        self.assertEqual(HTTPStatus.OK, channel.code, channel.result)
2425	        channel = self.make_request(*args)
2426	        self.assertEqual(HTTPStatus.TOO_MANY_REQUESTS, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2433	        # Test that the new delayed events aren't ratelimited anymore.
2434	        channel = self.make_request(*args)
2435	        self.assertEqual(HTTPStatus.OK, channel.code, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2480	
2481	        channel = self.make_request(
2482	            "POST",
2483	            "/search?access_token=%s" % (self.access_token,),
2484	            {
2485	                "search_categories": {
2486	                    "room_events": {"keys": ["content.body"], "search_term": "Hi"}
2487	                }

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2509	
2510	        channel = self.make_request(
2511	            "POST",
2512	            "/search?access_token=%s" % (self.access_token,),
2513	            {
2514	                "search_categories": {
2515	                    "room_events": {
2516	                        "keys": ["content.body"],
2517	                        "search_term": "Hi",
2518	                        "event_context": {"include_profile": True},
2519	                    }

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2555	    def test_restricted_no_auth(self) -> None:
2556	        channel = self.make_request("GET", self.url)
2557	        self.assertEqual(channel.code, HTTPStatus.UNAUTHORIZED, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2562	
2563	        channel = self.make_request("GET", self.url, access_token=tok)
2564	        self.assertEqual(channel.code, HTTPStatus.OK, channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2617	
2618	        channel = self.make_request("POST", self.url, body, self.token)
2619	        self.assertEqual(channel.code, 200)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2628	    def test_returns_both_rooms_and_spaces_if_no_filter(self) -> None:
2629	        chunk, count = self.make_public_rooms_request(None)
2630	        self.assertEqual(count, 2)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2632	        # Also check if there's no filter property at all in the body.
2633	        channel = self.make_request("POST", self.url, {}, self.token)
2634	        self.assertEqual(channel.code, 200)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2637	
2638	        chunk, count = self.make_public_rooms_request(None, "test|test")
2639	        self.assertEqual(count, 0)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2641	    def test_returns_only_rooms_based_on_filter(self) -> None:
2642	        chunk, count = self.make_public_rooms_request([None])
2643	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2647
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2646	
2647	        chunk, count = self.make_public_rooms_request([None], "test|test")
2648	        self.assertEqual(count, 0)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2650	    def test_returns_only_space_based_on_filter(self) -> None:
2651	        chunk, count = self.make_public_rooms_request(["m.space"])
2652	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2655	
2656	        chunk, count = self.make_public_rooms_request(["m.space"], "test|test")
2657	        self.assertEqual(count, 0)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2659	    def test_returns_both_rooms_and_space_based_on_filter(self) -> None:
2660	        chunk, count = self.make_public_rooms_request(["m.space", None])
2661	        self.assertEqual(count, 2)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2662	
2663	        chunk, count = self.make_public_rooms_request(["m.space", None], "test|test")
2664	        self.assertEqual(count, 0)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2666	    def test_returns_both_rooms_and_spaces_if_array_is_empty(self) -> None:
2667	        chunk, count = self.make_public_rooms_request([])
2668	        self.assertEqual(count, 2)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2669	
2670	        chunk, count = self.make_public_rooms_request([], "test|test")
2671	        self.assertEqual(count, 0)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2699	
2700	        channel = self.make_request(
2701	            "POST",
2702	            b"/_matrix/client/r0/publicRooms?server=testserv",
2703	            content={"filter": search_filter},
2704	            access_token=self.token,
2705	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2728	
2729	        channel = self.make_request(
2730	            "POST",
2731	            b"/_matrix/client/r0/publicRooms?server=testserv",
2732	            content={"filter": search_filter},
2733	            access_token=self.token,
2734	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2780	        request_data = {"displayname": self.displayname}
2781	        channel = self.make_request(
2782	            "PUT",
2783	            "/_matrix/client/r0/profile/%s/displayname" % (self.user_id,),
2784	            request_data,
2785	            access_token=self.tok,
2786	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2792	        request_data = {"membership": "join", "displayname": "other test user"}
2793	        channel = self.make_request(
2794	            "PUT",
2795	            "/_matrix/client/r0/rooms/%s/state/m.room.member/%s"
2796	            % (self.room_id, self.user_id),
2797	            request_data,
2798	            access_token=self.tok,
2799	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2803
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2802	
2803	        channel = self.make_request(
2804	            "GET",
2805	            "/_matrix/client/r0/rooms/%s/event/%s" % (self.room_id, event_id),
2806	            access_token=self.tok,
2807	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2835	        reason = "hello"
2836	        channel = self.make_request(
2837	            "POST",
2838	            f"/_matrix/client/r0/rooms/{self.room_id}/join",
2839	            content={"reason": reason},
2840	            access_token=self.second_tok,
2841	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2849	        reason = "hello"
2850	        channel = self.make_request(
2851	            "POST",
2852	            f"/_matrix/client/r0/rooms/{self.room_id}/leave",
2853	            content={"reason": reason},
2854	            access_token=self.second_tok,
2855	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2863	        reason = "hello"
2864	        channel = self.make_request(
2865	            "POST",
2866	            f"/_matrix/client/r0/rooms/{self.room_id}/kick",
2867	            content={"reason": reason, "user_id": self.second_user_id},
2868	            access_token=self.second_tok,
2869	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2877	        reason = "hello"
2878	        channel = self.make_request(
2879	            "POST",
2880	            f"/_matrix/client/r0/rooms/{self.room_id}/ban",
2881	            content={"reason": reason, "user_id": self.second_user_id},
2882	            access_token=self.creator_tok,
2883	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2889	        reason = "hello"
2890	        channel = self.make_request(
2891	            "POST",
2892	            f"/_matrix/client/r0/rooms/{self.room_id}/unban",
2893	            content={"reason": reason, "user_id": self.second_user_id},
2894	            access_token=self.creator_tok,
2895	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2901	        reason = "hello"
2902	        channel = self.make_request(
2903	            "POST",
2904	            f"/_matrix/client/r0/rooms/{self.room_id}/invite",
2905	            content={"reason": reason, "user_id": self.second_user_id},
2906	            access_token=self.creator_tok,
2907	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2920	        reason = "hello"
2921	        channel = self.make_request(
2922	            "POST",
2923	            f"/_matrix/client/r0/rooms/{self.room_id}/leave",
2924	            content={"reason": reason},
2925	            access_token=self.second_tok,
2926	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:2932
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2931	    def _check_for_reason(self, reason: str) -> None:
2932	        channel = self.make_request(
2933	            "GET",
2934	            "/_matrix/client/r0/rooms/{}/state/m.room.member/{}".format(
2935	                self.room_id, self.second_user_id
2936	            ),
2937	            access_token=self.creator_tok,
2938	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3042	
3043	        channel = self.make_request(
3044	            "GET",
3045	            "/rooms/%s/context/%s?filter=%s"
3046	            % (self.room_id, event_id, json.dumps(self.FILTER_LABELS)),
3047	            access_token=self.tok,
3048	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3072	
3073	        channel = self.make_request(
3074	            "GET",
3075	            "/rooms/%s/context/%s?filter=%s"
3076	            % (self.room_id, event_id, json.dumps(self.FILTER_NOT_LABELS)),
3077	            access_token=self.tok,
3078	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3107	
3108	        channel = self.make_request(
3109	            "GET",
3110	            "/rooms/%s/context/%s?filter=%s"
3111	            % (self.room_id, event_id, json.dumps(self.FILTER_LABELS_NOT_LABELS)),
3112	            access_token=self.tok,
3113	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3135	        token = "s0_0_0_0_0_0_0_0_0_0"
3136	        channel = self.make_request(
3137	            "GET",
3138	            "/rooms/%s/messages?access_token=%s&from=%s&filter=%s"
3139	            % (self.room_id, self.tok, token, json.dumps(self.FILTER_LABELS)),
3140	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3152	        token = "s0_0_0_0_0_0_0_0_0_0"
3153	        channel = self.make_request(
3154	            "GET",
3155	            "/rooms/%s/messages?access_token=%s&from=%s&filter=%s"
3156	            % (self.room_id, self.tok, token, json.dumps(self.FILTER_NOT_LABELS)),
3157	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3175	        token = "s0_0_0_0_0_0_0_0_0_0"
3176	        channel = self.make_request(
3177	            "GET",
3178	            "/rooms/%s/messages?access_token=%s&from=%s&filter=%s"
3179	            % (
3180	                self.room_id,
3181	                self.tok,
3182	                token,
3183	                json.dumps(self.FILTER_LABELS_NOT_LABELS),
3184	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3204	
3205	        channel = self.make_request(
3206	            "POST", "/search?access_token=%s" % self.tok, request_data
3207	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3239	
3240	        channel = self.make_request(
3241	            "POST", "/search?access_token=%s" % self.tok, request_data
3242	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3286	
3287	        channel = self.make_request(
3288	            "POST", "/search?access_token=%s" % self.tok, request_data
3289	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3378	        )
3379	        channel = self.make_request(
3380	            "GET",
3381	            f"/rooms/{self.room_id}/messages?filter={json.dumps(filter)}&dir=f&from={from_token}",
3382	            access_token=self.tok,
3383	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3424	
3425	        channel = self.make_request(
3426	            "GET",
3427	            '/rooms/%s/context/%s?filter={"types":["m.room.message"]}'
3428	            % (self.room_id, event_id),
3429	            access_token=self.tok,
3430	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3490	
3491	        channel = self.make_request(
3492	            "GET",
3493	            '/rooms/%s/context/%s?filter={"types":["m.room.message"]}'
3494	            % (self.room_id, event_id),
3495	            access_token=invited_tok,
3496	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3521	        valid_filter_str = '{"types": ["m.room.message"]}'
3522	        channel = self.make_request(
3523	            "GET",
3524	            f"/rooms/{self.room_id}/context/{event_id}?filter={valid_filter_str}",
3525	            access_token=self.tok,
3526	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3530	        invalid_filter_str = "}}}{}"
3531	        channel = self.make_request(
3532	            "GET",
3533	            f"/rooms/{self.room_id}/context/{event_id}?filter={invalid_filter_str}",
3534	            access_token=self.tok,
3535	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3607	        """Calls the endpoint under test. returns the json response object."""
3608	        channel = self.make_request(
3609	            "GET",
3610	            "/_matrix/client/r0/rooms/%s/aliases" % (self.room_id,),
3611	            access_token=access_token,
3612	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3626	
3627	        channel = self.make_request(
3628	            "PUT", url, request_data, access_token=self.room_owner_tok
3629	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3655	
3656	        channel = self.make_request(
3657	            "PUT", url, request_data, access_token=self.room_owner_tok
3658	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3662	        """Calls the endpoint under test. returns the json response object."""
3663	        channel = self.make_request(
3664	            "GET",
3665	            "rooms/%s/state/m.room.canonical_alias" % (self.room_id,),
3666	            access_token=self.room_owner_tok,
3667	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3676	        """Calls the endpoint under test. returns the json response object."""
3677	        channel = self.make_request(
3678	            "PUT",
3679	            "rooms/%s/state/m.room.canonical_alias" % (self.room_id,),
3680	            content,
3681	            access_token=self.room_owner_tok,
3682	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3829	        email_to_invite = "teresa@example.com"
3830	        channel = self.make_request(
3831	            method="POST",
3832	            path="/rooms/" + self.room_id + "/invite",
3833	            content={
3834	                "id_server": "example.com",
3835	                "id_access_token": "sometoken",
3836	                "medium": "email",
3837	                "address": email_to_invite,
3838	            },
3839	            access_token=self.tok,
3840	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3851	        mock.return_value = False
3852	        channel = self.make_request(
3853	            method="POST",
3854	            path="/rooms/" + self.room_id + "/invite",
3855	            content={
3856	                "id_server": "example.com",
3857	                "id_access_token": "sometoken",
3858	                "medium": "email",
3859	                "address": email_to_invite,
3860	            },
3861	            access_token=self.tok,
3862	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3896	        email_to_invite = "teresa@example.com"
3897	        channel = self.make_request(
3898	            method="POST",
3899	            path="/rooms/" + self.room_id + "/invite",
3900	            content={
3901	                "id_server": "example.com",
3902	                "id_access_token": "sometoken",
3903	                "medium": "email",
3904	                "address": email_to_invite,
3905	            },
3906	            access_token=self.tok,
3907	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3919	        mock.return_value = Codes.CONSENT_NOT_GIVEN
3920	        channel = self.make_request(
3921	            method="POST",
3922	            path="/rooms/" + self.room_id + "/invite",
3923	            content={
3924	                "id_server": "example.com",
3925	                "id_access_token": "sometoken",
3926	                "medium": "email",
3927	                "address": email_to_invite,
3928	            },
3929	            access_token=self.tok,
3930	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3938	        mock.return_value = (Codes.EXPIRED_ACCOUNT, {"field": "value"})
3939	        channel = self.make_request(
3940	            method="POST",
3941	            path="/rooms/" + self.room_id + "/invite",
3942	            content={
3943	                "id_server": "example.com",
3944	                "id_access_token": "sometoken",
3945	                "medium": "email",
3946	                "address": email_to_invite,
3947	            },
3948	            access_token=self.tok,
3949	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:3962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
3961	        """
3962	        channel = self.make_request(
3963	            method="POST",
3964	            path="/rooms/" + self.room_id + "/invite",
3965	            content={
3966	                "id_server": "example.com",
3967	                "medium": "email",
3968	                "address": "teresa@example.com",
3969	            },
3970	            access_token=self.tok,
3971	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4024
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4023	
4024	        channel = self.make_request(
4025	            "GET",
4026	            f"/_matrix/client/v1/rooms/{room_id}/timestamp_to_event?dir=b&ts={outlier_event.origin_server_ts}",
4027	            access_token=self.room_owner_tok,
4028	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4071	
4072	        channel = self.make_request(
4073	            "PUT",
4074	            f"/rooms/{self.room1}/send/m.room.message/1",
4075	            access_token=self.tok1,
4076	            content={"body": "hello", "msgtype": "m.text"},
4077	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4080	    def test_suspended_user_cannot_send_message_to_encrypted_room(self) -> None:
4081	        channel = self.make_request(
4082	            "PUT",
4083	            f"/_synapse/admin/v1/suspend/{self.user1}",
4084	            {"suspend": True},
4085	            access_token=self.admin_tok,
4086	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4090
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4089	
4090	        channel = self.make_request(
4091	            "PUT",
4092	            f"/rooms/{self.room2}/send/m.room.encrypted/1",
4093	            access_token=self.tok1,
4094	            content={},
4095	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4101	
4102	        channel = self.make_request(
4103	            "PUT",
4104	            f"/_matrix/client/v3/profile/{self.user1}/avatar_url",
4105	            access_token=self.tok1,
4106	            content={"avatar_url": "mxc://matrix.org/wefh34uihSDRGhw34"},
4107	            shorthand=False,
4108	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4110	
4111	        channel2 = self.make_request(
4112	            "PUT",
4113	            f"/_matrix/client/v3/profile/{self.user1}/displayname",
4114	            access_token=self.tok1,
4115	            content={"displayname": "something offensive"},
4116	            shorthand=False,
4117	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4121	        # first user sends message
4122	        self.make_request("POST", f"/rooms/{self.room1}/join", access_token=self.tok2)
4123	        res = self.helper.send_event(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4131	        # second user sends message
4132	        self.make_request("POST", f"/rooms/{self.room1}/join", access_token=self.tok1)
4133	        res2 = self.helper.send_event(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4144	        # second user can't redact first user's message
4145	        channel = self.make_request(
4146	            "PUT",
4147	            f"/_matrix/client/v3/rooms/{self.room1}/redact/{event_id}/1",
4148	            access_token=self.tok1,
4149	            content={"reason": "bogus"},
4150	            shorthand=False,
4151	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4154	        # but can redact their own
4155	        channel = self.make_request(
4156	            "PUT",
4157	            f"/_matrix/client/v3/rooms/{self.room1}/redact/{event_id2}/1",
4158	            access_token=self.tok1,
4159	            content={"reason": "bogus"},
4160	            shorthand=False,
4161	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4163	
4164	        channel = self.make_request(
4165	            "PUT",
4166	            f"/_matrix/client/v3/rooms/{self.room1}/send/m.room.redaction/3456346",
4167	            access_token=self.tok1,
4168	            content={"reason": "bogus", "redacts": event_id},
4169	            shorthand=False,
4170	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4172	
4173	        channel = self.make_request(
4174	            "PUT",
4175	            f"/_matrix/client/v3/rooms/{self.room1}/send/m.room.redaction/3456346",
4176	            access_token=self.tok1,
4177	            content={"reason": "bogus", "redacts": event_id2},
4178	            shorthand=False,
4179	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4183	        # user to ban joins room user1 created
4184	        self.make_request("POST", f"/rooms/{self.room1}/join", access_token=self.tok2)
4185	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4189	        # user1 tries to ban other user while suspended
4190	        channel = self.make_request(
4191	            "POST",
4192	            f"/_matrix/client/v3/rooms/{self.room1}/ban",
4193	            access_token=self.tok1,
4194	            content={"reason": "spite", "user_id": self.user2},
4195	            shorthand=False,
4196	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_rooms.py:4203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4202	        # ban now goes through
4203	        channel = self.make_request(
4204	            "POST",
4205	            f"/_matrix/client/v3/rooms/{self.room1}/ban",
4206	            access_token=self.tok1,
4207	            content={"reason": "spite", "user_id": self.user2},
4208	            shorthand=False,
4209	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_tags.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
44	        # Make the request
45	        channel = self.make_request(
46	            "PUT",
47	            f"/user/{user1_id}/rooms/{room_id}/tags/{tag}",
48	            content={"order": 0.5},
49	            access_token=user1_tok,
50	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_tags.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
67	        # Make the request
68	        channel = self.make_request(
69	            "PUT",
70	            f"/user/{user1_id}/rooms/{room_id}/tags/{tag}",
71	            content={"order": 0.5},
72	            access_token=user1_tok,
73	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_tags.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
87	        # Make the request
88	        channel = self.make_request(
89	            "PUT",
90	            f"/user/{user1_id}/rooms/{room_id}/tags/{tag}",
91	            content={"order": 0.5},
92	            access_token=user1_tok,
93	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
62	        cb = AsyncMock(return_value=self.mock_http_response)
63	        res = yield self.cache.fetch_or_execute_request(
64	            self.mock_request, self.mock_requester, cb, "some_arg", keyword="arg"
65	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
74	        for i in range(3):  # invoke multiple times
75	            res = yield self.cache.fetch_or_execute_request(
76	                self.mock_request,
77	                self.mock_requester,
78	                cb,
79	                "some_arg",
80	                keyword="arg",
81	                changing_args=i,
82	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
98	            with LoggingContext("c") as c1:
99	                res = yield self.cache.fetch_or_execute_request(
100	                    self.mock_request, self.mock_requester, cb
101	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
129	            try:
130	                yield self.cache.fetch_or_execute_request(
131	                    self.mock_request, self.mock_requester, cb
132	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
136	
137	            res = yield self.cache.fetch_or_execute_request(
138	                self.mock_request, self.mock_requester, cb
139	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
161	            try:
162	                yield self.cache.fetch_or_execute_request(
163	                    self.mock_request, self.mock_requester, cb
164	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
168	
169	            res = yield self.cache.fetch_or_execute_request(
170	                self.mock_request, self.mock_requester, cb
171	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
177	        cb = AsyncMock(return_value=self.mock_http_response)
178	        yield self.cache.fetch_or_execute_request(
179	            self.mock_request, self.mock_requester, cb, "an arg"
180	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
183	
184	        yield self.cache.fetch_or_execute_request(
185	            self.mock_request, self.mock_requester, cb, "an arg"
186	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/test_transactions.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
191	
192	        yield self.cache.fetch_or_execute_request(
193	            self.mock_request, self.mock_requester, cb, "an arg"
194	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	# an 'oidc_config' suitable for login_via_oidc.
58	TEST_OIDC_ISSUER = "https://issuer.test/"
59	TEST_OIDC_CONFIG = {

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
148	
149	        channel = make_request(
150	            self.reactor,
151	            self.site,
152	            "POST",
153	            path,
154	            content,
155	            custom_headers=custom_headers,
156	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
224	
225	        channel = make_request(
226	            self.reactor,
227	            self.site,
228	            "POST",
229	            path,
230	            data,
231	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
324	
325	        channel = make_request(
326	            self.reactor,
327	            self.site,
328	            "PUT",
329	            path,
330	            data,
331	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
413	
414	        channel = make_request(
415	            self.reactor,
416	            self.site,
417	            "PUT",
418	            path,
419	            content or {},
420	            custom_headers=custom_headers,
421	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
452	
453	        channel = make_request(
454	            self.reactor,
455	            self.site,
456	            "GET",
457	            path,
458	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
508	
509	        channel = make_request(self.reactor, self.site, method, path, content)
510	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
591	        path = "/_matrix/media/r0/upload?filename=%s" % (filename,)
592	        channel = make_request(
593	            self.reactor,
594	            self.site,
595	            "POST",
596	            path,
597	            content=image_data,
598	            access_token=tok,
599	            custom_headers=[("Content-Length", str(image_length))],
600	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
621	        """
622	        channel = make_request(
623	            self.reactor,
624	            self.site,
625	            "GET",
626	            "account/whoami",
627	            access_token=access_token,
628	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
670	        """
671	        client_redirect_url = "https://x"
672	        userinfo = {"sub": remote_user_id}

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
711	
712	        channel = make_request(
713	            self.reactor,
714	            self.site,
715	            "POST",
716	            "/login",
717	            content={"type": "m.login.token", "token": login_token},
718	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
841	            # now hit the callback URI with the right params and a made-up code
842	            channel = make_request(
843	                self.reactor,
844	                self.site,
845	                "GET",
846	                callback_uri,
847	                custom_headers=[
848	                    ("Cookie", "%s=%s" % (k, v)) for (k, v) in cookies.items()
849	                ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
885	        # to keep Synapse happy.
886	        channel = make_request(
887	            self.reactor,
888	            self.site,
889	            "GET",
890	            uri,
891	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
904	        next_uri = urllib.parse.urlunsplit(("", "") + parts[2:])
905	        channel = make_request(
906	            self.reactor,
907	            self.site,
908	            "GET",
909	            next_uri,
910	            custom_headers=[
911	                ("Host", parts[1]),
912	            ],

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
938	        # hit the redirect url (which will issue a cookie and state)
939	        channel = make_request(self.reactor, self.site, "GET", sso_redirect_endpoint)
940	        # that should serve a confirmation page

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/client/utils.py:954
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
953	        """Send a read receipt into the room at the given event"""
954	        channel = make_request(
955	            self.reactor,
956	            self.site,
957	            method="POST",
958	            path=f"/rooms/{room_id}/receipt/{ReceiptTypes.READ}/{event_id}",
959	            content={},
960	            access_token=tok,
961	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/key/v2/test_remote_key_resource.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
118	        testkey = signedjson.key.generate_signing_key("ver1")
119	        self.expect_outgoing_key_request(SERVER_NAME, testkey)
120	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/key/v2/test_remote_key_resource.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
120	
121	        resp = self.make_notary_request(SERVER_NAME, "ed25519:ver1")
122	        keys = resp["server_keys"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/key/v2/test_remote_key_resource.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
134	        testkey = signedjson.key.generate_signing_key("ver1")
135	        self.expect_outgoing_key_request(self.hs.hostname, testkey)
136	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/key/v2/test_remote_key_resource.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
136	
137	        resp = self.make_notary_request(self.hs.hostname, "ed25519:ver1")
138	        keys = resp["server_keys"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/key/v2/test_remote_key_resource.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
224	        # we expect hs1 to make a regular key request to the target server
225	        self.expect_outgoing_key_request("targetserver", testkey)
226	        keyid = "ed25519:%s" % (testkey.version,)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/key/v2/test_remote_key_resource.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
248	        # we expect hs1 to make a regular key request to itself
249	        self.expect_outgoing_key_request(self.hs.hostname, testkey)
250	        keyid = "ed25519:%s" % (testkey.version,)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/key/v2/test_remote_key_resource.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
267	        # we expect hs1 to make a regular key request to itself
268	        self.expect_outgoing_key_request(self.hs.hostname, self.hs_signing_key)
269	        keyid = "ed25519:%s" % (self.hs_signing_key.version,)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
70	        config["url_preview_ip_range_blacklist"] = (
71	            "192.168.1.1",
72	            "1.0.0.0/8",
73	            "3fff:ffff:ffff:ffff:ffff:ffff:ffff:ffff",
74	            "2001:800::/21",
75	        )
76	        config["url_preview_ip_range_whitelist"] = ("1.1.1.1",)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
75	        )
76	        config["url_preview_ip_range_whitelist"] = ("1.1.1.1",)
77	        config["url_preview_accept_language"] = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	            OEmbedEndpointConfig(
108	                api_endpoint="http://publish.twitter.com/oembed",
109	                url_patterns=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	                url_patterns=[
110	                    re.compile(r"http://twitter\.com/.+/status/.+"),
111	                ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	            OEmbedEndpointConfig(
115	                api_endpoint="http://www.hulu.com/api/oembed.{format}",
116	                url_patterns=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	                url_patterns=[
117	                    re.compile(r"http://www\.hulu\.com/watch/.+"),
118	                ],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
171	    def test_cache_returns_correct_type(self) -> None:
172	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
173	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	            "GET",
176	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
177	            shorthand=False,
178	            await_result=False,
179	        )
180	        self.pump()
181	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	            "GET",
201	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
202	            shorthand=False,
203	        )
204	
205	        # Check the cache response has the same content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
211	        # Clear the in-memory cache
212	        self.assertIn("http://matrix.org", self.url_previewer._cache)
213	        self.url_previewer._cache.pop("http://matrix.org")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	        self.assertIn("http://matrix.org", self.url_previewer._cache)
213	        self.url_previewer._cache.pop("http://matrix.org")
214	        self.assertNotIn("http://matrix.org", self.url_previewer._cache)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
213	        self.url_previewer._cache.pop("http://matrix.org")
214	        self.assertNotIn("http://matrix.org", self.url_previewer._cache)
215	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	            "GET",
219	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
220	            shorthand=False,
221	        )
222	
223	        # Check the cache response has the same content

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
229	    def test_non_ascii_preview_httpequiv(self) -> None:
230	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
231	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	            "GET",
242	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
243	            shorthand=False,
244	            await_result=False,
245	        )
246	        self.pump()
247	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
265	    def test_video_rejected(self) -> None:
266	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
267	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
271	            "GET",
272	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
273	            shorthand=False,
274	            await_result=False,
275	        )
276	        self.pump()
277	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
301	    def test_audio_rejected(self) -> None:
302	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
303	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
307	            "GET",
308	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
309	            shorthand=False,
310	            await_result=False,
311	        )
312	        self.pump()
313	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
337	    def test_non_ascii_preview_content_type(self) -> None:
338	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
339	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
348	            "GET",
349	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
350	            shorthand=False,
351	            await_result=False,
352	        )
353	        self.pump()
354	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
372	    def test_overlong_title(self) -> None:
373	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
374	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
383	            "GET",
384	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
385	            shorthand=False,
386	            await_result=False,
387	        )
388	        self.pump()
389	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
412	        """
413	        self.lookups["example.com"] = [(IPv4Address, "10.1.2.3")]
414	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
416	            "GET",
417	            "/_matrix/media/v3/preview_url?url=http://example.com",
418	            shorthand=False,
419	            await_result=False,
420	        )
421	        self.pump()
422	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
442	        """
443	        self.lookups["example.com"] = [(IPv4Address, "192.168.1.1")]
444	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
446	            "GET",
447	            "/_matrix/media/v3/preview_url?url=http://example.com",
448	            shorthand=False,
449	        )
450	
451	        # No requests made.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
465	        """
466	        self.lookups["example.com"] = [(IPv4Address, "1.1.1.2")]
467	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
469	            "GET",
470	            "/_matrix/media/v3/preview_url?url=http://example.com",
471	            shorthand=False,
472	        )
473	
474	        self.assertEqual(channel.code, 502)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
488	            "GET",
489	            "/_matrix/media/v3/preview_url?url=http://192.168.1.1",
490	            shorthand=False,
491	        )
492	
493	        # No requests made.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
505	        channel = self.make_request(
506	            "GET", "/_matrix/media/v3/preview_url?url=http://1.1.1.2", shorthand=False
507	        )
508	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
519	        """
520	        self.lookups["example.com"] = [(IPv4Address, "1.1.1.1")]
521	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
523	            "GET",
524	            "/_matrix/media/v3/preview_url?url=http://example.com",
525	            shorthand=False,
526	            await_result=False,
527	        )
528	        self.pump()
529	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
554	        self.lookups["example.com"] = [
555	            (IPv4Address, "1.1.1.2"),
556	            (IPv4Address, "10.1.2.3"),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
555	            (IPv4Address, "1.1.1.2"),
556	            (IPv4Address, "10.1.2.3"),
557	        ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
560	            "GET",
561	            "/_matrix/media/v3/preview_url?url=http://example.com",
562	            shorthand=False,
563	        )
564	        self.assertEqual(channel.code, 502)
565	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
582	            "GET",
583	            "/_matrix/media/v3/preview_url?url=http://example.com",
584	            shorthand=False,
585	        )
586	
587	        # No requests made.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
605	            "GET",
606	            "/_matrix/media/v3/preview_url?url=http://example.com",
607	            shorthand=False,
608	        )
609	
610	        self.assertEqual(channel.code, 502)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
624	            "OPTIONS",
625	            "/_matrix/media/v3/preview_url?url=http://example.com",
626	            shorthand=False,
627	        )
628	        self.assertEqual(channel.code, 204)
629	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
633	        """
634	        self.lookups["example.com"] = [(IPv4Address, "10.1.2.3")]
635	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
638	            "GET",
639	            "/_matrix/media/v3/preview_url?url=http://example.com",
640	            shorthand=False,
641	            await_result=False,
642	        )
643	        self.pump()
644	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
682	        """An image should be precached if mentioned in the HTML."""
683	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
684	        self.lookups["cdn.matrix.org"] = [(IPv4Address, "10.1.2.4")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
683	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
684	        self.lookups["cdn.matrix.org"] = [(IPv4Address, "10.1.2.4")]
685	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
691	            "GET",
692	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
693	            shorthand=False,
694	            await_result=False,
695	        )
696	        self.pump()
697	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
733	        """If the preview image doesn't exist, ensure some data is returned."""
734	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
735	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
741	            "GET",
742	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
743	            shorthand=False,
744	            await_result=False,
745	        )
746	        self.pump()
747	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
774	        """If the preview image doesn't exist, ensure some data is returned."""
775	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
776	        self.lookups["cdn.matrix.org"] = [(IPv4Address, "10.1.2.4")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
775	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
776	        self.lookups["cdn.matrix.org"] = [(IPv4Address, "10.1.2.4")]
777	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
783	            "GET",
784	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
785	            shorthand=False,
786	            await_result=False,
787	        )
788	        self.pump()
789	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
812	        """If the autodiscovered oEmbed URL fails, ensure some data is returned."""
813	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
814	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
823	            "GET",
824	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
825	            shorthand=False,
826	            await_result=False,
827	        )
828	        self.pump()
829	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:853
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
852	        """
853	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
854	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
854	
855	        data = base64.b64encode(SMALL_PNG).decode()
856	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:855
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
854	
855	        data = base64.b64encode(SMALL_PNG).decode()
856	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
875	        """
876	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
877	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
877	
878	        data = base64.b64encode(SMALL_PNG)
879	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:878
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
877	
878	        data = base64.b64encode(SMALL_PNG)
879	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
885	            "GET",
886	            "/_matrix/media/v3/preview_url?url=http://matrix.org",
887	            shorthand=False,
888	            await_result=False,
889	        )
890	        self.pump()
891	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
910	        """Test an oEmbed endpoint which returns a 'photo' type which redirects the preview to a new URL."""
911	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
912	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
911	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
912	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]
913	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
916	            "type": "photo",
917	            "url": "http://cdn.twitter.com/matrixdotorg",
918	        }
919	        oembed_content = json.dumps(result).encode("utf-8")
920	
921	        channel = self.make_request(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
922	            "GET",
923	            "/_matrix/media/v3/preview_url?url=http://twitter.com/matrixdotorg/status/12345",
924	            shorthand=False,
925	            await_result=False,
926	        )
927	        self.pump()
928	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
964	        body = channel.json_body
965	        self.assertEqual(body["og:url"], "http://twitter.com/matrixdotorg/status/12345")
966	        self._assert_small_png(body)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
969	        """Test an oEmbed endpoint which returns HTML content via the 'rich' type."""
970	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
971	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
982	            "GET",
983	            "/_matrix/media/v3/preview_url?url=http://twitter.com/matrixdotorg/status/12345",
984	            shorthand=False,
985	            await_result=False,
986	        )
987	        self.pump()
988	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1012	            {
1013	                "og:url": "http://twitter.com/matrixdotorg/status/12345",
1014	                "og:title": "Alice",
1015	                "og:description": "Content Preview",
1016	            },
1017	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1020	        """Test an oEmbed endpoint which requires the format in the URL."""
1021	        self.lookups["www.hulu.com"] = [(IPv4Address, "10.1.2.3")]
1022	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1032
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1031	            "GET",
1032	            "/_matrix/media/v3/preview_url?url=http://www.hulu.com/watch/12345",
1033	            shorthand=False,
1034	            await_result=False,
1035	        )
1036	        self.pump()
1037	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1063
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1062	            {
1063	                "og:url": "http://www.hulu.com/watch/12345",
1064	                "og:description": "Content Preview",
1065	            },
1066	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1072	        """The oEmbed URL should not be downloaded if the oEmbed URL is blocked."""
1073	        self.lookups["twitter.com"] = [(IPv4Address, "10.1.2.3")]
1074	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1076	            "GET",
1077	            "/_matrix/media/v3/preview_url?url=http://twitter.com/matrixdotorg/status/12345",
1078	            shorthand=False,
1079	            await_result=False,
1080	        )
1081	        self.pump()
1082	        self.assertEqual(channel.code, 403, channel.result)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1093	        # list of oEmbed patterns) to get "raw" HTML response.
1094	        self.lookups["www.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1095	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1095
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1094	        self.lookups["www.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1095	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1096	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1096
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1095	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1096	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1097	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1105	            "GET",
1106	            "/_matrix/media/v3/preview_url?url=http://www.twitter.com/matrixdotorg/status/12345",
1107	            shorthand=False,
1108	            await_result=False,
1109	        )
1110	        self.pump()
1111	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1129	            "type": "photo",
1130	            "url": "http://cdn.twitter.com/matrixdotorg",
1131	        }
1132	        oembed_content = json.dumps(result2).encode("utf-8")
1133	
1134	        # Ensure a second request is made to the oEmbed URL.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1172	        self.assertEqual(
1173	            body["og:url"], "http://www.twitter.com/matrixdotorg/status/12345"
1174	        )
1175	        self._assert_small_png(body)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1185	        # list of oEmbed patterns) to get "raw" HTML response.
1186	        self.lookups["www.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1187	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.4")]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1186	        self.lookups["www.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1187	        self.lookups["publish.twitter.com"] = [(IPv4Address, "10.1.2.4")]
1188	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1197	            "GET",
1198	            "/_matrix/media/v3/preview_url?url=http://www.twitter.com/matrixdotorg/status/12345",
1199	            shorthand=False,
1200	            await_result=False,
1201	        )
1202	        self.pump()
1203	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1234	        """
1235	        self.lookups["cdn.twitter.com"] = [(IPv4Address, "10.1.2.3")]
1236	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1238	            "GET",
1239	            "/_matrix/media/v3/preview_url?url=http://cdn.twitter.com/matrixdotorg",
1240	            shorthand=False,
1241	            await_result=False,
1242	        )
1243	        self.pump()
1244	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1391	        """
1392	        self.lookups["matrix.org"] = [(IPv4Address, "10.1.2.3")]
1393	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1393	
1394	        bad_url = quote("http://matrix.org:8888/foo")
1395	        good_url = quote("http://matrix.org/foo")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1394	        bad_url = quote("http://matrix.org:8888/foo")
1395	        good_url = quote("http://matrix.org/foo")
1396	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1433	        """
1434	        self.lookups["example.com"] = [(IPv4Address, "10.1.2.3")]
1435	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/media/test_url_preview.py:1436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1435	
1436	        bad_url = quote("http://example.com/foo")
1437	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	            {
52	                "m.homeserver": {"base_url": "https://tesths/"},
53	                "m.identity_server": {"base_url": "https://testis"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	                "m.homeserver": {"base_url": "https://tesths/"},
53	                "m.identity_server": {"base_url": "https://testis"},
54	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	        {
39	            "public_baseurl": "https://tesths",
40	            "default_identity_server": "https://testis",
41	        }
42	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	            "public_baseurl": "https://tesths",
40	            "default_identity_server": "https://testis",
41	        }
42	    )
43	    def test_client_well_known(self) -> None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	            {
85	                "m.homeserver": {"base_url": "https://tesths/"},
86	                "m.identity_server": {"base_url": "https://testis"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	                "m.homeserver": {"base_url": "https://tesths/"},
86	                "m.identity_server": {"base_url": "https://testis"},
87	                "custom": False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	        {
71	            "public_baseurl": "https://tesths",
72	            "default_identity_server": "https://testis",
73	            "extra_well_known_client_content": {"custom": False},
74	        }
75	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	            "public_baseurl": "https://tesths",
72	            "default_identity_server": "https://testis",
73	            "extra_well_known_client_content": {"custom": False},
74	        }
75	    )
76	    def test_client_well_known_custom(self) -> None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	            return_value={
129	                "issuer": "https://issuer",
130	                "account_management_uri": "https://my-account.issuer",
131	            }
132	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	                "issuer": "https://issuer",
130	                "account_management_uri": "https://my-account.issuer",
131	            }
132	        )
133	        self.hs.get_proxied_http_client().get_json = req_mock  # type: ignore[method-assign]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	                {
144	                    "m.homeserver": {"base_url": "https://homeserver/"},
145	                    "org.matrix.msc2965.authentication": {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	                    "org.matrix.msc2965.authentication": {
146	                        "issuer": "https://issuer",
147	                        "account": "https://my-account.issuer",
148	                    },
149	                },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
146	                        "issuer": "https://issuer",
147	                        "account": "https://my-account.issuer",
148	                    },
149	                },
150	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
153	        req_mock.assert_called_once_with(
154	            "https://issuer/.well-known/openid-configuration"
155	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	        {
112	            "public_baseurl": "https://homeserver",  # this is only required so that client well known is served
113	            "experimental_features": {
114	                "msc3861": {
115	                    "enabled": True,
116	                    "issuer": "https://issuer",
117	                    "client_id": "id",
118	                    "client_auth_method": "client_secret_post",
119	                    "client_secret": "secret",
120	                },
121	            },
122	            "disable_registration": True,
123	        }
124	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/rest/test_well_known.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
115	                    "enabled": True,
116	                    "issuer": "https://issuer",
117	                    "client_id": "id",
118	                    "client_auth_method": "client_secret_post",
119	                    "client_secret": "secret",
120	                },
121	            },
122	            "disable_registration": True,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
151	    result: dict = attr.Factory(dict)
152	    _ip: str = "127.0.0.1"
153	    _producer: Optional[Union[IPullProducer, IPushProducer]] = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
243	        for x in data:
244	            self.write(x)
245	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
294	        # this is called by Request.__init__ to configure Request.host.
295	        return address.IPv4Address("TCP", "127.0.0.1", 8888)
296	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
372	    custom_headers: Optional[Iterable[CustomHeaderType]] = None,
373	    client_ip: str = "127.0.0.1",
374	) -> FakeChannel:
375	    """
376	    Make a web request using the given method, path and content, and render it
377	
378	    Returns the fake Channel object which records the response to the request.
379	
380	    Args:
381	        reactor:
382	        site: The twisted Site to use to render the request
383	        method: The HTTP request method ("verb").
384	        path: The HTTP path, suitably URL encoded (e.g. escaped UTF-8 & spaces and such).
385	        content: The body of the request. JSON-encoded, if a str of bytes.
386	        access_token: The access token to add as authorization for the request.
387	        request: The request class to create.

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
431	
432	    req = request(channel, site)
433	    channel.request = req

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server.py:813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
812	    _peer_address: Union[IPv4Address, IPv6Address] = attr.Factory(
813	        lambda: address.IPv4Address("TCP", "127.0.0.1", 5678)
814	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
817	    _host_address: Union[IPv4Address, IPv6Address] = attr.Factory(
818	        lambda: address.IPv4Address("TCP", "127.0.0.1", 1234)
819	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
909	        for x in seq:
910	            self.write(x)
911	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server_notices/test_consent.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        }
54	        config["public_baseurl"] = "https://example.com/"
55	        config["form_secret"] = "123abc"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/server_notices/test_consent.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	            messages[0]["content"]["body"].startswith(
109	                "consent https://example.com/_matrix/consent"
110	            )
111	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
94	        with open(as_token, "w") as outfile:
95	            outfile.write(yaml.dump(as_yaml))
96	            self.as_yaml_files.append(as_token)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
94	        with open(as_token, "w") as outfile:
95	            outfile.write(yaml.dump(as_yaml))
96	            self.as_yaml_files.append(as_token)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	        self.as_list = [
126	            {"token": "token1", "url": "https://matrix-as.org", "id": "id_1"},
127	            {"token": "alpha_tok", "url": "https://alpha.com", "id": "id_alpha"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	            {"token": "token1", "url": "https://matrix-as.org", "id": "id_1"},
127	            {"token": "alpha_tok", "url": "https://alpha.com", "id": "id_alpha"},
128	            {"token": "beta_tok", "url": "https://beta.com", "id": "id_beta"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	            {"token": "alpha_tok", "url": "https://alpha.com", "id": "id_alpha"},
128	            {"token": "beta_tok", "url": "https://beta.com", "id": "id_beta"},
129	            {"token": "gamma_tok", "url": "https://gamma.com", "id": "id_gamma"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	            {"token": "beta_tok", "url": "https://beta.com", "id": "id_beta"},
129	            {"token": "gamma_tok", "url": "https://gamma.com", "id": "id_gamma"},
130	        ]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	        with open(as_token, "w") as outfile:
157	            outfile.write(yaml.dump(as_yaml))
158	            self.as_yaml_files.append(as_token)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
156	        with open(as_token, "w") as outfile:
157	            outfile.write(yaml.dump(as_yaml))
158	            self.as_yaml_files.append(as_token)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
480	        with open(path, "w") as f:
481	            f.write(yaml.dump(vals))
482	        return path

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_appservice.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
480	        with open(path, "w") as f:
481	            f.write(yaml.dump(vals))
482	        return path

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_cleanup_extrems.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
394	        consent_uri_builder = Mock()
395	        consent_uri_builder.build_user_consent_uri.return_value = "http://example.com"
396	        self.event_creator._consent_uri_builder = consent_uri_builder

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_client_ips.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
734	            {b"X-Forwarded-For": b"127.9.0.1"},
735	            "127.9.0.1",
736	            {"request": XForwardedForRequest},
737	        )
738	
739	    def test_request_from_getPeer(self) -> None:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_client_ips.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
743	        """
744	        self._runtest({}, "127.0.0.1", {})
745	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_client_ips.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
761	
762	        make_request(
763	            self.reactor,
764	            self.site,
765	            "GET",
766	            "/_synapse/admin/v2/users/" + self.user_id,
767	            access_token=access_token,
768	            custom_headers=headers1.items(),
769	            **make_request_args,
770	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_profile.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	        self.get_success(
60	            self.store.set_profile_avatar_url(self.u_frank, "http://my.site/here")
61	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_profile.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	        self.assertEqual(
64	            "http://my.site/here",
65	            (self.get_success(self.store.get_profile_avatar_url(self.u_frank))),
66	        )
67	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/storage/test_rollback_worker.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
62	        conf["worker_app"] = "yes"
63	        conf["instance_map"] = {"main": {"host": "127.0.0.1", "port": 0}}
64	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
84	
85	        make_request(
86	            self.reactor,
87	            FakeSite(res, self.reactor),
88	            b"GET",
89	            b"/_matrix/foo/%E2%98%83?a=%E2%98%83",
90	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
107	
108	        channel = make_request(
109	            self.reactor, FakeSite(res, self.reactor), b"GET", b"/_matrix/foo"
110	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
133	
134	        channel = make_request(
135	            self.reactor, FakeSite(res, self.reactor), b"GET", b"/_matrix/foo"
136	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
153	
154	        channel = make_request(
155	            self.reactor, FakeSite(res, self.reactor), b"GET", b"/_matrix/foo"
156	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
177	
178	        channel = make_request(
179	            self.reactor, FakeSite(res, self.reactor), b"GET", b"/_matrix/foobar"
180	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
206	        # The path was registered as GET, but this is a HEAD request.
207	        channel = make_request(
208	            self.reactor, FakeSite(res, self.reactor), b"HEAD", b"/_matrix/foo"
209	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
256	        # render the request and return the channel
257	        channel = make_request(self.reactor, site, method, path, shorthand=False)
258	        return channel

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
284	        """An OPTIONS requests to an unknown URL still returns 204 No Content."""
285	        channel = self._make_request(b"OPTIONS", b"/foo/")
286	        self.assertEqual(channel.code, 204)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
292	        """An OPTIONS requests to an known URL still returns 204 No Content."""
293	        channel = self._make_request(b"OPTIONS", b"/res/")
294	        self.assertEqual(channel.code, 204)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
300	        """A non-OPTIONS request to an unknown URL should 404."""
301	        channel = self._make_request(b"GET", b"/foo/")
302	        self.assertEqual(channel.code, 404)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
305	        """A non-OPTIONS request to an known URL should query the proper resource."""
306	        channel = self._make_request(b"GET", b"/res/")
307	        self.assertEqual(channel.code, 200)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
330	
331	        channel = make_request(
332	            self.reactor, FakeSite(res, self.reactor), b"GET", b"/path"
333	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
350	
351	        channel = make_request(
352	            self.reactor, FakeSite(res, self.reactor), b"GET", b"/path"
353	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
372	
373	        channel = make_request(
374	            self.reactor, FakeSite(res, self.reactor), b"GET", b"/path"
375	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
393	
394	        channel = make_request(
395	            self.reactor, FakeSite(res, self.reactor), b"HEAD", b"/path"
396	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
444	        """Test that handlers with the `@cancellable` flag can be cancelled."""
445	        channel = make_request(
446	            self.reactor, self.site, "GET", "/sleep", await_result=False
447	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
456	        """Test that handlers without the `@cancellable` flag cannot be cancelled."""
457	        channel = make_request(
458	            self.reactor, self.site, "POST", "/sleep", await_result=False
459	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
478	        """Test that handlers with the `@cancellable` flag can be cancelled."""
479	        channel = make_request(
480	            self.reactor, self.site, "GET", "/sleep", await_result=False
481	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_server.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
490	        """Test that handlers without the `@cancellable` flag cannot be cancelled."""
491	        channel = make_request(
492	            self.reactor, self.site, "POST", "/sleep", await_result=False
493	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_terms_auth.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	            {
41	                "public_baseurl": "https://example.org/",
42	                "user_consent": {
43	                    "version": "1.0",
44	                    "policy_name": "My Cool Privacy Policy",
45	                    "template_dir": "/",
46	                    "require_at_registration": True,
47	                },
48	            }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_terms_auth.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	                            "name": "My Cool Privacy Policy",
86	                            "url": "https://example.org/_matrix/consent?v=1.0",
87	                        },
88	                        "version": "1.0",
89	                    }
90	                }

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_utils/__init__.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
151	# Resolution: 1x1, MIME type: image/jpeg, Extension: jpeg, Size: 4 KiB
152	SMALL_CMYK_JPEG = base64.b64decode("""
153	/9j/7gAOQWRvYmUAZAAAAAAA/9sAQwAIBgYHBgUIBwcHCQkICgwUDQwLCww

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_utils/__init__.py:152
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
151	# Resolution: 1x1, MIME type: image/jpeg, Extension: jpeg, Size: 4 KiB
152	SMALL_CMYK_JPEG = base64.b64decode("""
153	/9j/7gAOQWRvYmUAZAAAAAAA/9sAQwAIBgYHBgUIBwcHCQkICgwUDQwLCww

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/test_utils/oidc.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	            "events": {
186	                "http://schemas.openid.net/event/backchannel-logout": {},
187	            },
188	        }

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/unittest.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
585	        custom_headers: Optional[Iterable[CustomHeaderType]] = None,
586	        client_ip: str = "127.0.0.1",
587	    ) -> FakeChannel:
588	        """
589	        Create a SynapseRequest at the path using the method and containing the
590	        given content.
591	
592	        Args:
593	            method: The HTTP request method ("verb").
594	            path: The HTTP path, suitably URL encoded (e.g. escaped UTF-8 & spaces
595	                and such). content (bytes or dict): The body of the request.
596	                JSON-encoded, if a dict.
597	            shorthand: Whether to try and be helpful and prefix the given URL
598	            with the usual REST API path, if it doesn't contain it.
599	            federation_auth_origin: if set to not-None, we will add a fake

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/unittest.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
618	        """
619	        return make_request(
620	            self.reactor,
621	            self.site,
622	            method,
623	            path,
624	            content,
625	            access_token,
626	            request,
627	            shorthand,
628	            federation_auth_origin,
629	            content_type,
630	            content_is_form,
631	            await_result,
632	            custom_headers,
633	            client_ip,
634	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/unittest.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
751	        # Create the user
752	        channel = self.make_request("GET", "/_synapse/admin/v1/register")
753	        self.assertEqual(channel.code, 200, msg=channel.result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/unittest.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
774	        }
775	        channel = self.make_request("POST", "/_synapse/admin/v1/register", body)
776	        self.assertEqual(channel.code, 200, channel.json_body)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/unittest.py:799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
798	        """
799	        channel = self.make_request(
800	            "POST",
801	            "/_matrix/client/r0/register",
802	            {
803	                "username": username,
804	                "type": "m.login.application_service",
805	            },
806	            access_token=appservice_token,
807	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/unittest.py:840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
839	
840	        channel = self.make_request(
841	            "POST",
842	            "/_matrix/client/r0/login",
843	            body,
844	            custom_headers=custom_headers,
845	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/unittest.py:960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
959	        custom_headers: Optional[Iterable[CustomHeaderType]] = None,
960	        client_ip: str = "127.0.0.1",
961	    ) -> FakeChannel:
962	        """Make an inbound signed federation request to this server
963	
964	        The request is signed as if it came from "other.example.com", which our HS
965	        already has the keys for.
966	        """
967	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/unittest.py:976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
975	                "Authorization",
976	                _auth_header_for_request(
977	                    origin=self.OTHER_SERVER_NAME,
978	                    destination=self.hs.hostname,
979	                    signing_key=self.OTHER_SERVER_SIGNATURE_KEY,
980	                    method=method,
981	                    path=path,
982	                    content=content,
983	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/unittest.py:987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
986	
987	        return make_request(
988	            self.reactor,
989	            self.site,
990	            method=method,
991	            path=path,
992	            content=content if content is not None else "",
993	            shorthand=False,
994	            await_result=await_result,
995	            custom_headers=custom_headers,
996	            client_ip=client_ip,
997	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/util/test_macaroons.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	            nonce="nonce",
100	            client_redirect_url="https://example.com/",
101	            ui_auth_session_id="",

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/utils.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
426	    def __enter__(self) -> None:
427	        signal.signal(signal.SIGALRM, self.handle_timeout)
428	        signal.alarm(self.seconds)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/matrix_synapse-1.128.0/matrix_synapse-1.128.0/tests/utils.py:427
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
426	    def __enter__(self) -> None:
427	        signal.signal(signal.SIGALRM, self.handle_timeout)
428	        signal.alarm(self.seconds)

--------------------------------------------------

Code scanned:
	Total lines of code: 278133
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 671.0
		High: 1705.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 2350.0
		High: 26.0
Files skipped (0):
