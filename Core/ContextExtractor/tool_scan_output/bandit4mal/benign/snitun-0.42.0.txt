Run started:2025-04-12 12:49:52.212877

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/client/connector.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
122	                    from_endpoint = self._pause_future or self._loop.create_task(
123	                        reader.read(4096),  # type: ignore[arg-type]
124	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/client/connector.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
125	                if not from_peer:
126	                    from_peer = self._loop.create_task(channel.read())
127	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/client/connector.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
139	                    if (from_endpoint_result := from_endpoint.result()) is not None:
140	                        await channel.write(from_endpoint_result)
141	                    from_endpoint = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/client/connector.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	
148	                    writer.write(from_peer.result())
149	                    from_peer = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/multiplexer/core.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
240	            encrypted_header = self._crypto.encrypt(header)
241	            self._writer.write(
242	                encrypted_header + data if data_len else encrypted_header,
243	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/listener_sni.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
161	        try:
162	            await channel.write(client_hello)
163	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/listener_sni.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
170	                    from_proxy = self._pause_future or self._loop.create_task(
171	                        reader.read(4096),  # type: ignore[arg-type]
172	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/listener_sni.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
173	                if not from_peer:
174	                    from_peer = self._loop.create_task(channel.read())
175	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/listener_sni.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
188	                    if (from_proxy_result := from_proxy.result()) is not None:
189	                        await channel.write(from_proxy_result)
190	                    from_proxy = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/listener_sni.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
196	
197	                    writer.write(from_peer.result())
198	                    from_peer = None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/peer.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	            token = hashlib.sha256(os.urandom(40)).digest()
88	            writer.write(self._crypto.encrypt(token))
89	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
103	        self._list_peer: PeerListener = PeerListener(self._peers)
104	        self._host: str = host or "0.0.0.0"
105	        self._port: int = port or 443

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
122	        assert self._server is not None, "Server not started"
123	        self._server.close()
124	        await self._server.wait_closed()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
133	            async with asyncio_timeout.timeout(10):
134	                data = await reader.read(2048)
135	        except TimeoutError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
136	            _LOGGER.warning("Abort connection initializing")
137	            writer.close()
138	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
143	        if not data:
144	            writer.close()
145	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
157	            _LOGGER.warning("No valid ClientHello found: %s", data)
158	            writer.close()
159	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
183	        """Gracefull shutdown a socket or free the handle."""
184	        self.soft_close()
185	        with suppress(OSError):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
187	                self.sock.shutdown(socket.SHUT_RDWR)
188	            self.sock.close()
189	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
204	
205	        self._host: str = host or "0.0.0.0"
206	        self._port: int = port or 443

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:231
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
230	
231	        self._server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
232	        self._server.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
250	            worker.shutdown()
251	            worker.close()
252	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
254	        assert self._server is not None, "Server not started"
255	        self._server.close()
256	        assert self._poller is not None, "Poller not started"

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
256	        assert self._poller is not None, "Poller not started"
257	        self._poller.close()
258	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
324	        try:
325	            data = client.sock.recv(MAX_READ_SIZE)
326	        except OSError as err:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
338	        if client.buffer.startswith(b"gA"):
339	            client.soft_close()
340	            next(workers_lb).handover_connection(client.sock, client.buffer)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/run.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
367	                continue
368	            client.soft_close()
369	            worker.handover_connection(client.sock, client.buffer, sni=hostname)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/server/worker.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
140	        except OSError:
141	            con.close()
142	            return

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/utils/aiohttp_client.py:35
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
34	        self._client = ClientPeer(snitun_server, snitun_port)
35	        self._socket = socket.socket()
36	        self._server_name = f"{snitun_server}:{snitun_port}"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/utils/aiohttp_client.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
39	        self._socket.setblocking(False)
40	        self._socket.bind(("127.0.0.1", 0))
41	        self._site = SockSite(runner, self._socket, ssl_context=context)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/utils/aiohttp_client.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
84	        """
85	        await self.disconnect()
86	        with suppress(OSError):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/snitun-0.42.0/snitun-0.42.0/snitun/utils/aiohttp_client.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
86	        with suppress(OSError):
87	            self._socket.close()
88	

--------------------------------------------------

Code scanned:
	Total lines of code: 2436
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 2.0
Files skipped (0):
