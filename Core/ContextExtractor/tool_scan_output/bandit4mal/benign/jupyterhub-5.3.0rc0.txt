Run started:2025-04-12 11:07:10.235817

Test results:
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/ci/check_sdist.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
16	
17	tar = tarfile.open(name=sys.argv[1], mode="r:gz")
18	try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/generate-metrics.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	        with open(filename, 'w') as f:
41	            f.write("# List of Prometheus Metrics\n\n")
42	            f.write(writer.dumps())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/generate-metrics.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	            f.write("# List of Prometheus Metrics\n\n")
42	            f.write(writer.dumps())
43	            f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/generate-metrics.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
42	            f.write(writer.dumps())
43	            f.write("\n")
44	        print(f"Generated {filename}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
184	    redoc_url = (
185	        f"https://cdn.redoc.ly/redoc/v{redoc_version}/bundles/redoc.standalone.js"
186	    )

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
189	        logger.info(f"Downloading {redoc_url} -> {dest}")
190	        urlretrieve(redoc_url, dest)
191	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	    # stage fonts for redoc from google fonts
193	    fonts_css_url = "https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:300,400,700"
194	    fonts_css_file = out_static / "redoc-fonts.css"

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
198	        logger.info(f"Downloading {fonts_css_url} -> {fonts_css_file}")
199	        urlretrieve(fonts_css_url, fonts_css_file)
200	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
204	    with open(fonts_css_file) as f:
205	        fonts_css = f.read()
206	

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
215	            logger.info(f"Downloading {font_url} -> {dest}")
216	            urlretrieve(font_url, dest)
217	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
221	            logger.info(f"Rewriting URLs in {fonts_css_file}")
222	            f.write(fonts_css)
223	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	            "name": "GitHub",
268	            "url": "https://github.com/jupyterhub/jupyterhub",
269	            "icon": "fa-brands fa-github",
270	        },
271	    ],
272	    "use_edit_page_button": True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
289	    r"https?://(.*\.)?example\.(org|com)(/.*)?",  # example links
290	    r"https://github.com/[^/]*$",  # too many github usernames / searches in changelog
291	    "https://github.com/jupyterhub/jupyterhub/pull/",  # too many PRs in changelog
292	    "https://github.com/jupyterhub/jupyterhub/compare/",  # too many comparisons in changelog
293	    "https://schema.jupyter.org/jupyterhub/.*",  # schemas are not published yet
294	    r"https?://(localhost|127.0.0.1).*",  # ignore localhost references in auto-links
295	    r"https://linux.die.net/.*",  # linux.die.net seems to block requests from CI with 403 sometimes
296	    # don't check links to unpublished advisories
297	    r"https://github.com/jupyterhub/jupyterhub/security/advisories/.*",
298	    # Occasionally blocks CI checks with 403
299	    r"https://www\.mysql\.com",
300	]
301	linkcheck_anchors_ignore = [
302	    "/#!",
303	    "/#%21",
304	]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
290	    r"https://github.com/[^/]*$",  # too many github usernames / searches in changelog
291	    "https://github.com/jupyterhub/jupyterhub/pull/",  # too many PRs in changelog
292	    "https://github.com/jupyterhub/jupyterhub/compare/",  # too many comparisons in changelog
293	    "https://schema.jupyter.org/jupyterhub/.*",  # schemas are not published yet
294	    r"https?://(localhost|127.0.0.1).*",  # ignore localhost references in auto-links
295	    r"https://linux.die.net/.*",  # linux.die.net seems to block requests from CI with 403 sometimes
296	    # don't check links to unpublished advisories
297	    r"https://github.com/jupyterhub/jupyterhub/security/advisories/.*",
298	    # Occasionally blocks CI checks with 403
299	    r"https://www\.mysql\.com",
300	]
301	linkcheck_anchors_ignore = [
302	    "/#!",
303	    "/#%21",
304	]
305	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
291	    "https://github.com/jupyterhub/jupyterhub/pull/",  # too many PRs in changelog
292	    "https://github.com/jupyterhub/jupyterhub/compare/",  # too many comparisons in changelog
293	    "https://schema.jupyter.org/jupyterhub/.*",  # schemas are not published yet
294	    r"https?://(localhost|127.0.0.1).*",  # ignore localhost references in auto-links
295	    r"https://linux.die.net/.*",  # linux.die.net seems to block requests from CI with 403 sometimes
296	    # don't check links to unpublished advisories
297	    r"https://github.com/jupyterhub/jupyterhub/security/advisories/.*",
298	    # Occasionally blocks CI checks with 403
299	    r"https://www\.mysql\.com",
300	]
301	linkcheck_anchors_ignore = [
302	    "/#!",
303	    "/#%21",
304	]
305	
306	# -- Intersphinx -------------------------------------------------------------

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
292	    "https://github.com/jupyterhub/jupyterhub/compare/",  # too many comparisons in changelog
293	    "https://schema.jupyter.org/jupyterhub/.*",  # schemas are not published yet
294	    r"https?://(localhost|127.0.0.1).*",  # ignore localhost references in auto-links
295	    r"https://linux.die.net/.*",  # linux.die.net seems to block requests from CI with 403 sometimes
296	    # don't check links to unpublished advisories
297	    r"https://github.com/jupyterhub/jupyterhub/security/advisories/.*",
298	    # Occasionally blocks CI checks with 403
299	    r"https://www\.mysql\.com",
300	]
301	linkcheck_anchors_ignore = [
302	    "/#!",
303	    "/#%21",
304	]
305	
306	# -- Intersphinx -------------------------------------------------------------
307	# ref: https://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#configuration

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
294	    r"https?://(localhost|127.0.0.1).*",  # ignore localhost references in auto-links
295	    r"https://linux.die.net/.*",  # linux.die.net seems to block requests from CI with 403 sometimes
296	    # don't check links to unpublished advisories
297	    r"https://github.com/jupyterhub/jupyterhub/security/advisories/.*",
298	    # Occasionally blocks CI checks with 403
299	    r"https://www\.mysql\.com",
300	]
301	linkcheck_anchors_ignore = [
302	    "/#!",
303	    "/#%21",
304	]
305	
306	# -- Intersphinx -------------------------------------------------------------
307	# ref: https://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#configuration
308	#
309	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	    # don't check links to unpublished advisories
297	    r"https://github.com/jupyterhub/jupyterhub/security/advisories/.*",
298	    # Occasionally blocks CI checks with 403
299	    r"https://www\.mysql\.com",
300	]
301	linkcheck_anchors_ignore = [
302	    "/#!",
303	    "/#%21",
304	]
305	
306	# -- Intersphinx -------------------------------------------------------------
307	# ref: https://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#configuration
308	#
309	
310	intersphinx_mapping = get_intersphinx_mapping(
311	    packages={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/conf.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
298	    # Occasionally blocks CI checks with 403
299	    r"https://www\.mysql\.com",
300	]
301	linkcheck_anchors_ignore = [
302	    "/#!",
303	    "/#%21",
304	]
305	
306	# -- Intersphinx -------------------------------------------------------------
307	# ref: https://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#configuration
308	#
309	
310	intersphinx_mapping = get_intersphinx_mapping(
311	    packages={
312	        "python",
313	        "tornado",

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/rbac/generate-scope-table.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
40	    g = {}
41	    exec((root / "jupyterhub" / "_version.py").read_text(), g)
42	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/source/rbac/generate-scope-table.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
54	
55	    exec("\n".join(scopes_lines), g)
56	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/docs/test_docs.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
19	    with version_py.open() as f:
20	        exec(f.read(), {}, ns)
21	    jupyterhub_version = ns["__version__"]

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/bootstrap-script/jupyterhub_config.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
27	    if os.path.exists(temp_path) and os.path.isdir(temp_path):
28	        shutil.rmtree(temp_path)
29	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/bootstrap-script/jupyterhub_config.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
40	c.DockerSpawner.hub_ip_connect = public_ips()[0]
41	c.DockerSpawner.container_ip = "0.0.0.0"
42	
43	# You can now mount the volume to the docker container as we've
44	# made sure the directory exists
45	# pylint: disable=bad-whitespace
46	c.DockerSpawner.volumes = {'/volumes/jupyterhub/{username}/': '/home/jovyan/work'}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/collaboration-accounts/jupyterhub_config.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	
50	c.JupyterHub.bind_url = "http://127.0.0.1:8000/rtc/"
51	
52	# default to hub home instead of spawning
53	c.JupyterHub.default_url = "/rtc/hub/home"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	    def get(self):
49	        self.write("<h1>My grade</h1>")
50	        name = self.current_user["name"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	        grades = self.settings["grades"]
52	        self.write(f"<p>My name is: {escape(name)}</p>")
53	        if name in grades:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	        if name in grades:
54	            self.write(f"<p>My grade is: {escape(str(grades[name]))}</p>")
55	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	        else:
56	            self.write("<p>No grade entered</p>")
57	        if READ_SCOPE in self.current_user["scopes"]:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
57	        if READ_SCOPE in self.current_user["scopes"]:
58	            self.write('<a href="grades/">enter grades</a>')
59	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	        grades = self.settings["grades"]
67	        self.write("<h1>All grades</h1>")
68	        self.write("<table>")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	        self.write("<h1>All grades</h1>")
68	        self.write("<table>")
69	        self.write("<tr><th>Student</th><th>Grade</th></tr>")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        self.write("<table>")
69	        self.write("<tr><th>Student</th><th>Grade</th></tr>")
70	        for student, grade in grades.items():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	            qgrade = escape(str(grade))
73	            self.write(
74	                f"""
75	                <tr>
76	                 <td class="student">{qstudent}</td>
77	                 <td class="grade">{qgrade}</td>
78	                </tr>

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
81	        if WRITE_SCOPE in self.current_user["scopes"]:
82	            self.write("Enter grade:")
83	            self.write(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	            self.write("Enter grade:")
83	            self.write(
84	                """
85	                <form action=. method=POST>

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/grades.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
120	
121	    http_server = HTTPServer(app)
122	    url = urlparse(os.environ['JUPYTERHUB_SERVICE_URL'])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/jupyterhub_config.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	        'name': 'grades',
8	        'url': 'http://127.0.0.1:10101',
9	        'command': [sys.executable, './grades.py'],
10	        'oauth_client_allowed_scopes': [
11	            'custom:grades:write',
12	            'custom:grades:read',
13	        ],
14	    },
15	]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/custom-scopes/jupyterhub_config.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
50	c.JupyterHub.spawner_class = 'simple'
51	c.JupyterHub.ip = '127.0.0.1'  # let's just run on localhost while dummy auth is enabled
52	c.JupyterHub.log_level = 10

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/external-oauth/jupyterhub_config.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        'api_token': api_token,
18	        'oauth_redirect_uri': 'http://127.0.0.1:5555/oauth_callback',
19	    }
20	]
21	
22	# Grant all JupyterHub users ability to access services
23	c.JupyterHub.load_roles = [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/external-oauth/jupyterhub_config.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	# only listen on localhost for testing.
43	c.JupyterHub.bind_url = 'http://127.0.0.1:8000'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/external-oauth/whoami-oauth-basic.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	        self.set_header('content-type', 'application/json')
97	        self.write(json.dumps(user_model, indent=1, sort_keys=True))
98	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/read-only/jupyterhub_config.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
94	c.JupyterHub.spawner_class = 'simple'
95	c.JupyterHub.ip = '127.0.0.1'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/jupyterhub_config.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
56	c.JupyterHub.spawner_class = 'simple'
57	c.JupyterHub.ip = '127.0.0.1'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	    """
48	    r = session.get(url, stream=True)
49	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	    # step 1: get user status
67	    r = session.get(user_url)
68	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	    # if server is not 'active', request launch
72	    if server_name not in user_model.get('servers', {}):
73	        log.info(f"Starting server {log_name}")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
73	        log.info(f"Starting server {log_name}")
74	        r = session.post(f"{user_url}/servers/{server_name}")
75	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	            log.warning(f"Unexpected status: {r.status_code}")
82	        r = session.get(user_url)
83	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	        log.info(f"Progress {event['progress']}%: {event['message']}")
102	        if event.get("ready"):
103	            server_url = event['url']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	    while True:
140	        r = session.get(user_url)
141	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	        user_model = r.json()
143	        if server_name not in user_model.get("servers", {}):
144	            log.info(f"Server {log_name} stopped")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	    user = "test-user"
160	    hub_url = "http://127.0.0.1:8000"
161	
162	    session = make_session(get_token())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/server-api/start-stop-server.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	    server_url = start_server(session, hub_url, user)
164	    r = session.get(f"{server_url}/api/status")
165	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-announcement/announcement.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	        self.set_header("Content-Type", "application/json; charset=UTF-8")
41	        self.write(escape.utf8(json.dumps(doc)))
42	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-announcement/jupyterhub_config.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        'name': 'announcement',
11	        'url': f'http://127.0.0.1:{port}',
12	        'command': [

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-announcement/jupyterhub_config.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
40	c.JupyterHub.spawner_class = 'simple'
41	c.JupyterHub.ip = '127.0.0.1'  # let's just run on localhost while dummy auth is enabled

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-fastapi/jupyterhub_config.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    msg = (
11	        "env PUBLIC_HOST is not set, defaulting to http://127.0.0.1:8000.  "
12	        "This can cause problems with OAuth.  "
13	        "Set PUBLIC_HOST to your public (browser accessible) host."
14	    )
15	    warnings.warn(msg)
16	    public_host = "http://127.0.0.1:8000"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-fastapi/jupyterhub_config.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    warnings.warn(msg)
16	    public_host = "http://127.0.0.1:8000"
17	else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-fastapi/jupyterhub_config.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        "name": service_name,
27	        "url": "http://127.0.0.1:10202",
28	        "command": ["uvicorn", "app:app", "--port", "10202"],
29	        "oauth_redirect_uri": oauth_redirect_uri,
30	        "environment": {"PUBLIC_HOST": public_host},
31	    }
32	]
33	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-notebook/external/jupyterhub_config.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        'name': service_name,
18	        'url': f'http://127.0.0.1:{service_port}',
19	        'api_token': 'c3a29e5d386fd7c9aa1e8fe9d41c282ec8b',

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-notebook/external/jupyterhub_config.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
36	c.JupyterHub.spawner_class = 'simple'
37	c.JupyterHub.ip = '127.0.0.1'  # let's just run on localhost while dummy auth is enabled

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-notebook/managed/jupyterhub_config.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        'name': service_name,
18	        'url': f'http://127.0.0.1:{service_port}',
19	        'command': ['jupyterhub-singleuser', '--debug'],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-notebook/managed/jupyterhub_config.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
36	c.JupyterHub.spawner_class = 'simple'
37	c.JupyterHub.ip = '127.0.0.1'  # let's just run on localhost while dummy auth is enabled

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-whoami-flask/jupyterhub_config.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	        'name': 'whoami',
6	        'url': 'http://127.0.0.1:10101',
7	        'command': ['flask', 'run', '--port=10101'],
8	        'environment': {'FLASK_APP': 'whoami-flask.py'},
9	    },
10	]
11	c.JupyterHub.load_roles = [

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-whoami-flask/jupyterhub_config.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
26	# listen only on localhost while testing with wide-open auth
27	c.JupyterHub.ip = '127.0.0.1'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-whoami/jupyterhub_config.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	        'name': 'whoami-api',
8	        'url': 'http://127.0.0.1:10101',
9	        'command': [sys.executable, './whoami.py'],
10	        'display': False,
11	    },
12	    {
13	        'name': 'whoami-oauth',
14	        'url': 'http://127.0.0.1:10102',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-whoami/jupyterhub_config.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        'name': 'whoami-oauth',
14	        'url': 'http://127.0.0.1:10102',
15	        'command': [sys.executable, './whoami-oauth.py'],
16	        # the default oauth roles is minimal,
17	        # only requesting access to the service,
18	        # and identification by name,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-whoami/jupyterhub_config.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
38	c.JupyterHub.spawner_class = 'simple'
39	c.JupyterHub.ip = '127.0.0.1'  # let's just run on localhost while dummy auth is enabled
40	# default to home page, since we don't want to start servers for this demo
41	c.JupyterHub.default_url = "/hub/home"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-whoami/whoami-oauth.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
24	        self.set_header('content-type', 'application/json')
25	        self.write(json.dumps(user_model, indent=1, sort_keys=True))
26	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-whoami/whoami-oauth.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
42	
43	    http_server = HTTPServer(app)
44	    url = urlparse(os.environ['JUPYTERHUB_SERVICE_URL'])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-whoami/whoami.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	        self.set_header('content-type', 'application/json')
24	        self.write(json.dumps(user_model, indent=1, sort_keys=True))
25	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/examples/service-whoami/whoami.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
34	
35	    http_server = HTTPServer(app)
36	    url = urlparse(os.environ['JUPYTERHUB_SERVICE_URL'])

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/_xsrf_utils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
41	    try:
42	        value = base64.urlsafe_b64decode(b64_value)
43	    except ValueError:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/_xsrf_utils.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
59	    signed_value = handler.create_signed_value(name, value)
60	    return base64.urlsafe_b64encode(signed_value).rstrip(b"=")
61	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/_xsrf_utils.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
307	        hasher.update(b"\xff")
308	    return base64.urlsafe_b64encode(hasher.digest()).decode("ascii")

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
156	        query = self.db.query(class_).options(
157	            joinedload(class_.owner).lazyload("*"),
158	            joinedload(class_.spawner).joinedload(orm.Spawner.user).lazyload("*"),

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
156	        query = self.db.query(class_).options(
157	            joinedload(class_.owner).lazyload("*"),
158	            joinedload(class_.spawner).joinedload(orm.Spawner.user).lazyload("*"),

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
157	            joinedload(class_.owner).lazyload("*"),
158	            joinedload(class_.spawner).joinedload(orm.Spawner.user).lazyload("*"),
159	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
157	            joinedload(class_.owner).lazyload("*"),
158	            joinedload(class_.spawner).joinedload(orm.Spawner.user).lazyload("*"),
159	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
157	            joinedload(class_.owner).lazyload("*"),
158	            joinedload(class_.spawner).joinedload(orm.Spawner.user).lazyload("*"),
159	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
161	            query = query.options(
162	                joinedload(class_.user).joinedload(orm.User.groups).lazyload("*"),
163	                joinedload(class_.group).lazyload("*"),

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
161	            query = query.options(
162	                joinedload(class_.user).joinedload(orm.User.groups).lazyload("*"),
163	                joinedload(class_.group).lazyload("*"),

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
161	            query = query.options(
162	                joinedload(class_.user).joinedload(orm.User.groups).lazyload("*"),
163	                joinedload(class_.group).lazyload("*"),

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
162	                joinedload(class_.user).joinedload(orm.User.groups).lazyload("*"),
163	                joinedload(class_.group).lazyload("*"),
164	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/shares.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
162	                joinedload(class_.user).joinedload(orm.User.groups).lazyload("*"),
163	                joinedload(class_.group).lazyload("*"),
164	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	        model["scopes"] = sorted(self.expanded_scopes.difference(_added_scopes))
83	        self.write(json.dumps(model))
84	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
223	
224	        self.write(json.dumps(data))
225	        # if testing with raiseload above, need expire_all to avoid affecting other operations

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
280	
281	        self.write(json.dumps([self.user_model(u) for u in created]))
282	        self.set_status(201)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
304	            model['auth_state'] = await user.get_auth_state()
305	        self.write(json.dumps(model))
306	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
333	
334	        self.write(json.dumps(self.user_model(user)))
335	        self.set_status(201)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
401	        user_['auth_state'] = await user.get_auth_state()
402	        self.write(json.dumps(user_))
403	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
437	
438	        self.write(json.dumps({'api_tokens': api_tokens}))
439	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
555	        token_model['token'] = api_token
556	        self.write(json.dumps(token_model))
557	        self.set_status(201)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
589	        token = self.find_token_by_id(user, token_id)
590	        self.write(json.dumps(self.token_model(token)))
591	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
778	        try:
779	            self.write(f'data: {json.dumps(event)}\n\n')
780	            await self.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/apihandlers/users.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
800	            try:
801	                self.write("\n\n")
802	                await self.flush()

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
189	    def _default_name(self):
190	        return getuser()
191	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:190
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
189	    def _default_name(self):
190	        return getuser()
191	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
213	
214	        ThreadPoolExecutor(1).submit(init_roles_and_users).result()
215	        user = orm.User.find(hub.db, self.name)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
291	                    try:
292	                        cls = entry_point.load()
293	                    except Exception as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:731
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
730	    bind_url = Unicode(
731	        "http://:8000",
732	        help="""The public facing URL of the whole JupyterHub application.
733	
734	        This is the address on which the proxy will bind.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
757	        config=True,
758	        help="""Set the public URL of JupyterHub
759	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
805	            self.log.warning(
806	                f"Adding missing protocol 'https://' to JupyterHub.public_url = {url!r}"
807	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
811	        '',
812	        help="""Run single-user servers on subdomains of this host.
813	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
833	            self.log.warning(
834	                f"Adding missing protocol 'https://' to JupyterHub.subdomain_host = {new!r}"
835	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
977	        )
978	        self.config.ConfigurableHTTPProxy.api_url = 'http://{}:{}'.format(
979	            self.proxy_api_ip or '127.0.0.1', self.proxy_api_port or self.port + 1

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
978	        self.config.ConfigurableHTTPProxy.api_url = 'http://{}:{}'.format(
979	            self.proxy_api_ip or '127.0.0.1', self.proxy_api_port or self.port + 1
980	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1004	    hub_ip = Unicode(
1005	        '127.0.0.1',
1006	        help="""The ip address for the Hub process to *bind* to.
1007	
1008	        By default, the hub listens on localhost only. This address must be accessible from

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1052	    hub_bind_url = Unicode(
1053	        help="""
1054	        The URL on which the Hub will listen.
1055	        This is a private URL for internal communication.
1056	        Typically set in combination with hub_connect_url.
1057	        If a unix socket, hub_connect_url **must** also be set.
1058	
1059	        For example:
1060	
1061	            "http://127.0.0.1:8081"
1062	            "unix+http://%2Fsrv%2Fjupyterhub%2Fjupyterhub.sock"
1063	
1064	        .. versionadded:: 0.9
1065	        """,
1066	        config=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1244	        self.log.warning(
1245	            "JupyterHub.api_tokens is pending deprecation"
1246	            " since JupyterHub version 0.8."
1247	            "  Consider using JupyterHub.service_tokens."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1261	        Dict(),
1262	        help="""List of service specification dictionaries.
1263	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1523	        False,
1524	        help="""DEPRECATED since version 2.0.0.
1525	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
1811	        parent, fname = os.path.split(path)
1812	        user = getuser()
1813	        if not os.path.isdir(parent):

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1812
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
1811	        parent, fname = os.path.split(path)
1812	        user = getuser()
1813	        if not os.path.isdir(parent):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1842	                with open(secret_file) as f:
1843	                    text_secret = f.read().strip()
1844	                if HEX_RE.match(text_secret):

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
1842	                with open(secret_file) as f:
1843	                    text_secret = f.read().strip()
1844	                if HEX_RE.match(text_secret):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1882	            with open(secret_file, 'w') as f:
1883	                f.write(text_secret)
1884	                f.write('\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1883	                f.write(text_secret)
1884	                f.write('\n')
1885	            if not _mswindows:  # Windows permissions don't follow POSIX rules

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1886	                try:
1887	                    os.chmod(secret_file, 0o600)
1888	                except OSError:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:1887
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1886	                try:
1887	                    os.chmod(secret_file, 0o600)
1888	                except OSError:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
3099	            .options(
3100	                joinedload(orm.User._orm_spawners),
3101	                joinedload(orm.Spawner.server),

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
3100	                joinedload(orm.User._orm_spawners),
3101	                joinedload(orm.Spawner.server),
3102	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3330	            with open(self.pid_file, 'w') as f:
3331	                f.write(str(pid))
3332	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3541	        with open(self.config_file, mode='w') as f:
3542	            f.write(config_text)
3543	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
3724	        # start the webserver
3725	        self.http_server = tornado.httpserver.HTTPServer(
3726	            self.tornado_application,
3727	            ssl_options=ssl_context,
3728	            xheaders=True,
3729	            trusted_downstream=self.trusted_downstream_ips,
3730	        )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3786	        # register cleanup on both TERM and INT
3787	        self.init_signal()
3788	        self._start_future.set_result(None)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
3797	            else:
3798	                signal.signal(s, self.win_shutdown_cancel_tasks)
3799	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3798
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
3797	            else:
3798	                signal.signal(s, self.win_shutdown_cancel_tasks)
3799	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3932
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3931	        except Exception:
3932	            loop.close()
3933	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/app.py:3941
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
3940	            loop.stop()
3941	            loop.close()
3942	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/auth.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	            dedent(
40	                """
41	                The shared database session at Authenticator.db is deprecated, and will be removed.
42	                Please manage your own database and connections.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/auth.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1235	        if p.returncode:
1236	            err = p.stdout.read().decode('utf8', 'replace')
1237	            raise RuntimeError(f"Failed to create system user {name}: {err}")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/auth.py:1248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1247	    def _default_executor(self):
1248	        return ThreadPoolExecutor(self.executor_threads)
1249	

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/auth.py:1465
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
1464	            uid = pwd.getpwnam(username).pw_uid
1465	            username = pwd.getpwuid(uid).pw_name
1466	            username = self.username_map.get(username, username)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/crypto.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
56	        try:
57	            key = base64.urlsafe_b64decode(key)
58	        except ValueError:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/crypto.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
99	    def _executor_default(self):
100	        return ThreadPoolExecutor(self.n_threads)
101	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/crypto.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
122	            return None
123	        return MultiFernet([Fernet(base64.urlsafe_b64encode(key)) for key in self.keys])
124	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/dbutil.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	    with open(ALEMBIC_INI_TEMPLATE_PATH) as f:
36	        alembic_ini_tpl = f.read()
37	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/dbutil.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	    with open(alembic_ini, 'w') as f:
39	        f.write(
40	            alembic_ini_tpl.format(
41	                alembic_dir=ALEMBIC_DIR,
42	                # If there are any %s in the URL, they should be replaced with %%, since ConfigParser
43	                # by default uses %() for substitution. You'll get %s in your URL when you have usernames
44	                # with special chars (such as '@') that need to be URL encoded. URL Encoding is done with %s.
45	                # YAY for nested templates?
46	                db_url=str(db_url).replace('%', '%%'),
47	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/dbutil.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
38	    with open(alembic_ini, 'w') as f:
39	        f.write(
40	            alembic_ini_tpl.format(
41	                alembic_dir=ALEMBIC_DIR,
42	                # If there are any %s in the URL, they should be replaced with %%, since ConfigParser
43	                # by default uses %() for substitution. You'll get %s in your URL when you have usernames
44	                # with special chars (such as '@') that need to be URL encoded. URL Encoding is done with %s.
45	                # YAY for nested templates?
46	                db_url=str(db_url).replace('%', '%%'),
47	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/handlers/base.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1133	            self.eventlog.emit(
1134	                schema_id='https://schema.jupyter.org/jupyterhub/events/server-action',
1135	                data={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/handlers/base.py:1357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1356	                self.eventlog.emit(
1357	                    schema_id='https://schema.jupyter.org/jupyterhub/events/server-action',
1358	                    data={

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/handlers/base.py:1692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1691	
1692	        self._fail_api_request(user_name, server_name)
1693	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/handlers/base.py:1783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1782	        ) == 'application/json' or 'api' in user_path.split('/'):
1783	            self._fail_api_request(user_name, server_name)
1784	            return

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/objects.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
52	        """
53	        if self.ip in {'', '0.0.0.0', '::'}:
54	            return self.url.replace(self._connect_ip, fmt_ip_url(self.ip) or '*', 1)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/objects.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
92	            return self.connect_ip
93	        elif self.ip in {'', '0.0.0.0', '::'}:
94	            # if listening on all interfaces, default to hostname for connect

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/objects.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
94	            # if listening on all interfaces, default to hostname for connect
95	            return socket.gethostname()
96	        else:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/objects.py:95
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
94	            # if listening on all interfaces, default to hostname for connect
95	            return socket.gethostname()
96	        else:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/objects.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
187	        """Is the server accepting connections?"""
188	        return can_connect(self._connect_ip, self._connect_port)
189	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/proxy.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
627	            with open(pid_file) as f:
628	                pid = int(f.read().strip())
629	        except ValueError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/proxy.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
671	        with open(self.pid_file, "w") as f:
672	            f.write(str(self.proxy_process.pid))
673	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/proxy.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
964	        path = self._routespec_to_chp_path(routespec)
965	        await self.api_request(path, method='POST', body=body)
966	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/proxy.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
969	        try:
970	            await self.api_request(path, method='DELETE')
971	        except HTTPError as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/proxy.py:989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
988	        proxy_poll_start_time = time.perf_counter()
989	        resp = await self.api_request('', client=client)
990	        chp_routes = json.loads(resp.body.decode('utf8', 'replace'))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/auth.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
288	    api_url = Unicode(
289	        os.getenv('JUPYTERHUB_API_URL') or 'http://127.0.0.1:8081/hub/api',
290	        help="""The base API URL of the Hub.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/auth.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
289	        os.getenv('JUPYTERHUB_API_URL') or 'http://127.0.0.1:8081/hub/api',
290	        help="""The base API URL of the Hub.
291	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/auth.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	        else:
303	            return 'http://127.0.0.1:8081' + url_path_join(self.hub_prefix, 'api')
304	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/auth.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
523	
524	        pool = ThreadPoolExecutor(1)
525	        # create an event loop in the thread

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/auth.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
579	
580	        data = await self._api_request(
581	            'GET',
582	            url,
583	            headers={"Authorization": "token " + api_token},
584	            allow_403=True,
585	        )

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/auth.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
616	            msg = f"Failed to connect to Hub API at {self.api_url!r}."
617	            msg += f"  Is the Hub accessible at this URL (from host: {socket.gethostname()})?"
618	            if '127.0.0.1' in self.api_url:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/auth.py:617
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
616	            msg = f"Failed to connect to Hub API at {self.api_url!r}."
617	            msg += f"  Is the Hub accessible at this URL (from host: {socket.gethostname()})?"
618	            if '127.0.0.1' in self.api_url:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/auth.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
617	            msg += f"  Is the Hub accessible at this URL (from host: {socket.gethostname()})?"
618	            if '127.0.0.1' in self.api_url:
619	                msg += (

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/auth.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1100	
1101	        token_reply = await self._api_request(
1102	            'POST',
1103	            self.oauth_token_url,
1104	            body=urlencode(params).encode('utf8'),
1105	            headers={'Content-Type': 'application/x-www-form-urlencoded'},
1106	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/service.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
432	        hub = self.hub
433	        if self.hub.ip in ('', '0.0.0.0', '::'):
434	            # if the Hub is listening on all interfaces,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/services/service.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
441	            else:
442	                hub.connect_ip = "127.0.0.1"
443	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/singleuser/mixins.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
254	    def _hub_api_url_default(self):
255	        return os.environ.get('JUPYTERHUB_API_URL') or 'http://127.0.0.1:8081/hub/api'
256	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/singleuser/mixins.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
292	            return ""
293	        return '127.0.0.1'
294	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/singleuser/mixins.py:760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
759	        with template_dir.joinpath("page.html").open() as f:
760	            page_template = f.read()
761	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/singleuser/mixins.py:760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
759	        with template_dir.joinpath("page.html").open() as f:
760	            page_template = f.read()
761	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/spawner.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
182	            dedent(
183	                """
184	                The shared database session at Spawner.db is deprecated, and will be removed.
185	                Please manage your own database and connections.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/spawner.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
468	    ip = Unicode(
469	        '127.0.0.1',
470	        help="""
471	        The IP address (or hostname) the single-user server should listen on.
472	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/spawner.py:2022
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2021	        out_dir = f"{hub_dir}/jupyterhub-certs"
2022	        shutil.rmtree(out_dir, ignore_errors=True)
2023	        os.makedirs(out_dir, 0o700, exist_ok=True)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/spawner.py:2078
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
2077	
2078	        return (self.ip or '127.0.0.1', self.port)
2079	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/spawner.py:2108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2107	        else:
2108	            alive = await self._signal(0)
2109	        if not alive:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/spawner.py:2144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2143	            self.log.debug("Interrupting %i", self.pid)
2144	            await self._signal(signal.SIGINT)
2145	            await self.wait_for_death(self.interrupt_timeout)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/spawner.py:2152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2151	        self.log.debug("Terminating %i", self.pid)
2152	        await self._signal(signal.SIGTERM)
2153	        await self.wait_for_death(self.term_timeout)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/spawner.py:2160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
2159	        self.log.debug("Killing %i", self.pid)
2160	        await self._signal(signal.SIGKILL)
2161	        await self.wait_for_death(self.kill_timeout)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	    await browser.goto(login_url)
118	    if params.get("next"):
119	        params["next"] = url_path_join(app.base_url, params["next"])

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
582	    # verify that "Your new API Token" panel is hidden after refresh the page
583	    await browser.reload(wait_until="load")
584	    await expect(token_area).to_be_hidden()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
635	        # reload the page
636	        await browser.reload(wait_until="load")
637	    # API Tokens table: verify that elements are displayed

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
744	
745	    await browser.reload(wait_until="load")
746	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
800	        # reload the page
801	        await browser.reload(wait_until="load")
802	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:1046
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1045	            f"{sd['description']} Applies to {sd['filter']}."
1046	            if sd.get('filter')
1047	            else sd['description']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:1521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1520	    assert hub_prefix in cookie_dict
1521	    target_xsrf = cookie_dict[target_prefix].get("_xsrf", {}).get("value")
1522	    assert target_xsrf

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:1521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1520	    assert hub_prefix in cookie_dict
1521	    target_xsrf = cookie_dict[target_prefix].get("_xsrf", {}).get("value")
1522	    assert target_xsrf

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:1523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1522	    assert target_xsrf
1523	    user_xsrf = cookie_dict[user_prefix].get("_xsrf", {}).get("value")
1524	    assert user_xsrf

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:1523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1522	    assert target_xsrf
1523	    user_xsrf = cookie_dict[user_prefix].get("_xsrf", {}).get("value")
1524	    assert user_xsrf

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:1525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1524	    assert user_xsrf
1525	    hub_xsrf = cookie_dict[hub_prefix].get("_xsrf", {}).get("value")
1526	    assert hub_xsrf

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:1525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1524	    assert user_xsrf
1525	    hub_xsrf = cookie_dict[hub_prefix].get("_xsrf", {}).get("value")
1526	    assert hub_xsrf

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_browser.py:1606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1605	        headers = {"Authorization": f"Bearer {token}"}
1606	        r = await async_requests.post(kernels_url, headers=headers)
1607	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/browser/test_share.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
27	    share_url = f"share-codes/{user.name}/{spawner.name}"
28	    r = await api_request(
29	        app,
30	        share_url,
31	        method="post",
32	        name=user.name,
33	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/conftest.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
377	        if app.internal_ssl:
378	            spec['url'] = f'https://127.0.0.1:{port}'
379	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/conftest.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
379	        else:
380	            spec['url'] = f'http://127.0.0.1:{port}'
381	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/conftest.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
382	    if external:
383	        spec['oauth_redirect_uri'] = f'http://127.0.0.1:{port}'
384	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/conftest.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
642	        "api_token": f"api_token-{service_name}",
643	        "oauth_redirect_uri": "http://127.0.0.1:5555/oauth_callback-from-api",
644	        "oauth_no_confirm": True,
645	        "oauth_client_allowed_scopes": ["inherit"],
646	        "info": {'foo': 'bar'},
647	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mocking.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	            port = random_port()
266	        return f'http://127.0.0.1:{port}/@/space%20word/'
267	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mocking.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
269	    def _ip_default(self):
270	        return '127.0.0.1'
271	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mocking.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
374	
375	        with ThreadPoolExecutor(1) as pool:
376	            f = pool.submit(cleanup)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	    def get(self):
39	        self.write(self.request.path)
40	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
46	        self.set_header('Content-Type', 'application/json')
47	        self.write(json.dumps(dict(os.environ)))
48	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	        api_url = os.environ['JUPYTERHUB_API_URL']
56	        r = requests.get(
57	            api_url + path, headers={'Authorization': f'token {api_token}'}
58	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
60	        self.set_header('Content-Type', 'application/json')
61	        self.write(r.text)
62	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
71	    def get(self):
72	        self.write(json.dumps(self.get_current_user()))
73	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	    def get(self):
90	        self.write(json.dumps(self.get_current_user()))
91	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	        ssl_context = None
111	        key = os.environ.get('JUPYTERHUB_SSL_KEYFILE') or ''
112	        cert = os.environ.get('JUPYTERHUB_SSL_CERTFILE') or ''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	        key = os.environ.get('JUPYTERHUB_SSL_KEYFILE') or ''
112	        cert = os.environ.get('JUPYTERHUB_SSL_CERTFILE') or ''
113	        ca = os.environ.get('JUPYTERHUB_SSL_CLIENT_CA') or ''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	        cert = os.environ.get('JUPYTERHUB_SSL_CERTFILE') or ''
113	        ca = os.environ.get('JUPYTERHUB_SSL_CLIENT_CA') or ''
114	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mockservice.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
119	
120	        server = httpserver.HTTPServer(app, ssl_options=ssl_context)
121	        server.listen(url.port, url.hostname)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mocksu.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
28	    def get(self):
29	        self.write(self.request.path)
30	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mocksu.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
33	    def get(self):
34	        self.write(json.dumps(sys.argv))
35	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/mocksu.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
57	
58	    server = httpserver.HTTPServer(app, ssl_options=ssl_context)
59	    log.app_log.info(f"Starting mock singleuser server at {url.hostname}:{url.port}")

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
43	    db = app.db
44	    r = await api_request(app, 'authorizations', 'gobbledygook')
45	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
43	    db = app.db
44	    r = await api_request(app, 'authorizations', 'gobbledygook')
45	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
51	    # check success:
52	    r = await api_request(app, 'authorizations/token', api_token)
53	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
51	    # check success:
52	    r = await api_request(app, 'authorizations/token', api_token)
53	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
57	    # check fail
58	    r = await api_request(
59	        app, 'authorizations/token', api_token, headers={'Authorization': 'no sir'}
60	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
57	    # check fail
58	    r = await api_request(
59	        app, 'authorizations/token', api_token, headers={'Authorization': 'no sir'}
60	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
62	
63	    r = await api_request(
64	        app,
65	        'authorizations/token',
66	        api_token,
67	        headers={'Authorization': f'token: {user.cookie_id}'},
68	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
62	
63	    r = await api_request(
64	        app,
65	        'authorizations/token',
66	        api_token,
67	        headers={'Authorization': f'token: {user.cookie_id}'},
68	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
88	
89	    r = await api_request(
90	        app,
91	        'users',
92	        method='post',
93	        data='{}',
94	        headers={
95	            "Authorization": "",
96	            "Content-Type": content_type,
97	        },
98	        cookies=cookies,
99	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
88	
89	    r = await api_request(
90	        app,
91	        'users',
92	        method='post',
93	        data='{}',
94	        headers={
95	            "Authorization": "",
96	            "Content-Type": content_type,
97	        },
98	        cookies=cookies,
99	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
124	
125	    r = await api_request(
126	        app,
127	        url,
128	        noauth=True,
129	        cookies=cookies,
130	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
124	
125	    r = await api_request(
126	        app,
127	        url,
128	        noauth=True,
129	        cookies=cookies,
130	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	    headers['Sec-Fetch-Mode'] = 'cors'
165	    r = await async_requests.get(url, **kwargs)
166	    assert r.status_code == 403

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	            if isinstance(server['state'], dict) and isinstance(
205	                server['state'].get('pid', None), int
206	            ):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
235	
236	    r = await api_request(app, 'users', headers=auth_header(db, 'admin'))
237	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
235	
236	    r = await api_request(app, 'users', headers=auth_header(db, 'admin'))
237	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
257	    ]
258	    r = await api_request(app, 'users', headers=auth_header(db, 'user'))
259	    assert r.status_code == 403

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
257	    ]
258	    r = await api_request(app, 'users', headers=auth_header(db, 'user'))
259	    assert r.status_code == 403

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
371	        headers['Accept'] = PAGINATION_MEDIA_TYPE
372	    r = await api_request(app, url, headers=headers)
373	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
371	        headers['Accept'] = PAGINATION_MEDIA_TYPE
372	    r = await api_request(app, url, headers=headers)
373	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
458	
459	    r = await api_request(
460	        app, f'users?state={state}', headers={"Accept": PAGINATION_MEDIA_TYPE}
461	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
458	
459	    r = await api_request(
460	        app, f'users?state={state}', headers={"Accept": PAGINATION_MEDIA_TYPE}
461	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
490	
491	    r = await api_request(app, 'users')
492	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
490	
491	    r = await api_request(app, 'users')
492	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
492	    assert r.status_code == 200
493	    response_users = [u.get("name") for u in r.json()]
494	    assert added_usernames.intersection(response_users) == added_usernames

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
495	
496	    r = await api_request(app, 'users?name_filter=q')
497	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
495	
496	    r = await api_request(app, 'users?name_filter=q')
497	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
497	    assert r.status_code == 200
498	    response_users = [u.get("name") for u in r.json()]
499	    assert response_users == ['q', 'qr', 'qrs', 'qrst']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
500	
501	    r = await api_request(app, 'users?name_filter=qr')
502	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
500	
501	    r = await api_request(app, 'users?name_filter=qr')
502	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
502	    assert r.status_code == 200
503	    response_users = [u.get("name") for u in r.json()]
504	    assert response_users == ['qr', 'qrs', 'qrst']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
505	
506	    r = await api_request(app, 'users?name_filter=qrs')
507	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
505	
506	    r = await api_request(app, 'users?name_filter=qrs')
507	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
507	    assert r.status_code == 200
508	    response_users = [u.get("name") for u in r.json()]
509	    assert response_users == ['qrs', 'qrst']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
510	
511	    r = await api_request(app, 'users?name_filter=qrst')
512	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
510	
511	    r = await api_request(app, 'users?name_filter=qrst')
512	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
512	    assert r.status_code == 200
513	    response_users = [u.get("name") for u in r.json()]
514	    assert response_users == ['qrst']

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
564	
565	    r = await api_request(
566	        app, 'users', params=params, headers={"Accept": PAGINATION_MEDIA_TYPE}
567	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
564	
565	    r = await api_request(
566	        app, 'users', params=params, headers={"Accept": PAGINATION_MEDIA_TYPE}
567	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
576	    params["offset"] = page_1["_pagination"]["next"]["offset"]
577	    r = await api_request(
578	        app, 'users', params=params, headers={"Accept": PAGINATION_MEDIA_TYPE}
579	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
576	    params["offset"] = page_1["_pagination"]["next"]["offset"]
577	    r = await api_request(
578	        app, 'users', params=params, headers={"Accept": PAGINATION_MEDIA_TYPE}
579	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
591	async def test_get_users_sort_invalid(app):
592	    r = await api_request(app, "users", params={"sort": "servers"})
593	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
591	async def test_get_users_sort_invalid(app):
592	    r = await api_request(app, "users", params={"sort": "servers"})
593	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
593	    assert r.status_code == 400
594	    r = await api_request(app, "users", params={"sort": "--id"})
595	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
593	    assert r.status_code == 400
594	    r = await api_request(app, "users", params={"sort": "--id"})
595	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
602	    # basic get self
603	    r = await api_request(app, 'user')
604	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
602	    # basic get self
603	    r = await api_request(app, 'user')
604	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
620	    db.commit()
621	    r = await api_request(
622	        app,
623	        'user',
624	        headers={'Authorization': 'token ' + token},
625	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
620	    db.commit()
621	    r = await api_request(
622	        app,
623	        'user',
624	        headers={'Authorization': 'token ' + token},
625	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
631	    # invalid auth gets 403
632	    r = await api_request(
633	        app,
634	        'user',
635	        headers={'Authorization': 'token notvalid'},
636	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
631	    # invalid auth gets 403
632	    r = await api_request(
633	        app,
634	        'user',
635	        headers={'Authorization': 'token notvalid'},
636	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
640	async def test_get_self_service(app, mockservice):
641	    r = await api_request(
642	        app, "user", headers={"Authorization": f"token {mockservice.api_token}"}
643	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
640	async def test_get_self_service(app, mockservice):
641	    r = await api_request(
642	        app, "user", headers={"Authorization": f"token {mockservice.api_token}"}
643	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
655	    name = 'newuser'
656	    r = await api_request(app, 'users', name, method='post')
657	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
655	    name = 'newuser'
656	    r = await api_request(app, 'users', name, method='post')
657	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
671	    # get own model
672	    r = await api_request(app, 'users', name, headers=auth_header(app.db, name))
673	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
671	    # get own model
672	    r = await api_request(app, 'users', name, headers=auth_header(app.db, name))
673	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
674	    # admin request
675	    r = await api_request(
676	        app,
677	        'users',
678	        name,
679	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
674	    # admin request
675	    r = await api_request(
676	        app,
677	        'users',
678	        name,
679	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
685	    # admin request, no such user
686	    r = await api_request(
687	        app,
688	        'users',
689	        'nosuchuser',
690	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
685	    # admin request, no such user
686	    r = await api_request(
687	        app,
688	        'users',
689	        'nosuchuser',
690	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
693	    # unauthorized request, no such user
694	    r = await api_request(
695	        app,
696	        'users',
697	        'nosuchuser',
698	        headers=auth_header(app.db, name),
699	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
693	    # unauthorized request, no such user
694	    r = await api_request(
695	        app,
696	        'users',
697	        'nosuchuser',
698	        headers=auth_header(app.db, name),
699	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
702	    # unauthorized request for existing user
703	    r = await api_request(
704	        app,
705	        'users',
706	        'admin',
707	        headers=auth_header(app.db, name),
708	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
702	    # unauthorized request for existing user
703	    r = await api_request(
704	        app,
705	        'users',
706	        'admin',
707	        headers=auth_header(app.db, name),
708	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
713	async def test_add_multi_user_bad(app):
714	    r = await api_request(app, 'users', method='post')
715	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
713	async def test_add_multi_user_bad(app):
714	    r = await api_request(app, 'users', method='post')
715	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
715	    assert r.status_code == 400
716	    r = await api_request(app, 'users', method='post', data='{}')
717	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
715	    assert r.status_code == 400
716	    r = await api_request(app, 'users', method='post', data='{}')
717	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
717	    assert r.status_code == 400
718	    r = await api_request(app, 'users', method='post', data='[]')
719	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
717	    assert r.status_code == 400
718	    r = await api_request(app, 'users', method='post', data='[]')
719	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
724	    app.authenticator.username_pattern = r'w.*'
725	    r = await api_request(
726	        app,
727	        'users',
728	        method='post',
729	        data=json.dumps({'usernames': ['Willow', 'Andrew', 'Tara']}),
730	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
724	    app.authenticator.username_pattern = r'w.*'
725	    r = await api_request(
726	        app,
727	        'users',
728	        method='post',
729	        data=json.dumps({'usernames': ['Willow', 'Andrew', 'Tara']}),
730	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
740	    names = ['a', 'b']
741	    r = await api_request(
742	        app, 'users', method='post', data=json.dumps({'usernames': names})
743	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
740	    names = ['a', 'b']
741	    r = await api_request(
742	        app, 'users', method='post', data=json.dumps({'usernames': names})
743	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
758	    # try to create the same users again
759	    r = await api_request(
760	        app, 'users', method='post', data=json.dumps({'usernames': names})
761	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
758	    # try to create the same users again
759	    r = await api_request(
760	        app, 'users', method='post', data=json.dumps({'usernames': names})
761	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
766	    # try to create the same users again
767	    r = await api_request(
768	        app, 'users', method='post', data=json.dumps({'usernames': names})
769	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
766	    # try to create the same users again
767	    r = await api_request(
768	        app, 'users', method='post', data=json.dumps({'usernames': names})
769	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
784	    names = ['c', 'd']
785	    r = await api_request(
786	        app,
787	        'users',
788	        method='post',
789	        data=json.dumps({'usernames': names, 'admin': True}),
790	        name=requester.name,
791	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
784	    names = ['c', 'd']
785	    r = await api_request(
786	        app,
787	        'users',
788	        method='post',
789	        data=json.dumps({'usernames': names, 'admin': True}),
790	        name=requester.name,
791	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
813	    name = 'dne_newuser'
814	    r = await api_request(app, 'users', name, method='post')
815	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
813	    name = 'dne_newuser'
814	    r = await api_request(app, 'users', name, method='post')
815	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:827
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
826	    assert user is not None
827	    r = await api_request(app, 'users', name, method='post')
828	    # special 409 conflict for creating a user that already exists

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:827
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
826	    assert user is not None
827	    r = await api_request(app, 'users', name, method='post')
828	    # special 409 conflict for creating a user that already exists

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
840	    db.commit()
841	    r = await api_request(
842	        app,
843	        'users',
844	        name,
845	        method='post',
846	        data=json.dumps({'admin': True}),
847	        name=user.name,
848	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
840	    db.commit()
841	    r = await api_request(
842	        app,
843	        'users',
844	        name,
845	        method='post',
846	        data=json.dumps({'admin': True}),
847	        name=user.name,
848	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:867
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
866	    mal = add_user(db, name='mal')
867	    r = await api_request(app, 'users', 'mal', method='delete')
868	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:867
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
866	    mal = add_user(db, name='mal')
867	    r = await api_request(app, 'users', 'mal', method='delete')
868	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:881
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
880	    name = new_username("make_admin")
881	    r = await api_request(app, 'users', name, method='post')
882	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:881
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
880	    name = new_username("make_admin")
881	    r = await api_request(app, 'users', name, method='post')
882	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
889	
890	    r = await api_request(
891	        app,
892	        'users',
893	        name,
894	        method='patch',
895	        data=json.dumps({'admin': True}),
896	        name=requester.name,
897	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
889	
890	    r = await api_request(
891	        app,
892	        'users',
893	        name,
894	        method='patch',
895	        data=json.dumps({'admin': True}),
896	        name=requester.name,
897	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
923	
924	    r = await api_request(
925	        app,
926	        'users',
927	        user.name,
928	        method='patch',
929	        data=json.dumps({'name': new_name}),
930	        name=requester.name,
931	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
923	
924	    r = await api_request(
925	        app,
926	        'users',
927	        user.name,
928	        method='patch',
929	        data=json.dumps({'name': new_name}),
930	        name=requester.name,
931	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
951	
952	    r = await api_request(
953	        app, 'users', name, method='patch', data=json.dumps({'auth_state': auth_state})
954	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
951	
952	    r = await api_request(
953	        app, 'users', name, method='patch', data=json.dumps({'auth_state': auth_state})
954	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:971
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
970	    assert user_auth_state is None
971	    r = await api_request(
972	        app,
973	        'users',
974	        name,
975	        method='patch',
976	        data=json.dumps({'auth_state': auth_state}),
977	        headers=auth_header(app.db, name),
978	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:971
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
970	    assert user_auth_state is None
971	    r = await api_request(
972	        app,
973	        'users',
974	        name,
975	        method='patch',
976	        data=json.dumps({'auth_state': auth_state}),
977	        headers=auth_header(app.db, name),
978	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:994
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
993	
994	    r = await api_request(app, 'users', name)
995	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:994
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
993	
994	    r = await api_request(app, 'users', name)
995	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1010	
1011	    r = await api_request(app, 'users', name, headers=auth_header(app.db, name))
1012	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1010	
1011	    r = await api_request(app, 'users', name, headers=auth_header(app.db, name))
1012	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1022	    before_servers = sorted(db.query(orm.Server), key=lambda s: s.url)
1023	    r = await api_request(
1024	        app, 'users', name, 'server', method='post', data=json.dumps(options)
1025	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1022	    before_servers = sorted(db.query(orm.Server), key=lambda s: s.url)
1023	    r = await api_request(
1024	        app, 'users', name, 'server', method='post', data=json.dumps(options)
1025	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1041	        kwargs["verify"] = app.internal_ssl_ca
1042	    r = await async_requests.get(url, **kwargs)
1043	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1046
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1045	
1046	    r = await async_requests.get(ujoin(url, 'args'), **kwargs)
1047	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1052
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1051	    assert len(argv) == 1
1052	    r = await async_requests.get(ujoin(url, 'env'), **kwargs)
1053	    env = r.json()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1063	
1064	    r = await api_request(app, 'users', name, 'server', method='delete')
1065	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1063	
1064	    r = await api_request(app, 'users', name, 'server', method='delete')
1065	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1086
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1085	    before_servers = sorted(db.query(orm.Server), key=lambda s: s.url)
1086	    r = await api_request(
1087	        app, 'users', name, 'server', method='post', data=json.dumps(options)
1088	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1086
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1085	    before_servers = sorted(db.query(orm.Server), key=lambda s: s.url)
1086	    r = await api_request(
1087	        app, 'users', name, 'server', method='post', data=json.dumps(options)
1088	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1098
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1097	    # stop the server
1098	    r = await api_request(app, 'users', name, 'server', method='delete')
1099	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1098
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1097	    # stop the server
1098	    r = await api_request(app, 'users', name, 'server', method='delete')
1099	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1104	    # should re-use options from last spawn
1105	    r = await api_request(app, 'users', name, 'server', method='post')
1106	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1104	    # should re-use options from last spawn
1105	    r = await api_request(app, 'users', name, 'server', method='post')
1106	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1113	    # stop the server
1114	    r = await api_request(app, 'users', name, 'server', method='delete')
1115	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1113	    # stop the server
1114	    r = await api_request(app, 'users', name, 'server', method='delete')
1115	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1118	    new_options = {'key': 'value'}
1119	    r = await api_request(
1120	        app, 'users', name, 'server', method='post', data=json.dumps(new_options)
1121	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1118	    new_options = {'key': 'value'}
1119	    r = await api_request(
1120	        app, 'users', name, 'server', method='post', data=json.dumps(new_options)
1121	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1139	    # spawn via API with ?foo=bar
1140	    r = await api_request(
1141	        app, 'users', name, 'server', method='post', params={'foo': 'bar'}
1142	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1139	    # spawn via API with ?foo=bar
1140	    r = await api_request(
1141	        app, 'users', name, 'server', method='post', params={'foo': 'bar'}
1142	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1150	    url = public_url(app, user)
1151	    r = await async_requests.get(ujoin(url, 'env'), **kwargs)
1152	    env = r.json()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1157	
1158	    r = await api_request(app, 'users', name, 'server', method='delete')
1159	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1157	
1158	    r = await api_request(app, 'users', name, 'server', method='delete')
1159	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1166	    app_user = add_user(db, app=app, name=name)
1167	    r = await api_request(app, 'users', name, 'server', method='post')
1168	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1166	    app_user = add_user(db, app=app, name=name)
1167	    r = await api_request(app, 'users', name, 'server', method='post')
1168	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1187	
1188	    r = await api_request(app, 'users', name, 'server', method='delete')
1189	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1187	
1188	    r = await api_request(app, 'users', name, 'server', method='delete')
1189	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1193	
1194	    r = await api_request(app, 'users', name, 'server', method='delete')
1195	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1193	
1194	    r = await api_request(app, 'users', name, 'server', method='delete')
1195	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1202	    assert app_user.spawner is not None
1203	    r = await api_request(app, 'users', name, 'server', method='delete')
1204	    # 204 deleted if there's no such server

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1202	    assert app_user.spawner is not None
1203	    r = await api_request(app, 'users', name, 'server', method='delete')
1204	    # 204 deleted if there's no such server

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1213	    app_user = add_user(db, app=app, name=name)
1214	    r = await api_request(app, 'users', name, 'server', method='post')
1215	    assert app_user.spawner is not None

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1213	    app_user = add_user(db, app=app, name=name)
1214	    r = await api_request(app, 'users', name, 'server', method='post')
1215	    assert app_user.spawner is not None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1233	    user = add_user(db, app=app, name=name)
1234	    r = await api_request(app, 'users', name, 'server', method='post')
1235	    # check that we don't re-use spawners that failed

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1233	    user = add_user(db, app=app, name=name)
1234	    r = await api_request(app, 'users', name, 'server', method='post')
1235	    # check that we don't re-use spawners that failed

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1239	
1240	    r = await api_request(app, 'users', name, 'server', method='post')
1241	    # check that we don't re-use spawners that failed

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1239	
1240	    r = await api_request(app, 'users', name, 'server', method='post')
1241	    # check that we don't re-use spawners that failed

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1246	async def test_spawn_nosuch_user(app):
1247	    r = await api_request(app, 'users', "nosuchuser", 'server', method='post')
1248	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1246	async def test_spawn_nosuch_user(app):
1247	    r = await api_request(app, 'users', "nosuchuser", 'server', method='post')
1248	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1254	    user = add_user(db, app=app, name=name)
1255	    r = await api_request(app, 'users', name, 'server', method='post')
1256	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1254	    user = add_user(db, app=app, name=name)
1255	    r = await api_request(app, 'users', name, 'server', method='post')
1256	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1279	    app_user = add_user(db, app=app, name=name)
1280	    r = await api_request(app, 'users', name, 'server', method='post')
1281	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1279	    app_user = add_user(db, app=app, name=name)
1280	    r = await api_request(app, 'users', name, 'server', method='post')
1281	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1281	    r.raise_for_status()
1282	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1283	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1281	    r.raise_for_status()
1282	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1283	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1307	    app_user = add_user(db, app=app, name=name)
1308	    r = await api_request(app, 'users', name, 'server', method='post')
1309	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1307	    app_user = add_user(db, app=app, name=name)
1308	    r = await api_request(app, 'users', name, 'server', method='post')
1309	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1309	    r.raise_for_status()
1310	    r = await api_request(app, 'users', name, 'server', method='delete')
1311	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1309	    r.raise_for_status()
1310	    r = await api_request(app, 'users', name, 'server', method='delete')
1311	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1311	    r.raise_for_status()
1312	    r = await api_request(app, 'users', name, 'server/progress')
1313	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1311	    r.raise_for_status()
1312	    r = await api_request(app, 'users', name, 'server/progress')
1313	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1318	    name = 'noserver'
1319	    r = await api_request(app, 'users', 'nosuchuser', 'server/progress')
1320	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1318	    name = 'noserver'
1319	    r = await api_request(app, 'users', 'nosuchuser', 'server/progress')
1320	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1321	    app_user = add_user(db, app=app, name=name)
1322	    r = await api_request(app, 'users', name, 'server/progress')
1323	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1321	    app_user = add_user(db, app=app, name=name)
1322	    r = await api_request(app, 'users', name, 'server/progress')
1323	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1333	    app_user = add_user(db, app=app, name=name)
1334	    r = await api_request(app, 'users', name, 'server', method='post')
1335	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1333	    app_user = add_user(db, app=app, name=name)
1334	    r = await api_request(app, 'users', name, 'server', method='post')
1335	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1335	    r.raise_for_status()
1336	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1337	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1335	    r.raise_for_status()
1336	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1337	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1360	    spawner.progress_ready_hook = custom_progress_ready_hook
1361	    r = await api_request(app, 'users', name, 'server', method='post')
1362	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1360	    spawner.progress_ready_hook = custom_progress_ready_hook
1361	    r = await api_request(app, 'users', name, 'server', method='post')
1362	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1362	    r.raise_for_status()
1363	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1364	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1362	    r.raise_for_status()
1363	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1364	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1388	    spawner.progress_ready_hook = custom_progress_ready_hook
1389	    r = await api_request(app, 'users', name, 'server', method='post')
1390	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1388	    spawner.progress_ready_hook = custom_progress_ready_hook
1389	    r = await api_request(app, 'users', name, 'server', method='post')
1390	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1390	    r.raise_for_status()
1391	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1392	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1390	    r.raise_for_status()
1391	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1392	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1418	    spawner.progress_ready_hook = custom_progress_ready_hook
1419	    r = await api_request(app, 'users', name, 'server', method='post')
1420	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1418	    spawner.progress_ready_hook = custom_progress_ready_hook
1419	    r = await api_request(app, 'users', name, 'server', method='post')
1420	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1420	    r.raise_for_status()
1421	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1422	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1420	    r.raise_for_status()
1421	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1422	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1438	    app_user = add_user(db, app=app, name=name)
1439	    r = await api_request(app, 'users', name, 'server', method='post')
1440	    assert r.status_code == 500

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1438	    app_user = add_user(db, app=app, name=name)
1439	    r = await api_request(app, 'users', name, 'server', method='post')
1440	    assert r.status_code == 500

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1440	    assert r.status_code == 500
1441	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1442	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1440	    assert r.status_code == 500
1441	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1442	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1459	    app_user = add_user(db, app=app, name=name)
1460	    r = await api_request(app, 'users', name, 'server', method='post')
1461	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1459	    app_user = add_user(db, app=app, name=name)
1460	    r = await api_request(app, 'users', name, 'server', method='post')
1461	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1461	    assert r.status_code == 202
1462	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1463	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1461	    assert r.status_code == 202
1462	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1463	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1498	
1499	    r = await api_request(app, 'users', name, 'server', method='post')
1500	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1498	
1499	    r = await api_request(app, 'users', name, 'server', method='post')
1500	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1500	    r.raise_for_status()
1501	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1502	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1500	    r.raise_for_status()
1501	    r = await api_request(app, 'users', name, 'server/progress', stream=True)
1502	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1525	    for name in names:
1526	        await api_request(app, 'users', name, 'server', method='post')
1527	    assert app.users.count_active_users()['pending'] == 2

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1525	    for name in names:
1526	        await api_request(app, 'users', name, 'server', method='post')
1527	    assert app.users.count_active_users()['pending'] == 2

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1532	    user.spawner._start_future = asyncio.Future()
1533	    r = await api_request(app, 'users', name, 'server', method='post')
1534	    assert r.status_code == 429

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1532	    user.spawner._start_future = asyncio.Future()
1533	    r = await api_request(app, 'users', name, 'server', method='post')
1534	    assert r.status_code == 429

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1542	    assert app.users.count_active_users()['pending'] == 1
1543	    r = await api_request(app, 'users', name, 'server', method='post')
1544	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1542	    assert app.users.count_active_users()['pending'] == 1
1543	    r = await api_request(app, 'users', name, 'server', method='post')
1544	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1556	        u.spawner.delay = 0
1557	        r = await api_request(app, 'users', u.name, 'server', method='delete')
1558	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1556	        u.spawner.delay = 0
1557	        r = await api_request(app, 'users', u.name, 'server', method='delete')
1558	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1573	    for name in names:
1574	        r = await api_request(app, 'users', name, 'server', method='post')
1575	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1573	    for name in names:
1574	        r = await api_request(app, 'users', name, 'server', method='post')
1575	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1583	    user = add_user(db, app=app, name=name)
1584	    r = await api_request(app, 'users', name, 'server', method='post')
1585	    assert r.status_code == 429

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1583	    user = add_user(db, app=app, name=name)
1584	    r = await api_request(app, 'users', name, 'server', method='post')
1585	    assert r.status_code == 429

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1591	    # stop one server
1592	    await api_request(app, 'users', names[0], 'server', method='delete')
1593	    counts = app.users.count_active_users()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1591	    # stop one server
1592	    await api_request(app, 'users', names[0], 'server', method='delete')
1593	    counts = app.users.count_active_users()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1597	
1598	    r = await api_request(app, 'users', name, 'server', method='post')
1599	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1597	
1598	    r = await api_request(app, 'users', name, 'server', method='post')
1599	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1610	            continue
1611	        r = await api_request(app, 'users', u.name, 'server', method='delete')
1612	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1610	            continue
1611	        r = await api_request(app, 'users', u.name, 'server', method='delete')
1612	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1624	    # start the server
1625	    r = await api_request(app, 'users', user.name, 'server', method='post')
1626	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1624	    # start the server
1625	    r = await api_request(app, 'users', user.name, 'server', method='post')
1626	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1630	    with mock.patch.object(spawner, 'start') as m:
1631	        r = await api_request(app, 'users', user.name, 'server', method='post')
1632	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1630	    with mock.patch.object(spawner, 'start') as m:
1631	        r = await api_request(app, 'users', user.name, 'server', method='post')
1632	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1636	    spawner.delay = 3
1637	    r = await api_request(app, 'users', user.name, 'server', method='delete')
1638	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1636	    spawner.delay = 3
1637	    r = await api_request(app, 'users', user.name, 'server', method='delete')
1638	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1645	    with mock.patch.object(spawner, 'stop') as m:
1646	        r = await api_request(app, 'users', user.name, 'server', method='delete')
1647	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1645	    with mock.patch.object(spawner, 'stop') as m:
1646	        r = await api_request(app, 'users', user.name, 'server', method='delete')
1647	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1650	    with mock.patch.object(spawner, 'start') as m:
1651	        r = await api_request(app, 'users', user.name, 'server', method='post')
1652	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1650	    with mock.patch.object(spawner, 'start') as m:
1651	        r = await api_request(app, 'users', user.name, 'server', method='post')
1652	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1656	    # start after stop is okay
1657	    r = await api_request(app, 'users', user.name, 'server', method='post')
1658	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1656	    # start after stop is okay
1657	    r = await api_request(app, 'users', user.name, 'server', method='post')
1658	    assert r.status_code == 202

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1661	async def test_get_proxy(app):
1662	    r = await api_request(app, 'proxy')
1663	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1661	async def test_get_proxy(app):
1662	    r = await api_request(app, 'proxy')
1663	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1669	async def test_get_proxy_pagination(app, offset):
1670	    r = await api_request(
1671	        app, f'proxy?offset={offset}', headers={"Accept": PAGINATION_MEDIA_TYPE}
1672	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1669	async def test_get_proxy_pagination(app, offset):
1670	    r = await api_request(
1671	        app, f'proxy?offset={offset}', headers={"Accept": PAGINATION_MEDIA_TYPE}
1672	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1682	    user = add_user(db, app=app, name=name)
1683	    r = await api_request(app, 'users', name, 'server', method='post')
1684	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1682	    user = add_user(db, app=app, name=name)
1683	    r = await api_request(app, 'users', name, 'server', method='post')
1684	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1691	    cookie = cookies[cookie_name][1:-1]
1692	    r = await api_request(app, 'authorizations/cookie', cookie_name, "nothintoseehere")
1693	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1691	    cookie = cookies[cookie_name][1:-1]
1692	    r = await api_request(app, 'authorizations/cookie', cookie_name, "nothintoseehere")
1693	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1694	
1695	    r = await api_request(
1696	        app, 'authorizations/cookie', cookie_name, quote(cookie, safe='')
1697	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1694	
1695	    r = await api_request(
1696	        app, 'authorizations/cookie', cookie_name, quote(cookie, safe='')
1697	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1702	    # deprecated cookie in body:
1703	    r = await api_request(app, 'authorizations/cookie', cookie_name, data=cookie)
1704	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1702	    # deprecated cookie in body:
1703	    r = await api_request(app, 'authorizations/cookie', cookie_name, data=cookie)
1704	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1718	    token = user.new_api_token()
1719	    r = await api_request(app, 'authorizations/token', token)
1720	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1718	    token = user.new_api_token()
1719	    r = await api_request(app, 'authorizations/token', token)
1720	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1722	    assert user_model['name'] == name
1723	    r = await api_request(app, 'authorizations/token', 'notauthorized')
1724	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1723
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1722	    assert user_model['name'] == name
1723	    r = await api_request(app, 'authorizations/token', 'notauthorized')
1724	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1729	    # request a new token
1730	    r = await api_request(
1731	        app, 'authorizations', 'token', method='post', headers=headers
1732	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1729	    # request a new token
1730	    r = await api_request(
1731	        app, 'authorizations', 'token', method='post', headers=headers
1732	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1754	    # request a new token
1755	    r = await api_request(
1756	        app, 'users/admin/tokens', method='post', headers=headers, data=body
1757	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1754	    # request a new token
1755	    r = await api_request(
1756	        app, 'users/admin/tokens', method='post', headers=headers, data=body
1757	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1780	    # check the validity of the new token
1781	    r = await api_request(app, 'users/admin/tokens', token_id)
1782	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1780	    # check the validity of the new token
1781	    r = await api_request(app, 'users/admin/tokens', token_id)
1782	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1786	    # delete the token
1787	    r = await api_request(app, 'users/admin/tokens', token_id, method='delete')
1788	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1786	    # delete the token
1787	    r = await api_request(app, 'users/admin/tokens', token_id, method='delete')
1788	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1789	    # verify deletion
1790	    r = await api_request(app, 'users/admin/tokens', token_id)
1791	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1789	    # verify deletion
1790	    r = await api_request(app, 'users/admin/tokens', token_id)
1791	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1812	    ):
1813	        r = await api_request(
1814	            app,
1815	            f'users/{user.name}/tokens',
1816	            method='post',
1817	            data=json.dumps(options),
1818	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1812	    ):
1813	        r = await api_request(
1814	            app,
1815	            f'users/{user.name}/tokens',
1816	            method='post',
1817	            data=json.dumps(options),
1818	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1849	    headers = {'Authorization': f'token {u.new_api_token()}'}
1850	    r = await api_request(
1851	        app,
1852	        'users',
1853	        for_user,
1854	        'tokens',
1855	        method='post',
1856	        data=json.dumps(data),
1857	        headers=headers,
1858	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1849	    headers = {'Authorization': f'token {u.new_api_token()}'}
1850	    r = await api_request(
1851	        app,
1852	        'users',
1853	        for_user,
1854	        'tokens',
1855	        method='post',
1856	        data=json.dumps(data),
1857	        headers=headers,
1858	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1865	    token_id = reply['id']
1866	    r = await api_request(app, 'users', for_user, 'tokens', token_id, headers=headers)
1867	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1865	    token_id = reply['id']
1866	    r = await api_request(app, 'users', for_user, 'tokens', token_id, headers=headers)
1867	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1876	    # delete the token
1877	    r = await api_request(
1878	        app, 'users', for_user, 'tokens', token_id, method='delete', headers=headers
1879	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1876	    # delete the token
1877	    r = await api_request(
1878	        app, 'users', for_user, 'tokens', token_id, method='delete', headers=headers
1879	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1881	    assert r.status_code == 204
1882	    r = await api_request(app, 'users', for_user, 'tokens', token_id, headers=headers)
1883	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1881	    assert r.status_code == 204
1882	    r = await api_request(app, 'users', for_user, 'tokens', token_id, headers=headers)
1883	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1889	    data = {'auth': {'username': name, 'password': name}}
1890	    r = await api_request(
1891	        app,
1892	        'users',
1893	        name,
1894	        'tokens',
1895	        method='post',
1896	        data=json.dumps(data) if data else None,
1897	        noauth=True,
1898	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1889	    data = {'auth': {'username': name, 'password': name}}
1890	    r = await api_request(
1891	        app,
1892	        'users',
1893	        name,
1894	        'tokens',
1895	        method='post',
1896	        data=json.dumps(data) if data else None,
1897	        noauth=True,
1898	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1901	    assert 'token' in reply
1902	    r = await api_request(app, 'authorizations', 'token', reply['token'])
1903	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1902
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1901	    assert 'token' in reply
1902	    r = await api_request(app, 'authorizations', 'token', reply['token'])
1903	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1912	    data = {'auth': {'username': name, 'password': name}}
1913	    r = await api_request(
1914	        app,
1915	        'users',
1916	        name,
1917	        'tokens',
1918	        method='post',
1919	        data=json.dumps(data) if data else None,
1920	        noauth=True,
1921	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1912	    data = {'auth': {'username': name, 'password': name}}
1913	    r = await api_request(
1914	        app,
1915	        'users',
1916	        name,
1917	        'tokens',
1918	        method='post',
1919	        data=json.dumps(data) if data else None,
1920	        noauth=True,
1921	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1925
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1924	    assert 'token' in reply
1925	    r = await api_request(app, 'authorizations', 'token', reply['token'])
1926	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1925
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1924	    assert 'token' in reply
1925	    r = await api_request(app, 'authorizations', 'token', reply['token'])
1926	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1945
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1944	    headers = {'Authorization': f'token {u.new_api_token()}'}
1945	    r = await api_request(app, 'users', for_user, 'tokens', headers=headers)
1946	    assert r.status_code == status

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1945
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1944	    headers = {'Authorization': f'token {u.new_api_token()}'}
1945	    r = await api_request(app, 'users', for_user, 'tokens', headers=headers)
1946	    assert r.status_code == status

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1954	    for token in reply['api_tokens']:
1955	        r = await api_request(
1956	            app, 'users', for_user, 'tokens', token['id'], headers=headers
1957	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1954	    for token in reply['api_tokens']:
1955	        r = await api_request(
1956	            app, 'users', for_user, 'tokens', token['id'], headers=headers
1957	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1969	async def test_groups_list(app):
1970	    r = await api_request(app, 'groups')
1971	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1969	async def test_groups_list(app):
1970	    r = await api_request(app, 'groups')
1971	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1981	
1982	    r = await api_request(app, 'groups')
1983	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:1982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1981	
1982	    r = await api_request(app, 'groups')
1983	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2002	    # Test offset for pagination
2003	    r = await api_request(app, "groups?offset=1")
2004	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2002	    # Test offset for pagination
2003	    r = await api_request(app, "groups?offset=1")
2004	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2017
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2016	
2017	    r = await api_request(app, "groups?offset=10")
2018	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2017
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2016	
2017	    r = await api_request(app, "groups?offset=10")
2018	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2022	    # Test limit for pagination
2023	    r = await api_request(app, "groups?limit=1")
2024	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2022	    # Test limit for pagination
2023	    r = await api_request(app, "groups?limit=1")
2024	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2037	    # 0 is rounded up to 1
2038	    r = await api_request(app, "groups?limit=0")
2039	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2037	    # 0 is rounded up to 1
2038	    r = await api_request(app, "groups?limit=0")
2039	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2055	    names = ['group1', 'group2']
2056	    r = await api_request(
2057	        app, 'groups', method='post', data=json.dumps({'groups': names})
2058	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2055	    names = ['group1', 'group2']
2056	    r = await api_request(
2057	        app, 'groups', method='post', data=json.dumps({'groups': names})
2058	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2065
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2064	    # try to create the same groups again
2065	    r = await api_request(
2066	        app, 'groups', method='post', data=json.dumps({'groups': names})
2067	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2065
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2064	    # try to create the same groups again
2065	    r = await api_request(
2066	        app, 'groups', method='post', data=json.dumps({'groups': names})
2067	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2080	
2081	    r = await api_request(app, 'groups/runaways')
2082	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2080	
2081	    r = await api_request(app, 'groups/runaways')
2082	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2084
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2083	
2084	    r = await api_request(app, 'groups/alphaflight')
2085	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2084
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2083	
2084	    r = await api_request(app, 'groups/alphaflight')
2085	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2099	    user = add_user(app.db, app=app, name='sasquatch')
2100	    r = await api_request(app, 'groups/runaways', method='delete')
2101	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2099	    user = add_user(app.db, app=app, name='sasquatch')
2100	    r = await api_request(app, 'groups/runaways', method='delete')
2101	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2102	
2103	    r = await api_request(
2104	        app, 'groups/new', method='post', data=json.dumps({'users': ['doesntexist']})
2105	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2102	
2103	    r = await api_request(
2104	        app, 'groups/new', method='post', data=json.dumps({'users': ['doesntexist']})
2105	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2108	
2109	    r = await api_request(
2110	        app,
2111	        'groups/omegaflight',
2112	        method='post',
2113	        data=json.dumps({'users': ['sasquatch']}),
2114	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2108	
2109	    r = await api_request(
2110	        app,
2111	        'groups/omegaflight',
2112	        method='post',
2113	        data=json.dumps({'users': ['sasquatch']}),
2114	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2122	    # create duplicate raises 400
2123	    r = await api_request(app, 'groups/omegaflight', method='post')
2124	    assert r.status_code == 409

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2122	    # create duplicate raises 400
2123	    r = await api_request(app, 'groups/omegaflight', method='post')
2124	    assert r.status_code == 409

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2125	
2126	    r = await api_request(app, 'groups/omegaflight', method='delete')
2127	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2125	
2126	    r = await api_request(app, 'groups/omegaflight', method='delete')
2127	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2131	    # delete nonexistent gives 404
2132	    r = await api_request(app, 'groups/omegaflight', method='delete')
2133	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2131	    # delete nonexistent gives 404
2132	    r = await api_request(app, 'groups/omegaflight', method='delete')
2133	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2142	    # must specify users
2143	    r = await api_request(app, 'groups/alphaflight/users', method='post', data='{}')
2144	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2142	    # must specify users
2143	    r = await api_request(app, 'groups/alphaflight/users', method='post', data='{}')
2144	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2147	    users = [add_user(db, app=app, name=name) for name in names]
2148	    r = await api_request(
2149	        app,
2150	        'groups/alphaflight/users',
2151	        method='post',
2152	        data=json.dumps({'users': names}),
2153	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2147	    users = [add_user(db, app=app, name=name) for name in names]
2148	    r = await api_request(
2149	        app,
2150	        'groups/alphaflight/users',
2151	        method='post',
2152	        data=json.dumps({'users': names}),
2153	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2162	
2163	    r = await api_request(
2164	        app,
2165	        'groups/alphaflight/users',
2166	        method='delete',
2167	        data=json.dumps({'users': names[:2]}),
2168	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2162	
2163	    r = await api_request(
2164	        app,
2165	        'groups/alphaflight/users',
2166	        method='delete',
2167	        data=json.dumps({'users': names[:2]}),
2168	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2197	    app.db.commit()
2198	    r = await api_request(
2199	        app, f"groups/{group.name}/properties", method='put', data=json_properties
2200	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2197	    app.db.commit()
2198	    r = await api_request(
2199	        app, f"groups/{group.name}/properties", method='put', data=json_properties
2200	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2214	    }
2215	    r = await api_request(
2216	        app,
2217	        f"groups/{group.name}/properties",
2218	        method='put',
2219	        data=json.dumps(properties),
2220	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2214	    }
2215	    r = await api_request(
2216	        app,
2217	        f"groups/{group.name}/properties",
2218	        method='put',
2219	        data=json.dumps(properties),
2220	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2223	
2224	    r = await api_request(
2225	        app,
2226	        f"groups/{group.name}/properties",
2227	        method='put',
2228	        data="{}",
2229	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2223	
2224	    r = await api_request(
2225	        app,
2226	        f"groups/{group.name}/properties",
2227	        method='put',
2228	        data="{}",
2229	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2240	    # create groups
2241	    r = await api_request(
2242	        app,
2243	        'groups',
2244	        method='post',
2245	        data=json.dumps({"groups": {"groupname": [user.name]}}),
2246	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2240	    # create groups
2241	    r = await api_request(
2242	        app,
2243	        'groups',
2244	        method='post',
2245	        data=json.dumps({"groups": {"groupname": [user.name]}}),
2246	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2247	    assert r.status_code == 201
2248	    r = await api_request(app, 'groups/newgroup', method='post')
2249	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2247	    assert r.status_code == 201
2248	    r = await api_request(app, 'groups/newgroup', method='post')
2249	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2250	    # add users to group
2251	    r = await api_request(
2252	        app,
2253	        f'groups/{group.name}/users',
2254	        method='post',
2255	        data=json.dumps({"users": [user.name]}),
2256	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2250	    # add users to group
2251	    r = await api_request(
2252	        app,
2253	        f'groups/{group.name}/users',
2254	        method='post',
2255	        data=json.dumps({"users": [user.name]}),
2256	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2258	    # remove users from group
2259	    r = await api_request(
2260	        app,
2261	        f'groups/{group.name}/users',
2262	        method='delete',
2263	        data=json.dumps({"users": [user.name]}),
2264	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2258	    # remove users from group
2259	    r = await api_request(
2260	        app,
2261	        f'groups/{group.name}/users',
2262	        method='delete',
2263	        data=json.dumps({"users": [user.name]}),
2264	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2266	    # delete groups
2267	    r = await api_request(app, f'groups/{group.name}', method='delete')
2268	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2266	    # delete groups
2267	    r = await api_request(app, f'groups/{group.name}', method='delete')
2268	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2279	    db = app.db
2280	    r = await api_request(app, 'services')
2281	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2279	    db = app.db
2280	    r = await api_request(app, 'services')
2281	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2298	    }
2299	    r = await api_request(app, 'services', headers=auth_header(db, 'user'))
2300	    assert r.status_code == 403

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2298	    }
2299	    r = await api_request(app, 'services', headers=auth_header(db, 'user'))
2300	    assert r.status_code == 403

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2306	    db = app.db
2307	    r = await api_request(app, f"services/{mockservice.name}")
2308	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2306	    db = app.db
2307	    r = await api_request(app, f"services/{mockservice.name}")
2308	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2323	    }
2324	    r = await api_request(
2325	        app,
2326	        f"services/{mockservice.name}",
2327	        headers={'Authorization': f'token {mockservice.api_token}'},
2328	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2323	    }
2324	    r = await api_request(
2325	        app,
2326	        f"services/{mockservice.name}",
2327	        headers={'Authorization': f'token {mockservice.api_token}'},
2328	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2330	
2331	    r = await api_request(
2332	        app, f"services/{mockservice.name}", headers=auth_header(db, 'user')
2333	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2330	
2331	    r = await api_request(
2332	        app, f"services/{mockservice.name}", headers=auth_header(db, 'user')
2333	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2335	
2336	    r = await api_request(app, "services/nosuchservice")
2337	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2335	
2336	    r = await api_request(app, "services/nosuchservice")
2337	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2347	    db = app.db
2348	    r = await api_request(
2349	        app,
2350	        f'services/{service_name}',
2351	        headers=auth_header(db, service_admin_user.name),
2352	        data=json.dumps(service_data),
2353	        method='post',
2354	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2347	    db = app.db
2348	    r = await api_request(
2349	        app,
2350	        f'services/{service_name}',
2351	        headers=auth_header(db, service_admin_user.name),
2352	        data=json.dumps(service_data),
2353	        method='post',
2354	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2378	    db = app.db
2379	    r = await api_request(
2380	        app,
2381	        f'services/{service_name}',
2382	        headers=auth_header(db, 'user'),
2383	        data=json.dumps(service_data),
2384	        method='post',
2385	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2378	    db = app.db
2379	    r = await api_request(
2380	        app,
2381	        f'services/{service_name}',
2382	        headers=auth_header(db, 'user'),
2383	        data=json.dumps(service_data),
2384	        method='post',
2385	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2397	
2398	    r = await api_request(
2399	        app,
2400	        f'services/{service_name}',
2401	        headers=auth_header(db, service_admin_user.name),
2402	        data=json.dumps(service_data),
2403	        method='post',
2404	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2397	
2398	    r = await api_request(
2399	        app,
2400	        f'services/{service_name}',
2401	        headers=auth_header(db, service_admin_user.name),
2402	        data=json.dumps(service_data),
2403	        method='post',
2404	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2414	
2415	    r = await api_request(
2416	        app,
2417	        f'services/{service_name}',
2418	        headers=auth_header(db, service_admin_user.name),
2419	        data=json.dumps(service_data),
2420	        method='post',
2421	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2414	
2415	    r = await api_request(
2416	        app,
2417	        f'services/{service_name}',
2418	        headers=auth_header(db, service_admin_user.name),
2419	        data=json.dumps(service_data),
2420	        method='post',
2421	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2423	
2424	    r = await api_request(
2425	        app,
2426	        f'services/{service_name}',
2427	        headers=auth_header(db, service_admin_user.name),
2428	        data=json.dumps(service_data),
2429	        method='post',
2430	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2423	
2424	    r = await api_request(
2425	        app,
2426	        f'services/{service_name}',
2427	        headers=auth_header(db, service_admin_user.name),
2428	        data=json.dumps(service_data),
2429	        method='post',
2430	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2440	    managed_service_data['command'] = ['foo']
2441	    r = await api_request(
2442	        app,
2443	        f'services/{service_name}',
2444	        headers=auth_header(db, service_admin_user.name),
2445	        data=json.dumps(managed_service_data),
2446	        method='post',
2447	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2440	    managed_service_data['command'] = ['foo']
2441	    r = await api_request(
2442	        app,
2443	        f'services/{service_name}',
2444	        headers=auth_header(db, service_admin_user.name),
2445	        data=json.dumps(managed_service_data),
2446	        method='post',
2447	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2459	    managed_service_data['admin'] = True
2460	    r = await api_request(
2461	        app,
2462	        f'services/{service_name}',
2463	        headers=auth_header(db, admin_user.name),
2464	        data=json.dumps(managed_service_data),
2465	        method='post',
2466	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2459	    managed_service_data['admin'] = True
2460	    r = await api_request(
2461	        app,
2462	        f'services/{service_name}',
2463	        headers=auth_header(db, admin_user.name),
2464	        data=json.dumps(managed_service_data),
2465	        method='post',
2466	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2479	    managed_service_data['admin'] = True
2480	    r = await api_request(
2481	        app,
2482	        f'services/{service_name}',
2483	        headers=auth_header(db, service_admin_user.name),
2484	        data=json.dumps(managed_service_data),
2485	        method='post',
2486	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2479	    managed_service_data['admin'] = True
2480	    r = await api_request(
2481	        app,
2482	        f'services/{service_name}',
2483	        headers=auth_header(db, service_admin_user.name),
2484	        data=json.dumps(managed_service_data),
2485	        method='post',
2486	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2502	    user_with_scope = create_user_with_scopes('admin:services', 'admin:users')
2503	    r = await api_request(
2504	        app,
2505	        f'services/{service_name}',
2506	        headers=auth_header(db, user_with_scope.name),
2507	        data=json.dumps(managed_service_data),
2508	        method='post',
2509	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2502	    user_with_scope = create_user_with_scopes('admin:services', 'admin:users')
2503	    r = await api_request(
2504	        app,
2505	        f'services/{service_name}',
2506	        headers=auth_header(db, user_with_scope.name),
2507	        data=json.dumps(managed_service_data),
2508	        method='post',
2509	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2525	    managed_service_data['oauth_client_allowed_scopes'] = ["admin:users"]
2526	    r = await api_request(
2527	        app,
2528	        f'services/{service_name}',
2529	        headers=auth_header(db, service_admin_user.name),
2530	        data=json.dumps(managed_service_data),
2531	        method='post',
2532	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2525	    managed_service_data['oauth_client_allowed_scopes'] = ["admin:users"]
2526	    r = await api_request(
2527	        app,
2528	        f'services/{service_name}',
2529	        headers=auth_header(db, service_admin_user.name),
2530	        data=json.dumps(managed_service_data),
2531	        method='post',
2532	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2542	    db = app.db
2543	    r = await api_request(
2544	        app,
2545	        f'services/{service_name}',
2546	        headers=auth_header(db, service_admin_user.name),
2547	        data=json.dumps(service_data),
2548	        method='post',
2549	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2542	    db = app.db
2543	    r = await api_request(
2544	        app,
2545	        f'services/{service_name}',
2546	        headers=auth_header(db, service_admin_user.name),
2547	        data=json.dumps(service_data),
2548	        method='post',
2549	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2551	
2552	    r = await api_request(
2553	        app,
2554	        f'services/{service_name}',
2555	        headers=auth_header(db, service_admin_user.name),
2556	        method='delete',
2557	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2551	
2552	    r = await api_request(
2553	        app,
2554	        f'services/{service_name}',
2555	        headers=auth_header(db, service_admin_user.name),
2556	        method='delete',
2557	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2571	
2572	    r = await api_request(app, f"services/{service_name}", method="delete")
2573	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2571	
2572	    r = await api_request(app, f"services/{service_name}", method="delete")
2573	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2579	    service_name = mockservice.name
2580	    r = await api_request(
2581	        app,
2582	        f'services/{service_name}',
2583	        headers=auth_header(db, service_admin_user.name),
2584	        method='delete',
2585	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2579	    service_name = mockservice.name
2580	    r = await api_request(
2581	        app,
2582	        f'services/{service_name}',
2583	        headers=auth_header(db, service_admin_user.name),
2584	        method='delete',
2585	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2594	        kwargs["verify"] = app.internal_ssl_ca
2595	    r = await api_request(app, bypass_proxy=True)
2596	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2594	        kwargs["verify"] = app.internal_ssl_ca
2595	    r = await api_request(app, bypass_proxy=True)
2596	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2601	async def test_info(app):
2602	    r = await api_request(app, 'info')
2603	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2601	async def test_info(app):
2602	    r = await api_request(app, 'info')
2603	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2631	    token = user.new_api_token()
2632	    r = await api_request(
2633	        app,
2634	        f"users/{admin_user.name}/activity",
2635	        headers={"Authorization": f"token {token}"},
2636	        data="{}",
2637	        method="post",
2638	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2631	    token = user.new_api_token()
2632	    r = await api_request(
2633	        app,
2634	        f"users/{admin_user.name}/activity",
2635	        headers={"Authorization": f"token {token}"},
2636	        data="{}",
2637	        method="post",
2638	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2643	    token = admin_user.new_api_token(roles=['admin'])
2644	    r = await api_request(
2645	        app,
2646	        f"users/{user.name}/activity",
2647	        headers={"Authorization": f"token {token}"},
2648	        data=json.dumps({"last_activity": utcnow().isoformat()}),
2649	        method="post",
2650	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2643	    token = admin_user.new_api_token(roles=['admin'])
2644	    r = await api_request(
2645	        app,
2646	        f"users/{user.name}/activity",
2647	        headers={"Authorization": f"token {token}"},
2648	        data=json.dumps({"last_activity": utcnow().isoformat()}),
2649	        method="post",
2650	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2680	
2681	    r = await api_request(
2682	        app,
2683	        f"users/{user.name}/activity",
2684	        headers={"Authorization": f"token {token}"},
2685	        data=json.dumps(
2686	            {"servers": {server_name: {"last_activity": activity.isoformat()}}}
2687	        ),
2688	        method="post",
2689	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2680	
2681	    r = await api_request(
2682	        app,
2683	        f"users/{user.name}/activity",
2684	        headers={"Authorization": f"token {token}"},
2685	        data=json.dumps(
2686	            {"servers": {server_name: {"last_activity": activity.isoformat()}}}
2687	        ),
2688	        method="post",
2689	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2715	async def test_options(app):
2716	    r = await api_request(app, 'users', method='options')
2717	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2715	async def test_options(app):
2716	    r = await api_request(app, 'users', method='options')
2717	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2721	async def test_bad_json_body(app):
2722	    r = await api_request(app, 'users', method='post', data='notjson')
2723	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2721	async def test_bad_json_body(app):
2722	    r = await api_request(app, 'users', method='post', data='notjson')
2723	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2737	    async def shutdown():
2738	        r = await api_request(
2739	            app,
2740	            'shutdown',
2741	            method='post',
2742	            data=json.dumps({'servers': True, 'proxy': True}),
2743	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_api.py:2738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2737	    async def shutdown():
2738	        r = await api_request(
2739	            app,
2740	            'shutdown',
2741	            method='post',
2742	            data=json.dumps({'servers': True, 'proxy': True}),
2743	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	    p.wait(timeout=10)
43	    out = p.stdout.read().decode('utf8', 'replace')
44	    assert 'log_level' in out

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	    p.wait(timeout=10)
51	    out = p.stdout.read().decode('utf8', 'replace')
52	    config = json.loads(out)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	        with open(os.path.join(td, 'jupyterhub_config.py'), 'w') as f:
62	            f.write("c.Authenticator.admin_users={'user'}")
63	        out = check_output(cmd + ['user'], cwd=td).decode('utf8', 'replace').strip()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
61	        with open(os.path.join(td, 'jupyterhub_config.py'), 'w') as f:
62	            f.write("c.Authenticator.admin_users={'user'}")
63	        out = check_output(cmd + ['user'], cwd=td).decode('utf8', 'replace').strip()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	    with open(cfg_file, 'w') as f:
93	        f.write("c.A = 5")
94	    p = Popen(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
92	    with open(cfg_file, 'w') as f:
93	        f.write("c.A = 5")
94	    p = Popen(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	    with open(cfg_file) as f:
103	        cfg_text = f.read()
104	    assert cfg_text == 'c.A = 5'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
114	    with open(cfg_file) as f:
115	        cfg_text = f.read()
116	    os.remove(cfg_file)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
177	    secret = os.urandom(COOKIE_SECRET_BYTES)
178	    secret_file.write(binascii.b2a_hex(secret))
179	    kwargs = {'cookie_secret_file': secret_path}

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
177	    secret = os.urandom(COOKIE_SECRET_BYTES)
178	    secret_file.write(binascii.b2a_hex(secret))
179	    kwargs = {'cookie_secret_file': secret_path}

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
185	    # raise with public secret file
186	    os.chmod(secret_path, 0o664)
187	    with pytest.raises(SystemExit):

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:186
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
185	    # raise with public secret file
186	    os.chmod(secret_path, 0o664)
187	    with pytest.raises(SystemExit):

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
190	    # ok with same file, proper permissions
191	    os.chmod(secret_path, 0o660)
192	    hub.init_secrets()

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:191
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
190	    # ok with same file, proper permissions
191	    os.chmod(secret_path, 0o660)
192	    hub.init_secrets()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
197	    secret_file = tmpdir.join('cookie_secret')
198	    secret_file.write('not base 64: uioe')
199	    secret_path = str(secret_file)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
197	    secret_file = tmpdir.join('cookie_secret')
198	    secret_file.write('not base 64: uioe')
199	    secret_path = str(secret_file)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
199	    secret_path = str(secret_file)
200	    os.chmod(secret_path, 0o660)
201	    kwargs = {'cookie_secret_file': secret_path}

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:200
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
199	    secret_path = str(secret_file)
200	    os.chmod(secret_path, 0o660)
201	    kwargs = {'cookie_secret_file': secret_path}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
354	    [
355	        ({'ip': '0.0.0.0'}, {'bind_url': 'http://0.0.0.0:8000/'}),
356	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
354	    [
355	        ({'ip': '0.0.0.0'}, {'bind_url': 'http://0.0.0.0:8000/'}),
356	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
357	            {'port': 123, 'base_url': '/prefix'},
358	            {'bind_url': 'http://:123/prefix/', 'base_url': '/prefix/'},
359	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
359	        ),
360	        ({'bind_url': 'http://0.0.0.0:12345/sub'}, {'base_url': '/sub/'}),
361	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
363	            {},
364	            {'base_url': '/', 'bind_url': 'http://:8000', 'ip': '', 'port': 8000},
365	        ),

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_app.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
577	    # background spawner.proc.wait to avoid waiting for zombie process here
578	    with ThreadPoolExecutor(1) as pool:
579	        pool.submit(spawner.proc.wait)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_auth.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
552	    ):
553	        r = await async_requests.get(public_url(app))
554	    assert urlparse(r.url).path.endswith("/hub/login")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_auth.py:865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
864	            role = orm.Role.find(app.db, expected_role['name'])
865	            assert role.description == expected_role.get('description', None)
866	            assert len(role.scopes) == len(expected_role.get('scopes', []))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_auth.py:866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
865	            assert role.description == expected_role.get('description', None)
866	            assert len(role.scopes) == len(expected_role.get('scopes', []))
867	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_auth.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
889	    # Add the current user to test that non-missing entities are not included in the warning
890	    role_spec['users'] = [*role_spec.get('users', []), user.name]
891	    # Add a scope to silence "Role will have no scopes" warning

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_eventlog.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    (
25	        'https://schema.jupyter.org/jupyterhub/events/server-action',
26	        dict(action='start', username='test-username', servername='test-servername'),
27	    )
28	]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_eventlog.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    (
35	        'https://schema.jupyter.org/jupyterhub/events/server-action',
36	        dict(action='start'),
37	    )
38	]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_internal_ssl_connections.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	        kwargs = {'verify': False}
46	        r = await async_requests.get(app.hub.url, **kwargs)
47	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_internal_ssl_connections.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	        kwargs = {'verify': False}
54	        r = await async_requests.get(app.proxy.api_url, **kwargs)
55	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_internal_ssl_connections.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	            kwargs = {'verify': False}
73	            r = await async_requests.get(spawner.server.url, **kwargs)
74	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
63	    user = add_user(app.db, app, name=username)
64	    r = await api_request(app, 'users', username, 'server', method='post')
65	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
63	    user = add_user(app.db, app, name=username)
64	    r = await api_request(app, 'users', username, 'server', method='post')
65	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
67	
68	    r = await api_request(app, 'users', username)
69	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
67	
68	    r = await api_request(app, 'users', username)
69	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
104	    # now stop the server
105	    r = await api_request(app, 'users', username, 'server', method='delete')
106	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
104	    # now stop the server
105	    r = await api_request(app, 'users', username, 'server', method='delete')
106	    assert r.status_code == 204

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
108	
109	    r = await api_request(app, 'users', username)
110	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
108	
109	    r = await api_request(app, 'users', username)
110	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
137	
138	    r = await api_request(
139	        app, 'users', username, 'servers', request_servername, method='post'
140	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
137	
138	    r = await api_request(
139	        app, 'users', username, 'servers', request_servername, method='post'
140	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	    expected_url = url_path_join(public_url(app, user), escapedname, 'env')
147	    r = await async_requests.get(url, cookies=cookies)
148	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
153	    env = r.json()
154	    prefix = env.get('JUPYTERHUB_SERVICE_PREFIX')
155	    assert prefix == user.spawners[servername].server.base_url

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
157	
158	    r = await api_request(app, 'users', username)
159	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
157	
158	    r = await api_request(app, 'users', username)
159	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
210	
211	    r = await api_request(
212	        app, 'users', username, 'servers', request_servername, method='post'
213	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
210	
211	    r = await api_request(
212	        app, 'users', username, 'servers', request_servername, method='post'
213	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
228	    servername = 'splugoth'
229	    r = await api_request(app, 'users', username, 'servers', servername, method='post')
230	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
228	    servername = 'splugoth'
229	    r = await api_request(app, 'users', username, 'servers', servername, method='post')
230	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
232	
233	    r = await api_request(
234	        app, 'users', username, 'servers', servername, method='delete'
235	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
232	
233	    r = await api_request(
234	        app, 'users', username, 'servers', servername, method='delete'
235	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
238	
239	    r = await api_request(app, 'users', username)
240	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
238	
239	    r = await api_request(app, 'users', username)
240	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
250	
251	    r = await api_request(
252	        app,
253	        'users',
254	        username,
255	        'servers',
256	        servername,
257	        method='delete',
258	        data=json.dumps({'remove': True}),
259	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
250	
251	    r = await api_request(
252	        app,
253	        'users',
254	        username,
255	        'servers',
256	        servername,
257	        method='delete',
258	        data=json.dumps({'remove': True}),
259	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
270	    servername = 'okay'
271	    r = await api_request(app, 'users', username, 'servers', servername, method='post')
272	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
270	    servername = 'okay'
271	    r = await api_request(app, 'users', username, 'servers', servername, method='post')
272	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
272	    assert r.status_code == 400
273	    r = await api_request(
274	        app, 'users', username, 'servers', servername, method='delete'
275	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
272	    assert r.status_code == 400
273	    r = await api_request(
274	        app, 'users', username, 'servers', servername, method='delete'
275	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
285	    servername1 = 'bar-1'
286	    r = await api_request(app, 'users', username, 'servers', servername1, method='post')
287	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
285	    servername1 = 'bar-1'
286	    r = await api_request(app, 'users', username, 'servers', servername1, method='post')
287	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
292	    servername2 = 'bar-2'
293	    r = await api_request(app, 'users', username, 'servers', servername2, method='post')
294	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
292	    servername2 = 'bar-2'
293	    r = await api_request(app, 'users', username, 'servers', servername2, method='post')
294	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
299	    servername3 = 'bar-3'
300	    r = await api_request(app, 'users', username, 'servers', servername3, method='post')
301	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
299	    servername3 = 'bar-3'
300	    r = await api_request(app, 'users', username, 'servers', servername3, method='post')
301	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
307	    # Create default server
308	    r = await api_request(app, 'users', username, 'server', method='post')
309	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
307	    # Create default server
308	    r = await api_request(app, 'users', username, 'server', method='post')
309	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
312	    # Delete 1st named server
313	    r = await api_request(
314	        app,
315	        'users',
316	        username,
317	        'servers',
318	        servername1,
319	        method='delete',
320	        data=json.dumps({'remove': True}),
321	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
312	    # Delete 1st named server
313	    r = await api_request(
314	        app,
315	        'users',
316	        username,
317	        'servers',
318	        servername1,
319	        method='delete',
320	        data=json.dumps({'remove': True}),
321	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
325	    # Create 3rd named server again
326	    r = await api_request(app, 'users', username, 'servers', servername3, method='post')
327	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
325	    # Create 3rd named server again
326	    r = await api_request(app, 'users', username, 'servers', servername3, method='post')
327	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
347	    servername1 = 'bar-1'
348	    r = await api_request(
349	        app, 'users', username, 'servers', servername1, method='post', cookies=cookies
350	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
347	    servername1 = 'bar-1'
348	    r = await api_request(
349	        app, 'users', username, 'servers', servername1, method='post', cookies=cookies
350	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
356	    servername2 = 'bar-2'
357	    r = await api_request(
358	        app, 'users', username, 'servers', servername2, method='post', cookies=cookies
359	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
356	    servername2 = 'bar-2'
357	    r = await api_request(
358	        app, 'users', username, 'servers', servername2, method='post', cookies=cookies
359	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
365	    servername3 = 'bar-3'
366	    r = await api_request(
367	        app, 'users', username, 'servers', servername3, method='post', cookies=cookies
368	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
365	    servername3 = 'bar-3'
366	    r = await api_request(
367	        app, 'users', username, 'servers', servername3, method='post', cookies=cookies
368	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
400	        )
401	        r = await async_requests.post(
402	            url_concat(
403	                action_url,
404	                {'next': next_url},
405	            ),
406	            cookies=cookies,
407	            data={'bounds': ['-10', '10'], 'energy': '938MeV'},
408	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
425	
426	    r = await api_request(app, 'users', username, 'servers', server_name, method='post')
427	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
425	
426	    r = await api_request(app, 'users', username, 'servers', server_name, method='post')
427	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
446	        await asyncio.sleep(0.1)
447	        r = await async_requests.get(r.url, cookies=cookies)
448	        path = urlparse(r.url).path

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
463	
464	    r = await api_request(app, 'users', username, 'servers', server_name, method='post')
465	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
463	
464	    r = await api_request(app, 'users', username, 'servers', server_name, method='post')
465	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
511	
512	    r = await api_request(app, 'users', username, 'server', method='post')
513	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
511	
512	    r = await api_request(app, 'users', username, 'server', method='post')
513	    assert r.status_code == 201

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
519	    ):
520	        r = await api_request(
521	            app, 'users', username, 'servers', server_name, method='post'
522	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
519	    ):
520	        r = await api_request(
521	            app, 'users', username, 'servers', server_name, method='post'
522	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
536	async def test_stopped_servers(app, user, named_servers, include_stopped_servers):
537	    r = await api_request(app, 'users', user.name, 'server', method='post')
538	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
536	async def test_stopped_servers(app, user, named_servers, include_stopped_servers):
537	    r = await api_request(app, 'users', user.name, 'server', method='post')
538	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
538	    r.raise_for_status()
539	    r = await api_request(app, 'users', user.name, 'servers', "named", method='post')
540	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
538	    r.raise_for_status()
539	    r = await api_request(app, 'users', user.name, 'servers', "named", method='post')
540	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
543	    for i in range(60):
544	        r = await api_request(app, 'users', user.name)
545	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
543	    for i in range(60):
544	        r = await api_request(app, 'users', user.name)
545	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
553	
554	    r = await api_request(app, 'users', user.name, 'server', method='delete')
555	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
553	
554	    r = await api_request(app, 'users', user.name, 'server', method='delete')
555	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
555	    r.raise_for_status()
556	    r = await api_request(app, 'users', user.name, 'servers', "named", method='delete')
557	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
555	    r.raise_for_status()
556	    r = await api_request(app, 'users', user.name, 'servers', "named", method='delete')
557	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
560	    for i in range(60):
561	        r = await api_request(app, 'users', user.name)
562	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
560	    for i in range(60):
561	        r = await api_request(app, 'users', user.name)
562	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
574	        path = f"{path}?include_stopped_servers"
575	    r = await api_request(app, path)
576	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_named_servers.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
574	        path = f"{path}?include_stopped_servers"
575	    r = await api_request(app, path)
576	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        (
14	            'http://abc:123',
15	            {
16	                'ip': 'abc',
17	                'port': 123,
18	                'host': 'http://abc:123',
19	                'url': 'http://abc:123/x/',
20	            },
21	        ),
22	        (
23	            'https://abc',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	                'port': 123,
18	                'host': 'http://abc:123',
19	                'url': 'http://abc:123/x/',
20	            },
21	        ),
22	        (
23	            'https://abc',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	                'host': 'http://abc:123',
19	                'url': 'http://abc:123/x/',
20	            },
21	        ),
22	        (
23	            'https://abc',
24	            {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        (
23	            'https://abc',
24	            {
25	                'ip': 'abc',
26	                'port': 443,
27	                'proto': 'https',
28	                'host': 'https://abc:443',
29	                'url': 'https://abc:443/x/',
30	            },
31	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	                'proto': 'https',
28	                'host': 'https://abc:443',
29	                'url': 'https://abc:443/x/',
30	            },
31	        ),
32	    ],
33	)
34	def test_bind_url(bind_url, attrs):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	                'host': 'https://abc:443',
29	                'url': 'https://abc:443/x/',
30	            },
31	        ),
32	    ],
33	)
34	def test_bind_url(bind_url, attrs):
35	    s = Server(bind_url=bind_url, base_url='/x/')

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
39	
40	_hostname = socket.gethostname()
41	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
39	
40	_hostname = socket.gethostname()
41	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	                'url': f'http://{_hostname}:123/x/',
54	                'bind_url': 'http://*:123/x/',
55	            },
56	        ),
57	        (
58	            '127.0.0.1',
59	            999,
60	            {

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
57	        (
58	            '127.0.0.1',
59	            999,
60	            {
61	                'ip': '127.0.0.1',
62	                'port': 999,
63	                'host': 'http://127.0.0.1:999',
64	                'url': 'http://127.0.0.1:999/x/',
65	                'bind_url': 'http://127.0.0.1:999/x/',
66	            },
67	        ),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
60	            {
61	                'ip': '127.0.0.1',
62	                'port': 999,
63	                'host': 'http://127.0.0.1:999',
64	                'url': 'http://127.0.0.1:999/x/',
65	                'bind_url': 'http://127.0.0.1:999/x/',
66	            },
67	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	                'port': 999,
63	                'host': 'http://127.0.0.1:999',
64	                'url': 'http://127.0.0.1:999/x/',
65	                'bind_url': 'http://127.0.0.1:999/x/',
66	            },
67	        ),
68	    ],
69	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	                'host': 'http://127.0.0.1:999',
64	                'url': 'http://127.0.0.1:999/x/',
65	                'bind_url': 'http://127.0.0.1:999/x/',
66	            },
67	        ),
68	    ],
69	)
70	def test_ip_port(ip, port, attrs):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_objects.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	                'url': 'http://127.0.0.1:999/x/',
65	                'bind_url': 'http://127.0.0.1:999/x/',
66	            },
67	        ),
68	    ],
69	)
70	def test_ip_port(ip, port, attrs):
71	    s = Server(ip=ip, port=port, base_url='/x/')

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
35	    server = objects.Server(orm_server=server)
36	    assert server.host == f'http://{socket.gethostname()}:{server.port}'
37	    assert server.url == server.host + '/'

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
35	    server = objects.Server(orm_server=server)
36	    assert server.host == f'http://{socket.gethostname()}:{server.port}'
37	    assert server.url == server.host + '/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    assert server.url == server.host + '/'
38	    assert server.bind_url == f'http://*:{server.port}/'
39	    server.ip = '127.0.0.1'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
38	    assert server.bind_url == f'http://*:{server.port}/'
39	    server.ip = '127.0.0.1'
40	    assert server.host == f'http://127.0.0.1:{server.port}'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    server.ip = '127.0.0.1'
40	    assert server.host == f'http://127.0.0.1:{server.port}'
41	    assert server.url == server.host + '/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    server.connect_ip = 'hub'
44	    assert server.host == f'http://hub:{server.port}'
45	    assert server.url == server.host + '/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	
47	    server.connect_url = f'http://hub-url:{server.port}/connect'
48	    assert server.host == f'http://hub-url:{server.port}'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	    server.connect_url = f'http://hub-url:{server.port}/connect'
48	    assert server.host == f'http://hub-url:{server.port}'
49	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	
50	    server.bind_url = 'http://127.0.0.1/'
51	    assert server.port == 80

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	
53	    check_connect_url = objects.Server(connect_url='http://127.0.0.1:80')
54	    assert check_connect_url.connect_url == 'http://127.0.0.1:80/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	    check_connect_url = objects.Server(connect_url='http://127.0.0.1:80')
54	    assert check_connect_url.connect_url == 'http://127.0.0.1:80/'
55	    check_connect_url = objects.Server(connect_url='http://127.0.0.1:80/')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    assert check_connect_url.connect_url == 'http://127.0.0.1:80/'
55	    check_connect_url = objects.Server(connect_url='http://127.0.0.1:80/')
56	    assert check_connect_url.connect_url == 'http://127.0.0.1:80/'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_orm.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    check_connect_url = objects.Server(connect_url='http://127.0.0.1:80/')
56	    assert check_connect_url.connect_url == 'http://127.0.0.1:80/'
57	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	    url = ujoin(public_host(app), app.hub.base_url)
34	    r = await async_requests.get(url)
35	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	    cookies = await app.login_user('river')
41	    r = await async_requests.get(public_url(app), cookies=cookies)
42	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	    r.raise_for_status()
67	    url = r.headers.get('Location', '')
68	    path = urlparse(url).path

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	    r.raise_for_status()
78	    url = r.headers.get('Location', '')
79	    path = urlparse(url).path

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
178	    # stop server to ensure /user/name is handled by the Hub
179	    r = await api_request(
180	        app, 'users', name, 'server', method='delete', cookies=cookies
181	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
178	    # stop server to ensure /user/name is handled by the Hub
179	    r = await api_request(
180	        app, 'users', name, 'server', method='delete', cookies=cookies
181	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
208	    # implemented in MockSpawner
209	    r = await async_requests.get(ujoin(public_url(app, u), 'env'))
210	    env = r.json()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
214	    # stop server
215	    r = await api_request(app, 'users', name, 'server', method='delete')
216	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
214	    # stop server
215	    r = await api_request(app, 'users', name, 'server', method='delete')
216	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254	        await asyncio.sleep(0.1)
255	        r = await async_requests.get(r.url, cookies=cookies)
256	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
349	        next_url = ujoin(app.base_url, 'user/jones/tree')
350	        r = await async_requests.get(
351	            url_concat(
352	                ujoin(base_url, 'spawn'),
353	                {'next': next_url, 'energy': '510keV'},
354	            ),
355	            cookies=cookies,
356	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
372	        next_url = ujoin(app.base_url, 'user/jones/tree')
373	        r = await async_requests.get(
374	            url_concat(
375	                ujoin(base_url, 'spawn'),
376	                {'next': next_url, 'energy': '510keV', 'illegal_argument': '42'},
377	            ),
378	            cookies=cookies,
379	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
391	        next_url = ujoin(app.base_url, 'user/jones/tree')
392	        r = await async_requests.get(
393	            url_concat(ujoin(base_url, 'spawn'), {'next': next_url}), cookies=cookies
394	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
398	        action_url = public_host(app) + form["action"]
399	        r = await async_requests.post(
400	            action_url,
401	            cookies=cookies,
402	            data={'bounds': ['-1', '1'], 'energy': '511keV'},
403	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
440	        url = ujoin(base_url, 'spawn', user.name)
441	        r = await async_requests.get(
442	            url_concat(url, {'next': next_url}),
443	            cookies=cookies,
444	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
453	
454	        r = await async_requests.post(
455	            action_url,
456	            cookies=cookies,
457	            data={'bounds': ['-3', '3'], 'energy': '938MeV'},
458	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
465	            await asyncio.sleep(0.1)
466	            r = await async_requests.get(r.url, cookies=cookies)
467	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
486	
487	        r = await async_requests.get(
488	            url,
489	            cookies=cookies,
490	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
495	
496	        r = await async_requests.post(
497	            action_url,
498	            cookies=cookies,
499	            data={'bounds': ['-1', '1'], 'energy': '511keV'},
500	            files={'hello': ('hello.txt', b'hello world\n')},
501	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
535	    # ?next query arg is preserved
536	    assert parse_qs(url.query).get('next') == [next_url]
537	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
553	    # (double-duty because we also want to wait for the spawn to finish)
554	    progress = await api_request(app, 'users', username, 'server/progress', stream=True)
555	    ex = async_requests.executor

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
553	    # (double-duty because we also want to wait for the spawn to finish)
554	    progress = await api_request(app, 'users', username, 'server/progress', stream=True)
555	    ex = async_requests.executor

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
563	    # refresh page after progress is complete
564	    r = await async_requests.get(r.url, cookies=cookies)
565	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
589	        await asyncio.sleep(0.1)
590	        r = await async_requests.get(r.url, cookies=cookies)
591	        path = urlparse(r.url).path

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
728	    login_url = base_url + 'hub/login'
729	    r = await async_requests.get(login_url)
730	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
731	    xsrf = r.cookies['_xsrf']
732	    r = await async_requests.get(login_url)
733	    assert set(r.cookies.keys()).issubset({"_xsrf"})

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
733	    assert set(r.cookies.keys()).issubset({"_xsrf"})
734	    r = await async_requests.post(
735	        login_url,
736	        data={'username': name, 'password': 'wrong', '_xsrf': xsrf},
737	        allow_redirects=False,
738	        cookies=r.cookies,
739	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
752	    base_url = public_url(app)
753	    r = await async_requests.post(
754	        base_url + 'hub/login',
755	        data={
756	            'username': name,
757	            'password': name,
758	            '_xsrf': "wrong",
759	        },
760	        allow_redirects=False,
761	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
796	        form_data["_xsrf"] = xsrf_input["value"]
797	        await async_requests.post(
798	            action_url, data=form_data, allow_redirects=False, cookies=cookies
799	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
816	        (False, '/has?repo=https/host.git', '/has?repo=https/host.git', None),
817	        (False, '/has?repo=https://host.git', '/has?repo=https://host.git', None),
818	        (False, '/has#repo=https://host.git', '/has#repo=https://host.git', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
816	        (False, '/has?repo=https/host.git', '/has?repo=https/host.git', None),
817	        (False, '/has?repo=https://host.git', '/has?repo=https://host.git', None),
818	        (False, '/has#repo=https://host.git', '/has#repo=https://host.git', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
817	        (False, '/has?repo=https://host.git', '/has?repo=https://host.git', None),
818	        (False, '/has#repo=https://host.git', '/has#repo=https://host.git', None),
819	        # next_url outside is not allowed
820	        (False, 'relative/path', '', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
817	        (False, '/has?repo=https://host.git', '/has?repo=https://host.git', None),
818	        (False, '/has#repo=https://host.git', '/has#repo=https://host.git', None),
819	        # next_url outside is not allowed
820	        (False, 'relative/path', '', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
820	        (False, 'relative/path', '', None),
821	        (False, 'https://other.domain', '', None),
822	        (False, 'ftp://other.domain', '', None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
925	    )
926	    r = await async_requests.get(
927	        public_host(app) + location, cookies=cookies, allow_redirects=False
928	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
933	    assert location == ujoin(app.base_url, "/hub/?xyz=5")
934	    r = await async_requests.get(
935	        public_host(app) + location, cookies=cookies, allow_redirects=False
936	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:945
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
944	        def get(self):
945	            self.write('ok!')
946	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
951	    # no auto_login: end up at /hub/login
952	    r = await async_requests.get(base_url)
953	    assert r.url == url_concat(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:961
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
960	    with mock.patch.dict(app.tornado_settings, {'authenticator': authenticator}):
961	        r = await async_requests.get(base_url)
962	    assert r.url == url_concat(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
975	    ):
976	        r = await s.get(
977	            public_host(app) + app.tornado_settings['logout_url'], cookies=cookies
978	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
997	    s.cookies = cookies
998	    r = await s.get(
999	        public_host(app) + app.tornado_settings['logout_url'],
1000	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:1032
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1031	    ):
1032	        r = await s.get(
1033	            public_host(app) + app.tornado_settings['logout_url'], cookies=cookies
1034	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:1064
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1063	    base_url = ujoin(public_host(app), app.hub.base_url)
1064	    r = await async_requests.get(ujoin(base_url, 'logo'))
1065	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:1067
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1066	    assert r.headers['content-type'] == 'image/png'
1067	    r = await async_requests.get(
1068	        ujoin(base_url, 'static', 'images', 'jupyterhub-80.png')
1069	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:1072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1071	    assert r.headers['content-type'] == 'image/png'
1072	    r = await async_requests.get(ujoin(base_url, 'static', 'css', 'style.min.css'))
1073	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_pages.py:1219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1218	    url = url_path_join(public_url(app, service) + 'owhoami/?arg=x')
1219	    r = await s.get(url)
1220	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
33	    auth_token = 'secret!'
34	    proxy_ip = '127.0.0.1'
35	    proxy_port = random_port()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
93	    add_user(app.db, app, name=name)
94	    r = await api_request(
95	        app, 'users', name, 'server', method='post', bypass_proxy=True
96	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
119	    # poke the server to update the proxy
120	    r = await api_request(app, 'proxy', method='post', bypass_proxy=True)
121	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
152	    new_api_url = f'http://{proxy_ip}:{proxy_port}'
153	    r = await api_request(
154	        app,
155	        'proxy',
156	        method='patch',
157	        data=json.dumps({'api_url': new_api_url, 'auth_token': new_auth_token}),
158	        bypass_proxy=True,
159	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
173	    test_user = add_user(app.db, app, name=username)
174	    r = await api_request(app, f'users/{username}/server', method='post')
175	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	        validated_routespec = routespec + "/"
222	    target = 'http://localhost:9999/test'
223	    proxy.extra_routes = {routespec: target}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
257	
258	    extra_routes = {routespec: "https://127.0.0.1"}
259	    if isinstance(expected, type) and issubclass(expected, BaseException):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
269	    [
270	        ("http://host", "http://host"),
271	        ("https://host", "https://host"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
269	    [
270	        ("http://host", "http://host"),
271	        ("https://host", "https://host"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	        ("http://host", "http://host"),
271	        ("https://host", "https://host"),
272	        ("/missing-host", ValueError),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	        ("http://host", "http://host"),
271	        ("https://host", "https://host"),
272	        ("/missing-host", ValueError),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
319	    proxy = app.proxy
320	    target = 'https://localhost:1234'
321	    with context():

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_proxy.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
341	async def test_proxy_patch_bad_request_data(app, test_data):
342	    r = await api_request(app, 'proxy', method='patch', data=test_data)
343	    assert r.status_code == 400

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	        'JUPYTERHUB_API_URL': url_path_join(app.hub.url, 'api/'),
30	        'JUPYTERHUB_SERVICE_URL': f'http://127.0.0.1:{random_port()}',
31	    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	    url = public_url(app, service) + '/foo'
69	    r = await async_requests.get(url, allow_redirects=False)
70	    path = f'/services/{name}/foo'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	        url = public_url(app, service) + '/api/users'
104	        r = await async_requests.get(url, allow_redirects=False)
105	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	                'name': name_1,
152	                'url': "http://irrelevant",
153	            },
154	            {
155	                'name': name_2,
156	                'url': "http://irrelevant",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	                'name': name_2,
156	                'url': "http://irrelevant",
157	            },
158	        ]
159	        await maybe_future(app.init_services())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	    with monotonic_future:
55	        assert cache.get('key', 'default') == 'default'
56	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	    with monotonic_future:
62	        assert cache.get('key', 'default') == 'cached value'
63	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	    # token without sufficient permission in Authorization header
73	    r = await async_requests.get(
74	        public_url(app, mockservice_url) + '/whoami/',
75	        headers={'Authorization': f'token {no_access_token}'},
76	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	    # token in Authorization header
80	    r = await async_requests.get(
81	        public_url(app, mockservice_url) + '/whoami/',
82	        headers={'Authorization': f'token {token}'},
83	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	    reply = r.json()
86	    sub_reply = {key: reply.get(key, 'missing') for key in ['name', 'admin']}
87	    assert sub_reply == {'name': u.name, 'admin': False}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	    # token in ?token parameter is not allowed by default
90	    r = await async_requests.get(
91	        public_url(app, mockservice_url) + f'/whoami/?token={token}',
92	        allow_redirects=False,
93	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
150	    # token in Authorization header
151	    r = await async_requests.get(
152	        public_url(app, mockservice_url) + 'whoami/',
153	        headers={'Authorization': f'token {token}'},
154	        allow_redirects=False,
155	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	    # token in ?token parameter is not allowed by default
172	    r = await async_requests.get(
173	        public_url(app, mockservice_url) + f'whoami/?token={token}',
174	        allow_redirects=False,
175	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	
292	    r = await s.get(url)
293	    if expected_scopes is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
297	        assert dest_url == public_url(app, mockservice_url) + "oauth_callback"
298	        assert parse_qs(query).get("error") == ["invalid_scope"]
299	        assert r.status_code == 400

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
316	    data["_xsrf"] = s.cookies["_xsrf"]
317	    r = await s.post(r.url, data=data)
318	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
325	    # second request should be authenticated, which means no redirects
326	    r = await s.get(url, allow_redirects=False)
327	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	    reply = r.json()
331	    sub_reply = {key: reply.get(key, 'missing') for key in ('kind', 'name')}
332	    assert sub_reply == {'name': user.name, 'kind': 'user'}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
360	    s.headers["Authorization"] = f"Bearer {token}"
361	    r = await async_requests.get(url, headers=s.headers)
362	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
396	
397	    r = await s.get(url)
398	    if not expect_success:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
407	    # submit the oauth form to complete authorization
408	    r = await s.post(r.url, data={"_xsrf": s.cookies["_xsrf"]})
409	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
416	    # second request should be authenticated, which means no redirects
417	    r = await s.get(url, allow_redirects=False)
418	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
420	    reply = r.json()
421	    sub_reply = {key: reply.get(key, 'missing') for key in ('kind', 'name')}
422	    assert sub_reply == {'name': name, 'kind': 'user'}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
430	
431	    r = await s.get(url, allow_redirects=False)
432	    assert r.status_code == 403

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	    url = url_path_join(public_url(app, service) + 'owhoami/?arg=x')
479	    r = await s.get(url)
480	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
504	    url_1 = url + "?oauth_test=1"
505	    oauth_1 = await s.get(url_1)
506	    assert state_cookie_name in s.cookies

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
524	    url_2 = url + "?oauth_test=2"
525	    oauth_2 = await s.get(url_2)
526	    state_cookies = [c for c in s.cookies.keys() if c.startswith(state_cookie_name)]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
546	    # submit the oauth form to complete authorization
547	    hub_xsrf = s.cookies.get("_xsrf", path=app.hub.base_url)
548	    r = await s.post(oauth.url, data={'scopes': ['identify'], "_xsrf": hub_xsrf})

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
547	    hub_xsrf = s.cookies.get("_xsrf", path=app.hub.base_url)
548	    r = await s.post(oauth.url, data={'scopes': ['identify'], "_xsrf": hub_xsrf})
549	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
563	    # finish other oauth
564	    r = await s.post(second_oauth.url, data={'scopes': ['identify'], "_xsrf": hub_xsrf})
565	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
600	    assert 'jupyterhub-session-id' in s.cookies
601	    r = await s.get(url)
602	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
604	    # submit the oauth form to complete authorization
605	    r = await s.post(r.url, data={'scopes': ['identify'], "_xsrf": s.cookies["_xsrf"]})
606	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
609	    # second request should be authenticated
610	    r = await s.get(url, allow_redirects=False)
611	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
613	    reply = r.json()
614	    sub_reply = {key: reply.get(key, 'missing') for key in ('kind', 'name')}
615	    assert sub_reply == {'name': name, 'kind': 'user'}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
626	    # hit hub logout URL
627	    r = await s.get(public_url(app, path='hub/logout'))
628	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
632	    # i.e. redirect back to login page
633	    r = await s.get(url)
634	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
649	
650	    r = await s.get(url, allow_redirects=False)
651	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_services_auth.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
653	    reply = r.json()
654	    sub_reply = {key: reply.get(key, 'missing') for key in ('kind', 'name')}
655	    assert sub_reply == {'name': name, 'kind': 'user'}

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
449	
450	    r = await api_request(
451	        app, f"/shares/{user.name}/", method="post", data=json.dumps(body)
452	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
449	
450	    r = await api_request(
451	        app, f"/shares/{user.name}/", method="post", data=json.dumps(body)
452	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
476	
477	    r = await api_request(app, share_path, method="post", data=json.dumps(body))
478	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
476	
477	    r = await api_request(app, share_path, method="post", data=json.dumps(body))
478	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
544	
545	    r = await api_request(
546	        app,
547	        f"/shares/{user.name}/",
548	        method="post",
549	        data=json.dumps(body),
550	        name=requester.name,
551	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
544	
545	    r = await api_request(
546	        app,
547	        f"/shares/{user.name}/",
548	        method="post",
549	        data=json.dumps(body),
550	        name=requester.name,
551	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
622	
623	    r = await api_request(
624	        app,
625	        f"/shares/{user.name}/",
626	        method="patch",
627	        data=json.dumps(body),
628	        name=requester.name,
629	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
622	
623	    r = await api_request(
624	        app,
625	        f"/shares/{user.name}/",
626	        method="patch",
627	        data=json.dumps(body),
628	        name=requester.name,
629	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
672	
673	    r = await api_request(
674	        app,
675	        f"/shares/{user.name}/",
676	        method="delete",
677	        name=requester.name,
678	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
672	
673	    r = await api_request(
674	        app,
675	        f"/shares/{user.name}/",
676	        method="delete",
677	        name=requester.name,
678	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
681	    # get updated share list
682	    r = await api_request(
683	        app,
684	        f"/shares/{user.name}/",
685	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
681	    # get updated share list
682	    r = await api_request(
683	        app,
684	        f"/shares/{user.name}/",
685	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
720	
721	    r = await api_request(app, f"/{kind}/{name}/shared")
722	    if name == "notfound":

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
720	
721	    r = await api_request(app, f"/{kind}/{name}/shared")
722	    if name == "notfound":

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
916	    expected_shares = sorted(expected_shares)
917	    r = await api_request(app, f"/shares/{user.name}/", name=requester.name)
918	    if ok:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
916	    expected_shares = sorted(expected_shares)
917	    r = await api_request(app, f"/shares/{user.name}/", name=requester.name)
918	    if ok:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
975	    expected_shares = sorted(expected_shares)
976	    r = await api_request(app, f"/shares/{user.name}", name=requester.name)
977	    assert r.status_code == status

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
975	    expected_shares = sorted(expected_shares)
976	    r = await api_request(app, f"/shares/{user.name}", name=requester.name)
977	    assert r.status_code == status

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
992	async def test_shares_api_list_no_such_owner(app):
993	    r = await api_request(app, "/shares/nosuchuser")
994	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
992	async def test_shares_api_list_no_such_owner(app):
993	    r = await api_request(app, "/shares/nosuchuser")
994	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:995
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
994	    assert r.status_code == 404
995	    r = await api_request(app, "/shares/nosuchuser/")
996	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:995
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
994	    assert r.status_code == 404
995	    r = await api_request(app, "/shares/nosuchuser/")
996	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:997
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
996	    assert r.status_code == 404
997	    r = await api_request(app, "/shares/nosuchuser/namedserver")
998	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:997
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
996	    assert r.status_code == 404
997	    r = await api_request(app, "/shares/nosuchuser/namedserver")
998	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1010	    """test methods defined on /shares/:user/:server not defined on /shares/:user"""
1011	    r = await api_request(app, f"/shares/{user.name}", method=method)
1012	    assert r.status_code == 405

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1010	    """test methods defined on /shares/:user/:server not defined on /shares/:user"""
1011	    r = await api_request(app, f"/shares/{user.name}", method=method)
1012	    assert r.status_code == 405

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1028	    share_url = f"shares/{user.name}/{spawner.name}"
1029	    r = await api_request(
1030	        app,
1031	        share_url,
1032	        method="post",
1033	        name=user.name,
1034	        data=json.dumps({"user": share_user.name}),
1035	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1029
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1028	    share_url = f"shares/{user.name}/{spawner.name}"
1029	    r = await api_request(
1030	        app,
1031	        share_url,
1032	        method="post",
1033	        name=user.name,
1034	        data=json.dumps({"user": share_user.name}),
1035	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1041	    token = share_user.new_api_token()
1042	    r = await async_requests.get(user_url, headers={"Authorization": f"Bearer {token}"})
1043	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1046
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1045	    # revoke access
1046	    r = await api_request(
1047	        app,
1048	        share_url,
1049	        method="patch",
1050	        name=user.name,
1051	        data=json.dumps(
1052	            {
1053	                "scopes": share_model["scopes"],
1054	                "user": share_user.name,
1055	            }

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1046
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1045	    # revoke access
1046	    r = await api_request(
1047	        app,
1048	        share_url,
1049	        method="patch",
1050	        name=user.name,
1051	        data=json.dumps(
1052	            {
1053	                "scopes": share_model["scopes"],
1054	                "user": share_user.name,
1055	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1060	    token = share_user.new_api_token()
1061	    r = await async_requests.get(user_url, headers={"Authorization": f"Bearer {token}"})
1062	    assert r.status_code == 403

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1076	    """test methods defined on /share-codes/:user/:server not defined on /share-codes/:user"""
1077	    r = await api_request(app, f"/share-codes/{user.name}", method=method)
1078	    assert r.status_code == 405

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1076	    """test methods defined on /share-codes/:user/:server not defined on /share-codes/:user"""
1077	    r = await api_request(app, f"/share-codes/{user.name}", method=method)
1078	    assert r.status_code == 405

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1117	        path = f"/share-codes/{user.name}/"
1118	    r = await api_request(app, path, name=requester.name)
1119	    assert r.status_code == status

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1117	        path = f"/share-codes/{user.name}/"
1118	    r = await api_request(app, path, name=requester.name)
1119	    assert r.status_code == status

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1134	    spawner = user.spawner.orm_spawner  # noqa
1135	    r = await api_request(app, "/share-codes/nosuchuser")
1136	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1134	    spawner = user.spawner.orm_spawner  # noqa
1135	    r = await api_request(app, "/share-codes/nosuchuser")
1136	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1136	    assert r.status_code == 404
1137	    r = await api_request(app, "/share-codes/nosuchuser/")
1138	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1136	    assert r.status_code == 404
1137	    r = await api_request(app, "/share-codes/nosuchuser/")
1138	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1138	    assert r.status_code == 404
1139	    r = await api_request(app, f"/share-codes/{user.name}/nosuchserver")
1140	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1138	    assert r.status_code == 404
1139	    r = await api_request(app, f"/share-codes/{user.name}/nosuchserver")
1140	    assert r.status_code == 404

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1192	
1193	    r = await api_request(
1194	        app,
1195	        f"/share-codes/{user.name}/",
1196	        method="post",
1197	        data=json.dumps(body),
1198	        name=requester.name,
1199	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1192	
1193	    r = await api_request(
1194	        app,
1195	        f"/share-codes/{user.name}/",
1196	        method="post",
1197	        data=json.dumps(body),
1198	        name=requester.name,
1199	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1240	
1241	    r = await api_request(
1242	        app,
1243	        f"/share-codes/{user.name}/",
1244	        method="post",
1245	        data=json.dumps(body),
1246	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1240	
1241	    r = await api_request(
1242	        app,
1243	        f"/share-codes/{user.name}/",
1244	        method="post",
1245	        data=json.dumps(body),
1246	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1262	    async def get_code():
1263	        r = await api_request(
1264	            app,
1265	            f"/share-codes/{user.name}/",
1266	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1262	    async def get_code():
1263	        r = await api_request(
1264	            app,
1265	            f"/share-codes/{user.name}/",
1266	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1338	
1339	    r = await api_request(
1340	        app,
1341	        url,
1342	        method="delete",
1343	        name=requester.name,
1344	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1338	
1339	    r = await api_request(
1340	        app,
1341	        url,
1342	        method="delete",
1343	        name=requester.name,
1344	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1399	    accept_url = public_url(app) + "hub/accept-share"
1400	    r = await async_requests.post(
1401	        accept_url,
1402	        cookies=cookies,
1403	        data=form_data,
1404	        allow_redirects=False,
1405	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1482	    accept_url = r.url
1483	    r = await async_requests.post(
1484	        accept_url,
1485	        cookies=cookies,
1486	        data=form_data,
1487	        allow_redirects=False,
1488	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_shares.py:1422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1421	        (True, None, "{USER_URL}"),
1422	        (False, "https://example.com{BASE_URL}", "{USER_URL}"),
1423	        (False, "{BASE_URL}hub", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	
23	IS_JUPYVERSE = os.environ.get("JUPYTERHUB_SINGLEUSER_APP") == "jupyverse"
24	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	    # no cookies, redirects to login page
82	    r = await s.get(url)
83	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	    api_url = url_path_join(url, "api/status")
88	    r = await s.get(api_url, allow_redirects=False)
89	    assert r.status_code == 403

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	    # with cookies, login successful
92	    r = await s.get(url, cookies=cookies)
93	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	    # logout
106	    r = await s.get(url_path_join(url, 'logout'), allow_redirects=False)
107	    assert len(r.cookies) == 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	    s.cookies = cookies
120	    r = await s.get(url)
121	    assert urlparse(r.url).path.endswith('/oauth2/authorize')

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
127	    # submit the oauth form to complete authorization
128	    r = await s.post(r.url, data={'scopes': ['identify'], '_xsrf': s.cookies['_xsrf']})
129	    final_url = urlparse(r.url).path.rstrip('/')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	
143	    r = await s.get(r.url, allow_redirects=False)
144	    assert r.status_code == 403

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
179	    with (jupyter_config_dir / "jupyter_server_config.py").open("w") as f:
180	        f.write("c.TestSingleUser.jupyter_config_py = True")
181	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	    # with cookies, login successful
188	    r = await s.get(url)
189	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
247	    with sub_dir.join("subfile.txt").open("w") as f:
248	        f.write("txt\n")
249	    abs_dir = tmpdir.join("abs").mkdir()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
250	    with abs_dir.join("absfile.txt").open("w") as f:
251	        f.write("absfile\n")
252	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
267	    url = public_url(app, user)
268	    r = await async_requests.get(
269	        url_path_join(public_url(app, user), 'jupyterhub-test-info'), headers=headers
270	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	    # secondary check: make sure it has the intended effect on root_dir
277	    r = await async_requests.get(
278	        url_path_join(public_url(app, user), 'api/contents/'), headers=headers
279	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
335	    with (jupyter_config_dir / "jupyter_server_config.py").open("w") as f:
336	        f.write("c.ServerApp.allow_unauthenticated_access = False")
337	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
385	        expect_error = (
386	            os.environ.get("JUPYTERHUB_SINGLEUSER_EXTENSION") == "1"
387	            or not have_notebook

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
458	    s = AsyncSession()
459	    r = await s.get(url + f"?token={token}", allow_redirects=False)
460	    print(r.url, r.status_code)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
468	    # no token in URL
469	    r = await s.get(url, allow_redirects=False)
470	    assert r.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_singleuser.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
480	    s = AsyncSession()
481	    r = await s.get(url, allow_redirects=False)
482	    # 403, not redirect

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
64	    ip, port = await spawner.start()
65	    assert ip == '127.0.0.1'
66	    assert isinstance(port, int)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
120	    await user.spawn()
121	    assert spawner.server.ip == '127.0.0.1'
122	    assert spawner.server.port > 0

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
245	    f = tmpdir.join('bashrc')
246	    f.write('export TESTVAR=foo\n')
247	    s = new_spawner(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
245	    f = tmpdir.join('bashrc')
246	    f.write('export TESTVAR=foo\n')
247	    s = new_spawner(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	    await wait_for_spawner(s)
263	    r = await async_requests.get(f'http://{ip}:{port}/env')
264	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
471	    url = url_path_join(public_url(app, user), "test/url")
472	    r = await async_requests.get(url, **kwargs)
473	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
480	    env_overrides = {
481	        "JUPYTERHUB_API_URL": "https://test.horse/hub/api",
482	        "TEST_KEY": "value",
483	    }
484	    spawner = new_spawner(db, environment=env_overrides)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
491	async def test_hub_connect_url(db):
492	    spawner = new_spawner(db, hub_connect_url="https://example.com/")
493	    name = spawner.user.name

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
494	    env = spawner.get_env()
495	    assert env["JUPYTERHUB_API_URL"] == "https://example.com/api"
496	    assert (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
497	        env["JUPYTERHUB_ACTIVITY_URL"]
498	        == f"https://example.com/api/users/{name}/activity"
499	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
673	    spawner = Spawner()
674	    spawner.server = Server.from_url("http://1.2.3.4")
675	    assert spawner.server is not None

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_spawner.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
675	    assert spawner.server is not None
676	    assert spawner.server.ip == "1.2.3.4"
677	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_user.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        ("name", "", "", ""),
79	        ("", "https://hub.tld/PREFIX/", "", "https://hub.tld/PREFIX/user/USERNAME/"),
80	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_user.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        ("name", "", "", ""),
79	        ("", "https://hub.tld/PREFIX/", "", "https://hub.tld/PREFIX/user/USERNAME/"),
80	        (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_user.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	            "name",
82	            "https://hub.tld/PREFIX/",
83	            "",
84	            "https://hub.tld/PREFIX/user/USERNAME/name/",
85	        ),
86	        (
87	            "name",
88	            "",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_user.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	            "",
84	            "https://hub.tld/PREFIX/user/USERNAME/name/",
85	        ),
86	        (
87	            "name",
88	            "",
89	            "https://hub.tld:123",
90	            "https://USERNAME.hub.tld:123/PREFIX/user/USERNAME/name/",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_user.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	            "",
89	            "https://hub.tld:123",
90	            "https://USERNAME.hub.tld:123/PREFIX/user/USERNAME/name/",
91	        ),
92	    ],
93	)
94	def test_public_url(app, user, server_name, public_url, subdomain_host, expected_url):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_user.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	            "https://hub.tld:123",
90	            "https://USERNAME.hub.tld:123/PREFIX/user/USERNAME/name/",
91	        ),
92	    ],
93	)
94	def test_public_url(app, user, server_name, public_url, subdomain_host, expected_url):
95	    expected_url = expected_url.replace("USERNAME", user.escaped_name).replace(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/test_utils.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
82	    def __init__(self):
83	        self.executor = ThreadPoolExecutor(1)
84	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
24	    def __init__(self):
25	        self.executor = ThreadPoolExecutor(1)
26	        real_submit = self.executor.submit

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	skip_if_ssl = pytest.mark.skipif(
70	    os.environ.get('SSL_ENABLED', False), reason="Does not use internal SSL"
71	)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/utils.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	    """Add a user to the database."""
126	    orm_user = find_user(db, name=kwargs.get('name'))
127	    if orm_user is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/utils.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
134	    db.commit()
135	    requested_roles = kwargs.get('roles')
136	    if requested_roles:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/utils.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	    assert 'http' not in resp.headers['Content-Security-Policy']
193	    if not kwargs.get('stream', False) and resp.content:
194	        assert resp.headers.get('content-type') == 'application/json'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/utils.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
193	    if not kwargs.get('stream', False) and resp.content:
194	        assert resp.headers.get('content-type') == 'application/json'
195	    return resp

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/tests/utils.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
210	    headers.setdefault("Sec-Fetch-Mode", "navigate")
211	    return async_requests.get(ujoin(base_url, path), **kw)
212	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
79	    """Get a single random port."""
80	    sock = socket.socket()
81	    sock.bind(('', 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
82	    port = sock.getsockname()[1]
83	    sock.close()
84	    return port

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
110	    """
111	    if ip in {'', '0.0.0.0'}:
112	        ip = '127.0.0.1'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
111	    if ip in {'', '0.0.0.0'}:
112	        ip = '127.0.0.1'
113	    elif ip == "::":

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
115	    try:
116	        socket.create_connection((ip, port)).close()
117	    except OSError as e:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
271	    """Wait for any server to show up at ip:port."""
272	    if ip in {'', '0.0.0.0'}:
273	        ip = '127.0.0.1'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
272	    if ip in {'', '0.0.0.0'}:
273	        ip = '127.0.0.1'
274	    elif ip == "::":

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
279	    await exponential_backoff(
280	        lambda: can_connect(ip, port),
281	        f"Server at {display_ip}:{port} didn't respond in {timeout} seconds",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
578	        stack = traceback.extract_stack(frame)
579	        if thread is threading.current_thread():
580	            # truncate last two frames of the current thread

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/jupyterhub/utils.py:579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
578	        stack = traceback.extract_stack(frame)
579	        if thread is threading.current_thread():
580	            # truncate last two frames of the current thread

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/jupyterhub-5.3.0rc0/jupyterhub-5.3.0rc0/testing/jupyterhub_config.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	# only listen on localhost for testing
17	c.JupyterHub.bind_url = 'http://127.0.0.1:8000'
18	
19	# don't cache static files
20	c.JupyterHub.tornado_settings = {

--------------------------------------------------

Code scanned:
	Total lines of code: 38642
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 149.0
		High: 772.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 905.0
		High: 16.0
Files skipped (0):
