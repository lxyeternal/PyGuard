Run started:2025-04-12 18:06:45.508034

Test results:
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/core/emitters/udp_emitter.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
23	
24	        self._socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
25	        self._socket.setblocking(0)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/core/plugins/ec2_plugin.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	ORIGIN = 'AWS::EC2::Instance'
9	IMDS_URL = 'http://169.254.169.254/latest/'
10	
11	
12	def initialize():

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/core/plugins/ec2_plugin.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
80	    req.method = method
81	    res = urlopen(req, timeout=1)
82	    return res.read().decode('utf-8')

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/core/plugins/ecs_plugin.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
13	        runtime_context = {}
14	        host_name = socket.gethostname()
15	        if host_name:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/core/plugins/ecs_plugin.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
13	        runtime_context = {}
14	        host_name = socket.gethostname()
15	        if host_name:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
148	
149	    def _create_xray_client(self, ip='127.0.0.1', port='2000'):
150	        session = botocore.session.get_session()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/core/sampling/connector.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	        session = botocore.session.get_session()
151	        url = 'http://%s:%s' % (ip, port)
152	        return session.create_client('xray', endpoint_url=url,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/flask/middleware.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
17	        self._recorder = recorder
18	        self.app.before_request(self._before_request)
19	        self.app.after_request(self._after_request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/flask/middleware.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
18	        self.app.before_request(self._before_request)
19	        self.app.after_request(self._after_request)
20	        self.app.teardown_request(self._teardown_request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/flask/middleware.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
19	        self.app.after_request(self._after_request)
20	        self.app.teardown_request(self._teardown_request)
21	        self.in_lambda_ctx = False

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httplib/patch.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
112	        # skip any ignored requests
113	        if _ignore_request(instance, instance.host, url):
114	            return wrapped(*args, **kwargs)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httpx/patch.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
45	
46	            response = self._wrapped_transport.handle_request(request)
47	            if subsegment is not None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/httpx/patch.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
67	
68	            response = await self._wrapped_transport.handle_async_request(request)
69	            if subsegment is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/aws_xray_sdk/ext/pynamodb/patch.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	    if return_value is not None:
70	        aws_meta['request_id'] = return_value.headers.get('x-amzn-RequestId')
71	        subsegment.put_http_meta(http.STATUS, return_value.status_code)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	with open(path.join(CURRENT_DIR, 'README.md'), 'r') as f:
8	    long_description = f.read()
9	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	
19	    url='https://github.com/aws/aws-xray-sdk-python',
20	
21	    author='Amazon Web Services',

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_daemon_config.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
6	
7	DEFAULT_IP = '127.0.0.1'
8	DEFAULT_PORT = 2000

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_daemon_config.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
23	
24	    assert config.udp_ip == '192.168.0.1'
25	    assert config.tcp_ip == '192.168.0.1'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_daemon_config.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
24	    assert config.udp_ip == '192.168.0.1'
25	    assert config.tcp_ip == '192.168.0.1'
26	    assert config.udp_port == 3000

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_daemon_config.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
33	
34	    assert config.udp_ip == '127.0.0.2'
35	    assert config.tcp_ip == '192.168.0.1'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_daemon_config.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
34	    assert config.udp_ip == '127.0.0.2'
35	    assert config.tcp_ip == '192.168.0.1'
36	    assert config.udp_port == 8080

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_daemon_config.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
41	
42	    assert config.udp_ip == '127.0.0.2'
43	    assert config.tcp_ip == '192.168.0.1'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_daemon_config.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
42	    assert config.udp_ip == '127.0.0.2'
43	    assert config.tcp_ip == '192.168.0.1'
44	    assert config.udp_port == 8080

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_daemon_config.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
49	    with pytest.raises(InvalidDaemonAddressException):
50	        DaemonConfig('192.168.0.1')
51	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_serialize_entities.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
220	    
221	    segment.put_http_meta(http.URL, 'https://aws.amazon.com')
222	    segment.put_http_meta(http.METHOD, 'get')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_serialize_entities.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
223	    segment.put_http_meta(http.USER_AGENT, 'test')
224	    segment.put_http_meta(http.CLIENT_IP, '127.0.0.1')
225	    segment.put_http_meta(http.X_FORWARDED_FOR, True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_serialize_entities.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
237	        "request": {
238	            "url": "https://aws.amazon.com",
239	            "method": "get",
240	            "user_agent": "test",
241	            "client_ip": "127.0.0.1",
242	            "x_forwarded_for": True
243	        },
244	        "response": {
245	            "status": 200,

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_serialize_entities.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
240	            "user_agent": "test",
241	            "client_ip": "127.0.0.1",
242	            "x_forwarded_for": True
243	        },
244	        "response": {
245	            "status": 200,
246	            "content_length": 0
247	        }
248	    },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_serialize_entities.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
390	    
391	    subsegment.put_http_meta(http.URL, 'https://aws.amazon.com')
392	    subsegment.put_http_meta(http.METHOD, 'get')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_serialize_entities.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
406	        "request": {
407	            "url": "https://aws.amazon.com",
408	            "method": "get"
409	        },
410	        "response": {
411	            "status": 200,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_utils.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	def test_get_hostname():
27	    s1 = get_hostname("https://amazon.com/")
28	    assert s1 == "amazon.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_utils.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	
30	    s2 = get_hostname("https://amazon.com/avery_long/path/and/stuff")
31	    assert s2 == "amazon.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_utils.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	
33	    s3 = get_hostname("http://aws.amazon.com/should_get/sub/domains")
34	    assert s3 == "aws.amazon.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_utils.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	
36	    s4 = get_hostname("https://amazon.com/somestuff?get=request&data=chiem")
37	    assert s4 == "amazon.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_utils.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	def test_strip_url():
50	    s1 = strip_url("https://amazon.com/page?getdata=response&stuff=morestuff")
51	    assert s1 == "https://amazon.com/page"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/aws_xray_sdk-2.14.0/aws_xray_sdk-2.14.0/tests/test_utils.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    s1 = strip_url("https://amazon.com/page?getdata=response&stuff=morestuff")
51	    assert s1 == "https://amazon.com/page"
52	

--------------------------------------------------

Code scanned:
	Total lines of code: 7179
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 10.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 2.0
Files skipped (0):
