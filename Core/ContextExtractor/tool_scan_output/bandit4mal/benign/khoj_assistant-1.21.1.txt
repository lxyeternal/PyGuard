Run started:2025-04-12 16:47:30.967071

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/app/settings.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
32	KHOJ_DOMAIN = os.getenv("KHOJ_DOMAIN", "khoj.dev")
33	ALLOWED_HOSTS = [f".{KHOJ_DOMAIN}", "localhost", "127.0.0.1", "[::1]", f"{KHOJ_DOMAIN}"]
34	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/app/settings.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	CSRF_TRUSTED_ORIGINS = [
36	    f"https://*.{KHOJ_DOMAIN}",
37	    f"https://{KHOJ_DOMAIN}",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/app/settings.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    f"https://{KHOJ_DOMAIN}",
38	    f"http://*.{KHOJ_DOMAIN}",
39	    f"http://{KHOJ_DOMAIN}",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/app/settings.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    f"http://{KHOJ_DOMAIN}",
40	    f"https://app.{KHOJ_DOMAIN}",
41	]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/configure.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	    async def authenticate(self, request: HTTPConnection):
113	        current_user = request.session.get("user")
114	        if current_user and current_user.get("email"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/configure.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	        current_user = request.session.get("user")
114	        if current_user and current_user.get("email"):
115	            user = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/configure.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
115	            user = (
116	                await self.khojuser_manager.filter(email=current_user.get("email"))
117	                .prefetch_related("subscription")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/configure.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	        # Request from Desktop, Emacs, Obsidian clients
127	        if len(request.headers.get("Authorization", "").split("Bearer ")) == 2:
128	            # Get bearer token from header

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/configure.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	        # Request from Whatsapp client
144	        client_id = request.query_params.get("client_id")
145	        if client_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/configure.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
158	            # Get the identifier used for the user
159	            phone_number = request.query_params.get("phone_number")
160	            if is_none_or_empty(phone_number):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/configure.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	
166	            create_if_not_exists = request.query_params.get("create_if_not_exists")
167	            if create_if_not_exists:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/configure.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	    app.add_middleware(NextJsMiddleware)
331	    app.add_middleware(SessionMiddleware, secret_key=os.environ.get("KHOJ_DJANGO_SECRET_KEY", "!secret"))
332	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/configure.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
376	                    log[field] = str(log[field])
377	        response = requests.post(constants.telemetry_server, json=state.telemetry)
378	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/database/adapters/__init__.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
553	    DEFAULT_AGENT_NAME = "Khoj"
554	    DEFAULT_AGENT_AVATAR = "https://assets.khoj.dev/lamp-128.png"
555	    DEFAULT_AGENT_SLUG = "khoj"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
33	                    print("Decode the base64 encoded PNG image")
34	                    decoded_image = base64.b64decode(chat["message"])
35	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
33	                    print("Decode the base64 encoded PNG image")
34	                    decoded_image = base64.b64decode(chat["message"])
35	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
44	                        webp_image_bytes = webp_image_io.getvalue()
45	                        chat["message"] = base64.b64encode(webp_image_bytes).decode()
46	                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE_V3.value

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
44	                        webp_image_bytes = webp_image_io.getvalue()
45	                        chat["message"] = base64.b64encode(webp_image_bytes).decode()
46	                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE_V3.value

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
57	                    print("Decode the base64 encoded WebP image")
58	                    decoded_image = base64.b64decode(chat["message"])
59	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
57	                    print("Decode the base64 encoded WebP image")
58	                    decoded_image = base64.b64decode(chat["message"])
59	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
68	                        webp_image_bytes = webp_image_io.getvalue()
69	                        chat["message"] = base64.b64encode(webp_image_bytes).decode()
70	                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE.value

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/database/management/commands/convert_images_png_to_webp.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
68	                        webp_image_bytes = webp_image_io.getvalue()
69	                        chat["message"] = base64.b64encode(webp_image_bytes).decode()
70	                        chat["intent"]["type"] = ImageIntentType.TEXT_TO_IMAGE.value

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/main.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	    "capacitor://localhost",  # To allow access from Obsidian iOS app using Capacitor.JS
75	    "http://localhost",  # To allow access from Obsidian Android app
76	    "http://localhost:*",  # To allow access from localhost
77	    "http://127.0.0.1:*",  # To allow access from localhost
78	    "app://khoj.dev",  # To allow access from Khoj desktop app
79	]
80	
81	app.add_middleware(
82	    CORSMiddleware,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/main.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    "http://localhost",  # To allow access from Obsidian Android app
76	    "http://localhost:*",  # To allow access from localhost
77	    "http://127.0.0.1:*",  # To allow access from localhost
78	    "app://khoj.dev",  # To allow access from Khoj desktop app
79	]
80	
81	app.add_middleware(
82	    CORSMiddleware,
83	    allow_origins=default_origins + custom_origins,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/main.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	    "http://localhost:*",  # To allow access from localhost
77	    "http://127.0.0.1:*",  # To allow access from localhost
78	    "app://khoj.dev",  # To allow access from Khoj desktop app
79	]
80	
81	app.add_middleware(
82	    CORSMiddleware,
83	    allow_origins=default_origins + custom_origins,
84	    allow_credentials=True,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/docx/docx_to_entries.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
64	                    bytes_content = docx_files[docx_file]
65	                    f.write(bytes_content)
66	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	    def wait_for_rate_limit_reset(response, func, *args, **kwargs):
43	        if response.status_code != 200 and response.headers.get("X-RateLimit-Remaining") == "0":
44	            wait_time = int(response.headers.get("X-RateLimit-Reset")) - int(time.time())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	        if response.status_code != 200 and response.headers.get("X-RateLimit-Remaining") == "0":
44	            wait_time = int(response.headers.get("X-RateLimit-Reset")) - int(time.time())
45	            logger.info(f"Github Rate limit reached. Waiting for {wait_time} seconds")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	    def process_repo(self, repo: GithubRepoConfig):
62	        repo_url = f"https://api.github.com/repos/{repo.owner}/{repo.name}"
63	        repo_shorthand = f"{repo.owner}/{repo.name}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	        params = {"recursive": "true"}
119	        response = requests.get(repo_content_url, headers=headers, params=params)
120	        contents = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	        # Raise exception if hit rate limit
123	        if response.status_code != 200 and response.headers.get("X-RateLimit-Remaining") == "0":
124	            raise ConnectionAbortedError("Github rate limit reached")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	                # Create URL for each markdown file on Github
137	                url_path = f'https://github.com/{repo.owner}/{repo.name}/blob/{repo.branch}/{item["path"]}'
138	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	                # Create URL for each org file on Github
145	                url_path = f'https://github.com/{repo.owner}/{repo.name}/blob/{repo.branch}/{item["path"]}'
146	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
151	            elif item["type"] == "blob":
152	                url_path = f'https://github.com/{repo.owner}/{repo.name}/blob/{repo.branch}/{item["path"]}'
153	                content_bytes = self.get_file_contents(item["url"], decode=False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	        headers = {"Accept": "application/vnd.github.v3.raw"}
175	        response = self.session.get(file_url, headers=headers, stream=True)
176	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/github/github_to_entries.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	        # Stop indexing on hitting rate limit
178	        if response.status_code != 200 and response.headers.get("X-RateLimit-Remaining") == "0":
179	            raise ConnectionAbortedError("Github rate limit reached")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/images/image_to_entries.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
71	                    bytes = image_files[image_file]
72	                    f.write(bytes)
73	                try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
88	            while True:
89	                result = self.session.post(
90	                    "https://api.notion.com/v1/search",
91	                    json=self.body_params,
92	                ).json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	                result = self.session.post(
90	                    "https://api.notion.com/v1/search",
91	                    json=self.body_params,
92	                ).json()
93	                responses.append(result)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	                responses.append(result)
94	                if result.get("has_more", False) == False:
95	                    break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	            with timer("Processing response", logger=logger):
101	                pages_or_databases = response.get("results", [])
102	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	        curr_heading = ""
126	        for block in content.get("results", []):
127	            block_type = block.get("type")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	        for block in content.get("results", []):
127	            block_type = block.get("type")
128	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	
133	            if block_data.get("rich_text") == None or len(block_data["rich_text"]) == 0:
134	                # There's no text to handle here.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	
158	            if block.get("has_children", True):
159	                raw_content += "\n"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	    def process_nested_children(self, children, raw_content, block_type=None):
179	        results = children.get("results", [])
180	        for child in results:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	        for child in results:
181	            child_type = child.get("type")
182	            if child_type == None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	            child_data = child[child_type]
185	            if child_data.get("rich_text") and len(child_data["rich_text"]) > 0:
186	                for text in child_data["rich_text"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	                    raw_content += self.process_text(text, block_type)
188	            if child_data.get("has_children", True):
189	                return self.process_nested_children(self.get_block_children(child["id"]), raw_content, block_type)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
193	    def process_text(self, text, block_type=None):
194	        text_type = text.get("type", None)
195	        if text_type in self.unsupported_block_types:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
196	            return ""
197	        if text.get("href", None):
198	            return f"<a href='{text['href']}'>{text['plain_text']}</a>"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	        try:
206	            return self.session.get(f"https://api.notion.com/v1/blocks/{block_id}/children").json()
207	        except Exception as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	        try:
206	            return self.session.get(f"https://api.notion.com/v1/blocks/{block_id}/children").json()
207	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
211	    def get_page(self, page_id):
212	        return self.session.get(f"https://api.notion.com/v1/pages/{page_id}").json()
213	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
211	    def get_page(self, page_id):
212	        return self.session.get(f"https://api.notion.com/v1/pages/{page_id}").json()
213	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	    def get_page_children(self, page_id):
215	        return self.session.get(f"https://api.notion.com/v1/blocks/{page_id}/children").json()
216	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
214	    def get_page_children(self, page_id):
215	        return self.session.get(f"https://api.notion.com/v1/blocks/{page_id}/children").json()
216	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/notion/notion_to_entries.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	            return None, None
224	        properties = page.get("properties", {})
225	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/content/pdf/pdf_to_entries.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	                    bytes = pdf_files[pdf_file]
68	                    f.write(bytes)
69	                try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	personality = PromptTemplate.from_template(
6	    """
7	You are Khoj, a smart, inquisitive and helpful personal assistant.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	no_entries_found = PromptTemplate.from_template(
69	    """
70	    It looks like you haven't added any notes yet. No worries, you can fix that by downloading the Khoj app from <a href=https://khoj.dev/downloads>here</a>.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	system_prompt_offline_chat = PromptTemplate.from_template(
77	    """
78	You are Khoj, a smart, inquisitive and helpful personal assistant.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	custom_system_prompt_offline_chat = PromptTemplate.from_template(
91	    """
92	You are {name}, a personal agent on Khoj.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
464	pick_relevant_information_collection_tools = PromptTemplate.from_template(
465	    """
466	You are Khoj, an extremely smart and helpful search assistant.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
534	infer_webpages_to_read = PromptTemplate.from_template(
535	    """
536	You are Khoj, an advanced web page reading assistant. You are to construct **up to three, valid** webpage urls to read before answering the user's question.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/conversation/prompts.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
740	to_notify_or_not = PromptTemplate.from_template(
741	    """
742	You are Khoj, an extremely smart and discerning notification assistant.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/embeddings.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
62	        try:
63	            response = requests.post(self.inference_endpoint, json=payload, headers=headers)
64	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/embeddings.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
113	            headers = {"Authorization": f"Bearer {self.api_key}", "Content-Type": "application/json"}
114	            response = requests.post(target_url, json=payload, headers=headers)
115	            return response.json()["scores"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/speech/text_to_speech.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	VOICE_ID = "RPEIZnKMqlQiZyZd1Dae"  # ID of the voice model to use. MALE - Christopher - friendly guy next door.
12	ELEVEN_API_URL = "https://api.elevenlabs.io/v1/text-to-speech"  # Base URL for the Text-to-Speech API
13	
14	markdown_renderer = MarkdownIt()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/speech/text_to_speech.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
45	    # Make the POST request to the TTS API with headers and data, enabling streaming response
46	    response = requests.post(tts_url, headers=headers, json=data, stream=True)
47	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	SERPER_DEV_API_KEY = os.getenv("SERPER_DEV_API_KEY")
26	SERPER_DEV_URL = "https://google.serper.dev/search"
27	
28	JINA_READER_API_URL = "https://r.jina.ai/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	
28	JINA_READER_API_URL = "https://r.jina.ai/"
29	JINA_SEARCH_API_URL = "https://s.jina.ai/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	JINA_READER_API_URL = "https://r.jina.ai/"
29	JINA_SEARCH_API_URL = "https://s.jina.ai/"
30	JINA_API_KEY = os.getenv("JINA_API_KEY")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/processor/tools/online_search.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	OLOSTEP_API_KEY = os.getenv("OLOSTEP_API_KEY")
33	OLOSTEP_API_URL = "https://agent.olostep.com/olostep-p2p-incomingAPI"
34	OLOSTEP_QUERY_PARAMS = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	
66	@api.get("/search", response_model=List[SearchResponse])
67	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
140	
141	    with concurrent.futures.ThreadPoolExecutor() as executor:
142	        if t in [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
194	    if not state.config:
195	        error_msg = f"ðŸš¨ Khoj is not configured.\nConfigure it via http://localhost:42110/settings, plugins or by editing {state.config_file}."
196	        logger.warning(error_msg)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	
185	@api.get("/update")
186	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
245	        # Store the audio from the request in a temporary file
246	        audio_data = await file.read()
247	        with open(audio_filename, "wb") as audio_file_writer:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
247	        with open(audio_filename, "wb") as audio_file_writer:
248	            audio_file_writer.write(audio_data)
249	        audio_file = open(audio_filename, "rb")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
220	
221	@api.post("/transcribe")
222	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
281	
282	@api.get("/settings", response_class=Response)
283	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
448	
449	@api.get("/health", response_class=Response)
450	@requires(["authenticated"], status_code=200)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
455	
456	@api.get("/v1/user", response_class=Response)
457	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
477	
478	@api.get("/automations", response_class=Response)
479	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
503	
504	@api.post("/automation", response_class=Response)
505	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
596	    # Run the function in a separate thread
597	    thread = threading.Thread(target=scheduled_chat_func, args=automation.args, kwargs=automation.kwargs)
598	    thread.start()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
577	
578	@api.post("/trigger/automation", response_class=Response)
579	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
657	    automation_metadata["crontime"] = crontime
658	    conversation_id = automation_metadata.get("conversation_id")
659	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_agents.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	
19	@api_agents.get("", response_class=Response)
20	async def all_agents(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	
73	@api_chat.get("/conversation/file-filters/{conversation_id}", response_class=Response)
74	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
99	
100	@api_chat.post("/conversation/file-filters/bulk", response_class=Response)
101	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
112	
113	@api_chat.post("/conversation/file-filters", response_class=Response)
114	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
140	
141	@api_chat.post("/feedback")
142	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
147	
148	@api_chat.post("/speech")
149	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	
172	@api_chat.get("/starters", response_class=Response)
173	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	        # Get latest N messages if N > 0
228	        if n > 0 and meta_log.get("chat"):
229	            meta_log["chat"] = meta_log["chat"][-n:]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
230	        # Else return all messages except latest N
231	        elif n < 0 and meta_log.get("chat"):
232	            meta_log["chat"] = meta_log["chat"][:n]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	
183	@api_chat.get("/history")
184	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
289	        # Get latest N messages if N > 0
290	        if n > 0 and meta_log.get("chat"):
291	            meta_log["chat"] = meta_log["chat"][-n:]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
292	        # Else return all messages except latest N
293	        elif n < 0 and meta_log.get("chat"):
294	            meta_log["chat"] = meta_log["chat"][:n]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
243	
244	@api_chat.get("/share/history")
245	def get_shared_chat(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
327	
328	@api_chat.post("/share/fork")
329	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
376	    user = request.user.object
377	    domain = request.headers.get("host")
378	    scheme = request.url.scheme

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
368	
369	@api_chat.post("/share")
370	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
401	
402	@api_chat.get("/sessions")
403	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
441	
442	@api_chat.post("/sessions")
443	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
470	
471	@api_chat.get("/options", response_class=Response)
472	async def chat_options(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
603	                client=request.user.client_app,
604	                user_agent=request.headers.get("user-agent"),
605	                host=request.headers.get("host"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
604	                user_agent=request.headers.get("user-agent"),
605	                host=request.headers.get("host"),
606	                metadata=chat_metadata,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
780	        if not is_none_or_empty(compiled_references):
781	            headings = "\n- " + "\n- ".join(set([c.get("compiled", c).split("\n")[0] for c in compiled_references]))
782	            # Strip only leading # from headings

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
831	                for query in direct_web_pages:
832	                    if online_results.get(query):
833	                        online_results[query]["webpages"] = direct_web_pages[query]["webpages"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_chat.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	
520	@api_chat.get("")
521	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_model.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	
18	@api_model.get("/chat/options", response_model=Dict[str, Union[str, int]])
19	def get_chat_model_options(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_model.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	
32	@api_model.get("/chat")
33	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_model.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
47	
48	@api_model.post("/chat", status_code=200)
49	@requires(["authenticated", "premium"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_model.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
72	
73	@api_model.post("/voice", status_code=200)
74	@requires(["authenticated", "premium"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_model.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
96	
97	@api_model.post("/search", status_code=200)
98	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/api_model.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
129	
130	@api_model.post("/paint", status_code=200)
131	@requires(["authenticated"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	        missing_requirements += ["Install the Khoj production package with `pip install khoj[prod]`"]
45	    if not os.environ.get("RESEND_API_KEY") and (
46	        not os.environ.get("GOOGLE_CLIENT_ID") or not os.environ.get("GOOGLE_CLIENT_SECRET")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	    if not os.environ.get("RESEND_API_KEY") and (
46	        not os.environ.get("GOOGLE_CLIENT_ID") or not os.environ.get("GOOGLE_CLIENT_SECRET")
47	    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	    if not os.environ.get("RESEND_API_KEY") and (
46	        not os.environ.get("GOOGLE_CLIENT_ID") or not os.environ.get("GOOGLE_CLIENT_SECRET")
47	    ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	
60	    CONF_URL = "https://accounts.google.com/.well-known/openid-configuration"
61	    oauth.register(name="google", server_metadata_url=CONF_URL, client_kwargs={"scope": "openid email profile"})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	
64	@auth_router.get("/login")
65	async def login_get(request: Request):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
69	
70	@auth_router.post("/login")
71	async def login(request: Request):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
75	
76	@auth_router.post("/magic")
77	async def login_magic_link(request: Request, form: MagicLinkForm):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	
92	@auth_router.get("/magic")
93	async def sign_in_with_magic_link(request: Request, code: str):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
104	
105	@auth_router.post("/token")
106	@requires(["authenticated"], redirect="login_page")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	
119	@auth_router.get("/token")
120	@requires(["authenticated"], redirect="login_page")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	
142	    credential = form.get("credential")
143	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	
144	    csrf_token_cookie = request.cookies.get("g_csrf_token")
145	    if not csrf_token_cookie:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	        return RedirectResponse(url=next_url)
148	    csrf_token_body = form.get("g_csrf_token")
149	    if not csrf_token_body:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
133	
134	@auth_router.post("/redirect")
135	async def auth(request: Request):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/auth.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	
178	@auth_router.get("/logout")
179	async def logout(request: Request):

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
110	
111	executor = ThreadPoolExecutor(max_workers=1)
112	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	    "Construct next url relative to current domain from request"
192	    next_url_param = urlparse(request.query_params.get("next", "/"))
193	    next_path = "/"  # default next path

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	    chat_history = ""
204	    for chat in conversation_history.get("chat", [])[-n:]:
205	        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	    for chat in conversation_history.get("chat", [])[-n:]:
205	        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:
206	            chat_history += f"User: {chat['intent']['query']}\n"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	            chat_history += f"{agent_name}: {chat['message']}\n"
208	        elif chat["by"] == "khoj" and ("text-to-image" in chat["intent"].get("type")):
209	            chat_history += f"User: {chat['intent']['query']}\n"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	            raise AssertionError(f"Invalid response for scheduling query : {response}")
440	        return response.get("crontime"), response.get("query"), response.get("subject")
441	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	            raise AssertionError(f"Invalid response for scheduling query : {response}")
440	        return response.get("crontime"), response.get("query"), response.get("subject")
441	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	            raise AssertionError(f"Invalid response for scheduling query : {response}")
440	        return response.get("crontime"), response.get("query"), response.get("subject")
441	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
522	        for result in online_results:
523	            if online_results[result].get("answerBox"):
524	                simplified_online_results[result] = online_results[result]["answerBox"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
524	                simplified_online_results[result] = online_results[result]["answerBox"]
525	            elif online_results[result].get("webpages"):
526	                simplified_online_results[result] = online_results[result]["webpages"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
825	    chat_history = ""
826	    for chat in conversation_log.get("chat", [])[-4:]:
827	        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:827
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
826	    for chat in conversation_log.get("chat", [])[-4:]:
827	        if chat["by"] == "khoj" and chat["intent"].get("type") in ["remember", "reminder"]:
828	            chat_history += f"Q: {chat['intent']['query']}\n"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
829	            chat_history += f"A: {chat['message']}\n"
830	        elif chat["by"] == "khoj" and "text-to-image" in chat["intent"].get("type"):
831	            chat_history += f"Q: Prompt: {chat['intent']['query']}\n"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
867	                image = response.data[0].b64_json
868	                decoded_image = base64.b64decode(image)
869	            except openai.OpenAIError or openai.BadRequestError or openai.APIConnectionError as e:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:868
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
867	                image = response.data[0].b64_json
868	                decoded_image = base64.b64decode(image)
869	            except openai.OpenAIError or openai.BadRequestError or openai.APIConnectionError as e:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
885	            try:
886	                response = requests.post(
887	                    f"https://api.stability.ai/v2beta/stable-image/generate/sd3",
888	                    headers={"authorization": f"Bearer {text_to_image_config.api_key}", "accept": "image/*"},
889	                    files={"none": ""},
890	                    data={
891	                        "prompt": improved_image_prompt,
892	                        "model": text2image_model,
893	                        "mode": "text-to-image",
894	                        "output_format": "png",
895	                        "aspect_ratio": "1:1",
896	                    },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
886	                response = requests.post(
887	                    f"https://api.stability.ai/v2beta/stable-image/generate/sd3",
888	                    headers={"authorization": f"Bearer {text_to_image_config.api_key}", "accept": "image/*"},

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:922
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
921	        intent_type = ImageIntentType.TEXT_TO_IMAGE_V3
922	        image = base64.b64encode(webp_image_bytes).decode("utf-8")
923	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:922
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
921	        intent_type = ImageIntentType.TEXT_TO_IMAGE_V3
922	        image = base64.b64encode(webp_image_bytes).decode("utf-8")
923	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
961	                status_code=429,
962	                detail="We're glad you're enjoying Khoj! You've exceeded your usage limit for today. Come back tomorrow or subscribe to increase your usage limit via [your settings](https://app.khoj.dev/settings).",
963	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1000	                status_code=429,
1001	                detail=f"We're glad you're enjoying Khoj! You've exceeded your `/{conversation_command.value}` command usage limit for today. Subscribe to increase your usage limit via [your settings](https://app.khoj.dev/settings).",
1002	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1157	    # Call the chat API endpoint with authenticated user token and query
1158	    raw_response = requests.get(url, headers=headers)
1159	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1167	    is_image = False
1168	    if raw_response.headers.get("Content-Type") == "application/json":
1169	        response_map = raw_response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1169	        response_map = raw_response.json()
1170	        ai_response = response_map.get("response") or response_map.get("image")
1171	        is_image = False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1169	        response_map = raw_response.json()
1170	        ai_response = response_map.get("response") or response_map.get("image")
1171	        is_image = False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1172	        if type(ai_response) == dict:
1173	            is_image = ai_response.get("image") is not None
1174	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1347	def get_user_config(user: KhojUser, request: Request, is_detailed: bool = False):
1348	    user_picture = request.session.get("user", {}).get("picture")
1349	    is_active = has_required_scope(request, ["premium"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1347	def get_user_config(user: KhojUser, request: Request, is_detailed: bool = False):
1348	    user_picture = request.session.get("user", {}).get("picture")
1349	    is_active = has_required_scope(request, ["premium"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1469	
1470	    no_documents = all([not files.get(file_type) for file_type in files])
1471	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1482	                OrgToEntries,
1483	                files.get("org"),
1484	                regenerate=regenerate,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1499	                MarkdownToEntries,
1500	                files.get("markdown"),
1501	                regenerate=regenerate,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1515	                PdfToEntries,
1516	                files.get("pdf"),
1517	                regenerate=regenerate,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1533	                PlaintextToEntries,
1534	                files.get("plaintext"),
1535	                regenerate=regenerate,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1591	                ImageToEntries,
1592	                files.get("image"),
1593	                regenerate=regenerate,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1603	                DocxToEntries,
1604	                files.get("docx"),
1605	                regenerate=regenerate,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/helpers.py:1622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1621	        return None
1622	    return f"https://api.notion.com/v1/oauth/authorize?client_id={NOTION_OAUTH_CLIENT_ID}&redirect_uri={NOTION_REDIRECT_URI}&response_type=code&state={user.uuid}"

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
22	
23	executor = ThreadPoolExecutor()
24	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	async def notion_auth_callback(request: Request, background_tasks: BackgroundTasks):
35	    code = request.query_params.get("code")
36	    state = request.query_params.get("state")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	    code = request.query_params.get("code")
36	    state = request.query_params.get("state")
37	    if not code or not state:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
47	    bearer_token = f"{NOTION_OAUTH_CLIENT_ID}:{NOTION_OAUTH_CLIENT_SECRET}"
48	    base64_encoded_token = base64.b64encode(bearer_token.encode()).decode()
49	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
47	    bearer_token = f"{NOTION_OAUTH_CLIENT_ID}:{NOTION_OAUTH_CLIENT_SECRET}"
48	    base64_encoded_token = base64.b64encode(bearer_token.encode()).decode()
49	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
61	
62	    response = requests.post("https://api.notion.com/v1/oauth/token", data=json.dumps(data), headers=headers)
63	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	
62	    response = requests.post("https://api.notion.com/v1/oauth/token", data=json.dumps(data), headers=headers)
63	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	
68	    access_token = final_response.get("access_token")
69	    await NotionConfig.objects.acreate(token=access_token, user=user)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	
71	    owner = final_response.get("owner")
72	    workspace_id = final_response.get("workspace_id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	    owner = final_response.get("owner")
72	    workspace_id = final_response.get("workspace_id")
73	    workspace_name = final_response.get("workspace_name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	    workspace_id = final_response.get("workspace_id")
73	    workspace_name = final_response.get("workspace_name")
74	    bot_id = final_response.get("bot_id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	    workspace_name = final_response.get("workspace_name")
74	    bot_id = final_response.get("bot_id")
75	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/routers/notion.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	
33	@notion_router.get("/auth/callback")
34	async def notion_auth_callback(request: Request, background_tasks: BackgroundTasks):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/cli.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
35	    parser.add_argument("--verbose", "-v", action="count", default=0, help="Show verbose conversion logs. Default: 0")
36	    parser.add_argument("--host", type=str, default="127.0.0.1", help="Host address of the server. Default: 127.0.0.1")
37	    parser.add_argument("--port", "-p", type=int, default=42110, help="Port of the server. Default: 42110")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/constants.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	app_env_filepath = "~/.khoj/env"
9	telemetry_server = "https://khoj.beta.haletic.com/v1/telemetry"
10	content_directory = "~/.khoj/content/"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/fs_syncer.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
103	            try:
104	                plaintext_content = f.read()
105	                if file.endswith(("html", "htm", "xml")):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/fs_syncer.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	            try:
151	                filename_to_content_map[file] = f.read()
152	            except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/fs_syncer.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
200	            try:
201	                filename_to_content_map[file] = f.read()
202	            except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/fs_syncer.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
245	            try:
246	                filename_to_content_map[file] = f.read()
247	            except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/helpers.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
224	            with open(app_env_filename, "a") as f:
225	                f.write("server_id=" + server_id + "\n")
226	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/helpers.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
234	        with open(app_env_filename, "w") as f:
235	            f.write("server_id=" + server_id + "\n")
236	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/helpers.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
255	
256	    if properties.get("server_id") is None:
257	        properties["server_id"] = get_server_id()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/helpers.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
262	        "server_version": version("khoj"),
263	        "os": platform.system(),
264	        "timestamp": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/helpers.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
262	        "server_version": version("khoj"),
263	        "os": platform.system(),
264	        "timestamp": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/helpers.py:263
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
262	        "server_version": version("khoj"),
263	        "os": platform.system(),
264	        "timestamp": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/khoj_assistant-1.21.1/khoj_assistant-1.21.1/src/khoj/utils/helpers.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
414	    try:
415	        response = requests.head("https://www.google.com")
416	        return response.status_code == 200

--------------------------------------------------

Code scanned:
	Total lines of code: 13492
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 46.0
		High: 150.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 188.0
		High: 8.0
Files skipped (0):
