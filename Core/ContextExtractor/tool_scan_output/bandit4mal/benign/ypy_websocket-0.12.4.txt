Run started:2025-04-12 12:56:12.711703

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/conftest.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
33	    try:
34	        async with websocket_server, serve(websocket_server.serve, "127.0.0.1", 1234):
35	            yield websocket_server

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_asgi.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
28	            ymap1.set(t, "key", "value")
29	        async with connect(
30	            f"ws://localhost:{unused_tcp_port}/my-roomname"
31	        ) as websocket1, WebsocketProvider(ydoc1, websocket1):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_asgi.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
35	        ydoc2 = Y.YDoc()
36	        async with connect(
37	            f"ws://localhost:{unused_tcp_port}/my-roomname"
38	        ) as websocket2, WebsocketProvider(ydoc2, websocket2):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ypy_yjs.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
45	    ytest = YTest(ydoc)
46	    async with connect("ws://127.0.0.1:1234/my-roomname") as websocket, WebsocketProvider(
47	        ydoc, websocket

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	    for d in data:
48	        await ystore.write(d)
49	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
47	    for d in data:
48	        await ystore.write(d)
49	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	    i = 0
55	    async for d, m, t in ystore.read():
56	        assert d == data[i]  # data

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	            mock_time.return_value = now
74	            await ystore.write(test_ydoc.update())
75	            async with aiosqlite.connect(ystore.db_path) as db:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
73	            mock_time.return_value = now
74	            await ystore.write(test_ydoc.update())
75	            async with aiosqlite.connect(ystore.db_path) as db:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
74	            await ystore.write(test_ydoc.update())
75	            async with aiosqlite.connect(ystore.db_path) as db:
76	                assert (await (await db.execute("SELECT count(*) FROM yupdates")).fetchone())[

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	        mock_time.return_value = now + ystore.document_ttl + 1
83	        await ystore.write(test_ydoc.update())
84	        async with aiosqlite.connect(ystore.db_path) as db:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
82	        mock_time.return_value = now + ystore.document_ttl + 1
83	        await ystore.write(test_ydoc.update())
84	        async with aiosqlite.connect(ystore.db_path) as db:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
83	        await ystore.write(test_ydoc.update())
84	        async with aiosqlite.connect(ystore.db_path) as db:
85	            # two updates in DB: one squashed update and the new update

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	    await ystore.start()
97	    await ystore.write(b"foo")
98	    YStore.version = prev_version

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/tests/test_ystore.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
96	    await ystore.start()
97	    await ystore.write(b"foo")
98	    YStore.version = prev_version

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/asgi_server.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
29	    async def __anext__(self) -> bytes:
30	        return await self.recv()
31	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/asgi_server.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
32	    async def send(self, message: bytes) -> None:
33	        await self._send(
34	            dict(
35	                type="websocket.send",
36	                bytes=message,
37	            )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/asgi_server.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
45	            if self._on_disconnect is not None:
46	                res = self._on_disconnect(message)
47	                if isawaitable(res):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/asgi_server.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
82	            if self._on_connect is not None:
83	                close = self._on_connect(msg, scope)
84	                if isawaitable(close):

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/asgi_server.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
88	
89	            await send({"type": "websocket.accept"})
90	            websocket = ASGIWebsocket(receive, send, scope["path"], self._on_disconnect)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/django_channels_consumer.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
185	        """
186	        await self.send(bytes_data=message_wrapper["message"])
187	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/django_channels_consumer.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
193	        """
194	        await self.channel_layer.group_send(
195	            self.room_name, {"type": "send_message", "message": message}
196	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/websocket_provider.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
108	                try:
109	                    await self._websocket.send(message)
110	                except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	        update = Y.encode_state_as_update(ydoc)  # type: ignore
121	        await self.write(update)
122	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
120	        update = Y.encode_state_as_update(ydoc)  # type: ignore
121	        await self.write(update)
122	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
128	        """
129	        async for update, *rest in self.read():  # type: ignore
130	            Y.apply_update(ydoc, update)  # type: ignore

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
169	            async with await anyio.open_file(self.path, "rb") as f:
170	                header = await f.read(8)
171	                if header == b"VERSION:":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
187	                version_bytes = f"VERSION:{self.version}\n".encode()
188	                await f.write(version_bytes)
189	                offset = len(version_bytes)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
187	                version_bytes = f"VERSION:{self.version}\n".encode()
188	                await f.write(version_bytes)
189	                offset = len(version_bytes)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
203	                await f.seek(offset)
204	                data = await f.read()
205	                if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
229	                data_len = write_var_uint(len(data))
230	                await f.write(data_len + data)
231	                metadata = await self.get_metadata()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
229	                data_len = write_var_uint(len(data))
230	                await f.write(data_len + data)
231	                metadata = await self.get_metadata()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
232	                metadata_len = write_var_uint(len(metadata))
233	                await f.write(metadata_len + metadata)
234	                timestamp = struct.pack("<d", time.time())

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
232	                metadata_len = write_var_uint(len(metadata))
233	                await f.write(metadata_len + metadata)
234	                timestamp = struct.pack("<d", time.time())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
235	                timestamp_len = write_var_uint(len(timestamp))
236	                await f.write(timestamp_len + timestamp)
237	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ypy_websocket-0.12.4/ypy_websocket-0.12.4/ypy_websocket/ystore.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
235	                timestamp_len = write_var_uint(len(timestamp))
236	                await f.write(timestamp_len + timestamp)
237	

--------------------------------------------------

Code scanned:
	Total lines of code: 1507
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 35.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 0.0
Files skipped (0):
