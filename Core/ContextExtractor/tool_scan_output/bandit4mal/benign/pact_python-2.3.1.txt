Run started:2025-04-12 12:05:57.345691

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	PACT_BIN_VERSION = os.getenv("PACT_BIN_VERSION", "2.4.1")
35	PACT_BIN_URL = "https://github.com/pact-foundation/pact-ruby-standalone/releases/download/v{version}/pact-{version}-{os}-{machine}.{ext}"
36	
37	# Latest version available at:
38	# https://github.com/pact-foundation/pact-reference/releases
39	PACT_LIB_VERSION = os.getenv("PACT_LIB_VERSION", "0.4.22")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	PACT_LIB_VERSION = os.getenv("PACT_LIB_VERSION", "0.4.22")
40	PACT_LIB_URL = "https://github.com/pact-foundation/pact-reference/releases/download/libpact_ffi-v{version}/{prefix}pact_ffi-{os}-{machine}.{ext}"
41	
42	
43	class UnsupportedPlatformError(RuntimeError):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
75	        for subdir in ["bin", "lib", "data"]:
76	            shutil.rmtree(PACT_ROOT_DIR / subdir, ignore_errors=True)
77	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
207	            if str(artifact).endswith(".tar.gz"):
208	                with tarfile.open(artifact) as f:
209	                    f.extractall(tmpdir)  # noqa: S202

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
212	                if (PACT_ROOT_DIR / d).is_dir():
213	                    shutil.rmtree(PACT_ROOT_DIR / d)
214	                shutil.copytree(

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
341	        with (
342	            gzip.open(artifact, "rb") as f_in,
343	            (self.tmpdir / (artifact.name.split("-")[0] + artifact.suffixes[0])).open(

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
342	            gzip.open(artifact, "rb") as f_in,
343	            (self.tmpdir / (artifact.name.split("-")[0] + artifact.suffixes[0])).open(
344	                "wb"
345	            ) as f_out,

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
370	        with (
371	            artifact.open("r", encoding="utf-8") as f_in,
372	            (self.tmpdir / "pact.h").open("w", encoding="utf-8") as f_out,

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
371	            artifact.open("r", encoding="utf-8") as f_in,
372	            (self.tmpdir / "pact.h").open("w", encoding="utf-8") as f_out,
373	        ):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
381	
382	                f_out.write(line)
383	        return includes

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
381	
382	                f_out.write(line)
383	        return includes

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
423	        ffibuilder = cffi.FFI()
424	        with (self.tmpdir / "pact.h").open(
425	            "r",
426	            encoding="utf-8",
427	        ) as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
427	        ) as f:
428	            ffibuilder.cdef(f.read())
429	        ffibuilder.set_source(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
455	        if not artifact.exists():
456	            response = requests.get(url, timeout=30)
457	            try:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
461	                raise RuntimeError(msg) from e
462	            with artifact.open("wb") as f:
463	                f.write(response.content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
462	            with artifact.open("wb") as f:
463	                f.write(response.content)
464	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/hatch_build.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
462	            with artifact.open("wb") as f:
463	                f.write(response.content)
464	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/__init__.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	
14	__url__ = "https://github.com/pact-foundation/pact-python"
15	__license__ = "MIT"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/cli/verify.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	    default=False,
120	    help='Allow pacts which are in pending state to be verified without causing the '
121	         'overall task to fail. For more information, see https://pact.io/pending',
122	    is_flag=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/cli/verify.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	    default=None,
126	    help='Automatically include the pending pacts in the verification step. '
127	         'For more information, see https://docs.pact.io/pact_broker/advanced_topics/wip_pacts/',)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/matchers.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
331	        """
332	        return Term(self.Regexes.ip_address.value, '127.0.0.1')
333	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/message_provider.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
67	
68	        resp = requests.post(f'{self._proxy_url()}/setup',
69	                             verify=False,
70	                             json={"messageHandlers": message_handlers})
71	        assert resp.status_code == 201, resp.text

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/message_provider.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	        s.mount(http_mount, HTTPAdapter(max_retries=retries))
85	        resp = s.get(f'{self._proxy_url()}/ping', verify=False)
86	        if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/message_provider.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
106	    def _start_proxy(self):
107	        self._process = Process(target=run_proxy, args=(), daemon=True)
108	        self._process.start()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/pact.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
284	        self._interactions = []
285	        resp = requests.get(
286	            self.uri + "/interactions/verification", headers=self.HEADERS, verify=False
287	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/pact.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
288	        assert resp.status_code == 200, resp.text
289	        resp = requests.post(self.uri + "/pact", headers=self.HEADERS, verify=False)
290	        assert resp.status_code == 200, resp.text

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/pact.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
362	
363	        resp = s.get(self.uri, headers=self.HEADERS, verify=False)
364	        if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/v3/_server.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
280	                "Pact-Message-Metadata",
281	                base64.b64encode(json.dumps(metadata).encode()).decode(),
282	            )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/v3/_server.py:281
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
280	                "Pact-Message-Metadata",
281	                base64.b64encode(json.dumps(metadata).encode()).decode(),
282	            )

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/v3/_util.py:158
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
157	    """
158	    with closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:
159	        s.bind(("", 0))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pact_python-2.3.1/pact_python-2.3.1/src/pact/verify_wrapper.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	        else:
73	            sys.stdout.write(line)
74	

--------------------------------------------------

Code scanned:
	Total lines of code: 14251
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 2.0
Files skipped (0):
