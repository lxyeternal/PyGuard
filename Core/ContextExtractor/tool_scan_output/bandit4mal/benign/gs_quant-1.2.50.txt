Run started:2025-04-12 13:26:49.148422

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/analytics/datagrid/datagrid.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
271	        domain = GsSession.current.domain.replace(".web", "")
272	        if domain == 'https://api.gs.com':
273	            domain = 'https://marquee.gs.com'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/analytics/datagrid/datagrid.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
272	        if domain == 'https://api.gs.com':
273	            domain = 'https://marquee.gs.com'
274	        url = f'{domain}/s/markets/grids/{self.id_}'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/analytics/workspaces/workspace.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
357	        domain = GsSession.current.domain.replace(".web", "")
358	        if domain == 'https://api.gs.com':
359	            domain = 'https://marquee.gs.com'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/analytics/workspaces/workspace.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
358	        if domain == 'https://api.gs.com':
359	            domain = 'https://marquee.gs.com'
360	        url = f'{domain}/s/markets/{self.__alias or self.__id}'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/fred/data.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    latest_realtime_end = '9999-12-31'
46	    root_url = 'https://api.stlouisfed.org/fred/series/observations'
47	
48	    def __init__(self, api_key=None):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/fred/data.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	        else:
52	            raise ValueError(textwrap.dedent("""
53	                    Please pass a string with your API key. You can sign up for a free api key on the Fred website at

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	    def wrapper(cls, *args, **kwargs):
94	        if os.environ.get(ENABLE_ASSET_CACHING):
95	            _logger.debug("Asset caching is enabled")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	                with _fn_cache_lock:
101	                    result = asset_cache.cache.get(GsSession.current, k)
102	            if result:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	    async def wrapper(cls, *args, **kwargs):
126	        if os.environ.get(ENABLE_ASSET_CACHING):
127	            _logger.debug("Asset caching is enabled")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	                with _fn_cache_lock:
133	                    result = asset_cache.cache.get(GsSession.current, k)
134	            if result:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
229	        query = cls.__create_query(fields, as_of, limit, order_by=order_by, **kwargs)
230	        response = GsSession.current._post('/assets/query', payload=query, cls=return_type)
231	        return response['results']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
260	        query = cls.__create_query(fields, as_of, limit, scroll, order_by=order_by, **kwargs)
261	        response = GsSession.current._post('/assets/query', payload=query, cls=return_type)
262	        results = get(response, 'results')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	        response = GsSession.current._post('/assets/query', payload=query, cls=return_type)
262	        results = get(response, 'results')
263	        while (has(response, 'scrollId') and len(get(response, 'results'))):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	        results = get(response, 'results')
263	        while (has(response, 'scrollId') and len(get(response, 'results'))):
264	            query = cls.__create_query(fields, as_of, limit, scroll, get(response, 'scrollId'), **kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	        while (has(response, 'scrollId') and len(get(response, 'results'))):
264	            query = cls.__create_query(fields, as_of, limit, scroll, get(response, 'scrollId'), **kwargs)
265	            response = GsSession.current._post('/assets/query', payload=query, cls=return_type)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
264	            query = cls.__create_query(fields, as_of, limit, scroll, get(response, 'scrollId'), **kwargs)
265	            response = GsSession.current._post('/assets/query', payload=query, cls=return_type)
266	            results += get(response, 'results')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	            response = GsSession.current._post('/assets/query', payload=query, cls=return_type)
266	            results += get(response, 'results')
267	        return results

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
278	        query = cls.__create_query(fields, as_of, limit, **kwargs)
279	        response = GsSession.current._post('/assets/data/query', payload=query)
280	        return response['results']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
292	        query = cls.__create_query(fields, as_of, limit, scroll, **kwargs)
293	        response = GsSession.current._post('/assets/data/query', payload=query)
294	        results = get(response, 'results')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
293	        response = GsSession.current._post('/assets/data/query', payload=query)
294	        results = get(response, 'results')
295	        while (has(response, 'scrollId') and len(get(response, 'results'))):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	        results = get(response, 'results')
295	        while (has(response, 'scrollId') and len(get(response, 'results'))):
296	            query = cls.__create_query(fields, as_of, limit, scroll, get(response, 'scrollId'), **kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
295	        while (has(response, 'scrollId') and len(get(response, 'results'))):
296	            query = cls.__create_query(fields, as_of, limit, scroll, get(response, 'scrollId'), **kwargs)
297	            response = GsSession.current._post('/assets/data/query', payload=query)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
296	            query = cls.__create_query(fields, as_of, limit, scroll, get(response, 'scrollId'), **kwargs)
297	            response = GsSession.current._post('/assets/data/query', payload=query)
298	            results += get(response, 'results')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
297	            response = GsSession.current._post('/assets/data/query', payload=query)
298	            results += get(response, 'results')
299	        return results

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
318	        query = dict(where=where, limit=limit, fields=fields, asOfTime=as_of.strftime("%Y-%m-%dT%H:%M:%SZ"))
319	        return GsSession.current._post('/positions/resolver', payload=query)
320	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
332	
333	        return GsSession.current._post('/assets/xrefs/query', payload=query).get('results')
334	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
332	
333	        return GsSession.current._post('/assets/xrefs/query', payload=query).get('results')
334	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
340	    ) -> Tuple[GsTemporalXRef, ...]:
341	        response = GsSession.current._get('/assets/{id}/xrefs'.format(id=asset_id))
342	        return tuple(GsTemporalXRef.from_dict(x) for x in response.get('xrefs', ()))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
341	        response = GsSession.current._get('/assets/{id}/xrefs'.format(id=asset_id))
342	        return tuple(GsTemporalXRef.from_dict(x) for x in response.get('xrefs', ()))
343	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
353	    ) -> GsAsset:
354	        return GsSession.current._get('/assets/{id}'.format(id=asset_id), cls=GsAsset)
355	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
365	    def get_asset_by_name(cls, name: str) -> GsAsset:
366	        ret = GsSession.current._get('/assets?name={}'.format(name))
367	        num_found = ret.get('totalResults', 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
366	        ret = GsSession.current._get('/assets?name={}'.format(name))
367	        num_found = ret.get('totalResults', 0)
368	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
377	    def create_asset(cls, asset: GsAsset) -> GsAsset:
378	        return GsSession.current._post('/assets', payload=asset, cls=GsAsset)
379	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
385	    def get_position_dates(asset_id: str) -> Tuple[dt.date, ...]:
386	        position_dates = GsSession.current._get(f'/assets/{asset_id}/positions/dates')['results']
387	        return tuple(dt.datetime.strptime(d, '%Y-%m-%d').date() for d in position_dates)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
400	
401	        results = GsSession.current._get(url)['results']
402	        return tuple(PositionSet.from_dict(r) for r in results)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
421	                try:
422	                    position_sets += GsSession.current._get(url)['positionSets']
423	                    start_date_str = (date.date() + dt.timedelta(days=1)).isoformat()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
429	            try:
430	                position_sets += GsSession.current._get(url)['positionSets']
431	            except HTTPError as err:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
441	
442	        results = GsSession.current._get(url)['results']
443	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
452	
453	        results = GsSession.current._post('/assets', asset)
454	        return results['id']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
459	    ) -> Tuple[Optional[Union[Instrument, Security]]]:
460	        instrument_infos = GsSession.current._post('/assets/instruments', asset_ids, cls=AssetToInstrumentResponse)
461	        instrument_lookup = {i.assetId: i.instrument for i in instrument_infos if i}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
461	        instrument_lookup = {i.assetId: i.instrument for i in instrument_infos if i}
462	        ret: Tuple[Optional[Union[Instrument, Security]], ...] = tuple(instrument_lookup.get(a) for a in asset_ids)
463	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
470	        asset_ids = tuple(filter(None, (p.asset_id for p in positions)))
471	        instrument_infos = GsSession.current._post('/assets/instruments', asset_ids, cls=AssetToInstrumentResponse) \
472	            if asset_ids else {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
482	            else:
483	                instrument_info = instrument_lookup.get(position.assetId)
484	                if instrument_info:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
512	
513	        results = GsSession.current._get(url)['results']
514	        return results

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
526	    def get_reports(cls, asset_id: str) -> Tuple[Report, ...]:
527	        return GsSession.current._get(f'/assets/{asset_id}/reports', cls=Report)['results']
528	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
555	        query = cls.__create_query((input_type, output_type), as_of, limit, **the_args)
556	        results = GsSession.current._post('/assets/data/query', payload=query)
557	        if len(results) >= query.limit:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
564	        for entry in results:
565	            key = entry.get(input_type)
566	            value = entry.get(output_type)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/assets.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
565	            key = entry.get(input_type)
566	            value = entry.get(output_type)
567	            if multimap:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/content.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
108	        """
109	        return [(content.id, b64decode(content.content.body)) for content in contents]
110	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/content.py:109
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
108	        """
109	        return [(content.id, b64decode(content.content.body)) for content in contents]
110	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/risk.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
158	                    _logger.info(f'Re-subscribing {len(pending_requests)} requests')
159	                    await asyncio.wait_for(ws.send(json.dumps(list(pending_requests.keys()))), timeout=send_timeout)
160	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/risk.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
165	                        if not all_requests_dispatched else None
166	                    result_listener = asyncio.ensure_future(ws.recv())
167	                    listeners = tuple(filter(None, (request_listener, result_listener)))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/risk.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
207	                            try:
208	                                result = msgpack.unpackb(base64.b64decode(result_str), raw=False) \
209	                                    if cls.USE_MSGPACK else json.loads(result_str)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/risk.py:208
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
207	                            try:
208	                                result = msgpack.unpackb(base64.b64decode(result_str), raw=False) \
209	                                    if cls.USE_MSGPACK else json.loads(result_str)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/gs/risk.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
243	                                # ... add to our result subscription ...
244	                                await asyncio.wait_for(ws.send(json.dumps(request_ids)), timeout=send_timeout)
245	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	            proxies = gs_quant_auth.__proxies__
40	            response = requests.get(url, params=params, proxies=proxies)
41	        except ModuleNotFoundError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    else:
44	        response = requests.get(url, params=params)
45	    return response

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/utils.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
52	    def initialize(cls, max_workers: int):
53	        cls.__executor = ThreadPoolExecutor(max_workers=max_workers)
54	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/api/utils.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
57	        if not cls.__executor:
58	            cls.__executor = ThreadPoolExecutor()
59	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/data/utilities.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
164	        print(f"{len(coverage)} symbols, will run in {math.ceil(len(coverage) / batch_size)} batches")
165	        with ThreadPoolExecutor(max_workers=parallel_factor) as e:
166	            try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/markets/baskets.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
538	        env = '-qa' if 'qa' in get(GsSession, 'current.domain', '') else env
539	        return f'https://marquee{env}.gs.com/s/products/{self.id}/summary'
540	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/markets/core.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
356	                          (len(requests_for_provider) > 1 or len(next(iter(requests_for_provider.values()))) > 1)
357	            request_pool = ThreadPoolExecutor(len(requests_for_provider)) \
358	                if len(requests_for_provider) > 1 or self.__is_async else None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/markets/securities.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
286	        env = '-qa' if 'qa' in get(GsSession, 'current.domain', '') else env
287	        return f'https://marquee{env}.gs.com/s/products/{self.get_marquee_id()}/summary'
288	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
292	            if tracing_scope:
293	                tracing_scope.span.set_tag('request.content.type', headers.get('Content-Type'))
294	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	
295	            use_msgpack = headers.get('Content-Type') == 'application/x-msgpack'
296	            if use_msgpack:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
296	            if use_msgpack:
297	                headers['Accept'] = headers.get('Content-Type')
298	            kwargs['headers'] = headers

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
311	            reason = response.reason if hasattr(response, 'reason') else response.reason_phrase
312	            err_msg = reason if response.headers.get('Content-Type') == 'text/html' else f'{reason}: {response.text}'
313	            raise error_builder(response.status_code, err_msg, context=f'{request_id}: {method} {url}')

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
352	                                                scope)
353	            response = self._session.request(method, url, **kwargs)
354	            request_id = response.headers.get('x-dash-requestid')

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
352	                                                scope)
353	            response = self._session.request(method, url, **kwargs)
354	            request_id = response.headers.get('x-dash-requestid')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
353	            response = self._session.request(method, url, **kwargs)
354	            request_id = response.headers.get('x-dash-requestid')
355	            logger.debug('Handling response for [Request ID]: %s [Method]: %s [URL]: %s', request_id, method, url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
360	                scope.span.set_tag('dash.request.id', request_id)
361	                scope.span.set_tag('response.content.type', response.headers.get('Content-Type'))
362	        if response.status_code == 401:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
366	            self._authenticate()
367	            return self.__request(method, path, payload=payload, request_headers=request_headers, cls=cls,
368	                                  try_auth=False, include_version=include_version, timeout=timeout,
369	                                  return_request_id=return_request_id, use_body=use_body, domain=domain)
370	        return self._parse_response(request_id, response, method, url, cls, return_request_id)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
366	            self._authenticate()
367	            return self.__request(method, path, payload=payload, request_headers=request_headers, cls=cls,
368	                                  try_auth=False, include_version=include_version, timeout=timeout,
369	                                  return_request_id=return_request_id, use_body=use_body, domain=domain)
370	        return self._parse_response(request_id, response, method, url, cls, return_request_id)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
392	                                                "content", scope)
393	            response = await self._session_async.request(method, url, **kwargs)
394	            request_id = response.headers.get('x-dash-requestid')

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
392	                                                "content", scope)
393	            response = await self._session_async.request(method, url, **kwargs)
394	            request_id = response.headers.get('x-dash-requestid')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
393	            response = await self._session_async.request(method, url, **kwargs)
394	            request_id = response.headers.get('x-dash-requestid')
395	            if scope:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
414	             domain: Optional[str] = None) -> Union[Base, tuple, dict]:
415	        return self.__request('GET', path, payload=payload, request_headers=request_headers, cls=cls,
416	                              include_version=include_version, timeout=timeout, return_request_id=return_request_id,
417	                              domain=domain)
418	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
414	             domain: Optional[str] = None) -> Union[Base, tuple, dict]:
415	        return self.__request('GET', path, payload=payload, request_headers=request_headers, cls=cls,
416	                              include_version=include_version, timeout=timeout, return_request_id=return_request_id,
417	                              domain=domain)
418	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
432	              return_request_id: Optional[bool] = False, domain: Optional[str] = None) -> Union[Base, tuple, dict]:
433	        return self.__request('POST', path, payload=payload, request_headers=request_headers, cls=cls,
434	                              include_version=include_version, timeout=timeout, return_request_id=return_request_id,
435	                              domain=domain)
436	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
432	              return_request_id: Optional[bool] = False, domain: Optional[str] = None) -> Union[Base, tuple, dict]:
433	        return self.__request('POST', path, payload=payload, request_headers=request_headers, cls=cls,
434	                              include_version=include_version, timeout=timeout, return_request_id=return_request_id,
435	                              domain=domain)
436	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
451	            -> Union[Base, tuple, dict]:
452	        return self.__request('DELETE', path, payload=payload, request_headers=request_headers, cls=cls,
453	                              include_version=include_version, timeout=timeout, return_request_id=return_request_id,
454	                              use_body=use_body)
455	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
451	            -> Union[Base, tuple, dict]:
452	        return self.__request('DELETE', path, payload=payload, request_headers=request_headers, cls=cls,
453	                              include_version=include_version, timeout=timeout, return_request_id=return_request_id,
454	                              use_body=use_body)
455	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
469	            -> Union[Base, tuple, dict]:
470	        return self.__request('PUT', path, payload=payload, request_headers=request_headers, cls=cls,
471	                              include_version=include_version, timeout=timeout, return_request_id=return_request_id)
472	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
469	            -> Union[Base, tuple, dict]:
470	        return self.__request('PUT', path, payload=payload, request_headers=request_headers, cls=cls,
471	                              include_version=include_version, timeout=timeout, return_request_id=return_request_id)
472	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
497	            }
498	        return websockets.connect(url,
499	                                  max_size=2 ** 32,
500	                                  ssl=CustomHttpAdapter.ssl_context() if url.startswith('wss') else None,
501	                                  **ws_library_headers,
502	                                  **kwargs)
503	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
525	            cls.__config = ConfigParser()
526	            cls.__config.read(os.path.join(os.path.dirname(inspect.getfile(cls)), 'config.ini'))
527	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
525	            cls.__config = ConfigParser()
526	            cls.__config.read(os.path.join(os.path.dirname(inspect.getfile(cls)), 'config.ini'))
527	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
547	        domain = Domain.MDS_US_EAST if use_mds else domain
548	        session = cls.get(
549	            environment_or_domain,
550	            client_id=client_id,
551	            client_secret=client_secret,
552	            scopes=scopes,
553	            api_version=api_version,
554	            application=application,
555	            http_adapter=http_adapter,
556	            domain=domain
557	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
566	        try:
567	            self._session.post(f'{self.domain}/{self.api_version}/activities',
568	                               verify=self.verify,
569	                               headers={'Content-Type': 'application/json; charset=utf-8'},
570	                               data=json.dumps({'action': 'Initiated', 'kpis': [{'id': 'gsqInitiated', 'value': 1}],
571	                                                'resource': 'GSQuant',
572	                                                'parameters': params}))
573	        except Exception:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
662	        }
663	        reply = self._session.post(self.auth_url, data=auth_data, verify=self.verify)
664	        if reply.status_code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
680	            cls.__config = ConfigParser()
681	            cls.__config.read(os.path.join(os.path.dirname(inspect.getfile(cls)), 'config.ini'))
682	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/session.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
680	            cls.__config = ConfigParser()
681	            cls.__config.read(os.path.join(os.path.dirname(inspect.getfile(cls)), 'config.ini'))
682	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/api/test_content.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
111	    # Assert
112	    assert actual == [(content.id, b64decode(content.content.body)) for content in contents]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/api/test_content.py:112
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
111	    # Assert
112	    assert actual == [(content.id, b64decode(content.content.body)) for content in contents]

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/fixtures/content.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
55	        'content': {
56	            'body': b64encode(b'Hello world!'),
57	            'mimeType': 'text/plain',

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/fixtures/content.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
55	        'content': {
56	            'body': b64encode(b'Hello world!'),
57	            'mimeType': 'text/plain',

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:1939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1938	    cds_asset = DefaultSwap('MAD6V3NP8ZB7HZTY', 'Lockheed_C_PFA_2y_USD')
1939	    actual = tm.cds_spread(cds_asset, 100)
1940	    assert_series_equal(pd.Series([0.000836], index=_index2, name='spreadAt100'), pd.Series(actual))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:1941
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1940	    assert_series_equal(pd.Series([0.000836], index=_index2, name='spreadAt100'), pd.Series(actual))
1941	    actual = tm.cds_spread(cds_asset, 250)
1942	    assert_series_equal(pd.Series([0.000436], index=_index2, name='spreadAt250'), pd.Series(actual))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:1943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1942	    assert_series_equal(pd.Series([0.000436], index=_index2, name='spreadAt250'), pd.Series(actual))
1943	    actual = tm.cds_spread(cds_asset, 500)
1944	    assert_series_equal(pd.Series([0.00036], index=_index2, name='spreadAt500'), pd.Series(actual))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:1946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1945	    with pytest.raises(NotImplementedError):
1946	        tm.cds_spread(cds_asset, 200)
1947	    with pytest.raises(NotImplementedError):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:1948
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1947	    with pytest.raises(NotImplementedError):
1948	        tm.cds_spread(cds_asset, 200, real_time=True)
1949	    replace.restore()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2136	    with pytest.raises(NotImplementedError):
2137	        tm_rates.basis_swap_spread(**args)
2138	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2143	    with pytest.raises(NotImplementedError):
2144	        tm_rates.basis_swap_spread(..., '1y', real_time=True)
2145	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2147	    with pytest.raises(MqValueError):
2148	        tm_rates.basis_swap_spread(**args)
2149	    args['swap_tenor'] = '6y'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2152	    with pytest.raises(MqValueError):
2153	        tm_rates.basis_swap_spread(**args)
2154	    args['spread_tenor'] = '3m'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2157	    with pytest.raises(MqValueError):
2158	        tm_rates.basis_swap_spread(**args)
2159	    args['reference_tenor'] = '6m'

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2162	    with pytest.raises(MqValueError):
2163	        tm_rates.basis_swap_spread(**args)
2164	    args['forward_tenor'] = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2167	    with pytest.raises(MqValueError):
2168	        tm_rates.basis_swap_spread(**args)
2169	    args['spread_benchmark_type'] = BenchmarkType.LIBOR

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2172	    with pytest.raises(MqValueError):
2173	        tm_rates.basis_swap_spread(**args)
2174	    args['reference_benchmark_type'] = BenchmarkType.LIBOR

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2180	    mocker.patch.object(GsDataApi, 'get_market_data', return_value=mock_curr(None, None))
2181	    actual = tm_rates.basis_swap_spread(**args)
2182	    expected = tm.ExtendedSeries([1, 2, 3], index=_index * 3, name='basisSwapRate')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/timeseries/test_measures.py:2198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2197	    args['location'] = PricingLocation.NYC
2198	    actual = tm_rates.basis_swap_spread(**args)
2199	    expected = tm.ExtendedSeries([1, 2, 3], index=_index * 3, name='basisSwapRate')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/utils/mock_request.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
152	            MockRequest.__saved_files.add(request_id)
153	            file_data.write(json.dumps(mock_data, indent=4))
154	        log_mock_data_event(f'Created {mfk.file_name}.')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/gs_quant/test/utils/mock_request.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
251	        with open(full_file_path, 'w') as out_file:
252	            out_file.write(json.dumps(new_data, indent=4))
253	        log_mock_data_event(f'Updated {mock_file_key.file_name}. As {existing_used} != {sorted_tests}')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/setup.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
35	    target_dir = os.path.join(reference, "gs_quant", "docs")
36	    shutil.rmtree(target_dir, ignore_errors=True)
37	    shutil.copytree(generated_dir, target_dir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/setup.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	with open("README.md", "r") as fh:
40	    long_description = fh.read()
41	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/setup.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    long_description_content_type="text/markdown",
51	    url="https://marquee.gs.com",
52	    license="http://www.apache.org/licenses/LICENSE-2.0",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/setup.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    url="https://marquee.gs.com",
52	    license="http://www.apache.org/licenses/LICENSE-2.0",
53	    packages=setuptools.find_packages(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
473	
474	LONG_VERSION_PY['git'] = r'''
475	# This file helps to compute a version number in source trees obtained from
476	# git-archive tarball (such as those provided by githubs download-from-tag
477	# feature). Distribution tarballs (built by setup.py sdist) and build
478	# directories (produced by setup.py build) will contain a much shorter file
479	# that just contains the computed version number.
480	
481	# This file is released into the public domain.
482	# Generated by versioneer-0.28
483	# https://github.com/python-versioneer/python-versioneer
484	
485	"""Git implementation of _version.py."""
486	
487	import errno
488	import os
489	import re
490	import subprocess
491	import sys
492	from typing import Callable, Dict
493	import functools
494	
495	
496	def get_keywords():
497	    """Get the keywords needed to look up the version information."""
498	    # these strings will be replaced by git during git-archive.
499	    # setup.py/versioneer.py will grep for the variable names, so they must
500	    # each be defined on a line of their own. _version.py will just call
501	    # get_keywords().
502	    git_refnames = "%(DOLLAR)sFormat:%%d%(DOLLAR)s"
503	    git_full = "%(DOLLAR)sFormat:%%H%(DOLLAR)s"
504	    git_date = "%(DOLLAR)sFormat:%%ci%(DOLLAR)s"
505	    keywords = {"refnames": git_refnames, "full": git_full, "date": git_date}
506	    return keywords
507	
508	
509	class VersioneerConfig:
510	    """Container for Versioneer configuration parameters."""
511	
512	
513	def get_config():
514	    """Create, populate and return the VersioneerConfig() object."""
515	    # these strings are filled in when 'setup.py versioneer' creates
516	    # _version.py
517	    cfg = VersioneerConfig()
518	    cfg.VCS = "git"
519	    cfg.style = "%(STYLE)s"
520	    cfg.tag_prefix = "%(TAG_PREFIX)s"
521	    cfg.parentdir_prefix = "%(PARENTDIR_PREFIX)s"
522	    cfg.versionfile_source = "%(VERSIONFILE_SOURCE)s"
523	    cfg.verbose = False
524	    return cfg
525	
526	
527	class NotThisMethod(Exception):
528	    """Exception raised if a method is not valid for the current scenario."""
529	
530	
531	LONG_VERSION_PY: Dict[str, str] = {}
532	HANDLERS: Dict[str, Dict[str, Callable]] = {}
533	
534	
535	def register_vcs_handler(vcs, method):  # decorator
536	    """Create decorator to mark a method as the handler of a VCS."""
537	    def decorate(f):
538	        """Store f in HANDLERS[vcs][method]."""
539	        if vcs not in HANDLERS:
540	            HANDLERS[vcs] = {}
541	        HANDLERS[vcs][method] = f
542	        return f
543	    return decorate
544	
545	
546	def run_command(commands, args, cwd=None, verbose=False, hide_stderr=False,
547	                env=None):
548	    """Call the given command(s)."""
549	    assert isinstance(commands, list)
550	    process = None
551	
552	    popen_kwargs = {}
553	    if sys.platform == "win32":
554	        # This hides the console window if pythonw.exe is used
555	        startupinfo = subprocess.STARTUPINFO()
556	        startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW
557	        popen_kwargs["startupinfo"] = startupinfo
558	
559	    for command in commands:
560	        try:
561	            dispcmd = str([command] + args)
562	            # remember shell=False, so use git.cmd on windows, not just git
563	            process = subprocess.Popen([command] + args, cwd=cwd, env=env,
564	                                       stdout=subprocess.PIPE,
565	                                       stderr=(subprocess.PIPE if hide_stderr
566	                                               else None), **popen_kwargs)
567	            break
568	        except OSError:
569	            e = sys.exc_info()[1]
570	            if e.errno == errno.ENOENT:
571	                continue
572	            if verbose:
573	                print("unable to run %%s" %% dispcmd)
574	                print(e)
575	            return None, None
576	    else:
577	        if verbose:
578	            print("unable to find command, tried %%s" %% (commands,))
579	        return None, None
580	    stdout = process.communicate()[0].strip().decode()
581	    if process.returncode != 0:
582	        if verbose:
583	            print("unable to run %%s (error)" %% dispcmd)
584	            print("stdout was %%s" %% stdout)
585	        return None, process.returncode
586	    return stdout, process.returncode
587	
588	
589	def versions_from_parentdir(parentdir_prefix, root, verbose):
590	    """Try to determine the version from the parent directory name.
591	
592	    Source tarballs conventionally unpack into a directory that includes both
593	    the project name and a version string. We will also support searching up
594	    two directory levels for an appropriately named parent directory
595	    """
596	    rootdirs = []
597	
598	    for _ in range(3):
599	        dirname = os.path.basename(root)
600	        if dirname.startswith(parentdir_prefix):
601	            return {"version": dirname[len(parentdir_prefix):],
602	                    "full-revisionid": None,
603	                    "dirty": False, "error": None, "date": None}
604	        rootdirs.append(root)
605	        root = os.path.dirname(root)  # up a level
606	
607	    if verbose:
608	        print("Tried directories %%s but none started with prefix %%s" %%
609	              (str(rootdirs), parentdir_prefix))
610	    raise NotThisMethod("rootdir doesn't start with parentdir_prefix")
611	
612	
613	@register_vcs_handler("git", "get_keywords")
614	def git_get_keywords(versionfile_abs):
615	    """Extract version information from the given file."""
616	    # the code embedded in _version.py can just fetch the value of these
617	    # keywords. When used from setup.py, we don't want to import _version.py,
618	    # so we do it with a regexp instead. This function is not used from
619	    # _version.py.
620	    keywords = {}
621	    try:
622	        with open(versionfile_abs, "r") as fobj:
623	            for line in fobj:
624	                if line.strip().startswith("git_refnames ="):
625	                    mo = re.search(r'=\s*"(.*)"', line)
626	                    if mo:
627	                        keywords["refnames"] = mo.group(1)
628	                if line.strip().startswith("git_full ="):
629	                    mo = re.search(r'=\s*"(.*)"', line)
630	                    if mo:
631	                        keywords["full"] = mo.group(1)
632	                if line.strip().startswith("git_date ="):
633	                    mo = re.search(r'=\s*"(.*)"', line)
634	                    if mo:
635	                        keywords["date"] = mo.group(1)
636	    except OSError:
637	        pass
638	    return keywords
639	
640	
641	@register_vcs_handler("git", "keywords")
642	def git_versions_from_keywords(keywords, tag_prefix, verbose):
643	    """Get version information from git keywords."""
644	    if "refnames" not in keywords:
645	        raise NotThisMethod("Short version file found")
646	    date = keywords.get("date")
647	    if date is not None:
648	        # Use only the last line.  Previous lines may contain GPG signature
649	        # information.
650	        date = date.splitlines()[-1]
651	
652	        # git-2.2.0 added "%%cI", which expands to an ISO-8601 -compliant
653	        # datestamp. However we prefer "%%ci" (which expands to an "ISO-8601
654	        # -like" string, which we must then edit to make compliant), because
655	        # it's been around since git-1.5.3, and it's too difficult to
656	        # discover which version we're using, or to work around using an
657	        # older one.
658	        date = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
659	    refnames = keywords["refnames"].strip()
660	    if refnames.startswith("$Format"):
661	        if verbose:
662	            print("keywords are unexpanded, not using")
663	        raise NotThisMethod("unexpanded keywords, not a git-archive tarball")
664	    refs = {r.strip() for r in refnames.strip("()").split(",")}
665	    # starting in git-1.8.3, tags are listed as "tag: foo-1.0" instead of
666	    # just "foo-1.0". If we see a "tag: " prefix, prefer those.
667	    TAG = "tag: "
668	    tags = {r[len(TAG):] for r in refs if r.startswith(TAG)}
669	    if not tags:
670	        # Either we're using git < 1.8.3, or there really are no tags. We use
671	        # a heuristic: assume all version tags have a digit. The old git %%d
672	        # expansion behaves like git log --decorate=short and strips out the
673	        # refs/heads/ and refs/tags/ prefixes that would let us distinguish
674	        # between branches and tags. By ignoring refnames without digits, we
675	        # filter out many common branch names like "release" and
676	        # "stabilization", as well as "HEAD" and "master".
677	        tags = {r for r in refs if re.search(r'\d', r)}
678	        if verbose:
679	            print("discarding '%%s', no digits" %% ",".join(refs - tags))
680	    if verbose:
681	        print("likely tags: %%s" %% ",".join(sorted(tags)))
682	    for ref in sorted(tags):
683	        # sorting will prefer e.g. "2.0" over "2.0rc1"
684	        if ref.startswith(tag_prefix):
685	            r = ref[len(tag_prefix):]
686	            # Filter out refs that exactly match prefix or that don't start
687	            # with a number once the prefix is stripped (mostly a concern
688	            # when prefix is '')
689	            if not re.match(r'\d', r):
690	                continue
691	            if verbose:
692	                print("picking %%s" %% r)
693	            return {"version": r,
694	                    "full-revisionid": keywords["full"].strip(),
695	                    "dirty": False, "error": None,
696	                    "date": date}
697	    # no suitable tags, so version is "0+unknown", but full hex is still there
698	    if verbose:
699	        print("no suitable tags, using unknown + full revision id")
700	    return {"version": "0+unknown",
701	            "full-revisionid": keywords["full"].strip(),
702	            "dirty": False, "error": "no suitable tags", "date": None}
703	
704	
705	@register_vcs_handler("git", "pieces_from_vcs")
706	def git_pieces_from_vcs(tag_prefix, root, verbose, runner=run_command):
707	    """Get version from 'git describe' in the root of the source tree.
708	
709	    This only gets called if the git-archive 'subst' keywords were *not*
710	    expanded, and _version.py hasn't already been rewritten with a short
711	    version string, meaning we're inside a checked out source tree.
712	    """
713	    GITS = ["git"]
714	    if sys.platform == "win32":
715	        GITS = ["git.cmd", "git.exe"]
716	
717	    # GIT_DIR can interfere with correct operation of Versioneer.
718	    # It may be intended to be passed to the Versioneer-versioned project,
719	    # but that should not change where we get our version from.
720	    env = os.environ.copy()
721	    env.pop("GIT_DIR", None)
722	    runner = functools.partial(runner, env=env)
723	
724	    _, rc = runner(GITS, ["rev-parse", "--git-dir"], cwd=root,
725	                   hide_stderr=not verbose)
726	    if rc != 0:
727	        if verbose:
728	            print("Directory %%s not under git control" %% root)
729	        raise NotThisMethod("'git rev-parse --git-dir' returned error")
730	
731	    # if there is a tag matching tag_prefix, this yields TAG-NUM-gHEX[-dirty]
732	    # if there isn't one, this yields HEX[-dirty] (no NUM)
733	    describe_out, rc = runner(GITS, [
734	        "describe", "--tags", "--dirty", "--always", "--long",
735	        "--match", f"{tag_prefix}[[:digit:]]*"
736	    ], cwd=root)
737	    # --long was added in git-1.5.5
738	    if describe_out is None:
739	        raise NotThisMethod("'git describe' failed")
740	    describe_out = describe_out.strip()
741	    full_out, rc = runner(GITS, ["rev-parse", "HEAD"], cwd=root)
742	    if full_out is None:
743	        raise NotThisMethod("'git rev-parse' failed")
744	    full_out = full_out.strip()
745	
746	    pieces = {}
747	    pieces["long"] = full_out
748	    pieces["short"] = full_out[:7]  # maybe improved later
749	    pieces["error"] = None
750	
751	    branch_name, rc = runner(GITS, ["rev-parse", "--abbrev-ref", "HEAD"],
752	                             cwd=root)
753	    # --abbrev-ref was added in git-1.6.3
754	    if rc != 0 or branch_name is None:
755	        raise NotThisMethod("'git rev-parse --abbrev-ref' returned error")
756	    branch_name = branch_name.strip()
757	
758	    if branch_name == "HEAD":
759	        # If we aren't exactly on a branch, pick a branch which represents
760	        # the current commit. If all else fails, we are on a branchless
761	        # commit.
762	        branches, rc = runner(GITS, ["branch", "--contains"], cwd=root)
763	        # --contains was added in git-1.5.4
764	        if rc != 0 or branches is None:
765	            raise NotThisMethod("'git branch --contains' returned error")
766	        branches = branches.split("\n")
767	
768	        # Remove the first line if we're running detached
769	        if "(" in branches[0]:
770	            branches.pop(0)
771	
772	        # Strip off the leading "* " from the list of branches.
773	        branches = [branch[2:] for branch in branches]
774	        if "master" in branches:
775	            branch_name = "master"
776	        elif not branches:
777	            branch_name = None
778	        else:
779	            # Pick the first branch that is returned. Good or bad.
780	            branch_name = branches[0]
781	
782	    pieces["branch"] = branch_name
783	
784	    # parse describe_out. It will be like TAG-NUM-gHEX[-dirty] or HEX[-dirty]
785	    # TAG might have hyphens.
786	    git_describe = describe_out
787	
788	    # look for -dirty suffix
789	    dirty = git_describe.endswith("-dirty")
790	    pieces["dirty"] = dirty
791	    if dirty:
792	        git_describe = git_describe[:git_describe.rindex("-dirty")]
793	
794	    # now we have TAG-NUM-gHEX or HEX
795	
796	    if "-" in git_describe:
797	        # TAG-NUM-gHEX
798	        mo = re.search(r'^(.+)-(\d+)-g([0-9a-f]+)$', git_describe)
799	        if not mo:
800	            # unparsable. Maybe git-describe is misbehaving?
801	            pieces["error"] = ("unable to parse git-describe output: '%%s'"
802	                               %% describe_out)
803	            return pieces
804	
805	        # tag
806	        full_tag = mo.group(1)
807	        if not full_tag.startswith(tag_prefix):
808	            if verbose:
809	                fmt = "tag '%%s' doesn't start with prefix '%%s'"
810	                print(fmt %% (full_tag, tag_prefix))
811	            pieces["error"] = ("tag '%%s' doesn't start with prefix '%%s'"
812	                               %% (full_tag, tag_prefix))
813	            return pieces
814	        pieces["closest-tag"] = full_tag[len(tag_prefix):]
815	
816	        # distance: number of commits since tag
817	        pieces["distance"] = int(mo.group(2))
818	
819	        # commit: short hex revision ID
820	        pieces["short"] = mo.group(3)
821	
822	    else:
823	        # HEX: no tags
824	        pieces["closest-tag"] = None
825	        out, rc = runner(GITS, ["rev-list", "HEAD", "--left-right"], cwd=root)
826	        pieces["distance"] = len(out.split())  # total number of commits
827	
828	    # commit date: see ISO-8601 comment in git_versions_from_keywords()
829	    date = runner(GITS, ["show", "-s", "--format=%%ci", "HEAD"], cwd=root)[0].strip()
830	    # Use only the last line.  Previous lines may contain GPG signature
831	    # information.
832	    date = date.splitlines()[-1]
833	    pieces["date"] = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
834	
835	    return pieces
836	
837	
838	def plus_or_dot(pieces):
839	    """Return a + if we don't already have one, else return a ."""
840	    if "+" in pieces.get("closest-tag", ""):
841	        return "."
842	    return "+"
843	
844	
845	def render_pep440(pieces):
846	    """Build up version string, with post-release "local version identifier".
847	
848	    Our goal: TAG[+DISTANCE.gHEX[.dirty]] . Note that if you
849	    get a tagged build and then dirty it, you'll get TAG+0.gHEX.dirty
850	
851	    Exceptions:
852	    1: no tags. git_describe was just HEX. 0+untagged.DISTANCE.gHEX[.dirty]
853	    """
854	    if pieces["closest-tag"]:
855	        rendered = pieces["closest-tag"]
856	        if pieces["distance"] or pieces["dirty"]:
857	            rendered += plus_or_dot(pieces)
858	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
859	            if pieces["dirty"]:
860	                rendered += ".dirty"
861	    else:
862	        # exception #1
863	        rendered = "0+untagged.%%d.g%%s" %% (pieces["distance"],
864	                                          pieces["short"])
865	        if pieces["dirty"]:
866	            rendered += ".dirty"
867	    return rendered
868	
869	
870	def render_pep440_branch(pieces):
871	    """TAG[[.dev0]+DISTANCE.gHEX[.dirty]] .
872	
873	    The ".dev0" means not master branch. Note that .dev0 sorts backwards
874	    (a feature branch will appear "older" than the master branch).
875	
876	    Exceptions:
877	    1: no tags. 0[.dev0]+untagged.DISTANCE.gHEX[.dirty]
878	    """
879	    if pieces["closest-tag"]:
880	        rendered = pieces["closest-tag"]
881	        if pieces["distance"] or pieces["dirty"]:
882	            if pieces["branch"] != "master":
883	                rendered += ".dev0"
884	            rendered += plus_or_dot(pieces)
885	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
886	            if pieces["dirty"]:
887	                rendered += ".dirty"
888	    else:
889	        # exception #1
890	        rendered = "0"
891	        if pieces["branch"] != "master":
892	            rendered += ".dev0"
893	        rendered += "+untagged.%%d.g%%s" %% (pieces["distance"],
894	                                          pieces["short"])
895	        if pieces["dirty"]:
896	            rendered += ".dirty"
897	    return rendered
898	
899	
900	def pep440_split_post(ver):
901	    """Split pep440 version string at the post-release segment.
902	
903	    Returns the release segments before the post-release and the
904	    post-release version number (or -1 if no post-release segment is present).
905	    """
906	    vc = str.split(ver, ".post")
907	    return vc[0], int(vc[1] or 0) if len(vc) == 2 else None
908	
909	
910	def render_pep440_pre(pieces):
911	    """TAG[.postN.devDISTANCE] -- No -dirty.
912	
913	    Exceptions:
914	    1: no tags. 0.post0.devDISTANCE
915	    """
916	    if pieces["closest-tag"]:
917	        if pieces["distance"]:
918	            # update the post release segment
919	            tag_version, post_version = pep440_split_post(pieces["closest-tag"])
920	            rendered = tag_version
921	            if post_version is not None:
922	                rendered += ".post%%d.dev%%d" %% (post_version + 1, pieces["distance"])
923	            else:
924	                rendered += ".post0.dev%%d" %% (pieces["distance"])
925	        else:
926	            # no commits, use the tag as the version
927	            rendered = pieces["closest-tag"]
928	    else:
929	        # exception #1
930	        rendered = "0.post0.dev%%d" %% pieces["distance"]
931	    return rendered
932	
933	
934	def render_pep440_post(pieces):
935	    """TAG[.postDISTANCE[.dev0]+gHEX] .
936	
937	    The ".dev0" means dirty. Note that .dev0 sorts backwards
938	    (a dirty tree will appear "older" than the corresponding clean one),
939	    but you shouldn't be releasing software with -dirty anyways.
940	
941	    Exceptions:
942	    1: no tags. 0.postDISTANCE[.dev0]
943	    """
944	    if pieces["closest-tag"]:
945	        rendered = pieces["closest-tag"]
946	        if pieces["distance"] or pieces["dirty"]:
947	            rendered += ".post%%d" %% pieces["distance"]
948	            if pieces["dirty"]:
949	                rendered += ".dev0"
950	            rendered += plus_or_dot(pieces)
951	            rendered += "g%%s" %% pieces["short"]
952	    else:
953	        # exception #1
954	        rendered = "0.post%%d" %% pieces["distance"]
955	        if pieces["dirty"]:
956	            rendered += ".dev0"
957	        rendered += "+g%%s" %% pieces["short"]
958	    return rendered
959	
960	
961	def render_pep440_post_branch(pieces):
962	    """TAG[.postDISTANCE[.dev0]+gHEX[.dirty]] .
963	
964	    The ".dev0" means not master branch.
965	
966	    Exceptions:
967	    1: no tags. 0.postDISTANCE[.dev0]+gHEX[.dirty]
968	    """
969	    if pieces["closest-tag"]:
970	        rendered = pieces["closest-tag"]
971	        if pieces["distance"] or pieces["dirty"]:
972	            rendered += ".post%%d" %% pieces["distance"]
973	            if pieces["branch"] != "master":
974	                rendered += ".dev0"
975	            rendered += plus_or_dot(pieces)
976	            rendered += "g%%s" %% pieces["short"]
977	            if pieces["dirty"]:
978	                rendered += ".dirty"
979	    else:
980	        # exception #1
981	        rendered = "0.post%%d" %% pieces["distance"]
982	        if pieces["branch"] != "master":
983	            rendered += ".dev0"
984	        rendered += "+g%%s" %% pieces["short"]
985	        if pieces["dirty"]:
986	            rendered += ".dirty"
987	    return rendered
988	
989	
990	def render_pep440_old(pieces):
991	    """TAG[.postDISTANCE[.dev0]] .
992	
993	    The ".dev0" means dirty.
994	
995	    Exceptions:
996	    1: no tags. 0.postDISTANCE[.dev0]
997	    """
998	    if pieces["closest-tag"]:
999	        rendered = pieces["closest-tag"]
1000	        if pieces["distance"] or pieces["dirty"]:
1001	            rendered += ".post%%d" %% pieces["distance"]
1002	            if pieces["dirty"]:
1003	                rendered += ".dev0"
1004	    else:
1005	        # exception #1
1006	        rendered = "0.post%%d" %% pieces["distance"]
1007	        if pieces["dirty"]:
1008	            rendered += ".dev0"
1009	    return rendered
1010	
1011	
1012	def render_git_describe(pieces):
1013	    """TAG[-DISTANCE-gHEX][-dirty].
1014	
1015	    Like 'git describe --tags --dirty --always'.
1016	
1017	    Exceptions:
1018	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
1019	    """
1020	    if pieces["closest-tag"]:
1021	        rendered = pieces["closest-tag"]
1022	        if pieces["distance"]:
1023	            rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
1024	    else:
1025	        # exception #1
1026	        rendered = pieces["short"]
1027	    if pieces["dirty"]:
1028	        rendered += "-dirty"
1029	    return rendered
1030	
1031	
1032	def render_git_describe_long(pieces):
1033	    """TAG-DISTANCE-gHEX[-dirty].
1034	
1035	    Like 'git describe --tags --dirty --always -long'.
1036	    The distance/hash is unconditional.
1037	
1038	    Exceptions:
1039	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
1040	    """
1041	    if pieces["closest-tag"]:
1042	        rendered = pieces["closest-tag"]
1043	        rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
1044	    else:
1045	        # exception #1
1046	        rendered = pieces["short"]
1047	    if pieces["dirty"]:
1048	        rendered += "-dirty"
1049	    return rendered
1050	
1051	
1052	def render(pieces, style):
1053	    """Render the given version pieces into the requested style."""
1054	    if pieces["error"]:
1055	        return {"version": "unknown",
1056	                "full-revisionid": pieces.get("long"),
1057	                "dirty": None,
1058	                "error": pieces["error"],
1059	                "date": None}
1060	
1061	    if not style or style == "default":
1062	        style = "pep440"  # the default
1063	
1064	    if style == "pep440":
1065	        rendered = render_pep440(pieces)
1066	    elif style == "pep440-branch":
1067	        rendered = render_pep440_branch(pieces)
1068	    elif style == "pep440-pre":
1069	        rendered = render_pep440_pre(pieces)
1070	    elif style == "pep440-post":
1071	        rendered = render_pep440_post(pieces)
1072	    elif style == "pep440-post-branch":
1073	        rendered = render_pep440_post_branch(pieces)
1074	    elif style == "pep440-old":
1075	        rendered = render_pep440_old(pieces)
1076	    elif style == "git-describe":
1077	        rendered = render_git_describe(pieces)
1078	    elif style == "git-describe-long":
1079	        rendered = render_git_describe_long(pieces)
1080	    else:
1081	        raise ValueError("unknown style '%%s'" %% style)
1082	
1083	    return {"version": rendered, "full-revisionid": pieces["long"],
1084	            "dirty": pieces["dirty"], "error": None,
1085	            "date": pieces.get("date")}
1086	
1087	
1088	def get_versions():
1089	    """Get version information or return default if unable to do so."""
1090	    # I am in _version.py, which lives at ROOT/VERSIONFILE_SOURCE. If we have
1091	    # __file__, we can work backwards from there to the root. Some
1092	    # py2exe/bbfreeze/non-CPython implementations don't do __file__, in which
1093	    # case we can only use expanded keywords.
1094	
1095	    cfg = get_config()
1096	    verbose = cfg.verbose
1097	
1098	    try:
1099	        return git_versions_from_keywords(get_keywords(), cfg.tag_prefix,
1100	                                          verbose)
1101	    except NotThisMethod:
1102	        pass
1103	
1104	    try:
1105	        root = os.path.realpath(__file__)
1106	        # versionfile_source is the relative path from the top of the source
1107	        # tree (where the .git directory might live) to this file. Invert
1108	        # this to find the root from __file__.
1109	        for _ in cfg.versionfile_source.split('/'):
1110	            root = os.path.dirname(root)
1111	    except NameError:
1112	        return {"version": "0+unknown", "full-revisionid": None,
1113	                "dirty": None,
1114	                "error": "unable to find root of source tree",
1115	                "date": None}
1116	
1117	    try:
1118	        pieces = git_pieces_from_vcs(cfg.tag_prefix, root, verbose)
1119	        return render(pieces, cfg.style)
1120	    except NotThisMethod:
1121	        pass
1122	
1123	    try:
1124	        if cfg.parentdir_prefix:
1125	            return versions_from_parentdir(cfg.parentdir_prefix, root, verbose)
1126	    except NotThisMethod:
1127	        pass
1128	
1129	    return {"version": "0+unknown", "full-revisionid": None,
1130	            "dirty": None,
1131	            "error": "unable to compute version", "date": None}
1132	'''
1133	
1134	
1135	@register_vcs_handler("git", "get_keywords")
1136	def git_get_keywords(versionfile_abs):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:1393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1392	        with open(".gitattributes", "a+") as fobj:
1393	            fobj.write(f"{versionfile_source} export-subst\n")
1394	        files.append(".gitattributes")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:1444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1443	        with open(filename) as f:
1444	            contents = f.read()
1445	    except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:1463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1462	    with open(filename, "w") as f:
1463	        f.write(SHORT_VERSION_PY % contents)
1464	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:1947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1946	                    LONG = LONG_VERSION_PY[cfg.VCS]
1947	                    f.write(LONG %
1948	                            {"DOLLAR": "$",
1949	                             "STYLE": cfg.style,
1950	                             "TAG_PREFIX": cfg.tag_prefix,
1951	                             "PARENTDIR_PREFIX": cfg.parentdir_prefix,
1952	                             "VERSIONFILE_SOURCE": cfg.versionfile_source,
1953	                             })

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:1976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1975	                    LONG = LONG_VERSION_PY[cfg.VCS]
1976	                    f.write(LONG %
1977	                            {"DOLLAR": "$",
1978	                             "STYLE": cfg.style,
1979	                             "TAG_PREFIX": cfg.tag_prefix,
1980	                             "PARENTDIR_PREFIX": cfg.parentdir_prefix,
1981	                             "VERSIONFILE_SOURCE": cfg.versionfile_source,
1982	                             })

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:2018
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2017	            with open(manifest_filename, 'w') as fobj:
2018	                fobj.write('\n'.join(normalized))
2019	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:2113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2112	            with open(os.path.join(root, "setup.cfg"), "a") as f:
2113	                f.write(SAMPLE_CONFIG)
2114	        print(CONFIG_ERROR, file=sys.stderr)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:2120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2119	        LONG = LONG_VERSION_PY[cfg.VCS]
2120	        f.write(LONG % {"DOLLAR": "$",
2121	                        "STYLE": cfg.style,
2122	                        "TAG_PREFIX": cfg.tag_prefix,
2123	                        "PARENTDIR_PREFIX": cfg.parentdir_prefix,
2124	                        "VERSIONFILE_SOURCE": cfg.versionfile_source,
2125	                        })

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:2132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2131	            with open(ipy, "r") as f:
2132	                old = f.read()
2133	        except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:2140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2139	            with open(ipy, "w") as f:
2140	                f.write(old.replace(OLD_SNIPPET, snippet))
2141	        elif snippet not in old:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gs_quant-1.2.50/gs_quant-1.2.50/versioneer.py:2144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2143	            with open(ipy, "a") as f:
2144	                f.write(snippet)
2145	        else:

--------------------------------------------------

Code scanned:
	Total lines of code: 98077
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 114.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 125.0
		High: 4.0
Files skipped (0):
