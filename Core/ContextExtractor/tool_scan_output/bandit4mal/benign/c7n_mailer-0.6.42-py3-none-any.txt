Run started:2025-04-12 12:18:07.049460

Test results:
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/azure_mailer/azure_queue_processor.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
64	        queue_message = json.loads(
65	            zlib.decompress(base64.b64decode(encoded_azure_queue_message.content))
66	        )

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/azure_mailer/azure_queue_processor.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
64	        queue_message = json.loads(
65	            zlib.decompress(base64.b64decode(encoded_azure_queue_message.content))
66	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/azure_mailer/azure_queue_processor.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
64	        queue_message = json.loads(
65	            zlib.decompress(base64.b64decode(encoded_azure_queue_message.content))
66	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/azure_mailer/azure_queue_processor.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
64	        queue_message = json.loads(
65	            zlib.decompress(base64.b64decode(encoded_azure_queue_message.content))
66	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/azure_mailer/deploy.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	            with open(os.path.join(d, t)) as fh:
83	                package.pkg.add_contents(function_path + "/msg-templates/%s" % t, fh.read())
84	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/azure_mailer/sendgrid_delivery.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
118	            # Python2
119	            body = message.get_payload(decode=True).decode("utf-8")
120	        mail.add_content(Content(message.get_content_type(), body.strip()))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/cli.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	CONFIG_SCHEMA = {
33	    "$schema": "http://json-schema.org/draft-07/schema",
34	    "id": "https://schema.cloudcustodian.io/v0/mailer.json",
35	    "type": "object",
36	    "additionalProperties": False,
37	    "required": ["queue_url"],
38	    "properties": {
39	        "queue_url": {"type": "string"},
40	        "endpoint_url": {"type": "string"},
41	        "from_address": {"type": "string"},
42	        "additional_email_headers": {
43	            "type": "object",
44	            "patternProperties": {
45	                "": {"type": "string"},
46	            },
47	        },
48	        "contact_tags": {"type": "array", "items": {"type": "string"}},
49	        "org_domain": {"type": "string"},
50	        # Standard Lambda Function Config
51	        "region": {"type": "string"},
52	        "role": {"type": "string"},
53	        "runtime": {"type": "string"},
54	        "memory": {"type": "integer"},
55	        "timeout": {"type": "integer"},
56	        "subnets": {"type": "array", "items": {"type": "string"}},
57	        "security_groups": {"type": "array", "items": {"type": "string"}},
58	        "dead_letter_config": {"type": "object"},
59	        "lambda_name": {"type": "string"},
60	        "lambda_description": {"type": "string"},
61	        "lambda_tags": {"type": "object"},
62	        "lambda_schedule": {"type": "string"},
63	        # Azure Function Config
64	        "function_properties": {
65	            "type": "object",
66	            "identity": {
67	                "type": "object",
68	                "additionalProperties": False,
69	                "properties": {
70	                    "type": {"enum": ["Embedded", "SystemAssigned", "UserAssigned"]},
71	                    "client_id": {"type": "string"},
72	                    "id": {"type": "string"},
73	                },
74	            },
75	            "appInsights": {
76	                "type": "object",
77	                "oneOf": [
78	                    {"type": "string"},
79	                    {
80	                        "type": "object",
81	                        "properties": {
82	                            "name": "string",
83	                            "location": "string",
84	                            "resourceGroupName": "string",
85	                        },
86	                    },
87	                ],
88	            },
89	            "storageAccount": {
90	                "type": "object",
91	                "oneOf": [
92	                    {"type": "string"},
93	                    {
94	                        "type": "object",
95	                        "properties": {
96	                            "name": "string",
97	                            "location": "string",
98	                            "resourceGroupName": "string",
99	                        },
100	                    },
101	                ],
102	            },
103	            "servicePlan": {
104	                "type": "object",
105	                "oneOf": [
106	                    {"type": "string"},
107	                    {
108	                        "type": "object",
109	                        "properties": {
110	                            "name": "string",
111	                            "location": "string",
112	                            "resourceGroupName": "string",
113	                            "skuTier": "string",
114	                            "skuName": "string",
115	                        },
116	                    },
117	                ],
118	            },
119	        },
120	        # GCP Cloud Function Config # TODO:
121	        # 'function_schedule': {'type': 'string'},
122	        # 'function_skuCode': {'type': 'string'},
123	        # 'function_sku': {'type': 'string'},
124	        "email_base_url": {"type": "string"},
125	        # Mailer Infrastructure Config
126	        "cache_engine": {"type": "string"},
127	        "smtp_server": {"type": "string"},
128	        "smtp_port": {"type": "integer"},
129	        "smtp_ssl": {"type": "boolean"},
130	        "smtp_username": {"type": "string"},
131	        "smtp_password": SECURED_STRING_SCHEMA,
132	        "ldap_email_key": {"type": "string"},
133	        "ldap_uid_tags": {"type": "array", "items": {"type": "string"}},
134	        "debug": {"type": "boolean"},
135	        "ldap_uid_regex": {"type": "string"},
136	        "ldap_uri": {"type": "string"},
137	        "ldap_bind_dn": {"type": "string"},
138	        "ldap_bind_user": {"type": "string"},
139	        "ldap_uid_attribute": {"type": "string"},
140	        "ldap_manager_attribute": {"type": "string"},
141	        "ldap_email_attribute": {"type": "string"},
142	        "ldap_bind_password_in_kms": {"type": "boolean"},
143	        "ldap_bind_password": SECURED_STRING_SCHEMA,
144	        "cross_accounts": {"type": "object"},
145	        "ses_region": {"type": "string"},
146	        "ses_role": {"type": "string"},
147	        "redis_host": {"type": "string"},
148	        "redis_port": {"type": "integer"},
149	        "datadog_api_key": {"type": "string"},  # TODO: encrypt with KMS?
150	        "datadog_application_key": {"type": "string"},  # TODO: encrypt with KMS?
151	        "slack_token": {"type": "string"},
152	        "slack_webhook": {"type": "string"},
153	        "sendgrid_api_key": SECURED_STRING_SCHEMA,
154	        "splunk_hec_url": {"type": "string"},
155	        "splunk_hec_token": {"type": "string"},
156	        "splunk_remove_paths": {"type": "array", "items": {"type": "string"}},
157	        "splunk_actions_list": {"type": "boolean"},
158	        "splunk_max_attempts": {"type": "integer"},
159	        "splunk_hec_max_length": {"type": "integer"},
160	        "splunk_hec_sourcetype": {"type": "string"},
161	        # MS Graph API config
162	        "graph_token_endpoint": {"type": "string"},
163	        "graph_sendmail_endpoint": {"type": "string"},
164	        "graph_client_id": {"type": "string"},
165	        "graph_client_secret": SECURED_STRING_SCHEMA,
166	        # SDK Config
167	        "profile": {"type": "string"},
168	        "http_proxy": {"type": "string"},
169	        "https_proxy": {"type": "string"},
170	        # Mapping account / emails
171	        "account_emails": {"type": "object"},
172	    },
173	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/cli.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    "$schema": "http://json-schema.org/draft-07/schema",
34	    "id": "https://schema.cloudcustodian.io/v0/mailer.json",
35	    "type": "object",
36	    "additionalProperties": False,
37	    "required": ["queue_url"],
38	    "properties": {
39	        "queue_url": {"type": "string"},
40	        "endpoint_url": {"type": "string"},
41	        "from_address": {"type": "string"},
42	        "additional_email_headers": {
43	            "type": "object",
44	            "patternProperties": {
45	                "": {"type": "string"},
46	            },
47	        },
48	        "contact_tags": {"type": "array", "items": {"type": "string"}},
49	        "org_domain": {"type": "string"},
50	        # Standard Lambda Function Config
51	        "region": {"type": "string"},
52	        "role": {"type": "string"},
53	        "runtime": {"type": "string"},
54	        "memory": {"type": "integer"},
55	        "timeout": {"type": "integer"},
56	        "subnets": {"type": "array", "items": {"type": "string"}},
57	        "security_groups": {"type": "array", "items": {"type": "string"}},
58	        "dead_letter_config": {"type": "object"},
59	        "lambda_name": {"type": "string"},
60	        "lambda_description": {"type": "string"},
61	        "lambda_tags": {"type": "object"},
62	        "lambda_schedule": {"type": "string"},
63	        # Azure Function Config
64	        "function_properties": {
65	            "type": "object",
66	            "identity": {
67	                "type": "object",
68	                "additionalProperties": False,
69	                "properties": {
70	                    "type": {"enum": ["Embedded", "SystemAssigned", "UserAssigned"]},
71	                    "client_id": {"type": "string"},
72	                    "id": {"type": "string"},
73	                },
74	            },
75	            "appInsights": {
76	                "type": "object",
77	                "oneOf": [
78	                    {"type": "string"},
79	                    {
80	                        "type": "object",
81	                        "properties": {
82	                            "name": "string",
83	                            "location": "string",
84	                            "resourceGroupName": "string",
85	                        },
86	                    },
87	                ],
88	            },
89	            "storageAccount": {
90	                "type": "object",
91	                "oneOf": [
92	                    {"type": "string"},
93	                    {
94	                        "type": "object",
95	                        "properties": {
96	                            "name": "string",
97	                            "location": "string",
98	                            "resourceGroupName": "string",
99	                        },
100	                    },
101	                ],
102	            },
103	            "servicePlan": {
104	                "type": "object",
105	                "oneOf": [
106	                    {"type": "string"},
107	                    {
108	                        "type": "object",
109	                        "properties": {
110	                            "name": "string",
111	                            "location": "string",
112	                            "resourceGroupName": "string",
113	                            "skuTier": "string",
114	                            "skuName": "string",
115	                        },
116	                    },
117	                ],
118	            },
119	        },
120	        # GCP Cloud Function Config # TODO:
121	        # 'function_schedule': {'type': 'string'},
122	        # 'function_skuCode': {'type': 'string'},
123	        # 'function_sku': {'type': 'string'},
124	        "email_base_url": {"type": "string"},
125	        # Mailer Infrastructure Config
126	        "cache_engine": {"type": "string"},
127	        "smtp_server": {"type": "string"},
128	        "smtp_port": {"type": "integer"},
129	        "smtp_ssl": {"type": "boolean"},
130	        "smtp_username": {"type": "string"},
131	        "smtp_password": SECURED_STRING_SCHEMA,
132	        "ldap_email_key": {"type": "string"},
133	        "ldap_uid_tags": {"type": "array", "items": {"type": "string"}},
134	        "debug": {"type": "boolean"},
135	        "ldap_uid_regex": {"type": "string"},
136	        "ldap_uri": {"type": "string"},
137	        "ldap_bind_dn": {"type": "string"},
138	        "ldap_bind_user": {"type": "string"},
139	        "ldap_uid_attribute": {"type": "string"},
140	        "ldap_manager_attribute": {"type": "string"},
141	        "ldap_email_attribute": {"type": "string"},
142	        "ldap_bind_password_in_kms": {"type": "boolean"},
143	        "ldap_bind_password": SECURED_STRING_SCHEMA,
144	        "cross_accounts": {"type": "object"},
145	        "ses_region": {"type": "string"},
146	        "ses_role": {"type": "string"},
147	        "redis_host": {"type": "string"},
148	        "redis_port": {"type": "integer"},
149	        "datadog_api_key": {"type": "string"},  # TODO: encrypt with KMS?
150	        "datadog_application_key": {"type": "string"},  # TODO: encrypt with KMS?
151	        "slack_token": {"type": "string"},
152	        "slack_webhook": {"type": "string"},
153	        "sendgrid_api_key": SECURED_STRING_SCHEMA,
154	        "splunk_hec_url": {"type": "string"},
155	        "splunk_hec_token": {"type": "string"},
156	        "splunk_remove_paths": {"type": "array", "items": {"type": "string"}},
157	        "splunk_actions_list": {"type": "boolean"},
158	        "splunk_max_attempts": {"type": "integer"},
159	        "splunk_hec_max_length": {"type": "integer"},
160	        "splunk_hec_sourcetype": {"type": "string"},
161	        # MS Graph API config
162	        "graph_token_endpoint": {"type": "string"},
163	        "graph_sendmail_endpoint": {"type": "string"},
164	        "graph_client_id": {"type": "string"},
165	        "graph_client_secret": SECURED_STRING_SCHEMA,
166	        # SDK Config
167	        "profile": {"type": "string"},
168	        "http_proxy": {"type": "string"},
169	        "https_proxy": {"type": "string"},
170	        # Mapping account / emails
171	        "account_emails": {"type": "object"},
172	    },
173	}
174	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/cli.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
190	    with open(args.config) as fh:
191	        config = yaml.load(fh.read(), Loader=yaml.SafeLoader)
192	    jsonschema.validate(config, CONFIG_SCHEMA)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/deploy.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	            with open(os.path.join(d, t)) as fh:
66	                archive.add_contents("msg-templates/%s" % t, fh.read())
67	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/gcp_mailer/gcp_queue_processor.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
79	        """Returns a message as a dict that been base64 decoded"""
80	        return json.loads(zlib.decompress(base64.b64decode(encoded_gcp_pubsub_message)))

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/gcp_mailer/gcp_queue_processor.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
79	        """Returns a message as a dict that been base64 decoded"""
80	        return json.loads(zlib.decompress(base64.b64decode(encoded_gcp_pubsub_message)))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/gcp_mailer/gcp_queue_processor.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
79	        """Returns a message as a dict that been base64 decoded"""
80	        return json.loads(zlib.decompress(base64.b64decode(encoded_gcp_pubsub_message)))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/gcp_mailer/gcp_queue_processor.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
79	        """Returns a message as a dict that been base64 decoded"""
80	        return json.loads(zlib.decompress(base64.b64decode(encoded_gcp_pubsub_message)))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/graph_delivery.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	                "message": {
31	                    "subject": mimetext.get("Subject"),
32	                    "body": {"contentType": contentType, "content": content},

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/graph_delivery.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
39	            }
40	            r = requests.post(
41	                self.sendmail_endpoint, data=json.dumps(data), headers=headers, timeout=10
42	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/graph_delivery.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	            "grant_type": "client_credentials",
48	            "scope": "https://graph.microsoft.com/.default",
49	            "client_id": client_id,
50	            "client_secret": client_secret,
51	        }
52	        r = requests.post(url, data=data, timeout=10)
53	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/graph_delivery.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
51	        }
52	        r = requests.post(url, data=data, timeout=10)
53	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/graph_delivery.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	        r.raise_for_status()
54	        return r.json().get("access_token")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/replay.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	            with open(msg_file, "r") as fh:
40	                raw = fh.read()
41	            logger.debug("Read %d byte message", len(raw))

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/replay.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
45	                logger.debug("base64-decoding and zlib decompressing message")
46	                raw = zlib.decompress(base64.b64decode(raw))
47	                if json_dump_file is not None:

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/replay.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
45	                logger.debug("base64-decoding and zlib decompressing message")
46	                raw = zlib.decompress(base64.b64decode(raw))
47	                if json_dump_file is not None:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/replay.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
45	                logger.debug("base64-decoding and zlib decompressing message")
46	                raw = zlib.decompress(base64.b64decode(raw))
47	                if json_dump_file is not None:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/replay.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
45	                logger.debug("base64-decoding and zlib decompressing message")
46	                raw = zlib.decompress(base64.b64decode(raw))
47	                if json_dump_file is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/replay.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	                    with open(json_dump_file, "wb") as fh:  # pragma: no cover
49	                        fh.write(raw)
50	            self.data = json.loads(raw)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/replay.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
177	    with open(policy_file, "r") as f:
178	        data = yaml.safe_load(f.read())
179	    policies = data["policies"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/replay.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
209	    with open(resources_path, "r") as f:
210	        resources = json.loads(f.read())
211	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/replay.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
235	    with open(options.config) as fh:
236	        config = yaml.load(fh.read(), Loader=yaml.SafeLoader)
237	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
13	    def __init__(self, config, logger, email_handler):
14	        self.caching = self.cache_factory(config, config.get("cache_engine", None))
15	        self.config = config

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	            return Redis(
22	                redis_host=config.get("redis_host"),
23	                redis_port=int(config.get("redis_port", 6379)),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	                redis_host=config.get("redis_host"),
23	                redis_port=int(config.get("redis_port", 6379)),
24	                db=0,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	        # Check for Slack targets in 'to' action and render appropriate template.
35	        for target in sqs_message.get("action", ()).get("to", []):
36	            if target == "slack://owners":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	        # Check for Slack targets in 'to' action and render appropriate template.
35	        for target in sqs_message.get("action", ()).get("to", []):
36	            if target == "slack://owners":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	                )
59	            elif target.startswith("https://hooks.slack.com/"):
60	                slack_messages[target] = get_rendered_jinja(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	                )
69	            elif target.startswith("slack://webhook/#") and self.config.get("slack_webhook"):
70	                webhook_target = self.config.get("slack_webhook")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	            elif target.startswith("slack://webhook/#") and self.config.get("slack_webhook"):
70	                webhook_target = self.config.get("slack_webhook")
71	                slack_messages[webhook_target] = get_rendered_jinja(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	                self.logger.debug(
81	                    "Generating message for webhook %s." % self.config.get("slack_webhook")
82	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	                result = next(
109	                    (item for item in resource_list[0].get("Tags", []) if item["Key"] == tag_name),
110	                    None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	                % (
142	                    sqs_message.get("account", ""),
143	                    sqs_message["policy"]["name"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	                    str(len(sqs_message["resources"])),
146	                    sqs_message["action"].get("slack_template", "slack_default"),
147	                    key,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	        for address in email_addresses:
160	            if self.caching and self.caching.get(address):
161	                self.logger.debug("Got Slack metadata from cache for: %s" % address)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	                self.logger.debug("Got Slack metadata from cache for: %s" % address)
162	                list[address] = self.caching.get(address)
163	                continue

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
164	
165	            response = requests.post(
166	                url="https://slack.com/api/users.lookupByEmail",
167	                data={"email": address},
168	                headers={
169	                    "Content-Type": "application/x-www-form-urlencoded",
170	                    "Authorization": "Bearer %s" % self.config.get("slack_token"),
171	                },
172	                timeout=60,
173	            ).json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	            response = requests.post(
166	                url="https://slack.com/api/users.lookupByEmail",
167	                data={"email": address},

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	                    "Content-Type": "application/x-www-form-urlencoded",
170	                    "Authorization": "Bearer %s" % self.config.get("slack_token"),
171	                },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	    def send_slack_msg(self, key, message_payload):
206	        if key.startswith("https://hooks.slack.com/"):
207	            response = requests.post(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
206	        if key.startswith("https://hooks.slack.com/"):
207	            response = requests.post(
208	                url=key,
209	                data=message_payload,
210	                headers={"Content-Type": "application/json;charset=utf-8"},
211	                timeout=60,
212	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
213	        else:
214	            response = requests.post(
215	                url="https://slack.com/api/chat.postMessage",
216	                data=message_payload,
217	                headers={
218	                    "Content-Type": "application/json;charset=utf-8",
219	                    "Authorization": "Bearer %s" % self.config.get("slack_token"),
220	                },
221	                timeout=60,
222	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
214	            response = requests.post(
215	                url="https://slack.com/api/chat.postMessage",
216	                data=message_payload,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/slack_delivery.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	                    "Content-Type": "application/json;charset=utf-8",
219	                    "Authorization": "Bearer %s" % self.config.get("slack_token"),
220	                },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	        indices = self._splunk_indices_for_message(msg)
50	        sourcetype = self.config.get("splunk_hec_sourcetype", "_json")
51	        for event in events:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	                        "host": "cloud-custodian",
57	                        "source": "%s-cloud-custodian" % event.get("account", "unknown"),
58	                        "sourcetype": sourcetype,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	        # if an event is present, add it to the log
76	        if msg.get("event", None) is not None:
77	            # add user to the log message, at the top level...

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	        # if configured, build and add actions list
86	        if self.config.get("splunk_actions_list", False):
87	            base_log["actions"] = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	        """
118	        paths = self.config.get("splunk_remove_paths", [])
119	        if not paths:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	        """
161	        max_attempts = self.config.get("splunk_max_attempts", 4)
162	        maxlen = self.config.get("splunk_hec_max_length", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	        max_attempts = self.config.get("splunk_max_attempts", 4)
162	        maxlen = self.config.get("splunk_hec_max_length", None)
163	        p = json.dumps(payload)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
239	        try:
240	            return {x["Key"]: x["Value"] for x in res.get("Tags", [])}
241	        except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	        except Exception:
242	            self.logger.warning("Exception building tags dict; Tags=%s", res.get("Tags", None))
243	            return {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	        indices = set()
257	        if msg and msg.get("action", False) and msg["action"].get("to", False):
258	            for to in msg["action"].get("to", []):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	        indices = set()
257	        if msg and msg.get("action", False) and msg["action"].get("to", False):
258	            for to in msg["action"].get("to", []):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/splunk_delivery.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257	        if msg and msg.get("action", False) and msg["action"].get("to", False):
258	            for to in msg["action"].get("to", []):
259	                if not to.startswith("splunkhec://"):

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/sqs_queue_processor.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
98	
99	            process_pool = multiprocessing.Pool(processes=self.max_num_processes)
100	        for sqs_message in sqs_messages:

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/sqs_queue_processor.py:99
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
98	
99	            process_pool = multiprocessing.Pool(processes=self.max_num_processes)
100	        for sqs_message in sqs_messages:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/sqs_queue_processor.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
132	            pass
133	        sqs_message = json.loads(zlib.decompress(base64.b64decode(body)))
134	

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/sqs_queue_processor.py:133
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
132	            pass
133	        sqs_message = json.loads(zlib.decompress(base64.b64decode(body)))
134	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/sqs_queue_processor.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
132	            pass
133	        sqs_message = json.loads(zlib.decompress(base64.b64decode(body)))
134	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/sqs_queue_processor.py:133
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
132	            pass
133	        sqs_message = json.loads(zlib.decompress(base64.b64decode(body)))
134	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/target.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	        if any(
29	            e.startswith("slack") or e.startswith("https://hooks.slack.com/")
30	            for e in message.get("action", {}).get("to", [])

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/utils.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
409	            kms = session.client("kms")
410	            return kms.decrypt(CiphertextBlob=base64.b64decode(config[encrypted_field]))[
411	                "Plaintext"

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/c7n_mailer-0.6.42-py3-none-any/c7n_mailer/utils.py:410
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
409	            kms = session.client("kms")
410	            return kms.decrypt(CiphertextBlob=base64.b64decode(config[encrypted_field]))[
411	                "Plaintext"

--------------------------------------------------

Code scanned:
	Total lines of code: 2761
	Total lines skipped (#nosec): 3

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 53.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 61.0
		High: 10.0
Files skipped (0):
