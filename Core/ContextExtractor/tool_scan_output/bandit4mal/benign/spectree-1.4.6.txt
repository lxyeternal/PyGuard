Run started:2025-04-12 14:25:34.861262

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/spectree/models.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	        ...,
165	        description="""URL or path of API server
166	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/spectree/page.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	    # https://github.com/Redocly/redoc
5	    "redoc": """
6	<!DOCTYPE html>
7	<html>
8	    <head>
9	        <title>ReDoc</title>
10	        <!-- needed for adaptive design -->
11	        <meta charset="utf-8"/>
12	        <meta name="viewport" content="width=device-width, initial-scale=1">
13	        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%221em%22 font-size=%2280%22>ðŸ“„</text></svg>">
14	        <link href=
15	        "https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:300,400,700"
16	        rel="stylesheet">
17	
18	        <!--
19	        ReDoc doesn't change outer page styles
20	        -->
21	        <style>
22	        body {{
23	            margin: 0;
24	            padding: 0;
25	        }}
26	        </style>
27	    </head>
28	    <body>
29	        <redoc spec-url='{spec_url}'></redoc>
30	        <script src="https://cdn.jsdelivr.net/npm/redoc@next/bundles/redoc.standalone.js"> </script>
31	    </body>
32	</html>""",
33	    # https://swagger.io
34	    "swagger": """
35	<!-- HTML for static distribution bundle build -->
36	<!DOCTYPE html>
37	<html lang="en">
38	    <head>
39	        <meta charset="UTF-8">
40	        <meta name="viewport" content="width=device-width, initial-scale=1" />
41	        <meta name="description" content="SwaggerUI"/>
42	        <title>SwaggerUI</title>
43	        <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@5.11.0/swagger-ui.css" />
44	        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%221em%22 font-size=%2280%22>ðŸ“„</text></svg>">
45	    </head>
46	
47	    <body>
48	        <div id="swagger-ui"></div>
49	
50	        <script src="https://unpkg.com/swagger-ui-dist@5.11.0/swagger-ui-bundle.js" crossorigin></script>
51	        <script src="https://unpkg.com/swagger-ui-dist@5.11.0/swagger-ui-standalone-preset.js" crossorigin></script>
52	        <script>
53	        window.onload = function() {{
54	        var full = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '');
55	        // Begin Swagger UI call region
56	        const ui = SwaggerUIBundle({{
57	            url: "{spec_url}",
58	            dom_id: '#swagger-ui',
59	            presets: [
60	                SwaggerUIBundle.presets.apis,
61	                SwaggerUIStandalonePreset
62	            ],
63	            layout: "StandaloneLayout",
64	            oauth2RedirectUrl: full + "/{spec_path}/swagger/oauth2-redirect.html",
65	        }});
66	        ui.initOAuth({{
67	            clientId: "{client_id}",
68	            clientSecret: "{client_secret}",
69	            realm: "{realm}",
70	            appName: "{app_name}",
71	            scopeSeparator: "{scope_separator}",
72	            additionalQueryStringParams: {additional_query_string_params},
73	            useBasicAuthenticationWithAccessCodeGrant: {use_basic_authentication_with_access_code_grant},
74	            usePkceWithAuthorizationCodeGrant: {use_pkce_with_authorization_code_grant},
75	        }});
76	        // End Swagger UI call region
77	
78	        window.ui = ui;
79	        }}
80	    </script>
81	    </body>
82	</html>""",
83	    "swagger/oauth2-redirect.html": """
84	<!DOCTYPE html>
85	<html lang="en-US">
86	<head>
87	    <title>Swagger UI: OAuth2 Redirect</title>
88	</head>
89	<body>
90	<script>
91	    'use strict';
92	    function run () {{
93	        var oauth2 = window.opener.swaggerUIRedirectOauth2;
94	        var sentState = oauth2.state;
95	        var redirectUrl = oauth2.redirectUrl;
96	        var isValid, qp, arr;
97	
98	        if (/code|token|error/.test(window.location.hash)) {{
99	            qp = window.location.hash.substring(1);
100	        }} else {{
101	            qp = location.search.substring(1);
102	        }}
103	
104	        arr = qp.split("&");
105	        arr.forEach(function (v,i,_arr) {{ _arr[i] = '"' + v.replace('=', '":"') + '"';}});
106	        qp = qp ? JSON.parse('{{' + arr.join() + '}}',
107	                function (key, value) {{
108	                    return key === "" ? value : decodeURIComponent(value);
109	                }}
110	        ) : {{}};
111	
112	        isValid = qp.state === sentState;
113	
114	        if ((
115	          oauth2.auth.schema.get("flow") === "accessCode" ||
116	          oauth2.auth.schema.get("flow") === "authorizationCode" ||
117	          oauth2.auth.schema.get("flow") === "authorization_code"
118	        ) && !oauth2.auth.code) {{
119	            if (!isValid) {{
120	                oauth2.errCb({{
121	                    authId: oauth2.auth.name,
122	                    source: "auth",
123	                    level: "warning",
124	                    message: "Authorization may be unsafe, passed state was changed in server Passed state wasn't returned from auth server"
125	                }});
126	            }}
127	
128	            if (qp.code) {{
129	                delete oauth2.state;
130	                oauth2.auth.code = qp.code;
131	                oauth2.callback({{auth: oauth2.auth, redirectUrl: redirectUrl}});
132	            }} else {{
133	                let oauthErrorMsg;
134	                if (qp.error) {{
135	                    oauthErrorMsg = "["+qp.error+"]: " +
136	                        (qp.error_description ? qp.error_description+ ". " : "no accessCode received from the server. ") +
137	                        (qp.error_uri ? "More info: "+qp.error_uri : "");
138	                }}
139	
140	                oauth2.errCb({{
141	                    authId: oauth2.auth.name,
142	                    source: "auth",
143	                    level: "error",
144	                    message: oauthErrorMsg || "[Authorization failed]: no accessCode received from the server"
145	                }});
146	            }}
147	        }} else {{
148	            oauth2.callback({{auth: oauth2.auth, token: qp, isValid: isValid, redirectUrl: redirectUrl}});
149	        }}
150	        window.close();
151	    }}
152	
153	    window.addEventListener('DOMContentLoaded', function () {{
154	      run();
155	    }});
156	</script>
157	</body>
158	</html>""",
159	    "scalar": """
160	<!doctype html>
161	<html>
162	  <head>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/spectree/page.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    # https://swagger.io
34	    "swagger": """
35	<!-- HTML for static distribution bundle build -->
36	<!DOCTYPE html>
37	<html lang="en">
38	    <head>
39	        <meta charset="UTF-8">
40	        <meta name="viewport" content="width=device-width, initial-scale=1" />
41	        <meta name="description" content="SwaggerUI"/>
42	        <title>SwaggerUI</title>
43	        <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@5.11.0/swagger-ui.css" />
44	        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%221em%22 font-size=%2280%22>ðŸ“„</text></svg>">
45	    </head>
46	
47	    <body>
48	        <div id="swagger-ui"></div>
49	
50	        <script src="https://unpkg.com/swagger-ui-dist@5.11.0/swagger-ui-bundle.js" crossorigin></script>
51	        <script src="https://unpkg.com/swagger-ui-dist@5.11.0/swagger-ui-standalone-preset.js" crossorigin></script>
52	        <script>
53	        window.onload = function() {{
54	        var full = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '');
55	        // Begin Swagger UI call region
56	        const ui = SwaggerUIBundle({{
57	            url: "{spec_url}",
58	            dom_id: '#swagger-ui',
59	            presets: [
60	                SwaggerUIBundle.presets.apis,
61	                SwaggerUIStandalonePreset
62	            ],
63	            layout: "StandaloneLayout",
64	            oauth2RedirectUrl: full + "/{spec_path}/swagger/oauth2-redirect.html",
65	        }});
66	        ui.initOAuth({{
67	            clientId: "{client_id}",
68	            clientSecret: "{client_secret}",
69	            realm: "{realm}",
70	            appName: "{app_name}",
71	            scopeSeparator: "{scope_separator}",
72	            additionalQueryStringParams: {additional_query_string_params},
73	            useBasicAuthenticationWithAccessCodeGrant: {use_basic_authentication_with_access_code_grant},
74	            usePkceWithAuthorizationCodeGrant: {use_pkce_with_authorization_code_grant},
75	        }});
76	        // End Swagger UI call region
77	
78	        window.ui = ui;
79	        }}
80	    </script>
81	    </body>
82	</html>""",
83	    "swagger/oauth2-redirect.html": """
84	<!DOCTYPE html>
85	<html lang="en-US">
86	<head>
87	    <title>Swagger UI: OAuth2 Redirect</title>
88	</head>
89	<body>
90	<script>
91	    'use strict';
92	    function run () {{
93	        var oauth2 = window.opener.swaggerUIRedirectOauth2;
94	        var sentState = oauth2.state;
95	        var redirectUrl = oauth2.redirectUrl;
96	        var isValid, qp, arr;
97	
98	        if (/code|token|error/.test(window.location.hash)) {{
99	            qp = window.location.hash.substring(1);
100	        }} else {{
101	            qp = location.search.substring(1);
102	        }}
103	
104	        arr = qp.split("&");
105	        arr.forEach(function (v,i,_arr) {{ _arr[i] = '"' + v.replace('=', '":"') + '"';}});
106	        qp = qp ? JSON.parse('{{' + arr.join() + '}}',
107	                function (key, value) {{
108	                    return key === "" ? value : decodeURIComponent(value);
109	                }}
110	        ) : {{}};
111	
112	        isValid = qp.state === sentState;
113	
114	        if ((
115	          oauth2.auth.schema.get("flow") === "accessCode" ||
116	          oauth2.auth.schema.get("flow") === "authorizationCode" ||
117	          oauth2.auth.schema.get("flow") === "authorization_code"
118	        ) && !oauth2.auth.code) {{
119	            if (!isValid) {{
120	                oauth2.errCb({{
121	                    authId: oauth2.auth.name,
122	                    source: "auth",
123	                    level: "warning",
124	                    message: "Authorization may be unsafe, passed state was changed in server Passed state wasn't returned from auth server"
125	                }});
126	            }}
127	
128	            if (qp.code) {{
129	                delete oauth2.state;
130	                oauth2.auth.code = qp.code;
131	                oauth2.callback({{auth: oauth2.auth, redirectUrl: redirectUrl}});
132	            }} else {{
133	                let oauthErrorMsg;
134	                if (qp.error) {{
135	                    oauthErrorMsg = "["+qp.error+"]: " +
136	                        (qp.error_description ? qp.error_description+ ". " : "no accessCode received from the server. ") +
137	                        (qp.error_uri ? "More info: "+qp.error_uri : "");
138	                }}
139	
140	                oauth2.errCb({{
141	                    authId: oauth2.auth.name,
142	                    source: "auth",
143	                    level: "error",
144	                    message: oauthErrorMsg || "[Authorization failed]: no accessCode received from the server"
145	                }});
146	            }}
147	        }} else {{
148	            oauth2.callback({{auth: oauth2.auth, token: qp, isValid: isValid, redirectUrl: redirectUrl}});
149	        }}
150	        window.close();
151	    }}
152	
153	    window.addEventListener('DOMContentLoaded', function () {{
154	      run();
155	    }});
156	</script>
157	</body>
158	</html>""",
159	    "scalar": """
160	<!doctype html>
161	<html>
162	  <head>
163	    <title>API Reference</title>
164	    <meta charset="utf-8" />
165	    <meta
166	      name="viewport"
167	      content="width=device-width, initial-scale=1" />
168	    <style>
169	      body {{
170	        margin: 0;
171	      }}
172	    </style>
173	    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%221em%22 font-size=%2280%22>ðŸ“„</text></svg>">
174	  </head>
175	  <body>
176	    <script
177	      id="api-reference"
178	      data-url="{spec_url}">
179	    </script>
180	    <script>
181	      var configuration = {{
182	        theme: 'purple',
183	      }}
184	
185	      var apiReference = document.getElementById('api-reference')
186	      apiReference.dataset.configuration = JSON.stringify(configuration)
187	    </script>
188	    <script src="https://cdn.jsdelivr.net/npm/@scalar/api-reference"></script>
189	  </body>
190	</html>""",
191	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/spectree/page.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	</html>""",
159	    "scalar": """
160	<!doctype html>
161	<html>
162	  <head>
163	    <title>API Reference</title>
164	    <meta charset="utf-8" />
165	    <meta
166	      name="viewport"
167	      content="width=device-width, initial-scale=1" />
168	    <style>
169	      body {{
170	        margin: 0;
171	      }}
172	    </style>
173	    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%221em%22 font-size=%2280%22>ðŸ“„</text></svg>">
174	  </head>
175	  <body>
176	    <script
177	      id="api-reference"
178	      data-url="{spec_url}">
179	    </script>
180	    <script>
181	      var configuration = {{
182	        theme: 'purple',
183	      }}
184	
185	      var apiReference = document.getElementById('api-reference')
186	      apiReference.dataset.configuration = JSON.stringify(configuration)
187	    </script>
188	    <script src="https://cdn.jsdelivr.net/npm/@scalar/api-reference"></script>
189	  </body>
190	</html>""",
191	}
192	
193	try:
194	    from offapi import OpenAPITemplate
195	
196	    PAGE_TEMPLATES = {
197	        "redoc": OpenAPITemplate.REDOC.value,
198	        "swagger": OpenAPITemplate.SWAGGER.value,
199	        "scalar": OpenAPITemplate.SCALAR.value,
200	    }
201	except ImportError:
202	    PAGE_TEMPLATES = ONLINE_PAGE_TEMPLATES

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/spectree/plugins/starlette_plugin.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	        has_data = request.method not in ("GET", "DELETE")
74	        content_type = request.headers.get("content-type", "").lower()
75	        use_json = json and has_data and content_type == "application/json"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/spectree/plugins/starlette_plugin.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	            for name in ("query", "json", "form", "headers", "cookies"):
140	                if annotations.get(name):
141	                    kwargs[name] = getattr(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/spectree/plugins/starlette_plugin.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	            description = (
252	                path_parameter_descriptions.get(name, "")
253	                if path_parameter_descriptions

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/tests/test_config.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    config = Configuration(
18	        license={"name": "MIT", "url": "https://opensource.org/licenses/MIT"}
19	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/tests/test_config.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    assert config.license.name == "MIT"
21	    assert config.license.url == "https://opensource.org/licenses/MIT"
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/tests/test_config.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	
31	    config = Configuration(contact={"name": "John", "url": "https://example.com"})
32	    assert config.contact.name == "John"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/tests/test_config.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    assert config.contact.name == "John"
33	    assert config.contact.url == "https://example.com"
34	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/tests/test_spec.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	def test_spec_servers_only(name, app):
69	    server1_url = "http://foo/bar"
70	    server2_url = "/foo/bar/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/tests/test_spec.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	def test_spec_servers_full(name, app):
83	    server1 = {"url": "http://foo/bar", "description": "Foo Bar"}
84	    server2 = {"url": "http://bar/foo/{lang}", "variables": {"lang": "en"}}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/spectree-1.4.6/spectree-1.4.6/tests/test_spec.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	    server1 = {"url": "http://foo/bar", "description": "Foo Bar"}
84	    server2 = {"url": "http://bar/foo/{lang}", "variables": {"lang": "en"}}
85	    spec = _get_spec(

--------------------------------------------------

Code scanned:
	Total lines of code: 6101
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 3.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 0.0
Files skipped (0):
