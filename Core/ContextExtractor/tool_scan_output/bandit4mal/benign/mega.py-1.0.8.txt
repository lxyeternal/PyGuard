Run started:2025-04-12 19:24:17.312467

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
14	with open('requirements.txt') as f:
15	    install_requires = f.read().splitlines()
16	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
17	with open('README.md', 'r', encoding='utf-8') as rm_file:
18	    readme = rm_file.read()
19	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/setup.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	with open('HISTORY.md', 'r', encoding='utf-8') as hist_file:
21	    history = hist_file.read()
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/setup.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	      zip_safe=False,
29	      url='https://github.com/odwyersoftware/mega.py',
30	      description='Python lib for the Mega.co.nz API',

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/crypto.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
132	        data = data.replace(search, replace)
133	    return base64.b64decode(data)
134	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/crypto.py:133
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
132	        data = data.replace(search, replace)
133	    return base64.b64decode(data)
134	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/crypto.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
140	def base64_url_encode(data):
141	    data = base64.b64encode(data)
142	    data = makestring(data)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/crypto.py:141
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
140	def base64_url_encode(data):
141	    data = base64.b64encode(data)
142	    data = makestring(data)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
55	        email = email.lower()
56	        get_user_salt_resp = self._api_request({'a': 'us0', 'user': email})
57	        user_salt = None

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
72	            user_hash = base64_url_encode(pbkdf2_key[-16:])
73	        resp = self._api_request({'a': 'us', 'user': email, 'uh': user_hash})
74	        if isinstance(resp, int):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
83	
84	        user = self._api_request({
85	            'a':
86	            'up',
87	            'k':
88	            a32_to_base64(encrypt_key(master_key, password_key)),
89	            'ts':
90	            base64_url_encode(
91	                a32_to_str(session_self_challenge) +
92	                a32_to_str(encrypt_key(session_self_challenge, master_key)))
93	        })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
94	
95	        resp = self._api_request({'a': 'us', 'user': user})
96	        if isinstance(resp, int):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
165	        url = f'{self.schema}://g.api.{self.domain}/cs'
166	        response = requests.post(
167	            url,
168	            params=params,
169	            data=json.dumps(data),
170	            timeout=self.timeout,
171	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
233	                        break
234	            if file['h'] and file['h'] in shared_keys.get('EXP', ()):
235	                shared_key = shared_keys['EXP'][file['h']]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
349	        logger.info('Getting all files...')
350	        files = self._api_request({'a': 'f', 'c': 1, 'r': 1})
351	        files_dict = {}

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
367	            file = file['f'][0]
368	            public_handle = self._api_request({'a': 'l', 'n': file['h']})
369	            file_key = file['k'][file['k'].index(':') + 1:]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
383	        if 'h' in file and 'k' in file:
384	            public_handle = self._api_request({'a': 'l', 'n': file['h']})
385	            if public_handle == -11:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
405	        if 'h' in file and 'k' in file:
406	            public_handle = self._api_request({'a': 'l', 'n': file['h']})
407	            if public_handle == -11:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
416	    def get_user(self):
417	        user_data = self._api_request({'a': 'ug'})
418	        return user_data

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
443	
444	        files = self._api_request({'a': 'f', 'c': 1})
445	        files_dict = {}

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
455	        # get node data
456	        node_data = self._api_request({'a': 'f', 'f': 1, 'p': public_handle})
457	        node_id = self.get_id_from_obj(node_data)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
474	        """
475	        json_resp = self._api_request({
476	            'a': 'uq',
477	            'xfer': 1,
478	            'strg': 1,
479	            'v': 1
480	        })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
500	            unit_coef = 1073741824
501	        json_resp = self._api_request({'a': 'uq', 'xfer': 1, 'strg': 1})
502	        return {

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
510	        """
511	        user_data = self._api_request({"a": "uq", "pro": 1})
512	        if 'balance' in user_data:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
533	        """
534	        return self._api_request({
535	            'a': 'd',
536	            'n': file_id,
537	            'i': self.request_id
538	        })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
557	                post_list.append({"a": "d", "n": file, "i": self.request_id})
558	            return self._api_request(post_list)
559	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
572	        node_data = self._node_data(node)
573	        self._api_request([{
574	            'a': 'l',
575	            'n': node_data['h'],
576	            'i': self.request_id
577	        }])

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
628	        }]
629	        self._api_request(request_body)
630	        nodes = self.get_files()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
657	                file_key = base64_to_a32(file_key)
658	                file_data = self._api_request({
659	                    'a': 'g',
660	                    'g': 1,
661	                    'p': file_handle
662	                })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
663	            else:
664	                file_data = self._api_request({
665	                    'a': 'g',
666	                    'g': 1,
667	                    'n': file_handle
668	                })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
674	        else:
675	            file_data = self._api_request({'a': 'g', 'g': 1, 'n': file['h']})
676	            k = file['k']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
694	
695	        input_file = requests.get(file_url, stream=True).raw
696	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
715	            for chunk_start, chunk_size in get_chunks(file_size):
716	                chunk = input_file.read(chunk_size)
717	                chunk = aes.decrypt(chunk)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
717	                chunk = aes.decrypt(chunk)
718	                temp_output_file.write(chunk)
719	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
717	                chunk = aes.decrypt(chunk)
718	                temp_output_file.write(chunk)
719	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
758	            file_size = os.path.getsize(filename)
759	            ul_url = self._api_request({'a': 'u', 's': file_size})['p']
760	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
776	                for chunk_start, chunk_size in get_chunks(file_size):
777	                    chunk = input_file.read(chunk_size)
778	                    upload_progress += len(chunk)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
797	                    chunk = aes.encrypt(chunk)
798	                    output_file = requests.post(ul_url + "/" +
799	                                                str(chunk_start),
800	                                                data=chunk,
801	                                                timeout=self.timeout)
802	                    completion_file_handle = output_file.text

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
805	            else:
806	                output_file = requests.post(ul_url + "/0",
807	                                            data='',
808	                                            timeout=self.timeout)
809	                completion_file_handle = output_file.text

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
831	            # update attributes
832	            data = self._api_request({
833	                'a':
834	                'p',
835	                't':
836	                dest,
837	                'i':
838	                self.request_id,
839	                'n': [{
840	                    'h': completion_file_handle,
841	                    't': 0,
842	                    'a': encrypt_attribs,
843	                    'k': encrypted_key
844	                }]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
858	        # update attributes
859	        data = self._api_request({
860	            'a':
861	            'p',
862	            't':
863	            parent_node_id,
864	            'n': [{
865	                'h': 'xxxxxxxx',
866	                't': 1,
867	                'a': encrypt_attribs,
868	                'k': encrypted_key
869	            }],
870	            'i':
871	            self.request_id
872	        })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
909	        # update attributes
910	        return self._api_request([{
911	            'a': 'a',
912	            'attr': encrypt_attribs,
913	            'key': encrypted_key,
914	            'n': file['h'],
915	            'i': self.request_id
916	        }])

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
945	            target_node_id = file['h']
946	        return self._api_request({
947	            'a': 'm',
948	            'n': file_id,
949	            't': target_node_id,
950	            'i': self.request_id
951	        })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
978	        else:
979	            return self._api_request({
980	                'a': 'ur',
981	                'u': email,
982	                'l': l,
983	                'i': self.request_id
984	            })

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:1007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1006	        """
1007	        data = self._api_request({'a': 'g', 'p': file_handle, 'ssm': 1})
1008	        if isinstance(data, int):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mega.py-1.0.8/mega.py-1.0.8/src/mega/mega.py:1049
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1048	        encrypted_name = base64_url_encode(encrypt_attr({'n': dest_name}, k))
1049	        return self._api_request({
1050	            'a':
1051	            'p',
1052	            't':
1053	            dest_node['h'],
1054	            'n': [{
1055	                'ph': file_handle,
1056	                't': 0,
1057	                'a': encrypted_name,
1058	                'k': encrypted_key
1059	            }]

--------------------------------------------------

Code scanned:
	Total lines of code: 1114
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 43.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 44.0
		High: 2.0
Files skipped (0):
