Run started:2025-04-12 13:56:00.177957

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/executions.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
56	        with open("/etc/hostname", "r") as f:
57	            pod_name = f.read().strip()
58	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
5	
6	NUCLEUS_URL = os.environ.get("LATCH_CLI_NUCLEUS_URL", "https://nucleus.latch.bio")
7	ADD_MESSAGE_ENDPOINT = f"{NUCLEUS_URL}/sdk/add-task-execution-message"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	
6	NUCLEUS_URL = os.environ.get("LATCH_CLI_NUCLEUS_URL", "https://nucleus.latch.bio")
7	ADD_MESSAGE_ENDPOINT = f"{NUCLEUS_URL}/sdk/add-task-execution-message"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    """
44	    task_project = os.environ.get("FLYTE_INTERNAL_TASK_PROJECT")
45	    task_domain = os.environ.get("FLYTE_INTERNAL_TASK_DOMAIN")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	    task_project = os.environ.get("FLYTE_INTERNAL_TASK_PROJECT")
45	    task_domain = os.environ.get("FLYTE_INTERNAL_TASK_DOMAIN")
46	    task_name = os.environ.get("FLYTE_INTERNAL_TASK_NAME")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	    task_domain = os.environ.get("FLYTE_INTERNAL_TASK_DOMAIN")
46	    task_name = os.environ.get("FLYTE_INTERNAL_TASK_NAME")
47	    task_version = os.environ.get("FLYTE_INTERNAL_TASK_VERSION")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	    task_name = os.environ.get("FLYTE_INTERNAL_TASK_NAME")
47	    task_version = os.environ.get("FLYTE_INTERNAL_TASK_VERSION")
48	    task_attempt_number = os.environ.get("FLYTE_ATTEMPT_NUMBER")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	    task_version = os.environ.get("FLYTE_INTERNAL_TASK_VERSION")
48	    task_attempt_number = os.environ.get("FLYTE_ATTEMPT_NUMBER")
49	    execution_token = os.environ.get("FLYTE_INTERNAL_EXECUTION_ID")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	    task_attempt_number = os.environ.get("FLYTE_ATTEMPT_NUMBER")
49	    execution_token = os.environ.get("FLYTE_INTERNAL_EXECUTION_ID")
50	    array_index = os.environ.get("FLYTE_K8S_ARRAY_INDEX")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    execution_token = os.environ.get("FLYTE_INTERNAL_EXECUTION_ID")
50	    array_index = os.environ.get("FLYTE_K8S_ARRAY_INDEX")
51	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/messages.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
55	
56	    response = requests.post(
57	        url=ADD_MESSAGE_ENDPOINT,
58	        json={
59	            "execution_token": execution_token,
60	            "task": {
61	                "project": task_project,
62	                "domain": task_domain,
63	                "name": task_name,
64	                "version": task_version,
65	            },
66	            "task_attempt_number": task_attempt_number,
67	            "task_array_index": array_index,
68	            "type": typ,
69	            "data": data,
70	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/functions/secrets.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
24	
25	    resp = post(
26	        url=urljoin(NUCLEUS_URL, "/secrets/get-new"),
27	        json={
28	            "name": secret_name,
29	            "ws_id": current_workspace(),
30	        },
31	        headers={"Authorization": get_auth_header()},
32	    )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/download.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
167	                # todo(ayush): benchmark this against asyncio
168	                with ProcessPoolExecutor(max_workers=get_max_workers()) as executor:
169	                    total_bytes = sum(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/download.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
231	                ):  # todo(ayush): figure out why chunk_size = None breaks in pods
232	                    f.write(data)
233	                    progress_bars.update(pbar_index, len(data))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/download.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
236	                progress_bars.update_total_progress(1)
237	                progress_bars.write(
238	                    f"Downloaded {job.dest.name} ({with_si_suffix(int(total_bytes))})"
239	                    f" in {human_readable_time(end - start)}"
240	                )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/upload.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
108	
109	    with ProcessPoolExecutor(max_workers=cores) as exec:
110	        with TransferStateManager() as man:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/upload.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
250	                    start = time.monotonic()
251	                    res = start_upload(
252	                        src_path, normalized, chunk_size_mib=chunk_size_mib
253	                    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/upload.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
278	
279	                        end_upload(
280	                            normalized,
281	                            res.upload_id,
282	                            [fut.result() for fut in chunk_futs],
283	                        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/upload.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
318	        with open(resolved, "rb") as f:
319	            sample = f.read(Units.KiB)
320	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/upload.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
407	            f.seek(part_size * part_index)
408	            data = f.read(part_size)
409	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/upload.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
437	                progress_bars.update_total_progress(1)
438	                progress_bars.write(f"Copied {src}")
439	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/_transfer/upload.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
444	                ):
445	                    end_upload(
446	                        dest=dest,
447	                        upload_id=upload_id,
448	                        parts=list(parts_by_source[src]),
449	                    )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch/ldata/path.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
334	            tmp_dir.mkdir(parents=True, exist_ok=True)
335	            atexit.register(lambda p: shutil.rmtree(p), tmp_dir)
336	            name = self.name()

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/auth/oauth2.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
147	        server_name = ("", 5050)
148	        server = http.server.HTTPServer(server_name, _CallbackHandler)
149	        server.authorized = False

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/auth/oauth2.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
151	        while not server.authorized:
152	            server.handle_request()
153	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/auth/oauth2.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
177	        token_request.add_header("Content-Type", "application/json")
178	        with urllib.request.urlopen(
179	            token_request, context=ssl.create_default_context(cafile=certifi.where())
180	        ) as f:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/auth/oauth2.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
181	            try:
182	                json_response = json.loads(f.read().decode("utf-8"))
183	                id_token = json_response["id_token"]

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/auth/utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
24	    # Padding must be stripped as specified in RFC.
25	    return base64.urlsafe_b64encode(bytestring).decode("utf-8").replace("=", "")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
315	
316	                            system = platform.system()
317	                            if system in {

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:316
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
315	
316	                            system = platform.system()
317	                            if system in {

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
338	
339	                                    res = os.system(str(new_meta.resolve()))
340	                                else:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
338	
339	                                    res = os.system(str(new_meta.resolve()))
340	                                else:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:339
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
338	
339	                                    res = os.system(str(new_meta.resolve()))
340	                                else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
493	            raise ValueError(
494	                f"{self.version} is an invalid version for AWS "
495	                "ECR. Please provide a version that accomodates the "

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
529	
530	        response = tinyrequests.post(
531	            self.latch_provision_url,
532	            headers=headers,
533	            json={"public_key": self.public_key},
534	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
553	
554	        resp = tinyrequests.post(
555	            "https://centromere.latch.bio/register/start",
556	            headers={"Authorization": f"Latch-SDK-Token {self.token}"},
557	            json={"SSHKey": self.ssh_key_path.with_suffix(".pub").read_text()},
558	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
554	        resp = tinyrequests.post(
555	            "https://centromere.latch.bio/register/start",
556	            headers={"Authorization": f"Latch-SDK-Token {self.token}"},
557	            json={"SSHKey": self.ssh_key_path.with_suffix(".pub").read_text()},
558	        )
559	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
565	        self.jump_key_path.write_text(json_data["JumpKey"])
566	        self.jump_key_path.chmod(0o600)
567	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
575	
576	        resp = tinyrequests.post(
577	            "https://centromere.latch.bio/register/stop",
578	            headers={"Authorization": f"Latch-SDK-Token {self.token}"},
579	            json={"InternalHostName": self.centromere_hostname},
580	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
576	        resp = tinyrequests.post(
577	            "https://centromere.latch.bio/register/stop",
578	            headers={"Authorization": f"Latch-SDK-Token {self.token}"},
579	            json={"InternalHostName": self.centromere_hostname},
580	        )
581	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
588	        headers = {"Authorization": f"Bearer {self.token}"}
589	        response = tinyrequests.post(
590	            self.latch_get_image_url, headers=headers, json={"task_name": task_name}
591	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
609	
610	        response = tinyrequests.post(
611	            self.latch_check_version_url,
612	            headers=headers,
613	            json={
614	                "version": version,
615	                "workflow_name": workflow_name,
616	                "ws_account_id": ws_id,
617	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/click_utils.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	        formatter.write_text(
49	            style("See " + style("https://docs.latch.bio/", underline=True), dim=True)
50	            + style(" for manuals, tutorials, examples, and an API reference", dim=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/constants.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	
59	    authz_server_host: str = "https://latchai.us.auth0.com"
60	    """Host of the authentication server used in 0Auth2.0 flow."""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/constants.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	
62	    redirect_url: str = "http://127.0.0.1:5050/callback"
63	    """Redirect URL registered with authentication server."""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/docker_utils/__init__.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
156	                commands=[
157	                    dedent(r"""
158	                            run \

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/docker_utils/__init__.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	                commands=[
210	                    dedent(r"""
211	                    run apt-get update --yes && \

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/exceptions/handler.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
82	
83	        with tarfile.open(tarball_path, mode="x:gz") as tf:
84	            # If calling stack frame is handling an exception, we want to store

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/main.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	            click.secho(
45	                dedent("""
46	                Unable to authenticate with Latch.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/main.py:979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
978	    with open(pkg_root / ".latch" / "nextflow_version", "r") as f:
979	        version = f.read().strip()
980	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/menus.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	    res = b""
114	    sys.stdout.write("\x1b[6n")
115	    sys.stdout.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/menus.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	    while not res.endswith(b"R"):
117	        res += sys.stdin.buffer.read(1)
118	    y, x = res.strip(b"\x1b[R").split(b";")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/menus.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
176	def read_next_byte() -> bytes:
177	    b = sys.stdin.buffer.read(1)
178	    if b in (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/nextflow/workflow.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	template = """\
21	import sys
22	from dataclasses import dataclass
23	from enum import Enum
24	import os
25	import subprocess
26	import requests
27	import shutil
28	from pathlib import Path
29	import typing
30	import typing_extensions
31	
32	from latch.resources.workflow import workflow
33	from latch.resources.tasks import nextflow_runtime_task, custom_task
34	from latch.types.file import LatchFile
35	from latch.types.directory import LatchDir, LatchOutputDir
36	from latch.ldata.path import LPath
37	from latch.executions import report_nextflow_used_storage
38	from latch_cli.nextflow.workflow import get_flag
39	from latch_cli.nextflow.utils import _get_execution_name
40	from latch_cli.utils import urljoins
41	from latch.types import metadata
42	from flytekit.core.annotation import FlyteAnnotation
43	
44	from latch_cli.services.register.utils import import_module_by_path
45	
46	meta = Path("{metadata_root}") / "__init__.py"
47	import_module_by_path(meta)
48	import latch_metadata
49	
50	@custom_task(cpu=0.25, memory=0.5, storage_gib=1)
51	def initialize() -> str:
52	    token = os.environ.get("FLYTE_INTERNAL_EXECUTION_ID")
53	    if token is None:
54	        raise RuntimeError("failed to get execution token")
55	
56	    headers = {{"Authorization": f"Latch-Execution-Token {{token}}"}}
57	
58	    print("Provisioning shared storage volume... ", end="")
59	    resp = requests.post(
60	        "http://nf-dispatcher-service.flyte.svc.cluster.local/provision-storage-ofs",
61	        headers=headers,
62	        json={{
63	            "storage_expiration_hours": {storage_expiration_hours},
64	            "version": {nextflow_version},
65	        }},
66	    )
67	    resp.raise_for_status()
68	    print("Done.")
69	
70	    return resp.json()["name"]
71	
72	
73	{preambles}
74	
75	{samplesheet_funs}
76	
77	@nextflow_runtime_task(cpu={cpu}, memory={memory}, storage_gib={storage_gib})
78	def nextflow_runtime(pvc_name: str, {param_signature}) -> None:
79	    shared_dir = Path("/nf-workdir")
80	
81	    exec_name = _get_execution_name()
82	    if exec_name is None:
83	        print("Failed to get execution name.")
84	        exec_name = "unknown"
85	
86	    latch_log_dir = urljoins("{log_dir}", exec_name)
87	    print(f"Log directory: {{latch_log_dir}}")
88	
89	{output_shortcuts}
90	{samplesheet_constructors}
91	
92	    ignore_list = [
93	        "latch",
94	        ".latch",
95	        ".git",
96	        "nextflow",
97	        ".nextflow",
98	        "work",
99	        "results",
100	        "miniconda",
101	        "anaconda3",
102	        "mambaforge",
103	    ]
104	
105	    shutil.copytree(
106	        Path("/root"),
107	        shared_dir,
108	        ignore=lambda src, names: ignore_list,
109	        ignore_dangling_symlinks=True,
110	        dirs_exist_ok=True,
111	    )
112	
113	    profile_list = {execution_profile}
114	    if {configurable_profiles}:
115	        profile_list.extend([p.value for p in execution_profiles])
116	
117	    if len(profile_list) == 0:
118	        profile_list.append("standard")
119	
120	    profiles = ','.join(profile_list)
121	
122	    cmd = [
123	        "/root/nextflow",
124	        "run",
125	        str(shared_dir / "{nf_script}"),
126	        "-work-dir",
127	        str(shared_dir),
128	        "-profile",
129	        profiles,
130	        "-c",
131	        "latch.config",
132	        "-resume",
133	{params_to_flags}
134	    ]
135	
136	    print("Launching Nextflow Runtime")
137	    print(' '.join(cmd))
138	    print(flush=True)
139	
140	    failed = False
141	    try:
142	        env = {{
143	            **os.environ,
144	            "NXF_ANSI_LOG": "false",
145	            "NXF_HOME": "/root/.nextflow",
146	            "NXF_OPTS": "-Xms{heap_initial}M -Xmx{heap_max}M -XX:ActiveProcessorCount={cpu}",
147	            "NXF_DISABLE_CHECK_LATEST": "true",
148	            "NXF_ENABLE_VIRTUAL_THREADS": "false",
149	            "NXF_ENABLE_FS_SYNC": "true",
150	        }}
151	
152	        if {upload_command_logs}:
153	            env["LATCH_LOG_DIR"] = latch_log_dir
154	
155	        subprocess.run(
156	            cmd,
157	            env=env,
158	            check=True,
159	            cwd=str(shared_dir),
160	        )
161	    except subprocess.CalledProcessError:
162	        failed = True
163	    finally:
164	        print()
165	
166	        nextflow_log = shared_dir / ".nextflow.log"
167	        if nextflow_log.exists():
168	            remote = LPath(urljoins(latch_log_dir, "nextflow.log"))
169	            print(f"Uploading .nextflow.log to {{remote.path}}")
170	            remote.upload_from(nextflow_log)
171	
172	        print("Computing size of workdir... ", end="")
173	        try:
174	            result = subprocess.run(
175	                ['du', '-sb', str(shared_dir)],
176	                check=True,
177	                stdout=subprocess.PIPE,
178	                stderr=subprocess.PIPE,
179	                text=True,
180	                timeout=5 * 60
181	            )
182	
183	            size = int(result.stdout.split()[0])
184	            report_nextflow_used_storage(size)
185	            print(f"Done. Workdir size: {{size / 1024 / 1024 / 1024: .2f}} GiB")
186	        except subprocess.TimeoutExpired:
187	            print("Failed to compute storage size: Operation timed out after 5 minutes.")
188	        except subprocess.CalledProcessError as e:
189	            print(f"Failed to compute storage size: {{e.stderr}}")
190	        except Exception as e:
191	            print(f"Failed to compute storage size: {{e}}")
192	
193	    if failed:
194	        sys.exit(1)
195	
196	
197	@workflow(metadata._nextflow_metadata)
198	def {workflow_func_name}({param_signature_with_defaults}) -> None:
199	    \"\"\"
200	{docstring}
201	    \"\"\"
202	
203	    pvc_name: str = initialize()
204	    nextflow_runtime(pvc_name=pvc_name, {param_args})
205	
206	"""
207	
208	
209	def _get_flags_for_dataclass(name: str, val: Any) -> List[str]:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/get.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
33	    token = retrieve_or_login()
34	    return _list_workflow_request(token, wf_name)
35	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/get.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
50	    url = config.api.workflow.list
51	    response = requests.post(url, headers=headers, json=data)
52	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/get.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	    wf_interface_resp = response.json()
54	    return wf_interface_resp.get("wfs", [])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/get_executions.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
32	
33	    resp = post(
34	        url=config.api.execution.list,
35	        headers=headers,
36	        json={"ws_account_id": context},
37	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/get_executions.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
162	                selected_execution_data = options[curr_selected]
163	                resp = post(
164	                    config.api.workflow.graph,
165	                    headers={"Authorization": f"Bearer {retrieve_or_login()}"},
166	                    json={
167	                        "workflow_id": selected_execution_data["workflow_id"],
168	                        "execution_id": selected_execution_data["id"],
169	                    },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/get_executions.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
355	    def get_logs():
356	        resp = post(
357	            config.api.execution.logs,
358	            headers={"Authorization": f"Bearer {retrieve_or_login()}"},
359	            json={
360	                "exec_id": execution_data["id"],
361	                "node_id": selected_task["node_id"],
362	                "account_id": ws_id,
363	            },

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/get_executions.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
366	        with open(log_file, "w") as f:
367	            f.write(resp.json()["message"].replace("\t", "    "))
368	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/get_executions.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
505	                headers = {"Authorization": f"Bearer {retrieve_or_login()}"}
506	                resp = post(
507	                    url=config.api.execution.abort,
508	                    headers=headers,
509	                    json={"execution_id": execution_data["id"]},
510	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/init/assemble_and_sort/__init__.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    ),
22	    repository="https://github.com/your-repo",
23	    license="MIT",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/init/example_nfcore/__init__.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    display_name="nf-core/fetchngs",
18	    documentation="https://nf-co.re/fetchngs/1.8/usage",
19	    author=LatchAuthor(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/init/init.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	            "curl",
89	            f"https://latch-public.s3.us-west-2.amazonaws.com/sdk/{bowtie2_base_name}.zip",
90	            "-o",

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/init/init.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
118	        else:
119	            shutil.rmtree(str(f))
120	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/init/init.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
190	            "curl",
191	            f"https://latch-public.s3.us-west-2.amazonaws.com/sdk/{snakemake_base_name}.zip",
192	            "-o",

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/attach.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
19	async def connect(execution_id: str, session_id: str):
20	    async with websockets.connect(
21	        urlparse(urljoin(NUCLEUS_URL, "/workflows/cli/attach-nf-workdir"))
22	        ._replace(scheme="wss")
23	        .geturl(),
24	        close_timeout=0,
25	        extra_headers={"Authorization": get_auth_header()},
26	    ) as ws:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/attach.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
28	
29	        await ws.send(json.dumps(request))
30	        data = await ws.recv()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/attach.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
29	        await ws.send(json.dumps(request))
30	        data = await ws.recv()
31	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/attach.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
67	    try:
68	        asyncio.run(connect(execution_id, session_id))
69	    except ws_exceptions.ConnectionClosedError as e:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/execute.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
23	async def connect(egn_info: EGNNode, container_info: Optional[ContainerNode]):
24	    async with websockets.connect(
25	        urlparse(urljoin(NUCLEUS_URL, "/workflows/cli/shell"))
26	        ._replace(scheme="wss")
27	        .geturl(),
28	        close_timeout=0,
29	        extra_headers={"Authorization": get_auth_header()},
30	    ) as ws:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/execute.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
37	
38	        await ws.send(json.dumps(request))
39	        data = await ws.recv()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/execute.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
38	        await ws.send(json.dumps(request))
39	        data = await ws.recv()
40	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/execute.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
75	    try:
76	        asyncio.run(connect(egn_info, container_info))
77	    finally:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/ws_utils.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	    while True:
63	        message = await reader.read(99999)
64	        if message == b"":

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/ws_utils.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
66	
67	        await ws.send(
68	            json.dumps({
69	                "stream": "stdin",
70	                "data": base64.b64encode(message).decode("ascii"),
71	            })

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/ws_utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
69	                "stream": "stdin",
70	                "data": base64.b64encode(message).decode("ascii"),
71	            })

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/ws_utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
69	                "stream": "stdin",
70	                "data": base64.b64encode(message).decode("ascii"),
71	            })

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/ws_utils.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	
88	            writer.write(base64.b64decode(res["data"].encode("ascii")))
89	        except (json.JSONDecodeError, KeyError) as e:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/ws_utils.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
87	
88	            writer.write(base64.b64decode(res["data"].encode("ascii")))
89	        except (json.JSONDecodeError, KeyError) as e:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/ws_utils.py:88
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
87	
88	            writer.write(base64.b64decode(res["data"].encode("ascii")))
89	        except (json.JSONDecodeError, KeyError) as e:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/k8s/ws_utils.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
104	
105	        await ws.send(
106	            json.dumps({
107	                "stream": "resize",
108	                "size": {
109	                    "Width": cols,
110	                    "Height": rows,
111	                },

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
51	        param_module = importlib.util.module_from_spec(spec)
52	        exec(param_code, param_module.__dict__)
53	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	
63	    wf_name = wf_params.get("_name")
64	    if wf_name is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
163	
164	    response = session.post(url, headers=headers, json=_interface_request)
165	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	    wf_id, wf_interface, wf_default_params = (
169	        wf_interface_resp.get("id"),
170	        wf_interface_resp.get("interface"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	        wf_interface_resp.get("id"),
170	        wf_interface_resp.get("interface"),
171	        wf_interface_resp.get("default_params"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170	        wf_interface_resp.get("interface"),
171	        wf_interface_resp.get("default_params"),
172	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
212	
213	    response = requests.post(url, headers=headers, json=_interface_request)
214	    response_data = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	            error = data["error"]
219	            source = error.get("source", "unknown")
220	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	
221	            error_data = error.get("data", {})
222	            message = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	            message = (
223	                error_data.get("stderr") or
224	                error_data.get("message") or

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	                error_data.get("stderr") or
224	                error_data.get("message") or
225	                str(error_data)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	        raise PermissionError(
242	            "You need access to the latch sdk beta ~ join the waitlist @"
243	            " https://latch.bio/sdk"
244	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/launch.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	        raise RuntimeError(f"Server error (HTTP {response.status_code}) - {error_msg}")
262	    if "error" in response_data or response_data.get("status") != "Successfully launched workflow":
263	        error_msg = extract_error_message(response_data)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
46	
47	    resp = post(
48	        config.api.workflow.get_latest,
49	        headers={"Authorization": f"Bearer {retrieve_or_login()}"},
50	        json={
51	            "registry_name": registry_name,
52	            "ws_account_id": current_workspace(),
53	        },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
166	
167	        resp = post(
168	            "https://centromere.latch.bio/develop/start",
169	            headers={"Authorization": f"Latch-SDK-Token {retrieve_or_login()}"},
170	            json={
171	                "ImageName": image,
172	                "Workspace": current_workspace(),
173	                "SSHKey": ssh.public_key,
174	                "Size": size.value,
175	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	        resp = post(
168	            "https://centromere.latch.bio/develop/start",
169	            headers={"Authorization": f"Latch-SDK-Token {retrieve_or_login()}"},
170	            json={
171	                "ImageName": image,
172	                "Workspace": current_workspace(),
173	                "SSHKey": ssh.public_key,
174	                "Size": size.value,
175	            },
176	        )

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
185	        jump_key_path.write_text(jump_key)
186	        jump_key_path.chmod(0o600)
187	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
200	            while poll_count < max_polls:
201	                resp = post(
202	                    "https://centromere.latch.bio/develop/ready",
203	                    headers={"Authorization": f"Latch-SDK-Token {retrieve_or_login()}"},
204	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
201	                resp = post(
202	                    "https://centromere.latch.bio/develop/ready",
203	                    headers={"Authorization": f"Latch-SDK-Token {retrieve_or_login()}"},
204	                )
205	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
235	
236	            with ProcessPoolExecutor() as exec:
237	                with SyncManager() as man:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
260	        finally:
261	            resp = post(
262	                "https://centromere.latch.bio/develop/stop",
263	                headers={"Authorization": f"Latch-SDK-Token {retrieve_or_login()}"},
264	                json={"ImageName": image},
265	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
261	            resp = post(
262	                "https://centromere.latch.bio/develop/stop",
263	                headers={"Authorization": f"Latch-SDK-Token {retrieve_or_login()}"},
264	                json={"ImageName": image},
265	            )
266	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
94	    if version is None:
95	        resp = post(
96	            config.api.workflow.get_latest,
97	            headers={"Authorization": f"Bearer {retrieve_or_login()}"},
98	            json={
99	                "registry_name": registry_name,
100	                "ws_account_id": current_workspace(),
101	            },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
116	
117	            resp = post(
118	                config.api.workflow.get_latest,
119	                headers={"Authorization": f"Bearer {retrieve_or_login()}"},
120	                json={
121	                    "registry_name": registry_name,
122	                    "ws_account_id": current_workspace(),
123	                },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	        msg = json.loads(message)
217	        if msg.get("Type") == _MessageType.exit.value:
218	            return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	            await aioconsole.aprint(
221	                msg.get("Body"),
222	                end="",

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
236	    body = {"Body": message, "Type": typ.value}
237	    await ws.send(json.dumps(body))
238	    # yield control back to the event loop,

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
272	
273	    old_sigwinch_handler = signal.getsignal(signal.SIGWINCH)
274	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
302	
303	    signal.signal(signal.SIGWINCH, new_sigwinch_handler)
304	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:303
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
302	
303	    signal.signal(signal.SIGWINCH, new_sigwinch_handler)
304	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
310	        while True:
311	            (term_width, term_height) = await resize_event_queue.get()
312	            await _send_resize_message(ws, term_width, term_height)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
315	        while True:
316	            message = await reader.read(1)
317	            await _send_message(ws, message)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
321	            obj: dict = json.loads(output)
322	            if obj.get("Type") == "exit":
323	                io_task.cancel()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
325	
326	            message = obj.get("Body")
327	            if message is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
329	                    message = message.encode("utf-8")
330	                writer.write(message)
331	            await writer.drain()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
340	        termios.tcsetattr(sys.stdin.fileno(), termios.TCSANOW, old_settings_stdin)
341	        signal.signal(signal.SIGWINCH, old_sigwinch_handler)
342	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:341
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
340	        termios.tcsetattr(sys.stdin.fileno(), termios.TCSANOW, old_settings_stdin)
341	        signal.signal(signal.SIGWINCH, old_sigwinch_handler)
342	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
359	        try:
360	            cent_resp = post(
361	                config.api.centromere.provision,
362	                headers=headers,
363	                json={"public_key": ssh.public_key},
364	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
366	
367	            init_local_dev_resp = post(
368	                config.api.centromere.start_local_dev,
369	                headers=headers,
370	                json={
371	                    "ws_account_id": current_workspace(),
372	                    "pkg_root": pkg_root.name,
373	                },

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
421	        try:
422	            async for ws in client.connect(
423	                f"ws://{centromere_ip}:{port}/ws",
424	                close_timeout=0,
425	                extra_headers=headers,
426	            ):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
465	                    await aioconsole.aprint("Exiting local development session")
466	                    await ws.close()
467	                    close_resp = post(

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/local_dev_old.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
466	                    await ws.close()
467	                    close_resp = post(
468	                        config.api.centromere.stop_local_dev,
469	                        headers={"Authorization": f"Bearer {retrieve_or_login()}"},
470	                    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/login.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
84	
85	    response = tinyrequests.post(url, headers=headers)
86	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/preview.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
63	
64	    resp = post(
65	        url=config.api.workflow.preview,
66	        headers={"Authorization": f"Bearer {retrieve_or_login()}"},
67	        json={
68	            "workflow_ui_preview": MessageToJson(wf.interface.to_flyte_idl().inputs),
69	            "ws_account_id": current_workspace(),
70	        },

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/register.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
82	            if message is not None:
83	                save_file.write(f"{message}\n")
84	                raise ValueError(message)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/register.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
88	            if error is not None:
89	                save_file.write(f"{error}\n")
90	                click.secho(f"Error when building image:\n{error}", fg="red", bold=True)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/register.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
93	            if lines is not None:
94	                save_file.write(f"{lines}\n")
95	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/register.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
617	                wf_id = wf_infos[0]["id"]
618	                url = f"https://console.latch.bio/workflows/{wf_id}"
619	                click.secho(url, fg="green")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
40	    data = {"pkg_name": ctx.image, "ws_account_id": current_workspace()}
41	    response = requests.post(ctx.latch_image_api_url, headers=headers, json=data)
42	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/utils.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
76	
77	    user, password = base64.b64decode(token).decode("utf-8").split(":")
78	    res = ctx.dkr_client.login(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/utils.py:77
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
76	
77	    user, password = base64.b64decode(token).decode("utf-8").split(":")
78	    res = ctx.dkr_client.login(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/utils.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
151	    )
152	    container_id = typing.cast(str, container.get("Id"))
153	    ctx.dkr_client.start(container_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/utils.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	    if token is None:
167	        token = os.environ.get("FLYTE_INTERNAL_EXECUTION_ID", "")
168	        if token != "":

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/register/utils.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
187	
188	        response = requests.post(
189	            latch_register_url, headers=headers, files=serialize_files
190	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/stop_pod.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
11	    """Stops a pod given a pod_id"""
12	    res = tinyrequests.post(
13	        urljoin(NUCLEUS_URL, "/pods/stop"),
14	        headers={"Authorization": get_auth_header()},
15	        json={"pod_id": pod_id},
16	    )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/sync.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
359	
360	    with ProcessPoolExecutor(max_workers=cores) as executor:
361	        sync_rec(srcs, normalize_path(dest), delete=delete, executor=executor)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/services/test_data/utils.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
10	def _retrieve_creds() -> Tuple[str, str, str, str]:
11	    response = tinyrequests.post(
12	        config.api.data.test_data,
13	        headers={"Authorization": f"Bearer {retrieve_or_login()}"},
14	        json={
15	            "ws_account_id": current_workspace(),
16	        },

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/tinyrequests.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
97	        try:
98	            conn.request(
99	                method,
100	                urlunparse(parts._replace(scheme="", netloc="")),
101	                headers=headers,
102	                body=body,
103	            )

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/tinyrequests.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
103	            )
104	            resp = conn.getresponse()
105	            break

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/tinyrequests.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
163	
164	    return request(
165	        "GET",
166	        url,
167	        headers=headers,
168	        data=data,
169	        json=json,
170	        stream=stream,
171	        num_retries=num_retries,
172	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/tinyrequests.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
185	
186	    return request(
187	        "PUT",
188	        url,
189	        headers=headers,
190	        data=data,
191	        json=json,
192	        stream=stream,
193	        num_retries=num_retries,
194	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/tinyrequests.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
207	
208	    return request(
209	        "POST",
210	        url,
211	        headers=headers,
212	        data=data,
213	        json=json,
214	        stream=stream,
215	        num_retries=num_retries,
216	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	    sdk_token = user_config.token
72	    execution_token = os.environ.get("FLYTE_INTERNAL_EXECUTION_ID")
73	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
268	
269	        os.chmod(ssh_key_path, 0o700)
270	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:269
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
268	
269	        os.chmod(ssh_key_path, 0o700)
270	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	    cache_location = user_config.root / "cached_version"
321	    resp = get(f"https://pypi.org/pypi/{latch_constants.pkg_name}/json")
322	    version = resp.json()["info"]["version"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
320	    cache_location = user_config.root / "cached_version"
321	    resp = get(f"https://pypi.org/pypi/{latch_constants.pkg_name}/json")
322	    version = resp.json()["info"]["version"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
323	    with open(cache_location, "w") as f:
324	        f.write(f"{version} {datetime.now().isoformat()}")
325	    return version

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
332	        with open(cache_location, "r") as f:
333	            version, timestamp = f.read().split(" ")
334	        if datetime.now() > datetime.fromisoformat(timestamp) + timedelta(days=1):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
334	        if datetime.now() > datetime.fromisoformat(timestamp) + timedelta(days=1):
335	            version = get_latest_package_version_request()
336	    except FileNotFoundError:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
336	    except FileNotFoundError:
337	        version = get_latest_package_version_request()
338	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
373	        with open(self._ssh_key_path, "r") as f:
374	            return f.read()
375	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
428	        )
429	        shutil.rmtree(new)
430	        os.renames(old, new)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/__init__.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
437	        )
438	        shutil.rmtree(new)
439	        os.renames(old, new)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/path.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	        click.secho(
66	            dedent(f"""
67	            `{path}` is not in a valid format.
68	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/path.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	        click.secho(
102	            dedent(f"""
103	            `{dom}` is not a valid path domain.
104	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/utils/path.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	        click.secho(
131	            dedent(f"""
132	            `{dom}` is not a valid path domain.
133	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_sdk_config/latch.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	DOMAIN = os.environ.get("LATCH_SDK_DOMAIN", "latch.bio")
15	CONSOLE_URL: str = f"https://console.{DOMAIN}"
16	NUCLEUS_URL: str = f"https://nucleus.{DOMAIN}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_sdk_config/latch.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	CONSOLE_URL: str = f"https://console.{DOMAIN}"
16	NUCLEUS_URL: str = f"https://nucleus.{DOMAIN}"
17	VACUOLE_URL: str = f"https://vacuole.{DOMAIN}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_sdk_config/latch.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	NUCLEUS_URL: str = f"https://nucleus.{DOMAIN}"
17	VACUOLE_URL: str = f"https://vacuole.{DOMAIN}"
18	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_sdk_gql/execute.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	    if auth_header is None:
25	        token = os.environ.get("FLYTE_INTERNAL_EXECUTION_ID", "")
26	        if token != "":

--------------------------------------------------

Code scanned:
	Total lines of code: 21039
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 128.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 155.0
		High: 9.0
Files skipped (0):
