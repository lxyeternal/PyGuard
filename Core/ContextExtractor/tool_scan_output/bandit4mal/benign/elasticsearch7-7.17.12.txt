Run started:2025-04-12 10:55:43.046815

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/__init__.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	    warnings.warn(
111	        "Support for Python 3.5 and earlier is deprecated and will be removed "
112	        "in v8.0.0 (current instance is Python %d.%d) See https://github.com/elastic"
113	        "/elasticsearch-py/issues/1696 for details." % sys.version_info[:2],
114	        category=DeprecationWarning,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/http_aiohttp.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
306	        try:
307	            async with self.session.request(
308	                method,
309	                url,
310	                data=body,
311	                headers=req_headers,
312	                timeout=timeout,
313	                fingerprint=self.ssl_assert_fingerprint,
314	            ) as response:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/http_aiohttp.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
321	                else:
322	                    raw_data = await response.read()
323	                    content_type = response_headers.get("content-type", "")

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/http_aiohttp.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
321	                else:
322	                    raw_data = await response.read()
323	                    content_type = response_headers.get("content-type", "")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/http_aiohttp.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
407	        if self._body is None:
408	            await self.read()
409	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/http_aiohttp.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
407	        if self._body is None:
408	            await self.read()
409	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/transport.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
216	            # use small timeout for the sniffing request, should be a fast api call
217	            _, headers, node_info = await conn.perform_request(
218	                "GET",
219	                "/_nodes/_all/http",
220	                timeout=self.sniff_timeout if not initial else None,
221	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/transport.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
237	            return self.loop.create_task(
238	                conn.perform_request("GET", "/_nodes/_all/http", timeout=timeout)
239	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/transport.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
244	        for conn in self.connection_pool.connections:
245	            tasks.append(_sniff_request(conn))
246	        for conn in self.seed_connections:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/transport.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
249	                continue
250	            tasks.append(_sniff_request(conn))
251	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/transport.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
388	            try:
389	                status, headers_response, data = await connection.perform_request(
390	                    method,
391	                    url,
392	                    params,
393	                    body,
394	                    headers=headers,
395	                    ignore=ignore,
396	                    timeout=timeout,
397	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/_async/transport.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
493	                try:
494	                    _, info_headers, info_response = await conn.perform_request(
495	                        "GET", "/", headers=headers, timeout=timeout
496	                    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/client/utils.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
222	                    warnings.warn(
223	                        "The 'doc_type' parameter is deprecated, use 'type' for this "
224	                        "API instead. See https://github.com/elastic/elasticsearch-py/"
225	                        "issues/1698 for more information",
226	                        category=DeprecationWarning,
227	                        stacklevel=2,
228	                    )
229	                if doc_type_in_params:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/client/utils.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	                    raise TypeError(
245	                        "The '%s' parameter%s %s only serialized in the request body "
246	                        "and can't be combined with the 'body' parameter. Either stop using the "
247	                        "'body' parameter and use keyword-arguments only or move the specified "
248	                        "parameters into the 'body'. See https://github.com/elastic/elasticsearch-py/"
249	                        "issues/1698 for more information"
250	                        % (
251	                            params_prose,
252	                            "s" if plural_params else "",
253	                            "are" if plural_params else "is",
254	                        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/client/utils.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	                    warnings.warn(
261	                        "The 'body' parameter is deprecated for the '%s' API and "
262	                        "will be removed in a future version. Instead use API parameters directly. "
263	                        "See https://github.com/elastic/elasticsearch-py/issues/1698 for "
264	                        "more information" % str(func.__name__),
265	                        DeprecationWarning,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/client/utils.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
271	                    warnings.warn(
272	                        "Using positional arguments for APIs is deprecated and will be "
273	                        "disabled in 8.0.0. Instead use only keyword arguments for all APIs. "
274	                        "See https://github.com/elastic/elasticsearch-py/issues/1698 for "
275	                        "more information",
276	                        DeprecationWarning,
277	                        stacklevel=2,
278	                    )
279	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/client/utils.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	                        raise TypeError(
303	                            "Can't use '%s' and 'body' parameters together because '%s' "
304	                            "is an alias for 'body'. Instead you should only use the "
305	                            "'%s' parameter. See https://github.com/elastic/elasticsearch-py/"
306	                            "issues/1698 for more information"
307	                            % (
308	                                body_name,
309	                                body_name,
310	                                body_name,
311	                            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/client/utils.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
317	                    warnings.warn(
318	                        "The 'body' parameter is deprecated for the '%s' API and "
319	                        "will be removed in a future version. Instead use the '%s' parameter. "
320	                        "See https://github.com/elastic/elasticsearch-py/issues/1698 "
321	                        "for more information" % (str(func.__name__), body_name),
322	                        category=DeprecationWarning,

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/client/utils.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
374	    if isinstance(auth_value, (list, tuple)):
375	        auth_value = base64.b64encode(to_bytes(":".join(auth_value)))
376	    return to_str(auth_value)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/client/utils.py:375
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
374	    if isinstance(auth_value, (list, tuple)):
375	        auth_value = base64.b64encode(to_bytes(":".join(auth_value)))
376	    return to_str(auth_value)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/connection/base.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
220	        tracer.info(
221	            "curl %s-X%s 'http://localhost:9200%s' -d '%s'",
222	            "-H 'Content-Type: application/json' " if body else "",
223	            method,
224	            path,
225	            self._pretty_json(body) if body else "",
226	        )
227	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/connection/http_requests.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
158	        request = requests.Request(method=method, headers=headers, url=url, data=body)
159	        prepared_request = self.session.prepare_request(request)
160	        settings = self.session.merge_environment_settings(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/connection/http_requests.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170	            }
171	            content_type = response_headers.get("content-type", "")
172	            raw_data = response.content

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/connection/http_urllib3.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
254	
255	            response = self.pool.urlopen(
256	                method, url, body, retries=Retry(False), headers=request_headers, **kw
257	            )

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/helpers/actions.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
468	
469	    pool = BlockingPool(thread_count)
470	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/elasticsearch7/helpers/test.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	else:
31	    ELASTICSEARCH_URL = "https://elastic:changeme@localhost:9200"
32	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/setup.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	    package_version = re.search(
29	        r"__versionstr__\s+=\s+[\"\']([^\"\']+)[\"\']", f.read()
30	    ).group(1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/setup.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	    license="Apache-2.0",
75	    url="https://github.com/elastic/elasticsearch-py",
76	    long_description=long_description,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/setup.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	    project_urls={
84	        "Documentation": "https://elasticsearch-py.readthedocs.io",
85	        "Source Code": "https://github.com/elastic/elasticsearch-py",
86	        "Issue Tracker": "https://github.com/elastic/elasticsearch-py/issues",
87	    },
88	    packages=packages,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/setup.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	        "Documentation": "https://elasticsearch-py.readthedocs.io",
85	        "Source Code": "https://github.com/elastic/elasticsearch-py",
86	        "Issue Tracker": "https://github.com/elastic/elasticsearch-py/issues",
87	    },
88	    packages=packages,
89	    package_data={"elasticsearch": ["py.typed", "*.pyi"]},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/elasticsearch7-7.17.12/elasticsearch7-7.17.12/setup.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	        "Source Code": "https://github.com/elastic/elasticsearch-py",
86	        "Issue Tracker": "https://github.com/elastic/elasticsearch-py/issues",
87	    },
88	    packages=packages,
89	    package_data={"elasticsearch": ["py.typed", "*.pyi"]},
90	    include_package_data=True,

--------------------------------------------------

Code scanned:
	Total lines of code: 26432
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 1.0
Files skipped (0):
