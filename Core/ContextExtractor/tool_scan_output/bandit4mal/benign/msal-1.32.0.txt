Run started:2025-04-12 14:21:54.922230

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
17	atexit.register(lambda:
18	    open(_token_cache_filename, "w").write(global_cache.serialize())
19	    # Hint: The following optional line persists only when state changed

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    http_method=msal.PopAuthScheme.HTTP_GET,
27	    url="https://example.com/endpoint",
28	    nonce="placeholder",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    scopes = _select_options([
76	        "https://graph.microsoft.com/.default",
77	        "https://management.azure.com/.default",
78	        "User.Read",
79	        "User.ReadBasic.All",
80	        ],
81	        header="Select a scope (multiple scopes can only be input by manually typing them, delimited by space):",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        "https://graph.microsoft.com/.default",
77	        "https://management.azure.com/.default",
78	        "User.Read",
79	        "User.ReadBasic.All",
80	        ],
81	        header="Select a scope (multiple scopes can only be input by manually typing them, delimited by space):",
82	        accept_nonempty_string=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	        ).split()  # It also converts the input string(s) into a list
84	    if "https://pas.windows.net/CheckMyAccess/Linux/.default" in scopes:
85	        raise ValueError("SSH Cert scope shall be tested by its dedicated functions")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	_SSH_CERT_DATA = {"token_type": "ssh-cert", "key_id": "key1", "req_cnf": _JWK1}
168	_SSH_CERT_SCOPE = ["https://pas.windows.net/CheckMyAccess/Linux/.default"]
169	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
196	    'key_id': _POP_KEY_ID,
197	    "req_cnf": base64.urlsafe_b64encode(_RAW_REQ_CNF.encode('utf-8')).decode('utf-8').rstrip('='),
198	        # Note: Sending _RAW_REQ_CNF without base64 encoding would result in an http 500 error

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
229	    bug_link = (
230	        "https://identitydivision.visualstudio.com/Engineering/_queries/query/79b3a352-a775-406f-87cd-a487c382a8ed/"
231	        if app._enable_broker else
232	        "https://github.com/AzureAD/microsoft-authentication-library-for-python/issues/new/choose"
233	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
231	        if app._enable_broker else
232	        "https://github.com/AzureAD/microsoft-authentication-library-for-python/issues/new/choose"
233	        )
234	    print("Bye. If you found a bug, please report it here: {}".format(bug_link))
235	    sys.exit()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
256	        try:
257	            global_cache.deserialize(open(_token_cache_filename, "r").read())
258	        except IOError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
282	    authority = _select_options([
283	        "https://login.microsoftonline.com/common",
284	        "https://login.microsoftonline.com/organizations",
285	        "https://login.microsoftonline.com/microsoft.onmicrosoft.com",
286	        "https://login.microsoftonline.com/msidlab4.onmicrosoft.com",
287	        "https://login.microsoftonline.com/consumers",
288	        ],
289	        header="Input authority (Note that MSA-PT apps would NOT use the /common authority)",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
283	        "https://login.microsoftonline.com/common",
284	        "https://login.microsoftonline.com/organizations",
285	        "https://login.microsoftonline.com/microsoft.onmicrosoft.com",
286	        "https://login.microsoftonline.com/msidlab4.onmicrosoft.com",
287	        "https://login.microsoftonline.com/consumers",
288	        ],
289	        header="Input authority (Note that MSA-PT apps would NOT use the /common authority)",
290	        accept_nonempty_string=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
284	        "https://login.microsoftonline.com/organizations",
285	        "https://login.microsoftonline.com/microsoft.onmicrosoft.com",
286	        "https://login.microsoftonline.com/msidlab4.onmicrosoft.com",
287	        "https://login.microsoftonline.com/consumers",
288	        ],
289	        header="Input authority (Note that MSA-PT apps would NOT use the /common authority)",
290	        accept_nonempty_string=True,
291	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
285	        "https://login.microsoftonline.com/microsoft.onmicrosoft.com",
286	        "https://login.microsoftonline.com/msidlab4.onmicrosoft.com",
287	        "https://login.microsoftonline.com/consumers",
288	        ],
289	        header="Input authority (Note that MSA-PT apps would NOT use the /common authority)",
290	        accept_nonempty_string=True,
291	        )
292	    instance_discovery = _input_boolean(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
286	        "https://login.microsoftonline.com/msidlab4.onmicrosoft.com",
287	        "https://login.microsoftonline.com/consumers",
288	        ],
289	        header="Input authority (Note that MSA-PT apps would NOT use the /common authority)",
290	        accept_nonempty_string=True,
291	        )
292	    instance_discovery = _input_boolean(
293	        "You input an unusual authority which might fail the Instance Discovery. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/__main__.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
295	        ) if authority and not authority.startswith(
296	            "https://login.microsoftonline.com") else None
297	    app = msal.PublicClientApplication(
298	        chosen_app["client_id"] if isinstance(chosen_app, dict) else chosen_app,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	            # https://cryptography.io/en/latest/hazmat/primitives/asymmetric/serialization/#cryptography.hazmat.primitives.serialization.pkcs12.load_key_and_certificates
77	            f.read(), passphrase_bytes)
78	    if not (private_key and cert):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
236	    _AUTH_SCHEME_UNSUPPORTED = (
237	        "auth_scheme is currently only available from broker. "
238	        "You can enable broker by following these instructions. "
239	        "https://msal-python.readthedocs.io/en/latest/#publicclientapplication")
240	
241	    def __init__(
242	            self, client_id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
629	        try:
630	            authority_to_use = authority or "https://{}/common/".format(WORLD_WIDE)
631	            self.authority = Authority(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
766	            return Authority(  # The central_authority has already been validated
767	                "https://{}/{}".format(regional_host, central_authority.tenant),
768	                self.http_client,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
789	            # so that we can ignore an empty string came from an empty ENV VAR.
790	            if client_credential.get("client_assertion"):
791	                client_assertion = client_credential['client_assertion']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
796	                    client_credential["passphrase"]
797	                    ) if client_credential.get("passphrase") else None
798	                if client_credential.get("private_key_pfx_path"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
797	                    ) if client_credential.get("passphrase") else None
798	                if client_credential.get("private_key_pfx_path"):
799	                    private_key, sha256_thumbprint, sha1_thumbprint, x5c = _parse_pfx(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
801	                        passphrase_bytes)
802	                    if client_credential.get("public_certificate") is True and x5c:
803	                        headers["x5c"] = x5c

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
804	                elif (
805	                        client_credential.get("private_key")  # PEM blob
806	                        and client_credential.get("thumbprint")):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
805	                        client_credential.get("private_key")  # PEM blob
806	                        and client_credential.get("thumbprint")):
807	                    sha1_thumbprint = client_credential["thumbprint"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
814	                    raise ValueError(
815	                        "client_credential needs to follow this format "
816	                        "https://msal-python.readthedocs.io/en/latest/#msal.ClientApplication.params.client_credential")
817	                if ("x5c" not in headers  # So the .pfx file contains no certificate

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
817	                if ("x5c" not in headers  # So the .pfx file contains no certificate
818	                    and isinstance(client_credential.get('public_certificate'), str)
819	                ):  # Then we treat the public_certificate value as PEM content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1114	        """
1115	        self._validate_ssh_cert_input_data(kwargs.get("data", {}))
1116	        telemetry_context = self._build_telemetry_context(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1185	        assert isinstance(scopes, list), "Invalid parameter type"
1186	        self._validate_ssh_cert_input_data(kwargs.get("data", {}))
1187	        warnings.warn(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1251	        grouped_accounts = {
1252	            a.get("home_account_id"):  # Grouped by home tenant's id
1253	                {  # These are minimal amount of non-tenant-specific account info

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1253	                {  # These are minimal amount of non-tenant-specific account info
1254	                    "home_account_id": a.get("home_account_id"),
1255	                    "environment": a.get("environment"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1254	                    "home_account_id": a.get("home_account_id"),
1255	                    "environment": a.get("environment"),
1256	                    "username": a.get("username"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1255	                    "environment": a.get("environment"),
1256	                    "username": a.get("username"),
1257	                    "account_source": a.get("account_source"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1256	                    "username": a.get("username"),
1257	                    "account_source": a.get("account_source"),
1258	
1259	                    # The following fields for backward compatibility, for now
1260	                    "authority_type": a.get("authority_type"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1259	                    # The following fields for backward compatibility, for now
1260	                    "authority_type": a.get("authority_type"),
1261	                    "local_account_id": a.get("local_account_id"),  # Tenant-specific

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1260	                    "authority_type": a.get("authority_type"),
1261	                    "local_account_id": a.get("local_account_id"),  # Tenant-specific
1262	                    "realm": a.get("realm"),  # Tenant-specific

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1261	                    "local_account_id": a.get("local_account_id"),  # Tenant-specific
1262	                    "realm": a.get("realm"),  # Tenant-specific
1263	                }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1271	    def _get_instance_metadata(self):  # This exists so it can be mocked in unit test
1272	        resp = self.http_client.get(
1273	            "https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=https://login.microsoftonline.com/common/oauth2/authorize",  # TBD: We may extend this to use self._instance_discovery endpoint
1274	            headers={'Accept': 'application/json'})
1275	        resp.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1272	        resp = self.http_client.get(
1273	            "https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=https://login.microsoftonline.com/common/oauth2/authorize",  # TBD: We may extend this to use self._instance_discovery endpoint
1274	            headers={'Accept': 'application/json'})
1275	        resp.raise_for_status()
1276	        return json.loads(resp.text)['metadata']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1316	                if rt["client_id"] == self.client_id or (
1317	                    app_metadata.get("family_id")  # Now let's settle family business
1318	                    and rt.get("family_id") == app_metadata["family_id"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1317	                    app_metadata.get("family_id")  # Now let's settle family business
1318	                    and rt.get("family_id") == app_metadata["family_id"])
1319	        ]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1461
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1460	        assert isinstance(scopes, list), "Invalid parameter type"
1461	        self._validate_ssh_cert_input_data(kwargs.get("data", {}))
1462	        correlation_id = msal.telemetry._get_new_correlation_id()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1502	                final_result = result
1503	        if final_result and final_result.get("suberror"):
1504	            final_result["classification"] = {  # Suppress these suberrors, per #57

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1503	        if final_result and final_result.get("suberror"):
1504	            final_result["classification"] = {  # Suppress these suberrors, per #57
1505	                "bad_token": "",
1506	                "token_expired": "",
1507	                "protection_policy_required": "",
1508	                "client_mismatch": "",
1509	                "device_authentication_failed": "",
1510	                }.get(final_result["suberror"], final_result["suberror"])
1511	        return final_result

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1532	                    "realm": authority.tenant,
1533	                    "home_account_id": (account or {}).get("home_account_id"),
1534	                    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1534	                    }
1535	            key_id = kwargs.get("data", {}).get("key_id")
1536	            if key_id:  # Some token types (SSH-certs, POP) are bound to a key

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1534	                    }
1535	            key_id = kwargs.get("data", {}).get("key_id")
1536	            if key_id:  # Some token types (SSH-certs, POP) are bound to a key

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1554	                    "access_token": entry["secret"],
1555	                    "token_type": entry.get("token_type", "Bearer"),
1556	                    "expires_in": int(expires_in),  # OAuth2 specs defines it as int

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1573	        try:
1574	            data = kwargs.get("data", {})
1575	            if account and account.get("authority_type") == _AUTHORITY_TYPE_CLOUDSHELL:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1574	            data = kwargs.get("data", {})
1575	            if account and account.get("authority_type") == _AUTHORITY_TYPE_CLOUDSHELL:
1576	                if auth_scheme:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1579	
1580	            if self._enable_broker and account and account.get("account_source") in (
1581	                _GRANT_TYPE_BROKER,  # Broker successfully established this account previously.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1585	                response = _acquire_token_silently(
1586	                    "https://{}/{}".format(self.authority.instance, self.authority.tenant),
1587	                    self.client_id,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1595	                if response:  # Broker provides a decisive outcome
1596	                    account_was_established_by_broker = account.get(
1597	                        "account_source") == _GRANT_TYPE_BROKER
1598	                    broker_attempt_succeeded_just_now = "error" not in response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1642	            "environment": authority.instance,
1643	            "home_account_id": (account or {}).get("home_account_id"),
1644	            # "realm": authority.tenant,  # AAD RTs are tenant-independent

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1660
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1659	                    # https://msazure.visualstudio.com/One/_git/ESTS-Docs/pullrequest/1138595
1660	                    "client_mismatch" in response.get("error_additional_info", []),
1661	                **kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1664	        last_resp = None
1665	        if app_metadata.get("family_id"):  # Meaning this app belongs to this family
1666	            last_resp = at = self._acquire_token_silent_by_finding_specific_refresh_token(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1706	                matches,
1707	                key=lambda e: int(e.get("last_modification_time", "0")),
1708	                reverse=True):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1710	            headers = telemetry_context.generate_headers()
1711	            if query.get("home_account_id"):  # Then use it as CCS Routing info
1712	                headers["X-AnchorMailbox"] = "Oid:{}".format(  # case-insensitive value

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1734	            logger.debug("Refresh failed. {error}: {error_description}".format(
1735	                error=response.get("error"),
1736	                error_description=response.get("error_description"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1735	                error=response.get("error"),
1736	                error_description=response.get("error_description"),
1737	                ))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1742	    def _validate_ssh_cert_input_data(self, data):
1743	        if data.get("token_type") == "ssh-cert":
1744	            if not data.get("req_cnf"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1743	        if data.get("token_type") == "ssh-cert":
1744	            if not data.get("req_cnf"):
1745	                raise ValueError(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1745	                raise ValueError(
1746	                    "When requesting an SSH certificate, "
1747	                    "you must include a string parameter named 'req_cnf' "
1748	                    "containing the public key in JWK format "

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1749	                    "(https://tools.ietf.org/html/rfc7517).")
1750	            if not data.get("key_id"):
1751	                raise ValueError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1778	        """
1779	        self._validate_ssh_cert_input_data(kwargs.get("data", {}))
1780	        telemetry_context = self._build_telemetry_context(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1832	            response = _signin_silently(
1833	                "https://{}/{}".format(self.authority.instance, self.authority.tenant),
1834	                self.client_id,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1843	                )
1844	            return self._process_broker_response(response, scopes, kwargs.get("data", {}))
1845	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1857
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1856	                username, correlation_id=headers[msal.telemetry.CLIENT_REQUEST_ID])
1857	            if user_realm_result.get("account_type") == "Federated":
1858	                response = _clean_up(self._acquire_token_by_username_password_federated(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1876
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1875	        wstrust_endpoint = {}
1876	        if user_realm_result.get("federation_metadata_url"):
1877	            wstrust_endpoint = mex_send_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1876	        if user_realm_result.get("federation_metadata_url"):
1877	            wstrust_endpoint = mex_send_request(
1878	                user_realm_result["federation_metadata_url"],
1879	                self.http_client)
1880	            if wstrust_endpoint is None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1876	        if user_realm_result.get("federation_metadata_url"):
1877	            wstrust_endpoint = mex_send_request(
1878	                user_realm_result["federation_metadata_url"],
1879	                self.http_client)
1880	            if wstrust_endpoint is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1881
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1880	            if wstrust_endpoint is None:
1881	                raise ValueError("Unable to find wstrust endpoint from MEX. "
1882	                    "This typically happens when attempting MSA accounts. "

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1885	        logger.debug("wstrust_endpoint = %s", wstrust_endpoint)
1886	        wstrust_result = wst_send_request(
1887	            username, password,
1888	            user_realm_result.get("cloud_audience_urn", "urn:federation:MicrosoftOnline"),
1889	            wstrust_endpoint.get("address",
1890	                # Fallback to an AAD supplied endpoint
1891	                user_realm_result.get("federation_active_auth_url")),
1892	            wstrust_endpoint.get("action"), self.http_client)
1893	        if not ("token" in wstrust_result and "type" in wstrust_result):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1886
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1885	        logger.debug("wstrust_endpoint = %s", wstrust_endpoint)
1886	        wstrust_result = wst_send_request(
1887	            username, password,
1888	            user_realm_result.get("cloud_audience_urn", "urn:federation:MicrosoftOnline"),
1889	            wstrust_endpoint.get("address",
1890	                # Fallback to an AAD supplied endpoint
1891	                user_realm_result.get("federation_active_auth_url")),
1892	            wstrust_endpoint.get("action"), self.http_client)
1893	        if not ("token" in wstrust_result and "type" in wstrust_result):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1887	            username, password,
1888	            user_realm_result.get("cloud_audience_urn", "urn:federation:MicrosoftOnline"),
1889	            wstrust_endpoint.get("address",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1889
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1888	            user_realm_result.get("cloud_audience_urn", "urn:federation:MicrosoftOnline"),
1889	            wstrust_endpoint.get("address",
1890	                # Fallback to an AAD supplied endpoint
1891	                user_realm_result.get("federation_active_auth_url")),
1892	            wstrust_endpoint.get("action"), self.http_client)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1891
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1890	                # Fallback to an AAD supplied endpoint
1891	                user_realm_result.get("federation_active_auth_url")),
1892	            wstrust_endpoint.get("action"), self.http_client)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1892
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1891	                user_realm_result.get("federation_active_auth_url")),
1892	            wstrust_endpoint.get("action"), self.http_client)
1893	        if not ("token" in wstrust_result and "type" in wstrust_result):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1895	        GRANT_TYPE_SAML1_1 = 'urn:ietf:params:oauth:grant-type:saml1_1-bearer'
1896	        grant_type = {
1897	            SAML_TOKEN_TYPE_V1: GRANT_TYPE_SAML1_1,
1898	            SAML_TOKEN_TYPE_V2: self.client.GRANT_TYPE_SAML2,
1899	            WSS_SAML_TOKEN_PROFILE_V1_1: GRANT_TYPE_SAML1_1,
1900	            WSS_SAML_TOKEN_PROFILE_V2: self.client.GRANT_TYPE_SAML2
1901	            }.get(wstrust_result.get("type"))
1902	        if not grant_type:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1901
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1900	            WSS_SAML_TOKEN_PROFILE_V2: self.client.GRANT_TYPE_SAML2
1901	            }.get(wstrust_result.get("type"))
1902	        if not grant_type:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:1904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1903	            raise RuntimeError(
1904	                "RSTR returned unknown token type: %s", wstrust_result.get("type"))
1905	        self.client.grant_assertion_encoders.setdefault(  # Register a non-standard type

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:2133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2132	            False
2133	            ) and data.get("token_type") != "ssh-cert"  # Work around a known issue as of PyMsalRuntime 0.8
2134	        self._validate_ssh_cert_input_data(data)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:2176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2175	            extra_scope_to_consent=extra_scopes_to_consent,
2176	            redirect_uri="http://localhost:{port}".format(
2177	                # Hardcode the host, for now. AAD portal rejects 127.0.0.1 anyway

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:2212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2211	            logger.debug(kwargs["welcome_template"])  # Experimental
2212	        authority = "https://{}/{}".format(
2213	            self.authority.instance, self.authority.tenant)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:2247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2246	                "access_token" in response and login_hint
2247	                and login_hint != response.get(
2248	                    "id_token_claims", {}).get("preferred_username"))
2249	            wrong_account_error_message = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:2247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2246	                "access_token" in response and login_hint
2247	                and login_hint != response.get(
2248	                    "id_token_claims", {}).get("preferred_username"))
2249	            wrong_account_error_message = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:2265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2264	                    ])
2265	                if is_wrong_account or "error" in response and response.get(
2266	                        "_broker_status") in recoverable_errors:
2267	                    pass  # It will fall back to the _signin_interactively()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:2326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2325	            self.ACQUIRE_TOKEN_BY_DEVICE_FLOW_ID,
2326	            correlation_id=flow.get(self.DEVICE_FLOW_CORRELATION_ID))
2327	        response = _clean_up(self.client.obtain_token_by_device_flow(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:2369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2368	        """
2369	        if kwargs.get("force_refresh"):
2370	            raise ValueError(  # We choose to disallow force_refresh

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/application.py:2388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2387	                "Please use a specific tenant instead.", DeprecationWarning)
2388	        self._validate_ssh_cert_input_data(kwargs.get("data", {}))
2389	        telemetry_context = self._build_telemetry_context(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/auth_scheme.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	        if http_method not in self._HTTP_METHODS:
29	            raise ValueError("http_method must be uppercase, according to "
30	                "https://datatracker.ietf.org/doc/html/draft-ietf-oauth-signed-http-request-03#section-3")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/authority.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    def __str__(self):
44	        return "https://{}/{}".format(self._instance, self._tenant)
45	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/authority.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	                if oidc_authority_url else
88	                "Unable to get authority configuration for {}. "
89	                "Authority would typically be in a format of "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/authority.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	        is_known_to_microsoft = self.instance in WELL_KNOWN_AUTHORITY_HOSTS
130	        instance_discovery_endpoint = 'https://{}/common/discovery/instance'.format(  # Note: This URL seemingly returns V1 endpoint only
131	            WORLD_WIDE  # Historically using WORLD_WIDE. Could use self.instance too

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/authority.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
137	            payload = _instance_discovery(
138	                "https://{}{}/oauth2/v2.0/authorize".format(
139	                    self.instance, authority.path),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/authority.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	            resp = response or self._http_client.get(
167	                "https://{netloc}/common/userrealm/{username}?api-version=1.0".format(
168	                    netloc=self.instance, username=username),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/authority.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
193	    raise ValueError(
194	        "Your given address (%s) should consist of "
195	        "an https url with a minimum of one segment in a path: e.g. "
196	        "https://login.microsoftonline.com/{tenant} "
197	        "or https://{tenant_name}.ciamlogin.com/{tenant} "
198	        "or https://{tenant_name}.b2clogin.com/{tenant_name}.onmicrosoft.com/policy"
199	        % authority_or_auth_endpoint)
200	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/broker.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	        _redirect_uri_on_mac if sys.platform == "darwin" else
187	        "https://login.microsoftonline.com/common/oauth2/nativeclient"
188	        # This default redirect_uri value is not currently used by WAM
189	        # but it is required by the MSAL.cpp to be set to a non-empty valid URI.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/cloudshell.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    cloud_shell_supported_audiences = [
28	        "https://analysis.windows.net/powerbi/api",  # Came from https://msazure.visualstudio.com/One/_git/compute-CloudShell?path=/src/images/agent/env/envconfig.PROD.json
29	        "https://pas.windows.net/CheckMyAccess/Linux/.default",  # Cloud Shell accepts it as-is
30	        ]
31	    for a in cloud_shell_supported_audiences:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/cloudshell.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	        "https://analysis.windows.net/powerbi/api",  # Came from https://msazure.visualstudio.com/One/_git/compute-CloudShell?path=/src/images/agent/env/envconfig.PROD.json
29	        "https://pas.windows.net/CheckMyAccess/Linux/.default",  # Cloud Shell accepts it as-is
30	        ]
31	    for a in cloud_shell_supported_audiences:
32	        if scope.startswith(a):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/cloudshell.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	    resp = http_client.post(
46	        "http://localhost:50342/oauth2/token",
47	        data=dict(
48	            data or {},
49	            resource=" ".join(map(_scope_to_resource, scopes))),
50	        headers={"Metadata": "true"},
51	        )
52	    if resp.status_code >= 300:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/cloudshell.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
112	            logger.debug("Unable to decode jwt payload: %s", parts[1])
113	    oauth2_response["client_info"] = base64.b64encode(
114	        # Mimic a client_info, so that MSAL would create an account
115	        json.dumps(client_info).encode("utf-8")).decode("utf-8")
116	    oauth2_response["id_token_claims"]["tid"] = client_info["utid"]  # TBD

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/cloudshell.py:113
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
112	            logger.debug("Unable to decode jwt payload: %s", parts[1])
113	    oauth2_response["client_info"] = base64.b64encode(
114	        # Mimic a client_info, so that MSAL would create an account
115	        json.dumps(client_info).encode("utf-8")).decode("utf-8")
116	    oauth2_response["id_token_claims"]["tid"] = client_info["utid"]  # TBD

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/managed_identity.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
320	                    scope=[resource],
321	                    token_endpoint="https://{}/{}".format(
322	                        self._get_instance(), self._tenant),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/managed_identity.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
355	    ):
356	        return "http://localhost:40342/metadata/identity/oauth2/token"
357	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/managed_identity.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
394	            logger.debug(
395	                "Ignoring managed_identity parameter. "
396	                "Managed Identity in Service Fabric is configured in the cluster, "
397	                "not during runtime. See also "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/managed_identity.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
426	            raise ManagedIdentityError(  # Note: Azure Identity for Python raised exception too
427	                "Invalid managed_identity parameter. "
428	                "Azure Arc supports only system-assigned managed identity, "
429	                "See also "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/managed_identity.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	        os.getenv(
452	            "AZURE_POD_IDENTITY_AUTHORITY_HOST", "http://169.254.169.254"
453	            ).strip("/") + "/metadata/identity/oauth2/token",
454	        params=params,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/managed_identity.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
630	    with open(filename) as f:
631	        secret = f.read()
632	    response = http_client.get(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    NS = {  # Also used by wstrust_*.py
60	        'wsdl': 'http://schemas.xmlsoap.org/wsdl/',
61	        'sp': 'http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702',
62	        'sp2005': 'http://schemas.xmlsoap.org/ws/2005/07/securitypolicy',
63	        'wsu': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd',
64	        'wsa': 'http://www.w3.org/2005/08/addressing',  # Duplicate?
65	        'wsa10': 'http://www.w3.org/2005/08/addressing',
66	        'http': 'http://schemas.microsoft.com/ws/06/2004/policy/http',
67	        'soap12': 'http://schemas.xmlsoap.org/wsdl/soap12/',
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        'wsdl': 'http://schemas.xmlsoap.org/wsdl/',
61	        'sp': 'http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702',
62	        'sp2005': 'http://schemas.xmlsoap.org/ws/2005/07/securitypolicy',
63	        'wsu': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd',
64	        'wsa': 'http://www.w3.org/2005/08/addressing',  # Duplicate?
65	        'wsa10': 'http://www.w3.org/2005/08/addressing',
66	        'http': 'http://schemas.microsoft.com/ws/06/2004/policy/http',
67	        'soap12': 'http://schemas.xmlsoap.org/wsdl/soap12/',
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	        'sp': 'http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702',
62	        'sp2005': 'http://schemas.xmlsoap.org/ws/2005/07/securitypolicy',
63	        'wsu': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd',
64	        'wsa': 'http://www.w3.org/2005/08/addressing',  # Duplicate?
65	        'wsa10': 'http://www.w3.org/2005/08/addressing',
66	        'http': 'http://schemas.microsoft.com/ws/06/2004/policy/http',
67	        'soap12': 'http://schemas.xmlsoap.org/wsdl/soap12/',
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	        'sp2005': 'http://schemas.xmlsoap.org/ws/2005/07/securitypolicy',
63	        'wsu': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd',
64	        'wsa': 'http://www.w3.org/2005/08/addressing',  # Duplicate?
65	        'wsa10': 'http://www.w3.org/2005/08/addressing',
66	        'http': 'http://schemas.microsoft.com/ws/06/2004/policy/http',
67	        'soap12': 'http://schemas.xmlsoap.org/wsdl/soap12/',
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	        'wsu': 'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd',
64	        'wsa': 'http://www.w3.org/2005/08/addressing',  # Duplicate?
65	        'wsa10': 'http://www.w3.org/2005/08/addressing',
66	        'http': 'http://schemas.microsoft.com/ws/06/2004/policy/http',
67	        'soap12': 'http://schemas.xmlsoap.org/wsdl/soap12/',
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):
79	        self.dom = ET.fromstring(mex_document)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        'wsa': 'http://www.w3.org/2005/08/addressing',  # Duplicate?
65	        'wsa10': 'http://www.w3.org/2005/08/addressing',
66	        'http': 'http://schemas.microsoft.com/ws/06/2004/policy/http',
67	        'soap12': 'http://schemas.xmlsoap.org/wsdl/soap12/',
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):
79	        self.dom = ET.fromstring(mex_document)
80	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	        'wsa10': 'http://www.w3.org/2005/08/addressing',
66	        'http': 'http://schemas.microsoft.com/ws/06/2004/policy/http',
67	        'soap12': 'http://schemas.xmlsoap.org/wsdl/soap12/',
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):
79	        self.dom = ET.fromstring(mex_document)
80	
81	    def _get_policy_ids(self, components_to_leaf, binding_xpath):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	        'http': 'http://schemas.microsoft.com/ws/06/2004/policy/http',
67	        'soap12': 'http://schemas.xmlsoap.org/wsdl/soap12/',
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):
79	        self.dom = ET.fromstring(mex_document)
80	
81	    def _get_policy_ids(self, components_to_leaf, binding_xpath):
82	        id_attr = '{%s}Id' % self.NS['wsu']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	        'soap12': 'http://schemas.xmlsoap.org/wsdl/soap12/',
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):
79	        self.dom = ET.fromstring(mex_document)
80	
81	    def _get_policy_ids(self, components_to_leaf, binding_xpath):
82	        id_attr = '{%s}Id' % self.NS['wsu']
83	        return set(["#{}".format(policy.get(id_attr))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	        'wsp': 'http://schemas.xmlsoap.org/ws/2004/09/policy',
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):
79	        self.dom = ET.fromstring(mex_document)
80	
81	    def _get_policy_ids(self, components_to_leaf, binding_xpath):
82	        id_attr = '{%s}Id' % self.NS['wsu']
83	        return set(["#{}".format(policy.get(id_attr))
84	            for policy in self.dom.findall(_xpath_of_root(components_to_leaf), self.NS)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	        's': 'http://www.w3.org/2003/05/soap-envelope',
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):
79	        self.dom = ET.fromstring(mex_document)
80	
81	    def _get_policy_ids(self, components_to_leaf, binding_xpath):
82	        id_attr = '{%s}Id' % self.NS['wsu']
83	        return set(["#{}".format(policy.get(id_attr))
84	            for policy in self.dom.findall(_xpath_of_root(components_to_leaf), self.NS)
85	            # If we did not find any binding, this is potentially bad.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	        'wst': 'http://docs.oasis-open.org/ws-sx/ws-trust/200512',
71	        'trust': "http://docs.oasis-open.org/ws-sx/ws-trust/200512",  # Duplicate?
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):
79	        self.dom = ET.fromstring(mex_document)
80	
81	    def _get_policy_ids(self, components_to_leaf, binding_xpath):
82	        id_attr = '{%s}Id' % self.NS['wsu']
83	        return set(["#{}".format(policy.get(id_attr))
84	            for policy in self.dom.findall(_xpath_of_root(components_to_leaf), self.NS)
85	            # If we did not find any binding, this is potentially bad.
86	            if policy.find(binding_xpath, self.NS) is not None])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        'saml': "urn:oasis:names:tc:SAML:1.0:assertion",
73	        'wst2005': 'http://schemas.xmlsoap.org/ws/2005/02/trust',  # was named "t"
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):
79	        self.dom = ET.fromstring(mex_document)
80	
81	    def _get_policy_ids(self, components_to_leaf, binding_xpath):
82	        id_attr = '{%s}Id' % self.NS['wsu']
83	        return set(["#{}".format(policy.get(id_attr))
84	            for policy in self.dom.findall(_xpath_of_root(components_to_leaf), self.NS)
85	            # If we did not find any binding, this is potentially bad.
86	            if policy.find(binding_xpath, self.NS) is not None])
87	
88	    def _get_username_password_policy_ids(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        }
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    ACTION_13 = 'http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue'
76	    ACTION_2005 = 'http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue'
77	
78	    def __init__(self, mex_document):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/mex.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	            if (binding.find('soap12:binding', self.NS).get("transport") !=
108	                    'http://schemas.xmlsoap.org/soap/http'):
109	                continue
110	            action = binding.find(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/assertion.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
18	def _encode_thumbprint(thumbprint):
19	    return base64.urlsafe_b64encode(binascii.a2b_hex(thumbprint)).decode()
20	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/assertion.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	                logger.exception(
128	                    'Some algorithms requires "pip install cryptography". '
129	                    'See https://pyjwt.readthedocs.io/en/latest/installation.html#cryptographic-dependencies-optional')
130	            raise

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
139	        self.end_headers()
140	        self.wfile.write(body.encode("utf-8"))
141	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
188	        """
189	        address = "0.0.0.0" if _is_inside_docker() else "127.0.0.1"  # Hardcode
190	            # Per RFC 8252 (https://tools.ietf.org/html/rfc8252#section-8.3):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
188	        """
189	        address = "0.0.0.0" if _is_inside_docker() else "127.0.0.1"  # Hardcode
190	            # Per RFC 8252 (https://tools.ietf.org/html/rfc8252#section-8.3):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
266	        result = {}  # A mutable object to be filled with thread's return value
267	        t = threading.Thread(
268	            target=self._get_auth_response, args=(result,), kwargs=kwargs)
269	        t.daemon = True  # So that it won't prevent the main thread from exiting

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
286	            ):
287	        welcome_uri = "http://localhost:{p}".format(p=self.get_port())
288	        abort_uri = "{loc}?error=abort".format(loc=welcome_uri)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
330	            # https://docs.python.org/2/library/basehttpserver.html#more-examples
331	            self._server.handle_request()
332	            if self._server.auth_response:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
338	        self._closing = True
339	        self._server.server_close()
340	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
344	    def __exit__(self, exc_type, exc_val, exc_tb):
345	        self.close()
346	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
357	        '--endpoint', help="The auth endpoint for your app.",
358	        default="https://login.microsoftonline.com/common/oauth2/v2.0/authorize")
359	    p.add_argument('client_id', help="The client_id of your application")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
361	    p.add_argument('--timeout', type=int, default=60, help="Timeout value, in second")
362	    p.add_argument('--host', default="127.0.0.1", help="The host of redirect_uri")
363	    p.add_argument('--scope', default=None, help="The scope list")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/authcode.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
368	            scope=args.scope.split() if args.scope else None,
369	            redirect_uri="http://{h}:{p}".format(h=args.host, p=receiver.get_port()),
370	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	    def encode_saml_assertion(assertion):
41	        return base64.urlsafe_b64encode(assertion).rstrip(b'=')  # Per RFC 7522
42	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	        params = {k: v for k, v in params.items() if v is not None}  # clean up
181	        if params.get('scope'):
182	            params['scope'] = self._stringify(params['scope'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
196	
197	        if self.default_body.get("client_assertion_type") and self.client_assertion:
198	            # See https://tools.ietf.org/html/rfc7521#section-4.2

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	            # See https://tools.ietf.org/html/rfc7521#section-4.2
199	            encoder = self.client_assertion_encoders.get(
200	                    self.default_body["client_assertion_type"], lambda a: a)
201	            _data["client_assertion"] = encoder(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
210	
211	        if _data.get('scope'):
212	            _data['scope'] = self._stringify(_data['scope'])

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
225	        if self.client_secret and self.client_id:
226	            _headers["Authorization"] = "Basic " + base64.b64encode("{}:{}".format(
227	                # Per https://tools.ietf.org/html/rfc6749#section-2.3.1
228	                # client_id and client_secret needs to be encoded by
229	                # "application/x-www-form-urlencoded"
230	                # https://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.1
231	                # BEFORE they are fed into HTTP Basic Authentication
232	                quote_plus(self.client_id), quote_plus(self.client_secret)
233	                ).encode("ascii")).decode("ascii")
234	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:226
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
225	        if self.client_secret and self.client_id:
226	            _headers["Authorization"] = "Basic " + base64.b64encode("{}:{}".format(
227	                # Per https://tools.ietf.org/html/rfc6749#section-2.3.1
228	                # client_id and client_secret needs to be encoded by
229	                # "application/x-www-form-urlencoded"
230	                # https://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.1
231	                # BEFORE they are fed into HTTP Basic Authentication
232	                quote_plus(self.client_id), quote_plus(self.client_secret)
233	                ).encode("ascii")).decode("ascii")
234	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
283	        # https://tools.ietf.org/html/rfc7636#section-4.2
284	        base64.urlsafe_b64encode(hashlib.sha256(verifier.encode("ascii")).digest())
285	        .rstrip(b"="))  # Required by https://tools.ietf.org/html/rfc7636#section-3

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
323	        DAE = "device_authorization_endpoint"
324	        if not self.configuration.get(DAE):
325	            raise ValueError("You need to provide device authorization endpoint")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
325	            raise ValueError("You need to provide device authorization endpoint")
326	        resp = self._http_client.post(self.configuration[DAE],
327	            data={"client_id": self.client_id, "scope": self._stringify(scope or [])},
328	            headers=dict(self.default_headers, **kwargs.pop("headers", {})),
329	            **kwargs)
330	        flow = json.loads(resp.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
330	        flow = json.loads(resp.text)
331	        flow["interval"] = int(flow.get("interval", 5))  # Some IdP returns string
332	        flow["expires_in"] = int(flow.get("expires_in", 1800))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
331	        flow["interval"] = int(flow.get("interval", 5))  # Some IdP returns string
332	        flow["expires_in"] = int(flow.get("expires_in", 1800))
333	        flow["expires_at"] = time.time() + flow["expires_in"]  # We invent this

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
340	        skew = 1
341	        if flow.get("latest_attempt_at", 0) + flow.get("interval", 5) - skew > now:
342	            warnings.warn('Attempted too soon. Please do time.sleep(flow["interval"])')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
340	        skew = 1
341	        if flow.get("latest_attempt_at", 0) + flow.get("interval", 5) - skew > now:
342	            warnings.warn('Attempted too soon. Please do time.sleep(flow["interval"])')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
349	            self.DEVICE_FLOW["GRANT_TYPE"], data=data, **kwargs)
350	        if result.get("error") == "slow_down":
351	            # Respecting https://tools.ietf.org/html/draft-ietf-oauth-device-flow-12#section-3.5

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
351	            # Respecting https://tools.ietf.org/html/draft-ietf-oauth-device-flow-12#section-3.5
352	            flow["interval"] = flow.get("interval", 5) + 5
353	        flow["latest_attempt_at"] = now

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
357	            flow,
358	            exit_condition=lambda flow: flow.get("expires_at", 0) < time.time(),
359	            **kwargs):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
386	            result = self._obtain_token_by_device_flow(flow, **kwargs)
387	            if result.get("error") not in self.DEVICE_FLOW_RETRIABLE_ERRORS:
388	                return result

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
388	                return result
389	            for i in range(flow.get("interval", 5)):  # Wait interval seconds
390	                if exit_condition(flow):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
536	            # This is app developer's error which we do NOT want to map to ValueError
537	        if not auth_code_flow.get("state"):
538	            # initiate_auth_code_flow() already guarantees a state to be available.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
542	            raise ValueError("state missing from auth_code_flow")
543	        if auth_code_flow.get("state") != auth_response.get("state"):
544	            raise ValueError("state mismatch: {} vs {}".format(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
542	            raise ValueError("state missing from auth_code_flow")
543	        if auth_code_flow.get("state") != auth_response.get("state"):
544	            raise ValueError("state mismatch: {} vs {}".format(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
544	            raise ValueError("state mismatch: {} vs {}".format(
545	                auth_code_flow.get("state"), auth_response.get("state")))
546	        if scope and set(scope) - set(auth_code_flow.get("scope", [])):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
544	            raise ValueError("state mismatch: {} vs {}".format(
545	                auth_code_flow.get("state"), auth_response.get("state")))
546	        if scope and set(scope) - set(auth_code_flow.get("scope", [])):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
545	                auth_code_flow.get("state"), auth_response.get("state")))
546	        if scope and set(scope) - set(auth_code_flow.get("scope", [])):
547	            raise ValueError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
547	            raise ValueError(
548	                "scope must be None or a subset of %s" % auth_code_flow.get("scope"))
549	        if auth_response.get("code"):  # i.e. the first leg was successful

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
548	                "scope must be None or a subset of %s" % auth_code_flow.get("scope"))
549	        if auth_response.get("code"):  # i.e. the first leg was successful
550	            return self._obtain_token_by_authorization_code(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
551	                auth_response["code"],
552	                redirect_uri=auth_code_flow.get("redirect_uri"),
553	                    # Required, if "redirect_uri" parameter was included in the

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
554	                    # authorization request, and their values MUST be identical.
555	                scope=scope or auth_code_flow.get("scope"),
556	                    # It is both unnecessary and harmless, per RFC 6749.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
563	                **kwargs)
564	        if auth_response.get("error"):  # It means the first leg encountered error
565	            # Here we do NOT return original auth_response as-is, to prevent a

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
567	            error = {"error": auth_response["error"]}
568	            if auth_response.get("error_description"):
569	                error["error_description"] = auth_response["error_description"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
569	                error["error_description"] = auth_response["error_description"]
570	            if auth_response.get("error_uri"):
571	                error["error_uri"] = auth_response["error_uri"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
625	        # Otherwise we will listen on _redirect_uri.port
626	        _redirect_uri = urlparse(redirect_uri or "http://127.0.0.1:0")
627	        if not _redirect_uri.hostname:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
696	            params = parse_qs(params)
697	        if params.get('state') != state:
698	            raise ValueError('state mismatch')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:792
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
791	                #       app developer to still explicitly provide a scope here.
792	                scope = _data.get("scope")
793	            (on_obtaining_tokens or self.on_obtaining_tokens)({

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
840	            **kwargs)
841	        if resp.get('error') == 'invalid_grant':
842	            (on_removing_rt or self.on_removing_rt)(token_item)  # Discard old RT

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oauth2.py:861
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
860	        """
861	        encoder = self.grant_assertion_encoders.get(grant_type, lambda a: a)
862	        data = kwargs.pop("data", {})

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/oauth2cli/oidc.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
31	        raw)
32	    output = base64.urlsafe_b64decode(raw)
33	    if encoding:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/region.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    url = (
18	        "http://169.254.169.254/metadata/instance"
19	
20	        # Utilize the "route parameters" feature to obtain region as a string
21	        # https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service?tabs=linux#route-parameters
22	        "/compute/location?format=text"
23	
24	        # Location info is available since API version 2017-04-02
25	        # https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-service?tabs=linux#response-1
26	        "&api-version=2021-01-01"
27	        )
28	    logger.info(
29	        "Connecting to IMDS {}. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/wstrust_request.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    now = datetime.utcnow()
80	    return """<s:Envelope xmlns:s='{s}' xmlns:wsa='{wsa}' xmlns:wsu='{wsu}'>
81	        <s:Header>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/wstrust_request.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	            applies_to=cloud_audience_urn,
122	            key_type='http://docs.oasis-open.org/ws-sx/ws-trust/200512/Bearer'
123	                if soap_action == Mex.ACTION_13 else
124	                'http://schemas.xmlsoap.org/ws/2005/05/identity/NoProofKey',
125	            request_type='http://docs.oasis-open.org/ws-sx/ws-trust/200512/Issue'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/wstrust_request.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	                if soap_action == Mex.ACTION_13 else
124	                'http://schemas.xmlsoap.org/ws/2005/05/identity/NoProofKey',
125	            request_type='http://docs.oasis-open.org/ws-sx/ws-trust/200512/Issue'
126	                if soap_action == Mex.ACTION_13 else
127	                'http://schemas.xmlsoap.org/ws/2005/02/trust/Issue',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/wstrust_request.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	                'http://schemas.xmlsoap.org/ws/2005/05/identity/NoProofKey',
125	            request_type='http://docs.oasis-open.org/ws-sx/ws-trust/200512/Issue'
126	                if soap_action == Mex.ACTION_13 else
127	                'http://schemas.xmlsoap.org/ws/2005/02/trust/Issue',
128	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/wstrust_request.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	                if soap_action == Mex.ACTION_13 else
127	                'http://schemas.xmlsoap.org/ws/2005/02/trust/Issue',
128	        )
129	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/wstrust_response.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	# http://docs.oasis-open.org/wss-m/wss/v1.1.1/os/wss-SAMLTokenProfile-v1.1.1-os.html#_Toc307397288
41	WSS_SAML_TOKEN_PROFILE_V1_1 = "http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1"
42	WSS_SAML_TOKEN_PROFILE_V2 = "http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/msal/wstrust_response.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	WSS_SAML_TOKEN_PROFILE_V1_1 = "http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV1.1"
42	WSS_SAML_TOKEN_PROFILE_V2 = "http://docs.oasis-open.org/wss/oasis-wss-saml-token-profile-1.1#SAMLV2.0"
43	
44	def parse_response(body):  # Returns {"token": "<saml:assertion ...>", "type": "..."}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_account_source.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	@patch.object(msal.authority, "tenant_discovery", return_value={
27	    "authorization_endpoint": "https://contoso.com/placeholder",
28	    "token_endpoint": "https://contoso.com/placeholder",
29	})  # Otherwise it would fail on OIDC discovery
30	class TestAccountSourceBehavior(unittest.TestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_account_source.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    "authorization_endpoint": "https://contoso.com/placeholder",
28	    "token_endpoint": "https://contoso.com/placeholder",
29	})  # Otherwise it would fail on OIDC discovery
30	class TestAccountSourceBehavior(unittest.TestCase):
31	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	_OIDC_DISCOVERY_MOCK = Mock(return_value={
25	    "authorization_endpoint": "https://contoso.com/placeholder",
26	    "token_endpoint": "https://contoso.com/placeholder",
27	})
28	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    "authorization_endpoint": "https://contoso.com/placeholder",
26	    "token_endpoint": "https://contoso.com/placeholder",
27	})
28	
29	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	    def setUp(self):
69	        self.authority_url = "https://login.microsoftonline.com/common"
70	        self.scopes = ["s1", "s2"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	    def setUp(self):
128	        self.authority_url = "https://login.microsoftonline.com/common"
129	        self.scopes = ["s1", "s2"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	        self.environment_in_cache = "sts.windows.net"
247	        self.authority_url_in_app = "https://login.microsoftonline.com/common"
248	        self.scopes = ["s1", "s2"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
257	            "scope": self.scopes,
258	            "token_endpoint": "https://{}/common/oauth2/v2.0/token".format(
259	                self.environment_in_cache),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
339	    """
340	    authority_url = "https://login.microsoftonline.com/common"
341	    scopes = ["s1", "s2"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
452	class TestTelemetryMaintainingOfflineState(unittest.TestCase):
453	    authority_url = "https://login.microsoftonline.com/common"
454	    scopes = ["s1", "s2"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
534	        cls.app = ClientApplication(
535	            "client_id", authority="https://login.microsoftonline.com/common")
536	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
563	        cls.app = PublicClientApplication(
564	            "client_id", authority="https://login.microsoftonline.com/common")
565	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
594	            "client_id", client_credential="secret",
595	            authority="https://login.microsoftonline.com/common")
596	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
651	                "token_endpoint":
652	                    "https://{}/{}/oauth2/v2.0/token".format(environment, tenant),
653	                "response": build_response(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
663	            client_id,
664	            authority="https://{}/common".format(environment),
665	            token_cache=cache)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
695	        self._test_certain_authority_should_emit_warning(
696	            authority="https://login.microsoftonline.com/common")
697	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
690	    @patch(_OIDC_DISCOVERY, new=Mock(return_value={
691	        "authorization_endpoint": "https://contoso.com/common",
692	        "token_endpoint": "https://contoso.com/common",
693	        }))
694	    def test_common_authority_should_emit_warning(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
691	        "authorization_endpoint": "https://contoso.com/common",
692	        "token_endpoint": "https://contoso.com/common",
693	        }))
694	    def test_common_authority_should_emit_warning(self):
695	        self._test_certain_authority_should_emit_warning(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
703	        self._test_certain_authority_should_emit_warning(
704	            authority="https://login.microsoftonline.com/organizations")
705	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
698	    @patch(_OIDC_DISCOVERY, new=Mock(return_value={
699	        "authorization_endpoint": "https://contoso.com/organizations",
700	        "token_endpoint": "https://contoso.com/organizations",
701	        }))
702	    def test_organizations_authority_should_emit_warning(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
699	        "authorization_endpoint": "https://contoso.com/organizations",
700	        "token_endpoint": "https://contoso.com/organizations",
701	        }))
702	    def test_organizations_authority_should_emit_warning(self):
703	        self._test_certain_authority_should_emit_warning(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
712	            "client_id", client_credential="secret",
713	            authority="https://login.microsoftonline.com/microsoft.onmicrosoft.com")
714	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
765	            "client_id",
766	            authority="https://login.microsoftonline.com/common",
767	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:778
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
777	                "client_id",
778	                authority="https://login.microsoftonline.com/common",
779	                enable_broker_on_mac=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
787	            "client_id",
788	            authority="https://login.microsoftonline.com/common",
789	            enable_broker_on_mac=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
754	@patch("msal.authority.tenant_discovery", new=Mock(return_value={
755	    "authorization_endpoint": "https://contoso.com/placeholder",
756	    "token_endpoint": "https://contoso.com/placeholder",
757	    }))
758	class TestMsalBehaviorWithoutPyMsalRuntimeOrBroker(unittest.TestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
755	    "authorization_endpoint": "https://contoso.com/placeholder",
756	    "token_endpoint": "https://contoso.com/placeholder",
757	    }))
758	class TestMsalBehaviorWithoutPyMsalRuntimeOrBroker(unittest.TestCase):
759	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
804	            "client_id",
805	            authority="https://login.microsoftonline.com/common",
806	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
811	            "client_id",
812	            authority="https://login.microsoftonline.com/common",
813	            enable_broker_on_mac=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
819	            "client_id",
820	            authority="https://contoso.com/adfs",
821	            #instance_discovery=False,  # Automatically skipped when detected ADFS
822	            enable_broker_on_mac=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
828	            "client_id",
829	            authority="https://contoso.b2clogin.com/contoso/policy",
830	            #instance_discovery=False,  # Automatically skipped when detected B2C
831	            enable_broker_on_mac=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
837	            "client_id",
838	            authority="https://contoso.com/path",
839	            instance_discovery=False,  # Need this for a generic authority url

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
847	            "client_id",
848	            oidc_authority="https://contoso.com/path",
849	            enable_broker_on_mac=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:857
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
856	            "client_id",
857	            authority="https://login.microsoftonline.com/common",
858	            enable_broker_on_mac=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
795	@patch("msal.authority.tenant_discovery", new=Mock(return_value={
796	    "authorization_endpoint": "https://contoso.com/placeholder",
797	    "token_endpoint": "https://contoso.com/placeholder",
798	    }))
799	@patch("msal.application._init_broker", new=Mock())  # Pretend pymsalruntime installed and working

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_application.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
796	    "authorization_endpoint": "https://contoso.com/placeholder",
797	    "token_endpoint": "https://contoso.com/placeholder",
798	    }))
799	@patch("msal.application._init_broker", new=Mock())  # Pretend pymsalruntime installed and working
800	class TestBrokerFallbackWithDifferentAuthorities(unittest.TestCase):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_assertion.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
11	        assertion = JwtAssertionCreator(key=None, algorithm="none").sign_assertion(
12	            "audience", "issuer", additional_claims={"client_ip": "1.2.3.4"})
13	        payload = json.loads(decode_part(assertion.split(b'.')[1].decode('utf-8')))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_assertion.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
13	        payload = json.loads(decode_part(assertion.split(b'.')[1].decode('utf-8')))
14	        self.assertEqual("1.2.3.4", payload.get("client_ip"))
15	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authcode.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	                    "<html>&lt;tag&gt;foo&lt;/tag&gt;</html>",
34	                    requests.get("http://localhost:{}?error=<tag>foo</tag>".format(
35	                        receiver.get_port())).text,
36	                    "Unsafe data in HTML should be escaped",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authcode.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	                    "<html>&lt;tag&gt;foo&lt;/tag&gt;</html>",
34	                    requests.get("http://localhost:{}?error=<tag>foo</tag>".format(
35	                        receiver.get_port())).text,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        c = MinimalHttpClient()
18	        a = Authority('https://{}/{}'.format(host, tenant), c)
19	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	            a.authorization_endpoint,
21	            'https://{}/{}/oauth2/v2.0/authorize'.format(host, tenant))
22	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	            a.token_endpoint,
24	            'https://{}/{}/oauth2/v2.0/token'.format(host, tenant))
25	        c.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	            a.authorization_endpoint,
32	            'https://{}/{}/oauth2/v2.0/authorize'.format(host, tenant))
33	        self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	            a.token_endpoint,
35	            'https://{}/{}/oauth2/v2.0/token'.format(host, tenant))
36	        c.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	        less_known = 'login.windows.net'  # less.known.host/
55	        v1_token_endpoint = 'https://{}/common/oauth2/token'.format(less_known)
56	        a = Authority(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        a = Authority(
57	            'https://{}/common'.format(less_known), MinimalHttpClient())
58	        self.assertEqual(a.token_endpoint, v1_token_endpoint)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	        with _assert(ValueError, "invalid_instance"):
67	            Authority('https://example.com/tenant_doesnt_matter_in_this_case',
68	                      MinimalHttpClient())
69	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	            Authority(
73	                'https://example.com/invalid',
74	                MinimalHttpClient(), validate_authority=False)
75	        except ValueError as e:
76	            if "invalid_instance" in str(e):  # Imprecise but good enough

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	    def test_path_less_authority_should_work(self, oidc_discovery):
90	        Authority('https://contoso.ciamlogin.com', self.http_client)
91	        oidc_discovery.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        oidc_discovery.assert_called_once_with(
92	            "https://contoso.ciamlogin.com/contoso.onmicrosoft.com/v2.0/.well-known/openid-configuration",
93	            self.http_client)
94	
95	    def test_authority_with_path_should_be_used_as_is(self, oidc_discovery):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	    def test_authority_with_path_should_be_used_as_is(self, oidc_discovery):
96	        Authority('https://contoso.ciamlogin.com/anything', self.http_client)
97	        oidc_discovery.assert_called_once_with(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	        oidc_discovery.assert_called_once_with(
98	            "https://contoso.ciamlogin.com/anything/v2.0/.well-known/openid-configuration",
99	            self.http_client)
100	
101	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	@patch("msal.authority.tenant_discovery", return_value={
83	    "authorization_endpoint": "https://contoso.com/placeholder",
84	    "token_endpoint": "https://contoso.com/placeholder",
85	    })
86	class TestCiamAuthority(unittest.TestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	    "authorization_endpoint": "https://contoso.com/placeholder",
84	    "token_endpoint": "https://contoso.com/placeholder",
85	    })
86	class TestCiamAuthority(unittest.TestCase):
87	    http_client = MinimalHttpClient()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	class OidcAuthorityTestCase(unittest.TestCase):
108	    authority = "https://contoso.com/tenant"
109	
110	    def setUp(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	        oidc_discovery.assert_called_once_with(self.oidc_discovery_endpoint, c)
124	        self.assertEqual(a.authorization_endpoint, 'https://contoso.com/authorize')
125	        self.assertEqual(a.token_endpoint, 'https://contoso.com/token')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	        self.assertEqual(a.authorization_endpoint, 'https://contoso.com/authorize')
125	        self.assertEqual(a.token_endpoint, 'https://contoso.com/token')
126	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	        self.assertEqual(
135	            app.authority.authorization_endpoint, 'https://contoso.com/authorize')
136	        self.assertEqual(app.authority.token_endpoint, 'https://contoso.com/token')
137	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	            app.authority.authorization_endpoint, 'https://contoso.com/authorize')
136	        self.assertEqual(app.authority.token_endpoint, 'https://contoso.com/token')
137	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
103	@patch("msal.authority.tenant_discovery", return_value={
104	    "authorization_endpoint": "https://contoso.com/authorize",
105	    "token_endpoint": "https://contoso.com/token",
106	    })
107	class OidcAuthorityTestCase(unittest.TestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	    "authorization_endpoint": "https://contoso.com/authorize",
105	    "token_endpoint": "https://contoso.com/token",
106	    })
107	class OidcAuthorityTestCase(unittest.TestCase):
108	    authority = "https://contoso.com/tenant"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	    authority = (  # dSTS is single tenanted with a tenant placeholder
142	        'https://test-instance1-dsts.dsts.core.azure-test.net/dstsv2/common')
143	    authorization_endpoint = (
144	        "https://some.url.dsts.core.azure-test.net/dstsv2/common/oauth2/authorize")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	    authorization_endpoint = (
144	        "https://some.url.dsts.core.azure-test.net/dstsv2/common/oauth2/authorize")
145	    token_endpoint = (
146	        "https://some.url.dsts.core.azure-test.net/dstsv2/common/oauth2/token")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	    token_endpoint = (
146	        "https://some.url.dsts.core.azure-test.net/dstsv2/common/oauth2/token")
147	
148	    @patch("msal.authority._instance_discovery")
149	    @patch("msal.authority.tenant_discovery", return_value={
150	        "authorization_endpoint": authorization_endpoint,
151	        "token_endpoint": token_endpoint,
152	    })  # We need to create new patches (i.e. mocks) for non-inherited test cases
153	    def test_application_obj_should_accept_dsts_url_as_an_authority(
154	            self, oidc_discovery, instance_discovery):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
166	    def test_canonicalize_tenant_followed_by_extra_paths(self):
167	        _, i, t = canonicalize("https://example.com/tenant/subpath?foo=bar#fragment")
168	        self.assertEqual("example.com", i)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
171	    def test_canonicalize_tenant_followed_by_extra_query(self):
172	        _, i, t = canonicalize("https://example.com/tenant?foo=bar#fragment")
173	        self.assertEqual("example.com", i)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	    def test_canonicalize_tenant_followed_by_extra_fragment(self):
177	        _, i, t = canonicalize("https://example.com/tenant#fragment")
178	        self.assertEqual("example.com", i)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
182	        with self.assertRaises(ValueError):
183	            canonicalize("http://non.https.example.com/tenant")
184	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	        with self.assertRaises(ValueError):
187	            canonicalize("https://no.tenant.example.com")
188	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
190	        with self.assertRaises(ValueError):
191	            canonicalize("https://no.tenant.example.com/")
192	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
197	        # We use a real authority so the constructor can finish tenant discovery
198	        authority = "https://login.microsoftonline.com/common"
199	        self.assertNotIn(authority, Authority._domains_without_user_realm_discovery)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
227	            self, instance_metadata, known_to_microsoft_validation, _):
228	        app = msal.ClientApplication("id", authority="https://login.microsoftonline.com/common")
229	        known_to_microsoft_validation.assert_not_called()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
236	        app = msal.ClientApplication(
237	            "id", authority="https://contoso.com/common", validate_authority=False)
238	        known_to_microsoft_validation.assert_not_called()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
244	        """Not strictly required, but when/if we already supported it, we better keep it"""
245	        app = msal.ClientApplication("id", authority="https://contoso.com/adfs")
246	        known_to_microsoft_validation.assert_not_called()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	        app = msal.ClientApplication(
254	            "id", authority="https://login.b2clogin.com/contoso/b2c_policy")
255	        known_to_microsoft_validation.assert_not_called()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
261	        for authority in [
262	                "https://login.microsoftonline.com/common",  # Known to Microsoft
263	                "https://contoso.com/adfs",  # ADFS
264	                "https://login.b2clogin.com/contoso/b2c_policy",  # B2C
265	                "https://private.cloud/foo",  # Private Cloud
266	                ]:
267	            self._test_turning_off_instance_discovery_should_skip_authority_validation_and_instance_metadata(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
262	                "https://login.microsoftonline.com/common",  # Known to Microsoft
263	                "https://contoso.com/adfs",  # ADFS
264	                "https://login.b2clogin.com/contoso/b2c_policy",  # B2C
265	                "https://private.cloud/foo",  # Private Cloud
266	                ]:
267	            self._test_turning_off_instance_discovery_should_skip_authority_validation_and_instance_metadata(
268	                authority, instance_metadata, known_to_microsoft_validation)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
263	                "https://contoso.com/adfs",  # ADFS
264	                "https://login.b2clogin.com/contoso/b2c_policy",  # B2C
265	                "https://private.cloud/foo",  # Private Cloud
266	                ]:
267	            self._test_turning_off_instance_discovery_should_skip_authority_validation_and_instance_metadata(
268	                authority, instance_metadata, known_to_microsoft_validation)
269	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	                "https://login.b2clogin.com/contoso/b2c_policy",  # B2C
265	                "https://private.cloud/foo",  # Private Cloud
266	                ]:
267	            self._test_turning_off_instance_discovery_should_skip_authority_validation_and_instance_metadata(
268	                authority, instance_metadata, known_to_microsoft_validation)
269	
270	    def _test_turning_off_instance_discovery_should_skip_authority_validation_and_instance_metadata(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
217	@patch("msal.authority.tenant_discovery", return_value={
218	    "authorization_endpoint": "https://contoso.com/placeholder",
219	    "token_endpoint": "https://contoso.com/placeholder",
220	    })
221	@patch("msal.authority._instance_discovery")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_authority.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	    "authorization_endpoint": "https://contoso.com/placeholder",
219	    "token_endpoint": "https://contoso.com/placeholder",
220	    })
221	@patch("msal.authority._instance_discovery")
222	@patch.object(msal.ClientApplication, "_get_instance_metadata", return_value=[])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_broker.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    _client_id = "04f0c124-f2bc-4f59-8241-bf6df9866bbd"  # Visual Studio
22	    _authority = "https://login.microsoftonline.com/common"
23	    _scopes = ["https://graph.microsoft.com/.default"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_broker.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    _authority = "https://login.microsoftonline.com/common"
23	    _scopes = ["https://graph.microsoft.com/.default"]
24	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_ccs.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        scopes = ["some", "scope"]
41	        authority_url = "https://login.microsoftonline.com/common"
42	        token_cache = msal.TokenCache()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
50	        with open(filename) as f:
51	            conf = json.load(f)
52	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	            discovery_uri = conf["oidp"] + '/.well-known/openid-configuration'
63	            openid_configuration.update(requests.get(discovery_uri).json())
64	        except:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	                "openid configuration uri not accesible: %s", discovery_uri)
67	    openid_configuration.update(conf.get("additional_openid_configuration", {}))
68	    if openid_configuration.get("device_authorization_endpoint"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	    openid_configuration.update(conf.get("additional_openid_configuration", {}))
68	    if openid_configuration.get("device_authorization_endpoint"):
69	        # The following urljoin(..., ...) trick allows a "path_name" shorthand

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        openid_configuration["device_authorization_endpoint"] = urljoin(
71	            openid_configuration.get("token_endpoint", ""),
72	            openid_configuration.get("device_authorization_endpoint", ""))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	            openid_configuration.get("token_endpoint", ""),
72	            openid_configuration.get("device_authorization_endpoint", ""))
73	    conf["openid_configuration"] = openid_configuration

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
98	            with open(os.path.join(THIS_FOLDER, private_key_path)) as f:
99	                private_key = f.read()  # Expecting PEM format
100	            cls.client = Client(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	                http_client=http_client,
118	                client_secret=CONFIG.get('client_secret'))
119	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	    def test_client_credentials(self):
125	        result = self.client.obtain_token_for_client(CONFIG.get('scope'))
126	        self.assertIn('access_token', result)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	    @unittest.skipIf(
121	        "token_endpoint" not in CONFIG.get("openid_configuration", {}),
122	        "token_endpoint missing")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	            CONFIG["username"], CONFIG["password"],
137	            data={"resource": CONFIG.get("resource")},  # MSFT AAD V1 only
138	            scope=CONFIG.get("scope"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
137	            data={"resource": CONFIG.get("resource")},  # MSFT AAD V1 only
138	            scope=CONFIG.get("scope"))
139	        self.assertLoosely(result)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	    @unittest.skipIf(
129	        "token_endpoint" not in CONFIG.get("openid_configuration", {}),
130	        "token_endpoint missing")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
144	    def test_auth_code(self):
145	        port = CONFIG.get("listen_port", 44331)
146	        redirect_uri = "http://localhost:%s" % port

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
145	        port = CONFIG.get("listen_port", 44331)
146	        redirect_uri = "http://localhost:%s" % port
147	        nonce = "nonce should contain sufficient entropy"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
150	            nonce=nonce,
151	            redirect_uri=redirect_uri, scope=CONFIG.get("scope"))
152	        ac = obtain_auth_code(port, auth_uri=auth_request_uri)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	            data={
157	                "scope": CONFIG.get("scope"),
158	                "resource": CONFIG.get("resource"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	                "scope": CONFIG.get("scope"),
158	                "resource": CONFIG.get("resource"),
159	                },  # MSFT AAD only

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	    @unittest.skipUnless(
142	        "authorization_endpoint" in CONFIG.get("openid_configuration", {}),
143	        "authorization_endpoint missing")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	    def test_auth_code_flow(self):
168	        with AuthCodeReceiver(port=CONFIG.get("listen_port")) as receiver:
169	            flow = self.client.initiate_auth_code_flow(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	            flow = self.client.initiate_auth_code_flow(
170	                redirect_uri="http://localhost:%d" % receiver.get_port(),
171	                scope=CONFIG.get("scope"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170	                redirect_uri="http://localhost:%d" % receiver.get_port(),
171	                scope=CONFIG.get("scope"),
172	                login_hint=CONFIG.get("username"),  # To skip the account selector

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	                scope=CONFIG.get("scope"),
172	                login_hint=CONFIG.get("username"),  # To skip the account selector
173	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	                        a=CONFIG["openid_configuration"]["authorization_endpoint"],
183	                        i=CONFIG.get("client_id")),
184	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	            self.assertIsNotNone(
186	                auth_response.get("code"), "Error: {}, Detail: {}".format(
187	                    auth_response.get("error"), auth_response))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
186	                auth_response.get("code"), "Error: {}, Detail: {}".format(
187	                    auth_response.get("error"), auth_response))
188	            result = self.client.obtain_token_by_auth_code_flow(flow, auth_response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	    @unittest.skipUnless(
165	        "authorization_endpoint" in CONFIG.get("openid_configuration", {}),
166	        "authorization_endpoint missing")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
211	        result = self.client.obtain_token_by_browser(
212	            scope=CONFIG.get("scope"),
213	            redirect_uri=CONFIG.get("redirect_uri"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	            scope=CONFIG.get("scope"),
213	            redirect_uri=CONFIG.get("redirect_uri"),
214	            welcome_template="""<html><body>

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	                    a=CONFIG["openid_configuration"]["authorization_endpoint"],
219	                    i=CONFIG.get("client_id")),
220	            success_template="<strong>Done. You can close this window now.</strong>",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	            success_template="<strong>Done. You can close this window now.</strong>",
221	            login_hint=CONFIG.get("username"),  # To skip the account selector
222	            timeout=60,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	    @unittest.skipUnless(
208	        "authorization_endpoint" in CONFIG.get("openid_configuration", {}),
209	        "authorization_endpoint missing")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	    def test_device_flow(self):
230	        flow = self.client.initiate_device_flow(scope=CONFIG.get("scope"))
231	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
226	    @unittest.skipUnless(
227	        CONFIG.get("openid_configuration", {}).get("device_authorization_endpoint"),
228	        "device_authorization_endpoint is missing")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
226	    @unittest.skipUnless(
227	        CONFIG.get("openid_configuration", {}).get("device_authorization_endpoint"),
228	        "device_authorization_endpoint is missing")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	@unittest.skipUnless("client_id" in CONFIG, "client_id missing")
82	@unittest.skipUnless(CONFIG.get("openid_configuration"), "openid_configuration missing")
83	class TestClient(Oauth2TestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
254	        client = Client(
255	            {"token_endpoint": "http://example.com/token"},
256	            "client_id",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
258	            on_obtaining_tokens=lambda event:
259	                self.assertEqual("new", event["response"].get("refresh_token")),
260	            on_updating_rt=lambda rt_item, new_rt:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	        client = Client(
268	            {"token_endpoint": "http://example.com/token"},
269	            "client_id",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	        client = Client(
282	            {"token_endpoint": "http://example.com/token"},
283	            "client_id",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
285	            on_obtaining_tokens=lambda event:
286	                self.assertEqual("new", event["response"].get("refresh_token")),
287	            on_updating_rt=lambda rt_item, new_rt:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_client.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
295	    def test_accessing_session_property_for_backward_compatibility(self):
296	        client = Client({"token_endpoint": "https://example.com"}, "client_id")
297	        client.session

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cloudshell.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	        for scope, expected_resource in {
8	            "https://analysis.windows.net/powerbi/api/foo":
9	                "https://analysis.windows.net/powerbi/api",  # A special case
10	            "https://pas.windows.net/CheckMyAccess/Linux/.default":
11	                "https://pas.windows.net/CheckMyAccess/Linux/.default",  # Special case
12	            "https://double-slash.com//scope": "https://double-slash.com/",
13	            "https://single-slash.com/scope": "https://single-slash.com",
14	            "guid/some/scope": "guid",
15	            "6dae42f8-4368-4678-94ff-3960e28e3630/.default":
16	                # The real guid of AKS resource
17	                # https://learn.microsoft.com/en-us/azure/aks/kubelogin-authentication#how-to-use-kubelogin-with-aks
18	                "6dae42f8-4368-4678-94ff-3960e28e3630",
19	        }.items():
20	            self.assertEqual(_scope_to_resource(scope), expected_resource)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cloudshell.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	                "https://analysis.windows.net/powerbi/api",  # A special case
10	            "https://pas.windows.net/CheckMyAccess/Linux/.default":
11	                "https://pas.windows.net/CheckMyAccess/Linux/.default",  # Special case
12	            "https://double-slash.com//scope": "https://double-slash.com/",
13	            "https://single-slash.com/scope": "https://single-slash.com",
14	            "guid/some/scope": "guid",
15	            "6dae42f8-4368-4678-94ff-3960e28e3630/.default":
16	                # The real guid of AKS resource
17	                # https://learn.microsoft.com/en-us/azure/aks/kubelogin-authentication#how-to-use-kubelogin-with-aks
18	                "6dae42f8-4368-4678-94ff-3960e28e3630",
19	        }.items():
20	            self.assertEqual(_scope_to_resource(scope), expected_resource)
21	
22	if __name__ == '__main__':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cloudshell.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	                "https://pas.windows.net/CheckMyAccess/Linux/.default",  # Special case
12	            "https://double-slash.com//scope": "https://double-slash.com/",
13	            "https://single-slash.com/scope": "https://single-slash.com",
14	            "guid/some/scope": "guid",
15	            "6dae42f8-4368-4678-94ff-3960e28e3630/.default":
16	                # The real guid of AKS resource
17	                # https://learn.microsoft.com/en-us/azure/aks/kubelogin-authentication#how-to-use-kubelogin-with-aks
18	                "6dae42f8-4368-4678-94ff-3960e28e3630",
19	        }.items():
20	            self.assertEqual(_scope_to_resource(scope), expected_resource)
21	
22	if __name__ == '__main__':
23	    unittest.main()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cloudshell.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	            "https://double-slash.com//scope": "https://double-slash.com/",
13	            "https://single-slash.com/scope": "https://single-slash.com",
14	            "guid/some/scope": "guid",
15	            "6dae42f8-4368-4678-94ff-3960e28e3630/.default":
16	                # The real guid of AKS resource
17	                # https://learn.microsoft.com/en-us/azure/aks/kubelogin-authentication#how-to-use-kubelogin-with-aks
18	                "6dae42f8-4368-4678-94ff-3960e28e3630",
19	        }.items():
20	            self.assertEqual(_scope_to_resource(scope), expected_resource)
21	
22	if __name__ == '__main__':
23	    unittest.main()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cloudshell.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	            "https://analysis.windows.net/powerbi/api/foo":
9	                "https://analysis.windows.net/powerbi/api",  # A special case
10	            "https://pas.windows.net/CheckMyAccess/Linux/.default":
11	                "https://pas.windows.net/CheckMyAccess/Linux/.default",  # Special case
12	            "https://double-slash.com//scope": "https://double-slash.com/",
13	            "https://single-slash.com/scope": "https://single-slash.com",
14	            "guid/some/scope": "guid",
15	            "6dae42f8-4368-4678-94ff-3960e28e3630/.default":
16	                # The real guid of AKS resource
17	                # https://learn.microsoft.com/en-us/azure/aks/kubelogin-authentication#how-to-use-kubelogin-with-aks
18	                "6dae42f8-4368-4678-94ff-3960e28e3630",
19	        }.items():
20	            self.assertEqual(_scope_to_resource(scope), expected_resource)
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cloudshell.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	            "https://pas.windows.net/CheckMyAccess/Linux/.default":
11	                "https://pas.windows.net/CheckMyAccess/Linux/.default",  # Special case
12	            "https://double-slash.com//scope": "https://double-slash.com/",
13	            "https://single-slash.com/scope": "https://single-slash.com",
14	            "guid/some/scope": "guid",
15	            "6dae42f8-4368-4678-94ff-3960e28e3630/.default":
16	                # The real guid of AKS resource
17	                # https://learn.microsoft.com/en-us/azure/aks/kubelogin-authentication#how-to-use-kubelogin-with-aks
18	                "6dae42f8-4368-4678-94ff-3960e28e3630",
19	        }.items():
20	            self.assertEqual(_scope_to_resource(scope), expected_resource)
21	
22	if __name__ == '__main__':
23	    unittest.main()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cloudshell.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	                "https://pas.windows.net/CheckMyAccess/Linux/.default",  # Special case
12	            "https://double-slash.com//scope": "https://double-slash.com/",
13	            "https://single-slash.com/scope": "https://single-slash.com",
14	            "guid/some/scope": "guid",
15	            "6dae42f8-4368-4678-94ff-3960e28e3630/.default":
16	                # The real guid of AKS resource
17	                # https://learn.microsoft.com/en-us/azure/aks/kubelogin-authentication#how-to-use-kubelogin-with-aks
18	                "6dae42f8-4368-4678-94ff-3960e28e3630",
19	        }.items():
20	            self.assertEqual(_scope_to_resource(scope), expected_resource)
21	
22	if __name__ == '__main__':
23	    unittest.main()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cloudshell.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	            "https://double-slash.com//scope": "https://double-slash.com/",
13	            "https://single-slash.com/scope": "https://single-slash.com",
14	            "guid/some/scope": "guid",
15	            "6dae42f8-4368-4678-94ff-3960e28e3630/.default":
16	                # The real guid of AKS resource
17	                # https://learn.microsoft.com/en-us/azure/aks/kubelogin-authentication#how-to-use-kubelogin-with-aks
18	                "6dae42f8-4368-4678-94ff-3960e28e3630",
19	        }.items():
20	            self.assertEqual(_scope_to_resource(scope), expected_resource)
21	
22	if __name__ == '__main__':
23	    unittest.main()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cryptography.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
14	latest_cryptography_version = ET.fromstring(
15	    requests.get("https://pypi.org/rss/project/cryptography/releases.xml").text
16	    ).findall("./channel/item/title")[0].text

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cryptography.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	latest_cryptography_version = ET.fromstring(
15	    requests.get("https://pypi.org/rss/project/cryptography/releases.xml").text
16	    ).findall("./channel/item/title")[0].text

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cryptography.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	    parser = configparser.ConfigParser()
21	    parser.read("setup.cfg")
22	    for line in parser["options"]["install_requires"].splitlines():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cryptography.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	            with open(sibling("certificate-with-password.pem")) as f:
48	                _load_private_key_from_pem_str(f.read(), passphrase_bytes)
49	            pfx = sibling("certificate-with-password.pfx")  # Created by:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_cryptography.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	            expected_ceiling, get_current_ceiling(),
59	            "Test passed with latest cryptography, so we shall bump ceiling to N+3={}, "
60	            "based on their latest deprecation policy "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        client_secret=None,
50	        authority="https://login.microsoftonline.com/common",
51	        port=44331,
52	        scopes=["https://graph.microsoft.com/.default"],  # Microsoft Graph
53	        **kwargs):
54	    from msal.oauth2cli.authcode import obtain_auth_code
55	    if client_secret:
56	        app = msal.ConfidentialClientApplication(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	        port=44331,
52	        scopes=["https://graph.microsoft.com/.default"],  # Microsoft Graph
53	        **kwargs):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	            client_id, authority=authority, http_client=MinimalHttpClient())
63	    redirect_uri = "http://localhost:%d" % port
64	    ac = obtain_auth_code(port, auth_uri=app.get_authorization_request_url(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	        lab=_render(
82	            "https://aka.ms/GetLabSecret?Secret=" + (lab_name or "msidlabXYZ"),
83	            description="this password api" if html_mode else None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	            skippable_errors=("invalid_grant", "interaction_required")):
93	        if response.get("error") in skippable_errors:
94	            logger.debug("Response = %s", response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	            # Some of these errors are configuration issues, not library issues
96	            raise unittest.SkipTest(response.get("error_description"))
97	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	                        # Do explicit response.get(...) rather than **response
103	                        error=response.get("error"),
104	                        error_description=response.get("error_description")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	                        error=response.get("error"),
104	                        error_description=response.get("error_description")))
105	            assertion()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	            json.dumps(self.app.token_cache._cache, indent=4),
113	            json.dumps(result_from_wire.get("id_token_claims"), indent=4),
114	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	            self.assertIsNone(
128	                silent_result.get("refresh_token"), "acquire_token_silent() should return no RT")
129	            if auth_scheme:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	            json.dumps(self.app.token_cache._cache, indent=4),
158	            json.dumps(result_from_wire.get("id_token_claims"), indent=4),
159	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
171	            client_credential=None,
172	            authority="https://login.microsoftonline.com/common",
173	            oidc_authority=None,
174	            scopes=["https://graph.microsoft.com/.default"],  # Microsoft Graph
175	            http_client=None,
176	            azure_region=None,
177	            **kwargs):
178	        if client_credential:
179	            return msal.ConfidentialClientApplication(
180	                client_id,
181	                client_credential=client_credential,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	            oidc_authority=None,
174	            scopes=["https://graph.microsoft.com/.default"],  # Microsoft Graph
175	            http_client=None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
296	                # Note: No interpolation here, cause error won't always present
297	                error=result.get("error"),
298	                error_description=result.get("error_description")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
297	                error=result.get("error"),
298	                error_description=result.get("error_description")))
299	        if username and result.get("id_token_claims", {}).get("preferred_username"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
298	                error_description=result.get("error_description")))
299	        if username and result.get("id_token_claims", {}).get("preferred_username"):
300	            self.assertEqual(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
298	                error_description=result.get("error_description")))
299	        if username and result.get("id_token_claims", {}).get("preferred_username"):
300	            self.assertEqual(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
312	class CloudShellTestCase(E2eTestCase):
313	    scope_that_requires_no_managed_device = "https://management.core.windows.net/"  # Scopes came from https://msazure.visualstudio.com/One/_git/compute-CloudShell?path=/src/images/agent/env/envconfig.PROD.json&version=GBmaster&_a=contents
314	
315	    def setUpClass(cls):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
323	        self.assertEqual(
324	            "Bearer", result.get("token_type"), "Unexpected result: %s" % result)
325	        self.assertIsNotNone(result.get("access_token"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
324	            "Bearer", result.get("token_type"), "Unexpected result: %s" % result)
325	        self.assertIsNotNone(result.get("access_token"))
326	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
337	        with open(CONFIG) as f:
338	            cls.config = json.load(f)
339	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
351	            self.config["client_id"],
352	            client_secret=self.config.get("client_secret"),
353	            authority=self.config.get("authority"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
352	            client_secret=self.config.get("client_secret"),
353	            authority=self.config.get("authority"),
354	            port=self.config.get("listen_port", 44331),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
353	            authority=self.config.get("authority"),
354	            port=self.config.get("listen_port", 44331),
355	            scopes=scopes or self.config["scope"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
368	                # Note: No interpolation here, cause error won't always present
369	                error=result.get("error"),
370	                error_description=result.get("error_description")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
369	                error=result.get("error"),
370	                error_description=result.get("error_description")))
371	        self.assertCacheWorksForUser(result, self.config["scope"], username=None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
389	            self.config["client_id"],
390	            client_credential=self.config.get("client_secret"),
391	            authority=self.config.get("authority"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
390	            client_credential=self.config.get("client_secret"),
391	            authority=self.config.get("authority"),
392	            http_client=MinimalHttpClient())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
392	            http_client=MinimalHttpClient())
393	        scope = self.config.get("scope", [])
394	        result = self.app.acquire_token_for_client(scope)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
402	        with open(os.path.join(THIS_FOLDER, client_cert['private_key_path'])) as f:
403	            private_key = f.read()  # Should be in PEM format
404	        self.app = msal.ConfidentialClientApplication(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	            http_client=MinimalHttpClient())
408	        scope = self.config.get("scope", [])
409	        result = self.app.acquire_token_for_client(scope)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
419	        with open(os.path.join(THIS_FOLDER, client_cert['private_key_path'])) as f:
420	            private_key = f.read()  # Should be in PEM format
421	        with open(os.path.join(THIS_FOLDER, client_cert['public_certificate'])) as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
421	        with open(os.path.join(THIS_FOLDER, client_cert['public_certificate'])) as f:
422	            public_certificate = f.read()
423	        self.app = msal.ConfidentialClientApplication(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
430	            http_client=MinimalHttpClient())
431	        scope = self.config.get("scope", [])
432	        result = self.app.acquire_token_for_client(scope)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
441	            http_client=MinimalHttpClient())
442	        scope = self.config.get("scope", [])
443	        result = self.app.acquire_token_for_client(scope)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
451	        with open(CONFIG) as f:
452	            cls.config = json.load(f)
453	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
461	        env_client_cert_path="LAB_APP_CLIENT_CERT_PFX_PATH",
462	        authority="https://login.microsoftonline.com/"
463	            "72f988bf-86f1-41af-91ab-2d7cd011db47",  # Microsoft tenant ID
464	        timeout=None,
465	        **kwargs):
466	    """Returns the lab app as an MSAL confidential client.
467	
468	    Get it from environment variables if defined, otherwise fall back to use MSI.
469	    """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
470	    logger.info(
471	        "Reading ENV variables %s and %s for lab app defined at "
472	        "https://docs.msidlab.com/accounts/confidentialclient.html",
473	        env_client_id, env_name2)
474	    if os.getenv(env_client_id) and os.getenv(env_client_cert_path):
475	        # id came from https://docs.msidlab.com/accounts/confidentialclient.html

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
504	    result = lab_app.acquire_token_for_client(scopes)
505	    if not result.get("access_token"):
506	        raise LabTokenError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
507	            "Unable to obtain token for lab. Encountered {}: {}".format(
508	            result.get("error"), result.get("error_description")
509	        ))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
507	            "Unable to obtain token for lab. Encountered {}: {}".format(
508	            result.get("error"), result.get("error_description")
509	        ))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
526	        cls.session = get_session(get_lab_app(), [
527	                "https://request.msidlab.com/.default",  # A lab change since June 10, 2024
528	            ])
529	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
535	    def get_lab_app_object(cls, client_id=None, **query):  # https://msidlab.com/swagger/index.html
536	        url = "https://msidlab.com/api/app/{}".format(client_id or "")
537	        resp = cls.session.get(url, params=query)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
536	        url = "https://msidlab.com/api/app/{}".format(client_id or "")
537	        resp = cls.session.get(url, params=query)
538	        result = resp.json()[0]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
547	            logger.info("Querying lab user password for %s", lab_name)
548	            url = "https://msidlab.com/api/LabSecret?secret=%s" % lab_name
549	            resp = cls.session.get(url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
548	            url = "https://msidlab.com/api/LabSecret?secret=%s" % lab_name
549	            resp = cls.session.get(url)
550	            cls._secrets[lab_name] = resp.json()["value"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
554	    def get_lab_user(cls, **query):  # https://docs.msidlab.com/labapi/userapi.html
555	        resp = cls.session.get("https://msidlab.com/api/user", params=query)
556	        result = resp.json()[0]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
554	    def get_lab_user(cls, **query):  # https://docs.msidlab.com/labapi/userapi.html
555	        resp = cls.session.get("https://msidlab.com/api/user", params=query)
556	        result = resp.json()[0]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
556	        result = resp.json()[0]
557	        assert result.get("upn"), "Found no test user but {}".format(
558	            json.dumps(result, indent=2))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
558	            json.dumps(result, indent=2))
559	        _env = query.get("azureenvironment", "").lower()
560	        authority_base = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
559	        _env = query.get("azureenvironment", "").lower()
560	        authority_base = {
561	            "azureusgovernment": "https://login.microsoftonline.us/"
562	            }.get(_env, "https://login.microsoftonline.com/")
563	        scope = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
560	        authority_base = {
561	            "azureusgovernment": "https://login.microsoftonline.us/"
562	            }.get(_env, "https://login.microsoftonline.com/")
563	        scope = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
561	            "azureusgovernment": "https://login.microsoftonline.us/"
562	            }.get(_env, "https://login.microsoftonline.com/")
563	        scope = {
564	            "azureusgovernment": ["https://graph.microsoft.us/.default"],
565	            }.get(_env, ["https://graph.microsoft.com/.default"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
562	            }.get(_env, "https://login.microsoftonline.com/")
563	        scope = {
564	            "azureusgovernment": ["https://graph.microsoft.us/.default"],
565	            }.get(_env, ["https://graph.microsoft.com/.default"])
566	        return {  # Mapping lab API response to our simplified configuration format

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
563	        scope = {
564	            "azureusgovernment": ["https://graph.microsoft.us/.default"],
565	            }.get(_env, ["https://graph.microsoft.com/.default"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
564	            "azureusgovernment": ["https://graph.microsoft.us/.default"],
565	            }.get(_env, ["https://graph.microsoft.com/.default"])
566	        return {  # Mapping lab API response to our simplified configuration format

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
586	            json.dumps(self.app.token_cache._cache, indent=4),
587	            json.dumps(result.get("id_token_claims"), indent=4),
588	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
592	                # Note: No interpolation here, cause error won't always present
593	                error=result.get("error"),
594	                error_description=result.get("error_description")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
593	                error=result.get("error"),
594	                error_description=result.get("error_description")))
595	        self.assertCacheWorksForUser(result, scope, username=None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
608	                scope,
609	                redirect_uri="http://localhost:%d" % receiver.get_port(),
610	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
622	        self.assertIsNotNone(
623	            auth_response.get("code"), "Error: {}, Detail: {}".format(
624	                auth_response.get("error"), auth_response))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
623	            auth_response.get("code"), "Error: {}, Detail: {}".format(
624	                auth_response.get("error"), auth_response))
625	        result = self.app.acquire_token_by_auth_code_flow(flow, auth_response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
629	            json.dumps(self.app.token_cache._cache, indent=4),
630	            json.dumps(result.get("id_token_claims"), indent=4),
631	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
635	                # Note: No interpolation here, cause error won't always present
636	                error=result.get("error"),
637	                error_description=result.get("error_description")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
636	                error=result.get("error"),
637	                error_description=result.get("error_description")))
638	        if username and result.get("id_token_claims", {}).get("preferred_username"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
637	                error_description=result.get("error_description")))
638	        if username and result.get("id_token_claims", {}).get("preferred_username"):
639	            self.assertEqual(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
637	                error_description=result.get("error_description")))
638	        if username and result.get("id_token_claims", {}).get("preferred_username"):
639	            self.assertEqual(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
667	                ).acquire_token_for_client(scopes=config_pca["scope"])
668	        assertion = result.get("access_token")
669	        self.assertIsNotNone(assertion, "First app failed to get AT. {}".format(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
683	        cca_result = cca.acquire_token_on_behalf_of(assertion, config_cca["scope"])
684	        self.assertIsNotNone(cca_result.get("access_token"), "OBO call failed: {}".format(
685	            json.dumps(cca_result, indent=2)))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
692	        #    the following part shows one of the ways to obtain an AT from cache.
693	        username = cca_result.get("id_token_claims", {}).get("preferred_username")
694	        accounts = cca.get_accounts(username=username)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
692	        #    the following part shows one of the ways to obtain an AT from cache.
693	        username = cca_result.get("id_token_claims", {}).get("preferred_username")
694	        accounts = cca.get_accounts(username=username)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
700	        self.assertTrue(
701	            result and result.get("access_token") == cca_result["access_token"],
702	            "CCA should hit an access token from cache: {}".format(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
726	        result = self.app.acquire_token_for_client(scope)
727	        self.assertIsNotNone(result.get("access_token"), "Got %s instead" % result)
728	        self.assertCacheWorksForApp(result, scope)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
734	        result = app.acquire_token_for_client(self.SCOPE, data=self.DATA1)
735	        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format(
736	            result.get("error"), result.get("error_description")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
735	        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format(
736	            result.get("error"), result.get("error_description")))
737	        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
735	        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format(
736	            result.get("error"), result.get("error_description")))
737	        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
742	        self.assertIsNotNone(
743	            cached_result.get("access_token"), "Encountered {}: {}".format(
744	            cached_result.get("error"), cached_result.get("error_description")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
743	            cached_result.get("access_token"), "Encountered {}: {}".format(
744	            cached_result.get("error"), cached_result.get("error_description")))
745	        self.assertEqual(self.EXPECTED_TOKEN_TYPE, cached_result["token_type"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
743	            cached_result.get("access_token"), "Encountered {}: {}".format(
744	            cached_result.get("error"), cached_result.get("error_description")))
745	        self.assertEqual(self.EXPECTED_TOKEN_TYPE, cached_result["token_type"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
750	        self.assertIsNotNone(
751	            refreshed_result.get("access_token"), "Encountered {}: {}".format(
752	            refreshed_result.get("error"), refreshed_result.get("error_description")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
751	            refreshed_result.get("access_token"), "Encountered {}: {}".format(
752	            refreshed_result.get("error"), refreshed_result.get("error_description")))
753	        self.assertEqual(self.EXPECTED_TOKEN_TYPE, refreshed_result["token_type"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
751	            refreshed_result.get("access_token"), "Encountered {}: {}".format(
752	            refreshed_result.get("error"), refreshed_result.get("error_description")))
753	        self.assertEqual(self.EXPECTED_TOKEN_TYPE, refreshed_result["token_type"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:761
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
760	                # of the only 2 clients that are PreAuthz to use ssh cert feature
761	            authority="https://login.microsoftonline.com/common",
762	            scope=self.SCOPE,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
768	                # acquire_token_silent() would work because we pass in the same key
769	        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format(
770	            result.get("error"), result.get("error_description")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
769	        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format(
770	            result.get("error"), result.get("error_description")))
771	        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
769	        self.assertIsNotNone(result.get("access_token"), "Encountered {}: {}".format(
770	            result.get("error"), result.get("error_description")))
771	        self.assertEqual(self.EXPECTED_TOKEN_TYPE, result["token_type"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
803	    DATA2 = {"token_type": "ssh-cert", "key_id": "key2", "req_cnf": _JWK2}
804	    _SCOPE_USER = ["https://pas.windows.net/CheckMyAccess/Linux/user_impersonation"]
805	    _SCOPE_SP = ["https://pas.windows.net/CheckMyAccess/Linux/.default"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
804	    _SCOPE_USER = ["https://pas.windows.net/CheckMyAccess/Linux/user_impersonation"]
805	    _SCOPE_SP = ["https://pas.windows.net/CheckMyAccess/Linux/.default"]
806	    SCOPE = _SCOPE_SP  # Historically there was a separation, at 2021 it is unified

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
819	        'key_id': key,
820	        "req_cnf": base64.urlsafe_b64encode(raw_req_cnf.encode('utf-8')).decode('utf-8').rstrip('='),
821	            # Note: Sending raw_req_cnf without base64 encoding would result in an http 500 error

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:887
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
886	            self.get_lab_user(usertype="cloud"),  # This is generally not the current laptop's default AAD account
887	            authority="https://login.microsoftonline.com/organizations",
888	            client_id="04b07795-8ddb-461a-bbee-02f9e1bf7b46",  # Azure CLI is an MSA-PT app

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
895	        config = self.get_lab_user(usertype="onprem", federationProvider="ADFSv2019")
896	        config["authority"] = "https://fs.%s.com/adfs" % config["lab_name"]
897	        config["scope"] = self.adfs2019_scopes

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
908	        config = self.get_lab_user(usertype="onprem", federationProvider="ADFSv2019")
909	        config["authority"] = "https://fs.%s.com/adfs" % config["lab_name"]
910	        config["scope"] = self.adfs2019_scopes

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
917	            config,
918	            authority="https://fs.%s.com/adfs" % config["lab_name"],
919	            scope=self.adfs2019_scopes,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:927
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
926	            config,
927	            authority="https://fs.%s.com/adfs" % config["lab_name"],
928	            scope=self.adfs2019_scopes,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
946	        config_cca["client_id"] = os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID")
947	        config_cca["scope"] = ["https://graph.microsoft.com/.default"]
948	        config_cca["client_secret"] = os.getenv("LAB_OBO_CLIENT_SECRET")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
933	        os.getenv("LAB_OBO_CLIENT_SECRET"),
934	        "Need LAB_OBO_CLIENT_SECRET from https://aka.ms/GetLabSecret?Secret=TodoListServiceV2-OBO")
935	    @unittest.skipUnless(
936	        os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID"),
937	        "Need LAB_OBO_CONFIDENTIAL_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
936	        os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID"),
937	        "Need LAB_OBO_CONFIDENTIAL_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")
938	    @unittest.skipUnless(
939	        os.getenv("LAB_OBO_PUBLIC_CLIENT_ID"),
940	        "Need LAB_OBO_PUBLIC_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
939	        os.getenv("LAB_OBO_PUBLIC_CLIENT_ID"),
940	        "Need LAB_OBO_PUBLIC_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")
941	    def test_acquire_token_obo(self):
942	        config = self.get_lab_user(usertype="cloud")
943	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
961	    def test_acquire_token_obo_for_sp(self):
962	        authority = "https://login.windows-ppe.net/f686d426-8d16-42db-81b7-ab578e110ccd"
963	        with open("tests/sp_obo.pem") as pem:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
964	            client_secret = {
965	                "private_key": pem.read(),
966	                "thumbprint": "378938210C976692D7F523B8C4FFBB645D17CE92",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
992	                _app["authority"], _app["labName"].lower().rstrip(".com")),
993	            scope=["https://graph.microsoft.com/.default"],
994	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1010
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1009	        config["client_id"] = os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID")
1010	        config["scope"] = ["https://graph.microsoft.com/.default"]
1011	        config["client_secret"] = os.getenv("LAB_OBO_CLIENT_SECRET")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
997	        os.getenv("LAB_OBO_CLIENT_SECRET"),
998	        "Need LAB_OBO_CLIENT_SECRET from https://aka.ms/GetLabSecret?Secret=TodoListServiceV2-OBO")
999	    @unittest.skipUnless(
1000	        os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID"),
1001	        "Need LAB_OBO_CONFIDENTIAL_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1000	        os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID"),
1001	        "Need LAB_OBO_CONFIDENTIAL_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")
1002	    def test_confidential_client_acquire_token_by_username_password(self):
1003	        # This approach won't work:
1004	        #       config = self.get_lab_user(usertype="cloud", publicClient="no")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1014	    def _build_b2c_authority(self, policy):
1015	        base = "https://msidlabb2c.b2clogin.com/msidlabb2c.onmicrosoft.com"
1016	        return base + "/" + policy  # We do not support base + "?p=" + policy

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1082
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1081	        self._test_acquire_token_interactive(
1082	            authority=self.app_config.get("authority"),
1083	            oidc_authority=self.app_config.get("oidc_authority"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1083
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1082	            authority=self.app_config.get("authority"),
1083	            oidc_authority=self.app_config.get("oidc_authority"),
1084	            client_id=self.app_config["appId"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1100	            client_secret=self.get_lab_user_secret(secret_name),
1101	            authority=self.app_config.get("authority"),
1102	            oidc_authority=self.app_config.get("oidc_authority"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1101	            authority=self.app_config.get("authority"),
1102	            oidc_authority=self.app_config.get("oidc_authority"),
1103	            scope=self.app_config["scopes"],  # It shall ends with "/.default"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1114	        self._test_username_password(
1115	            authority=self.app_config.get("authority"),
1116	            oidc_authority=self.app_config.get("oidc_authority"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1115	            authority=self.app_config.get("authority"),
1116	            oidc_authority=self.app_config.get("oidc_authority"),
1117	            client_id=self.app_config["appId"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1126	        self._test_device_flow(
1127	            authority=self.app_config.get("authority"),
1128	            oidc_authority=self.app_config.get("oidc_authority"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1127	            authority=self.app_config.get("authority"),
1128	            oidc_authority=self.app_config.get("oidc_authority"),
1129	            client_id=self.app_config["appId"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1140	            # Derived from https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/blob/4.63.0/tests/Microsoft.Identity.Test.Integration.netcore/HeadlessTests/CiamIntegrationTests.cs#L156
1141	            "https://login.msidlabsciam.com/fe362aec-5d43-45d1-b730-9755e60dc3b9/v2.0")
1142	
1143	
1144	class WorldWideRegionalEndpointTestCase(LabBasedTestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1154	            #validate_authority=False,
1155	            authority="https://login.microsoftonline.com/microsoft.onmicrosoft.com",
1156	            azure_region=configured_region,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1158	            )
1159	        scopes = ["https://graph.microsoft.com/.default"]
1160	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1167	            mocked_method.assert_called_with(
1168	                'https://{}/{}/oauth2/v2.0/token'.format(
1169	                    expected_host, self.app.authority.tenant),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1228	        config_cca["client_id"] = os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID")
1229	        config_cca["scope"] = ["https://graph.microsoft.com/.default"]
1230	        config_cca["client_secret"] = os.getenv("LAB_OBO_CLIENT_SECRET")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1214	        os.getenv("LAB_OBO_CLIENT_SECRET"),
1215	        "Need LAB_OBO_CLIENT_SECRET from https://aka.ms/GetLabSecret?Secret=TodoListServiceV2-OBO")
1216	    @unittest.skipUnless(
1217	        os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID"),
1218	        "Need LAB_OBO_CONFIDENTIAL_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1217	        os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID"),
1218	        "Need LAB_OBO_CONFIDENTIAL_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")
1219	    @unittest.skipUnless(
1220	        os.getenv("LAB_OBO_PUBLIC_CLIENT_ID"),
1221	        "Need LAB_OBO_PUBLIC_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1220	        os.getenv("LAB_OBO_PUBLIC_CLIENT_ID"),
1221	        "Need LAB_OBO_PUBLIC_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")
1222	    def test_cca_obo_should_bypass_regional_endpoint_therefore_still_work(self):
1223	        """We test OBO because it is implemented in sub class ConfidentialClientApplication"""
1224	        config = self.get_lab_user(usertype="cloud")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1256	        config["client_id"] = os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID")
1257	        config["scope"] = ["https://graph.microsoft.com/.default"]
1258	        config["client_secret"] = os.getenv("LAB_OBO_CLIENT_SECRET")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1245	        os.getenv("LAB_OBO_CLIENT_SECRET"),
1246	        "Need LAB_OBO_CLIENT_SECRET from https://aka.ms/GetLabSecret?Secret=TodoListServiceV2-OBO")
1247	    @unittest.skipUnless(
1248	        os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID"),
1249	        "Need LAB_OBO_CONFIDENTIAL_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1248	        os.getenv("LAB_OBO_CONFIDENTIAL_CLIENT_ID"),
1249	        "Need LAB_OBO_CONFIDENTIAL_CLIENT_ID from https://docs.msidlab.com/flows/onbehalfofflow.html")
1250	    def test_cca_ropc_should_bypass_regional_endpoint_therefore_still_work(self):
1251	        """We test ROPC because it is implemented in base class ClientApplication"""
1252	        config = self.get_lab_user(usertype="cloud")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1280	            usertype="cloud", azureenvironment=self.environment, publicClient="no")
1281	        config_cca["scope"] = ["https://graph.microsoft.us/.default"]
1282	        config_cca["client_secret"] = self.get_lab_user_secret("ARLMSIDLAB1-IDLASBS-App-CC-Secret")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1287	        config_pca["password"] = self.get_lab_user_secret(config_pca["lab_name"])
1288	        config_pca["scope"] = ["{app_uri}/files.read".format(app_uri=obo_app_object.get("identifierUris"))]
1289	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1314	            http_method=msal.PopAuthScheme.HTTP_GET,
1315	            url="https://www.Contoso.com/Path1/Path2?queryParam1=a&queryParam2=b",
1316	            nonce="placeholder",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1320	            client_id=_AZURE_CLI,
1321	            authority="https://login.microsoftonline.com/organizations",
1322	            scope=["https://management.azure.com/.default"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1321	            authority="https://login.microsoftonline.com/organizations",
1322	            scope=["https://management.azure.com/.default"],
1323	            auth_scheme=auth_scheme,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1339	            http_method="POST",
1340	            url="https://www.Contoso.com/Path1/Path2?queryParam1=a&queryParam2=b",
1341	            nonce=requests.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1340	            url="https://www.Contoso.com/Path1/Path2?queryParam1=a&queryParam2=b",
1341	            nonce=requests.get(
1342	                # TODO: Could use ".../missing" and then parse its WWW-Authenticate header
1343	                "https://testingsts.azurewebsites.net/servernonce/get").text,
1344	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1342	                # TODO: Could use ".../missing" and then parse its WWW-Authenticate header
1343	                "https://testingsts.azurewebsites.net/servernonce/get").text,
1344	            )
1345	        config = self.get_lab_user(usertype="cloud")
1346	        config["password"] = self.get_lab_user_secret(config["lab_name"])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1356	
1357	        validation = requests.post(
1358	            # TODO: This endpoint does not seem to validate the url
1359	            "https://testingsts.azurewebsites.net/servernonce/validateshr",
1360	            data={"SHR": shr},
1361	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1358	            # TODO: This endpoint does not seem to validate the url
1359	            "https://testingsts.azurewebsites.net/servernonce/validateshr",
1360	            data={"SHR": shr},
1361	            )
1362	        self.assertEqual(validation.status_code, 200)
1363	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1372	
1373	        api_endpoint = "https://20.190.132.47/beta/me"
1374	        verify = True  # Hopefully this will make CodeQL happy

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1383	        # @suppress py/bandit/requests-ssl-verify-disabled
1384	        resp = requests.get(api_endpoint, verify=verify)  # CodeQL [SM03157]
1385	        self.assertEqual(resp.status_code, 401, "Initial call should end with an http 401 error")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1387	            self.get_lab_user(usertype="cloud"),  # This is generally not the current laptop's default AAD account
1388	            scope=["https://graph.microsoft.com/.default"],
1389	            auth_scheme=msal.PopAuthScheme(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1391	                url=api_endpoint,
1392	                nonce=self._extract_pop_nonce(resp.headers.get("WWW-Authenticate")),
1393	                ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_e2e.py:1395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1394	            ))
1395	        resp = requests.get(
1396	            api_endpoint,
1397	            # CodeQL [SM03157]
1398	            verify=verify,  # @suppress py/bandit/requests-ssl-verify-disabled
1399	            headers={
1400	            "Authorization": "pop {}".format(result["access_token"]),
1401	            })

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mex.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12	        with open(os.path.join(THIS_FOLDER, sample)) as sample_file:
13	            endpoint = Mex(mex_document=sample_file.read()
14	                ).get_wstrust_username_password_endpoint()["address"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mex.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	        self._test_parser("microsoft.mex.xml",
19	            'https://corp.sts.microsoft.com/adfs/services/trust/13/usernamemixed')
20	
21	    def test_happy_path_2(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mex.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	        self._test_parser('arupela.mex.xml',
23	            'https://fs.arupela.com/adfs/services/trust/13/usernamemixed')
24	
25	    def test_happy_path_3(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mex.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        self._test_parser('archan.us.mex.xml',
27	            'https://arvmserver2012.archan.us/adfs/services/trust/13/usernamemixed')
28	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	        cache = app._token_cache._cache
74	        self.assertEqual(1, len(cache.get("AccessToken", [])), "Should have 1 AT")
75	        at = list(cache["AccessToken"].values())[0]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	        self.assertEqual(
77	            app._managed_identity.get("Id", "SYSTEM_ASSIGNED_MANAGED_IDENTITY"),
78	            at["client_id"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	        self._test_happy_path().assert_called_with(
135	            'http://169.254.169.254/metadata/identity/oauth2/token',
136	            params={'api-version': '2018-02-01', 'resource': 'R'},
137	            headers={'Metadata': 'true'},
138	            )
139	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
142	        self._test_happy_path().assert_called_with(
143	            'http://localhost:1234/metadata/identity/oauth2/token',
144	            params={'api-version': '2018-02-01', 'resource': 'R'},
145	            headers={'Metadata': 'true'},
146	            )
147	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	
140	    @patch.dict(os.environ, {"AZURE_POD_IDENTITY_AUTHORITY_HOST": "http://localhost:1234//"})
141	    def test_happy_path_of_pod_identity(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	            mocked_method.assert_called_with(
169	                'http://169.254.169.254/metadata/identity/oauth2/token',
170	                params={'api-version': '2018-02-01', 'resource': 'R', 'msi_res_id': '1234'},
171	                headers={'Metadata': 'true'},
172	                )
173	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	            mocked_method.assert_called_with(
210	                'http://localhost',
211	                params={'api-version': '2019-08-01', 'resource': 'R', 'mi_res_id': '1234'},
212	                headers={'X-IDENTITY-HEADER': 'foo', 'Metadata': 'true'},
213	                )
214	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	
175	@patch.dict(os.environ, {"IDENTITY_ENDPOINT": "http://localhost", "IDENTITY_HEADER": "foo"})
176	class AppServiceTestCase(ClientTestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
215	
216	@patch.dict(os.environ, {"MSI_ENDPOINT": "http://localhost", "MSI_SECRET": "foo"})
217	class MachineLearningTestCase(ClientTestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	@patch.dict(os.environ, {
242	    "IDENTITY_ENDPOINT": "http://localhost",
243	    "IDENTITY_HEADER": "foo",
244	    "IDENTITY_SERVER_THUMBPRINT": "bar",
245	})
246	class ServiceFabricTestCase(ClientTestCase):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
285	@patch.dict(os.environ, {
286	    "IDENTITY_ENDPOINT": "http://localhost/token",
287	    "IMDS_ENDPOINT": "http://localhost",
288	})
289	@patch(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
286	    "IDENTITY_ENDPOINT": "http://localhost/token",
287	    "IMDS_ENDPOINT": "http://localhost",
288	})
289	@patch(
290	    "builtins.open" if sys.version_info.major >= 3 else "__builtin__.open",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
340	    @patch.dict(os.environ, {
341	        "IDENTITY_ENDPOINT": "http://localhost",
342	        "IDENTITY_HEADER": "foo",
343	        "IDENTITY_SERVER_THUMBPRINT": "bar",
344	    })
345	    def test_service_fabric(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
348	    @patch.dict(os.environ, {
349	        "IDENTITY_ENDPOINT": "http://localhost",
350	        "IDENTITY_HEADER": "foo",
351	    })
352	    def test_app_service(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
355	    @patch.dict(os.environ, {
356	        "MSI_ENDPOINT": "http://localhost",
357	        "MSI_SECRET": "foo",
358	    })
359	    def test_machine_learning(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
362	    @patch.dict(os.environ, {
363	        "IDENTITY_ENDPOINT": "http://localhost",
364	        "IMDS_ENDPOINT": "http://localhost",
365	    })
366	    def test_arc_by_env_var(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_mi.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
363	        "IDENTITY_ENDPOINT": "http://localhost",
364	        "IMDS_ENDPOINT": "http://localhost",
365	    })
366	    def test_arc_by_env_var(self):
367	        self.assertEqual(get_managed_identity_source(), AZURE_ARC)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)
57	        resp1 = http_client.post("https://example.com")  # We implemented POST only
58	        resp2 = http_client.post("https://example.com")  # We implemented POST only

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	        resp1 = http_client.post("https://example.com")  # We implemented POST only
58	        resp2 = http_client.post("https://example.com")  # We implemented POST only
59	        logger.debug(http_cache)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	        sleep(retry_after + 1)
62	        resp3 = http_client.post("https://example.com")  # We implemented POST only
63	        self.assertNotEqual(resp1.text, resp3.text, "Should return a new response")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)
93	        resp1 = http_client.post("https://example.com", data={
94	            "scope": "one", "claims": "bar", "grant_type": "authorization_code"})
95	        resp2 = http_client.post("https://example.com", data={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	            "scope": "one", "claims": "bar", "grant_type": "authorization_code"})
95	        resp2 = http_client.post("https://example.com", data={
96	            "scope": "one", "claims": "foo", "grant_type": "password"})
97	        logger.debug(http_cache)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)
105	        resp1 = http_client.post("https://example.com", data={"scope": "one"})
106	        resp2 = http_client.post("https://example.com", data={"scope": "two"})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	        resp1 = http_client.post("https://example.com", data={"scope": "one"})
106	        resp2 = http_client.post("https://example.com", data={"scope": "two"})
107	        logger.debug(http_cache)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)
115	        resp1 = http_client.post("https://example.com", data={"claims": "foo"})
116	        logger.debug(http_cache)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	        logger.debug(http_cache)
117	        resp1_again = http_client.post("https://example.com", data={"claims": "foo"})
118	        self.assertEqual(resp1.text, resp1_again.text, "Should return a cached response")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	        self.assertEqual(resp1.text, resp1_again.text, "Should return a cached response")
119	        resp2 = http_client.post("https://example.com", data={"claims": "bar"})
120	        self.assertNotEqual(resp1.text, resp2.text, "Should return a new response")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	        self.assertNotEqual(resp1.text, resp2.text, "Should return a new response")
121	        resp2_again = http_client.post("https://example.com", data={"claims": "bar"})
122	        self.assertEqual(resp2.text, resp2_again.text, "Should return a cached response")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	        http_client = ThrottledHttpClient(http_client, http_cache=http_cache)
149	        resp1 = http_client.get("https://example.com?foo=bar")
150	        resp2 = http_client.get("https://example.com?foo=bar")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	        resp1 = http_client.get("https://example.com?foo=bar")
150	        resp2 = http_client.get("https://example.com?foo=bar")
151	        logger.debug(http_cache)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	        resp1 = http_client.post(
160	            "https://example.com", data={"grant_type": DEVICE_AUTH_GRANT})
161	        resp2 = http_client.post(
162	            "https://example.com", data={"grant_type": DEVICE_AUTH_GRANT})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_throttled_http_client.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
161	        resp2 = http_client.post(
162	            "https://example.com", data={"grant_type": DEVICE_AUTH_GRANT})
163	        logger.debug(http_cache)
164	        self.assertNotEqual(resp1.text, resp2.text, "Should return a new response")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_token_cache.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
20	        **claims):  # AAD issues "preferred_username", ADFS issues "upn"
21	    return "header.%s.signature" % base64.b64encode(json.dumps(dict({
22	        "iss": iss,
23	        "sub": sub,
24	        "aud": aud,
25	        "exp": exp or (time.time() + 100),
26	        "iat": iat or time.time(),
27	        }, **claims)).encode()).decode('utf-8')
28	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_token_cache.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
20	        **claims):  # AAD issues "preferred_username", ADFS issues "upn"
21	    return "header.%s.signature" % base64.b64encode(json.dumps(dict({
22	        "iss": iss,
23	        "sub": sub,
24	        "aud": aud,
25	        "exp": exp or (time.time() + 100),
26	        "iat": iat or time.time(),
27	        }, **claims)).encode()).decode('utf-8')
28	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_token_cache.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
36	    if uid and utid:  # Mimic the AAD behavior for "client_info=1" request
37	        response["client_info"] = base64.b64encode(json.dumps({
38	            "uid": uid, "utid": utid,
39	            }).encode()).decode('utf-8')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_token_cache.py:37
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
36	    if uid and utid:  # Mimic the AAD behavior for "client_info=1" request
37	        response["client_info"] = base64.b64encode(json.dumps({
38	            "uid": uid, "utid": utid,
39	            }).encode()).decode('utf-8')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_token_cache.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	            "scope": ["s2", "s1", "s3"],  # Not in particular order
65	            "token_endpoint": "https://login.example.com/contoso/v2/token",
66	            "response": build_response(
67	                uid="uid", utid="utid",  # client_info
68	                expires_in=3600, access_token="an access token",
69	                id_token=id_token, refresh_token="a refresh token"),
70	            }, now=now)
71	        access_token_entry = {
72	                'cached_at': "1000",
73	                'client_id': 'my_client_id',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_token_cache.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
140	            "scope": ["s2", "s1", "s3"],  # Not in particular order
141	            "token_endpoint": "https://fs.msidlab8.com/adfs/oauth2/token",
142	            "response": build_response(
143	                uid=None, utid=None,  # ADFS will provide no client_info
144	                expires_in=3600, access_token="an access token",
145	                id_token=id_token, refresh_token="a refresh token"),
146	            }, now=1000)
147	        access_token_entry = {
148	                'cached_at': "1000",
149	                'client_id': 'my_client_id',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_token_cache.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
224	            "scope": scopes,
225	            "token_endpoint": "https://login.example.com/contoso/v2/token",
226	            "response": build_response(
227	                uid="uid", utid="utid",  # client_info
228	                expires_in=3600, access_token="an access token",
229	                refresh_token="a refresh token"),
230	            }, now=now)
231	        self.assertFoundAccessToken(scopes=scopes, data=data, now=now, query=dict(
232	            data,  # Also use the extra data as a query criteria
233	            client_id="my_client_id",
234	            environment="login.example.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_token_cache.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
254	            "scope": scopes,
255	            "token_endpoint": "https://login.example.com/contoso/v2/token",
256	            "response": build_response(
257	                uid="uid", utid="utid",  # client_info
258	                expires_in=3600, refresh_in=1800, access_token="an access token",
259	                ),  #refresh_token="a refresh token"),
260	            }, now=1000)
261	        at = self.assertFoundAccessToken(scopes=scopes, query=dict(
262	            client_id="my_client_id",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_wstrust.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    def test_findall_content_with_comparison(self):
42	        content = """
43	            <saml:Assertion xmlns:saml="SAML:assertion">
44	                <ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
45	                foo
46	                </ds:Signature>
47	            </saml:Assertion>"""
48	        sample = ('<ns0:Wrapper xmlns:ns0="namespace0">'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_wstrust.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	    def test_parse_error(self):
62	        error_response = '''
63	            <s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://www.w3.org/2005/08/addressing" xmlns:u="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
64	              <s:Header>
65	               <a:Action s:mustUnderstand="1">http://www.w3.org/2005/08/addressing/soap/fault</a:Action>
66	               <o:Security s:mustUnderstand="1" xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
67	                 <u:Timestamp u:Id="_0">
68	                 <u:Created>2013-07-30T00:32:21.989Z</u:Created>
69	                 <u:Expires>2013-07-30T00:37:21.989Z</u:Expires>
70	                 </u:Timestamp>
71	               </o:Security>
72	               </s:Header>
73	             <s:Body>
74	               <s:Fault>
75	                 <s:Code>
76	                   <s:Value>s:Sender</s:Value>
77	                   <s:Subcode>
78	                   <s:Value xmlns:a="http://docs.oasis-open.org/ws-sx/ws-trust/200512">a:RequestFailed</s:Value>
79	                   </s:Subcode>
80	                 </s:Code>
81	                 <s:Reason>
82	                 <s:Text xml:lang="en-US">MSIS3127: The specified request failed.</s:Text>
83	                 </s:Reason>
84	               </s:Fault>
85	            </s:Body>
86	            </s:Envelope>'''
87	        self.assertEqual({

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/msal-1.32.0/msal-1.32.0/tests/test_wstrust.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
93	        with open(os.path.join(os.path.dirname(__file__), "rst_response.xml")) as f:
94	            rst_body = f.read()
95	        result = parse_token_by_re(rst_body)

--------------------------------------------------

Code scanned:
	Total lines of code: 9488
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 271.0
		High: 240.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 507.0
		High: 4.0
Files skipped (0):
