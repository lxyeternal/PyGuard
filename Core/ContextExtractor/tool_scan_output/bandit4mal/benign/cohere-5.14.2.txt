Run started:2025-04-12 11:38:02.929048

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/aws_client.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	            self,
30	            base_url="https://api.cohere.com",  # this url is unused for BedrockClient
31	            environment=ClientEnvironment.PRODUCTION,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/aws_client.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	            self,
61	            base_url="https://api.cohere.com",  # this url is unused for BedrockClient
62	            environment=ClientEnvironment.PRODUCTION,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/aws_client.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
145	            if "bytes" in obj:
146	                base64_payload = base64.b64decode(obj["bytes"]).decode("utf-8")
147	                streamed_obj = json.loads(base64_payload)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/aws_client.py:146
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
145	            if "bytes" in obj:
146	                base64_payload = base64.b64decode(obj["bytes"]).decode("utf-8")
147	                streamed_obj = json.loads(base64_payload)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/aws_client.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
282	        endpoint = "invocations" if not stream else "invocations-response-stream"
283	        return f"https://runtime.sagemaker.{aws_region}.amazonaws.com/endpoints/{model}/{endpoint}"
284	    return ""

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:518
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
517	                    return
518	                _response.read()
519	                if _response.status_code == 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
942	        """
943	        _response = self._client_wrapper.httpx_client.request(
944	            "v1/chat",
945	            method="POST",
946	            json={
947	                "message": message,
948	                "model": model,
949	                "preamble": preamble,
950	                "chat_history": convert_and_respect_annotation_metadata(
951	                    object_=chat_history, annotation=typing.Sequence[Message], direction="write"
952	                ),
953	                "conversation_id": conversation_id,
954	                "prompt_truncation": prompt_truncation,
955	                "connectors": convert_and_respect_annotation_metadata(
956	                    object_=connectors, annotation=typing.Sequence[ChatConnector], direction="write"
957	                ),
958	                "search_queries_only": search_queries_only,
959	                "documents": documents,
960	                "citation_quality": citation_quality,
961	                "temperature": temperature,
962	                "max_tokens": max_tokens,
963	                "max_input_tokens": max_input_tokens,
964	                "k": k,
965	                "p": p,
966	                "seed": seed,
967	                "stop_sequences": stop_sequences,
968	                "frequency_penalty": frequency_penalty,
969	                "presence_penalty": presence_penalty,
970	                "raw_prompting": raw_prompting,
971	                "return_prompt": return_prompt,
972	                "tools": convert_and_respect_annotation_metadata(
973	                    object_=tools, annotation=typing.Sequence[Tool], direction="write"
974	                ),
975	                "tool_results": convert_and_respect_annotation_metadata(
976	                    object_=tool_results, annotation=typing.Sequence[ToolResult], direction="write"
977	                ),
978	                "force_single_step": force_single_step,
979	                "response_format": convert_and_respect_annotation_metadata(
980	                    object_=response_format, annotation=ResponseFormat, direction="write"
981	                ),
982	                "safety_mode": safety_mode,
983	                "stream": False,
984	            },
985	            headers={
986	                "content-type": "application/json",
987	                "Accepts": str(accepts) if accepts is not None else None,
988	            },
989	            request_options=request_options,
990	            omit=OMIT,
991	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
942	        """
943	        _response = self._client_wrapper.httpx_client.request(
944	            "v1/chat",
945	            method="POST",
946	            json={
947	                "message": message,
948	                "model": model,
949	                "preamble": preamble,
950	                "chat_history": convert_and_respect_annotation_metadata(
951	                    object_=chat_history, annotation=typing.Sequence[Message], direction="write"
952	                ),
953	                "conversation_id": conversation_id,
954	                "prompt_truncation": prompt_truncation,
955	                "connectors": convert_and_respect_annotation_metadata(
956	                    object_=connectors, annotation=typing.Sequence[ChatConnector], direction="write"
957	                ),
958	                "search_queries_only": search_queries_only,
959	                "documents": documents,
960	                "citation_quality": citation_quality,
961	                "temperature": temperature,
962	                "max_tokens": max_tokens,
963	                "max_input_tokens": max_input_tokens,
964	                "k": k,
965	                "p": p,
966	                "seed": seed,
967	                "stop_sequences": stop_sequences,
968	                "frequency_penalty": frequency_penalty,
969	                "presence_penalty": presence_penalty,
970	                "raw_prompting": raw_prompting,
971	                "return_prompt": return_prompt,
972	                "tools": convert_and_respect_annotation_metadata(
973	                    object_=tools, annotation=typing.Sequence[Tool], direction="write"
974	                ),
975	                "tool_results": convert_and_respect_annotation_metadata(
976	                    object_=tool_results, annotation=typing.Sequence[ToolResult], direction="write"
977	                ),
978	                "force_single_step": force_single_step,
979	                "response_format": convert_and_respect_annotation_metadata(
980	                    object_=response_format, annotation=ResponseFormat, direction="write"
981	                ),
982	                "safety_mode": safety_mode,
983	                "stream": False,
984	            },
985	            headers={
986	                "content-type": "application/json",
987	                "Accepts": str(accepts) if accepts is not None else None,
988	            },
989	            request_options=request_options,
990	            omit=OMIT,
991	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:1307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1306	                    return
1307	                _response.read()
1308	                if _response.status_code == 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:1568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1567	        """
1568	        _response = self._client_wrapper.httpx_client.request(
1569	            "v1/generate",
1570	            method="POST",
1571	            json={
1572	                "prompt": prompt,
1573	                "model": model,
1574	                "num_generations": num_generations,
1575	                "max_tokens": max_tokens,
1576	                "truncate": truncate,
1577	                "temperature": temperature,
1578	                "seed": seed,
1579	                "preset": preset,
1580	                "end_sequences": end_sequences,
1581	                "stop_sequences": stop_sequences,
1582	                "k": k,
1583	                "p": p,
1584	                "frequency_penalty": frequency_penalty,
1585	                "presence_penalty": presence_penalty,
1586	                "return_likelihoods": return_likelihoods,
1587	                "raw_prompting": raw_prompting,
1588	                "stream": False,
1589	            },
1590	            headers={
1591	                "content-type": "application/json",
1592	            },
1593	            request_options=request_options,
1594	            omit=OMIT,
1595	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:1568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1567	        """
1568	        _response = self._client_wrapper.httpx_client.request(
1569	            "v1/generate",
1570	            method="POST",
1571	            json={
1572	                "prompt": prompt,
1573	                "model": model,
1574	                "num_generations": num_generations,
1575	                "max_tokens": max_tokens,
1576	                "truncate": truncate,
1577	                "temperature": temperature,
1578	                "seed": seed,
1579	                "preset": preset,
1580	                "end_sequences": end_sequences,
1581	                "stop_sequences": stop_sequences,
1582	                "k": k,
1583	                "p": p,
1584	                "frequency_penalty": frequency_penalty,
1585	                "presence_penalty": presence_penalty,
1586	                "return_likelihoods": return_likelihoods,
1587	                "raw_prompting": raw_prompting,
1588	                "stream": False,
1589	            },
1590	            headers={
1591	                "content-type": "application/json",
1592	            },
1593	            request_options=request_options,
1594	            omit=OMIT,
1595	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:1810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1809	        """
1810	        _response = self._client_wrapper.httpx_client.request(
1811	            "v1/embed",
1812	            method="POST",
1813	            json={
1814	                "texts": texts,
1815	                "images": images,
1816	                "model": model,
1817	                "input_type": input_type,
1818	                "embedding_types": embedding_types,
1819	                "truncate": truncate,
1820	            },
1821	            headers={
1822	                "content-type": "application/json",
1823	            },
1824	            request_options=request_options,
1825	            omit=OMIT,
1826	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:1810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1809	        """
1810	        _response = self._client_wrapper.httpx_client.request(
1811	            "v1/embed",
1812	            method="POST",
1813	            json={
1814	                "texts": texts,
1815	                "images": images,
1816	                "model": model,
1817	                "input_type": input_type,
1818	                "embedding_types": embedding_types,
1819	                "truncate": truncate,
1820	            },
1821	            headers={
1822	                "content-type": "application/json",
1823	            },
1824	            request_options=request_options,
1825	            omit=OMIT,
1826	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2025	        """
2026	        _response = self._client_wrapper.httpx_client.request(
2027	            "v1/rerank",
2028	            method="POST",
2029	            json={
2030	                "model": model,
2031	                "query": query,
2032	                "documents": convert_and_respect_annotation_metadata(
2033	                    object_=documents, annotation=typing.Sequence[RerankRequestDocumentsItem], direction="write"
2034	                ),
2035	                "top_n": top_n,
2036	                "rank_fields": rank_fields,
2037	                "return_documents": return_documents,
2038	                "max_chunks_per_doc": max_chunks_per_doc,
2039	            },
2040	            headers={
2041	                "content-type": "application/json",
2042	            },
2043	            request_options=request_options,
2044	            omit=OMIT,
2045	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2025	        """
2026	        _response = self._client_wrapper.httpx_client.request(
2027	            "v1/rerank",
2028	            method="POST",
2029	            json={
2030	                "model": model,
2031	                "query": query,
2032	                "documents": convert_and_respect_annotation_metadata(
2033	                    object_=documents, annotation=typing.Sequence[RerankRequestDocumentsItem], direction="write"
2034	                ),
2035	                "top_n": top_n,
2036	                "rank_fields": rank_fields,
2037	                "return_documents": return_documents,
2038	                "max_chunks_per_doc": max_chunks_per_doc,
2039	            },
2040	            headers={
2041	                "content-type": "application/json",
2042	            },
2043	            request_options=request_options,
2044	            omit=OMIT,
2045	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2235	        """
2236	        _response = self._client_wrapper.httpx_client.request(
2237	            "v1/classify",
2238	            method="POST",
2239	            json={
2240	                "inputs": inputs,
2241	                "examples": convert_and_respect_annotation_metadata(
2242	                    object_=examples, annotation=typing.Sequence[ClassifyExample], direction="write"
2243	                ),
2244	                "model": model,
2245	                "preset": preset,
2246	                "truncate": truncate,
2247	            },
2248	            headers={
2249	                "content-type": "application/json",
2250	            },
2251	            request_options=request_options,
2252	            omit=OMIT,
2253	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2235	        """
2236	        _response = self._client_wrapper.httpx_client.request(
2237	            "v1/classify",
2238	            method="POST",
2239	            json={
2240	                "inputs": inputs,
2241	                "examples": convert_and_respect_annotation_metadata(
2242	                    object_=examples, annotation=typing.Sequence[ClassifyExample], direction="write"
2243	                ),
2244	                "model": model,
2245	                "preset": preset,
2246	                "truncate": truncate,
2247	            },
2248	            headers={
2249	                "content-type": "application/json",
2250	            },
2251	            request_options=request_options,
2252	            omit=OMIT,
2253	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2448	        """
2449	        _response = self._client_wrapper.httpx_client.request(
2450	            "v1/summarize",
2451	            method="POST",
2452	            json={
2453	                "text": text,
2454	                "length": length,
2455	                "format": format,
2456	                "model": model,
2457	                "extractiveness": extractiveness,
2458	                "temperature": temperature,
2459	                "additional_command": additional_command,
2460	            },
2461	            headers={
2462	                "content-type": "application/json",
2463	            },
2464	            request_options=request_options,
2465	            omit=OMIT,
2466	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2448	        """
2449	        _response = self._client_wrapper.httpx_client.request(
2450	            "v1/summarize",
2451	            method="POST",
2452	            json={
2453	                "text": text,
2454	                "length": length,
2455	                "format": format,
2456	                "model": model,
2457	                "extractiveness": extractiveness,
2458	                "temperature": temperature,
2459	                "additional_command": additional_command,
2460	            },
2461	            headers={
2462	                "content-type": "application/json",
2463	            },
2464	            request_options=request_options,
2465	            omit=OMIT,
2466	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2635	        """
2636	        _response = self._client_wrapper.httpx_client.request(
2637	            "v1/tokenize",
2638	            method="POST",
2639	            json={
2640	                "text": text,
2641	                "model": model,
2642	            },
2643	            headers={
2644	                "content-type": "application/json",
2645	            },
2646	            request_options=request_options,
2647	            omit=OMIT,
2648	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2635	        """
2636	        _response = self._client_wrapper.httpx_client.request(
2637	            "v1/tokenize",
2638	            method="POST",
2639	            json={
2640	                "text": text,
2641	                "model": model,
2642	            },
2643	            headers={
2644	                "content-type": "application/json",
2645	            },
2646	            request_options=request_options,
2647	            omit=OMIT,
2648	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2817	        """
2818	        _response = self._client_wrapper.httpx_client.request(
2819	            "v1/detokenize",
2820	            method="POST",
2821	            json={
2822	                "tokens": tokens,
2823	                "model": model,
2824	            },
2825	            headers={
2826	                "content-type": "application/json",
2827	            },
2828	            request_options=request_options,
2829	            omit=OMIT,
2830	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2817	        """
2818	        _response = self._client_wrapper.httpx_client.request(
2819	            "v1/detokenize",
2820	            method="POST",
2821	            json={
2822	                "tokens": tokens,
2823	                "model": model,
2824	            },
2825	            headers={
2826	                "content-type": "application/json",
2827	            },
2828	            request_options=request_options,
2829	            omit=OMIT,
2830	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2988	        """
2989	        _response = self._client_wrapper.httpx_client.request(
2990	            "v1/check-api-key",
2991	            method="POST",
2992	            request_options=request_options,
2993	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:2989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2988	        """
2989	        _response = self._client_wrapper.httpx_client.request(
2990	            "v1/check-api-key",
2991	            method="POST",
2992	            request_options=request_options,
2993	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:3575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3574	                    return
3575	                await _response.aread()
3576	                if _response.status_code == 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:4008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4007	        """
4008	        _response = await self._client_wrapper.httpx_client.request(
4009	            "v1/chat",
4010	            method="POST",
4011	            json={
4012	                "message": message,
4013	                "model": model,
4014	                "preamble": preamble,
4015	                "chat_history": convert_and_respect_annotation_metadata(
4016	                    object_=chat_history, annotation=typing.Sequence[Message], direction="write"
4017	                ),
4018	                "conversation_id": conversation_id,
4019	                "prompt_truncation": prompt_truncation,
4020	                "connectors": convert_and_respect_annotation_metadata(
4021	                    object_=connectors, annotation=typing.Sequence[ChatConnector], direction="write"
4022	                ),
4023	                "search_queries_only": search_queries_only,
4024	                "documents": documents,
4025	                "citation_quality": citation_quality,
4026	                "temperature": temperature,
4027	                "max_tokens": max_tokens,
4028	                "max_input_tokens": max_input_tokens,
4029	                "k": k,
4030	                "p": p,
4031	                "seed": seed,
4032	                "stop_sequences": stop_sequences,
4033	                "frequency_penalty": frequency_penalty,
4034	                "presence_penalty": presence_penalty,
4035	                "raw_prompting": raw_prompting,
4036	                "return_prompt": return_prompt,
4037	                "tools": convert_and_respect_annotation_metadata(
4038	                    object_=tools, annotation=typing.Sequence[Tool], direction="write"
4039	                ),
4040	                "tool_results": convert_and_respect_annotation_metadata(
4041	                    object_=tool_results, annotation=typing.Sequence[ToolResult], direction="write"
4042	                ),
4043	                "force_single_step": force_single_step,
4044	                "response_format": convert_and_respect_annotation_metadata(
4045	                    object_=response_format, annotation=ResponseFormat, direction="write"
4046	                ),
4047	                "safety_mode": safety_mode,
4048	                "stream": False,
4049	            },
4050	            headers={
4051	                "content-type": "application/json",
4052	                "Accepts": str(accepts) if accepts is not None else None,
4053	            },
4054	            request_options=request_options,
4055	            omit=OMIT,
4056	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:4008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
4007	        """
4008	        _response = await self._client_wrapper.httpx_client.request(
4009	            "v1/chat",
4010	            method="POST",
4011	            json={
4012	                "message": message,
4013	                "model": model,
4014	                "preamble": preamble,
4015	                "chat_history": convert_and_respect_annotation_metadata(
4016	                    object_=chat_history, annotation=typing.Sequence[Message], direction="write"
4017	                ),
4018	                "conversation_id": conversation_id,
4019	                "prompt_truncation": prompt_truncation,
4020	                "connectors": convert_and_respect_annotation_metadata(
4021	                    object_=connectors, annotation=typing.Sequence[ChatConnector], direction="write"
4022	                ),
4023	                "search_queries_only": search_queries_only,
4024	                "documents": documents,
4025	                "citation_quality": citation_quality,
4026	                "temperature": temperature,
4027	                "max_tokens": max_tokens,
4028	                "max_input_tokens": max_input_tokens,
4029	                "k": k,
4030	                "p": p,
4031	                "seed": seed,
4032	                "stop_sequences": stop_sequences,
4033	                "frequency_penalty": frequency_penalty,
4034	                "presence_penalty": presence_penalty,
4035	                "raw_prompting": raw_prompting,
4036	                "return_prompt": return_prompt,
4037	                "tools": convert_and_respect_annotation_metadata(
4038	                    object_=tools, annotation=typing.Sequence[Tool], direction="write"
4039	                ),
4040	                "tool_results": convert_and_respect_annotation_metadata(
4041	                    object_=tool_results, annotation=typing.Sequence[ToolResult], direction="write"
4042	                ),
4043	                "force_single_step": force_single_step,
4044	                "response_format": convert_and_respect_annotation_metadata(
4045	                    object_=response_format, annotation=ResponseFormat, direction="write"
4046	                ),
4047	                "safety_mode": safety_mode,
4048	                "stream": False,
4049	            },
4050	            headers={
4051	                "content-type": "application/json",
4052	                "Accepts": str(accepts) if accepts is not None else None,
4053	            },
4054	            request_options=request_options,
4055	            omit=OMIT,
4056	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:4380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4379	                    return
4380	                await _response.aread()
4381	                if _response.status_code == 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:4649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4648	        """
4649	        _response = await self._client_wrapper.httpx_client.request(
4650	            "v1/generate",
4651	            method="POST",
4652	            json={
4653	                "prompt": prompt,
4654	                "model": model,
4655	                "num_generations": num_generations,
4656	                "max_tokens": max_tokens,
4657	                "truncate": truncate,
4658	                "temperature": temperature,
4659	                "seed": seed,
4660	                "preset": preset,
4661	                "end_sequences": end_sequences,
4662	                "stop_sequences": stop_sequences,
4663	                "k": k,
4664	                "p": p,
4665	                "frequency_penalty": frequency_penalty,
4666	                "presence_penalty": presence_penalty,
4667	                "return_likelihoods": return_likelihoods,
4668	                "raw_prompting": raw_prompting,
4669	                "stream": False,
4670	            },
4671	            headers={
4672	                "content-type": "application/json",
4673	            },
4674	            request_options=request_options,
4675	            omit=OMIT,
4676	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:4649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
4648	        """
4649	        _response = await self._client_wrapper.httpx_client.request(
4650	            "v1/generate",
4651	            method="POST",
4652	            json={
4653	                "prompt": prompt,
4654	                "model": model,
4655	                "num_generations": num_generations,
4656	                "max_tokens": max_tokens,
4657	                "truncate": truncate,
4658	                "temperature": temperature,
4659	                "seed": seed,
4660	                "preset": preset,
4661	                "end_sequences": end_sequences,
4662	                "stop_sequences": stop_sequences,
4663	                "k": k,
4664	                "p": p,
4665	                "frequency_penalty": frequency_penalty,
4666	                "presence_penalty": presence_penalty,
4667	                "return_likelihoods": return_likelihoods,
4668	                "raw_prompting": raw_prompting,
4669	                "stream": False,
4670	            },
4671	            headers={
4672	                "content-type": "application/json",
4673	            },
4674	            request_options=request_options,
4675	            omit=OMIT,
4676	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:4899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
4898	        """
4899	        _response = await self._client_wrapper.httpx_client.request(
4900	            "v1/embed",
4901	            method="POST",
4902	            json={
4903	                "texts": texts,
4904	                "images": images,
4905	                "model": model,
4906	                "input_type": input_type,
4907	                "embedding_types": embedding_types,
4908	                "truncate": truncate,
4909	            },
4910	            headers={
4911	                "content-type": "application/json",
4912	            },
4913	            request_options=request_options,
4914	            omit=OMIT,
4915	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:4899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
4898	        """
4899	        _response = await self._client_wrapper.httpx_client.request(
4900	            "v1/embed",
4901	            method="POST",
4902	            json={
4903	                "texts": texts,
4904	                "images": images,
4905	                "model": model,
4906	                "input_type": input_type,
4907	                "embedding_types": embedding_types,
4908	                "truncate": truncate,
4909	            },
4910	            headers={
4911	                "content-type": "application/json",
4912	            },
4913	            request_options=request_options,
4914	            omit=OMIT,
4915	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5122	        """
5123	        _response = await self._client_wrapper.httpx_client.request(
5124	            "v1/rerank",
5125	            method="POST",
5126	            json={
5127	                "model": model,
5128	                "query": query,
5129	                "documents": convert_and_respect_annotation_metadata(
5130	                    object_=documents, annotation=typing.Sequence[RerankRequestDocumentsItem], direction="write"
5131	                ),
5132	                "top_n": top_n,
5133	                "rank_fields": rank_fields,
5134	                "return_documents": return_documents,
5135	                "max_chunks_per_doc": max_chunks_per_doc,
5136	            },
5137	            headers={
5138	                "content-type": "application/json",
5139	            },
5140	            request_options=request_options,
5141	            omit=OMIT,
5142	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
5122	        """
5123	        _response = await self._client_wrapper.httpx_client.request(
5124	            "v1/rerank",
5125	            method="POST",
5126	            json={
5127	                "model": model,
5128	                "query": query,
5129	                "documents": convert_and_respect_annotation_metadata(
5130	                    object_=documents, annotation=typing.Sequence[RerankRequestDocumentsItem], direction="write"
5131	                ),
5132	                "top_n": top_n,
5133	                "rank_fields": rank_fields,
5134	                "return_documents": return_documents,
5135	                "max_chunks_per_doc": max_chunks_per_doc,
5136	            },
5137	            headers={
5138	                "content-type": "application/json",
5139	            },
5140	            request_options=request_options,
5141	            omit=OMIT,
5142	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5340	        """
5341	        _response = await self._client_wrapper.httpx_client.request(
5342	            "v1/classify",
5343	            method="POST",
5344	            json={
5345	                "inputs": inputs,
5346	                "examples": convert_and_respect_annotation_metadata(
5347	                    object_=examples, annotation=typing.Sequence[ClassifyExample], direction="write"
5348	                ),
5349	                "model": model,
5350	                "preset": preset,
5351	                "truncate": truncate,
5352	            },
5353	            headers={
5354	                "content-type": "application/json",
5355	            },
5356	            request_options=request_options,
5357	            omit=OMIT,
5358	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
5340	        """
5341	        _response = await self._client_wrapper.httpx_client.request(
5342	            "v1/classify",
5343	            method="POST",
5344	            json={
5345	                "inputs": inputs,
5346	                "examples": convert_and_respect_annotation_metadata(
5347	                    object_=examples, annotation=typing.Sequence[ClassifyExample], direction="write"
5348	                ),
5349	                "model": model,
5350	                "preset": preset,
5351	                "truncate": truncate,
5352	            },
5353	            headers={
5354	                "content-type": "application/json",
5355	            },
5356	            request_options=request_options,
5357	            omit=OMIT,
5358	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5561	        """
5562	        _response = await self._client_wrapper.httpx_client.request(
5563	            "v1/summarize",
5564	            method="POST",
5565	            json={
5566	                "text": text,
5567	                "length": length,
5568	                "format": format,
5569	                "model": model,
5570	                "extractiveness": extractiveness,
5571	                "temperature": temperature,
5572	                "additional_command": additional_command,
5573	            },
5574	            headers={
5575	                "content-type": "application/json",
5576	            },
5577	            request_options=request_options,
5578	            omit=OMIT,
5579	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
5561	        """
5562	        _response = await self._client_wrapper.httpx_client.request(
5563	            "v1/summarize",
5564	            method="POST",
5565	            json={
5566	                "text": text,
5567	                "length": length,
5568	                "format": format,
5569	                "model": model,
5570	                "extractiveness": extractiveness,
5571	                "temperature": temperature,
5572	                "additional_command": additional_command,
5573	            },
5574	            headers={
5575	                "content-type": "application/json",
5576	            },
5577	            request_options=request_options,
5578	            omit=OMIT,
5579	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5756	        """
5757	        _response = await self._client_wrapper.httpx_client.request(
5758	            "v1/tokenize",
5759	            method="POST",
5760	            json={
5761	                "text": text,
5762	                "model": model,
5763	            },
5764	            headers={
5765	                "content-type": "application/json",
5766	            },
5767	            request_options=request_options,
5768	            omit=OMIT,
5769	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
5756	        """
5757	        _response = await self._client_wrapper.httpx_client.request(
5758	            "v1/tokenize",
5759	            method="POST",
5760	            json={
5761	                "text": text,
5762	                "model": model,
5763	            },
5764	            headers={
5765	                "content-type": "application/json",
5766	            },
5767	            request_options=request_options,
5768	            omit=OMIT,
5769	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
5946	        """
5947	        _response = await self._client_wrapper.httpx_client.request(
5948	            "v1/detokenize",
5949	            method="POST",
5950	            json={
5951	                "tokens": tokens,
5952	                "model": model,
5953	            },
5954	            headers={
5955	                "content-type": "application/json",
5956	            },
5957	            request_options=request_options,
5958	            omit=OMIT,
5959	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:5947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
5946	        """
5947	        _response = await self._client_wrapper.httpx_client.request(
5948	            "v1/detokenize",
5949	            method="POST",
5950	            json={
5951	                "tokens": tokens,
5952	                "model": model,
5953	            },
5954	            headers={
5955	                "content-type": "application/json",
5956	            },
5957	            request_options=request_options,
5958	            omit=OMIT,
5959	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:6126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
6125	        """
6126	        _response = await self._client_wrapper.httpx_client.request(
6127	            "v1/check-api-key",
6128	            method="POST",
6129	            request_options=request_options,
6130	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/base_client.py:6126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
6125	        """
6126	        _response = await self._client_wrapper.httpx_client.request(
6127	            "v1/check-api-key",
6128	            method="POST",
6129	            request_options=request_options,
6130	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/client.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        raise ValueError(
65	            f"Since python sdk cohere==5.0.0, the function {fn_name}(...) has been moved to {new_fn_name}(...). "
66	            f"Please update your code. Issues may be filed in https://github.com/cohere-ai/cohere-python/issues."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/client.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        raise ValueError(
79	            f"Since python sdk cohere==5.0.0, the function {fn_name}(...) has been deprecated. "
80	            f"Please update your code. Issues may be filed in https://github.com/cohere-ai/cohere-python/issues."

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/client.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
142	        httpx_client: typing.Optional[httpx.Client] = None,
143	        thread_pool_executor: ThreadPoolExecutor = ThreadPoolExecutor(64),
144	        log_warning_experimental_features: bool = True,

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/client.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
334	        httpx_client: typing.Optional[httpx.AsyncClient] = None,
335	        thread_pool_executor: ThreadPoolExecutor = ThreadPoolExecutor(64),
336	        log_warning_experimental_features: bool = True,

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/client_v2.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
20	        httpx_client: typing.Optional[httpx.Client] = None,
21	        thread_pool_executor: ThreadPoolExecutor = ThreadPoolExecutor(64),
22	        log_warning_experimental_features: bool = True,

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/client_v2.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
47	        httpx_client: typing.Optional[httpx.AsyncClient] = None,
48	        thread_pool_executor: ThreadPoolExecutor = ThreadPoolExecutor(64),
49	        log_warning_experimental_features: bool = True,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
76	        """
77	        _response = self._client_wrapper.httpx_client.request(
78	            "v1/connectors",
79	            method="GET",
80	            params={
81	                "limit": limit,
82	                "offset": offset,
83	            },
84	            request_options=request_options,
85	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
282	        """
283	        _response = self._client_wrapper.httpx_client.request(
284	            "v1/connectors",
285	            method="POST",
286	            json={
287	                "name": name,
288	                "description": description,
289	                "url": url,
290	                "excludes": excludes,
291	                "oauth": convert_and_respect_annotation_metadata(
292	                    object_=oauth, annotation=CreateConnectorOAuth, direction="write"
293	                ),
294	                "active": active,
295	                "continue_on_failure": continue_on_failure,
296	                "service_auth": convert_and_respect_annotation_metadata(
297	                    object_=service_auth, annotation=CreateConnectorServiceAuth, direction="write"
298	                ),
299	            },
300	            headers={
301	                "content-type": "application/json",
302	            },
303	            request_options=request_options,
304	            omit=OMIT,
305	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
468	        """
469	        _response = self._client_wrapper.httpx_client.request(
470	            f"v1/connectors/{jsonable_encoder(id)}",
471	            method="GET",
472	            request_options=request_options,
473	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:637
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
636	        """
637	        _response = self._client_wrapper.httpx_client.request(
638	            f"v1/connectors/{jsonable_encoder(id)}",
639	            method="DELETE",
640	            request_options=request_options,
641	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
835	        """
836	        _response = self._client_wrapper.httpx_client.request(
837	            f"v1/connectors/{jsonable_encoder(id)}",
838	            method="PATCH",
839	            json={
840	                "name": name,
841	                "url": url,
842	                "excludes": excludes,
843	                "oauth": convert_and_respect_annotation_metadata(
844	                    object_=oauth, annotation=CreateConnectorOAuth, direction="write"
845	                ),
846	                "active": active,
847	                "continue_on_failure": continue_on_failure,
848	                "service_auth": convert_and_respect_annotation_metadata(
849	                    object_=service_auth, annotation=CreateConnectorServiceAuth, direction="write"
850	                ),
851	            },
852	            headers={
853	                "content-type": "application/json",
854	            },
855	            request_options=request_options,
856	            omit=OMIT,
857	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:1030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1029	        """
1030	        _response = self._client_wrapper.httpx_client.request(
1031	            f"v1/connectors/{jsonable_encoder(id)}/oauth/authorize",
1032	            method="POST",
1033	            params={
1034	                "after_token_redirect": after_token_redirect,
1035	            },
1036	            request_options=request_options,
1037	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:1221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1220	        """
1221	        _response = await self._client_wrapper.httpx_client.request(
1222	            "v1/connectors",
1223	            method="GET",
1224	            params={
1225	                "limit": limit,
1226	                "offset": offset,
1227	            },
1228	            request_options=request_options,
1229	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:1435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1434	        """
1435	        _response = await self._client_wrapper.httpx_client.request(
1436	            "v1/connectors",
1437	            method="POST",
1438	            json={
1439	                "name": name,
1440	                "description": description,
1441	                "url": url,
1442	                "excludes": excludes,
1443	                "oauth": convert_and_respect_annotation_metadata(
1444	                    object_=oauth, annotation=CreateConnectorOAuth, direction="write"
1445	                ),
1446	                "active": active,
1447	                "continue_on_failure": continue_on_failure,
1448	                "service_auth": convert_and_respect_annotation_metadata(
1449	                    object_=service_auth, annotation=CreateConnectorServiceAuth, direction="write"
1450	                ),
1451	            },
1452	            headers={
1453	                "content-type": "application/json",
1454	            },
1455	            request_options=request_options,
1456	            omit=OMIT,
1457	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:1629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1628	        """
1629	        _response = await self._client_wrapper.httpx_client.request(
1630	            f"v1/connectors/{jsonable_encoder(id)}",
1631	            method="GET",
1632	            request_options=request_options,
1633	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:1807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1806	        """
1807	        _response = await self._client_wrapper.httpx_client.request(
1808	            f"v1/connectors/{jsonable_encoder(id)}",
1809	            method="DELETE",
1810	            request_options=request_options,
1811	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:2014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2013	        """
2014	        _response = await self._client_wrapper.httpx_client.request(
2015	            f"v1/connectors/{jsonable_encoder(id)}",
2016	            method="PATCH",
2017	            json={
2018	                "name": name,
2019	                "url": url,
2020	                "excludes": excludes,
2021	                "oauth": convert_and_respect_annotation_metadata(
2022	                    object_=oauth, annotation=CreateConnectorOAuth, direction="write"
2023	                ),
2024	                "active": active,
2025	                "continue_on_failure": continue_on_failure,
2026	                "service_auth": convert_and_respect_annotation_metadata(
2027	                    object_=service_auth, annotation=CreateConnectorServiceAuth, direction="write"
2028	                ),
2029	            },
2030	            headers={
2031	                "content-type": "application/json",
2032	            },
2033	            request_options=request_options,
2034	            omit=OMIT,
2035	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/connectors/client.py:2216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2215	        """
2216	        _response = await self._client_wrapper.httpx_client.request(
2217	            f"v1/connectors/{jsonable_encoder(id)}/oauth/authorize",
2218	            method="POST",
2219	            params={
2220	                "after_token_redirect": after_token_redirect,
2221	            },
2222	            request_options=request_options,
2223	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/core/http_client.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
197	
198	        response = self.httpx_client.request(
199	            method=method,
200	            url=urllib.parse.urljoin(f"{base_url}/", path),
201	            headers=jsonable_encoder(
202	                remove_none_from_dict(
203	                    {
204	                        **self.base_headers(),
205	                        **(headers if headers is not None else {}),
206	                        **(request_options.get("additional_headers", {}) or {} if request_options is not None else {}),
207	                    }
208	                )
209	            ),
210	            params=encode_query(
211	                jsonable_encoder(
212	                    remove_none_from_dict(
213	                        remove_omit_from_dict(
214	                            {
215	                                **(params if params is not None else {}),
216	                                **(
217	                                    request_options.get("additional_query_parameters", {}) or {}
218	                                    if request_options is not None
219	                                    else {}
220	                                ),
221	                            },
222	                            omit,
223	                        )
224	                    )
225	                )
226	            ),
227	            json=json_body,
228	            data=data_body,
229	            content=content,
230	            files=(
231	                convert_file_dict_to_httpx_tuples(remove_omit_from_dict(remove_none_from_dict(files), omit))
232	                if (files is not None and files is not omit)
233	                else None
234	            ),
235	            timeout=timeout,
236	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/core/http_client.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
241	                time.sleep(_retry_timeout(response=response, retries=retries))
242	                return self.request(
243	                    path=path,
244	                    method=method,
245	                    base_url=base_url,
246	                    params=params,
247	                    json=json,
248	                    content=content,
249	                    files=files,
250	                    headers=headers,
251	                    request_options=request_options,
252	                    retries=retries + 1,
253	                    omit=omit,
254	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/core/http_client.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
374	        # Add the input to each of these and do None-safety checks
375	        response = await self.httpx_client.request(
376	            method=method,
377	            url=urllib.parse.urljoin(f"{base_url}/", path),
378	            headers=jsonable_encoder(
379	                remove_none_from_dict(
380	                    {
381	                        **self.base_headers(),
382	                        **(headers if headers is not None else {}),
383	                        **(request_options.get("additional_headers", {}) or {} if request_options is not None else {}),
384	                    }
385	                )
386	            ),
387	            params=encode_query(
388	                jsonable_encoder(
389	                    remove_none_from_dict(
390	                        remove_omit_from_dict(
391	                            {
392	                                **(params if params is not None else {}),
393	                                **(
394	                                    request_options.get("additional_query_parameters", {}) or {}
395	                                    if request_options is not None
396	                                    else {}
397	                                ),
398	                            },
399	                            omit,
400	                        )
401	                    )
402	                )
403	            ),
404	            json=json_body,
405	            data=data_body,
406	            content=content,
407	            files=(
408	                convert_file_dict_to_httpx_tuples(remove_omit_from_dict(remove_none_from_dict(files), omit))
409	                if files is not None
410	                else None
411	            ),
412	            timeout=timeout,
413	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/core/http_client.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
418	                await asyncio.sleep(_retry_timeout(response=response, retries=retries))
419	                return await self.request(
420	                    path=path,
421	                    method=method,
422	                    base_url=base_url,
423	                    params=params,
424	                    json=json,
425	                    content=content,
426	                    files=files,
427	                    headers=headers,
428	                    request_options=request_options,
429	                    retries=retries + 1,
430	                    omit=omit,
431	                )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/core/jsonable_encoder.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
57	    if isinstance(obj, bytes):
58	        return base64.b64encode(obj).decode("utf-8")
59	    if isinstance(obj, Enum):

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/core/jsonable_encoder.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
57	    if isinstance(obj, bytes):
58	        return base64.b64encode(obj).decode("utf-8")
59	    if isinstance(obj, Enum):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
92	        """
93	        _response = self._client_wrapper.httpx_client.request(
94	            "v1/datasets",
95	            method="GET",
96	            params={
97	                "datasetType": dataset_type,
98	                "before": serialize_datetime(before) if before is not None else None,
99	                "after": serialize_datetime(after) if after is not None else None,
100	                "limit": limit,
101	                "offset": offset,
102	                "validationStatus": validation_status,
103	            },
104	            request_options=request_options,
105	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
314	        """
315	        _response = self._client_wrapper.httpx_client.request(
316	            "v1/datasets",
317	            method="POST",
318	            params={
319	                "name": name,
320	                "type": type,
321	                "keep_original_file": keep_original_file,
322	                "skip_malformed_input": skip_malformed_input,
323	                "keep_fields": keep_fields,
324	                "optional_fields": optional_fields,
325	                "text_separator": text_separator,
326	                "csv_delimiter": csv_delimiter,
327	                "dry_run": dry_run,
328	            },
329	            data={},
330	            files={
331	                "data": data,
332	                "eval_data": eval_data,
333	            },
334	            request_options=request_options,
335	            omit=OMIT,
336	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
494	        """
495	        _response = self._client_wrapper.httpx_client.request(
496	            "v1/datasets/usage",
497	            method="GET",
498	            request_options=request_options,
499	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
661	        """
662	        _response = self._client_wrapper.httpx_client.request(
663	            f"v1/datasets/{jsonable_encoder(id)}",
664	            method="GET",
665	            request_options=request_options,
666	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
830	        """
831	        _response = self._client_wrapper.httpx_client.request(
832	            f"v1/datasets/{jsonable_encoder(id)}",
833	            method="DELETE",
834	            request_options=request_options,
835	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:1035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1034	        """
1035	        _response = await self._client_wrapper.httpx_client.request(
1036	            "v1/datasets",
1037	            method="GET",
1038	            params={
1039	                "datasetType": dataset_type,
1040	                "before": serialize_datetime(before) if before is not None else None,
1041	                "after": serialize_datetime(after) if after is not None else None,
1042	                "limit": limit,
1043	                "offset": offset,
1044	                "validationStatus": validation_status,
1045	            },
1046	            request_options=request_options,
1047	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1264	        """
1265	        _response = await self._client_wrapper.httpx_client.request(
1266	            "v1/datasets",
1267	            method="POST",
1268	            params={
1269	                "name": name,
1270	                "type": type,
1271	                "keep_original_file": keep_original_file,
1272	                "skip_malformed_input": skip_malformed_input,
1273	                "keep_fields": keep_fields,
1274	                "optional_fields": optional_fields,
1275	                "text_separator": text_separator,
1276	                "csv_delimiter": csv_delimiter,
1277	                "dry_run": dry_run,
1278	            },
1279	            data={},
1280	            files={
1281	                "data": data,
1282	                "eval_data": eval_data,
1283	            },
1284	            request_options=request_options,
1285	            omit=OMIT,
1286	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1452	        """
1453	        _response = await self._client_wrapper.httpx_client.request(
1454	            "v1/datasets/usage",
1455	            method="GET",
1456	            request_options=request_options,
1457	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:1628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1627	        """
1628	        _response = await self._client_wrapper.httpx_client.request(
1629	            f"v1/datasets/{jsonable_encoder(id)}",
1630	            method="GET",
1631	            request_options=request_options,
1632	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/datasets/client.py:1805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1804	        """
1805	        _response = await self._client_wrapper.httpx_client.request(
1806	            f"v1/datasets/{jsonable_encoder(id)}",
1807	            method="DELETE",
1808	            request_options=request_options,
1809	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/embed_jobs/client.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
61	        """
62	        _response = self._client_wrapper.httpx_client.request(
63	            "v1/embed-jobs",
64	            method="GET",
65	            request_options=request_options,
66	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/embed_jobs/client.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
272	        """
273	        _response = self._client_wrapper.httpx_client.request(
274	            "v1/embed-jobs",
275	            method="POST",
276	            json={
277	                "model": model,
278	                "dataset_id": dataset_id,
279	                "input_type": input_type,
280	                "name": name,
281	                "embedding_types": embedding_types,
282	                "truncate": truncate,
283	            },
284	            headers={
285	                "content-type": "application/json",
286	            },
287	            request_options=request_options,
288	            omit=OMIT,
289	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/embed_jobs/client.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
452	        """
453	        _response = self._client_wrapper.httpx_client.request(
454	            f"v1/embed-jobs/{jsonable_encoder(id)}",
455	            method="GET",
456	            request_options=request_options,
457	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/embed_jobs/client.py:620
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
619	        """
620	        _response = self._client_wrapper.httpx_client.request(
621	            f"v1/embed-jobs/{jsonable_encoder(id)}/cancel",
622	            method="POST",
623	            request_options=request_options,
624	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/embed_jobs/client.py:790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
789	        """
790	        _response = await self._client_wrapper.httpx_client.request(
791	            "v1/embed-jobs",
792	            method="GET",
793	            request_options=request_options,
794	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/embed_jobs/client.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1008	        """
1009	        _response = await self._client_wrapper.httpx_client.request(
1010	            "v1/embed-jobs",
1011	            method="POST",
1012	            json={
1013	                "model": model,
1014	                "dataset_id": dataset_id,
1015	                "input_type": input_type,
1016	                "name": name,
1017	                "embedding_types": embedding_types,
1018	                "truncate": truncate,
1019	            },
1020	            headers={
1021	                "content-type": "application/json",
1022	            },
1023	            request_options=request_options,
1024	            omit=OMIT,
1025	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/embed_jobs/client.py:1197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1196	        """
1197	        _response = await self._client_wrapper.httpx_client.request(
1198	            f"v1/embed-jobs/{jsonable_encoder(id)}",
1199	            method="GET",
1200	            request_options=request_options,
1201	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/embed_jobs/client.py:1372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1371	        """
1372	        _response = await self._client_wrapper.httpx_client.request(
1373	            f"v1/embed-jobs/{jsonable_encoder(id)}/cancel",
1374	            method="POST",
1375	            request_options=request_options,
1376	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/environment.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	class ClientEnvironment(enum.Enum):
7	    PRODUCTION = "https://api.cohere.com"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
98	                lazy_sagemaker().s3.S3Downloader.download(s3_tar_model, local_tar_models_dir, sagemaker_session=self._sess)
99	                with tarfile.open(os.path.join(local_tar_models_dir, s3_tar_model.split("/")[-1])) as tar:
100	                    tar.extractall(local_models_dir)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
103	            model_tar = os.path.join(tmpdir, "models.tar.gz")
104	            with tarfile.open(model_tar, "w:gz") as tar:
105	                tar.add(local_models_dir, arcname=".")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
405	                result = self._client.invoke_endpoint(**params)
406	                return Chat.from_dict(json.loads(result['Body'].read().decode()))
407	        except lazy_botocore().EndpointConnectionError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
437	                return Chat.from_dict(
438	                    json.loads(result['body'].read().decode()))
439	        except lazy_botocore().EndpointConnectionError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
512	                return Generations(
513	                    json.loads(result['Body'].read().decode())['generations'])
514	        except lazy_botocore().EndpointConnectionError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
537	                return Generations(
538	                    json.loads(result['body'].read().decode())['generations'])
539	        except lazy_botocore().EndpointConnectionError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
585	            result = self._client.invoke_endpoint(**params)
586	            response = json.loads(result['Body'].read().decode())
587	        except lazy_botocore().EndpointConnectionError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
606	            result = self._client.invoke_model(**params)
607	            response = json.loads(result['body'].read().decode())
608	        except lazy_botocore().EndpointConnectionError as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
667	            result = self._client.invoke_endpoint(**params)
668	            response = json.loads(result['Body'].read().decode())
669	            reranking = Reranking(response)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:698
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
697	            result = self._client.invoke_endpoint(**params)
698	            response = json.loads(result["Body"].read().decode())
699	        except lazy_botocore().EndpointConnectionError as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
912	        if not role:
913	            raise ValueError("must provide a role ARN for bedrock finetuning (https://docs.aws.amazon.com/bedrock/latest/userguide/model-customization-iam-role.html)")
914	        if not train_data.startswith("s3:"):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/cohere_aws/client.py:979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
978	            result = self._client.invoke_endpoint(**params)
979	            response = json.loads(result['Body'].read().decode())
980	            summary = Summary(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/tokenizers.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	    """Returns a HF tokenizer from a given tokenizer config URL."""
21	    tokenizer = co._cache_get(tokenizer_cache_key(model))
22	    if tokenizer is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/tokenizers.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	        return tokenizer
24	    tokenizer_url = co.models.get(model).tokenizer_url
25	    if not tokenizer_url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/tokenizers.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	
36	    response = requests.get(tokenizer_url)
37	    tokenizer = Tokenizer.from_str(response.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/tokenizers.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	
58	    tokenizer = co._cache_get(tokenizer_cache_key(model))
59	    if tokenizer is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/tokenizers.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	        return tokenizer
61	    tokenizer_url = (await co.models.get(model)).tokenizer_url
62	    if not tokenizer_url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/manually_maintained/tokenizers.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	    for header in ["x-goog-stored-content-length", "Content-Length"]:
98	        size = head_response.headers.get(header)
99	        if size:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/models/client.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
59	        """
60	        _response = self._client_wrapper.httpx_client.request(
61	            f"v1/models/{jsonable_encoder(model)}",
62	            method="GET",
63	            request_options=request_options,
64	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/models/client.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
243	        """
244	        _response = self._client_wrapper.httpx_client.request(
245	            "v1/models",
246	            method="GET",
247	            params={
248	                "page_size": page_size,
249	                "page_token": page_token,
250	                "endpoint": endpoint,
251	                "default_only": default_only,
252	            },
253	            request_options=request_options,
254	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/models/client.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
429	        """
430	        _response = await self._client_wrapper.httpx_client.request(
431	            f"v1/models/{jsonable_encoder(model)}",
432	            method="GET",
433	            request_options=request_options,
434	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/models/client.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
621	        """
622	        _response = await self._client_wrapper.httpx_client.request(
623	            "v1/models",
624	            method="GET",
625	            params={
626	                "page_size": page_size,
627	                "page_token": page_token,
628	                "endpoint": endpoint,
629	                "default_only": default_only,
630	            },
631	            request_options=request_options,
632	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    if awaitable.__class__.__name__ == "EmbedJob" or awaitable.__class__.__name__ == "CreateEmbedJobResponse":
44	        return cohere.embed_jobs.get(id=get_id(awaitable))
45	    elif awaitable.__class__.__name__ == "DatasetsGetResponse" or awaitable.__class__.__name__ == "DatasetsCreateResponse":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	    elif awaitable.__class__.__name__ == "DatasetsGetResponse" or awaitable.__class__.__name__ == "DatasetsCreateResponse":
46	        return cohere.datasets.get(id=get_id(awaitable))
47	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/utils.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	    if awaitable.__class__.__name__ == "EmbedJob" or awaitable.__class__.__name__ == "CreateEmbedJobResponse":
55	        return await cohere.embed_jobs.get(id=get_id(awaitable))
56	    elif awaitable.__class__.__name__ == "DatasetsGetResponse" or awaitable.__class__.__name__ == "DatasetsCreateResponse":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/utils.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	    elif awaitable.__class__.__name__ == "DatasetsGetResponse" or awaitable.__class__.__name__ == "DatasetsCreateResponse":
57	        return await cohere.datasets.get(id=get_id(awaitable))
58	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/utils.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	            raise ValueError("Dataset part does not have a url")
276	        resp = requests.get(part.url, stream=True)
277	        for record in reader(resp.raw): # type: ignore

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
264	                    return
265	                _response.read()
266	                if _response.status_code == 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
545	        """
546	        _response = self._client_wrapper.httpx_client.request(
547	            "v2/chat",
548	            method="POST",
549	            json={
550	                "model": model,
551	                "messages": convert_and_respect_annotation_metadata(
552	                    object_=messages, annotation=ChatMessages, direction="write"
553	                ),
554	                "tools": convert_and_respect_annotation_metadata(
555	                    object_=tools, annotation=typing.Sequence[ToolV2], direction="write"
556	                ),
557	                "strict_tools": strict_tools,
558	                "documents": convert_and_respect_annotation_metadata(
559	                    object_=documents, annotation=typing.Sequence[V2ChatRequestDocumentsItem], direction="write"
560	                ),
561	                "citation_options": convert_and_respect_annotation_metadata(
562	                    object_=citation_options, annotation=CitationOptions, direction="write"
563	                ),
564	                "response_format": convert_and_respect_annotation_metadata(
565	                    object_=response_format, annotation=ResponseFormatV2, direction="write"
566	                ),
567	                "safety_mode": safety_mode,
568	                "max_tokens": max_tokens,
569	                "stop_sequences": stop_sequences,
570	                "temperature": temperature,
571	                "seed": seed,
572	                "frequency_penalty": frequency_penalty,
573	                "presence_penalty": presence_penalty,
574	                "k": k,
575	                "p": p,
576	                "return_prompt": return_prompt,
577	                "logprobs": logprobs,
578	                "tool_choice": tool_choice,
579	                "stream": False,
580	            },
581	            headers={
582	                "content-type": "application/json",
583	            },
584	            request_options=request_options,
585	            omit=OMIT,
586	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
545	        """
546	        _response = self._client_wrapper.httpx_client.request(
547	            "v2/chat",
548	            method="POST",
549	            json={
550	                "model": model,
551	                "messages": convert_and_respect_annotation_metadata(
552	                    object_=messages, annotation=ChatMessages, direction="write"
553	                ),
554	                "tools": convert_and_respect_annotation_metadata(
555	                    object_=tools, annotation=typing.Sequence[ToolV2], direction="write"
556	                ),
557	                "strict_tools": strict_tools,
558	                "documents": convert_and_respect_annotation_metadata(
559	                    object_=documents, annotation=typing.Sequence[V2ChatRequestDocumentsItem], direction="write"
560	                ),
561	                "citation_options": convert_and_respect_annotation_metadata(
562	                    object_=citation_options, annotation=CitationOptions, direction="write"
563	                ),
564	                "response_format": convert_and_respect_annotation_metadata(
565	                    object_=response_format, annotation=ResponseFormatV2, direction="write"
566	                ),
567	                "safety_mode": safety_mode,
568	                "max_tokens": max_tokens,
569	                "stop_sequences": stop_sequences,
570	                "temperature": temperature,
571	                "seed": seed,
572	                "frequency_penalty": frequency_penalty,
573	                "presence_penalty": presence_penalty,
574	                "k": k,
575	                "p": p,
576	                "return_prompt": return_prompt,
577	                "logprobs": logprobs,
578	                "tool_choice": tool_choice,
579	                "stream": False,
580	            },
581	            headers={
582	                "content-type": "application/json",
583	            },
584	            request_options=request_options,
585	            omit=OMIT,
586	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
810	        """
811	        _response = self._client_wrapper.httpx_client.request(
812	            "v2/embed",
813	            method="POST",
814	            json={
815	                "texts": texts,
816	                "images": images,
817	                "model": model,
818	                "input_type": input_type,
819	                "inputs": convert_and_respect_annotation_metadata(
820	                    object_=inputs, annotation=typing.Sequence[EmbedInput], direction="write"
821	                ),
822	                "output_dimension": output_dimension,
823	                "embedding_types": embedding_types,
824	                "truncate": truncate,
825	            },
826	            headers={
827	                "content-type": "application/json",
828	            },
829	            request_options=request_options,
830	            omit=OMIT,
831	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
810	        """
811	        _response = self._client_wrapper.httpx_client.request(
812	            "v2/embed",
813	            method="POST",
814	            json={
815	                "texts": texts,
816	                "images": images,
817	                "model": model,
818	                "input_type": input_type,
819	                "inputs": convert_and_respect_annotation_metadata(
820	                    object_=inputs, annotation=typing.Sequence[EmbedInput], direction="write"
821	                ),
822	                "output_dimension": output_dimension,
823	                "embedding_types": embedding_types,
824	                "truncate": truncate,
825	            },
826	            headers={
827	                "content-type": "application/json",
828	            },
829	            request_options=request_options,
830	            omit=OMIT,
831	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1027	        """
1028	        _response = self._client_wrapper.httpx_client.request(
1029	            "v2/rerank",
1030	            method="POST",
1031	            json={
1032	                "model": model,
1033	                "query": query,
1034	                "documents": documents,
1035	                "top_n": top_n,
1036	                "return_documents": return_documents,
1037	                "max_tokens_per_doc": max_tokens_per_doc,
1038	            },
1039	            headers={
1040	                "content-type": "application/json",
1041	            },
1042	            request_options=request_options,
1043	            omit=OMIT,
1044	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1027	        """
1028	        _response = self._client_wrapper.httpx_client.request(
1029	            "v2/rerank",
1030	            method="POST",
1031	            json={
1032	                "model": model,
1033	                "query": query,
1034	                "documents": documents,
1035	                "top_n": top_n,
1036	                "return_documents": return_documents,
1037	                "max_tokens_per_doc": max_tokens_per_doc,
1038	            },
1039	            headers={
1040	                "content-type": "application/json",
1041	            },
1042	            request_options=request_options,
1043	            omit=OMIT,
1044	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:1405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1404	                    return
1405	                await _response.aread()
1406	                if _response.status_code == 400:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:1694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1693	        """
1694	        _response = await self._client_wrapper.httpx_client.request(
1695	            "v2/chat",
1696	            method="POST",
1697	            json={
1698	                "model": model,
1699	                "messages": convert_and_respect_annotation_metadata(
1700	                    object_=messages, annotation=ChatMessages, direction="write"
1701	                ),
1702	                "tools": convert_and_respect_annotation_metadata(
1703	                    object_=tools, annotation=typing.Sequence[ToolV2], direction="write"
1704	                ),
1705	                "strict_tools": strict_tools,
1706	                "documents": convert_and_respect_annotation_metadata(
1707	                    object_=documents, annotation=typing.Sequence[V2ChatRequestDocumentsItem], direction="write"
1708	                ),
1709	                "citation_options": convert_and_respect_annotation_metadata(
1710	                    object_=citation_options, annotation=CitationOptions, direction="write"
1711	                ),
1712	                "response_format": convert_and_respect_annotation_metadata(
1713	                    object_=response_format, annotation=ResponseFormatV2, direction="write"
1714	                ),
1715	                "safety_mode": safety_mode,
1716	                "max_tokens": max_tokens,
1717	                "stop_sequences": stop_sequences,
1718	                "temperature": temperature,
1719	                "seed": seed,
1720	                "frequency_penalty": frequency_penalty,
1721	                "presence_penalty": presence_penalty,
1722	                "k": k,
1723	                "p": p,
1724	                "return_prompt": return_prompt,
1725	                "logprobs": logprobs,
1726	                "tool_choice": tool_choice,
1727	                "stream": False,
1728	            },
1729	            headers={
1730	                "content-type": "application/json",
1731	            },
1732	            request_options=request_options,
1733	            omit=OMIT,
1734	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:1694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1693	        """
1694	        _response = await self._client_wrapper.httpx_client.request(
1695	            "v2/chat",
1696	            method="POST",
1697	            json={
1698	                "model": model,
1699	                "messages": convert_and_respect_annotation_metadata(
1700	                    object_=messages, annotation=ChatMessages, direction="write"
1701	                ),
1702	                "tools": convert_and_respect_annotation_metadata(
1703	                    object_=tools, annotation=typing.Sequence[ToolV2], direction="write"
1704	                ),
1705	                "strict_tools": strict_tools,
1706	                "documents": convert_and_respect_annotation_metadata(
1707	                    object_=documents, annotation=typing.Sequence[V2ChatRequestDocumentsItem], direction="write"
1708	                ),
1709	                "citation_options": convert_and_respect_annotation_metadata(
1710	                    object_=citation_options, annotation=CitationOptions, direction="write"
1711	                ),
1712	                "response_format": convert_and_respect_annotation_metadata(
1713	                    object_=response_format, annotation=ResponseFormatV2, direction="write"
1714	                ),
1715	                "safety_mode": safety_mode,
1716	                "max_tokens": max_tokens,
1717	                "stop_sequences": stop_sequences,
1718	                "temperature": temperature,
1719	                "seed": seed,
1720	                "frequency_penalty": frequency_penalty,
1721	                "presence_penalty": presence_penalty,
1722	                "k": k,
1723	                "p": p,
1724	                "return_prompt": return_prompt,
1725	                "logprobs": logprobs,
1726	                "tool_choice": tool_choice,
1727	                "stream": False,
1728	            },
1729	            headers={
1730	                "content-type": "application/json",
1731	            },
1732	            request_options=request_options,
1733	            omit=OMIT,
1734	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:1967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1966	        """
1967	        _response = await self._client_wrapper.httpx_client.request(
1968	            "v2/embed",
1969	            method="POST",
1970	            json={
1971	                "texts": texts,
1972	                "images": images,
1973	                "model": model,
1974	                "input_type": input_type,
1975	                "inputs": convert_and_respect_annotation_metadata(
1976	                    object_=inputs, annotation=typing.Sequence[EmbedInput], direction="write"
1977	                ),
1978	                "output_dimension": output_dimension,
1979	                "embedding_types": embedding_types,
1980	                "truncate": truncate,
1981	            },
1982	            headers={
1983	                "content-type": "application/json",
1984	            },
1985	            request_options=request_options,
1986	            omit=OMIT,
1987	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:1967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1966	        """
1967	        _response = await self._client_wrapper.httpx_client.request(
1968	            "v2/embed",
1969	            method="POST",
1970	            json={
1971	                "texts": texts,
1972	                "images": images,
1973	                "model": model,
1974	                "input_type": input_type,
1975	                "inputs": convert_and_respect_annotation_metadata(
1976	                    object_=inputs, annotation=typing.Sequence[EmbedInput], direction="write"
1977	                ),
1978	                "output_dimension": output_dimension,
1979	                "embedding_types": embedding_types,
1980	                "truncate": truncate,
1981	            },
1982	            headers={
1983	                "content-type": "application/json",
1984	            },
1985	            request_options=request_options,
1986	            omit=OMIT,
1987	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:2192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2191	        """
2192	        _response = await self._client_wrapper.httpx_client.request(
2193	            "v2/rerank",
2194	            method="POST",
2195	            json={
2196	                "model": model,
2197	                "query": query,
2198	                "documents": documents,
2199	                "top_n": top_n,
2200	                "return_documents": return_documents,
2201	                "max_tokens_per_doc": max_tokens_per_doc,
2202	            },
2203	            headers={
2204	                "content-type": "application/json",
2205	            },
2206	            request_options=request_options,
2207	            omit=OMIT,
2208	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cohere-5.14.2/cohere-5.14.2/src/cohere/v2/client.py:2192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2191	        """
2192	        _response = await self._client_wrapper.httpx_client.request(
2193	            "v2/rerank",
2194	            method="POST",
2195	            json={
2196	                "model": model,
2197	                "query": query,
2198	                "documents": documents,
2199	                "top_n": top_n,
2200	                "return_documents": return_documents,
2201	                "max_tokens_per_doc": max_tokens_per_doc,
2202	            },
2203	            headers={
2204	                "content-type": "application/json",
2205	            },
2206	            request_options=request_options,
2207	            omit=OMIT,
2208	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 25159
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 120.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 127.0
		High: 2.0
Files skipped (0):
