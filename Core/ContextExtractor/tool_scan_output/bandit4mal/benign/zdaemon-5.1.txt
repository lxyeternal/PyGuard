Run started:2025-04-12 10:49:49.241298

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/setup.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	def read(*rnames):
35	    return open(os.path.join(os.path.dirname(__file__), *rnames)).read()
36	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/setup.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    version='5.1',
41	    url="https://github.com/zopefoundation/zdaemon",
42	    license="ZPL 2.1",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/setup.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	    long_description=(
47	        read('README.rst') +
48	        '\n' +

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/setup.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	        '\n' +
49	        read('src/zdaemon/README.rst') +
50	        '\n' +

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/setup.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	        '\n' +
51	        read('CHANGES.rst')),
52	    packages=[

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/nokill.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
5	
6	signal.signal(signal.SIGTERM, signal.SIG_IGN)
7	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/nokill.py:6
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
5	
6	signal.signal(signal.SIGTERM, signal.SIG_IGN)
7	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/parent.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	    fd = os.open(donothing, os.O_WRONLY | os.O_CREAT, 0o700)
24	    os.write(fd, donothing_contents.encode())
25	    os.close(fd)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	    with open(name, 'w') as f:
50	        f.write(text)
51	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
49	    with open(name, 'w') as f:
50	        f.write(text)
51	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	    with open(name) as f:
55	        return f.read()
56	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
456	    tmpdir = tempfile.mkdtemp()
457	    td.append(lambda: shutil.rmtree(tmpdir))
458	    test.globs['tmpdir'] = tmpdir

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
459	    workspace = tempfile.mkdtemp()
460	    td.append(lambda: shutil.rmtree(workspace))
461	    os.chdir(workspace)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
461	    os.chdir(workspace)
462	    write('zdaemon', zdaemon_template % dict(
463	        python=sys.executable,
464	        zdaemon=zdaemon_loc,
465	        ZConfig=zconfig_loc,
466	    ))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
461	    os.chdir(workspace)
462	    write('zdaemon', zdaemon_template % dict(
463	        python=sys.executable,
464	        zdaemon=zdaemon_loc,
465	        ZConfig=zconfig_loc,
466	    ))

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
466	    ))
467	    os.chmod('zdaemon', 0o755)
468	    test.globs['system'] = system

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:467
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
466	    ))
467	    os.chmod('zdaemon', 0o755)
468	    test.globs['system'] = system

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
490	    try:
491	        prev_handler = signal.signal(signal.SIGALRM, raiseTimeout)
492	    except ValueError:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:491
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
490	    try:
491	        prev_handler = signal.signal(signal.SIGALRM, raiseTimeout)
492	    except ValueError:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
501	            signal.alarm(0)
502	            signal.signal(signal.SIGALRM, prev_handler)
503	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/tests.py:502
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
501	            signal.alarm(0)
502	            signal.signal(signal.SIGALRM, prev_handler)
503	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testuser.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
28	    with open(name, 'w') as f:
29	        f.write(text)
30	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdoptions.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
334	                f = open(self.configfile, 'w')
335	                f.write(self.configtext)
336	                f.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdoptions.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
334	                f = open(self.configfile, 'w')
335	                f.write(self.configtext)
336	                f.close()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdoptions.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
439	    def tearDown(self):
440	        shutil.rmtree(self.root)
441	        super().tearDown()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
69	                    signal.SIGCHLD):
70	            signal.signal(sig, signal.SIG_DFL)
71	        try:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
69	                    signal.SIGCHLD):
70	            signal.signal(sig, signal.SIG_DFL)
71	        try:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
88	               (self.ppath, self.python, self.zdrun, self.zdsock, args))
89	        os.system(cmd)
90	        # When the daemon crashes, the following may help debug it:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:89
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
88	               (self.ppath, self.python, self.zdrun, self.zdsock, args))
89	        os.system(cmd)
90	        # When the daemon crashes, the following may help debug it:

--------------------------------------------------
>> Issue: [B811:getuid] os.getuid
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b811_getuid.html
260	        # people have a strange tendency to run the tests as root
261	        if os.getuid() == 0:
262	            self.fail("""

--------------------------------------------------
>> Issue: [B305:blacklist] os.getuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:261
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
260	        # people have a strange tendency to run the tests as root
261	        if os.getuid() == 0:
262	            self.fail("""

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
303	    def tearDown(self):
304	        shutil.rmtree(self.root)
305	        got = sys.stdout.getvalue()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
384	        with open(config_file, 'w') as f:
385	            f.write(config)
386	        return config_file

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
384	        with open(config_file, 'w') as f:
385	            f.write(config)
386	        return config_file

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:421
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
420	    """
421	    sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
422	    try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
422	    try:
423	        sock.connect(sockname)
424	        sock.send(action.encode() + b"\n")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
423	        sock.connect(sockname)
424	        sock.send(action.encode() + b"\n")
425	        sock.shutdown(1)  # We're not writing any more

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
427	        while True:
428	            data = sock.recv(1000)
429	            if not data:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
431	            response += data
432	        sock.close()
433	        return response

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/tests/testzdrun.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
443	    finally:
444	        sock.close()
445	

--------------------------------------------------
>> Issue: [B303:blacklist] pwd.getpwuid
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:190
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b303-pwd-getpwuid
189	            try:
190	                pwrec = pwd.getpwuid(uid)
191	            except KeyError:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:222
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
221	        """
222	        sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
223	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
223	        try:
224	            sock.connect(self.options.sockname)
225	            sock.send(action.encode() + b"\n")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
224	            sock.connect(self.options.sockname)
225	            sock.send(action.encode() + b"\n")
226	            sock.shutdown(1)  # We're not writing any more

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
228	            while True:
229	                data = sock.recv(1000)
230	                if not data:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
236	        finally:
237	            sock.close()
238	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
275	            while not cond(n):
276	                sys.stdout.write(". ")
277	                sys.stdout.flush()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
405	        try:
406	            signame = name2signal(arg)
407	        except ValueError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
581	        for line in lines:
582	            sys.stdout.write(line)
583	            sys.stdout.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
592	                self.f.seek(-bytes_added, 2)
593	                bytes = self.f.read(bytes_added)
594	                sys.stdout.write(bytes)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
593	                bytes = self.f.read(bytes_added)
594	                sys.stdout.write(bytes)
595	                sys.stdout.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdctl.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
610	            self.f.seek(pos)
611	            byte = self.f.read(1)
612	            if byte == '\n':

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdoptions.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	        """Print a brief error message to stderr and exit(2)."""
97	        sys.stderr.write("Error: %s\n" % str(msg))
98	        sys.stderr.write("For help, use %s -h\n" % self.progname)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdoptions.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	        sys.stderr.write("Error: %s\n" % str(msg))
98	        sys.stderr.write("For help, use %s -h\n" % self.progname)
99	        sys.exit(2)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
198	                self.testing.add(pid)
199	                thread = threading.Thread(target=self.test, args=(pid,))
200	                thread.setDaemon(True)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
211	                    try:
212	                        os.close(i)
213	                    except os.error:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
217	                except os.error as err:
218	                    sys.stderr.write("can't exec %r: %s\n" %
219	                                     (self.filename, err))
220	                    sys.stderr.flush()  # just in case

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:282
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
281	        while True:
282	            sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
283	            try:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
284	                sock.bind(tempname)
285	                os.chmod(tempname, 0o700)
286	                try:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:285
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
284	                sock.bind(tempname)
285	                os.chmod(tempname, 0o700)
286	                try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
293	                    msg = "Unlinking stale socket %s; sleep 1" % sockname
294	                    sys.stderr.write(msg + "\n")
295	                    sys.stderr.flush()  # just in case

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
297	                    self.unlink_quietly(sockname)
298	                    sock.close()
299	                    time.sleep(1)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:318
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
317	    def checkopen(self):
318	        s = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
319	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
319	        try:
320	            s.connect(self.options.sockname)
321	            s.send(b"status\n")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
320	            s.connect(self.options.sockname)
321	            s.send(b"status\n")
322	            data = s.recv(1000).decode()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
321	            s.send(b"status\n")
322	            data = s.recv(1000).decode()
323	            s.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
322	            data = s.recv(1000).decode()
323	            s.close()
324	        except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
329	                   (self.options.sockname, data))
330	            sys.stderr.write(msg + "\n")
331	            sys.stderr.flush()  # just in case

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
335	    def setsignals(self):
336	        signal.signal(signal.SIGTERM, self.sigexit)
337	        signal.signal(signal.SIGHUP, self.sigexit)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:336
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
335	    def setsignals(self):
336	        signal.signal(signal.SIGTERM, self.sigexit)
337	        signal.signal(signal.SIGHUP, self.sigexit)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
336	        signal.signal(signal.SIGTERM, self.sigexit)
337	        signal.signal(signal.SIGHUP, self.sigexit)
338	        signal.signal(signal.SIGINT, self.sigexit)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:337
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
336	        signal.signal(signal.SIGTERM, self.sigexit)
337	        signal.signal(signal.SIGHUP, self.sigexit)
338	        signal.signal(signal.SIGINT, self.sigexit)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
337	        signal.signal(signal.SIGHUP, self.sigexit)
338	        signal.signal(signal.SIGINT, self.sigexit)
339	        signal.signal(signal.SIGCHLD, self.sigchild)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:338
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
337	        signal.signal(signal.SIGHUP, self.sigexit)
338	        signal.signal(signal.SIGINT, self.sigexit)
339	        signal.signal(signal.SIGCHLD, self.sigchild)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
338	        signal.signal(signal.SIGINT, self.sigexit)
339	        signal.signal(signal.SIGCHLD, self.sigchild)
340	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:339
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
338	        signal.signal(signal.SIGINT, self.sigexit)
339	        signal.signal(signal.SIGCHLD, self.sigchild)
340	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
404	                                 % self.options.directory)
405	        os.close(0)
406	        sys.stdin = sys.__stdin__ = open("/dev/null")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
459	                try:
460	                    self.dorecv()
461	                except OSError as msg:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
472	            if sig_r in r:
473	                os.read(sig_r, 1)  # don't let the buffer fill up
474	        self.logger.info("Exiting")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
525	            self.sendreply("Command superseded by new command")
526	            self.commandsocket.close()
527	            self.commandsocket = None

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
535	    def dorecv(self):
536	        data = self.commandsocket.recv(1000)
537	        if not data:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
538	            self.sendreply("Command not terminated by newline")
539	            self.commandsocket.close()
540	            self.commandsocket = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
543	            self.docommand()
544	            self.commandsocket.close()
545	            self.commandsocket = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
547	            self.sendreply("Command exceeds 10 KB")
548	            self.commandsocket.close()
549	            self.commandsocket = None

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
651	            if hasattr(self.commandsocket, "sendall"):
652	                self.commandsocket.sendall(msg)
653	            else:  # pragma: nocover

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
655	                while msg:
656	                    sent = self.commandsocket.send(msg)
657	                    msg = msg[sent:]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
673	        self.lock = threading.Lock()
674	        thread = threading.Thread(target=self.copy)
675	        thread.setDaemon(True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
686	                    for fd in ii:
687	                        self.write(os.read(fd, 8192))
688	        finally:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
686	                    for fd in ii:
687	                        self.write(os.read(fd, 8192))
688	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
691	            # deadlocking when the pipe buffer becomes full.
692	            os.close(self.read_from)
693	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/zdaemon-5.1/zdaemon-5.1/src/zdaemon/zdrun.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
696	        with self.lock:
697	            self.file.close()
698	            self.file = new_file

--------------------------------------------------

Code scanned:
	Total lines of code: 2986
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 73.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 74.0
		High: 17.0
Files skipped (0):
