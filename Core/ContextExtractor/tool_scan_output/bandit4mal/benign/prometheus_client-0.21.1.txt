Run started:2025-04-12 15:04:03.661426

Test results:
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/bridge/graphite.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
87	        conn = socket.create_connection(self._address, self._timeout)
88	        conn.sendall(''.join(output).encode('ascii'))
89	        conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/bridge/graphite.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
88	        conn.sendall(''.join(output).encode('ascii'))
89	        conn.close()
90	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/decorator.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
194	            code = compile(src, filename, 'single')
195	            exec(code, evaldict)
196	        except:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
216	        port: int,
217	        addr: str = '0.0.0.0',
218	        registry: CollectorRegistry = REGISTRY,
219	        certfile: Optional[str] = None,
220	        keyfile: Optional[str] = None,
221	        client_cafile: Optional[str] = None,
222	        client_capath: Optional[str] = None,
223	        protocol: int = ssl.PROTOCOL_TLS_SERVER,
224	        client_auth_required: bool = False,
225	) -> Tuple[WSGIServer, threading.Thread]:
226	    """Starts a WSGI server for prometheus metrics as a daemon thread."""

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
236	        httpd.socket = context.wrap_socket(httpd.socket, server_side=True)
237	    t = threading.Thread(target=httpd.serve_forever)
238	    t.daemon = True

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
236	        httpd.socket = context.wrap_socket(httpd.socket, server_side=True)
237	    t = threading.Thread(target=httpd.serve_forever)
238	    t.daemon = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
342	        self.end_headers()
343	        self.wfile.write(output)
344	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
368	    The path must end in .prom for the textfile collector to process it."""
369	    tmppath = f'{path}.{os.getpid()}.{threading.current_thread().ident}'
370	    with open(tmppath, 'wb') as f:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
368	    The path must end in .prom for the textfile collector to process it."""
369	    tmppath = f'{path}.{os.getpid()}.{threading.current_thread().ident}'
370	    with open(tmppath, 'wb') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
370	    with open(tmppath, 'wb') as f:
371	        f.write(generate_latest(registry))
372	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
452	            auth_value = f'{username}:{password}'.encode()
453	            auth_token = base64.b64encode(auth_value)
454	            auth_header = b'Basic ' + auth_token

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:453
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
452	            auth_value = f'{username}:{password}'.encode()
453	            auth_token = base64.b64encode(auth_value)
454	            auth_header = b'Basic ' + auth_token

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
644	        # Added in Pushgateway 0.9.0.
645	        return k + "@base64", base64.urlsafe_b64encode(v.encode("utf-8")).decode("utf-8")
646	    else:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:652
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
651	    """Grouping key with instance set to the IP Address of this host."""
652	    with closing(socket.socket(socket.AF_INET, socket.SOCK_DGRAM)) as s:
653	        if sys.platform == 'darwin':

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
658	            # https://stackoverflow.com/a/28950776
659	            s.connect(('10.255.255.255', 1))
660	        else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
658	            # https://stackoverflow.com/a/28950776
659	            s.connect(('10.255.255.255', 1))
660	        else:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/exposition.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
660	        else:
661	            s.connect(('localhost', 0))
662	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/mmap_dict.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
88	            # how much of the file (which is preallocated to _INITIAL_MMAP_SIZE bytes) is occupied.
89	            data = infp.read(mmap.PAGESIZE)
90	            used = _unpack_integer(data, 0)[0]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/mmap_dict.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
91	            if used > len(data):  # Then read in the rest, if needed.
92	                data += infp.read(used - len(data))
93	        return _read_all_values(data, used)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/platform_collector.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
16	        info = self._info()
17	        system = self._platform.system()
18	        if system == "Java":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/prometheus_client/process_collector.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	            with open(os.path.join(pid, 'stat'), 'rb') as stat:
63	                parts = (stat.read().split(b')')[-1].split())
64	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/setup.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
5	with open(path.join(path.abspath(path.dirname(__file__)), 'README.md')) as f:
6	    long_description = f.read()
7	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    keywords="prometheus monitoring instrumentation client",
19	    url="https://github.com/prometheus/client_python",
20	    packages=[

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_asgi.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
21	        {
22	            "client": ("127.0.0.1", 32767),
23	            "headers": [],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_asgi.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
28	            "scheme": "http",
29	            "server": ("127.0.0.1", 80),
30	            "type": "http",

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_core.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
236	        workers = 2
237	        pool = ThreadPoolExecutor(max_workers=workers)
238	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_core.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
318	        duration = 0.1
319	        pool = ThreadPoolExecutor(max_workers=workers)
320	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_core.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
470	        duration = 0.1
471	        pool = ThreadPoolExecutor(max_workers=workers)
472	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_exposition.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
217	                length = int(self.headers['content-length'])
218	                requests.append((self, self.rfile.read(length)))
219	                self.end_headers()

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_exposition.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
226	        # which will cause the request handler to return 201.
227	        httpd_redirect = HTTPServer(('localhost', 0), TestHandler)
228	        self.redirect_address = TestHandler.redirect_address = \

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_exposition.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	        self.redirect_address = TestHandler.redirect_address = \
229	            f'http://localhost:{httpd_redirect.server_address[1]}/{redirect_flag}'
230	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_exposition.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
232	            def run(self):
233	                httpd_redirect.handle_request()
234	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_exposition.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
239	        # set up the normal server to serve the example requests across test cases.
240	        httpd = HTTPServer(('localhost', 0), TestHandler)
241	        self.address = f'http://localhost:{httpd.server_address[1]}'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_exposition.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
240	        httpd = HTTPServer(('localhost', 0), TestHandler)
241	        self.address = f'http://localhost:{httpd.server_address[1]}'
242	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_exposition.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
244	            def run(self):
245	                httpd.handle_request()
246	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_graphite_bridge.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
20	            def handle(s):
21	                self.data = s.request.recv(1024)
22	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_graphite_bridge.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
27	                server.handle_request()
28	                server.socket.close()
29	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_multiprocess.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
27	        values.ValueClass = MutexValue
28	        shutil.rmtree(self.tempdir)
29	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_multiprocess.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
63	        del os.environ['PROMETHEUS_MULTIPROC_DIR']
64	        shutil.rmtree(self.tempdir)
65	        values.ValueClass = MutexValue

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prometheus_client-0.21.1/prometheus_client-0.21.1/tests/test_twisted.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	        port = server.getHost().port
42	        url = f"http://localhost:{port}/metrics"
43	        d = agent.request(b"GET", url.encode("ascii"))

--------------------------------------------------

Code scanned:
	Total lines of code: 6650
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 29.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 3.0
Files skipped (0):
