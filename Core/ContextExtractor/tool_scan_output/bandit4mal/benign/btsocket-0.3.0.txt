Run started:2025-04-12 10:22:55.051537

Test results:
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_callback.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
44	        logger.debug('Reader callback')
45	        data = self.sock.recv(100)
46	        pkt = btmgmt_protocol.reader(data)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_callback.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
61	            logger.info('sending pkt [%s]', tools.format_pkt(this_cmd))
62	            self.sock.send(this_cmd)
63	        if not self.running and len(self.cmd_queue) == 0:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_callback.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
105	        """
106	        btmgmt_socket.close(self.sock)
107	        # Stop the event loop

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_callback.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
107	        # Stop the event loop
108	        self.loop.close()
109	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_callback.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
122	            # We are done. Close sockets and the event loop.
123	            self.close()

--------------------------------------------------
>> Issue: [B841:cdll] ctypes.CDLL
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_socket.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b841_cdll.html
43	    ctypes.cdll.LoadLibrary("libc.so.6")
44	    libc = ctypes.CDLL("libc.so.6")
45	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_socket.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
68	
69	    sock_fd = socket.socket(AF_BLUETOOTH, SOCK_RAW, BTPROTO_HCI, fileno=fd)
70	    return sock_fd

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_socket.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
75	    fd = bt_socket.detach()
76	    socket.close(fd)
77	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_socket.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
92	    def reader():
93	        data = sock.recv(100)
94	        print("Received:", data)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_socket.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
114	        # We are done. Close sockets and the event loop.
115	        close(sock)
116	        loop.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_socket.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
115	        close(sock)
116	        loop.close()
117	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_sync.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
23	    logger.debug('Sending bytes: %s', cmd_pkt)
24	    sock.send(cmd_pkt)
25	    while not response_recvd:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_sync.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
25	    while not response_recvd:
26	        raw_data = sock.recv(100)
27	        logger.debug('Received: %s', raw_data)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/btsocket/btmgmt_sync.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
32	
33	    btmgmt_socket.close(sock)
34	    if data.event_frame.status != btmgmt_protocol.ErrorCodes.Success:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	with open(path.join(here, 'README.rst'), encoding='utf-8') as f:
24	    long_description = f.read()
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/btsocket-0.3.0/btsocket-0.3.0/setup.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    # The project's main homepage.
39	    url='https://github.com/ukBaz/python-btsocket',
40	
41	    # Author details
42	    author='Barry Byford',

--------------------------------------------------

Code scanned:
	Total lines of code: 1460
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 1.0
Files skipped (0):
