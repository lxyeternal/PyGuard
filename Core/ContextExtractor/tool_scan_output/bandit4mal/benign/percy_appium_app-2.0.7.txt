Run started:2025-04-12 10:22:44.935093

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
9	# Maybe get the CLI API address from the environment
10	PERCY_CLI_API = os.environ.get('PERCY_CLI_API') or 'http://localhost:5338'
11	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	# Maybe get the CLI API address from the environment
10	PERCY_CLI_API = os.environ.get('PERCY_CLI_API') or 'http://localhost:5338'
11	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
20	        try:
21	            response = requests.get(f'{PERCY_CLI_API}/percy/healthcheck', timeout=10)
22	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	            Environment.percy_build_url = data['build']['url']
28	            Environment.session_type = data.get('type', None)
29	            version = response.headers.get('x-percy-core-version')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	            Environment.session_type = data.get('type', None)
29	            version = response.headers.get('x-percy-core-version')
30	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
55	
56	        response = requests.post(f'{PERCY_CLI_API}/percy/comparison', json=body, timeout=600)
57	        # Handle errors

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	        if response.status_code != 200:
62	            raise CLIException(data.get('error', 'UnknownException'))
63	        return data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
72	
73	            response = requests.post(f'{PERCY_CLI_API}/percy/events', json=body, timeout=30)
74	            # Handle errors

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	            if response.status_code != 200:
79	                raise CLIException(data.get('error', 'UnknownException'))
80	            return data

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
96	
97	        response = requests.post(f'{PERCY_CLI_API}/percy/automateScreenshot', json=body, timeout=600)
98	        # Handle errors

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	        if response.status_code != 200:
103	            raise CLIException(data.get('error', 'UnknownException'))
104	        return data.get('data', {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/lib/cli_wrapper.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	            raise CLIException(data.get('error', 'UnknownException'))
104	        return data.get('data', {})
105	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/providers/app_automate.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        session_hash = str(session_details.get("sessionHash"))
38	        self.debug_url = "https://app-automate.browserstack.com/dashboard/v2/builds/" + build_hash + "/sessions/" + session_hash
39	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/providers/generic_provider.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
172	        with open(filepath, 'wb') as f:
173	            f.write(png_bytes)
174	        return filepath

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/percy/providers/generic_provider.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
172	        with open(filepath, 'wb') as f:
173	            f.write(png_bytes)
174	        return filepath

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	with open(path.join(cwd, 'README.md'), encoding='utf-8') as f:
8	    long_description = f.read()
9	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    author_email='team@percy.io',
19	    url='https://github.com/percy/percy-appium-python',
20	    keywords='appium percy visual testing',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_app_automate.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	class TestAppAutomate(unittest.TestCase):
12	    comparison_response = {'success': True, 'link': 'https://snapshots-url'}
13	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_app_automate.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	        debug_url = self.app_automate.get_debug_url()
31	        self.assertEqual(debug_url, 'https://app-automate.browserstack.com/dashboard/v2/builds/abc/sessions/def')
32	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_app_automate.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    def test_app_automate_supports_with_correct_url(self):
34	        app_automate_session = self.app_automate.supports('https://hub-cloud.browserstack.com/wd/hub')
35	        self.assertEqual(app_automate_session, True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_app_automate.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    def test_app_automate_supports_with_incorrect_url(self):
38	        app_automate_session = self.app_automate.supports('https://hub-cloud.generic.com/wd/hub')
39	        self.assertEqual(app_automate_session, False)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_app_automate.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        self.app_automate.screenshot('name')
75	        mock_screenshot_end.assert_called_once_with('name', 'https://link', 'success', None)
76	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_app_automate.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	            self.app_automate.screenshot('name')
84	        mock_screenshot_end.assert_called_with('name', 'https://link', 'failure', None, str(e.exception))
85	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_app_automate.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	    @patch.object(Metadata, 'session_id', PropertyMock(return_value='unique_session_id'))
69	    @patch.object(GenericProvider, 'screenshot', MagicMock(return_value={'link': 'https://link'}))
70	    def test_execute_percy_screenshot_end(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_app_percy.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	class TestAppPercy(unittest.TestCase):
20	    comparison_response = {'link': 'https://snapshot_url', 'success': True}
21	    sync_response = {'link': 'https://snapshot_url', 'data': 'sync-data', 'success': True}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_app_percy.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    comparison_response = {'link': 'https://snapshot_url', 'success': True}
21	    sync_response = {'link': 'https://snapshot_url', 'data': 'sync-data', 'success': True}
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_driver_metadata.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	        self.mock_webdriver.session_id = 'session_id_123'
16	        self.mock_webdriver.command_executor._url = 'https://example-hub:4444/wd/hub' # pylint: disable=W0212
17	        self.mock_webdriver.capabilities = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_driver_metadata.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    def test_command_executor_url(self):
38	        url = 'https://example-hub:4444/wd/hub'
39	        self.assertEqual(self.metadata.command_executor_url, url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_generic_provider.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	class TestGenericProvider(unittest.TestCase):
19	    comparison_response = {"comparison": {"id": 123, "url": "https://percy-build-url"}}
20	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_generic_provider.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
41	    def tearDown(self) -> None:
42	        shutil.rmtree(self.existing_dir)
43	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
31	# daemon threads automatically shut down when the main process exits
32	mock_server = HTTPServer(("localhost", 8000), MockServerRequestHandler)
33	mock_server_thread = Thread(target=mock_server.serve_forever)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        httpretty.GET,
54	        "http://localhost:5338/percy/healthcheck",
55	        body=health_body,
56	        adding_headers=health_headers,
57	        status=health_status,
58	    )
59	
60	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	        httpretty.POST,
64	        "http://localhost:5338/percy/comparison",
65	        body=(
66	            '{ "success": ' + ("true" if not fail else 'false, "error": "test"') + "}"
67	        ),
68	        status=(500 if fail else 200),
69	    )
70	
71	def mock_poa_screenshot(fail=False, sync=False):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	        httpretty.POST,
76	        "http://localhost:5338/percy/automateScreenshot",
77	        body=body,
78	        status=(500 if fail else 200),
79	    )
80	
81	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
152	
153	        self.assertEqual(httpretty.last_request().path, "/percy/healthcheck")
154	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
165	
166	        self.assertEqual(httpretty.last_request().path, "/percy/healthcheck")
167	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
180	
181	        self.assertEqual(httpretty.last_request().path, "/percy/comparison")
182	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
223	
224	        self.assertEqual(httpretty.last_request().path, "/percy/comparison")
225	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	        driver.command_executor = Mock()
261	        driver.command_executor._url = 'https://hub-cloud.browserstack.com/wd/hub'
262	
263	        element = Mock()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
272	
273	        self.assertEqual(httpretty.last_request().path, '/percy/automateScreenshot')
274	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/percy_appium_app-2.0.7/percy_appium_app-2.0.7/tests/test_screenshot.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
297	        driver.command_executor = Mock()
298	        driver.command_executor._url = 'https://hub-cloud.browserstack.com/wd/hub'
299	        self.mock_webdriver.capabilities = { 'key': 'value' }

--------------------------------------------------

Code scanned:
	Total lines of code: 2311
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 0.0
Files skipped (0):
