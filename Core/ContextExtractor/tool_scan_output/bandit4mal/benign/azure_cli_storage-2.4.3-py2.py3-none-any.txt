Run started:2025-04-12 12:20:39.096540

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/_help.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	
187	helps['storage blob copy start'] = """
188	type: command
189	short-summary: Copies a blob asynchronously. Use `az storage blob show` to check the status of the blobs.
190	examples:
191	  - name: Copies a blob asynchronously. Use `az storage blob show` to check the status of the blobs. (autogenerated)
192	    text: az storage blob copy start --account-key 00000000 --account-name MyAccount --destination-blob MyDestinationBlob --destination-container MyDestinationContainer --source-uri https://storage.blob.core.windows.net/photos
193	    crafted: true
194	"""
195	
196	helps['storage blob copy start-batch'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/_params.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
160	        c.argument('policy', type=file_type, completer=FilesCompleter(),
161	                   help='The Storage Account ManagementPolicies Rules, in JSON format. See more details in: '
162	                        'https://docs.microsoft.com/en-us/azure/storage/common/storage-lifecycle-managment-concepts.')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/_transformers.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
75	        if hasattr(entity_property, 'value') and isinstance(entity_property.value, bytes):
76	            entity_property.value = base64.b64encode(entity_property.value).decode()
77	    return entity

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/_transformers.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
75	        if hasattr(entity_property, 'value') and isinstance(entity_property.value, bytes):
76	            entity_property.value = base64.b64encode(entity_property.value).decode()
77	    return entity

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/_validators.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
207	
208	    uri = 'https://{}.blob.{}/{}/{}{}{}'.format(source_account_name,
209	                                                cmd.cli_ctx.cloud.suffixes.storage_endpoint,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/_validators.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
310	
311	    uri = 'https://{0}.{1}.{6}/{2}/{3}{4}{5}'.format(
312	        source_account_name,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	STORAGE_RESOURCE_ENDPOINT = "https://storage.azure.com"
25	SERVICES = {'blob', 'file'}

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
30	    def __init__(self, creds=None):
31	        self.system = platform.system()
32	        install_location = _get_default_install_location()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
30	    def __init__(self, creds=None):
31	        self.system = platform.system()
32	        install_location = _get_default_install_location()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
30	    def __init__(self, creds=None):
31	        self.system = platform.system()
32	        install_location = _get_default_install_location()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	                os.makedirs(install_dir)
37	            base_url = 'https://azcopyvnext.azureedge.net/release20190423/azcopy_{}_amd64_10.1.0.{}'
38	            if self.system == 'Windows':

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
46	            try:
47	                _urlretrieve(file_url, install_location)
48	                os.chmod(install_location,

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
47	                _urlretrieve(file_url, install_location)
48	                os.chmod(install_location,
49	                         os.stat(install_location).st_mode | stat.S_IXUSR | stat.S_IXGRP | stat.S_IXOTH)
50	            except IOError as err:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
47	                _urlretrieve(file_url, install_location)
48	                os.chmod(install_location,
49	                         os.stat(install_location).st_mode | stat.S_IXUSR | stat.S_IXGRP | stat.S_IXOTH)
50	            except IOError as err:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
159	def _get_default_install_location():
160	    system = platform.system()
161	    if system == 'Windows':

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
159	def _get_default_install_location():
160	    system = platform.system()
161	    if system == 'Windows':

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:160
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
159	def _get_default_install_location():
160	    system = platform.system()
161	    if system == 'Windows':

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
174	    import io
175	    req = urlopen(url)
176	    compressedFile = io.BytesIO(req.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175	    req = urlopen(url)
176	    compressedFile = io.BytesIO(req.read())
177	    if url.endswith('zip'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
182	            import StringIO  # pylint: disable=import-error
183	            zip_file = zipfile.ZipFile(StringIO.StringIO(req.read()))
184	        for fileName in zip_file.namelist():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186	                with open(install_location, 'wb') as f:
187	                    f.write(zip_file.read(fileName))
188	    elif url.endswith('gz'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
186	                with open(install_location, 'wb') as f:
187	                    f.write(zip_file.read(fileName))
188	    elif url.endswith('gz'):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
189	        import tarfile
190	        with tarfile.open(fileobj=compressedFile, mode="r:gz") as tar:
191	            for tarinfo in tar:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
192	                if tarinfo.isfile() and tarinfo.name.endswith('azcopy'):
193	                    with open(install_location, 'wb') as f:
194	                        f.write(tar.extractfile(tarinfo).read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
193	                    with open(install_location, 'wb') as f:
194	                        f.write(tar.extractfile(tarinfo).read())
195	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/azcopy/util.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
193	                    with open(install_location, 'wb') as f:
194	                        f.write(tar.extractfile(tarinfo).read())
195	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_storage-2.4.3-py2.py3-none-any/azure/cli/command_modules/storage/oauth_token_util.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        # should give back token that is valid for at least 5 mins
28	        token = Profile(cli_ctx=self.cli_ctx).get_raw_token(resource="https://storage.azure.com")[0][2]
29	        try:

--------------------------------------------------

Code scanned:
	Total lines of code: 4713
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 16.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 4.0
Files skipped (0):
