Run started:2025-04-12 15:27:04.407945

Test results:
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/pkg.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
280	            mode = 'r' if e == '.tar' else 'r:' + e.split('.')[2]
281	            arch = tarfile.open(sdist_path, mode=mode)
282	            func = tar_files

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/pkg.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
313	                continue
314	            with open(os.path.join(path, f)) as fobj:
315	                data = fobj.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/pkg.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
314	            with open(os.path.join(path, f)) as fobj:
315	                data = fobj.read()
316	            files.append((data, f))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/pypi.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	def pypi_client(index_url='http://pypi.python.org/pypi', *args, **kwargs):
18	    '''

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/pypi.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
68	
69	    r = urllib2.Request('http://pypi.python.org/simple/{0}'.format(package_name))
70	    return urllib2.urlopen(r, timeout=timeout).geturl().split('/')[-2]

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/pypi.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
69	    r = urllib2.Request('http://pypi.python.org/simple/{0}'.format(package_name))
70	    return urllib2.urlopen(r, timeout=timeout).geturl().split('/')[-2]
71	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/pypi.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
257	
258	    URL = 'http://pypi.python.org/pypi/{0}/json'
259	
260	    def __init__(self, package_name, fast=False):

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/pypi.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
277	        def _request(url, timeout=None):
278	            return urllib2.urlopen(url, timeout=timeout).read()
279	        if req_func is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/utils.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	    names = [n for n in zf.namelist() if search in n]
20	    fobj_list = [zf.read(n) for n in names]
21	    return list(zip(fobj_list, map(os.path.basename, names)))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/pkgtools/utils.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	    names = [n for n in tf.getnames() if 'egg-info' in n and not n.endswith('egg-info')]
25	    fobj_list = [tf.extractfile(n).read() for n in names]
26	    return list(zip(fobj_list, map(os.path.basename, names)))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/setup.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	
6	long_desc = '''pkgtools is a Python library that offers some tools to work with Python Packages. It includes two packages:
7	
8	    * `pkgtools.pypi`: a simple yet powerful interface to `PyPI <http://pypi.python.org/pypi>`_ (Python Package Index)
9	    * `pkgtools.pkg`: some package utilities, like metadata reading
10	
11	
12	Hello World!
13	------------
14	
15	::
16	
17	    >>> from pkgtools.pypi import PyPI
18	    >>> pypi = PyPI()
19	    >>> pypi.package_releases('pypol_')
20	    ['0.5']
21	    >>> pypi.package_releases('pypol_', True)
22	    ['0.5', '0.4', '0.3', '0.2']
23	    >>> pypol_egg = pypi.release_urls('pypol_', '0.5')[2]
24	    >>> pypol_egg
25	    Object({'has_sig': False, 'upload_time': <DateTime '20110213T09:33:07' at 97d666c>, 'comment_text': '',
26	    'python_version': '2.6', 'url': 'http://pypi.python.org/packages/2.6/p/pypol_/pypol_-0.5-py2.6.egg',
27	    'md5_digest': '20e660cef8513f35fdb0afd5390146bc', 'downloads': 46, 'filename': 'pypol_-0.5-py2.6.egg',
28	    'packagetype': 'bdist_egg', 'size': 116826})
29	    >>> pypol_egg['python_version']
30	    '2.6'
31	    >>> pypol_egg.python_version
32	    '2.6'
33	    >>> pypol_egg.filename
34	    'pypol_-0.5-py2.6.egg'
35	    >>> pypol_egg.url
36	    'http://pypi.python.org/packages/2.6/p/pypol_/pypol_-0.5-py2.6.egg'
37	
38	::
39	
40	    >>> from pkgtools.pkg import Installed
41	    >>> i = Installed('sphinx')
42	    >>> i
43	    <pkgtools.pkg.Installed object at 0x96f68ec>
44	    >>> i.file('entry_points.txt')
45	    {'console_scripts': {'sphinx-autogen': 'sphinx.ext.autosummary.generate:main',
46	                         'sphinx-build': 'sphinx:main',
47	                         'sphinx-quickstart': 'sphinx.quickstart:main'},
48	     'distutils.commands': {'build_sphinx': 'sphinx.setup_command:BuildDoc'}}
49	    >>> i.file('requires.txt')
50	    ['Pygments>=0.8', 'Jinja2>=2.2', 'docutils>=0.5']
51	    >>> i.file('depencency_links.txt')
52	    Traceback (most recent call last):
53	      File "<pyshell#8>", line 1, in <module>
54	        i.file('depencency_links.txt')
55	      File "pkg.py", line 80, in file
56	        raise KeyError('This package does not have {0} file'.format(name))
57	    KeyError: This package does not have depencency_links.txt file
58	    >>> i.file('PKG-INFO')['Metadata-Version']
59	    '1.0'
60	    >>> i.file('PKG-INFO')['Name']
61	    'Sphinx'
62	'''
63	
64	setup(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/setup.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	    license='MIT',
70	    url='http://pkgtools.readthedocs.org/',
71	    download_url='http://pypi.python.org/pypi/pkgtools',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pkgtools-0.7.3/pkgtools-0.7.3/setup.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	    url='http://pkgtools.readthedocs.org/',
71	    download_url='http://pypi.python.org/pypi/pkgtools',
72	    description='Python Packages Tools, with Python 3.3 support',

--------------------------------------------------

Code scanned:
	Total lines of code: 806
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 7.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 0.0
Files skipped (0):
