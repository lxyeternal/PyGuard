Run started:2025-04-12 16:23:49.590455

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	USER_POOL = "us-east-2_ghlOXVLi1"
12	USER_POOL_URL = f"https://cognito-idp.us-east-2.amazonaws.com/{USER_POOL}"
13	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
97	
98	            response = self._do_request(method, path, **kwargs)
99	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
103	                # then run the request again with updated tokens
104	                response = self._do_request(method, path, **kwargs)
105	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	    def _do_request(self, method: str, path: str, **kwargs) -> requests.Response:
129	        headers = kwargs.get("headers")
130	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
136	
137	        return requests.request(
138	            method,
139	            f"{self.host}/{path}",
140	            **kwargs,
141	            headers=headers,
142	            timeout=(self.connect_timeout, self.read_timeout),
143	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	        if not self.pool_wellknown_jwks:
148	            self.pool_wellknown_jwks = requests.get(
149	                USER_POOL_URL + "/.well-known/jwks.json",
150	                timeout=5,
151	            ).json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	
153	        kid = jwt.get_unverified_header(token).get("kid")
154	        keys = self.pool_wellknown_jwks.get("keys")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
153	        kid = jwt.get_unverified_header(token).get("kid")
154	        keys = self.pool_wellknown_jwks.get("keys")
155	        key = list(filter(lambda x: x.get("kid") == kid, keys))[0]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
154	        keys = self.pool_wellknown_jwks.get("keys")
155	        key = list(filter(lambda x: x.get("kid") == kid, keys))[0]
156	        hmac_key = jwt.api_jwk.PyJWK(key).key

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
184	        """Make a request."""
185	        response = self._do_request(method, path, **kwargs)
186	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/auth.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
190	            # then run the request again with updated tokens
191	            response = self._do_request(method, path, **kwargs)
192	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	API_ROOT = "https://api.emporiaenergy.com"
25	API_CHANNELS = "devices/{deviceGid}/channels"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	API_MAINTENANCE = (
39	    "https://s3.amazonaws.com/com.emporiaenergy.manual.ota/maintenance/maintenance.json"
40	)
41	
42	
43	class PyEmVue(object):
44	    def __init__(self, connect_timeout: float = 6.03, read_timeout: float = 10.03):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	        """Checks to see if the API is down for maintenance, returns the reported message if present."""
53	        response = requests.get(API_MAINTENANCE)
54	        if response.status_code == 404:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
62	        """Get all devices under the current customer account."""
63	        response = self.auth.request("get", API_CUSTOMER_DEVICES)
64	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
78	        url = API_DEVICE_PROPERTIES.format(deviceGid=device.device_gid)
79	        response = self.auth.request("get", url)
80	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
88	        url = API_CHANNELS.format(deviceGid=channel.device_gid)
89	        response = self.auth.request("put", url, json=channel.as_dictionary())
90	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
97	        """Get details for the current customer."""
98	        response = self.auth.request("get", API_CUSTOMER)
99	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
141	            attempts += 1
142	            response = self.auth.request("get", url)
143	            if response.status_code == 200 and response.text:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
191	        )
192	        response = self.auth.request("get", url)
193	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
205	        """Return a list of outlets linked to the account. Deprecated, use get_devices_status instead."""
206	        response = self.auth.request("get", API_GET_STATUS)
207	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
223	
224	        response = self.auth.request("put", API_OUTLET, json=outlet.as_dictionary())
225	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
230	        """Return a list of EVSEs/chargers linked to the account. Deprecated, use get_devices_status instead."""
231	        response = self.auth.request("get", API_GET_STATUS)
232	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
252	
253	        response = self.auth.request("put", API_CHARGER, json=charger.as_dictionary())
254	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
261	        """Gets the list of outlets and chargers. If device list is provided, updates the connected status on each device."""
262	        response = self.auth.request("get", API_GET_STATUS)
263	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
290	        """Gets the list of channel types"""
291	        response = self.auth.request("get", API_CHANNEL_TYPES)
292	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
304	        """Get all vehicles under the current customer account."""
305	        response = self.auth.request("get", API_VEHICLES)
306	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/pyemvue/pyemvue.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
316	        url = API_VEHICLE_STATUS.format(vehicleGid=vehicle_gid)
317	        response = self.auth.request("get", url)
318	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyemvue-0.18.8/pyemvue-0.18.8/tools/apinspect.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	                        except:
33	                            sample['body'] = b.read()
34	                if 'response_body.json' in files:

--------------------------------------------------

Code scanned:
	Total lines of code: 1884
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 26.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 0.0
Files skipped (0):
