Run started:2025-04-12 11:46:19.632165

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/const.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	CFG_CONST = ["CFG_NAME", "CFG_ENV_VARS"]
13	DEFAULT_SERVER = "http://refgenomes.databio.org"  # "http://rg.databio.org"
14	TAG_NAME_BANNED_CHARS = [":", "/"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/const.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
266	
267	CONF_STRUCTURE = """
268	# example genome configuration structure

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/exceptions.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	DOC_URL = "http://refgenie.databio.org/en/latest/genome_config/"
21	
22	
23	class RefgenconfError(Exception):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/helpers.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
144	                        ).format(alias=genome)
145	                        digest = send_data_request(url_alias)
146	                        _LOGGER.info(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/helpers.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
261	        d = os.path.join(rgc[CFG_FOLDER_KEY], genome_v[CFG_ALIASES_KEY][0])
262	        shutil.rmtree(d)
263	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/helpers.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
300	    _LOGGER.debug(f"Downloading JSON data; querying URL: {url}")
301	    resp = get(url, params=params)
302	    if resp.ok:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
293	        self.make_writable(filepath)
294	        self.write()
295	        self.make_readonly()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
419	        else:
420	            genomes_data = send_data_request(
421	                get_json_url(server_url, API_ID_GENOMES_DICT)
422	            )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
640	        for d in dirs_to_remove:
641	            shutil.rmtree(d)
642	        if dirs_to_remove:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
824	                continue
825	            asset_seek_key_target = send_data_request(
826	                asset_seek_key_url,
827	                params={"tag": tag_name, "remoteClass": remote_class},
828	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1087	                    for g, data in self[CFG_GENOMES_KEY].items()
1088	                    if asset in data.get(CFG_ASSETS_KEY)
1089	                ],

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1208	
1209	            aliases_by_digest = send_data_request(aliases_url)
1210	            # convert the original, condensed mapping to a data structure with optimal time complexity

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1221	                    if g in aliases_by_digest.keys()
1222	                    else digests_by_alias.get(g, None)
1223	                    for g in genomes

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1545	                determined_tag = (
1546	                    send_data_request(
1547	                        get_json_url(server_url, API_ID_DEFAULT_TAG).format(
1548	                            genome=genome, asset=asset
1549	                        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1575	            try:
1576	                archive_data = send_data_request(
1577	                    url_asset_attrs, params={"tag": determined_tag}
1578	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1590	                _LOGGER.debug("Determined server URL: {}".format(server_url))
1591	                genome_archive_data = send_data_request(url_genome_attrs)
1592	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1652	            try:
1653	                signal.signal(signal.SIGINT, build_signal_handler(tarpath))
1654	                _download_url_progress(

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1653
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1652	            try:
1653	                signal.signal(signal.SIGINT, build_signal_handler(tarpath))
1654	                _download_url_progress(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1684	            new_checksum = checksum(tarpath)
1685	            old_checksum = archive_data and archive_data.get(CFG_ARCHIVE_CHECKSUM_KEY)
1686	            if old_checksum and new_checksum != old_checksum:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:1903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1902	                try:
1903	                    digest = send_data_request(url_alias)
1904	                except DownloadJsonError:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:2519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2518	        try:
2519	            remote_digest = send_data_request(asset_digest_url)
2520	        except DownloadJsonError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:2670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2669	        try:
2670	            path = super(RefGenConf, self).write(filepath=filepath, exclude_case=True)
2671	        except ValidationError:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:2800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2799	        """
2800	        genomes_data = send_data_request(url, params={"includeSeekKeys": True})
2801	        return (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:2897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2896	    # prompt the user
2897	    url = "http://refgenie.databio.org/en/latest/upgrade_config/"
2898	    if not force and not query_yes_no(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:2963
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2962	    # write over the config file
2963	    rgc.write()
2964	    return True

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:2993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
2992	        """
2993	        f = urlopen(x)
2994	        content_len = f.info().get("Content-length")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:2994
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2993	        f = urlopen(x)
2994	        content_len = f.info().get("Content-length")
2995	        f.close()

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:3013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
3012	    with progress as p:
3013	        urlretrieve(url, filename=output_path, reporthook=p.rep_hook)
3014	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:3309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
3308	    """
3309	    json = send_data_request(url + "/openapi.json")
3310	    return map_paths_by_id(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf.py:3345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
3344	    elif os.path.isdir(path):
3345	        rmtree(path)
3346	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
205	        self.make_writable(filepath)
206	        self.write()
207	        self.make_readonly()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
205	        self.make_writable(filepath)
206	        self.write()
207	        self.make_readonly()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1060	            try:
1061	                signal.signal(signal.SIGINT, build_signal_handler(filepath))
1062	                _download_url_progress(

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1060	            try:
1061	                signal.signal(signal.SIGINT, build_signal_handler(filepath))
1062	                _download_url_progress(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1114	                    if os.path.isdir(tag_dir):
1115	                        shutil.rmtree(tag_dir)
1116	                        _LOGGER.info("Removed existing directory: {}".format(tag_dir))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:1716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1715	        self.run_plugins(PRE_UPDATE_HOOK)
1716	        path = super(_RefGenConfV03, self).write(filepath=filepath)
1717	        self.run_plugins(POST_UPDATE_HOOK)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:1716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1715	        self.run_plugins(PRE_UPDATE_HOOK)
1716	        path = super(_RefGenConfV03, self).write(filepath=filepath)
1717	        self.run_plugins(POST_UPDATE_HOOK)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:1748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1747	    _LOGGER.debug("Downloading JSON data; querying URL: '{}'".format(url))
1748	    resp = requests.get(url, params=params)
1749	    if resp.ok:

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:1768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
1767	    ) as dpb:
1768	        urllib.request.urlretrieve(url, filename=output_path, reporthook=dpb.update_to)
1769	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:1988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
1987	    """
1988	    with urllib.request.urlopen(url) as response:
1989	        encoding = response.info().get_content_charset("utf8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:1990
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1989	        encoding = response.info().get_content_charset("utf8")
1990	        return json.loads(response.read().decode(encoding))
1991	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/refgenconf/refgenconf_v03.py:2144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2143	    elif os.path.isdir(path):
2144	        rmtree(path)
2145	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/refgenconf-0.12.2/refgenconf-0.12.2/setup.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    ),
50	    url="https://refgenie.databio.org",
51	    author=u"Nathan Sheffield, Vince Reuter, Michal Stolarczyk",

--------------------------------------------------

Code scanned:
	Total lines of code: 6537
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 36.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 2.0
Files skipped (0):
