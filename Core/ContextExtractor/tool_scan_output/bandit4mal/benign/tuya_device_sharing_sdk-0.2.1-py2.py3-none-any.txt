Run started:2025-04-12 12:19:43.063368

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	        self.expire_time = (
30	                token_info.get("t", 0)
31	                + token_info.get("expire_time", 0) * 1000

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	                token_info.get("t", 0)
31	                + token_info.get("expire_time", 0) * 1000
32	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	        )
33	        self.uid = token_info.get("uid", "")
34	        self.access_token = token_info.get("access_token", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	        self.uid = token_info.get("uid", "")
34	        self.access_token = token_info.get("access_token", "")
35	        self.refresh_token = token_info.get("refresh_token", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	        self.access_token = token_info.get("access_token", "")
35	        self.refresh_token = token_info.get("refresh_token", "")
36	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
106	
107	        response = self.session.request(
108	            method, self.endpoint + path, params=params, json=body, headers=headers
109	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	
120	        if not ret.get("success"):
121	            raise Exception(f"network error:({ret['code']}) {ret['msg']}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	
123	        result = _aex_gcm_decrypt(ret.get("result"), secret)
124	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
144	        try:
145	            response = self.get("/v1.0/m/token/" + self.token_info.refresh_token)
146	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	
147	            if response.get("success"):
148	                result = response.get("result", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	            if response.get("success"):
148	                result = response.get("result", {})
149	                token_info = {

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
175	        """
176	        return self.__request("GET", path, params, None)
177	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
191	        """
192	        return self.__request("POST", path, params, body)
193	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
205	        """
206	        return self.__request("PUT", path, None, body)
207	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
219	        """
220	        return self.__request("DELETE", path, params, None)
221	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
243	
244	    return base64.b64encode(nonce) + base64.b64encode(ciphertext)
245	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:244
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
243	
244	    return base64.b64encode(nonce) + base64.b64encode(ciphertext)
245	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
243	
244	    return base64.b64encode(nonce) + base64.b64encode(ciphertext)
245	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:244
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
243	
244	    return base64.b64encode(nonce) + base64.b64encode(ciphertext)
245	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
247	def _aex_gcm_decrypt(cipher_data: str, secret: str) -> str:
248	    cipher_data = base64.b64decode(cipher_data)
249	    nonce = cipher_data[:12]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:248
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
247	def _aex_gcm_decrypt(cipher_data: str, secret: str) -> str:
248	    cipher_data = base64.b64decode(cipher_data)
249	    nonce = cipher_data[:12]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/customerapi.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
285	    for item in headers:
286	        val = data.get(item, "")
287	        if val != "":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	        """Init SharingMQConfig."""
24	        result = mqConfigResponse.get("result", {})
25	        self.url = result.get("url", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	        result = mqConfigResponse.get("result", {})
25	        self.url = result.get("url", "")
26	        self.client_id = result.get("clientId", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
25	        self.url = result.get("url", "")
26	        self.client_id = result.get("clientId", "")
27	        self.username = result.get("username", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	        self.client_id = result.get("clientId", "")
27	        self.username = result.get("username", "")
28	        self.password = result.get("password", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	        self.username = result.get("username", "")
28	        self.password = result.get("password", "")
29	        self.expire_time = result.get("expireTime", 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	        self.password = result.get("password", "")
29	        self.expire_time = result.get("expireTime", 0)
30	        self.owner_topic = result.get("topic").get("ownerId").get("sub")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	        self.expire_time = result.get("expireTime", 0)
30	        self.owner_topic = result.get("topic").get("ownerId").get("sub")
31	        self.dev_topic = result.get("topic").get("devId").get("sub")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	        self.expire_time = result.get("expireTime", 0)
30	        self.owner_topic = result.get("topic").get("ownerId").get("sub")
31	        self.dev_topic = result.get("topic").get("devId").get("sub")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	        self.expire_time = result.get("expireTime", 0)
30	        self.owner_topic = result.get("topic").get("ownerId").get("sub")
31	        self.dev_topic = result.get("topic").get("devId").get("sub")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	        self.owner_topic = result.get("topic").get("ownerId").get("sub")
31	        self.dev_topic = result.get("topic").get("devId").get("sub")
32	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	        self.owner_topic = result.get("topic").get("ownerId").get("sub")
31	        self.dev_topic = result.get("topic").get("devId").get("sub")
32	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	        self.owner_topic = result.get("topic").get("ownerId").get("sub")
31	        self.dev_topic = result.get("topic").get("devId").get("sub")
32	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
46	        link_id = f"tuya-device-sharing-sdk-python.{uuid.uuid1()}"
47	        response = self.api.post("/v1.0/m/life/ha/access/config", None,
48	                                 {"linkId": link_id})
49	        if (response.get("success"), False) is False:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/mq.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	                                 {"linkId": link_id})
49	        if (response.get("success"), False) is False:
50	            raise Exception("get mqtt config error.")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/cz_timer1_alg.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
18	def numDecodeToIntList(input):
19	    bytes = base64.b64decode(input)
20	    return [item & 0xFF for item in bytes]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/cz_timer1_alg.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
18	def numDecodeToIntList(input):
19	    bytes = base64.b64decode(input)
20	    return [item & 0xFF for item in bytes]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/cz_timer2_alg.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
18	def numDecodeToIntList(input):
19	    bytes = base64.b64decode(input)
20	    return [item & 0xFF for item in bytes]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/cz_timer2_alg.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
18	def numDecodeToIntList(input):
19	    bytes = base64.b64decode(input)
20	    return [item & 0xFF for item in bytes]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_alarm.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
20	def decode(input):
21	    return base64.b64decode(input)
22	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_alarm.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
20	def decode(input):
21	    return base64.b64decode(input)
22	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_daily.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
38	def decode(input_str):
39	    return base64.b64decode(input_str)
40	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_daily.py:39
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
38	def decode(input_str):
39	    return base64.b64decode(input_str)
40	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_data.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
20	def decode(input_str):
21	    return base64.b64decode(input_str)
22	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_data.py:21
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
20	def decode(input_str):
21	    return base64.b64decode(input_str)
22	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_frozen.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
18	def decode(input: str) -> bytes:
19	    return base64.b64decode(input)
20	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_frozen.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
18	def decode(input: str) -> bytes:
19	    return base64.b64decode(input)
20	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_month.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
18	def decode(input: str) -> bytes:
19	    return base64.b64decode(input)
20	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_month.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
18	def decode(input: str) -> bytes:
19	    return base64.b64decode(input)
20	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_params.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
18	def decode(input: str) -> bytes:
19	    return base64.b64decode(input)
20	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_params.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
18	def decode(input: str) -> bytes:
19	    return base64.b64decode(input)
20	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_tariff.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
37	def decode(input_string):
38	    return b64decode(input_string)
39	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/db_v1_tariff.py:38
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
37	def decode(input_string):
38	    return b64decode(input_string)
39	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/ms_dp_syn_alg.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
21	        data = input_str
22	        sync_byte = base64.b64decode(data)
23	        data_size = len(sync_byte)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/strategy_repo/ms_dp_syn_alg.py:22
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
21	        data = input_str
22	        sync_byte = base64.b64decode(data)
23	        data_size = len(sync_byte)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/user.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
15	    def qr_code(self, client_id: str, schema: str, user_code: str) -> Dict[str, Any]:
16	        response = self.session.request("POST",
17	                                        f"https://{URL_PATH}/v1.0/m/life/home-assistant/qrcode/tokens?clientid={client_id}&usercode={user_code}&schema={schema}",
18	                                        params=None, json=None, headers=None)
19	        return response.json()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/user.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
21	    def login_result(self, token: str, client_id: str, user_code: str) -> Tuple[bool, Dict[str, Any]]:
22	        response = self.session.request("GET",
23	                                        f"https://{URL_PATH}/v1.0/m/life/home-assistant/qrcode/tokens/{token}?clientid={client_id}&usercode={user_code}",
24	                                        params=None, json=None, headers=None)
25	        response = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/user.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
25	        response = response.json()
26	        if response.get("success"):
27	            ret = response.get("result", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/user.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	        if response.get("success"):
27	            ret = response.get("result", {})
28	            ret["t"] = response.get("t")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/user.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	            ret = response.get("result", {})
28	            ret["t"] = response.get("t")
29	            return True, ret

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/user.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
39	        self.api.refresh_access_token_if_need()
40	        self.api.post("/v1.0/m/token/terminal/expire", None, {
41	            "accessToken": self.api.token_info.access_token,
42	            "terminalId": terminal_id
43	        })

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tuya_device_sharing_sdk-0.2.1-py2.py3-none-any/tuya_sharing/user.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
45	    def user_version_report(self, system_version: str, ty_plugin_version: str, ty_sdk_version: str):
46	        self.api.post("/v1.0/m/life/home-assistant/qrcode/versions", None, {
47	            "system_version": system_version,
48	            "ty_plugin_version": ty_plugin_version,
49	            "ty_sdk_version": ty_sdk_version
50	        })

--------------------------------------------------

Code scanned:
	Total lines of code: 2179
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 50.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 50.0
		High: 13.0
Files skipped (0):
