Run started:2025-04-12 10:16:36.944781

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	def crds_forwarded_url():
70	    return "https://localhost:8001/"
71	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
210	def hst_shared_cache_state(crds_shared_group_cache):
211	    cfg = ConfigState(cache=crds_shared_group_cache, url="https://hst-crds.stsci.edu", observatory="hst")
212	    cfg.config_setup()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	def hst_default_cache_state(default_cache):
219	    cfg = ConfigState(cache=default_cache, mode='auto', url="https://hst-crds.stsci.edu", observatory="hst")
220	    cfg.config_setup()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
225	def jwst_default_cache_state(default_cache):
226	    cfg = ConfigState(cache=default_cache, mode='auto', url="https://jwst-crds.stsci.edu", observatory="jwst")
227	    cfg.config_setup()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
235	        cache=str(test_temp_dir),
236	        url="https://hst-crds.stsci.edu",
237	        observatory="hst",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
247	        cache=None,
248	        url="https://jwst-crds.stsci.edu",
249	        observatory="jwst",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
259	        cache=crds_shared_group_cache,
260	        url="https://jwst-crds.stsci.edu",
261	        observatory="jwst")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
270	        cache=crds_shared_group_cache,
271	        url="https://jwst-crds-serverless.stsci.edu",
272	        observatory="jwst"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
282	        cache=crds_shared_group_cache,
283	        url="https://hst-serverless-mode.stsci.edu",
284	        observatory="hst"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
306	        cache=crds_shared_group_cache,
307	        url="https://roman-crds-serverless.stsci.edu",
308	        observatory="roman"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
316	def broken_state():
317	    cfg = ConfigState(cache="/nowhere", url="https://server-is-out-of-town")
318	    cfg.config_setup()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
340	def roman_test_cache_state(test_cache):
341	    cfg = ConfigState(cache=test_cache, url="https://roman-serverless-mode.stsci.edu", observatory="roman")
342	    cfg.config_setup()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/conftest.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
348	def tobs_test_cache_state(test_cache):
349	    cfg = ConfigState(cache=test_cache, url="https://tobs-serverless-mode.stsci.edu", clear_existing=False)
350	    cfg.config_setup()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/__init__.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	
128	URL = os.environ.get("CRDS_SERVER_URL", "https://crds-serverless-mode.stsci.edu")
129	api.set_crds_server(URL)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/bestrefs/stale.py:730
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
729	        path = self.cache / name
730	        table.write(path, format='ascii.' + format, overwrite=True)
731	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/bestrefs/stale.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
796	        path = self.cache / name
797	        pars = Table.read(path)
798	        mask = (pars['date_obs_mjd'] >= start_time.mjd) & (pars['date_obs_mjd'] <= end_time.mjd)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/bestrefs/stale.py:880
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
879	                text +='\n\n'
880	                text += fh.read()
881	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/certify/certify.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
683	        with open(self.filename, "rb") as handle:
684	            contents = handle.read()
685	        return contents

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
280	    encoded_compressed_data = S.get_sqlite_db(observatory)
281	    data = zlib.decompress(base64.b64decode(encoded_compressed_data))
282	    path = config.get_sqlite3_db_path(observatory)

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:281
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
280	    encoded_compressed_data = S.get_sqlite_db(observatory)
281	    data = zlib.decompress(base64.b64decode(encoded_compressed_data))
282	    path = config.get_sqlite3_db_path(observatory)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
280	    encoded_compressed_data = S.get_sqlite_db(observatory)
281	    data = zlib.decompress(base64.b64decode(encoded_compressed_data))
282	    path = config.get_sqlite3_db_path(observatory)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:281
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
280	    encoded_compressed_data = S.get_sqlite_db(observatory)
281	    data = zlib.decompress(base64.b64decode(encoded_compressed_data))
282	    path = config.get_sqlite3_db_path(observatory)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
284	    with open(path, "wb+") as db_out:
285	        db_out.write(data)
286	    return path

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
824	            for data in generator:
825	                outfile.write(data)
826	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
835	        log.verbose("Running download plugin:", repr(plugin_cmd))
836	        status = os.WEXITSTATUS(os.system(plugin_cmd))
837	        if status != 0:

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:836
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
835	        log.verbose("Running download plugin:", repr(plugin_cmd))
836	        status = os.WEXITSTATUS(os.system(plugin_cmd))
837	        if status != 0:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
848	        try:
849	            infile = request.urlopen(url)
850	            file_size = utils.human_format_number(self.catalog_file_size(filename)).strip()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
851	            stats = utils.TimingStats()
852	            data = infile.read(config.CRDS_DATA_CHUNK_SIZE)
853	            while data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/api.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
859	                yield data
860	                data = infile.read(config.CRDS_DATA_CHUNK_SIZE)
861	        except Exception as exc:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/proxy.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
29	    try:
30	        request.urlopen('')
31	    except Exception:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/proxy.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
33	
34	init_urlopen()
35	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/proxy.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
150	        try:
151	            channel = request.urlopen(url, parameters, timeout=timeout)
152	            return channel.read().decode("utf-8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/proxy.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
151	            channel = request.urlopen(url, parameters, timeout=timeout)
152	            return channel.read().decode("utf-8")
153	        except Exception as exc:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/proxy.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
201	    compressed = gzip.compress(utf8)
202	    b64 = base64.b64encode(compressed)
203	    ascii = b64.decode("ascii")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/proxy.py:202
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
201	    compressed = gzip.compress(utf8)
202	    b64 = base64.b64encode(compressed)
203	    ascii = b64.decode("ascii")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/proxy.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
218	        b64 = ascii.encode("ascii")
219	        compressed = base64.b64decode(b64)
220	        utf8 = gzip.decompress(compressed)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/client/proxy.py:219
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
218	        b64 = ascii.encode("ascii")
219	        compressed = base64.b64decode(b64)
220	        utf8 = gzip.decompress(compressed)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/cmdline.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
672	        with open(filename, "w+") as err_file:
673	            err_file.write("\n".join(sorted(error_list))+"\n")
674	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/config.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	                    raise exceptions.CrdsWebAuthenticationError("You must 'chmod 0600 $HOME/.crds.ini' to make it secret.")
38	                parser.read(ini_path)
39	                CRDS_INI_PARSER = parser

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/config.py:582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
581	            with open(mode_path) as pfile:
582	                mode = pfile.read().strip()
583	            # log.verbose("Determined cache format from", repr(mode_path), "as", repr(mode))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/config.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
606	        from crds.core import heavy_client as hv   #  yeah,  kinda gross
607	        hv.cache_atomic_write(mode_path, mode, "Couldn't save sub-directory mode config")
608	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/config.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
804	CRDS_DEFAULT_SERVERS = {
805	    "hst" : "https://hst-crds.stsci.edu",
806	    "jwst" : "https://jwst-crds.stsci.edu",
807	    "roman" : "https://roman-crds.stsci.edu",
808	    # None : "https://crds-serverless-mode.stsci.edu"
809	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/config.py:806
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
805	    "hst" : "https://hst-crds.stsci.edu",
806	    "jwst" : "https://jwst-crds.stsci.edu",
807	    "roman" : "https://roman-crds.stsci.edu",
808	    # None : "https://crds-serverless-mode.stsci.edu"
809	}
810	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/config.py:807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
806	    "jwst" : "https://jwst-crds.stsci.edu",
807	    "roman" : "https://roman-crds.stsci.edu",
808	    # None : "https://crds-serverless-mode.stsci.edu"
809	}
810	
811	def get_server_url(observatory):

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/config.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
832	        if username in ["None", "none", None]:
833	            username = getpass.getuser()
834	        USERNAME.set(username)

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/config.py:833
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
832	        if username in ["None", "none", None]:
833	            username = getpass.getuser()
834	        USERNAME.set(username)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/heavy_client.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
557	            "is inconsistent with observatory", repr(observatory) + ".",
558	            "You may be configured for the wrong project.  "
559	            "Check CRDS_SERVER_URL and CRDS_OBSERVATORY "
560	            "environment settings.  See https://jwst-crds.stsci.edu/docs/cmdline_bestrefs/ (JWST) "
561	            "or https://hst-crds.stsci.edu/docs/cmdline_bestrefs/ (HST) for information on configuring CRDS.")
562	    return info

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/heavy_client.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
580	    server_config_path = os.path.join(path, "server_config")
581	    cache_atomic_write(server_config_path, pprint.pformat(info), "SERVER INFO")
582	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/heavy_client.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
585	    bad_files_path = os.path.join(path, "bad_files.txt")
586	    cache_atomic_write(bad_files_path, bad_files_lines, "BAD FILES LIST")
587	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/heavy_client.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
605	            with open(temp_path, mode) as file_:
606	                file_.write(contents)
607	            os.rename(temp_path, replace_path)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/heavy_client.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
615	    """Return last connected server status to help configure off-line use."""
616	    with log.fatal_error_on_exception("CRDS server connection and cache load FAILED.  Cannot continue.\n"
617	                         " See https://hst-crds.stsci.edu/docs/cmdline_bestrefs/ or https://jwst-crds.stsci.edu/docs/cmdline_bestrefs/\n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/heavy_client.py:750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
749	        pickled = pickle.dumps(loaded)
750	        cache_atomic_write(pickle_file, pickled, "CONTEXT PICKLE")
751	        log.info("Saved pickled context", repr(pickle_file))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/log.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
173	        if self.eol_pending:
174	            self.write()
175	        return self.format(*args, **keys)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/log.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
214	        sys.stderr.flush()
215	        sys.stdout.write(output)
216	        sys.stdout.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/pysh.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
354	        for line in lines:
355	            os.write(handle, line.encode("utf-8"))
356	    finally:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/pysh.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
354	        for line in lines:
355	            os.write(handle, line.encode("utf-8"))
356	    finally:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/pysh.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
358	    try:
359	        exec(open(fname).read(), globals, locals)
360	    finally:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/pysh.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
358	    try:
359	        exec(open(fname).read(), globals, locals)
360	    finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/reftypes.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
117	    with open(combined_specs_path, "w+") as specs_file:
118	        specs_file.write(specs_json)
119	        log.info("Saved combined type specs to", repr(combined_specs_path))

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/rmap.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
304	        namespace.update(selectors.SELECTORS)
305	        exec(code, namespace)
306	        header = LowerCaseDict(namespace["header"])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/rmap.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
388	        with open(filename, "w+") as handle:
389	            handle.write(self.format())
390	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/rmap.py:1841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1840	    new_mapping = ReferenceMapping.from_string(new_rmap, ignore_checksum=True)
1841	    new_mapping.write(new_filename)
1842	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/selectors.py:2087
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2086	                else:
2087	                    log.verbose_warning("-"*40 + f"\nMatch case\n{key_data}\nis an equal weight special case of\n{other_data}","""
2088	For some parameter sets, CRDS interprets both matches as equally good.
2089	See the file submission section of the CRDS server user's guide here:
2090	    https://hst-crds.stsci.edu/static/users_guide/index.html
2091	for more explanation.
2092	""", "-"*40)
2093	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:385
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
384	                out.seek(0)
385	                return result, out.read()
386	            finally:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
571	    with open(fname) as sourcefile:
572	        contents = sourcefile.read()
573	    return ast.literal_eval(contents)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
602	                    "Failed chmod'ing new directory", repr(subdir), "to %o." % mode):
603	                os.chmod(subdir, mode)
604	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:603
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
602	                    "Failed chmod'ing new directory", repr(subdir), "to %o." % mode):
603	                os.chmod(subdir, mode)
604	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
622	    user_writeable = bool(stats.st_mode & stat.S_IWUSR)
623	    user_id = os.geteuid() if 'windows' not in platform.system().lower() else stats.st_uid
624	    effective_user_matches =  bool(stats.st_uid == user_id)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
622	    user_writeable = bool(stats.st_mode & stat.S_IWUSR)
623	    user_id = os.geteuid() if 'windows' not in platform.system().lower() else stats.st_uid
624	    effective_user_matches =  bool(stats.st_uid == user_id)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:623
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
622	    user_writeable = bool(stats.st_mode & stat.S_IWUSR)
623	    user_id = os.geteuid() if 'windows' not in platform.system().lower() else stats.st_uid
624	    effective_user_matches =  bool(stats.st_uid == user_id)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
625	    group_writeable = bool(stats.st_mode & stat.S_IWGRP)
626	    group_id = os.getgroups() if 'windows' not in platform.system().lower() else [stats.st_gid]
627	    group_matches = bool(stats.st_gid in group_id)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
625	    group_writeable = bool(stats.st_mode & stat.S_IWGRP)
626	    group_id = os.getgroups() if 'windows' not in platform.system().lower() else [stats.st_gid]
627	    group_matches = bool(stats.st_gid in group_id)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:626
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
625	    group_writeable = bool(stats.st_mode & stat.S_IWGRP)
626	    group_id = os.getgroups() if 'windows' not in platform.system().lower() else [stats.st_gid]
627	    group_matches = bool(stats.st_gid in group_id)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
700	    obj = s3.Object(bucket_name, key)
701	    binary = obj.get()["Body"].read()
702	    if mode == "text":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
717	    import requests
718	    r = requests.get(url)
719	    r.raise_for_status()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
737	        with open(uri, mode) as file:
738	            return file.read()
739	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:751
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
750	        while size < insize:
751	            block = infile.read(config.CRDS_CHECKSUM_BLOCK_SIZE)
752	            size += len(block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
770	            while size < insize:
771	                block = source_file.read(config.CRDS_CHECKSUM_BLOCK_SIZE)
772	                destination_file.write(block)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
771	                block = source_file.read(config.CRDS_CHECKSUM_BLOCK_SIZE)
772	                destination_file.write(block)
773	                size += len(block)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
847	    with log.augment_exception("Error importing", repr(import_cmd)):
848	        exec(import_cmd, namespace, namespace)
849	        return namespace[cls]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:1081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1080	    """"Apply instrument fixers to `instr` to replace obsolete synonyms with standard version."""
1081	    return get_all_instrument_fixers().get(instr, instr)
1082	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1108	    for key in possible_keys:
1109	        val = getter.get(key.upper(), None)
1110	        if val is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:1111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1110	        if val is None:
1111	            val = getter.get(key.lower(), None)
1112	        if val is not None and val not in ["undefined", "UNDEFINED"]:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/core/utils.py:1181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1180	            case = { "CASE_" + str(i) : comb }
1181	            outfile.write(json.dumps(case) + "\n")
1182	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
206	        if self.mapping_text_diffs:   # only banner when there's two kinds to differentiate
207	            log.write("="*20, "logical differences",  repr(self.old_file), "vs.", repr(self.new_file), "="*20)
208	        if self.hide_boring_diffs:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
206	        if self.mapping_text_diffs:   # only banner when there's two kinds to differentiate
207	            log.write("="*20, "logical differences",  repr(self.old_file), "vs.", repr(self.new_file), "="*20)
208	        if self.hide_boring_diffs:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
212	            if self.primitive_diffs:
213	                log.write("="*80)
214	            diff2 = simplify_to_lowest_mapping(diff1) if self.lowest_mapping_only else diff1

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
212	            if self.primitive_diffs:
213	                log.write("="*80)
214	            diff2 = simplify_to_lowest_mapping(diff1) if self.lowest_mapping_only else diff1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
216	            if not self.squash_tuples:
217	                log.write(diff2)
218	            else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
216	            if not self.squash_tuples:
217	                log.write(diff2)
218	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
218	            else:
219	                log.write(self.squash_diff_tuples(diff2))
220	            if self.primitive_diffs and "header" not in diff_action(diff1):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
218	            else:
219	                log.write(self.squash_diff_tuples(diff2))
220	            if self.primitive_diffs and "header" not in diff_action(diff1):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
230	            if self.mapping_text_diffs:
231	                log.write("="*20, "text difference", repr(old), "vs.", repr(new), "="*20)
232	                text_difference(self.observatory, old, new)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
230	            if self.mapping_text_diffs:
231	                log.write("="*20, "text difference", repr(old), "vs.", repr(new), "="*20)
232	                text_difference(self.observatory, old, new)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
232	                text_difference(self.observatory, old, new)
233	                log.write("="*80)
234	            if self.check_references:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
232	                text_difference(self.observatory, old, new)
233	                log.write("="*80)
234	            if self.check_references:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
412	            source_pp = pprint.pformat(utils.fix_json_strings(source_json))
413	            temp_file.write(source_pp)
414	        self.remove_files += [temp_file.name]

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/diff.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
412	            source_pp = pprint.pformat(utils.fix_json_strings(source_json))
413	            temp_file.write(source_pp)
414	        self.remove_files += [temp_file.name]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/io/factory.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	    with open(filepath, "rb") as handle:
103	        first_5 = str(handle.read(5).decode('utf-8'))
104	        if first_5 == "#ASDF":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/io/factory.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
106	        elif first_5 == "SIMPL":
107	            first_81 = first_5 + handle.read(76).decode('utf-8')
108	            if first_81[-1] == '\n':

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/io/factory.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
108	            if first_81[-1] == '\n':
109	                all_chars = first_81 + handle.read().decode('utf-8')
110	                lines = all_chars.splitlines()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/io/fits.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        s.seek(0)
81	        info_string = "\n".join(s.read().splitlines()[1:])
82	        return info_string

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/io/tables.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	        else:
66	            tab = table.Table.read(filename)
67	            self.colnames = tuple(name.upper() for name in tab.columns)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/jwst/gen_system_crdscfg.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
203	    with open(sys.argv[1]) as infile:
204	        print(CrdsCfgGenerator(infile.read()))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/list.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	
35	    epilog = """
36	General categories of information driven by switches include:
37	
38	0. Overall CRDS configuration
39	1. CRDS server file lists
40	2. CRDS cache file lists and paths
41	3. Cached file contents or headers
42	4. CRDS reprocessing dataset ids and parameters
43	5. Listing global default and installed pipeline contexts
44	6. Resolving context specifiers into literal context names
45	
46	Many crds list services require setting CRDS_SERVER_URL to a valid CRDS
47	server to provide a source for the headers.
48	
49	For HST::
50	
51	% export CRDS_SERVER_URL=https://hst-crds.stsci.edu
52	
53	or for JWST::
54	
55	% export CRDS_SERVER_URL=https://jwst-crds.stsci.edu
56	
57	0. Configuration information governing the behavior of CRDS for simple
58	configurations can be dumped::
59	
60	crds list --status
61	CRDS Version = '7.0.7, bump-version, 7432326'
62	CRDS_MODE = 'auto'
63	CRDS_PATH = '/Users/jmiller/crds_cache_ops'
64	CRDS_SERVER_URL = 'https://jwst-crds.stsci.edu'
65	Effective Context = 'jwst_0204.pmap'
66	Last Synced = '2016-09-20 08:00:09.115330'
67	Python Executable = '/Users/jmiller/anaconda/bin/python'
68	Python Version = '3.5.2.final.0'
69	Readonly Cache = False
70	
71	More comprehensive configuration information is also available for advanced
72	configurations::
73	
74	% crds list --config
75	... lots of info ....
76	
77	1. Files known by the CRDS server to belong to specified contexts can be listed
78	even if the files are not installed in a local CRDS Cache.
79	
80	The --mappings command recursively evaluates and includes all the sub-mappings,
81	i.e. imaps and pmaps, of the specified contexts.
82	
83	Contexts to list can be specified in a variety of ways:
84	
85	-- To list the references contained by several contexts::
86	
87	% crds list  --references --contexts hst_0001.pmap hst_0002.pmap ...
88	vb41935ij_bia.fits
89	vb41935kj_bia.fits
90	...
91	
92	-- To list the references in a numerical range of contexts::
93	
94	% crds list --references --range 1:2 --references
95	vb41935lj_bia.fits
96	vb41935oj_bia.fits
97	...
98	
99	-- To list all mappings, even those not referenced by an imap or pmap::
100	
101	% crds list --mappings --all
102	hst.pmap
103	hst_0001.pmap
104	hst_0002.pmap
105	hst_acs.imap
106	hst_acs_0001.imap
107	hst_acs_0002.imap
108	hst_acs_atodtab.rmap
109	...
110	
111	--references, --mappings, or both can be listed.
112	
113	2. Locally cached files (files already synced to your computer) can be listed::
114	
115	% crds list --cached-mappings --full-path
116	...
117	
118	% crds list --cached-references --full-path
119	...
120	
121	In both cases adding --full-path prints the path of the file within the CRDS cache.
122	
123	These are merely simple directory listings which ignore the context specifiers
124	and can be grep'ed for finer grained answers.
125	
126	3. The contents of cached mappings or references (header only) can be printed to stdout like this::
127	
128	% crds list --contexts jwst-fgs-linearity-edit jwst-nirspec-linearity-edit --cat --add-filename | grep parkey
129	CRDS - INFO - Symbolic context 'jwst-fgs-linearity-edit' resolves to 'jwst_fgs_linearity_0008.rmap'
130	CRDS - INFO - Symbolic context 'jwst-nirspec-linearity-edit' resolves to 'jwst_nirspec_linearity_0009.rmap'
131	/cache/path/mappings/jwst/jwst_fgs_linearity_0008.rmap:     'parkey' : (('META.INSTRUMENT.DETECTOR', 'META.SUBARRAY.NAME'), ('META.OBSERVATION.DATE', 'META.OBSERVATION.TIME')),
132	/cache/path/mappings/jwst/jwst_nirspec_linearity_0009.rmap:     'parkey' : (('META.INSTRUMENT.DETECTOR', 'META.SUBARRAY.NAME'), ('META.OBSERVATION.DATE', 'META.OBSERVATION.TIME')),
133	
134	this prints the contents of the specified rmaps.
135	
136	The -edit specifier above refers to mappings contained by the default starting point (.pmap) of future
137	server submissions.  It tracks on-going submission work that precedes the adoption of a new context
138	as the default in use by the pipeline.
139	
140	crds.list --cat can be applied to references and prints out the reference metadata that CRDS views
141	abstractly as the file header.
142	
143	References need to be catted explicitly by name,  but the list can come from the --references command
144	explained above::
145	
146	% crds list --cat jwst_nirspec_dark_0036.fits
147	CRDS - INFO - Symbolic context 'jwst-operational' resolves to 'jwst_0167.pmap'
148	##########################################################################################
149	File:  '/grp/crds/jwst/references/jwst/jwst_nirspec_dark_0036.fits'
150	##########################################################################################
151	{'A1_COL_C': '8.9600000e+002',
152	'A1_CONF1': '2.1846000e+004',
153	...
154	}
155	
156	4. Information about the dataset IDs and parameters used for CRDS reprocessing
157	and regressions can be printed or stored.
158	
159	 Parameter set IDs can be listed for one or more instruments as follows::
160	
161	 % crds list --dataset-ids-for-instruments wfc3...
162	 JCL403010:JCL403ECQ
163	 ... hundreds to hundreds of thousands of IDs as shown above ...
164	
165	 IDs can also be captured to a file using UNIX I/O redirection::
166	
167	 % crds list --dataset-ids-for-instruments wfc3   >wfc3.ids
168	
169	 IDs for HST are of the form <product>:<exposure> where many exposures feed into
170	 the construction of one product and recalibrating any component exposure suggests
171	 recalibrating the combined product.
172	
173	 CRDS stores dataset parameters for regression testing as a JSON dictionaries
174	 specifying one set of dataset parameters per line of the file::
175	
176	 % crds list --dataset-headers @wfc3.ids --json > wfc3.headers.json
177	
178	 NOTE:  while IDs can be specified directly on the command line,  CRDS has an
179	 @-notation that means "take IDs from this file".
180	
181	 The JSON headers are suitable for running through crds.bestrefs to perform
182	 reprocessing checks or single context reference file coverage checks shown  here::
183	
184	 % crds bestrefs --load-pickle wfc3.headers.json --dump-unique-errors --stats
185	 ...  errors related to looking up references for these parameter sets ...
186	
187	 The script crds_dataset_capture combines the process of dumping all IDs for an
188	 instrument and dumping their corresponding dataset parameters.  IDs files and
189	 header files are placed in a dated regression capture directory::
190	
191	 % crds_dataset_capture wfc3 acs ...
192	 ... downloads IDs and headers for WFC3, ACS to dated directory ...
193	
194	 The default multi-line format for dataset parameters is more readable than the
195	 --json form::
196	
197	 % crds list --dataset-headers jcl403010 --first-id --minimize-header
198	 CRDS - INFO - Symbolic context 'hst-operational' resolves to 'hst_0462.pmap'
199	 CRDS - INFO - Dataset pars for 'JCL403010:JCL403ECQ' with respect to 'hst_0462.pmap'
200	 {'APERTURE': 'WFC1',
201	  'ATODCORR': 'OMIT',
202	  'BIASCORR': 'COMPLETE',
203	  'CCDAMP': 'ABCD',
204	  'CCDCHIP': '-999.0',
205	  'CCDGAIN': '2.0',
206	  'CRCORR': 'OMIT',
207	  'DARKCORR': 'COMPLETE',
208	  'DATE-OBS': '2016-02-20',
209	  'DETECTOR': 'WFC',
210	  'DQICORR': 'COMPLETE',
211	  'DRIZCORR': 'COMPLETE',
212	  'FILTER1': 'CLEAR1L',
213	  'FILTER2': 'F814W',
214	  'FLASHCUR': 'LOW',
215	  'FLATCORR': 'COMPLETE',
216	  'FLSHCORR': 'OMIT',
217	  'FW1OFFST': '0.0',
218	  'FW2OFFST': '0.0',
219	  'FWSOFFST': '0.0',
220	  'GLINCORR': 'UNDEFINED',
221	  'INSTRUME': 'ACS',
222	  'LTV1': '0.0',
223	  'LTV2': '0.0',
224	  'NAXIS1': '4144.0',
225	  'NAXIS2': '4136.0',
226	  'OBSTYPE': 'IMAGING',
227	  'PCTECORR': 'UNDEFINED',
228	  'PHOTCORR': 'COMPLETE',
229	  'RPTCORR': 'UNDEFINED',
230	  'SHADCORR': 'OMIT',
231	  'SHUTRPOS': 'A',
232	  'TIME-OBS': '17:32:29.666665',
233	  'XCORNER': '0.0',
234	  'YCORNER': '0.0',
235	  'dataset_id': 'JCL403010:JCL403ECQ'}
236	
237	 Sometimes it's desirable to know the individual exposures CRDS associates with a product id::
238	
239	 % crds list --dataset-headers jcl403010 --id-expansions-only
240	 CRDS - INFO - Symbolic context 'hst-operational' resolves to 'hst_0462.pmap'
241	 JCL403010:JCL403ECQ
242	 JCL403010:JCL403EEQ
243	 JCL403010:JCL403EGQ
244	 JCL403010:JCL403EIQ
245	 JCL403010:JCL403EKQ
246	 JCL403010:JCL403EMQ
247	 JCL403010:JCL403EOQ
248	 JCL403010:JCL403EQQ
249	 JCL403010:JCL403ESQ
250	 JCL403010:JCL403EUQ
251	
252	5. Information about the default context can be printed.  There are two variations and a subtle distinction::
253	
254	% python m crds.list --operational-context
255	jwst_0204.pmap
256	
257	lists the context which has been *commanded* as default on the CRDS server.
258	
259	While::
260	
261	% crds list --remote-context jwst-ops-pipeline
262	jwst_0101.pmap
263	
264	lists the context which is *in actual use* in the associated archive pipeline as reported by
265	a cache sync echo.
266	
267	During the interval between commanding a new default on the CRDS server and syncing the pipeline
268	CRDS cache,  the commanded and actual pipeline contexts can differ.
269	
270	6. Resolving context specifiers
271	
272	Some CRDS tools, including crds.list and crds.sync, support multiple
273	mechanisms for specifying context.  The --resolve-contexts command
274	interprets those specifiers into a non-recursive list of literal mapping
275	names and prints them out.  --resolve-contexts differs from --mappings
276	because it does not implicitly include all sub-mappings of the specified
277	contexts::
278	
279	% crds list --resolve-contexts --all
280	jwst.pmap
281	jwst_0000.pmap
282	jwst_0001.pmap
283	jwst_0002.pmap
284	jwst_0003.pmap
285	...
286	
287	% crds list --resolve-contexts --last 5
288	jwst_0205.pmap
289	jwst_0206.pmap
290	jwst_0207.pmap
291	jwst_0208.pmap
292	jwst_0209.pmap
293	
294	% crds list --resolve-contexts  --contexts jwst-miri-dark-operational
295	jwst_miri_dark_0012.rmap
296	
297	% crds list --resolve-contexts --contexts jwst-niriss-superbias-2016-01-01T00:00:00
298	jwst_niriss_superbias_0005.rmap
299	    """
300	    def __init__(self, *args, **keys):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/matches.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
304	                for match in matches:
305	                    log.write(ctx, ref, ":", match)
306	            else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/misc/check_archive.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	
22	    epilog = """
23	Checking out the archive with respect to CRDS file availability
24	and setting up a pipeline cache might have a few stages:
25	
26	1. Run crds.list to generate a list of files to check, for example for
27	all contexts, do this:
28	
29	    % setenv CRDS_SERVER_URL https://jwst-crds.stsci.edu
30	    % setenv CRDS_PATH $HOME/crds_cache_ops
31	    % crds list --all --mappings --references >files.b6
32	
33	This captures the file list with respect to the CRDS OPS server which
34	during the development period directly distributes files and is a
35	complete "reference" copy.
36	
37	2. Run crds.misc.check_archive to query the archive server with HTTP HEAD for each of the files:
38	
39	    % setenv CRDS_SERVER_URL https://jwst-crds-b6it.stsci.edu
40	    % setenv CRDS_PATH $HOME/crds_cache_b6it
41	    crds check_archive --files @files.b6 --dump-good-files --stats > all.b6it.archive
42	
43	This checks the file list in files.b6 against the CRDS B6 server
44	database and whatever archive URL that server is configured to use,
45	nominally the B6 archive server.
46	
47	crds.misc.check_archive currently checks each file for availability and
48	correct length with respect to the CRDS catalog.  A status line for
49	each bad file, or all files, is printed to standard out, in this case
50	captured to output file all.b6.archive.  e.g. status like:
51	
52	    jwst_nirspec_superbias_0001.rmap 15a45e1ef114b1d5dc2017fd847830fd3c3eaac6 518 ok
53	    jwst_nirspec_superbias_0002.rmap 07c94beb372396253dd42c2ff4f2c54ac678d55c 596 ok
54	    jwst_nirspec_superbias_0003.rmap a031720e6ffeec9d730ec0051a6cea1215e7054f 666 ok
55	
56	ERROR messages for each problem (missing or length) are printed to stderr
57	
58	3. Once the archive is looking good,  sync all the CRDS rules to a local cache:
59	
60	    % crds sync --all --stats --check-sha1sum
61	
62	which will verify rules download, loadability, and exact contents with respect to
63	the CRDS server database.
64	
65	4. Once all of these trial runs are completed,  the appropriate archive pipeline
66	is probably ready to run the cron_sync script to initialize their CRDS cache from
67	the archive and appropriate CRDS server.
68	    """
69	
70	    def __init__(self, *args, **keys):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/misc/get_synphot.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
283	        with log.verbose_warning_on_exception("Failed removing", repr(path)):
284	            shutil.rmtree(path)
285	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/misc/query_affected.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	    description = """
10	query_affected_datasets (QAD) queries the CRDS server for datasets affected by the specified
11	CONTEXT(s), history INDICES, or DATES.  QAD relies on pre-computed results on the server,
12	so QAD queries are only valid for historical context transitions from the context history.
13	When no history interval is specified,  QAD uses the last processed context as the starting
14	point,  and the end of the current history as the stopping point.
15	
16	Before going too far, a couple of points are in order:
17	
18	    1. QueryAffectedDatasetsScript is intended to be sub-classed.   By default it just prints dataset
19	    IDs on STDOUT as well as log and affected datasets computation output to STDERR.   Override the
20	    use_affected() and use_all_ids() methods to do something custom with the affected dataset IDs,
21	    either switch-by-switch, or potentially multiple contexts at once, respectively.   Override the
22	    log_affected() or log_all_ids() methods to customize most logging.   QAD provides basic interaction
23	    with the context history, affected datasets service, recording state, and error handling.
24	
25	    2. crds.bestrefs can be used to compute the datasets affected by arbitrary context transitions
26	    when run locally.   The computation can require minutes to hours depending on number of instruments,
27	    types, datasets, and tables potentially affected.    For this, the --affected-datasets switch
28	    configures crds.bestrefs to perform an affected datasets computation using the bundle of standard
29	    options run on the CRDS servers.
30	
31	Due to processing order on the server, new contexts appear in the context history as operational
32	before the datasets affected have been computed.   This framework helps resolve that race condition
33	and provides options for handling affected datasets computations which contained errors.
34	
35	To support interactive experimentation, QAD supports listing the context history:
36	
37	    % query_affected_datasets --list
38	    (0, '2013-07-02 15:44:53', 'hst.pmap', 'set by system')
39	    (1, '2013-09-10 18:23:06', 'hst_0003.pmap', 'Updated hst.pmap with new references (known to reffile_ops_rep on harpo) up to 09-10-2013')
40	    ...
41	    (85, '2014-09-23 16:48:17', 'hst_0287.pmap', 'Delivery of new WFC3 darks.')
42	    (86, '2014-10-13 11:26:40', 'hst_0288.pmap', 'Delivery of a new ACS WFC1-1K bias.')
43	    (87, '2014-10-14 09:34:29', 'hst_0289.pmap', 'Delivery of a new COS FUV BPIXTAB.')
44	
45	See also the -x and -y parameters below for customizing interactive query ranges.
46	
47	With no history range specified, QAD selects the last history item processed as the starting point
48	and the end of the current history as the stopping point.  Normally there's nothing new to report,
49	the last thing processed was the end of the history and nothing has changed on the server.
50	
51	    % query_affected_datasets
52	    CRDS - INFO - No new results available.
53	    CRDS - INFO - 0 errors
54	    CRDS - INFO - 0 warnings
55	    CRDS - INFO - 1 infos
56	
57	Following a context change,  by default QAD will notice a difference between the last saved context
58	and the new last context in the history.  QAD is designed to be sub-classed but by default prints log
59	information and recorded affected datasets output to STDERR.   It prints affected dataset IDs to STDOUT.
60	Run periodically,  QAD will typically see at most a single context switch.
61	
62	    % query_affected_datasets > ids
63	    CRDS - INFO - Fetching effects for (96, '2014-11-25 15:48:40', 'hst_0300.pmap', 'Delivery of a new COS HVTAB for association LCIX02080.')
64	    ####################################################################################################
65	    --------------------------------------------------------------------------------------------------------------
66	    CRDS hst ops datasets affected hst_0299.pmap --> hst_0300.pmap on 2014-11-25-15:50:09
67	    --------------------------------------------------------------------------------------------------------------
68	    CRDS - INFO - [2014-11-25 15:50:12,563]  Mapping differences from 'hst_0299.pmap' --> 'hst_0300.pmap' affect:
69	     {'cos': ['hvtab']}
70	    CRDS - INFO - [2014-11-25 15:50:12,731]  Possibly affected --datasets-since dates determined by 'hst_0299.pmap' --> 'hst_0300.pmap' are:
71	     {'cos': '2009-05-11 00:00:00'}
72	    CRDS - INFO - [2014-11-25 15:50:12,731]  Computing bestrefs for db datasets for ['cos']
73	    CRDS - INFO - [2014-11-25 15:50:12,731]  Dumping dataset parameters for 'cos' from CRDS server at 'https://hst-crds.stsci.edu' since '2009-05-11 00:00:00'
74	    CRDS - INFO - [2014-11-25 15:50:16,457]  Downloaded  19592 dataset ids for 'cos' since '2009-05-11 00:00:00'
75	    CRDS - INFO - [2014-11-25 15:51:16,293]  Updated exposure counts:
76	     {'COS': {'hvtab': 13696}}
77	    CRDS - INFO - [2014-11-25 15:51:16,309]  Affected products = 9494
78	    CRDS - INFO - [2014-11-25 15:51:16,319]  Unique error types: 0
79	    CRDS - INFO - [2014-11-25 15:51:16,319]  STARTED 2014-11-25 15:50:10.67
80	    CRDS - INFO - [2014-11-25 15:51:16,319]  STOPPED 2014-11-25 15:51:16.31
81	    CRDS - INFO - [2014-11-25 15:51:16,319]  ELAPSED 0:01:05.64
82	    CRDS - INFO - [2014-11-25 15:51:16,319]  19.59 K datasets at 298.47  datasets-per-second
83	    CRDS - INFO - [2014-11-25 15:51:16,319]  0 errors
84	    CRDS - INFO - [2014-11-25 15:51:16,319]  0 warnings
85	    CRDS - INFO - [2014-11-25 15:51:16,319]  12 infos
86	    --------------------------------------------------------------------------------------------------------------
87	    OK: CRDS hst ops datasets affected hst_0299.pmap --> hst_0300.pmap on 2014-11-25-15:50:09 : 9494 affected
88	    --------------------------------------------------------------------------------------------------------------
89	    ####################################################################################################
90	    CRDS - INFO - Contributing context switches = 1
91	    CRDS - INFO - Total products affected = 9494
92	    CRDS - INFO - 0 errors
93	    CRDS - INFO - 0 warnings
94	    CRDS - INFO - 3 infos
95	
96	    % cat ids
97	    i9zf01010
98	    i9zf02010
99	    i9zf03010
100	    i9zf04010
101	    i9zf05010
102	    ...
103	
104	STDERR output from multiple context switches is delimited by ########## lines.
105	
106	For the sake of custom queries,  QAD supports --starting-context (-x) and --stopping-context (-y) parameters to define the
107	history starting and stopping points.  -x and -y can be specified as CONTEXTS, HISTORY INDICES, or DATES.
108	
109	    % query_affected_datasets -x 92 -y 94 > ids
110	    CRDS - INFO - Fetching effects for (92, '2014-11-05 13:53:15', 'hst_0296.pmap', 'Delivery of new ACS bias, dark, and cte_corrected dark reference files.')
111	    CRDS - INFO - Fetching effects for (93, '2014-11-10 13:11:02', 'hst_0297.pmap', 'The WFC3 Team delivered 3 new dark reference files.')
112	    ####################################################################################################
113	    --------------------------------------------------------------------------------------------------------------
114	    CRDS hst ops datasets affected hst_0295.pmap --> hst_0296.pmap on 2014-11-05-13:55:08
115	    --------------------------------------------------------------------------------------------------------------
116	    CRDS - INFO - [2014-11-05 13:55:12,922]  Mapping differences from 'hst_0295.pmap' --> 'hst_0296.pmap' affect:
117	     {'acs': ['biasfile', 'drkcfile', 'darkfile']}
118	    CRDS - INFO - [2014-11-05 13:55:13,576]  Possibly affected --datasets-since dates determined by 'hst_0295.pmap' --> 'hst_0296.pmap' are:
119	     {'acs': '2014-08-26 09:55:53'}
120	    CRDS - INFO - [2014-11-05 13:55:13,576]  Computing bestrefs for db datasets for ['acs']
121	    CRDS - INFO - [2014-11-05 13:55:13,576]  Dumping dataset parameters for 'acs' from CRDS server at 'https://hst-crds.stsci.edu' since '2014-08-26 09:55:53'
122	    CRDS - INFO - [2014-11-05 13:55:39,323]  Downloaded  1431 dataset ids for 'acs' since '2014-08-26 09:55:53'
123	    CRDS - INFO - [2014-11-05 13:55:52,999]  Updated exposure counts:
124	     {'ACS': {'biasfile': 1374, 'darkfile': 1386, 'drkcfile': 1386}}
125	    CRDS - INFO - [2014-11-05 13:55:53,001]  Affected products = 670
126	    CRDS - INFO - [2014-11-05 13:55:53,001]  Unique error types: 0
127	    CRDS - INFO - [2014-11-05 13:55:53,001]  STARTED 2014-11-05 13:55:10.62
128	    CRDS - INFO - [2014-11-05 13:55:53,002]  STOPPED 2014-11-05 13:55:53.00
129	    CRDS - INFO - [2014-11-05 13:55:53,002]  ELAPSED 0:00:42.37
130	    CRDS - INFO - [2014-11-05 13:55:53,002]  1.43 K datasets at 33.77  datasets-per-second
131	    CRDS - INFO - [2014-11-05 13:55:53,002]  0 errors
132	    CRDS - INFO - [2014-11-05 13:55:53,002]  0 warnings
133	    CRDS - INFO - [2014-11-05 13:55:53,002]  12 infos
134	    --------------------------------------------------------------------------------------------------------------
135	    OK: CRDS hst ops datasets affected hst_0295.pmap --> hst_0296.pmap on 2014-11-05-13:55:08 : 670 affected
136	    --------------------------------------------------------------------------------------------------------------
137	    ####################################################################################################
138	    --------------------------------------------------------------------------------------------------------------
139	    CRDS hst ops datasets affected hst_0296.pmap --> hst_0297.pmap on 2014-11-10-13:15:07
140	    --------------------------------------------------------------------------------------------------------------
141	    CRDS - INFO - [2014-11-10 13:15:10,393]  Mapping differences from 'hst_0296.pmap' --> 'hst_0297.pmap' affect:
142	     {'wfc3': ['darkfile']}
143	    CRDS - INFO - [2014-11-10 13:15:10,574]  Possibly affected --datasets-since dates determined by 'hst_0296.pmap' --> 'hst_0297.pmap' are:
144	     {'wfc3': '2014-10-27 00:30:40'}
145	    CRDS - INFO - [2014-11-10 13:15:10,574]  Computing bestrefs for db datasets for ['wfc3']
146	    CRDS - INFO - [2014-11-10 13:15:10,574]  Dumping dataset parameters for 'wfc3' from CRDS server at 'https://hst-crds.stsci.edu' since '2014-10-27 00:30:40'
147	    CRDS - INFO - [2014-11-10 13:15:33,868]  Downloaded  714 dataset ids for 'wfc3' since '2014-10-27 00:30:40'
148	    CRDS - INFO - [2014-11-10 13:15:43,290]  Updated exposure counts:
149	     {'WFC3': {'darkfile': 369}}
150	    CRDS - INFO - [2014-11-10 13:15:43,291]  Affected products = 292
151	    CRDS - INFO - [2014-11-10 13:15:43,291]  Unique error types: 0
152	    CRDS - INFO - [2014-11-10 13:15:43,291]  STARTED 2014-11-10 13:15:08.58
153	    CRDS - INFO - [2014-11-10 13:15:43,291]  STOPPED 2014-11-10 13:15:43.29
154	    CRDS - INFO - [2014-11-10 13:15:43,291]  ELAPSED 0:00:34.70
155	    CRDS - INFO - [2014-11-10 13:15:43,291]  714 datasets at 20.57  datasets-per-second
156	    CRDS - INFO - [2014-11-10 13:15:43,292]  0 errors
157	    CRDS - INFO - [2014-11-10 13:15:43,292]  0 warnings
158	    CRDS - INFO - [2014-11-10 13:15:43,292]  12 infos
159	    --------------------------------------------------------------------------------------------------------------
160	    OK: CRDS hst ops datasets affected hst_0296.pmap --> hst_0297.pmap on 2014-11-10-13:15:07 : 292 affected
161	    --------------------------------------------------------------------------------------------------------------
162	    ####################################################################################################
163	    CRDS - INFO - Contributing context switches = 2
164	    CRDS - INFO - Total products affected = 962
165	    CRDS - INFO - 0 errors
166	    CRDS - INFO - 0 warnings
167	    CRDS - INFO - 4 infos
168	
169	QAD is designed to be run perdiodically,  say every 30 minutes,  to check with the CRDS server for
170	context updates.  If multiple context switches occur during one polling interval,  by default QAD
171	includes IDs from all of them.   This is also true of interactive queries using -x and/or -y,  so
172	it's possible to combine affected datasets from multiple switches when repeated IDs are expected.
173	
174	QAD also supports a --single-context-switch (-s) mode for printing results 1-by-1 in the advent of
175	multiple context switches in on polling interval.
176	
177	Since there is a race condition between when a context is made operational and when affected datasets results
178	are available on the CRDS server,  QAD also supports a -i switch for ignoring unavailable results.  Alternately
179	missing results are considered an error,  the main difference being the exit status.
180	
181	For initialzing,  specify -i to ignore any missing computations since QAD will attempt to process the
182	entire history the first time it is run and precomputed results don't exist for all historical context
183	switches.
184	
185	It's possible for precomputed results to contain bestrefs errors of some sort,  most likely due to invalid
186	bestrefs selection parametersin the HST DADSOPS catalog.   By default the datasets from a computation which
187	contained errors are excluded from the overall results.   Use -k to include the dataset IDs from computations
188	which included errors.
189	
190	Conversely, to abort processing when an affected datasets computation included errors,  use -z to fail
191	and quit.
192	
193	The --quiet (-q) parameter suppresses the recorded log output from the affected datasets computations:
194	
195	    % query_affected_datasets -x 94 -y 97 -q > ids
196	    CRDS - INFO - Fetching effects for (94, '2014-11-18 17:15:35', 'hst_0298.pmap', 'Delivery of new ACS DKC, DRK, and BIA files.')
197	    CRDS - INFO - Fetching effects for (95, '2014-11-20 16:12:34', 'hst_0299.pmap', 'Delivery of new WFC3 UVIS darks.')
198	    CRDS - INFO - Fetching effects for (96, '2014-11-25 15:48:40', 'hst_0300.pmap', 'Delivery of a new COS HVTAB for association LCIX02080.')
199	    CRDS - INFO - Contributing context switches = 3
200	    CRDS - INFO - Total products affected = 10356
201	    CRDS - INFO - 0 errors
202	    CRDS - INFO - 0 warnings
203	    CRDS - INFO - 5 infos
204	
205	NOTE:  CRDS logging is used in both query_affected_datasets and the original server-side affected datasets computations.  The
206	final errors count shown above only applies to the client-side computing in query_affected_datasets,  so server-side errors are
207	not *counted*.   However,  server-side errors are tracked and reduced to a single client-side error for each server-side
208	bestrefs run with errors.
209	
210	The --verbose parameter includes debug output in excess of normal application logging,  possibly useful
211	for debugging subclasses of the QueryAffectedDatasetsScript skeletal framework.
212	
213	"""
214	    def add_args(self):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/misc/query_affected.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
457	        with open(self.last_processed_path, "w+") as last:
458	            last.write(str(hist))
459	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/misc/synphot/integration_tests.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
185	            if self.processes > 1:
186	                with Pool(processes=self.processes) as pool:
187	                    for start_index in range(0, total_modes, self.batch_size):

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/misc/synphot/integration_tests.py:186
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
185	            if self.processes > 1:
186	                with Pool(processes=self.processes) as pool:
187	                    for start_index in range(0, total_modes, self.batch_size):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/misc/uniqname.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	            else:
100	                self.rewrite(filename, uniqname)
101	                if self.args.remove_original:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/newcontext.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	    key, replaced = loaded.set_item(key, os.path.basename(replacement))
93	    loaded.write(where)
94	    return key, replaced, replacement

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
29	    mapping.header[key] = new_value
30	    mapping.write(new_rmap)
31	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	    del mapping.header[key]
39	    mapping.write(new_rmap)
40	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	    new.header["name"] = str(os.path.basename(new_path))
52	    new.write(new_path)
53	    return str(derived_from)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
125	    log.verbose("Writing", repr(new_rmap))
126	    new.write(new_rmap)
127	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
140	    log.verbose("Writing", repr(new_rmap))
141	    new.write(new_rmap)
142	    formatted = new.format()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
33	    new.header["name"] = str(os.path.basename(new_path))
34	    new.write(new_path)
35	    return str(derived_from)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	            log.verbose("Writing", srepr(new_rmap))
54	            new.write(new_rmap)
55	    formatted = new.format()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	    log.verbose("Writing", srepr(new_rmap))
79	    new.write(new_rmap)
80	    formatted = new.format()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
103	    log.verbose("Writing", srepr(new_rmap))
104	    new.write(new_rmap)
105	    formatted = new.format()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	        rmapping.header[header_key] = header_value
156	    rmapping.write(new_filename)
157	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
164	    del rmapping.header[header_key]
165	    rmapping.write(new_filename)
166	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
177	    rmapping.selector.delete_match_param(parameter)
178	    rmapping.write(new_filename)
179	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
201	    rmapping.header["parkey"] = pktuple
202	    rmapping.write(new_filename)
203	    rmapping = rmap.load_mapping(new_filename)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
231	    new_mapping.header["substitutions"][parameter_name] = { old_text : new_text }
232	    new_mapping.write(new_filename)
233	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/refactoring/refactor2.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
243	        log.info("-"*80)
244	        log.write(str(rmapping))
245	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    'bit': {
24	        'hst':  'https://hst-crds-bit.stsci.edu/',
25	        'jwst': 'https://jwst-crds-bit.stsci.edu/',
26	    },
27	    'cit': {
28	        'hst':  'https://hst-crds-cit.stsci.edu/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        'hst':  'https://hst-crds-bit.stsci.edu/',
25	        'jwst': 'https://jwst-crds-bit.stsci.edu/',
26	    },
27	    'cit': {
28	        'hst':  'https://hst-crds-cit.stsci.edu/',
29	        'jwst': 'https://jwst-crds-cit.stsci.edu/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    'cit': {
28	        'hst':  'https://hst-crds-cit.stsci.edu/',
29	        'jwst': 'https://jwst-crds-cit.stsci.edu/',
30	    },
31	    'dev': {
32	        'hst':  'https://hst-crds-dev.stsci.edu/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	        'hst':  'https://hst-crds-cit.stsci.edu/',
29	        'jwst': 'https://jwst-crds-cit.stsci.edu/',
30	    },
31	    'dev': {
32	        'hst':  'https://hst-crds-dev.stsci.edu/',
33	        'jwst': 'https://jwst-crds-dev.stsci.edu/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    'dev': {
32	        'hst':  'https://hst-crds-dev.stsci.edu/',
33	        'jwst': 'https://jwst-crds-dev.stsci.edu/',
34	        'roman': 'https://roman-crds-dev.stsci.edu/',
35	    },
36	    'int': {
37	        'roman': 'https://roman-crds-int.stsci.edu/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	        'hst':  'https://hst-crds-dev.stsci.edu/',
33	        'jwst': 'https://jwst-crds-dev.stsci.edu/',
34	        'roman': 'https://roman-crds-dev.stsci.edu/',
35	    },
36	    'int': {
37	        'roman': 'https://roman-crds-int.stsci.edu/',
38	    },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	        'jwst': 'https://jwst-crds-dev.stsci.edu/',
34	        'roman': 'https://roman-crds-dev.stsci.edu/',
35	    },
36	    'int': {
37	        'roman': 'https://roman-crds-int.stsci.edu/',
38	    },
39	    'ops': {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    'int': {
37	        'roman': 'https://roman-crds-int.stsci.edu/',
38	    },
39	    'ops': {
40	        'hst':  'https://hst-crds.stsci.edu/',   # 'ops' not in URL

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    'ops': {
40	        'hst':  'https://hst-crds.stsci.edu/',   # 'ops' not in URL
41	        'jwst': 'https://jwst-crds.stsci.edu/',
42	        'roman': 'https://roman-crds.stsci.edu/',
43	    },
44	    'test': {
45	        'hst':  'https://hst-crds-test.stsci.edu/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        'hst':  'https://hst-crds.stsci.edu/',   # 'ops' not in URL
41	        'jwst': 'https://jwst-crds.stsci.edu/',
42	        'roman': 'https://roman-crds.stsci.edu/',
43	    },
44	    'test': {
45	        'hst':  'https://hst-crds-test.stsci.edu/',
46	        'jwst': 'https://jwst-crds-test.stsci.edu/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	        'jwst': 'https://jwst-crds.stsci.edu/',
42	        'roman': 'https://roman-crds.stsci.edu/',
43	    },
44	    'test': {
45	        'hst':  'https://hst-crds-test.stsci.edu/',
46	        'jwst': 'https://jwst-crds-test.stsci.edu/',
47	        'roman': 'https://roman-crds-test.stsci.edu/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    'test': {
45	        'hst':  'https://hst-crds-test.stsci.edu/',
46	        'jwst': 'https://jwst-crds-test.stsci.edu/',
47	        'roman': 'https://roman-crds-test.stsci.edu/',
48	    },
49	    'tvac': {
50	        'roman': 'https://roman-crds-tvac.stsci.edu/',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        'hst':  'https://hst-crds-test.stsci.edu/',
46	        'jwst': 'https://jwst-crds-test.stsci.edu/',
47	        'roman': 'https://roman-crds-test.stsci.edu/',
48	    },
49	    'tvac': {
50	        'roman': 'https://roman-crds-tvac.stsci.edu/',
51	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        'jwst': 'https://jwst-crds-test.stsci.edu/',
47	        'roman': 'https://roman-crds-test.stsci.edu/',
48	    },
49	    'tvac': {
50	        'roman': 'https://roman-crds-tvac.stsci.edu/',
51	    }
52	}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    'tvac': {
50	        'roman': 'https://roman-crds-tvac.stsci.edu/',
51	    }
52	}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	        with open(self.args.redcat_parameters) as f:
112	            text = f.read()
113	            log.verbose("Raw YAML read:\n", text, verbosity=75)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/rc_submit.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
153	        try:
154	            with urllib.request.urlopen(url) as req:
155	                self._form_description = yaml.safe_load(req)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	        log_section("GET:", url, divider_name="GET: " + url.split("&")[0])
83	        return self.session.get(url)
84	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
95	        log_section("POST:", vars, divider_name="POST: " + url)
96	        return self.session.post(url, data=vars)
97	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	        """
112	        response = self.get(relative_url)
113	        csrf = response.cookies['csrftoken']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	        results_id = relative_url.split('/')[-1]
121	        resp = self.get(relative_url)
122	        csrf = resp.cookies['csrftoken']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
123	        url = self.abs_url('/submit_confirm_pipeline/')
124	        response = self.session.post(url, {
125	            'results_id': results_id,
126	            'csrfmiddlewaretoken': csrf,
127	            'button': action,
128	            })

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
138	        """Issue a warning if self.locked_instrument is already locked."""
139	        response = self.get("/lock_status/"+self.username+"/")
140	        log.verbose("lock_status:", response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
148	        self.session.cookies["ASB-AUTH"] = self.password
149	        response = self.repost(
150	            "/login/",
151	            username = self.username,
152	            password = self.password,
153	            instrument = self.locked_instrument,
154	            next = next,
155	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	        """Login to the CRDS website and proceed to relative url `next`."""
206	        self.get("/logout/")
207	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	        abs_url = self.abs_url("/upload/chunked/")
210	        response = self.session.get(abs_url)
211	        log.verbose("COOKIES:", log.PP(response.cookies))

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
218	            data = {"csrfmiddlewaretoken": csrf_token}
219	            self.session.post(abs_url, files=files, data=data)
220	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
223	                while True:
224	                    chunk = f.read(_UPLOAD_CHUNK_SIZE)
225	                    if len(chunk) == 0:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/submit/web.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
232	                    headers = {"Content-Range": content_range}
233	                    response = self.session.post(abs_url, files=files, data=data, headers=headers)
234	                    csrf_token = response.cookies["csrftoken"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/crds/sync.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
553	                    with open(self.args.dataset_ids[0][1:]) as pfile:
554	                        self.args.dataset_ids = pfile.read().splitlines()
555	                with log.error_on_exception("Failed to get matching parameters for", self.args.dataset_ids):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/documentation/crds_users_guide/source/conf.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
350	intersphinx_mapping = {
351	    'python': ('https://docs.python.org/3/', None),
352	    'numpy': ('https://docs.scipy.org/doc/numpy/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/documentation/crds_users_guide/source/conf.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
351	    'python': ('https://docs.python.org/3/', None),
352	    'numpy': ('https://docs.scipy.org/doc/numpy/', None),
353	    'scipy': ('https://docs.scipy.org/doc/scipy/reference/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/documentation/crds_users_guide/source/conf.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
352	    'numpy': ('https://docs.scipy.org/doc/numpy/', None),
353	    'scipy': ('https://docs.scipy.org/doc/scipy/reference/', None),
354	    'matplotlib': ('http://matplotlib.org/', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/documentation/crds_users_guide/source/conf.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
353	    'scipy': ('https://docs.scipy.org/doc/scipy/reference/', None),
354	    'matplotlib': ('http://matplotlib.org/', None),
355	    # 'jwst': ('https://jwst-pipeline.readthedocs.io/en/latest/jwst/package_index.html', None),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/setup_data.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    author_email="jmiller@stsci.edu",
33	    url="https://hst-crds.stsci.edu",
34	    license="BSD",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/bestrefs/test_bestrefs.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	        out = caplog.text
174	    out_to_check = """ (FATAL) CRDS server connection and cache load FAILED.  Cannot continue.
175	 See https://hst-crds.stsci.edu/docs/cmdline_bestrefs/ or https://jwst-crds.stsci.edu/docs/cmdline_bestrefs/
176	 for more information on configuring CRDS,  particularly CRDS_PATH and CRDS_SERVER_URL. : [Errno 2] No such file or directory: '/nowhere/config/hst/server_config'"""
177	    for msg in out_to_check.splitlines():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/bestrefs/test_bestrefs.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	    
189	    out_to_check = """ Dumping dataset parameters from CRDS server at 'https://hst-crds.stsci.edu' for ['LB6M01030']
190	 Dumped 1 of 1 datasets from CRDS server at 'https://hst-crds.stsci.edu'
191	 Computing bestrefs for datasets ['LB6M01030']
192	 No comparison context or source comparison requested.
193	 0 errors
194	 0 warnings"""
195	    for msg in out_to_check.splitlines():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/bestrefs/test_bestrefs.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
226	    
227	    odd_pattern = re.compile("Dumping dataset parameters for '[a-z0-9]{3,6}' from CRDS server at 'https://hst-crds.stsci.edu'")
228	    even_pattern = re.compile("Downloaded  [0-9]{5,6} dataset ids for '[a-z0-9]{3,6}' since None")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/bestrefs/test_bestrefs.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
266	                    "Computing bestrefs for db datasets for ['acs']",
267	                    "Dumping dataset parameters for 'acs' from CRDS server at 'https://hst-crds.stsci.edu' since '1992-01-02 00:00:00'"]
268	    pattern = re.compile("Downloaded  [0-9]{5,6} dataset ids for '[a-z0-9]{3,6}' since '1992-01-02 00:00:00'")
269	    for i, line in enumerate(out):
270	        line = line.strip()
271	        if i < 6:
272	            assert out_to_check[i] in line
273	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/bestrefs/test_bestrefs.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
335	    
336	    out_to_check = """ Dumping dataset parameters from CRDS server at 'https://hst-crds.stsci.edu' for ['JA9553LVQ', 'JBBGRCGFQ']
337	 Dumped 2 of 2 datasets from CRDS server at 'https://hst-crds.stsci.edu'
338	 Computing bestrefs for datasets ['JA9553LVQ', 'JBBGRCGFQ']
339	 0 errors
340	 1 warnings"""
341	    for msg in out_to_check.splitlines():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/certify/test_certify.py:1393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1392	
1393	    expected9 = """Inserting s7g1700gl_dead_dup1.fits into 'hst_cos_deadtab_0250.rmap'
1394	Unexpanded header [('DETECTOR', 'FUV'), ('LIFE_ADJ', 'UNDEFINED'), ('OPT_ELEM', 'UNDEFINED')]
1395	Skipping expansion for unused parkey 'LIFE_ADJ' of '-1.0|1.0'
1396	Skipping expansion for unused parkey 'LIFE_ADJ' of '-1.0|1.0'
1397	Skipping expansion for unused parkey 'OPT_ELEM' of 'G130M|G140L|G160M'
1398	Skipping expansion for unused parkey 'OPT_ELEM' of 'G185M|G225M|G230L|G285M|MIRRORA|MIRRORB'
1399	Expanded header [('DETECTOR', 'FUV'), ('LIFE_ADJ', 'UNDEFINED'), ('OPT_ELEM', 'UNDEFINED')]
1400	Mapping extra parkey 'DEADCORR' from UNDEFINED to 'N/A'.
1401	Validating key 'FUV'
1402	Checking 'DETECTOR' = 'FUV' against ('FUV', 'NUV')
1403	Modify found ('FUV',) augmenting UseAfterSelector(('DATE-OBS', 'TIME-OBS'), nselections=1) with 's7g1700gl_dead_dup1.fits'
1404	Validating key '1996-10-01 00:00:00'
1405	Modify found '1996-10-01 00:00:00' as primitive 's7g1700gl_dead.fits' replacing with 's7g1700gl_dead_dup1.fits'
1406	Inserting s7g1700gl_dead_dup2.fits into 'hst_cos_deadtab_0250.rmap'
1407	Unexpanded header [('DETECTOR', 'FUV'), ('LIFE_ADJ', 'UNDEFINED'), ('OPT_ELEM', 'UNDEFINED')]
1408	Skipping expansion for unused parkey 'LIFE_ADJ' of '-1.0|1.0'
1409	Skipping expansion for unused parkey 'LIFE_ADJ' of '-1.0|1.0'
1410	Skipping expansion for unused parkey 'OPT_ELEM' of 'G130M|G140L|G160M'
1411	Skipping expansion for unused parkey 'OPT_ELEM' of 'G185M|G225M|G230L|G285M|MIRRORA|MIRRORB'
1412	Expanded header [('DETECTOR', 'FUV'), ('LIFE_ADJ', 'UNDEFINED'), ('OPT_ELEM', 'UNDEFINED')]
1413	Mapping extra parkey 'DEADCORR' from UNDEFINED to 'N/A'.
1414	Validating key 'FUV'
1415	Checking 'DETECTOR' = 'FUV' against ('FUV', 'NUV')
1416	Modify found ('FUV',) augmenting UseAfterSelector(('DATE-OBS', 'TIME-OBS'), nselections=1) with 's7g1700gl_dead_dup2.fits'
1417	Validating key '1996-10-01 00:00:00'
1418	Modify found '1996-10-01 00:00:00' as primitive 's7g1700gl_dead_dup1.fits' replacing with 's7g1700gl_dead_dup2.fits'
1419	----------------------------------------
1420	Both 's7g1700gl_dead_dup2.fits' and 's7g1700gl_dead_dup1.fits' identically match case:
1421	    ((('DETECTOR', 'FUV'),), (('DATE-OBS', '1996-10-01'), ('TIME-OBS', '00:00:00')))
1422	Each reference would replace the other in the rmap.
1423	Either reference file matching parameters need correction
1424	or additional matching parameters should be added to the rmap
1425	to enable CRDS to differentiate between the two files.
1426	See the file submission section of the CRDS server user's guide here:
1427	    https://hst-crds.stsci.edu/static/users_guide/index.html
1428	for more explanation.
1429	Inserting s7g1700gl_dead_overlap.fits into 'hst_cos_deadtab_0250.rmap'
1430	Unexpanded header [('DETECTOR', 'FUV|NUV'), ('LIFE_ADJ', 'UNDEFINED'), ('OPT_ELEM', 'UNDEFINED')]
1431	Skipping expansion for unused parkey 'LIFE_ADJ' of '-1.0|1.0'
1432	Skipping expansion for unused parkey 'LIFE_ADJ' of '-1.0|1.0'
1433	Skipping expansion for unused parkey 'OPT_ELEM' of 'G130M|G140L|G160M'
1434	Skipping expansion for unused parkey 'OPT_ELEM' of 'G185M|G225M|G230L|G285M|MIRRORA|MIRRORB'
1435	Expanded header [('DETECTOR', 'FUV|NUV'), ('LIFE_ADJ', 'UNDEFINED'), ('OPT_ELEM', 'UNDEFINED')]
1436	Mapping extra parkey 'DEADCORR' from UNDEFINED to 'N/A'.
1437	Validating key 'FUV|NUV'
1438	Checking 'DETECTOR' = 'FUV' against ('FUV', 'NUV')
1439	Checking 'DETECTOR' = 'NUV' against ('FUV', 'NUV')
1440	Modify couldn't find 'FUV|NUV' adding new selector.
1441	creating nested 'UseAfter' with '1996-10-01 00:00:00' = 's7g1700gl_dead_overlap.fits'
1442	Writing '/tmp/hst_cos_deadtab_0250.rmap'
1443	########################################
1444	Certifying '/tmp/hst_cos_deadtab_0250.rmap' as 'MAPPING' relative to context 'hst_0508.pmap'
1445	Parsing '/tmp/hst_cos_deadtab_0250.rmap'
1446	Validating 'hst_cos_deadtab_0250.rmap' with parameters (('DETECTOR',), ('DATE-OBS', 'TIME-OBS'))
1447	Validating key ('FUV',)
1448	Checking 'DETECTOR' = 'FUV' against ('FUV', 'NUV')"""
1449	
1450	    expected10 = """Match case

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/certify/test_certify.py:1450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1449	
1450	    expected10 = """Match case
1451	('FUV',) : UseAfter({
1452	    '1996-10-01 00:00:00' : s7g1700gl_dead_dup2.fits
1453	is an equal weight special case of
1454	('FUV|NUV',) : UseAfter({
1455	    '1996-10-01 00:00:00' : s7g1700gl_dead_overlap.fits 
1456	For some parameter sets, CRDS interprets both matches as equally good.
1457	See the file submission section of the CRDS server user's guide here:
1458	    https://hst-crds.stsci.edu/static/users_guide/index.html
1459	for more explanation.
1460	----------------------------------------
1461	Validating key '1996-10-01 00:00:00'
1462	Validating key ('FUV|NUV',)
1463	Checking 'DETECTOR' = 'FUV' against ('FUV', 'NUV')
1464	Checking 'DETECTOR' = 'NUV' against ('FUV', 'NUV')
1465	Validating key '1996-10-01 00:00:00'
1466	Validating key ('NUV',)
1467	Checking 'DETECTOR' = 'NUV' against ('FUV', 'NUV')
1468	----------------------------------------
1469	Match case
1470	('NUV',) : UseAfter({
1471	    '1996-10-01 00:00:00' : s7g1700ql_dead.fits
1472	is an equal weight special case of
1473	('FUV|NUV',) : UseAfter({
1474	    '1996-10-01 00:00:00' : s7g1700gl_dead_overlap.fits 
1475	For some parameter sets, CRDS interprets both matches as equally good.
1476	See the file submission section of the CRDS server user's guide here:
1477	    https://hst-crds.stsci.edu/static/users_guide/index.html
1478	for more explanation.
1479	    ----------------------------------------
1480	Validating key '1996-10-01 00:00:00'
1481	Mapping '/tmp/hst_cos_deadtab_0250.rmap' did not change relative to context 'hst_0508.pmap'
1482	########################################
1483	1 errors
1484	2 warnings"""
1485	
1486	    for msg in expected3.splitlines():

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_heavy_client.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
237	    _ = log.set_verbose()
238	    os.chmod(pickle_file, 0o444)
239	    heavy_client.remove_pickled_mapping("jwst_0016.pmap")

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_heavy_client.py:238
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
237	    _ = log.set_verbose()
238	    os.chmod(pickle_file, 0o444)
239	    heavy_client.remove_pickled_mapping("jwst_0016.pmap")

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_heavy_client.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
240	    assert os.path.exists(pickle_file)
241	    os.chmod(pickle_file, 0o666)
242	    heavy_client.remove_pickled_mapping("jwst_0016.pmap")

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_heavy_client.py:241
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
240	    assert os.path.exists(pickle_file)
241	    os.chmod(pickle_file, 0o666)
242	    heavy_client.remove_pickled_mapping("jwst_0016.pmap")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_locking.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
16	        for char in "testing":
17	            output_file.write(char)
18	            output_file.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_locking.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
19	            time.sleep(0.2)
20	        output_file.write("\n")
21	        output_file.flush()

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_locking.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
30	    context = multiprocessing.get_context("fork")
31	    pool = context.Pool(5)
32	    with tempfile.NamedTemporaryFile(mode="a") as output_file:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
348	def test_validate_mapping_ambiguous(default_shared_state, hst_data, caplog):
349	    default_shared_state.url = "https://hst-crds.stsci.edu"
350	    default_shared_state.config_setup()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
354	        out = caplog.text
355	    expected = """ Match('DETECTOR', 'CCDAMP', 'CCDGAIN') : ('HRC', 'C', '1.0|2.0|4.0|8.0') : 
356	----------------------------------------
357	Match case
358	('HRC', 'C', '1.0|2.0|4.0|8.0') : UseAfter({
359	    '2003-11-06 15:11:06' : nc113178j_drk.fits
360	is an equal weight special case of
361	('HRC', 'A|ABCD|AD|B|BC|C|D', '1.0|2.0|4.0|8.0') : UseAfter({
362	    '1992-01-01 00:00:00' : lcb12060j_drk.fits
363	Cancel the submission and regenerate the reference files
364	with different parameter values which coincide with an existing category.
365	For some parameter sets, CRDS interprets both matches as equally good.
366	For more explanation, see the file submission section of the CRDS server user's guide here:
367	https://hst-crds.stsci.edu/static/users_guide/index.html
368	----------------------------------------
369	    Match('DETECTOR', 'CCDAMP', 'CCDGAIN') : ('HRC', 'C', '2.0') : 
370	----------------------------------------
371	Match case
372	('HRC', 'C', '2.0') : UseAfter({
373	    '2002-03-26 00:00:00' : m3t1633tj_drk.fits
374	is an equal weight special case of
375	('HRC', 'A|ABCD|AD|B|BC|C|D', '1.0|2.0|4.0|8.0') : UseAfter({
376	    '1992-01-01 00:00:00' : lcb12060j_drk.fits
377	Cancel the submission and regenerate the reference files
378	with different parameter values which coincide with an existing category.
379	For some parameter sets, CRDS interprets both matches as equally good.
380	For more explanation, see the file submission section of the CRDS server user's guide here:
381	https://hst-crds.stsci.edu/static/users_guide/index.html
382	----------------------------------------
383	    Match('DETECTOR', 'CCDAMP', 'CCDGAIN') : ('HRC', 'D', '1.0|2.0|4.0|8.0') : 
384	----------------------------------------
385	Match case
386	('HRC', 'D', '1.0|2.0|4.0|8.0') : UseAfter({
387	    '1991-01-01 00:00:00' : j4d1435nj_drk.fits
388	is an equal weight special case of
389	('HRC', 'A|ABCD|AD|B|BC|C|D', '1.0|2.0|4.0|8.0') : UseAfter({
390	    '1992-01-01 00:00:00' : lcb12060j_drk.fits
391	Cancel the submission and regenerate the reference files
392	with different parameter values which coincide with an existing category.
393	For some parameter sets, CRDS interprets both matches as equally good.
394	For more explanation, see the file submission section of the CRDS server user's guide here:
395	https://hst-crds.stsci.edu/static/users_guide/index.html
396	----------------------------------------
397	    Match('DETECTOR', 'CCDAMP', 'CCDGAIN') : ('WFC', 'ABCD', '1.0') : 
398	----------------------------------------
399	Match case
400	('WFC', 'ABCD', '1.0') : UseAfter({
401	    '2003-10-25 01:18:03' : nba1143tj_drk.fits
402	is an equal weight special case of
403	('WFC', 'A|ABCD|AC|AD|B|BC|BD|C|D', '1.0') : UseAfter({
404	    '2003-09-13 00:48:08' : na11410lj_drk.fits
405	Cancel the submission and regenerate the reference files
406	with different parameter values which coincide with an existing category.
407	For some parameter sets, CRDS interprets both matches as equally good.
408	For more explanation, see the file submission section of the CRDS server user's guide here:
409	https://hst-crds.stsci.edu/static/users_guide/index.html
410	----------------------------------------
411	    Match('DETECTOR', 'CCDAMP', 'CCDGAIN') : ('WFC', 'A|ABCD|AC|AD|B|BC|BD|C|D', '1.0') : 
412	----------------------------------------
413	Match case
414	('WFC', 'A|ABCD|AC|AD|B|BC|BD|C|D', '1.0') : UseAfter({
415	    '2003-09-13 00:48:08' : na11410lj_drk.fits
416	is an equal weight special case of
417	('WFC', 'A|ABCD|AC|AD|B|BC|BD|C|D', '1.0|2.0|4.0|8.0') : UseAfter({
418	    '1991-01-01 00:00:00' : lcb1202gj_drk.fits
419	Cancel the submission and regenerate the reference files
420	with different parameter values which coincide with an existing category.
421	For some parameter sets, CRDS interprets both matches as equally good.
422	For more explanation, see the file submission section of the CRDS server user's guide here:
423	https://hst-crds.stsci.edu/static/users_guide/index.html
424	----------------------------------------
425	    Match('DETECTOR', 'CCDAMP', 'CCDGAIN') : ('WFC', 'A|ABCD|AD|B|BC|C|D', '1.0|2.0|4.0|8.0') : 
426	----------------------------------------
427	Match case
428	('WFC', 'A|ABCD|AD|B|BC|C|D', '1.0|2.0|4.0|8.0') : UseAfter({
429	    '2006-07-30 02:04:10' : q9520146j_drk.fits
430	is an equal weight special case of
431	('WFC', 'A|ABCD|AC|AD|B|BC|BD|C|D', '1.0|2.0|4.0|8.0') : UseAfter({
432	    '1991-01-01 00:00:00' : lcb1202gj_drk.fits
433	Cancel the submission and regenerate the reference files
434	with different parameter values which coincide with an existing category.
435	For some parameter sets, CRDS interprets both matches as equally good.
436	For more explanation, see the file submission section of the CRDS server user's guide here:
437	https://hst-crds.stsci.edu/static/users_guide/index.html
438	----------------------------------------
439	"""
440	    for line in expected.splitlines():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	        out = caplog.text
452	    expected = """Match case
453	('WFI01', 'F158') : UseAfter({
454	    '2020-01-01 00:00:00' : roman_wfi_flat_0002.asdf
455	is an equal weight special case of
456	('WFI01', 'F158|F184|F213') : UseAfter({
457	    '2021-08-01 11:11:11' : roman_wfi_flat_0004.asdf
458	Cancel the submission and regenerate the reference files
459	with different parameter values which coincide with an existing category.
460	For some parameter sets, CRDS interprets both matches as equally good.
461	For more explanation, see the file submission section of the CRDS server user's guide here:
462	https://roman-crds.stsci.edu/static/users_guide/index.html
463	----------------------------------------
464	"""
465	    for line in expected.splitlines():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
720	def test_rmap_schema_uri(default_shared_state):
721	    string = '''header = {
722	'derived_from' : 'jwst_nircam_pars-tweakregstep_0001.rmap',
723	'file_ext' : '.asdf',
724	'filekind' : 'pars-tweakregstep',
725	'filetype' : 'pars-tweakregstep',
726	'instrument' : 'NIRCAM',
727	'mapping' : 'REFERENCE',
728	'name' : 'jwst_nircam_pars-tweakregstep_0002.rmap',
729	'observatory' : 'JWST',
730	'parkey' : (('META.EXPOSURE.TYPE', 'META.INSTRUMENT.FILTER', 'META.INSTRUMENT.PUPIL'), ('META.OBSERVATION.DATE', 'META.OBSERVATION.TIME')),
731	'schema_uri' : 'http://stsci.edu/schemas/asdf/core/ndarray-1.0.0',
732	'sha1sum' : '186bb16c5b4ec498d9cc7d03ff564ae22f221d6f',
733	'suffix' : 'pars-tweakregstep',
734	'text_descr' : 'TweakRegStep runtime parameters',
735	}
736	
737	selector = Match({
738	})
739	'''
740	    r = rmap.ReferenceMapping.from_string(string, ignore_checksum=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
740	    r = rmap.ReferenceMapping.from_string(string, ignore_checksum=True)
741	    assert r.schema_uri == 'http://stsci.edu/schemas/asdf/core/ndarray-1.0.0'
742	    r.validate()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
748	def test_rmap_schema_uri_missing(default_shared_state):
749	    string = '''header = {
750	'derived_from' : 'jwst_nircam_pars-tweakregstep_0001.rmap',
751	'file_ext' : '.asdf',
752	'filekind' : 'pars-tweakregstep',
753	'filetype' : 'pars-tweakregstep',
754	'instrument' : 'NIRCAM',
755	'mapping' : 'REFERENCE',
756	'name' : 'jwst_nircam_pars-tweakregstep_0002.rmap',
757	'observatory' : 'JWST',
758	'parkey' : (('META.EXPOSURE.TYPE', 'META.INSTRUMENT.FILTER', 'META.INSTRUMENT.PUPIL'), ('META.OBSERVATION.DATE', 'META.OBSERVATION.TIME')),
759	'schema_uri' : 'http://stsci.edu/schemas/asdf/core/does_not_exist-1.0.0',
760	'sha1sum' : '186bb16c5b4ec498d9cc7d03ff564ae22f221d6f',
761	'suffix' : 'pars-tweakregstep',
762	'text_descr' : 'TweakRegStep runtime parameters',
763	}
764	
765	selector = Match({
766	})
767	'''
768	    r = rmap.ReferenceMapping.from_string(string, ignore_checksum=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:1440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1439	    result = r.insert(insert_header, "foo.fits")
1440	    result.write(result_filename)
1441	    diffs = r.difference(result)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:1446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1445	    log.verbose("recursive insert result rmap:")
1446	    log.verbose(open(result_filename).read())
1447	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:2095
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2094	        result = r.delete("bar.fits")
2095	        result.write(self.result_filename)
2096	        log.verbose("result:\n", str(result))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/core/test_rmap.py:2104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2103	        log.verbose("recursive delete result rmap:")
2104	        log.verbose(open(self.result_filename).read())
2105	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/misc/test_check_archive.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    assert chk is False
34	    assert "File 'foo.pmap' failed HTTP HEAD with code = 404 from 'https://hst-crds.stsci.edu/unchecked_get/mappings/hst/foo.pmap'" in out
35	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/misc/test_check_archive.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	        out = caplog.text
43	    expected = """Mapping URL: 'https://hst-crds.stsci.edu/unchecked_get/mappings/hst/'
44	Reference URL: 'https://hst-crds.stsci.edu/unchecked_get/references/hst/'
45	File 'foo.map' failed HTTP HEAD with code = 404 from 'https://hst-crds.stsci.edu/unchecked_get/references/hst/foo.map'
46	1 errors
47	0 warnings"""
48	    for line in expected.splitlines():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/submit/test_submit.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    def _set_config(self, hst_shared_cache_state, submit_test_files, tmp_rc, mock_submit_form):
18	        hst_shared_cache_state.url = 'https://hst-crds.stsci.edu'
19	        hst_shared_cache_state.config_setup()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/crds-12.1.4/crds-12.1.4/test/test_sync.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
75	            with open(config.locate_file(name, "hst"), "w+") as handle:
76	                handle.write("foo")
77	        self.run_script(f"{self.sync_rmap} --fetch-references --check-files", expected_errs=2)

--------------------------------------------------

Code scanned:
	Total lines of code: 38562
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 74.0
		High: 118.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 177.0
		High: 15.0
Files skipped (0):
