Run started:2025-04-12 16:44:41.684529

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	    """
100	    if resp.headers.get("content-type") == "application/json":
101	        data = resp.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	    return (
114	        resp.headers.get("content-type") == "application/json"
115	        and resp.status_code == codes.ok

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	    return (
125	        resp.headers.get("content-type") == "application/json"
126	        and resp.status_code == codes.created

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
144	    current_dir_size = 0
145	    with tarfile.open(fileobj=tar_stream, mode="w:gz") as tar:
146	        for filename in filenames:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
224	        self.user_agent = "pygitguardian/{} ({};py{})".format(
225	            self._version, platform.system(), platform.python_version()
226	        )

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
224	        self.user_agent = "pygitguardian/{} ({};py{})".format(
225	            self._version, platform.system(), platform.python_version()
226	        )

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:225
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
224	        self.user_agent = "pygitguardian/{} ({};py{})".format(
225	            self._version, platform.system(), platform.python_version()
226	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
257	            start = time.time()
258	            response: Response = self.session.request(
259	                method=method, url=url, timeout=self.timeout, headers=headers, **kwargs
260	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
285	
286	        self.app_version = response.headers.get("X-App-Version", self.app_version)
287	        self.secrets_engine_version = response.headers.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
286	        self.app_version = response.headers.get("X-App-Version", self.app_version)
287	        self.secrets_engine_version = response.headers.get(
288	            "X-Secrets-Engine-Version", self.secrets_engine_version
289	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
329	    ) -> Response:
330	        return self.request(
331	            method="get",
332	            endpoint=endpoint,
333	            version=version,
334	            extra_headers=extra_headers,
335	            **kwargs,
336	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
345	    ) -> Response:
346	        return self.request(
347	            "post",
348	            endpoint=endpoint,
349	            json=data,
350	            version=version,
351	            extra_headers=extra_headers,
352	            **kwargs,
353	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
362	    ) -> Response:
363	        return self.request(
364	            "patch",
365	            endpoint=endpoint,
366	            json=data,
367	            version=version,
368	            extra_headers=extra_headers,
369	            **kwargs,
370	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
379	    ) -> Response:
380	        return self.request(
381	            "delete",
382	            endpoint=endpoint,
383	            json=data,
384	            version=version,
385	            extra_headers=extra_headers,
386	            **kwargs,
387	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
397	        """
398	        resp = self.get(endpoint="health")
399	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
421	                token = "self"
422	            resp = self.get(
423	                endpoint=f"api_tokens/{token}",
424	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
468	
469	        resp = self.post(
470	            endpoint="scan",
471	            data=request_obj,
472	            extra_headers=extra_headers,
473	            params=params,
474	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
531	
532	        resp = self.post(
533	            endpoint="multiscan",
534	            data=request_obj,
535	            extra_headers=extra_headers,
536	            params=params,
537	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
558	
559	        resp = self.get(
560	            endpoint=f"incidents/secrets/{incident_id}",
561	            params={"with_occurrences": with_occurrences},
562	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
583	
584	        resp = self.get(
585	            endpoint="quotas",
586	            extra_headers=extra_headers,
587	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
615	        try:
616	            resp = self.post(
617	                endpoint="honeytokens",
618	                extra_headers=extra_headers,
619	                data={
620	                    "name": name,
621	                    "type": type_,
622	                    "description": description,
623	                },

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
660	        try:
661	            resp = self.post(
662	                endpoint="honeytokens/with-context",
663	                extra_headers=extra_headers,
664	                data={
665	                    "name": name,
666	                    "type": type_,
667	                    "description": description,
668	                    "project_extensions": ",".join(project_extensions),
669	                    "filename": filename,
670	                    "language": language,
671	                },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
692	        """
693	        resp = self.get("metadata")
694	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
699	        metadata = ServerMetadata.from_dict(resp.json())
700	        self.maximum_payload_size = metadata.preferences.get(
701	            "general__maximum_payload_size", MAXIMUM_PAYLOAD_SIZE
702	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
717	
718	        resp = self.post(
719	            endpoint="auth/jwt",
720	            data={"audience": jwt_audience, "audience_type": service.value},
721	            extra_headers=extra_headers,
722	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
736	
737	        response = self.get(
738	            endpoint="members",
739	            params=parameters.to_dict() if parameters else {},
740	            extra_headers=extra_headers,
741	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
756	    ) -> Union[Detail, Member]:
757	        response = self.get(
758	            endpoint=f"members/{member_id}",
759	            extra_headers=extra_headers,
760	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
814	        params = parameters.to_dict() if parameters else {}
815	        response = self.get(
816	            endpoint="teams",
817	            params=params,
818	            extra_headers=extra_headers,
819	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
834	    ) -> Union[Detail, Team]:
835	        response = self.get(
836	            endpoint=f"teams/{team_id}",
837	            extra_headers=extra_headers,
838	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
853	    ) -> Union[Detail, Team]:
854	        response = self.post(
855	            endpoint="teams", data=CreateTeam.to_dict(team), extra_headers=extra_headers
856	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
909	    ) -> Union[Detail, CursorPaginatedResponse[TeamInvitation]]:
910	        response = self.get(
911	            endpoint=f"teams/{team_id}/team_invitations",
912	            params=parameters.to_dict() if parameters else {},
913	            extra_headers=extra_headers,
914	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
932	    ) -> Union[Detail, TeamInvitation]:
933	        response = self.post(
934	            endpoint=f"teams/{team_id}/team_invitations",
935	            data=CreateTeamInvitation.to_dict(invitation),
936	            extra_headers=extra_headers,
937	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
967	    ) -> Union[Detail, CursorPaginatedResponse[TeamMember]]:
968	        response = self.get(
969	            endpoint=f"teams/{team_id}/team_memberships",
970	            params=parameters.to_dict() if parameters else {},
971	            extra_headers=extra_headers,
972	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
991	    ) -> Union[Detail, TeamMember]:
992	        response = self.post(
993	            endpoint=f"teams/{team_id}/team_memberships",
994	            data=CreateTeamMember.to_dict(member),
995	            params=parameters.to_dict() if parameters else {},
996	            extra_headers=extra_headers,
997	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:1027
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1026	    ) -> Union[Detail, CursorPaginatedResponse[Source]]:
1027	        response = self.get(
1028	            endpoint="sources",
1029	            params=parameters.to_dict() if parameters else {},
1030	            extra_headers=extra_headers,
1031	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1047	    ) -> Union[Detail, CursorPaginatedResponse[Source]]:
1048	        response = self.get(
1049	            endpoint=f"teams/{team_id}/sources",
1050	            params=parameters.to_dict() if parameters else {},
1051	            extra_headers=extra_headers,
1052	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:1072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1071	
1072	        response = self.post(
1073	            endpoint=f"teams/{team_id}/sources",
1074	            data=data,
1075	            extra_headers=extra_headers,
1076	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:1086
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1085	    ) -> Union[Detail, CursorPaginatedResponse[Invitation]]:
1086	        response = self.get(
1087	            endpoint="invitations",
1088	            params=parameters.to_dict() if parameters else {},
1089	            extra_headers=extra_headers,
1090	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/client.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1108	    ) -> Union[Detail, Invitation]:
1109	        response = self.post(
1110	            endpoint="invitations",
1111	            data=CreateInvitation.to_dict(invitation),
1112	            params=parameters.to_dict() if parameters else {},
1113	            extra_headers=extra_headers,
1114	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/config.py:1
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	DEFAULT_BASE_URI = "https://api.gitguardian.com"
2	DEFAULT_API_VERSION = "v1"
3	DEFAULT_TIMEOUT = 20.0  # 20s default timeout

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/config.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	DEFAULT_REWRITE_GIT_HISTORY_MESSAGE = """
11	  To prevent having to rewrite git history in the future, setup ggshield as a pre-commit hook:
12	    https://docs.gitguardian.com/ggshield-docs/integrations/git-hooks/pre-commit
13	"""
14	
15	DEFAULT_PRE_COMMIT_MESSAGE = """> How to remediate

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/models_utils.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	
134	        if previous_page := response.links.get("prev"):
135	            paginated_response.prev = previous_page["url"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/pygitguardian/models_utils.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	            paginated_response.prev = previous_page["url"]
136	        if next_page := response.links.get("next"):
137	            paginated_response.next = next_page["url"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	FILENAME = ".env"
67	DOCUMENT = """
68	    import urllib.request
69	    url = 'http://jen_barber:correcthorsebatterystaple@cake.gitguardian.com/isreal.json'
70	    response = urllib.request.urlopen(url)
71	    consume(response.read())"
72	"""
73	EXAMPLE_RESPONSE = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
132	            "validapi_keyforsure",
133	            "http://fake_uri",
134	            "custom",
135	            30.0,
136	            None,
137	            id="valid prefix",
138	        ),
139	        pytest.param(
140	            "validapi_keyforsure",
141	            "https://api.gitguardian.com",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
140	            "validapi_keyforsure",
141	            "https://api.gitguardian.com",
142	            "custom",
143	            30.0,
144	            None,
145	            id="valid - no trailing /",
146	        ),
147	        pytest.param(
148	            "validapi_keyforsure",
149	            "https://api.gitguardian.com/",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	            "validapi_keyforsure",
149	            "https://api.gitguardian.com/",
150	            "custom",
151	            30.0,
152	            None,
153	            id="valid - trailing /",
154	        ),
155	        pytest.param(
156	            "validapi_keyforsure", None, "custom", 30.0, None, id="No baseuri"
157	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	            "validapi_keyforsure",
169	            "https://api.gitguardian.com/",
170	            "custom",
171	            30.0,
172	            None,
173	            id="Custom headers",
174	        ),
175	        pytest.param(
176	            "–––––––FILL-ME–––––––––",
177	            "https://api.gitguardian.com/",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	            "–––––––FILL-ME–––––––––",
177	            "https://api.gitguardian.com/",
178	            "None",
179	            30.0,
180	            ValueError,
181	            id="U+2013 dash characters in API key",
182	        ),
183	    ],
184	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
222	        (
223	            ("https://api.gitguardian.com",),
224	            "v1",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
225	            (
226	                ("multiscan", "https://api.gitguardian.com/v1/multiscan"),
227	                ("scan", "https://api.gitguardian.com/v1/scan"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
226	                ("multiscan", "https://api.gitguardian.com/v1/multiscan"),
227	                ("scan", "https://api.gitguardian.com/v1/scan"),
228	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
231	            (
232	                "https://gg-onprem-instance.company.com/exposed",
233	                "https://gg-onprem-instance.company.com/exposed/",
234	            ),
235	            "v1",
236	            (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
232	                "https://gg-onprem-instance.company.com/exposed",
233	                "https://gg-onprem-instance.company.com/exposed/",
234	            ),
235	            "v1",
236	            (
237	                (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	                    "multiscan",
239	                    "https://gg-onprem-instance.company.com/exposed/v1/multiscan",
240	                ),
241	                ("scan", "https://gg-onprem-instance.company.com/exposed/v1/scan"),
242	            ),
243	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
240	                ),
241	                ("scan", "https://gg-onprem-instance.company.com/exposed/v1/scan"),
242	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	    """
452	    client = GGClient(api_key="", base_uri="https://docs.gitguardian.com")
453	    resp = client.get(endpoint="/img/gg_owl.svg", version=None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
630	            "hmsl_hash": "05975add34ddc9a38a0fb57c7d3e676ffed57080516fc16bf8d8f14308fedb86",
631	            "gitguardian_url": "https://dashboard.gitguardian.com/workspace/1/incidents/3899",
632	            "regression": False,
633	            "status": "IGNORED",
634	            "assignee_id": 309,
635	            "assignee_email": "eric@gitguardian.com",
636	            "occurrences_count": 4,
637	            "secret_presence": {
638	                "files_requiring_code_fix": 1,
639	                "files_pending_merge": 1,
640	                "files_fixed": 1,
641	                "outside_vcs": 1,
642	                "removed_outside_vcs": 0,
643	                "in_vcs": 3,
644	                "removed_in_vcs": 0,
645	            },
646	            "ignore_reason": "test_credential",
647	            "triggered_at": "2019-05-12T09:37:49Z",
648	            "ignored_at": "2019-08-24T14:15:22Z",
649	            "ignorer_id": 309,
650	            "ignorer_api_token_id": "fdf075f9-1662-4cf1-9171-af50568158a8",
651	            "resolver_id": 395,
652	            "resolver_api_token_id": "fdf075f9-1662-4cf1-9171-af50568158a8",
653	            "secret_revoked": False,
654	            "severity": "high",
655	            "validity": "valid",
656	            "resolved_at": None,
657	            "share_url": "https://dashboard.gitguardian.com/share/incidents/11111111-1111-1111-1111-111111111111",
658	            "tags": ["FROM_HISTORICAL_SCAN", "SENSITIVE_FILE"],
659	            "feedback_list": [
660	                {
661	                    "created_at": "2021-05-20T12:40:55.662949Z",
662	                    "updated_at": "2021-05-20T12:40:55.662949Z",
663	                    "member_id": 42,
664	                    "email": "eric@gitguardian.com",
665	                    "answers": [
666	                        {
667	                            "type": "boolean",
668	                            "field_ref": "actual_secret_yes_no",
669	                            "field_label": "Is it an actual secret?",
670	                            "boolean": True,
671	                        }
672	                    ],
673	                }
674	            ],
675	            "occurrences": None,
676	        },
677	    )
678	
679	    result = client.retrieve_secret_incident(3759)
680	
681	    assert mock_response.call_count == 1
682	    assert result.id == 3759
683	    assert result.detector.name == "slack_bot_token"
684	    assert result.ignore_reason == "test_credential"
685	    assert result.secret_revoked is False
686	
687	
688	@responses.activate
689	def test_rate_limit():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
656	            "resolved_at": None,
657	            "share_url": "https://dashboard.gitguardian.com/share/incidents/11111111-1111-1111-1111-111111111111",
658	            "tags": ["FROM_HISTORICAL_SCAN", "SENSITIVE_FILE"],
659	            "feedback_list": [
660	                {
661	                    "created_at": "2021-05-20T12:40:55.662949Z",
662	                    "updated_at": "2021-05-20T12:40:55.662949Z",
663	                    "member_id": 42,
664	                    "email": "eric@gitguardian.com",
665	                    "answers": [
666	                        {
667	                            "type": "boolean",
668	                            "field_ref": "actual_secret_yes_no",
669	                            "field_label": "Is it an actual secret?",
670	                            "boolean": True,
671	                        }
672	                    ],
673	                }
674	            ],
675	            "occurrences": None,
676	        },
677	    )
678	
679	    result = client.retrieve_secret_incident(3759)
680	
681	    assert mock_response.call_count == 1
682	    assert result.id == 3759
683	    assert result.detector.name == "slack_bot_token"
684	    assert result.ignore_reason == "test_credential"
685	    assert result.secret_revoked is False
686	
687	
688	@responses.activate
689	def test_rate_limit():
690	    """
691	    GIVEN a GGClient instance with callbacks
692	    WHEN calling an API endpoint and we hit a rate-limit
693	    THEN the client retries after the delay
694	    AND the `on_rate_limited()` method of the callback is called
695	    """
696	    callbacks = Mock(spec=GGClientCallbacks)
697	
698	    client = create_client(callbacks=callbacks)
699	    multiscan_url = client._url_from_endpoint("multiscan", "v1")
700	
701	    rate_limit_response = responses.post(
702	        url=multiscan_url,
703	        status=429,
704	        headers={"Retry-After": "1"},
705	    )
706	    normal_response = responses.post(
707	        url=multiscan_url,
708	        status=200,
709	        json=[
710	            {
711	                "policy_break_count": 0,
712	                "policies": ["pol"],
713	                "policy_breaks": [],
714	            }
715	        ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
898	            "created_at": "2019-08-22T14:15:22Z",
899	            "gitguardian_url": "https://dashboard.gitguardian.com/workspace/1/honeytokens/d45a123f-b15d-4fea-abf6-ff2a8479de5b",  # noqa: E501
900	            "status": "active",
901	            "triggered_at": "2019-08-22T14:15:22Z",
902	            "revoked_at": None,
903	            "open_events_count": 2,
904	            "type": "AWS",
905	            "creator_id": 122,
906	            "revoker_id": None,
907	            "creator_api_token_id": None,
908	            "revoker_api_token_id": None,
909	            "token": {"access_token_id": "AAAA", "secret_key": "BBB"},
910	            "tags": ["publicly_exposed"],
911	        },
912	    )
913	
914	    result = client.create_honeytoken(
915	        name="honeytoken A",
916	        description="honeytoken used in the repository AA",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
975	            "honeytoken_id": "d45a123f-b15d-4fea-abf6-ff2a8479de5b",
976	            "gitguardian_url": "https://dashboard.gitguardian.com/workspace/1/honeytokens/d45a123f-b15d-4fea-abf6-ff2a8479de5b",  # noqa: E501
977	        },
978	    )
979	
980	    result = client.create_honeytoken_with_context(
981	        name="honeytoken A",
982	        description="honeytoken used in the repository AA",
983	        type_="AWS",
984	        filename="aws.yaml",
985	    )
986	
987	    assert mock_response.call_count == 1

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_client.py:1056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1055	    buffer = BytesIO()
1056	    with tarfile.open(fileobj=buffer, mode="w") as tar_file:
1057	        for name, content in files:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	                    "known_secret": True,
130	                    "incident_url": "https://api.gitguardian.com/workspace/2/incidents/3",
131	                    "matches": [{"match": "hello", "type": "hello"}],
132	                },
133	            ),
134	            (
135	                PolicyBreakSchema,
136	                PolicyBreak,
137	                {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	                    "known_secret": True,
142	                    "incident_url": "https://api.gitguardian.com/workspace/2/incidents/3",
143	                    "matches": [{"match": "hello", "type": "hello"}],
144	                    "is_excluded": True,
145	                    "exclude_reason": "bad secret",
146	                },
147	            ),
148	            (
149	                PolicyBreakSchema,
150	                PolicyBreak,
151	                {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	                    "known_secret": True,
156	                    "incident_url": "https://api.gitguardian.com/workspace/2/incidents/3",
157	                    "matches": [{"match": "hello", "type": "hello"}],
158	                    "is_excluded": False,
159	                    "exclude_reason": None,
160	                    "diff_kind": None,
161	                },
162	            ),
163	            (
164	                PolicyBreakSchema,
165	                PolicyBreak,
166	                {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	                    "known_secret": True,
171	                    "incident_url": "https://api.gitguardian.com/workspace/2/incidents/3",
172	                    "matches": [{"match": "hello", "type": "hello"}],
173	                    "is_excluded": False,
174	                    "exclude_reason": None,
175	                    "diff_kind": "addition",
176	                },
177	            ),
178	            (
179	                QuotaSchema,
180	                Quota,
181	                {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
227	                    "created_at": "2019-08-22T14:15:22Z",
228	                    "gitguardian_url": "https://dashboard.gitguardian.com/workspace/1/honeytokens/d45a123f-b15d-4fea-abf6-ff2a8479de5b",  # noqa: E501
229	                    "status": "active",
230	                    "triggered_at": "2019-08-22T14:15:22Z",
231	                    "revoked_at": None,
232	                    "open_events_count": 2,
233	                    "type": "AWS",
234	                    "creator_id": 122,
235	                    "revoker_id": None,
236	                    "creator_api_token_id": None,
237	                    "revoker_api_token_id": None,
238	                    "token": {"access_token_id": "AAAA", "secret_key": "BBB"},
239	                    "tags": ["publicly_exposed"],
240	                },
241	            ),
242	            (
243	                HoneytokenWithContextResponseSchema,
244	                HoneytokenWithContextResponse,
245	                {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
254	                    "honeytoken_id": "d45a123f-b15d-4fea-abf6-ff2a8479de5b",
255	                    "gitguardian_url": "https://dashboard.gitguardian.com/workspace/1/honeytokens/d45a123f-b15d-4fea-abf6-ff2a8479de5b",  # noqa: E501
256	                },
257	            ),
258	            (
259	                SecretIncidentSchema,
260	                SecretIncident,
261	                {
262	                    "id": 3759,
263	                    "date": "2019-08-22T14:15:22Z",
264	                    "detector": {
265	                        "name": "slack_bot_token",
266	                        "display_name": "Slack Bot Token",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
273	                    "hmsl_hash": "05975add34ddc9a38a0fb57c7d3e676ffed57080516fc16bf8d8f14308fedb86",
274	                    "gitguardian_url": "https://dashboard.gitguardian.com/workspace/1/incidents/3899",
275	                    "regression": False,
276	                    "status": "IGNORED",
277	                    "assignee_id": 309,
278	                    "assignee_email": "eric@gitguardian.com",
279	                    "occurrences_count": 4,
280	                    "secret_presence": {
281	                        "files_requiring_code_fix": 1,
282	                        "files_pending_merge": 1,
283	                        "files_fixed": 1,
284	                        "outside_vcs": 1,
285	                        "removed_outside_vcs": 0,
286	                        "in_vcs": 3,
287	                        "removed_in_vcs": 0,
288	                    },
289	                    "ignore_reason": "test_credential",
290	                    "triggered_at": "2019-05-12T09:37:49Z",
291	                    "ignored_at": "2019-08-24T14:15:22Z",
292	                    "ignorer_id": 309,
293	                    "ignorer_api_token_id": "fdf075f9-1662-4cf1-9171-af50568158a8",
294	                    "resolver_id": 395,
295	                    "resolver_api_token_id": "fdf075f9-1662-4cf1-9171-af50568158a8",
296	                    "secret_revoked": False,
297	                    "severity": "high",
298	                    "validity": "valid",
299	                    "resolved_at": None,
300	                    "share_url": "https://dashboard.gitguardian.com/share/incidents/11111111-11111",
301	                    "tags": ["FROM_HISTORICAL_SCAN", "SENSITIVE_FILE"],
302	                    "feedback_list": [
303	                        {
304	                            "created_at": "2021-05-20T12:40:55.662949Z",
305	                            "updated_at": "2021-05-20T12:40:55.662949Z",
306	                            "member_id": 42,
307	                            "email": "eric@gitguardian.com",
308	                            "answers": [
309	                                {
310	                                    "type": "boolean",
311	                                    "field_ref": "actual_secret_yes_no",
312	                                    "field_label": "Is it an actual secret?",
313	                                    "boolean": True,
314	                                }
315	                            ],
316	                        }
317	                    ],
318	                    "occurrences": None,
319	                },
320	            ),
321	            (
322	                SecretOccurrenceSchema,
323	                SecretOccurrence,
324	                {
325	                    "id": 16424242,
326	                    "incident_id": 133424242,
327	                    "author_info": "toto@gitguardian.com",
328	                    "author_name": "toto@gitguardian.com",
329	                    "date": "2024-01-17T16:05:43Z",
330	                    "filepath": ".pre-commit-config.yaml",
331	                    "kind": "historical",
332	                    "sha": "ee95f89e211831f07f07e07fde478",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
299	                    "resolved_at": None,
300	                    "share_url": "https://dashboard.gitguardian.com/share/incidents/11111111-11111",
301	                    "tags": ["FROM_HISTORICAL_SCAN", "SENSITIVE_FILE"],
302	                    "feedback_list": [
303	                        {
304	                            "created_at": "2021-05-20T12:40:55.662949Z",
305	                            "updated_at": "2021-05-20T12:40:55.662949Z",
306	                            "member_id": 42,
307	                            "email": "eric@gitguardian.com",
308	                            "answers": [
309	                                {
310	                                    "type": "boolean",
311	                                    "field_ref": "actual_secret_yes_no",
312	                                    "field_label": "Is it an actual secret?",
313	                                    "boolean": True,
314	                                }
315	                            ],
316	                        }
317	                    ],
318	                    "occurrences": None,
319	                },
320	            ),
321	            (
322	                SecretOccurrenceSchema,
323	                SecretOccurrence,
324	                {
325	                    "id": 16424242,
326	                    "incident_id": 133424242,
327	                    "author_info": "toto@gitguardian.com",
328	                    "author_name": "toto@gitguardian.com",
329	                    "date": "2024-01-17T16:05:43Z",
330	                    "filepath": ".pre-commit-config.yaml",
331	                    "kind": "historical",
332	                    "sha": "ee95f89e211831f07f07e07fde478",
333	                    "presence": "present",
334	                    "url": "https://github.com/GitGuardian/py-gitguardian/commit/ee95f89e211831f07f07e07fde478",
335	                    "matches": [
336	                        {
337	                            "name": "connection_uri",
338	                            "indice_start": 62,
339	                            "indice_end": 131,
340	                            "pre_line_start": None,
341	                            "pre_line_end": None,
342	                            "post_line_start": 3,
343	                            "post_line_end": 3,
344	                        },
345	                        {
346	                            "name": "scheme",
347	                            "indice_start": 62,
348	                            "indice_end": 70,
349	                            "pre_line_start": None,
350	                            "pre_line_end": None,
351	                            "post_line_start": 3,
352	                            "post_line_end": 3,
353	                        },
354	                        {
355	                            "name": "username",
356	                            "indice_start": 73,
357	                            "indice_end": 81,
358	                            "pre_line_start": None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
333	                    "presence": "present",
334	                    "url": "https://github.com/GitGuardian/py-gitguardian/commit/ee95f89e211831f07f07e07fde478",
335	                    "matches": [
336	                        {
337	                            "name": "connection_uri",
338	                            "indice_start": 62,
339	                            "indice_end": 131,
340	                            "pre_line_start": None,
341	                            "pre_line_end": None,
342	                            "post_line_start": 3,
343	                            "post_line_end": 3,
344	                        },
345	                        {
346	                            "name": "scheme",
347	                            "indice_start": 62,
348	                            "indice_end": 70,
349	                            "pre_line_start": None,
350	                            "pre_line_end": None,
351	                            "post_line_start": 3,
352	                            "post_line_end": 3,
353	                        },
354	                        {
355	                            "name": "username",
356	                            "indice_start": 73,
357	                            "indice_end": 81,
358	                            "pre_line_start": None,
359	                            "pre_line_end": None,
360	                            "post_line_start": 3,
361	                            "post_line_end": 3,
362	                        },
363	                        {
364	                            "name": "password",
365	                            "indice_start": 82,
366	                            "indice_end": 99,
367	                            "pre_line_start": None,
368	                            "pre_line_end": None,
369	                            "post_line_start": 3,
370	                            "post_line_end": 3,
371	                        },
372	                        {
373	                            "name": "host",
374	                            "indice_start": 100,
375	                            "indice_end": 112,
376	                            "pre_line_start": None,
377	                            "pre_line_end": None,
378	                            "post_line_start": 3,
379	                            "post_line_end": 3,
380	                        },
381	                        {
382	                            "name": "port",
383	                            "indice_start": 113,
384	                            "indice_end": 117,
385	                            "pre_line_start": None,
386	                            "pre_line_end": None,
387	                            "post_line_start": 3,
388	                            "post_line_end": 3,
389	                        },
390	                        {
391	                            "name": "database",
392	                            "indice_start": 118,
393	                            "indice_end": 131,
394	                            "pre_line_start": None,
395	                            "pre_line_end": None,
396	                            "post_line_start": 3,
397	                            "post_line_end": 3,
398	                        },
399	                    ],
400	                    "source": {
401	                        "id": 16218989,
402	                        "type": "github",
403	                        "full_name": "py-gitguardian",
404	                        "health": "at_risk",
405	                        "source_criticality": "unknown",
406	                        "default_branch": "main",
407	                        "default_branch_head": None,
408	                        "open_incidents_count": 19,
409	                        "closed_incidents_count": 0,
410	                        "last_scan": {
411	                            "date": "2024-08-07T14:15:33.829070Z",
412	                            "status": "finished",
413	                            "failing_reason": "",
414	                            "commits_scanned": 49,
415	                            "duration": "0.0",
416	                            "branches_scanned": 14,
417	                            "progress": 100,
418	                        },
419	                        "monitored": True,
420	                        "visibility": "internal",
421	                        "external_id": "139",
422	                        "secret_incidents_breakdown": {
423	                            "open_secret_incidents": {
424	                                "total": 19,
425	                                "severity_breakdown": {
426	                                    "critical": 0,
427	                                    "high": 7,
428	                                    "medium": 0,
429	                                    "low": 0,
430	                                    "info": 0,
431	                                    "unknown": 12,
432	                                },
433	                            },
434	                            "closed_secret_incidents": {
435	                                "total": 0,
436	                                "severity_breakdown": {
437	                                    "critical": 0,
438	                                    "high": 0,
439	                                    "medium": 0,
440	                                    "low": 0,
441	                                    "info": 0,
442	                                    "unknown": 0,
443	                                },
444	                            },
445	                        },
446	                        "url": "https://github.com/GitGuardian/py-gitguardian",
447	                    },
448	                    "tags": ["FROM_HISTORICAL_SCAN"],
449	                },
450	            ),
451	        ],
452	    )
453	    def test_schema_loads(self, schema_klass, expected_klass, instance_data):
454	        """
455	        GIVEN the right kwargs  and an extra field in dict format
456	        WHEN loading using the schema
457	        THEN the extra field should be excluded
458	        AND the result should be an instance of the expected class
459	        """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_models.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
445	                        },
446	                        "url": "https://github.com/GitGuardian/py-gitguardian",
447	                    },
448	                    "tags": ["FROM_HISTORICAL_SCAN"],
449	                },
450	            ),
451	        ],
452	    )
453	    def test_schema_loads(self, schema_klass, expected_klass, instance_data):
454	        """
455	        GIVEN the right kwargs  and an extra field in dict format
456	        WHEN loading using the schema
457	        THEN the extra field should be excluded
458	        AND the result should be an instance of the expected class
459	        """
460	        schema = schema_klass()
461	
462	        data = {**instance_data, "field": "extra"}
463	
464	        obj = schema.load(data)
465	        assert isinstance(obj, expected_klass)
466	
467	    def test_detail_renames_error_field(self):
468	        """
469	        GIVEN a Detail JSON dict with an `error` field instead of a `detail` field
470	        WHEN loading using the schema
471	        THEN the created Detail instance contains a `detail` field with the right value
472	        """
473	        detail = Detail.SCHEMA.load({"error": "An error message"})
474	        assert detail.detail == "An error message"
475	
476	    @pytest.mark.parametrize("known_secret", [True, False])
477	    def test_policy_break_known_secret_field(self, known_secret):
478	        """
479	        GIVEN the data with policy breaks
480	        WHEN loading using the schema
481	        THEN known_secret is parsed correctly with the default value set to False
482	        """
483	        data = {
484	            "type": "hello",
485	            "policy": "hello",
486	            "validity": "hey",
487	            "matches": [{"match": "hello", "type": "hello"}],
488	        }
489	        if known_secret:
490	            data["known_secret"] = True
491	
492	        obj = PolicyBreakSchema().load(data)
493	
494	        assert obj.known_secret is known_secret

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pygitguardian-1.20.0/pygitguardian-1.20.0/tests/test_utils.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
29	    (tmp_path / "output").mkdir(exist_ok=True)
30	    with tarfile.open(fileobj=BytesIO(tar_stream), mode="r:gz") as tar:
31	        tar.extractall(tmp_path / "output")

--------------------------------------------------

Code scanned:
	Total lines of code: 4334
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 42.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 72.0
		High: 1.0
Files skipped (0):
