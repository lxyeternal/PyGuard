Run started:2025-04-12 15:57:29.005711

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/alignment/__init__.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	        model = FAN(num_modules=4, num_landmarks=98, device=device)
13	        model_url = 'https://github.com/xinntao/facexlib/releases/download/v0.1.0/alignment_WFLW_4HG.pth'
14	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/assessment/__init__.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	        model = HyperIQA(16, 112, 224, 112, 56, 28, 14, 7)
10	        model_url = 'https://github.com/xinntao/facexlib/releases/download/v0.2.0/assessment_hyperIQA.pth'
11	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/detection/__init__.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        model = RetinaFace(network_name='resnet50', half=half, device=device)
11	        model_url = 'https://github.com/xinntao/facexlib/releases/download/v0.1.0/detection_Resnet50_Final.pth'
12	    elif model_name == 'retinaface_mobile0.25':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/detection/__init__.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        model = RetinaFace(network_name='mobile0.25', half=half, device=device)
14	        model_url = 'https://github.com/xinntao/facexlib/releases/download/v0.1.0/detection_mobilenet0.25_Final.pth'
15	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/headpose/__init__.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	        model = HopeNet('resnet', [3, 4, 6, 3], 66)
10	        model_url = 'https://github.com/xinntao/facexlib/releases/download/v0.2.0/headpose_hopenet.pth'
11	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/matting/__init__.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        model = MODNet(backbone_pretrained=False)
11	        model_url = 'https://github.com/xinntao/facexlib/releases/download/v0.2.0/matting_modnet_portrait.pth'
12	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/parsing/__init__.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        model = BiSeNet(num_class=19)
11	        model_url = 'https://github.com/xinntao/facexlib/releases/download/v0.2.0/parsing_bisenet.pth'
12	    elif model_name == 'parsenet':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/parsing/__init__.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        model = ParseNet(in_size=512, out_size=512, parsing_ch=19)
14	        model_url = 'https://github.com/xinntao/facexlib/releases/download/v0.2.2/parsing_parsenet.pth'
15	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/recognition/__init__.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	        model = Backbone(num_layers=50, drop_ratio=0.6, mode='ir_se').to('cuda').eval()
10	        model_url = 'https://github.com/xinntao/facexlib/releases/download/v0.1.0/recognition_arcface_ir_se50.pth'
11	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/utils/face_restoration_helper.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	        if isinstance(img, str):
112	            img = cv2.imread(img)
113	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/utils/face_restoration_helper.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	                save_path = f'{path}_{idx:02d}.{self.save_ext}'
264	                imwrite(cropped_face, save_path)
265	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/utils/face_restoration_helper.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
363	            save_path = f'{path}.{self.save_ext}'
364	            imwrite(upsample_img, save_path)
365	        return upsample_img

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/utils/face_utils.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
222	    det_net = init_detection_model('retinaface_resnet50', half=False)
223	    img_ori = cv2.imread(img_path)
224	    h, w = img_ori.shape[0:2]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/utils/face_utils.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
247	
248	    cv2.imwrite(f'tmp/{img_name}_cropeed_face.png', cropped_face)
249	    img = paste_face_back(img_ori, cropped_face, inverse_affine)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/utils/face_utils.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
249	    img = paste_face_back(img_ori, cropped_face, inverse_affine)
250	    cv2.imwrite(f'tmp/{img_name}_back.png', img)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/utils/misc.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
26	        os.makedirs(dir_name, exist_ok=True)
27	    return cv2.imwrite(file_path, img, params)
28	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/facexlib/visualization/vis_headpose.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
90	    if save_path is not None:
91	        cv2.imwrite(save_path, img)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_headpose.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
17	
18	    img = cv2.imread(args.img_path)
19	    with torch.no_grad():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_hyperiqa.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	
31	    img = cv2.imread(args.img_path)
32	    img_name = os.path.basename(args.img_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_parsing.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
25	    if save_anno_path is not None:
26	        cv2.imwrite(save_anno_path, vis_parsing_anno)
27	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_parsing.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
37	
38	        cv2.imwrite(save_vis_path, vis_im)
39	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_parsing.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	
47	    img_input = cv2.imread(img_path)
48	    img_input = cv2.resize(img_input, (512, 512), interpolation=cv2.INTER_LINEAR)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_parsing_parsenet.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
26	    if save_anno_path is not None:
27	        cv2.imwrite(save_anno_path, vis_parsing_anno)
28	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_parsing_parsenet.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	
39	        cv2.imwrite(save_vis_path, vis_im)
40	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_parsing_parsenet.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	
48	    img_input = cv2.imread(img_path)
49	    # resize to 512 x 512 for better performance

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_tracking.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
31	        img_basename = os.path.basename(path)
32	        frame = cv2.imread(path)
33	        img_size = frame.shape[0:2]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/inference/inference_tracking.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	            save_path = os.path.join(args.save_folder, img_basename)
73	            cv2.imwrite(save_path, frame)
74	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/scripts/extract_detection_info_ffhq.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
38	    # save image
39	    cv2.imwrite(save_path, image)
40	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	    with open('README.md', encoding='utf-8') as f:
14	        content = f.read()
15	    return content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/setup.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	    with open('VERSION', 'r') as f:
61	        SHORT_VERSION = f.read().strip()
62	    VERSION_INFO = ', '.join([x if x.isdigit() else f'"{x}"' for x in SHORT_VERSION.split('.')])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/setup.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
65	    with open(version_file, 'w') as f:
66	        f.write(version_file_str)
67	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/setup.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
70	    with open(version_file, 'r') as f:
71	        exec(compile(f.read(), version_file, 'exec'))
72	    return locals()['__version__']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/setup.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
70	    with open(version_file, 'r') as f:
71	        exec(compile(f.read(), version_file, 'exec'))
72	    return locals()['__version__']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/facexlib-0.3.0/facexlib-0.3.0/setup.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        keywords='computer vision, face, detection, landmark, alignment',
93	        url='https://github.com/xinntao/facexlib',
94	        include_package_data=True,

--------------------------------------------------

Code scanned:
	Total lines of code: 4282
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 33.0
		High: 1.0
Files skipped (0):
