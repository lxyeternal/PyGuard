Run started:2025-04-12 15:00:34.041160

Test results:
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
278	
279	        return await self._client.request(self._page_cls, self._options)
280	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
526	        # TODO: report this error to httpx
527	        return self._client.build_request(  # pyright: ignore[reportUnknownMemberType]
528	            headers=headers,
529	            timeout=self.timeout if isinstance(options.timeout, NotGiven) else options.timeout,
530	            method=options.method,
531	            url=prepared_url,
532	            # the `Query` type that we use is incompatible with qs'
533	            # `Params` type as it needs to be typed as `Mapping[str, object]`
534	            # so that passing a `TypedDict` doesn't cause an error.
535	            # https://github.com/microsoft/pyright/issues/3526#event-6715453066
536	            params=self.qs.stringify(cast(Mapping[str, Any], params)) if params else None,
537	            json=json_data if is_given(json_data) else None,
538	            files=files,
539	            **kwargs,
540	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
681	                "Streaming is strongly recommended for operations that may take longer than 10 minutes. "
682	                + "See https://github.com/anthropics/anthropic-sdk-python#long-requests for more details",
683	            )
684	        return Timeout(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
828	        try:
829	            self.close()
830	        except Exception:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:936
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
935	        if hasattr(self, "_client"):
936	            self._client.close()
937	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
946	    ) -> None:
947	        self.close()
948	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1012	
1013	        return self._request(
1014	            cast_to=cast_to,
1015	            options=options,
1016	            stream=stream,
1017	            stream_cls=stream_cls,
1018	            retries_taken=retries_taken,
1019	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1039
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1038	        remaining_retries = options.get_max_retries(self.max_retries) - retries_taken
1039	        request = self._build_request(options, retries_taken=retries_taken)
1040	        self._prepare_request(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1039	        request = self._build_request(options, retries_taken=retries_taken)
1040	        self._prepare_request(request)
1041	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1049
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1048	        try:
1049	            response = self._client.send(
1050	                request,
1051	                stream=stream or self._should_stream_response_body(request=request),
1052	                **kwargs,
1053	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1058
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1057	            if remaining_retries > 0:
1058	                return self._retry_request(
1059	                    input_options,
1060	                    cast_to,
1061	                    retries_taken=retries_taken,
1062	                    stream=stream,
1063	                    stream_cls=stream_cls,
1064	                    response_headers=None,
1065	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1072	            if remaining_retries > 0:
1073	                return self._retry_request(
1074	                    input_options,
1075	                    cast_to,
1076	                    retries_taken=retries_taken,
1077	                    stream=stream,
1078	                    stream_cls=stream_cls,
1079	                    response_headers=None,
1080	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1100	            if remaining_retries > 0 and self._should_retry(err.response):
1101	                err.response.close()
1102	                return self._retry_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1101	                err.response.close()
1102	                return self._retry_request(
1103	                    input_options,
1104	                    cast_to,
1105	                    retries_taken=retries_taken,
1106	                    response_headers=err.response.headers,
1107	                    stream=stream,
1108	                    stream_cls=stream_cls,
1109	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1113	            if not err.response.is_closed:
1114	                err.response.read()
1115	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1150	
1151	        return self._request(
1152	            options=options,
1153	            cast_to=cast_to,
1154	            retries_taken=retries_taken + 1,
1155	            stream=stream,
1156	            stream_cls=stream_cls,
1157	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1235	
1236	        return self.request(page, options, stream=False)
1237	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1281	        # it understands the type variables
1282	        return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
1283	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1335	        )
1336	        return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
1337	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1346	        opts = FinalRequestOptions.construct(method="patch", url=path, json_data=body, **options)
1347	        return self.request(cast_to, opts)
1348	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1360	        )
1361	        return self.request(cast_to, opts)
1362	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1371	        opts = FinalRequestOptions.construct(method="delete", url=path, json_data=body, **options)
1372	        return self.request(cast_to, opts)
1373	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1431	            # TODO(someday): support non asyncio runtimes here
1432	            asyncio.get_running_loop().create_task(self.aclose())
1433	        except Exception:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1536	        """
1537	        await self._client.aclose()
1538	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1547	    ) -> None:
1548	        await self.close()
1549	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1613	
1614	        return await self._request(
1615	            cast_to=cast_to,
1616	            options=options,
1617	            stream=stream,
1618	            stream_cls=stream_cls,
1619	            retries_taken=retries_taken,
1620	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1644	        remaining_retries = options.get_max_retries(self.max_retries) - retries_taken
1645	        request = self._build_request(options, retries_taken=retries_taken)
1646	        await self._prepare_request(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1645	        request = self._build_request(options, retries_taken=retries_taken)
1646	        await self._prepare_request(request)
1647	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1652	        try:
1653	            response = await self._client.send(
1654	                request,
1655	                stream=stream or self._should_stream_response_body(request=request),
1656	                **kwargs,
1657	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1661	            if remaining_retries > 0:
1662	                return await self._retry_request(
1663	                    input_options,
1664	                    cast_to,
1665	                    retries_taken=retries_taken,
1666	                    stream=stream,
1667	                    stream_cls=stream_cls,
1668	                    response_headers=None,
1669	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1676	            if remaining_retries > 0:
1677	                return await self._retry_request(
1678	                    input_options,
1679	                    cast_to,
1680	                    retries_taken=retries_taken,
1681	                    stream=stream,
1682	                    stream_cls=stream_cls,
1683	                    response_headers=None,
1684	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1698	            if remaining_retries > 0 and self._should_retry(err.response):
1699	                await err.response.aclose()
1700	                return await self._retry_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1699	                await err.response.aclose()
1700	                return await self._retry_request(
1701	                    input_options,
1702	                    cast_to,
1703	                    retries_taken=retries_taken,
1704	                    response_headers=err.response.headers,
1705	                    stream=stream,
1706	                    stream_cls=stream_cls,
1707	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1711	            if not err.response.is_closed:
1712	                await err.response.aread()
1713	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1746	
1747	        return await self._request(
1748	            options=options,
1749	            cast_to=cast_to,
1750	            retries_taken=retries_taken + 1,
1751	            stream=stream,
1752	            stream_cls=stream_cls,
1753	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1865	        opts = FinalRequestOptions.construct(method="get", url=path, **options)
1866	        return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
1867	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1919	        )
1920	        return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
1921	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1931
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1930	        opts = FinalRequestOptions.construct(method="patch", url=path, json_data=body, **options)
1931	        return await self.request(cast_to, opts)
1932	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1945
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1944	        )
1945	        return await self.request(cast_to, opts)
1946	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:1956
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1955	        opts = FinalRequestOptions.construct(method="delete", url=path, json_data=body, **options)
1956	        return await self.request(cast_to, opts)
1957	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:2040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2039	    try:
2040	        system = platform.system().lower()
2041	        platform_name = platform.platform().lower()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:2040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
2039	    try:
2040	        system = platform.system().lower()
2041	        platform_name = platform.platform().lower()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_base_client.py:2040
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
2039	    try:
2040	        system = platform.system().lower()
2041	        platform_name = platform.platform().lower()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_client.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	        if base_url is None:
108	            base_url = f"https://api.anthropic.com"
109	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_client.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
333	        if base_url is None:
334	            base_url = f"https://api.anthropic.com"
335	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_legacy_response.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
434	    def read(self) -> bytes:
435	        return self.response.read()
436	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_legacy_response.py:463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
462	            for data in self.response.iter_bytes():
463	                f.write(data)
464	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_legacy_response.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
475	            for data in self.response.iter_bytes(chunk_size):
476	                f.write(data)
477	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_legacy_response.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
481	    async def aread(self) -> bytes:
482	        return await self.response.aread()
483	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_legacy_response.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
507	            async for data in self.response.aiter_bytes(chunk_size):
508	                await f.write(data)
509	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
344	        if not self._is_sse_stream:
345	            self.read()
346	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
359	        try:
360	            return self.http_response.read()
361	        except httpx.StreamConsumed as exc:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
368	        """Read and decode the response content into a string."""
369	        self.read()
370	        return self.http_response.text

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
373	        """Read and decode the JSON response content."""
374	        self.read()
375	        return self.http_response.json()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
451	        if not self._is_sse_stream:
452	            await self.read()
453	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
466	        try:
467	            return await self.http_response.aread()
468	        except httpx.StreamConsumed as exc:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
475	        """Read and decode the response content into a string."""
476	        await self.read()
477	        return self.http_response.text

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
480	        """Read and decode the JSON response content."""
481	        await self.read()
482	        return self.http_response.json()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
535	            for data in self.iter_bytes():
536	                f.write(data)
537	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
561	            async for data in self.iter_bytes():
562	                await f.write(data)
563	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
577	            for data in self.iter_bytes(chunk_size):
578	                f.write(data)
579	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_response.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
594	            async for data in self.iter_bytes(chunk_size):
595	                await f.write(data)
596	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_utils/_transform.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
235	
236	        return base64.b64encode(binary).decode("ascii")
237	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_utils/_transform.py:236
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
235	
236	        return base64.b64encode(binary).decode("ascii")
237	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_utils/_transform.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
383	
384	        return base64.b64encode(binary).decode("ascii")
385	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/_utils/_transform.py:384
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
383	
384	        return base64.b64encode(binary).decode("ascii")
385	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/lib/bedrock/_client.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	        if base_url is None:
148	            base_url = f"https://bedrock-runtime.{self.aws_region}.amazonaws.com"
149	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/lib/bedrock/_client.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
176	
177	        data = request.read().decode()
178	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/lib/bedrock/_client.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
291	        if base_url is None:
292	            base_url = f"https://bedrock-runtime.{self.aws_region}.amazonaws.com"
293	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/lib/bedrock/_client.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
320	
321	        data = request.read().decode()
322	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/lib/streaming/_beta_messages.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
148	    def __enter__(self) -> BetaMessageStream:
149	        raw_stream = self.__api_request()
150	        self.__stream = BetaMessageStream(raw_stream)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/lib/streaming/_messages.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
148	    def __enter__(self) -> MessageStream:
149	        raw_stream = self.__api_request()
150	        self.__stream = MessageStream(raw_stream)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/lib/vertex/_auth.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    credentials, loaded_project_id = google_auth.default(
22	        scopes=["https://www.googleapis.com/auth/cloud-platform"],
23	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/resources/beta/messages/messages.py:949
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
948	            warnings.warn(
949	                f"The model '{model}' is deprecated and will reach end-of-life on {DEPRECATED_MODELS[model]}.\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.",
950	                DeprecationWarning,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/resources/beta/messages/messages.py:2184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2183	            warnings.warn(
2184	                f"The model '{model}' is deprecated and will reach end-of-life on {DEPRECATED_MODELS[model]}.\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.",
2185	                DeprecationWarning,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/resources/messages/messages.py:948
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
947	            warnings.warn(
948	                f"The model '{model}' is deprecated and will reach end-of-life on {DEPRECATED_MODELS[model]}.\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.",
949	                DeprecationWarning,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/resources/messages/messages.py:1006
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1005	            warnings.warn(
1006	                f"The model '{model}' is deprecated and will reach end-of-life on {DEPRECATED_MODELS[model]}.\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.",
1007	                DeprecationWarning,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/resources/messages/messages.py:2160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2159	            warnings.warn(
2160	                f"The model '{model}' is deprecated and will reach end-of-life on {DEPRECATED_MODELS[model]}.\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.",
2161	                DeprecationWarning,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/src/anthropic/resources/messages/messages.py:2218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2217	            warnings.warn(
2218	                f"The model '{model}' is deprecated and will reach end-of-life on {DEPRECATED_MODELS[model]}.\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.",
2219	                DeprecationWarning,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/api_resources/beta/messages/test_batches.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/api_resources/beta/test_messages.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/api_resources/beta/test_models.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/api_resources/messages/test_batches.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/api_resources/test_completions.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	
14	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
15	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/api_resources/test_messages.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
19	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/api_resources/test_models.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
16	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/conftest.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
14	
15	pytest.register_assert_rewrite("tests.utils")
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/conftest.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
30	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/streaming/test_messages.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
18	api_key = "my-anthropic-api-key"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_bedrock.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	def test_messages_retries(respx_mock: MockRouter) -> None:
29	    respx_mock.post(re.compile(r"https://bedrock-runtime\.us-east-1\.amazonaws\.com/model/.*/invoke")).mock(
30	        side_effect=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_bedrock.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	        calls[0].request.url
53	        == "https://bedrock-runtime.us-east-1.amazonaws.com/model/anthropic.claude-3-sonnet-20240229-v1:0/invoke"
54	    )
55	    assert (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_bedrock.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        calls[1].request.url
57	        == "https://bedrock-runtime.us-east-1.amazonaws.com/model/anthropic.claude-3-sonnet-20240229-v1:0/invoke"
58	    )
59	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_bedrock.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	async def test_messages_retries_async(respx_mock: MockRouter) -> None:
64	    respx_mock.post(re.compile(r"https://bedrock-runtime\.us-east-1\.amazonaws\.com/model/.*/invoke")).mock(
65	        side_effect=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_bedrock.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	        calls[0].request.url
88	        == "https://bedrock-runtime.us-east-1.amazonaws.com/model/anthropic.claude-3-sonnet-20240229-v1:0/invoke"
89	    )
90	    assert (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_bedrock.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        calls[1].request.url
92	        == "https://bedrock-runtime.us-east-1.amazonaws.com/model/anthropic.claude-3-sonnet-20240229-v1:0/invoke"
93	    )
94	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_bedrock.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	def test_application_inference_profile(respx_mock: MockRouter) -> None:
98	    respx_mock.post(re.compile(r"https://bedrock-runtime\.us-east-1\.amazonaws\.com/model/.*/invoke")).mock(
99	        side_effect=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_bedrock.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	        calls[0].request.url
121	        == "https://bedrock-runtime.us-east-1.amazonaws.com/model/arn:aws:bedrock:us-east-1:123456789012:application-inference-profile%2Fjf2sje1c0jnb/invoke"
122	    )
123	    assert (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_bedrock.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	        calls[1].request.url
125	        == "https://bedrock-runtime.us-east-1.amazonaws.com/model/arn:aws:bedrock:us-east-1:123456789012:application-inference-profile%2Fjf2sje1c0jnb/invoke"
126	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_vertex.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
14	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_vertex.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    def test_messages_retries(self, respx_mock: MockRouter) -> None:
25	        request_url = "https://region-aiplatform.googleapis.com/v1/projects/project/locations/region/publishers/anthropic/models/claude-3-sonnet@20240229:rawPredict"
26	        respx_mock.post(request_url).mock(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/lib/test_vertex.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
128	    async def test_messages_retries(self, respx_mock: MockRouter) -> None:
129	        request_url = "https://region-aiplatform.googleapis.com/v1/projects/project/locations/region/publishers/anthropic/models/claude-3-sonnet@20240229:rawPredict"
130	        respx_mock.post(request_url).mock(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	
41	base_url = os.environ.get("TEST_API_BASE_URL", "http://127.0.0.1:4010")
42	api_key = "my-anthropic-api-key"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
45	def _get_params(client: BaseClient[Any, Any]) -> dict[str, str]:
46	    request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
47	    url = httpx.URL(request.url)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
200	            client = self.client.copy()
201	            client._build_request(options)
202	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
203	        # ensure that the machinery is warmed up before tracing starts.
204	        build_request(options)
205	        gc.collect()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
212	        for _ in range(ITERATIONS):
213	            build_request(options)
214	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
258	    def test_request_timeout(self) -> None:
259	        request = self.client._build_request(FinalRequestOptions(method="get", url="/foo"))
260	        timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
262	
263	        request = self.client._build_request(
264	            FinalRequestOptions(method="get", url="/foo", timeout=httpx.Timeout(100.0))
265	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
273	
274	        request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
275	        timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
284	
285	            request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
286	            timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
294	
295	            request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
296	            timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
304	
305	            request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
306	            timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
322	        )
323	        request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
324	        assert request.headers.get("x-foo") == "bar"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
335	        )
336	        request = client2._build_request(FinalRequestOptions(method="get", url="/foo"))
337	        assert request.headers.get("x-foo") == "stainless"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
341	        client = Anthropic(base_url=base_url, api_key=api_key, _strict_response_validation=True)
342	        request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
343	        assert request.headers.get("X-Api-Key") == api_key

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
351	        ):
352	            client2._build_request(FinalRequestOptions(method="get", url="/foo"))
353	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
353	
354	        request2 = client2._build_request(FinalRequestOptions(method="get", url="/foo", headers={"X-Api-Key": Omit()}))
355	        assert request2.headers.get("X-Api-Key") is None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
360	        )
361	        request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
362	        url = httpx.URL(request.url)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
364	
365	        request = client._build_request(
366	            FinalRequestOptions(
367	                method="get",
368	                url="/foo",
369	                params={"foo": "baz", "query_param": "overridden"},
370	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
375	    def test_request_extra_json(self) -> None:
376	        request = self.client._build_request(
377	            FinalRequestOptions(
378	                method="post",
379	                url="/foo",
380	                json_data={"foo": "bar"},
381	                extra_json={"baz": False},
382	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
386	
387	        request = self.client._build_request(
388	            FinalRequestOptions(
389	                method="post",
390	                url="/foo",
391	                extra_json={"baz": False},
392	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
397	        # `extra_json` takes priority over `json_data` when keys clash
398	        request = self.client._build_request(
399	            FinalRequestOptions(
400	                method="post",
401	                url="/foo",
402	                json_data={"foo": "bar", "baz": True},
403	                extra_json={"baz": None},
404	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
409	    def test_request_extra_headers(self) -> None:
410	        request = self.client._build_request(
411	            FinalRequestOptions(
412	                method="post",
413	                url="/foo",
414	                **make_request_options(extra_headers={"X-Foo": "Foo"}),
415	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
419	        # `extra_headers` takes priority over `default_headers` when keys clash
420	        request = self.client.with_options(default_headers={"X-Bar": "true"})._build_request(
421	            FinalRequestOptions(
422	                method="post",
423	                url="/foo",
424	                **make_request_options(
425	                    extra_headers={"X-Bar": "false"},
426	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
431	    def test_request_extra_query(self) -> None:
432	        request = self.client._build_request(
433	            FinalRequestOptions(
434	                method="post",
435	                url="/foo",
436	                **make_request_options(
437	                    extra_query={"my_query_param": "Foo"},
438	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
444	        # if both `query` and `extra_query` are given, they are merged
445	        request = self.client._build_request(
446	            FinalRequestOptions(
447	                method="post",
448	                url="/foo",
449	                **make_request_options(
450	                    query={"bar": "1"},
451	                    extra_query={"foo": "2"},
452	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
458	        # `extra_query` takes priority over `query` when keys clash
459	        request = self.client._build_request(
460	            FinalRequestOptions(
461	                method="post",
462	                url="/foo",
463	                **make_request_options(
464	                    query={"foo": "1"},
465	                    extra_query={"foo": "2"},
466	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
472	    def test_multipart_repeating_array(self, client: Anthropic) -> None:
473	        request = client._build_request(
474	            FinalRequestOptions.construct(
475	                method="get",
476	                url="/foo",
477	                headers={"Content-Type": "multipart/form-data; boundary=6b7ba517decee4a450543ea6ae821c82"},
478	                json_data={"array": ["foo", "bar"]},
479	                files=[("foo.txt", b"hello world")],
480	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
482	
483	        assert request.read().split(b"\r\n") == [
484	            b"--6b7ba517decee4a450543ea6ae821c82",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
558	    def test_base_url_setter(self) -> None:
559	        client = Anthropic(base_url="https://example.com/from_init", api_key=api_key, _strict_response_validation=True)
560	        assert client.base_url == "https://example.com/from_init/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
559	        client = Anthropic(base_url="https://example.com/from_init", api_key=api_key, _strict_response_validation=True)
560	        assert client.base_url == "https://example.com/from_init/"
561	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
561	
562	        client.base_url = "https://example.com/from_setter"  # type: ignore[assignment]
563	
564	        assert client.base_url == "https://example.com/from_setter/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
563	
564	        assert client.base_url == "https://example.com/from_setter/"
565	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
566	    def test_base_url_env(self) -> None:
567	        with update_env(ANTHROPIC_BASE_URL="http://localhost:5000/from/env"):
568	            client = Anthropic(api_key=api_key, _strict_response_validation=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
568	            client = Anthropic(api_key=api_key, _strict_response_validation=True)
569	            assert client.base_url == "http://localhost:5000/from/env/"
570	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
584	    def test_base_url_trailing_slash(self, client: Anthropic) -> None:
585	        request = client._build_request(
586	            FinalRequestOptions(
587	                method="post",
588	                url="/foo",
589	                json_data={"foo": "bar"},
590	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
591	        )
592	        assert request.url == "http://localhost:5000/custom/path/foo"
593	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
573	        [
574	            Anthropic(base_url="http://localhost:5000/custom/path/", api_key=api_key, _strict_response_validation=True),
575	            Anthropic(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
575	            Anthropic(
576	                base_url="http://localhost:5000/custom/path/",
577	                api_key=api_key,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
607	    def test_base_url_no_trailing_slash(self, client: Anthropic) -> None:
608	        request = client._build_request(
609	            FinalRequestOptions(
610	                method="post",
611	                url="/foo",
612	                json_data={"foo": "bar"},
613	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:615
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
614	        )
615	        assert request.url == "http://localhost:5000/custom/path/foo"
616	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
596	        [
597	            Anthropic(base_url="http://localhost:5000/custom/path/", api_key=api_key, _strict_response_validation=True),
598	            Anthropic(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
598	            Anthropic(
599	                base_url="http://localhost:5000/custom/path/",
600	                api_key=api_key,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
630	    def test_absolute_request_url(self, client: Anthropic) -> None:
631	        request = client._build_request(
632	            FinalRequestOptions(
633	                method="post",
634	                url="https://myapi.com/foo",
635	                json_data={"foo": "bar"},
636	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
633	                method="post",
634	                url="https://myapi.com/foo",
635	                json_data={"foo": "bar"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
637	        )
638	        assert request.url == "https://myapi.com/foo"
639	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:620
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
619	        [
620	            Anthropic(base_url="http://localhost:5000/custom/path/", api_key=api_key, _strict_response_validation=True),
621	            Anthropic(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
621	            Anthropic(
622	                base_url="http://localhost:5000/custom/path/",
623	                api_key=api_key,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1071	            client = self.client.copy()
1072	            client._build_request(options)
1073	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1075
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1074	        # ensure that the machinery is warmed up before tracing starts.
1075	        build_request(options)
1076	        gc.collect()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1084
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1083	        for _ in range(ITERATIONS):
1084	            build_request(options)
1085	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1129	    async def test_request_timeout(self) -> None:
1130	        request = self.client._build_request(FinalRequestOptions(method="get", url="/foo"))
1131	        timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1133	
1134	        request = self.client._build_request(
1135	            FinalRequestOptions(method="get", url="/foo", timeout=httpx.Timeout(100.0))
1136	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1144	
1145	        request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
1146	        timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1155	
1156	            request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
1157	            timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1165	
1166	            request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
1167	            timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1175	
1176	            request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
1177	            timeout = httpx.Timeout(**request.extensions["timeout"])  # type: ignore

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1193	        )
1194	        request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
1195	        assert request.headers.get("x-foo") == "bar"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1206	        )
1207	        request = client2._build_request(FinalRequestOptions(method="get", url="/foo"))
1208	        assert request.headers.get("x-foo") == "stainless"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1212	        client = AsyncAnthropic(base_url=base_url, api_key=api_key, _strict_response_validation=True)
1213	        request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
1214	        assert request.headers.get("X-Api-Key") == api_key

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1222	        ):
1223	            client2._build_request(FinalRequestOptions(method="get", url="/foo"))
1224	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1224	
1225	        request2 = client2._build_request(FinalRequestOptions(method="get", url="/foo", headers={"X-Api-Key": Omit()}))
1226	        assert request2.headers.get("X-Api-Key") is None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1231	        )
1232	        request = client._build_request(FinalRequestOptions(method="get", url="/foo"))
1233	        url = httpx.URL(request.url)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1235	
1236	        request = client._build_request(
1237	            FinalRequestOptions(
1238	                method="get",
1239	                url="/foo",
1240	                params={"foo": "baz", "query_param": "overridden"},
1241	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1246	    def test_request_extra_json(self) -> None:
1247	        request = self.client._build_request(
1248	            FinalRequestOptions(
1249	                method="post",
1250	                url="/foo",
1251	                json_data={"foo": "bar"},
1252	                extra_json={"baz": False},
1253	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1257	
1258	        request = self.client._build_request(
1259	            FinalRequestOptions(
1260	                method="post",
1261	                url="/foo",
1262	                extra_json={"baz": False},
1263	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1268	        # `extra_json` takes priority over `json_data` when keys clash
1269	        request = self.client._build_request(
1270	            FinalRequestOptions(
1271	                method="post",
1272	                url="/foo",
1273	                json_data={"foo": "bar", "baz": True},
1274	                extra_json={"baz": None},
1275	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1280	    def test_request_extra_headers(self) -> None:
1281	        request = self.client._build_request(
1282	            FinalRequestOptions(
1283	                method="post",
1284	                url="/foo",
1285	                **make_request_options(extra_headers={"X-Foo": "Foo"}),
1286	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1290	        # `extra_headers` takes priority over `default_headers` when keys clash
1291	        request = self.client.with_options(default_headers={"X-Bar": "true"})._build_request(
1292	            FinalRequestOptions(
1293	                method="post",
1294	                url="/foo",
1295	                **make_request_options(
1296	                    extra_headers={"X-Bar": "false"},
1297	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1302	    def test_request_extra_query(self) -> None:
1303	        request = self.client._build_request(
1304	            FinalRequestOptions(
1305	                method="post",
1306	                url="/foo",
1307	                **make_request_options(
1308	                    extra_query={"my_query_param": "Foo"},
1309	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1315	        # if both `query` and `extra_query` are given, they are merged
1316	        request = self.client._build_request(
1317	            FinalRequestOptions(
1318	                method="post",
1319	                url="/foo",
1320	                **make_request_options(
1321	                    query={"bar": "1"},
1322	                    extra_query={"foo": "2"},
1323	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1329	        # `extra_query` takes priority over `query` when keys clash
1330	        request = self.client._build_request(
1331	            FinalRequestOptions(
1332	                method="post",
1333	                url="/foo",
1334	                **make_request_options(
1335	                    query={"foo": "1"},
1336	                    extra_query={"foo": "2"},
1337	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1343	    def test_multipart_repeating_array(self, async_client: AsyncAnthropic) -> None:
1344	        request = async_client._build_request(
1345	            FinalRequestOptions.construct(
1346	                method="get",
1347	                url="/foo",
1348	                headers={"Content-Type": "multipart/form-data; boundary=6b7ba517decee4a450543ea6ae821c82"},
1349	                json_data={"array": ["foo", "bar"]},
1350	                files=[("foo.txt", b"hello world")],
1351	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1353	
1354	        assert request.read().split(b"\r\n") == [
1355	            b"--6b7ba517decee4a450543ea6ae821c82",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1430	        client = AsyncAnthropic(
1431	            base_url="https://example.com/from_init", api_key=api_key, _strict_response_validation=True
1432	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1432	        )
1433	        assert client.base_url == "https://example.com/from_init/"
1434	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1434	
1435	        client.base_url = "https://example.com/from_setter"  # type: ignore[assignment]
1436	
1437	        assert client.base_url == "https://example.com/from_setter/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1436	
1437	        assert client.base_url == "https://example.com/from_setter/"
1438	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1439	    def test_base_url_env(self) -> None:
1440	        with update_env(ANTHROPIC_BASE_URL="http://localhost:5000/from/env"):
1441	            client = AsyncAnthropic(api_key=api_key, _strict_response_validation=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1441	            client = AsyncAnthropic(api_key=api_key, _strict_response_validation=True)
1442	            assert client.base_url == "http://localhost:5000/from/env/"
1443	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1459	    def test_base_url_trailing_slash(self, client: AsyncAnthropic) -> None:
1460	        request = client._build_request(
1461	            FinalRequestOptions(
1462	                method="post",
1463	                url="/foo",
1464	                json_data={"foo": "bar"},
1465	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1466	        )
1467	        assert request.url == "http://localhost:5000/custom/path/foo"
1468	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1447	            AsyncAnthropic(
1448	                base_url="http://localhost:5000/custom/path/", api_key=api_key, _strict_response_validation=True
1449	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1450	            AsyncAnthropic(
1451	                base_url="http://localhost:5000/custom/path/",
1452	                api_key=api_key,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1484	    def test_base_url_no_trailing_slash(self, client: AsyncAnthropic) -> None:
1485	        request = client._build_request(
1486	            FinalRequestOptions(
1487	                method="post",
1488	                url="/foo",
1489	                json_data={"foo": "bar"},
1490	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1491	        )
1492	        assert request.url == "http://localhost:5000/custom/path/foo"
1493	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1472	            AsyncAnthropic(
1473	                base_url="http://localhost:5000/custom/path/", api_key=api_key, _strict_response_validation=True
1474	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1475	            AsyncAnthropic(
1476	                base_url="http://localhost:5000/custom/path/",
1477	                api_key=api_key,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1509	    def test_absolute_request_url(self, client: AsyncAnthropic) -> None:
1510	        request = client._build_request(
1511	            FinalRequestOptions(
1512	                method="post",
1513	                url="https://myapi.com/foo",
1514	                json_data={"foo": "bar"},
1515	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1512	                method="post",
1513	                url="https://myapi.com/foo",
1514	                json_data={"foo": "bar"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1516	        )
1517	        assert request.url == "https://myapi.com/foo"
1518	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1497	            AsyncAnthropic(
1498	                base_url="http://localhost:5000/custom/path/", api_key=api_key, _strict_response_validation=True
1499	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/anthropic-0.49.0/anthropic-0.49.0/tests/test_client.py:1501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1500	            AsyncAnthropic(
1501	                base_url="http://localhost:5000/custom/path/",
1502	                api_key=api_key,

--------------------------------------------------

Code scanned:
	Total lines of code: 25069
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 69.0
		High: 124.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 190.0
		High: 3.0
Files skipped (0):
