Run started:2025-04-12 12:10:56.547082

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/manager/dynamic.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
168	        log.debug("Starting thread pool with %d workers." % (workers, ))
169	        self.executor = self.Executor(workers, self.divisor, self.timeout)
170	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/manager/futures.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
69	        log.debug("Starting thread pool with %d workers." % (workers, ))
70	        self.executor = futures.ThreadPoolExecutor(workers)
71	        

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/message.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
298				with open(name, 'rb') as fp:
299					value = fp.read()
300				name = os.path.basename(name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/message.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
303			elif hasattr(data, 'read'):
304				value = data.read()
305			else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/message.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
353				with open(name, 'rb') as fp:
354					data = fp.read()
355				name = os.path.basename(name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/message.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
358			elif hasattr(data, 'read'):
359				data = data.read()
360			else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/release.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	description = "A light-weight modular mail delivery framework for Python 2.7+, 3.3+, Pypy, and Pypy3."
14	url = 'https://github.com/marrow/mailer/'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/testing.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
30		
31		def __init__(self, host='127.0.0.1', port=2526):
32			# Initialize the SMTP component.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/testing.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
75			self.join(timeout)
76			self.close()
77		

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/mailgun.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18		
19		API_URL_TMPL = "https://api.mailgun.net/v3/{domain}/messages.mime"
20		
21		def __init__(self, config): 

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/mailgun.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24			else:
25				self.keys = config.get('keys', {})
26	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/mailgun.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
41			
42			result = self.session.post(uri, auth=('api', self.keys[domain]),
43				data = {'from': message.author, 'to': list(str(i) for i in message.recipients),
44						'subject': message.subject},
45				files = {"message": ('message.mime', message.mime.as_bytes())})
46			

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/postmark.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
47	                        "Name": attachment.get_filename(),
48	                        "Content": base64.b64encode(attachment.get_payload(decode=True)),
49	                        "ContentType": attachment.get_content_type()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/postmark.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
47	                        "Name": attachment.get_filename(),
48	                        "Content": base64.b64encode(attachment.get_payload(decode=True)),
49	                        "ContentType": attachment.get_content_type()

--------------------------------------------------
>> Issue: [B321:blacklist] urllib2_Request
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/postmark.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-urllib2-request
55	    def _batchsend(self):
56	        request = urllib2.Request(
57	            "https://api.postmarkapp.com/email/batch",
58	            json.dumps(self.messages),
59	            {
60	                'Accept': "application/json",
61	                'Content-Type': "application/json",
62	                'X-Postmark-Server-Token': self.key,
63	            }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/postmark.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        request = urllib2.Request(
57	            "https://api.postmarkapp.com/email/batch",
58	            json.dumps(self.messages),
59	            {
60	                'Accept': "application/json",
61	                'Content-Type': "application/json",
62	                'X-Postmark-Server-Token': self.key,
63	            }
64	        )

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/postmark.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
66	        try:
67	            response = urllib2.urlopen(request)
68	        except (urllib2.HTTPError, urllib2.URLError) as e:

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/postmark.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
66	        try:
67	            response = urllib2.urlopen(request)
68	        except (urllib2.HTTPError, urllib2.URLError) as e:

--------------------------------------------------
>> Issue: [B321:blacklist] urllib2_Request
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/sendgrid.py:72
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-urllib2-request
71	
72	        request = urllib2.Request(
73	                "https://sendgrid.com/api/mail.send.json",
74	                urllib.urlencode(args, True)
75	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/sendgrid.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        request = urllib2.Request(
73	                "https://sendgrid.com/api/mail.send.json",
74	                urllib.urlencode(args, True)
75	            )
76	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/sendgrid.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
80	        try:
81	            response = urllib2.urlopen(request)
82	        except (urllib2.HTTPError, urllib2.URLError):

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/sendgrid.py:81
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
80	        try:
81	            response = urllib2.urlopen(request)
82	        except (urllib2.HTTPError, urllib2.URLError):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/smtp.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
25	    def __init__(self, config):
26	        self.host = native(config.get('host', '127.0.0.1'))
27	        self.tls = config.get('tls', 'optional')

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/transport/smtp.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
77	        connection.set_debuglevel(self.debug)
78	        connection.connect(self.host, self.port)
79	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/marrow/mailer/validator.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
142	    # DNS server. So we try to work around it:
143	    false_positive_ips = ['208.67.217.132']
144	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
19	version = description = url = author = ""  # Satisfy linter.
20	exec(open(os.path.join("marrow", "mailer", "release.py")).read())
21	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/setup.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	version = description = url = author = ""  # Satisfy linter.
20	exec(open(os.path.join("marrow", "mailer", "release.py")).read())
21	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_message.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
213			with tempfile.NamedTemporaryFile(mode='wb') as fh:
214				fh.write(b"foo")
215				fh.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_message.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
241			with tempfile.NamedTemporaryFile() as fh:
242				fh.write(base64.b64decode(self.gif))
243				fh.flush()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_message.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
241			with tempfile.NamedTemporaryFile() as fh:
242				fh.write(base64.b64decode(self.gif))
243				fh.flush()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_message.py:242
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
241			with tempfile.NamedTemporaryFile() as fh:
242				fh.write(base64.b64decode(self.gif))
243				fh.flush()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_message.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
255			message.rich = "Farewell cruel world."
256			message.embed('test.gif', base64.b64decode(self.gif))
257			

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_message.py:256
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
255			message.rich = "Farewell cruel world."
256			message.embed('test.gif', base64.b64decode(self.gif))
257			

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_message.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
264				def read(s):
265					return base64.b64decode(self.gif)
266			

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_message.py:265
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
264				def read(s):
265					return base64.b64decode(self.gif)
266			

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_validator.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
105		dataset = [
106				('gothcandy.com', 'a', '174.129.236.35'),
107				('a' * 64 + '.gothcandy.com', 'a', False),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_validator.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
109				('nx.example.com', 'a', False),
110				('xn--ls8h.la', 'a', '38.103.165.13'),  # IDN: (poop).la
111			]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/marrow.mailer-4.0.3/marrow.mailer-4.0.3/test/test_validator.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
114			try:
115				assert mock.lookup_domain(domain, kind, server=['8.8.8.8']) == expect
116			except DNS.DNSError:

--------------------------------------------------

Code scanned:
	Total lines of code: 3315
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 19.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 9.0
Files skipped (0):
