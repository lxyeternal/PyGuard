Run started:2025-04-12 10:19:18.527068

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/__main__.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	        print("Download {} from {}".format(dst, url))
36	        resp = requests.get(url, stream=True)
37	        resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/__main__.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	        resp.raise_for_status()
38	        length = int(resp.headers.get("Content-Length", 0))
39	        r = ReadProgress(resp.raw, length)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/__main__.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    zipfile_path = "stf-binaries.zip"
57	    cache_download("https://github.com/openatx/stf-binaries/archive/0.2.zip",
58	                   zipfile_path)
59	    zip_folder = "stf-binaries-0.2"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/__main__.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
183	        port = 8000
184	        url = "http://%s:%d/%s" % (current_ip(), port, filename)
185	        print("File URL:", url)

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/__main__.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
195	
196	        httpd = ThreadingHTTPServer(('', port), SimpleHTTPRequestHandler)
197	        httpd.serve_forever()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/__main__.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
325	            for chunk in d.sync.iter_content(remote_path):
326	                fd.write(chunk)
327	                bytes_so_far += len(chunk)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
29	    """ Returns if server is running """
30	    s = socket.socket()
31	    try:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
31	    try:
32	        s.settimeout(.1)
33	        s.connect((host, port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
32	        s.settimeout(.1)
33	        s.connect((host, port))
34	        return True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
37	    finally:
38	        s.close()
39	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
44	        self.__port = port
45	        self.__conn = self._safe_connect()
46	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:50
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
49	        adb_port = self.__port
50	        s = socket.socket()
51	        s.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, 1) # Set TCP keepalive

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
51	        s.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, 1) # Set TCP keepalive
52	        if platform.system() == "Darwin":
53	            pass

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
51	        s.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, 1) # Set TCP keepalive
52	        if platform.system() == "Darwin":
53	            pass

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
51	        s.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, 1) # Set TCP keepalive
52	        if platform.system() == "Darwin":
53	            pass

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
58	        try:
59	            s.settimeout(3) # prevent socket hang
60	            s.connect((adb_host, adb_port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
59	            s.settimeout(3) # prevent socket hang
60	            s.connect((adb_host, adb_port))
61	            s.settimeout(None)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
60	            s.connect((adb_host, adb_port))
61	            s.settimeout(None)
62	            return s

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
83	    def __del__(self):
84	        self.close()
85	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
92	            pass
93	        self.__conn.close()
94	        self.__conn = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
99	    def __exit__(self, exc_type, exc, traceback):
100	        self.close()
101	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
108	    def send(self, data: bytes) -> int:
109	        return self.conn.send(data)
110	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
117	    def read_uint32(self) -> int:
118	        data = self.read(4)
119	        return int.from_bytes(data, "little")

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
124	        while t > 0:
125	            chunk = self.conn.recv(t)
126	            if not chunk:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
133	        cmd_bytes = cmd.encode("utf-8")
134	        self.conn.send("{:04x}".format(len(cmd_bytes)).encode("utf-8") + cmd_bytes)
135	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
136	    def read_string(self, n: int) -> str:
137	        data = self.read(n).decode("utf-8", errors="replace")
138	        return data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	        while True:
158	            chunk = self.read(4096)
159	            if not chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
164	    def check_okay(self):
165	        data = self.read(4)
166	        if data == _FAIL:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
180	        if not host:
181	            host = os.environ.get("ANDROID_ADB_SERVER_HOST", "127.0.0.1")
182	        if not port:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_adb.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
205	            if timeout:
206	                _conn.conn.settimeout(timeout)
207	            return _conn

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_device.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
195	            return c
196	        output = c.read_until_close(encoding=encoding)
197	        # https://github.com/openatx/uiautomator2/issues/998

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_device.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
197	        # https://github.com/openatx/uiautomator2/issues/998
198	        c.close()
199	        if encoding:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_device.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
392	            c.check_okay()
393	            return c.read_until_close()
394	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_device.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
403	            c.check_okay()
404	            return c.read_until_close()
405	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_device.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
453	            finally:
454	                fsrc.close()
455	                stream.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_device.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
454	                fsrc.close()
455	                stream.close()
456	                event.done()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
35	def is_port_in_use(port: int) -> bool:
36	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
37	        return s.connect_ex(('127.0.0.1', port)) == 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
36	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
37	        return s.connect_ex(('127.0.0.1', port)) == 0
38	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
41	    try:
42	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
43	        s.bind(('127.0.0.1', 0))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
42	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
43	        s.bind(('127.0.0.1', 0))
44	        try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
46	        finally:
47	            s.close()
48	    except OSError:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
67	def current_ip():
68	    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
69	    try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
69	    try:
70	        s.connect(("8.8.8.8", 80))
71	        ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
69	    try:
70	        s.connect(("8.8.8.8", 80))
71	        ip = s.getsockname()[0]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
73	    except OSError:
74	        return "127.0.0.1"
75	    finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
75	    finally:
76	        s.close()
77	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
191	    def read(self, n: int) -> bytes:
192	        chunk = self.r.read(n)
193	        self.update(chunk)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
194	        if self._tmpfd:
195	            self._tmpfd.write(chunk)
196	        return chunk

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
194	        if self._tmpfd:
195	            self._tmpfd.write(chunk)
196	        return chunk

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/_utils.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
215	        zf = zipfile.ZipFile(self._fp)
216	        raw_manifest = zf.read("AndroidManifest.xml")
217	        axml = AXML(raw_manifest)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/install.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	        try:
64	            response = requests.get(url, stream=True)
65	            response.raise_for_status()  # Raise an error for HTTP errors

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/install.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	                    if chunk:  # Filter out keep-alive chunks
71	                        file.write(chunk)
72	        except requests.exceptions.RequestException as e:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/install.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
70	                    if chunk:  # Filter out keep-alive chunks
71	                        file.write(chunk)
72	        except requests.exceptions.RequestException as e:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
145	        self._finalizer.detach()
146	        self._p.send_signal(signal.SIGINT)
147	        try:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
214	        del _c
215	        message = c.conn.recv(100).decode("utf-8")
216	        print("Scrcpy:", message)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
217	        self._conn = c
218	        threading.Thread(
219	            name="scrcpy_main", target=self._copy2null, args=(c.conn,), daemon=True
220	        ).start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
223	        fh = pathlib.Path(self._filename).open("wb")
224	        threading.Thread(
225	            name="socket_copy",
226	            target=self._copy2file,
227	            args=(stream_sock, fh),
228	            daemon=True,
229	        ).start()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
237	            try:
238	                chunk = s.recv(1024)
239	                if chunk == b"":

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
247	        while True:
248	            chunk = s.recv(1 << 16)
249	            if not chunk:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
250	                break
251	            fh.write(chunk)
252	        fh.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
251	            fh.write(chunk)
252	        fh.close()
253	        print("Copy h264 stream finished", flush=True)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
256	    def _stop(self) -> bool:
257	        self._conn.close()
258	        self._done_event.wait(timeout=3.0)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
298	    def _stop(self):
299	        self._stream.send(b"\n")
300	        self._stream.read_until_close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
299	        self._stream.send(b"\n")
300	        self._stream.read_until_close()
301	        self._stream.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/screenrecord.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
300	        self._stream.read_until_close()
301	        self._stream.close()
302	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/sync.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	                while True:
135	                    chunk = r.read(4096) # should not >64k
136	                    if not chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/sync.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	                if cmd == _FAIL:
162	                    str_size = struct.unpack("<I", c.read(4))[0]
163	                    error_message = c.read_string(str_size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/sync.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
167	                elif cmd == _DATA:
168	                    chunk_size = struct.unpack("<I", c.read(4))[0]
169	                    chunk = c.read(chunk_size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/sync.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
168	                    chunk_size = struct.unpack("<I", c.read(4))[0]
169	                    chunk = c.read(chunk_size)
170	                    if len(chunk) != chunk_size:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/adbutils/sync.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
210	            for chunk in self.iter_content(src):
211	                f.write(chunk)
212	                size += len(chunk)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	BINARIES_URL = {
22	    "darwin": "https://dl.google.com/android/repository/platform-tools-latest-darwin.zip",
23	    "linux": "https://dl.google.com/android/repository/platform-tools-latest-linux.zip",
24	    "win32": "https://dl.google.com/android/repository/platform-tools-latest-windows.zip"
25	}
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    "darwin": "https://dl.google.com/android/repository/platform-tools-latest-darwin.zip",
23	    "linux": "https://dl.google.com/android/repository/platform-tools-latest-linux.zip",
24	    "win32": "https://dl.google.com/android/repository/platform-tools-latest-windows.zip"
25	}
26	
27	# https://peps.python.org/pep-0491/#file-format

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    "linux": "https://dl.google.com/android/repository/platform-tools-latest-linux.zip",
24	    "win32": "https://dl.google.com/android/repository/platform-tools-latest-windows.zip"
25	}
26	
27	# https://peps.python.org/pep-0491/#file-format
28	# https://packaging.python.org/en/latest/specifications/platform-compatibility-tags/

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	    with open(archive_name, 'wb') as handle:
48	        response = requests.get(base_url, stream=True)
49	        if not response.ok:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	                break
54	            handle.write(block)
55	    print("done")

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
66	        if fname == "adb":
67	            os.chmod(filename, 0o755)
68	        print("done")

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
66	        if fname == "adb":
67	            os.chmod(filename, 0o755)
68	        print("done")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
103	            ):
104	                shutil.rmtree(os.path.join(root, dname))
105	                print("Removing", dname)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	        with open(wheelfile, "w", encoding="UTF-8") as f:
161	            f.write("\n".join(lines))
162	        

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/build_wheel.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
169	    os.remove(os.path.join(distdir, fname))
170	    shutil.rmtree(os.path.join(distdir, packdir))
171	    

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/test_real_device/test_adb.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
7	
8	adb = adbutils.AdbClient("127.0.0.1", 5037)
9	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/test_real_device/test_device.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
231	def test_open_browser(device: AdbDevice):
232	    device.open_browser("https://example.org")
233	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/tests/adb_server.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
196	class AdbServer:
197	    def __init__(self, port: int = 7305, host: str = '127.0.0.1'):
198	        self.port = port

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/tests/adb_server.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
221	async def adb_server():
222	    host = '127.0.0.1'
223	    port = 7305

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/tests/conftest.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
15	    try:
16	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
17	            s.settimeout(0.1)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/tests/conftest.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
16	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
17	            s.settimeout(0.1)
18	            s.connect(('127.0.0.1', port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/tests/conftest.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
17	            s.settimeout(0.1)
18	            s.connect(('127.0.0.1', port))
19	        return True

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/adbutils-2.8.6/adbutils-2.8.6/tests/conftest.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
17	            s.settimeout(0.1)
18	            s.connect(('127.0.0.1', port))
19	        return True

--------------------------------------------------

Code scanned:
	Total lines of code: 3884
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 65.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 80.0
		High: 8.0
Files skipped (0):
