Run started:2025-04-12 10:18:20.771896

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/code_utils.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
128	    with open(file_name) as f:
129	        file_string = f.read()
130	    response = oai.Completion.create(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/code_utils.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	        with open(file_name) as f:
162	            file_string = f.read()
163	        code += f"""{file_name}:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/code_utils.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
237	        with open(filepath, "w") as fout:
238	            fout.write(code)
239	    # check if already running in a docker container

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/code_utils.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
251	        else:
252	            signal.signal(signal.SIGALRM, timeout_handler)
253	            try:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/code_utils.py:252
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
251	        else:
252	            signal.signal(signal.SIGALRM, timeout_handler)
253	            try:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/oai/completion.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
146	        if seed is None:
147	            shutil.rmtree(cache_path_root, ignore_errors=True)
148	            return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/oai/openai_utils.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
78	            with open(f"{key_file_path}/{openai_api_key_file}") as key_file:
79	                os.environ["OPENAI_API_KEY"] = key_file.read().strip()
80	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/oai/openai_utils.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
87	            with open(f"{key_file_path}/{aoai_api_key_file}") as key_file:
88	                os.environ["AZURE_OPENAI_API_KEY"] = key_file.read().strip()
89	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/oai/openai_utils.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
96	            with open(f"{key_file_path}/{aoai_api_base_file}") as key_file:
97	                os.environ["AZURE_OPENAI_API_BASE"] = key_file.read().strip()
98	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/retrieve_utils.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        raise NotImplementedError(
48	            f"""num_tokens_from_text() is not implemented for model {model}. See """
49	            f"""https://github.com/openai/openai-python/blob/main/chatml.md for information on how messages are """

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/retrieve_utils.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	        with open(file) as f:
130	            text = f.read()
131	        chunks += split_text_to_chunks(text, max_tokens, chunk_mode, must_break_at_empty_line)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/retrieve_utils.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	        save_path = os.path.join("/tmp/chromadb", os.path.basename(url))
167	    with requests.get(url, stream=True) as r:
168	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/autogen/retrieve_utils.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	            for chunk in r.iter_content(chunk_size=8192):
171	                f.write(chunk)
172	    return save_path

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/automl/model.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
93	    alarm_set = False
94	    if time_limit is not None and threading.current_thread() is threading.main_thread():
95	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/automl/model.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
93	    alarm_set = False
94	    if time_limit is not None and threading.current_thread() is threading.main_thread():
95	        try:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/automl/model.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
95	        try:
96	            signal.signal(signal.SIGALRM, TimeoutHandler)
97	            signal.alarm(int(time_limit) or 1)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/automl/model.py:96
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
95	        try:
96	            signal.signal(signal.SIGALRM, TimeoutHandler)
97	            signal.alarm(int(time_limit) or 1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/automl/model.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
620	            "SynapseML is not installed. Please refer to [SynapseML]"
621	            + "(https://github.com/microsoft/SynapseML) for installation instructions."
622	        )
623	        if "regression" == task:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/automl/model.py:1197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1196	            if os.path.exists(ckpt_location):
1197	                shutil.rmtree(ckpt_location)
1198	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/automl/model.py:2117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2116	            )
2117	        shutil.rmtree(train_dir, ignore_errors=True)
2118	        if weight is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/automl/spark/__init__.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    ERROR = ImportError(
22	        """Please run pip install flaml[spark]
23	    and check [here](https://spark.apache.org/docs/latest/api/python/getting_started/install.html)
24	    for more details about installing Spark."""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/searcher/blendsearch.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	            logger.info(
170	                "No low-cost partial config given to the search algorithm. "
171	                "For cost-frugal search, "
172	                "consider providing low-cost values for cost-related hps via "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/searcher/blendsearch.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
352	            # id: int -> thread: SearchThread
353	            0: SearchThread(self._ls.mode, self._gs, self.cost_attr, self._eps)
354	        }

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/searcher/blendsearch.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
484	                        self._started_from_low_cost = True
485	                    self._create_thread(config, result, self._subspace.get(trial_id, self._ls.space))
486	                # reset admissible region to ls bounding box

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/searcher/blendsearch.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
502	            obj = {k: result[k] for k in self.lexico_objectives["metrics"]}
503	        self._search_thread_pool[self._thread_count] = SearchThread(
504	            self._ls.mode,
505	            self._ls.create(
506	                config,
507	                obj,
508	                cost=result.get(self.cost_attr, 1),
509	                space=space,
510	            ),
511	            self.cost_attr,
512	            self._eps,
513	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/searcher/blendsearch.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
630	            del self._candidate_start_points[best_trial_id]
631	            self._create_thread(config, result, self._subspace.get(best_trial_id, self._ls.space))
632	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/searcher/blendsearch.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
674	                return None
675	            choice, backup = self._select_thread()
676	            config = self._search_thread_pool[choice].suggest(trial_id)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/spark/utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	    if not _have_spark:
40	        msg = """use_spark=True requires installation of PySpark. Please run pip install flaml[spark]
41	        and check [here](https://spark.apache.org/docs/latest/api/python/getting_started/install.html)
42	        for more details about installing Spark."""
43	        return False, ImportError(msg)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/spark/utils.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
169	    with open(custom_path, "w") as f:
170	        f.write(custom_code)
171	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/spark/utils.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
278	        if self._force_cancel and _have_spark:
279	            self._monitor_daemon = threading.Thread(target=self._monitor_overtime)
280	            # logger.setLevel("INFO")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/flaml/tune/tune.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
700	                    for trial in analysis.trials:
701	                        f.write(f"result: {trial.last_result}\n")
702	            return analysis

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	with open("README.md", encoding="UTF-8") as fh:
8	    long_description = fh.read()
9	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
13	with open(os.path.join(here, "flaml/version.py")) as fp:
14	    exec(fp.read(), version)
15	__version__ = version["__version__"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	with open(os.path.join(here, "flaml/version.py")) as fp:
14	    exec(fp.read(), version)
15	__version__ = version["__version__"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	    long_description_content_type="text/markdown",
30	    url="https://github.com/microsoft/FLAML",
31	    packages=setuptools.find_packages(include=["flaml*"]),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
58	                    )
59	                    f.write(ns_line)
60	                    f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	                    f.write(ns_line)
60	                    f.write("\n")
61	            elif isinstance(X, scipy.sparse.csr_matrix):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
142	        with open(os.path.join(ds_dir, fname)) as f:
143	            vw_content = f.read().splitlines()
144	            print(type(vw_content), len(vw_content))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	    def __init__(self, max_iter_num, dataset_id, ns_num, **kwargs):
202	        use_log = (kwargs.get("use_log", True),)
203	        shuffle = kwargs.get("shuffle", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
202	        use_log = (kwargs.get("use_log", True),)
203	        shuffle = kwargs.get("shuffle", False)
204	        vw_format = kwargs.get("vw_format", True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	        shuffle = kwargs.get("shuffle", False)
204	        vw_format = kwargs.get("vw_format", True)
205	        print("dataset_id", dataset_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	        self._problem_info.update(kwargs)
221	        self._fixed_hp_config = kwargs.get("fixed_hp_config", {})
222	        self.namespace_feature_dim = AutoVW.get_ns_feature_dim_from_vw_example(self.vw_examples[0])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
371	            vanilla_vw,
372	            loss_func=vw_oml_problem_args["fixed_hp_config"].get("loss_function", "squared"),
373	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
394	            autovw,
395	            loss_func=vw_oml_problem_args["fixed_hp_config"].get("loss_function", "squared"),
396	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_autovw.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
420	            autovw,
421	            loss_func=vw_oml_problem_args["fixed_hp_config"].get("loss_function", "squared"),
422	        )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/flaml-2.3.4/flaml-2.3.4/test/test_gpu.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
111	        automl = pickle.load(f)
112	    shutil.rmtree("test/data/output/")
113	    automl.predict(X_test)

--------------------------------------------------

Code scanned:
	Total lines of code: 22606
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 37.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 3.0
Files skipped (0):
