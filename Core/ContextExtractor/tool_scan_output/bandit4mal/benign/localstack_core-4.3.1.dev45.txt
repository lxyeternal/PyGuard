Run started:2025-04-12 16:31:23.053988

Test results:
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/client.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
398	        context = RequestContext()
399	        context.request = create_http_request(request)
400	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/forwarder.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	    if not endpoint_url:
242	        endpoint_url = "http://localhost.localstack.cloud"
243	    # pre-process the request args (some params are modified using botocore event handlers)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/forwarder.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
263	
264	    aws_request: AWSPreparedRequest = client._endpoint.create_request(request_dict, operation)
265	    context = RequestContext()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/forwarder.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
268	    context.region = region
269	    context.request = create_http_request(aws_request)
270	    context.service_request = parameters

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/handlers/analytics.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
45	
46	        self.aggregator.add_request(
47	            ServiceRequestInfo(
48	                service_name,
49	                operation_name,
50	                response.status_code,
51	                err_type=err_type,
52	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/handlers/cors.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	        # allow access from Web app and localhost domains
112	        "https://app.localstack.cloud",
113	        "http://app.localstack.cloud",
114	        "https://localhost",
115	        "https://localhost.localstack.cloud",
116	        # for requests from Electron apps, e.g., DynamoDB NoSQL Workbench
117	        "file://",
118	    ]
119	    # Add allowed origins for localhost domains, using different protocol/port combinations.
120	    for protocol in {"http", "https"}:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/handlers/cors.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	        "https://app.localstack.cloud",
113	        "http://app.localstack.cloud",
114	        "https://localhost",
115	        "https://localhost.localstack.cloud",
116	        # for requests from Electron apps, e.g., DynamoDB NoSQL Workbench
117	        "file://",
118	    ]
119	    # Add allowed origins for localhost domains, using different protocol/port combinations.
120	    for protocol in {"http", "https"}:
121	        for port in _get_allowed_cors_ports():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/handlers/cors.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	        "http://app.localstack.cloud",
114	        "https://localhost",
115	        "https://localhost.localstack.cloud",
116	        # for requests from Electron apps, e.g., DynamoDB NoSQL Workbench
117	        "file://",
118	    ]
119	    # Add allowed origins for localhost domains, using different protocol/port combinations.
120	    for protocol in {"http", "https"}:
121	        for port in _get_allowed_cors_ports():
122	            result.append(f"{protocol}://{LOCALHOST}:{port}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/handlers/cors.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	        "https://localhost",
115	        "https://localhost.localstack.cloud",
116	        # for requests from Electron apps, e.g., DynamoDB NoSQL Workbench
117	        "file://",
118	    ]
119	    # Add allowed origins for localhost domains, using different protocol/port combinations.
120	    for protocol in {"http", "https"}:
121	        for port in _get_allowed_cors_ports():
122	            result.append(f"{protocol}://{LOCALHOST}:{port}")
123	            result.append(f"{protocol}://{LOCALHOST_HOSTNAME}:{port}")

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/handlers/logging.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
146	                    "input_type": "Request",
147	                    "input": restore_payload(context.request),
148	                    "request_headers": dict(context.request.headers),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/handlers/validation.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
56	                try:
57	                    openapi.validate_request(WerkzeugOpenAPIRequest(context.request))
58	                    # We stop the handler at the first succeeded validation, as the other spec might not even specify

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/op_router.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
253	        if isinstance(rule, _RequestMatchingRule):
254	            rule = rule.match_request(request)
255	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/parser.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
297	    def _parse_blob(self, _, __, node: str, ___) -> bytes:
298	        return base64.b64decode(node)
299	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/parser.py:298
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
297	    def _parse_blob(self, _, __, node: str, ___) -> bytes:
298	        return base64.b64decode(node)
299	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/parser.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
573	        if shape is not None:
574	            self._parse_payload(request, shape, shape.members, uri_params, final_parsed)
575	        return operation, final_parsed

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
337	        def event_stream_serializer() -> Iterable[bytes]:
338	            yield self._encode_event_payload("initial-response")
339	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
380	                # encode the event and yield it
381	                yield self._encode_event_payload(
382	                    event_type=event_member_name, content=serialized_event_response.data
383	                )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
550	            value = value.encode(self.DEFAULT_ENCODING)
551	        return base64.b64encode(value).strip().decode(self.DEFAULT_ENCODING)
552	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:551
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
550	            value = value.encode(self.DEFAULT_ENCODING)
551	        return base64.b64encode(value).strip().decode(self.DEFAULT_ENCODING)
552	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:620
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
619	
620	        response.set_response(self._encode_payload(self._node_to_string(root, mime_type)))
621	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:891
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
890	        if operation_model.http.get("method") != "HEAD":
891	            self._serialize_payload(
892	                payload_params,
893	                response,
894	                shape,
895	                shape_members,
896	                operation_model,
897	                mime_type,
898	                request_id,
899	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
941	            body_payload = parameters.get(payload_member, b"")
942	            body_payload = self._encode_payload(body_payload)
943	            response.set_response(body_payload)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:949
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
948	                response.set_response(
949	                    self._encode_payload(
950	                        self._serialize_body_params(
951	                            body_params,
952	                            shape_members[payload_member],
953	                            operation_model,
954	                            mime_type,
955	                            request_id,
956	                        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
961	            response.set_response(
962	                self._encode_payload(
963	                    self._serialize_body_params(
964	                        parameters, shape, operation_model, mime_type, request_id
965	                    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1104	        response.set_response(
1105	            self._encode_payload(
1106	                self._serialize_body_params(
1107	                    parameters, shape, operation_model, mime_type, request_id
1108	                )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:1180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1179	        request_id_element.text = request_id
1180	        response.set_response(self._encode_payload(self._node_to_string(root, mime_type)))
1181	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:1403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1402	        payload = shape.serialization.get("payload") if shape is not None else None
1403	        if self._has_streaming_payload(payload, shape_members):
1404	            # Don't apply content-type to streaming bodies

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:1463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1462	
1463	    XML_NAMESPACE = "http://s3.amazonaws.com/doc/2006-03-01/"
1464	
1465	    def _serialize_response(

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:1488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1487	        ):
1488	            self._serialize_payload(
1489	                payload_params,
1490	                response,
1491	                shape,
1492	                shape_members,
1493	                operation_model,
1494	                mime_type,
1495	                request_id,
1496	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/protocol/serializer.py:1522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1521	
1522	        response.set_response(self._encode_payload(self._node_to_string(root, mime_type)))
1523	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/scaffold.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
543	
544	    with Pool() as pool:
545	        pool.starmap(_do_generate_code, [(service, path, doc) for service in services])

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/scaffold.py:544
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
543	
544	    with Pool() as pool:
545	        pool.starmap(_do_generate_code, [(service, path, doc) for service in services])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/serving/edge.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	        threads.append(
69	            threading.Thread(
70	                target=server.serve_forever, name=f"werkzeug-server-{host_port.port}", daemon=True
71	            )

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/serving/edge.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
68	        threads.append(
69	            threading.Thread(
70	                target=server.serve_forever, name=f"werkzeug-server-{host_port.port}", daemon=True
71	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/serving/twisted.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
170	    if asynchronous:
171	        return start_worker_thread(reactor.run)
172	    else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/serving/twisted.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
170	    if asynchronous:
171	        return start_worker_thread(reactor.run)
172	    else:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/aws/skeleton.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
153	
154	            return self.dispatch_request(serializer, context, instance)
155	        except ServiceException as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/cli/localstack.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	            # don't handle ClickExceptions, just reraise
56	            if ctx and ctx.params.get("debug"):
57	                click.echo(traceback.format_exc())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/cli/localstack.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	        except Exception as e:
60	            if ctx and ctx.params.get("debug"):
61	                click.echo(traceback.format_exc())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/cli/localstack.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	    # overwrite the config variable here to defer import of cache_dir
178	    if not os.environ.get("LOCALSTACK_VOLUME_DIR", "").strip():
179	        config.VOLUME_DIR = str(cache_dir() / "volume")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/cli/localstack.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
389	    try:
390	        health = requests.get(f"{url}/_localstack/health", timeout=2)
391	        doc = health.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/cli/localstack.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
391	        doc = health.json()
392	        services = doc.get("services", [])
393	        if format_ == "table":

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/cli/localstack.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
600	    try:
601	        response = requests.post(
602	            f"{url}/_localstack/health",
603	            json={"action": "restart"},
604	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/cli/localstack.py:758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
757	        raise CLIError(
758	            "The LocalStack CLI can only update itself if installed via PIP. "
759	            "Please follow the instructions on https://docs.localstack.cloud/ to update your CLI."
760	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/cli/localstack.py:913
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
912	def print_app() -> None:
913	    console.print("- [bold]App:[/bold] https://app.localstack.cloud")
914	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/cli/lpm.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
100	
101	        with ThreadPool(processes=parallel) as pool:
102	            pool.starmap(

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
268	def is_linux() -> bool:
269	    return platform.system() == "Linux"
270	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
268	def is_linux() -> bool:
269	    return platform.system() == "Linux"
270	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:269
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
268	def is_linux() -> bool:
269	    return platform.system() == "Linux"
270	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
272	def is_macos() -> bool:
273	    return platform.system() == "Darwin"
274	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
272	def is_macos() -> bool:
273	    return platform.system() == "Darwin"
274	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:273
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
272	def is_macos() -> bool:
273	    return platform.system() == "Darwin"
274	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
276	def is_windows() -> bool:
277	    return platform.system().lower() == "windows"
278	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
276	def is_windows() -> bool:
277	    return platform.system().lower() == "windows"
278	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:277
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
276	def is_windows() -> bool:
277	    return platform.system().lower() == "windows"
278	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
336	    with open("/proc/1/cgroup", "rt") as ifh:
337	        content = ifh.read()
338	        if "docker" in content or "buildkit" in content:

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
339	            return True
340	        os_hostname = socket.gethostname()
341	        if os_hostname and os_hostname in content:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:340
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
339	            return True
340	        os_hostname = socket.gethostname()
341	        if os_hostname and os_hostname in content:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
386	is_in_macos = is_macos()
387	default_ip = "0.0.0.0" if is_in_docker else "127.0.0.1"
388	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
386	is_in_macos = is_macos()
387	default_ip = "0.0.0.0" if is_in_docker else "127.0.0.1"
388	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
599	            ) as unprivileged_port_start:
600	                port = unprivileged_port_start.read()
601	                return int(port.strip())

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
672	            # Any others should be removed.
673	            if "0.0.0.0" in deduped_hosts:
674	                unique.append(HostAndPort(host="0.0.0.0", port=port))

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
673	            if "0.0.0.0" in deduped_hosts:
674	                unique.append(HostAndPort(host="0.0.0.0", port=port))
675	                continue

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
834	if not DOCKER_BRIDGE_IP:
835	    DOCKER_BRIDGE_IP = "172.17.0.1"
836	    if is_in_docker:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
836	    if is_in_docker:
837	        candidates = (DOCKER_BRIDGE_IP, "172.18.0.1")
838	        for ip in candidates:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/config.py:1186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1185	# bind address of local DNS server
1186	DNS_ADDRESS = os.environ.get("DNS_ADDRESS") or "0.0.0.0"
1187	# port of the local DNS server

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/constants.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
19	LOCALHOST = "localhost"
20	LOCALHOST_IP = "127.0.0.1"
21	LOCALHOST_HOSTNAME = "localhost.localstack.cloud"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/constants.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	LOCALSTACK_MAVEN_VERSION = "0.2.21"
28	MAVEN_REPO_URL = "https://repo1.maven.org/maven2"
29	
30	# URL of localstack's artifacts repository on GitHub
31	ARTIFACTS_REPO = "https://github.com/localstack/localstack-artifacts"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/constants.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	# URL of localstack's artifacts repository on GitHub
31	ARTIFACTS_REPO = "https://github.com/localstack/localstack-artifacts"
32	
33	# Artifacts endpoint
34	ASSETS_ENDPOINT = "https://assets.localstack.cloud"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/constants.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	# Artifacts endpoint
34	ASSETS_ENDPOINT = "https://assets.localstack.cloud"
35	
36	# Hugging Face endpoint for localstack
37	HUGGING_FACE_ENDPOINT = "https://huggingface.co/localstack"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/constants.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	# Hugging Face endpoint for localstack
37	HUGGING_FACE_ENDPOINT = "https://huggingface.co/localstack"
38	
39	# host to bind to when starting the services
40	BIND_HOST = "0.0.0.0"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/constants.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
39	# host to bind to when starting the services
40	BIND_HOST = "0.0.0.0"
41	
42	# root code folder
43	MODULE_MAIN_PATH = os.path.dirname(os.path.realpath(__file__))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/constants.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
129	# API endpoint for analytics events
130	API_ENDPOINT = os.environ.get("API_ENDPOINT") or "https://api.localstack.cloud/v1"
131	# new analytics API endpoint

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/constants.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	# new analytics API endpoint
132	ANALYTICS_API = os.environ.get("ANALYTICS_API") or "https://analytics.localstack.cloud/v1"
133	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/deprecations.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
193	        "2.0.0",
194	        "This configuration is obsolete with the new lambda provider "
195	        "https://docs.localstack.cloud/user-guide/aws/lambda/#migrating-to-lambda-v2\n"
196	        "Please mount the Docker socket /var/run/docker.sock as a volume when starting LocalStack.",
197	    ),
198	    EnvVarDeprecation(
199	        "LAMBDA_STAY_OPEN_MODE",
200	        "2.0.0",
201	        "Stay open mode is the default behavior in the new lambda provider "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/deprecations.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
200	        "2.0.0",
201	        "Stay open mode is the default behavior in the new lambda provider "
202	        "https://docs.localstack.cloud/user-guide/aws/lambda/#migrating-to-lambda-v2",
203	    ),
204	    EnvVarDeprecation(
205	        "LAMBDA_REMOTE_DOCKER",
206	        "2.0.0",
207	        "The new lambda provider copies zip files by default and automatically configures hot reloading "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/deprecations.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
206	        "2.0.0",
207	        "The new lambda provider copies zip files by default and automatically configures hot reloading "
208	        "https://docs.localstack.cloud/user-guide/aws/lambda/#migrating-to-lambda-v2",
209	    ),
210	    EnvVarDeprecation(
211	        "LAMBDA_CODE_EXTRACT_TIME",
212	        "2.0.0",
213	        "Function creation now happens asynchronously in the new lambda provider "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/deprecations.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	        "2.0.0",
213	        "Function creation now happens asynchronously in the new lambda provider "
214	        "https://docs.localstack.cloud/user-guide/aws/lambda/#migrating-to-lambda-v2",
215	    ),
216	    EnvVarDeprecation(
217	        "LAMBDA_CONTAINER_REGISTRY",
218	        "2.0.0",
219	        "The new lambda provider uses LAMBDA_RUNTIME_IMAGE_MAPPING instead "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/deprecations.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	        "2.0.0",
219	        "The new lambda provider uses LAMBDA_RUNTIME_IMAGE_MAPPING instead "
220	        "https://docs.localstack.cloud/user-guide/aws/lambda/#migrating-to-lambda-v2",
221	    ),
222	    EnvVarDeprecation(
223	        "LAMBDA_FALLBACK_URL",
224	        "2.0.0",
225	        "This feature is not supported in the new lambda provider "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/deprecations.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
224	        "2.0.0",
225	        "This feature is not supported in the new lambda provider "
226	        "https://docs.localstack.cloud/user-guide/aws/lambda/#migrating-to-lambda-v2",
227	    ),
228	    EnvVarDeprecation(
229	        "LAMBDA_FORWARD_URL",
230	        "2.0.0",
231	        "This feature is not supported in the new lambda provider "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/deprecations.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
230	        "2.0.0",
231	        "This feature is not supported in the new lambda provider "
232	        "https://docs.localstack.cloud/user-guide/aws/lambda/#migrating-to-lambda-v2",
233	    ),
234	    EnvVarDeprecation(
235	        "LAMBDA_XRAY_INIT",
236	        "2.0.0",
237	        "The X-Ray daemon is always initialized in the new lambda provider "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/deprecations.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
236	        "2.0.0",
237	        "The X-Ray daemon is always initialized in the new lambda provider "
238	        "https://docs.localstack.cloud/user-guide/aws/lambda/#migrating-to-lambda-v2",
239	    ),
240	    EnvVarDeprecation(
241	        "KINESIS_INITIALIZE_STREAMS",
242	        "1.4.0",
243	        "This option has no effect anymore. Please use the AWS client and init hooks instead.",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/deprecations.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
252	        "3.0.0",
253	        "This option is ignored because the legacy Lambda provider (v1) has been removed since 3.0.0. "
254	        "Please remove PROVIDER_OVERRIDE_LAMBDA and migrate to our new Lambda provider (v2): "
255	        "https://docs.localstack.cloud/user-guide/aws/lambda/#migrating-to-lambda-v2",
256	    ),
257	    EnvVarDeprecation(
258	        "ES_CUSTOM_BACKEND",
259	        "0.14.0",
260	        "This option has no effect anymore. Please use OPENSEARCH_CUSTOM_BACKEND instead.",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dev/kubernetes/__main__.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
221	    with open(path, "w") as f:
222	        f.write(yaml.dump(content))
223	        f.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dev/kubernetes/__main__.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
318	    print("2. Once the cluster is created, start LocalStack with the generated overrides:")
319	    print("\n    helm repo add localstack https://localstack.github.io/helm-charts # (if required)")
320	    print(

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dev/run/configurators.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
108	            file.write_text(self.script, newline="\n", encoding="utf-8")
109	            file.chmod(0o777)
110	        cfg.volumes.add(BindMount(str(file), f"/tmp/{file.name}"))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dev/run/configurators.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
374	    with gzip.open(cache_file, mode="rt") as fd:
375	        return fd.read().splitlines(keepends=False)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
65	
66	DEFAULT_FALLBACK_DNS_SERVER = "8.8.8.8"
67	FALLBACK_DNS_LOCK = threading.RLock()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
633	        upstream_dns: str,
634	        host: str = "0.0.0.0",
635	    ) -> None:
636	        super().__init__(port, host)
637	        self.resolver = Resolver(upstream_dns=upstream_dns)
638	        self.protocols = protocols
639	        self.servers = []

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
667	            request = dns.message.make_query("localhost.localstack.cloud", "A")
668	            answers = dns.query.udp(request, "127.0.0.1", port=self.port, timeout=0.5).answer
669	            return len(answers) > 0

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
675	        for server in self.servers:
676	            server.start_thread()
677	        LOG.debug("DNS Server started")

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
716	        port: int = 53,
717	        host: str = "0.0.0.0",
718	    ) -> None:
719	        super().__init__(port, host)
720	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:731
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
730	            request = dns.message.make_query("localhost.localstack.cloud", "A")
731	            answers = dns.query.udp(request, "127.0.0.1", port=self.port, timeout=0.5).answer
732	            return len(answers) > 0

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
764	        # we do not want to include localhost here, or a loop might happen
765	        candidates = [r for r in resolver.nameservers if r != "127.0.0.1"]
766	        result = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
813	        with file_path.open("r+") as outfile:
814	            PREVIOUS_RESOLV_CONF_FILE = outfile.read()
815	            previous_resolv_conf_without_nameservers = [

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
820	            outfile.seek(0)
821	            outfile.write(content)
822	            outfile.write("\n".join(previous_resolv_conf_without_nameservers))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
821	            outfile.write(content)
822	            outfile.write("\n".join(previous_resolv_conf_without_nameservers))
823	            outfile.truncate()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
843	        with file_path.open("w") as outfile:
844	            outfile.write(PREVIOUS_RESOLV_CONF_FILE)
845	    except Exception:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/dns/server.py:952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
951	    if in_docker():
952	        host = "0.0.0.0"
953	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/http/duplex_socket.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
37	            peek_bytes = 5
38	            first_bytes = newsock.recv(peek_bytes, socket.MSG_PEEK)
39	            if len(first_bytes or "") != peek_bytes:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/http/duplex_socket.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
49	            newsock.setblocking(1)
50	            newsock.settimeout(1)
51	            try:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/core.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
60	        target_path = self._get_install_marker_path(target_directory)
61	        download(download_url, target_path)
62	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/core.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
146	        self.github_tag_url = (
147	            f"https://api.github.com/repos/{github_slug}/releases/tags/{self.version}"
148	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/core.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
154	        headers = None
155	        gh_token = os.environ.get("GITHUB_API_TOKEN")
156	        if gh_token:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/core.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	            headers = {"authorization": f"Bearer {gh_token}"}
158	        response = requests.get(self.github_tag_url, headers=headers)
159	        if not response.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/core.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        download_url = None
165	        for asset in github_release.get("assets", []):
166	            # find the correct binary in the release

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/ffmpeg.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	FFMPEG_STATIC_BIN_URL = (
9	    "https://www.johnvansickle.com/ffmpeg/releases/ffmpeg-{version}-{arch}-static.tar.xz"
10	)
11	
12	
13	class FfmpegPackage(Package):
14	    def __init__(self):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/java.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	
67	        ld_library_path = ld_library_path or os.environ.get("LD_LIBRARY_PATH")
68	        # null paths (e.g. `:/foo`) have a special meaning according to the manpages

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/java.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	        endpoint = (
165	            f"https://api.adoptium.net/v3/assets/latest/{self.version}/hotspot?"
166	            f"os={self.os_name}&architecture={self.arch}&image_type=jdk"
167	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/java.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	        # Override user-agent because Adoptium API denies service to `requests` library
169	        response = requests.get(endpoint, headers={"user-agent": USER_AGENT_STRING}).json()
170	        return response[0]["binary"]["package"]["link"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/java.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	        return (
186	            f"https://github.com/adoptium/temurin{self.version}-binaries/releases/download/{tag_slug}/"
187	            f"OpenJDK{self.version}U-jdk_{self.arch}_{self.os_name}_hotspot_{semver_safe}.tar.gz"
188	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/terraform.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	TERRAFORM_URL_TEMPLATE = (
12	    "https://releases.hashicorp.com/terraform/{version}/terraform_{version}_{os}_{arch}.zip"
13	)
14	
15	
16	class TerraformPackage(Package):
17	    def __init__(self):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/terraform.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
31	    def _get_download_url(self) -> str:
32	        system = platform.system().lower()
33	        arch = get_arch()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/terraform.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
31	    def _get_download_url(self) -> str:
32	        system = platform.system().lower()
33	        arch = get_arch()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/packages/terraform.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
31	    def _get_download_url(self) -> str:
32	        system = platform.system().lower()
33	        arch = get_arch()

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/runtime/init.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
107	        with open(path, "rb") as fd:
108	            exec(fd.read(), {})
109	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/runtime/init.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	        with open(path, "rb") as fd:
108	            exec(fd.read(), {})
109	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/runtime/main.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
75	
76	    signal.signal(signal.SIGINT, _terminate_localstack)
77	    signal.signal(signal.SIGTERM, _terminate_localstack)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/runtime/main.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
75	
76	    signal.signal(signal.SIGINT, _terminate_localstack)
77	    signal.signal(signal.SIGTERM, _terminate_localstack)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/runtime/main.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
76	    signal.signal(signal.SIGINT, _terminate_localstack)
77	    signal.signal(signal.SIGTERM, _terminate_localstack)
78	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/runtime/main.py:77
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
76	    signal.signal(signal.SIGINT, _terminate_localstack)
77	    signal.signal(signal.SIGTERM, _terminate_localstack)
78	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/runtime/runtime.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
56	
57	        self._init_filesystem()
58	        self._on_starting()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/runtime/runtime.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	        #  if the runtime shuts down beforehand
66	        threading.Thread(target=self._run_ready_monitor, daemon=True).start()
67	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/runtime/runtime.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	        # we don't know yet why, but shutdown does not work on the main thread
83	        threading.Thread(target=self.shutdown, name="Runtime-Shutdown").start()
84	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/helpers.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
482	    """Import an API from an OpenAPI spec document"""
483	    body = parse_json_or_yaml(to_str(request["body"].read()))
484	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/context.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
187	            # we string encode our base64 as string as well
188	            return to_str(base64.b64encode(self.data))
189	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/context.py:188
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
187	            # we string encode our base64 as string as well
188	            return to_str(base64.b64encode(self.data))
189	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	        # }
100	        request_params = context.integration.get("requestParameters", {})
101	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	
170	        auth_context_authorizer = context.auth_context.get("authorizer") or {}
171	        for k, v in auth_context_authorizer.items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
199	        # }
200	        integration_responses = context.integration.get("integrationResponses", {})
201	        # XXX Fix for other status codes context.response contains a response status code, but response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
202	        # can be a LambdaResponse or Response object and the field is not the same, normalize it or use introspection
203	        response_params = integration_responses.get("200", {}).get("responseParameters", {})
204	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
202	        # can be a LambdaResponse or Response object and the field is not the same, normalize it or use introspection
203	        response_params = integration_responses.get("200", {}).get("responseParameters", {})
204	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	def select_integration_response(matched_part: str, invocation_context: ApiInvocationContext):
249	    int_responses = invocation_context.integration.get("integrationResponses") or {}
250	    if select_by_pattern := [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	        for response in int_responses.values()
253	        if response.get("selectionPattern")
254	        and re.match(response.get("selectionPattern"), matched_part)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
253	        if response.get("selectionPattern")
254	        and re.match(response.get("selectionPattern"), matched_part)
255	    ]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	        default_responses = [
266	            response for response in int_responses.values() if not response.get("selectionPattern")
267	        ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
308	        response = api_gateway_client.get_stage(restApiId=context.api_id, stageName=context.stage)
309	        return response.get("variables", {})
310	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
374	    target_resource = list(filter(lambda res: res["id"] == resource_id, resources))[0]
375	    path_part = target_resource.get("pathPart", "")
376	    if path_suffix:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
380	        path_suffix = path_part
381	    parent_id = target_resource.get("parentId")
382	    if not parent_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
397	    for resource in resources["items"]:
398	        path = resource.get("path")
399	        # TODO: check if this is still required in the general case (can we rely on "path" being

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
439	    for match in matches:
440	        match_methods = list(match[1].get("resourceMethods", {}).keys())
441	        # only look for path matches if the request method is in the resource

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
564	        return None
565	    methods = resource.get("resourceMethods") or {}
566	    return methods.get(invocation_context.method.upper()) or methods.get("ANY")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
565	    methods = resource.get("resourceMethods") or {}
566	    return methods.get(invocation_context.method.upper()) or methods.get("ANY")
567	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
565	    methods = resource.get("resourceMethods") or {}
566	    return methods.get(invocation_context.method.upper()) or methods.get("ANY")
567	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
597	
598	    source_ip = invocation_context.auth_identity.get("sourceIp")
599	    integration_uri = integration_uri or ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
612	            "sourceIp": source_ip,
613	            "userAgent": headers.get("User-Agent"),
614	        },

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
621	
622	    if invocation_context.is_websocket_request():
623	        request_context["connectionId"] = invocation_context.connection_id

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
649	    # skip if this is a websocket request
650	    if invocation_context.is_websocket_request():
651	        return invocation_context

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
656	    path_match = re.search(PATH_REGEX_USER_REQUEST, path)
657	    host_header = headers.get(HEADER_LOCALSTACK_EDGE_URL, "") or headers.get("Host") or ""
658	    host_match = re.search(HOST_REGEX_EXECUTE_API, host_header)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/helpers.py:657
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
656	    path_match = re.search(PATH_REGEX_USER_REQUEST, path)
657	    host_header = headers.get(HEADER_LOCALSTACK_EDGE_URL, "") or headers.get("Host") or ""
658	    host_match = re.search(HOST_REGEX_EXECUTE_API, host_header)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	    ):
96	        for k, v in integration_params.get("headers").items():
97	            headers.update({k: v})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	        integration = invocation_context.integration
104	        integration_responses = integration.get("integrationResponses") or {}
105	        if not integration_responses:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	            return_code = entries[0]
114	        response_params = integration_responses[return_code].get("responseParameters", {})
115	        for key, value in response_params.items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	        integration = invocation_context.integration
125	        template_selection_expression = integration.get("templateSelectionExpression")
126	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	        if not template_selection_expression:
131	            content_type = invocation_context.headers.get(HEADER_CONTENT_TYPE, APPLICATION_JSON)
132	            if integration.get("RequestTemplates", {}).get(content_type):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	            content_type = invocation_context.headers.get(HEADER_CONTENT_TYPE, APPLICATION_JSON)
132	            if integration.get("RequestTemplates", {}).get(content_type):
133	                return content_type

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	            content_type = invocation_context.headers.get(HEADER_CONTENT_TYPE, APPLICATION_JSON)
132	            if integration.get("RequestTemplates", {}).get(content_type):
133	                return content_type

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	        region_name=extract_region_from_arn(function_arn),
199	        role_arn=invocation_context.integration.get("credentials"),
200	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	    )
208	    if payload := inv_result.get("Payload"):
209	        payload = to_str(payload.read())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
242	
243	        response.status_code = int(parsed_result.get("statusCode", 200))
244	        parsed_headers = parsed_result.get("headers", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
243	        response.status_code = int(parsed_result.get("statusCode", 200))
244	        parsed_headers = parsed_result.get("headers", {})
245	        if parsed_headers is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
247	        try:
248	            result_body = parsed_result.get("body")
249	            if isinstance(result_body, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	                body_bytes = to_bytes(to_str(result_body or ""))
253	                if parsed_result.get("isBase64Encoded", False):
254	                    body_bytes = base64.b64decode(body_bytes)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
253	                if parsed_result.get("isBase64Encoded", False):
254	                    body_bytes = base64.b64decode(body_bytes)
255	                response._content = body_bytes

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:254
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
253	                if parsed_result.get("isBase64Encoded", False):
254	                    body_bytes = base64.b64decode(body_bytes)
255	                response._content = body_bytes

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
258	            response._content = "{}"
259	        response.multi_value_headers = parsed_result.get("multiValueHeaders") or {}
260	        return response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	    def fix_proxy_path_params(path_params):
264	        proxy_path_param_value = path_params.get("proxy+")
265	        if not proxy_path_param_value:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
340	            )
341	            asynchronous = invocation_context.headers.get("X-Amz-Invocation-Type") == "'Event'"
342	            return call_lambda(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	        uri = (
359	            invocation_context.integration.get("uri")
360	            or invocation_context.integration.get("integrationUri")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
359	            invocation_context.integration.get("uri")
360	            or invocation_context.integration.get("integrationUri")
361	            or ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
412	
413	        response.status_code = int(parsed_result.get("statusCode", 200))
414	        parsed_headers = parsed_result.get("headers", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
413	        response.status_code = int(parsed_result.get("statusCode", 200))
414	        parsed_headers = parsed_result.get("headers", {})
415	        if parsed_headers is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
417	        try:
418	            result_body = parsed_result.get("body")
419	            if isinstance(result_body, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
422	                body_bytes = to_bytes(result_body or "")
423	                if parsed_result.get("isBase64Encoded", False):
424	                    body_bytes = base64.b64decode(body_bytes)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
423	                if parsed_result.get("isBase64Encoded", False):
424	                    body_bytes = base64.b64decode(body_bytes)
425	                response._content = body_bytes

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:424
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
423	                if parsed_result.get("isBase64Encoded", False):
424	                    body_bytes = base64.b64decode(body_bytes)
425	                response._content = body_bytes

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
428	            response._content = "{}"
429	        response.multi_value_headers = parsed_result.get("multiValueHeaders") or {}
430	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
444	        integration_parameters = self.request_params_resolver.resolve(context=invocation_context)
445	        headers.update(integration_parameters.get("headers", {}))
446	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
453	        # Websockets
454	        if invocation_context.is_websocket_request():
455	            template_key = self.render_template_selection_expression(invocation_context)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
453	        # Websockets
454	        if invocation_context.is_websocket_request():
455	            template_key = self.render_template_selection_expression(invocation_context)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
459	
460	        asynchronous = headers.get("X-Amz-Invocation-Type", "").strip("'") == "Event"
461	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
493	        uri = (
494	            invocation_context.integration.get("uri")
495	            or invocation_context.integration.get("integrationUri")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
494	            invocation_context.integration.get("uri")
495	            or invocation_context.integration.get("integrationUri")
496	            or ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
507	        integration = invocation_context.integration
508	        integration_type_orig = integration.get("type") or integration.get("integrationType") or ""
509	        integration_type = integration_type_orig.upper()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
507	        integration = invocation_context.integration
508	        integration_type_orig = integration.get("type") or integration.get("integrationType") or ""
509	        integration_type = integration_type_orig.upper()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
509	        integration_type = integration_type_orig.upper()
510	        uri = integration.get("uri") or integration.get("integrationUri") or ""
511	        integration_subtype = integration.get("integrationSubtype")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
509	        integration_type = integration_type_orig.upper()
510	        uri = integration.get("uri") or integration.get("integrationUri") or ""
511	        integration_subtype = integration.get("integrationSubtype")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
510	        uri = integration.get("uri") or integration.get("integrationUri") or ""
511	        integration_subtype = integration.get("integrationSubtype")
512	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
537	            # Websockets
538	            if invocation_context.is_websocket_request():
539	                template_key = self.render_template_selection_expression(invocation_context)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
537	            # Websockets
538	            if invocation_context.is_websocket_request():
539	                template_key = self.render_template_selection_expression(invocation_context)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
556	            region_name=invocation_context.region_name,
557	            role_arn=invocation_context.integration.get("credentials"),
558	            source_arn=get_source_arn(invocation_context),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
561	
562	        result = common.make_http_request(
563	            url=config.internal_service_url(), data=payload, headers=headers, method="POST"
564	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
561	
562	        result = common.make_http_request(
563	            url=config.internal_service_url(), data=payload, headers=headers, method="POST"
564	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
575	        # https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations-aws-services-reference.html#Kinesis-PutRecord
576	        stream_name = request_parameters.get("StreamName")
577	        partition_key = request_parameters.get("PartitionKey")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
576	        stream_name = request_parameters.get("StreamName")
577	        partition_key = request_parameters.get("PartitionKey")
578	        data = request_parameters.get("Data")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
577	        partition_key = request_parameters.get("PartitionKey")
578	        data = request_parameters.get("Data")
579	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
591	    ) -> Dict[str, Any]:
592	        request_parameters = invocation_context.integration.get("requestParameters", {})
593	        self._validate_required_params(request_parameters)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
604	
605	        if invocation_context.headers.get("Content-Type") == "application/json":
606	            variables["request"]["body"] = json.loads(invocation_context.data_as_string())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
612	        payload = {
613	            "StreamName": VtlTemplate().render_vtl(request_parameters.get("StreamName"), variables),
614	            "Data": VtlTemplate().render_vtl(request_parameters.get("Data"), variables),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
613	            "StreamName": VtlTemplate().render_vtl(request_parameters.get("StreamName"), variables),
614	            "Data": VtlTemplate().render_vtl(request_parameters.get("Data"), variables),
615	            "PartitionKey": VtlTemplate().render_vtl(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
615	            "PartitionKey": VtlTemplate().render_vtl(
616	                request_parameters.get("PartitionKey"), variables
617	            ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
621	            payload["ExplicitHashKey"] = VtlTemplate().render_vtl(
622	                request_parameters.get("ExplicitHashKey"), variables
623	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
625	            payload["SequenceNumberForOrdering"] = VtlTemplate().render_vtl(
626	                request_parameters.get("SequenceNumberForOrdering"), variables
627	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
639	        integration = invocation_context.integration
640	        uri = integration.get("uri") or integration.get("integrationUri") or ""
641	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
639	        integration = invocation_context.integration
640	        uri = integration.get("uri") or integration.get("integrationUri") or ""
641	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
651	            region_name=invocation_context.region_name,
652	            role_arn=invocation_context.integration.get("credentials"),
653	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
673	
674	        status_code = response.get("ResponseMetadata", {}).get("HTTPStatusCode", 200)
675	        # apply response templates

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
673	
674	        status_code = response.get("ResponseMetadata", {}).get("HTTPStatusCode", 200)
675	        # apply response templates

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:698
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
697	        relative_path, query_string_params = extract_query_string_params(path=invocation_path)
698	        uri = integration.get("uri") or integration.get("integrationUri") or ""
699	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:698
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
697	        relative_path, query_string_params = extract_query_string_params(path=invocation_path)
698	        uri = integration.get("uri") or integration.get("integrationUri") or ""
699	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
745	
746	        if object.get("ContentType"):
747	            headers["Content-Type"] = object["ContentType"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
749	        # stream used so large files do not fill memory
750	        if body := object.get("Body"):
751	            response = request_response_stream(stream=body, headers=headers)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
771	        relative_path, query_string_params = extract_query_string_params(path=invocation_path)
772	        uri = integration.get("uri") or integration.get("integrationUri") or ""
773	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:772
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
771	        relative_path, query_string_params = extract_query_string_params(path=invocation_path)
772	        uri = integration.get("uri") or integration.get("integrationUri") or ""
773	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:776
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
775	        integration_parameters = self.request_params_resolver.resolve(context=invocation_context)
776	        headers.update(integration_parameters.get("headers", {}))
777	        self._set_http_apigw_headers(headers, invocation_context)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
784	            instance = (instances or [None])[0]
785	            if instance and instance.get("Id"):
786	                uri = "http://%s/%s" % (instance["Id"], invocation_path.lstrip("/"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
785	            if instance and instance.get("Id"):
786	                uri = "http://%s/%s" % (instance["Id"], invocation_path.lstrip("/"))
787	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
814	        )
815	        result = requests.request(method=method, url=uri, data=payload, headers=headers)
816	        if not result.ok:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
814	        )
815	        result = requests.request(method=method, url=uri, data=payload, headers=headers)
816	        if not result.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
832	        integration = invocation_context.integration
833	        uri = integration.get("uri") or integration.get("integrationUri") or ""
834	        account_id, queue = uri.split("/")[-2:]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
832	        integration = invocation_context.integration
833	        uri = integration.get("uri") or integration.get("integrationUri") or ""
834	        account_id, queue = uri.split("/")[-2:]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
839	            region_name=region_name,
840	            role_arn=invocation_context.integration.get("credentials"),
841	            source_arn=get_source_arn(invocation_context),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
845	        integration_parameters = self.request_params_resolver.resolve(context=invocation_context)
846	        headers.update(integration_parameters.get("headers", {}))
847	        if "Accept" not in headers:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
849	
850	        if invocation_context.is_websocket_request():
851	            template_key = self.render_template_selection_expression(invocation_context)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
849	
850	        if invocation_context.is_websocket_request():
851	            template_key = self.render_template_selection_expression(invocation_context)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
864	        url = urljoin(config.internal_service_url(), f"/queue/{region_name}/{account_id}/{queue}")
865	        response = common.make_http_request(url, method="POST", headers=headers, data=new_request)
866	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
864	        url = urljoin(config.internal_service_url(), f"/queue/{region_name}/{account_id}/{queue}")
865	        response = common.make_http_request(url, method="POST", headers=headers, data=new_request)
866	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:879
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
878	        integration = invocation_context.integration
879	        uri = integration.get("uri") or integration.get("integrationUri") or ""
880	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:879
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
878	        integration = invocation_context.integration
879	        uri = integration.get("uri") or integration.get("integrationUri") or ""
880	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
881	        try:
882	            if invocation_context.is_websocket_request():
883	                template_key = self.render_template_selection_expression(invocation_context)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
881	        try:
882	            if invocation_context.is_websocket_request():
883	                template_key = self.render_template_selection_expression(invocation_context)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
893	        )
894	        response = make_http_request(
895	            config.internal_service_url(), method="POST", headers=headers, data=payload
896	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
893	        )
894	        response = make_http_request(
895	            config.internal_service_url(), method="POST", headers=headers, data=payload
896	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
908	        # stateMachineArn and input are required
909	        state_machine_arn_param = request_parameters.get("StateMachineArn")
910	        input_param = request_parameters.get("Input")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
909	        state_machine_arn_param = request_parameters.get("StateMachineArn")
910	        input_param = request_parameters.get("Input")
911	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
919	        uri = (
920	            invocation_context.integration.get("uri")
921	            or invocation_context.integration.get("integrationUri")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
920	            invocation_context.integration.get("uri")
921	            or invocation_context.integration.get("integrationUri")
922	            or ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
925	
926	        if invocation_context.integration.get("IntegrationType") == "AWS_PROXY":
927	            payload = self._create_request_parameters(invocation_context)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
927	            payload = self._create_request_parameters(invocation_context)
928	        elif APPLICATION_JSON in invocation_context.integration.get("requestTemplates", {}):
929	            payload = self.request_templates.render(invocation_context)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:936
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
935	            region_name=invocation_context.region_name,
936	            role_arn=invocation_context.integration.get("credentials"),
937	        ).stepfunctions

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
938	
939	        if isinstance(payload.get("input"), dict):
940	            payload["input"] = json.dumps(payload["input"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:973
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
972	            result = await_sfn_execution_result(result["executionArn"])
973	            result_status = result.get("status")
974	            if result_status != "SUCCEEDED":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:995
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
994	    def _create_request_parameters(self, invocation_context):
995	        request_parameters = invocation_context.integration.get("requestParameters", {})
996	        self._validate_required_params(request_parameters)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1006	        }
1007	        rendered_input = VtlTemplate().render_vtl(request_parameters.get("Input"), variables)
1008	        return {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1008	        return {
1009	            "stateMachineArn": request_parameters.get("StateMachineArn"),
1010	            "input": rendered_input,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1019	    def invoke(self, invocation_context: ApiInvocationContext) -> Response:
1020	        passthrough_behavior = invocation_context.integration.get("passthroughBehavior") or ""
1021	        request_template = invocation_context.integration.get("requestTemplates", {}).get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1020	        passthrough_behavior = invocation_context.integration.get("passthroughBehavior") or ""
1021	        request_template = invocation_context.integration.get("requestTemplates", {}).get(
1022	            invocation_context.headers.get(HEADER_CONTENT_TYPE, APPLICATION_JSON)
1023	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1020	        passthrough_behavior = invocation_context.integration.get("passthroughBehavior") or ""
1021	        request_template = invocation_context.integration.get("requestTemplates", {}).get(
1022	            invocation_context.headers.get(HEADER_CONTENT_TYPE, APPLICATION_JSON)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1022
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1021	        request_template = invocation_context.integration.get("requestTemplates", {}).get(
1022	            invocation_context.headers.get(HEADER_CONTENT_TYPE, APPLICATION_JSON)
1023	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1040	        status_code = 200
1041	        if invocation_context.headers.get(HEADER_CONTENT_TYPE) == APPLICATION_JSON:
1042	            try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1043	                mock_response = json.loads(request_payload)
1044	                status_code = mock_response.get("statusCode", status_code)
1045	            except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1060	        response = self.apply_response_parameters(invocation_context, response)
1061	        if not invocation_context.headers.get(HEADER_CONTENT_TYPE):
1062	            invocation_context.headers.update({HEADER_CONTENT_TYPE: APPLICATION_JSON})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1070
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1069	):
1070	    request_parameters = integration.get("requestParameters")
1071	    uri = uri or integration.get("uri") or integration.get("integrationUri") or ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1070	    request_parameters = integration.get("requestParameters")
1071	    uri = uri or integration.get("uri") or integration.get("integrationUri") or ""
1072	    if request_parameters:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1070	    request_parameters = integration.get("requestParameters")
1071	    uri = uri or integration.get("uri") or integration.get("integrationUri") or ""
1072	    if request_parameters:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1076	            request_param_value = f"method.request.path.{key}"
1077	            if request_parameters.get(request_param_key) == request_param_value:
1078	                uri = uri.replace(f"{{{key}}}", path_params[key])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1080
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1079	
1080	    if integration.get("type") != "HTTP_PROXY" and request_parameters:
1081	        for key in query_params.copy():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1084
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1083	            request_param_val = f"method.request.querystring.{key}"
1084	            if request_parameters.get(request_query_key, None) != request_param_val:
1085	                query_params.pop(key)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1098	        uri = (
1099	            invocation_context.integration.get("uri")
1100	            or invocation_context.integration.get("integrationUri")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1099	            invocation_context.integration.get("uri")
1100	            or invocation_context.integration.get("integrationUri")
1101	            or ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1106	            region_name=region_name,
1107	            role_arn=invocation_context.integration.get("credentials"),
1108	            source_arn=get_source_arn(invocation_context),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1109	        )
1110	        headers.update({"X-Amz-Target": invocation_context.headers.get("X-Amz-Target")})
1111	        response = make_http_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1110	        headers.update({"X-Amz-Target": invocation_context.headers.get("X-Amz-Target")})
1111	        response = make_http_request(
1112	            config.internal_service_url(), method="POST", headers=headers, data=payload
1113	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/integration.py:1111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1110	        headers.update({"X-Amz-Target": invocation_context.headers.get("X-Amz-Target")})
1111	        response = make_http_request(
1112	            config.internal_service_url(), method="POST", headers=headers, data=payload
1113	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	        store = store or get_apigateway_store_for_invocation(context=context)
87	        if not (container := store.rest_apis.get(context.api_id)):
88	            # TODO: find the right exception

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	        # check if there is validator for the resource
107	        resource = resource_methods.get(self.context.method, resource_methods.get("ANY", {}))
108	        if not (resource.get("requestValidatorId") or "").strip():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	        # check if there is validator for the resource
107	        resource = resource_methods.get(self.context.method, resource_methods.get("ANY", {}))
108	        if not (resource.get("requestValidatorId") or "").strip():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	        resource = resource_methods.get(self.context.method, resource_methods.get("ANY", {}))
108	        if not (resource.get("requestValidatorId") or "").strip():
109	            return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	        # check if there is a validator for this request
112	        validator = self.rest_api_container.validators.get(resource["requestValidatorId"])
113	        if not validator:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
115	
116	        if self.should_validate_request(validator) and (
117	            missing_parameters := self._get_missing_required_parameters(resource)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	        # https://docs.aws.amazon.com/cdk/api/v1/docs/@aws-cdk_aws-apigateway.EmptyModel.html
130	        if not (request_models := resource.get("requestModels")):
131	            model_name = EMPTY_MODEL

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	        else:
133	            model_name = request_models.get(
134	                APPLICATION_JSON, request_models.get("$default", EMPTY_MODEL)
135	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	            model_name = request_models.get(
134	                APPLICATION_JSON, request_models.get("$default", EMPTY_MODEL)
135	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	        missing_params = []
166	        if not (request_parameters := resource.get("requestParameters")):
167	            return missing_params

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
196	    def should_validate_request(validator):
197	        return validator.get("validateRequestParameters")
198	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
211	    usage_plans = client.get_usage_plans()
212	    for item in usage_plans.get("items", []):
213	        api_stages = item.get("apiStages", [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	    for item in usage_plans.get("items", []):
213	        api_stages = item.get("apiStages", [])
214	        usage_plan_ids.extend(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	        usage_plan_ids.extend(
215	            item.get("id")
216	            for api_stage in api_stages

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	            if (
218	                api_stage.get("stage") == invocation_context.stage
219	                and api_stage.get("apiId") == invocation_context.api_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	                api_stage.get("stage") == invocation_context.stage
219	                and api_stage.get("apiId") == invocation_context.api_id
220	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	        usage_plan_keys = client.get_usage_plan_keys(usagePlanId=usage_plan_id)
224	        for key in usage_plan_keys.get("items", []):
225	            if key.get("value") == api_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
224	        for key in usage_plan_keys.get("items", []):
225	            if key.get("value") == api_key:
226	                # check if the key is enabled

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
226	                # check if the key is enabled
227	                api_key = client.get_api_key(apiKey=key.get("id"))
228	                return api_key.get("enabled") in ("true", True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	                api_key = client.get_api_key(apiKey=key.get("id"))
228	                return api_key.get("enabled") in ("true", True)
229	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244	
245	    api_key_source = rest_api.get("apiKeySource")
246	    match api_key_source:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
247	        case "HEADER":
248	            api_key = invocation_context.headers.get("X-API-Key")
249	            return validate_api_key(api_key, invocation_context) if api_key else False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
250	        case "AUTHORIZER":
251	            api_key = invocation_context.auth_identity.get("apiKey")
252	            return validate_api_key(api_key, invocation_context) if api_key else False

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
286	    try:
287	        validator.validate_request()
288	    except (BadRequestParameters, BadRequestBody) as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
290	
291	    api_key_required = resource.get("resourceMethods", {}).get(method, {}).get("apiKeyRequired")
292	    if api_key_required and not is_api_key_valid(invocation_context):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
290	
291	    api_key_required = resource.get("resourceMethods", {}).get(method, {}).get("apiKeyRequired")
292	    if api_key_required and not is_api_key_valid(invocation_context):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
290	
291	    api_key_required = resource.get("resourceMethods", {}).get(method, {}).get("apiKeyRequired")
292	    if api_key_required and not is_api_key_valid(invocation_context):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	
295	    resource_methods = resource.get("resourceMethods", {})
296	    resource_method = resource_methods.get(method, {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
295	    resource_methods = resource.get("resourceMethods", {})
296	    resource_method = resource_methods.get(method, {})
297	    if not resource_method:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
299	        # ResourcePath: '/*' - produces 'X-AMAZON-APIGATEWAY-ANY-METHOD'
300	        resource_method = resource_methods.get("ANY", {}) or resource_methods.get(
301	            "X-AMAZON-APIGATEWAY-ANY-METHOD", {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
299	        # ResourcePath: '/*' - produces 'X-AMAZON-APIGATEWAY-ANY-METHOD'
300	        resource_method = resource_methods.get("ANY", {}) or resource_methods.get(
301	            "X-AMAZON-APIGATEWAY-ANY-METHOD", {}
302	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
302	        )
303	    method_integration = resource_method.get("methodIntegration")
304	    if not method_integration:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
347	    integration = invocation_context.integration
348	    integration_type_orig = integration.get("type") or integration.get("integrationType") or ""
349	    integration_type = integration_type_orig.upper()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
347	    integration = invocation_context.integration
348	    integration_type_orig = integration.get("type") or integration.get("integrationType") or ""
349	    integration_type = integration_type_orig.upper()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
349	    integration_type = integration_type_orig.upper()
350	    integration_method = integration.get("httpMethod")
351	    uri = integration.get("uri") or integration.get("integrationUri") or ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
350	    integration_method = integration.get("httpMethod")
351	    uri = integration.get("uri") or integration.get("integrationUri") or ""
352	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/invocations.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
350	    integration_method = integration.get("httpMethod")
351	    uri = integration.get("uri") or integration.get("integrationUri") or ""
352	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/provider.py:2829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2828	    result["_links"]["curies"] = {
2829	        "href": "https://docs.aws.amazon.com/apigateway/latest/developerguide/restapi-authorizer-latest.html",
2830	        "name": model_type,
2831	        "templated": True,
2832	    }
2833	    result["_links"]["%s:delete" % model_type] = {"href": self_link}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/provider.py:2844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2843	        {
2844	            "$schema": "http://json-schema.org/draft-04/schema#",
2845	            "title": "Empty Schema",
2846	            "type": "object",
2847	        }
2848	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/provider.py:2858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2857	        {
2858	            "$schema": "http://json-schema.org/draft-04/schema#",
2859	            "title": "Error Schema",
2860	            "type": "object",
2861	            "properties": {"message": {"type": "string"}},
2862	        }
2863	    ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/router_asf.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	    # Example: test%2Balias@gmail.com => test%2Balias@gmail.com
40	    raw_uri = path = request.environ.get("RAW_URI")
41	    if raw_uri.startswith("//"):

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/router_asf.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
44	
45	    data = restore_payload(request)
46	    headers = Headers(request.headers)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/router_asf.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	    #   and use it everywhere.
63	    ctx = ApiInvocationContext(method, path, data, headers, stage=url_params.get("stage"))
64	    ctx.raw_uri = raw_uri

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/router_asf.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
156	        invocation_context.account_id = account_id
157	        result = invoke_rest_api_from_request(invocation_context)
158	        if result is not None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/router_asf.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
156	        invocation_context.account_id = account_id
157	        result = invoke_rest_api_from_request(invocation_context)
158	        if result is not None:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/templates.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
101	        encoded_str = s.encode(config.DEFAULT_ENCODING)
102	        encoded_b64_str = base64.b64encode(encoded_str)
103	        return encoded_b64_str.decode(config.DEFAULT_ENCODING)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/templates.py:102
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
101	        encoded_str = s.encode(config.DEFAULT_ENCODING)
102	        encoded_b64_str = base64.b64encode(encoded_str)
103	        return encoded_b64_str.decode(config.DEFAULT_ENCODING)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/templates.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
107	            s = json.dumps(s)
108	        return base64.b64decode(s)
109	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/legacy/templates.py:108
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
107	            s = json.dumps(s)
108	        return base64.b64decode(s)
109	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_request.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
170	    ) -> RequestDataMapping:
171	        return self._param_mapper.map_integration_request(
172	            request_parameters=request_parameters,
173	            invocation_request=context.invocation_request,
174	            context_variables=context.context_variables,
175	            stage_variables=context.stage_variables,
176	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_request.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
193	
194	        body, request_override = self._vtl_template.render_request(
195	            template=template,
196	            variables=MappingTemplateVariables(
197	                context=context.context_variables,
198	                stageVariables=context.stage_variables or {},
199	                input=MappingTemplateInput(
200	                    body=body_utf8,
201	                    params=MappingTemplateParams(
202	                        path=request.get("path_parameters"),
203	                        querystring=request.get("query_string_parameters", {}),
204	                        header=request.get("headers"),
205	                    ),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_request.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
263	            if content_handling and content_handling == ContentHandlingStrategy.CONVERT_TO_TEXT:
264	                body = base64.b64encode(body)
265	            # if the content handling is not defined, or CONVERT_TO_BINARY, we do not touch the body and leave it as

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_request.py:264
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
263	            if content_handling and content_handling == ContentHandlingStrategy.CONVERT_TO_TEXT:
264	                body = base64.b64encode(body)
265	            # if the content handling is not defined, or CONVERT_TO_BINARY, we do not touch the body and leave it as

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_request.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
272	                try:
273	                    body = base64.b64decode(body)
274	                except ValueError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_request.py:273
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
272	                try:
273	                    body = base64.b64decode(body)
274	                except ValueError:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_response.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
246	            ) or (not content_handling and not is_binary_accept):
247	                body = base64.b64encode(body)
248	        else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_response.py:247
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
246	            ) or (not content_handling and not is_binary_accept):
247	                body = base64.b64encode(body)
248	        else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_response.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
255	                try:
256	                    body = base64.b64decode(body)
257	                except ValueError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/integration_response.py:256
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
255	                try:
256	                    body = base64.b64decode(body)
257	                except ValueError:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/method_request.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
30	    ):
31	        self.validate_request(
32	            context.resource_method,
33	            context.deployment.rest_api,
34	            context.invocation_request,
35	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/method_request.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
55	
56	        if self.should_validate_request(validator) and (
57	            missing_parameters := self._get_missing_required_parameters(method, request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/parse.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
38	        # first, create the InvocationRequest with the incoming request
39	        context.invocation_request = self.create_invocation_request(context)
40	        # then we can create the ContextVariables, used throughout the invocation as payload and to render authorizer

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/parse.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
59	            headers=headers,
60	            body=restore_payload(request),
61	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/handlers/parse.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
153	                principalOrgId=None,
154	                sourceIp="127.0.0.1",  # TODO: get the sourceIp from the Request
155	                user=None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	def get_target_prefix_for_service(service_name: str) -> str | None:
133	    return get_service_catalog().get(service_name).metadata.get("targetPrefix")
134	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	def get_target_prefix_for_service(service_name: str) -> str | None:
133	    return get_service_catalog().get(service_name).metadata.get("targetPrefix")
134	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	
186	        if credentials := context.integration.get("credentials"):
187	            credentials = render_uri_with_stage_variables(credentials, context.stage_variables)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	
213	            if target := self.get_action_service_target(service_name, action):
214	                headers["X-Amz-Target"] = target

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
237	
238	        request_response = requests.request(**request_parameters)
239	        response_content = request_response.content

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
237	
238	        request_response = requests.request(**request_parameters)
239	        response_content = request_response.content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	        *_, region_name, service_name, action_type = split_arn
269	        boto_service_name = self.SERVICE_MAP.get(service_name, service_name)
270	        return ParsedAwsIntegrationUri(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
310	            # we try to populate the missing fields from the OperationModel of the operation
311	            operation_model = get_service_catalog().get(service_name).operation_model(action)
312	            for key in operation_model.output_shape.members:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
360	        # TODO: write test for credentials rendering
361	        if credentials := context.integration.get("credentials"):
362	            credentials = render_uri_with_stage_variables(credentials, context.stage_variables)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
398	        binary_response_accepted = mime_type_matches_binary_media_types(
399	            mime_type=context.invocation_request["headers"].get("Accept"),
400	            binary_media_types=context.deployment.rest_api.rest_api.get("binaryMediaTypes", []),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	            mime_type=context.invocation_request["headers"].get("Accept"),
400	            binary_media_types=context.deployment.rest_api.rest_api.get("binaryMediaTypes", []),
401	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
402	        body = self._parse_body(
403	            body=lambda_response.get("body"),
404	            is_base64_encoded=binary_response_accepted and lambda_response.get("isBase64Encoded"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
403	            body=lambda_response.get("body"),
404	            is_base64_encoded=binary_response_accepted and lambda_response.get("isBase64Encoded"),
405	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
409	            body=body,
410	            status_code=int(lambda_response.get("statusCode") or 200),
411	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
431	        )
432	        if payload := inv_result.get("Payload"):
433	            return payload.read()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
454	                    lambda_response["errorMessage"],
455	                    lambda_response.get("requestId", "<Unknown Request Id>"),
456	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
471	
472	        if headers := lambda_response.get("headers"):
473	            lambda_response["headers"] = {k: serialize_header(v) for k, v in headers.items()}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
474	
475	        if multi_value_headers := lambda_response.get("multiValueHeaders"):
476	            lambda_response["multiValueHeaders"] = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
490	
491	        if (headers := lambda_response.get("headers")) is not None:
492	            if not isinstance(headers, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
496	
497	        if (multi_value_headers := lambda_response.get("multiValueHeaders")) is not None:
498	            if not isinstance(multi_value_headers, dict):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
568	        except UnicodeDecodeError:
569	            return to_str(base64.b64encode(body)), True
570	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:569
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
568	        except UnicodeDecodeError:
569	            return to_str(base64.b64encode(body)), True
570	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
577	            try:
578	                return base64.b64decode(body)
579	            except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:578
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
577	            try:
578	                return base64.b64decode(body)
579	            except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
585	    def _merge_lambda_response_headers(lambda_response: LambdaProxyResponse) -> dict:
586	        headers = lambda_response.get("headers") or {}
587	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/aws.py:588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
587	
588	        if multi_value_headers := lambda_response.get("multiValueHeaders"):
589	            # multiValueHeaders has the priority and will decide the casing of the final headers, as they are merged

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/http.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	    def _get_integration_timeout(integration: Integration) -> float:
38	        return int(integration.get("timeoutInMillis", 29000)) / 1000
39	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/http.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
69	        try:
70	            request_response = requests.request(**request_parameters)
71	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/http.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
69	        try:
70	            request_response = requests.request(**request_parameters)
71	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/http.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
124	        try:
125	            request_response = requests.request(**request_parameters)
126	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/integrations/http.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
124	        try:
125	            request_response = requests.request(**request_parameters)
126	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/template_mapping.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
161	        encoded_str = s.encode(config.DEFAULT_ENCODING)
162	        encoded_b64_str = base64.b64encode(encoded_str)
163	        return encoded_b64_str.decode(config.DEFAULT_ENCODING)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/template_mapping.py:162
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
161	        encoded_str = s.encode(config.DEFAULT_ENCODING)
162	        encoded_b64_str = base64.b64encode(encoded_str)
163	        return encoded_b64_str.decode(config.DEFAULT_ENCODING)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/template_mapping.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
167	            s = json.dumps(s)
168	        return base64.b64decode(s)
169	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/apigateway/next_gen/execute_api/template_mapping.py:168
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
167	            s = json.dumps(s)
168	        return base64.b64decode(s)
169	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/api_utils.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	def prepare_template_body(req_data: dict) -> str | bytes | None:  # TODO: mutating and returning
20	    template_url = req_data.get("TemplateURL")
21	    if template_url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/api_utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	        req_data["TemplateURL"] = convert_s3_to_local_url(template_url)
23	    url = req_data.get("TemplateURL", "")
24	    if is_local_service_url(url):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/api_utils.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	def get_template_body(req_data: dict) -> str:
36	    body = req_data.get("TemplateBody")
37	    if body:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/api_utils.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	        return body
39	    url = req_data.get("TemplateURL")
40	    if url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/api_utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	    if url:
41	        response = run_safe(lambda: safe_requests.get(url, verify=False))
42	        # check error codes, and code 301 - fixes https://github.com/localstack/localstack/issues/1884

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/api_utils.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
56	                result = client.get_object(Bucket=parts[0], Key=parts[2])
57	                body = to_str(result["Body"].read())
58	                return body

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/deploy_ui.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	
31	        download_url = req_params.get("templateURL")
32	        if download_url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/deploy_ui.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	                LOG.debug("Attempting to download CloudFormation template URL: %s", download_url)
35	                template_body = requests.get(download_url).text
36	                template_body = parse_json_or_yaml(template_body)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/deployment_utils.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
277	    LOG.warning(
278	        "%s. To find out if %s is supported in LocalStack Pro, "
279	        "please check out our docs at https://docs.localstack.cloud/user-guide/aws/cloudformation/#resources-pro--enterprise-edition",
280	        message,
281	        resource_type,
282	    )
283	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/engine/template_deployer.py:726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
725	            )
726	            return to_str(base64.b64encode(to_bytes(value_to_encode)))
727	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/engine/template_deployer.py:726
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
725	            )
726	            return to_str(base64.b64encode(to_bytes(value_to_encode)))
727	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/engine/template_deployer.py:1230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1229	        # run deployment in background loop, to avoid client network timeouts
1230	        return start_worker_thread(_run)
1231	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/engine/transformers.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
251	        )
252	    result = json.loads(invocation["Payload"].read())
253	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/scaffolding/__main__.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
567	        if file_destination.exists():
568	            should_overwrite = self.confirm_overwrite(file_destination)
569	            if not should_overwrite:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/scaffolding/__main__.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
686	        if should_write:
687	            self.write()
688	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/scaffolding/__main__.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
691	    def write(self):
692	        self.writer.write(self.file_type, self.contents)
693	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/scaffolding/__main__.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
804	    console.print(
805	        "Resource types: https://docs.aws.amazon.com/cloudformation-cli/latest/userguide/resource-types.html"
806	    )
807	    # TODO: print for every resource

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudformation/scaffolding/__main__.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
811	            # lambda_ should become lambda (re-use the same list we use for generating the models)
812	            f"{matching_resource}: https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-{resource_name.service.lower()}-{resource_name.resource.lower()}.html"
813	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudwatch/provider.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
323	
324	        start_worker_thread(restart_alarms)
325	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/cloudwatch/provider_v2.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
189	
190	        start_worker_thread(restart_alarms)
191	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/packages.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	DDBLOCAL_URL = "https://d1ni2b6xgvw0s0.cloudfront.net/v2.x/dynamodb_local_latest.zip"
22	
23	
24	class DynamoDBLocalPackage(Package):

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/packages.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
83	        if not os.path.exists(ddb_agent_jar_path):
84	            download(DDB_AGENT_JAR_URL, ddb_agent_jar_path)
85	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/packages.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
87	        if not os.path.exists(javassit_jar_path):
88	            download(JAVASSIST_JAR_URL, javassit_jar_path)
89	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
201	    def __init__(self, num_thread: int = 10):
202	        self.executor = ThreadPoolExecutor(num_thread, thread_name_prefix="ddb_stream_fwd")
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
268	            records = table_records["records"]
269	            table_def = store.table_definitions.get(table_name) or {}
270	            stream_arn = table_def["KinesisDataStreamDestinations"][-1]["StreamArn"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
335	
336	        existing_key = MANAGED_KMS_KEYS.get(region_name)
337	        if existing_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
354	    def get_sse_description(cls, account_id: str, region_name: str, data):
355	        if data.get("Enabled"):
356	            kms_master_key_id = data.get("KMSMasterKeyId")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
355	        if data.get("Enabled"):
356	            kms_master_key_id = data.get("KMSMasterKeyId")
357	            if not kms_master_key_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
390	    original_region = context.region
391	    original_authorization = context.request.headers.get("Authorization")
392	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
435	        for table_name, ttl_spec in ttl_specs.items():
436	            if ttl_spec.get("Enabled", False):
437	                attribute_name = ttl_spec.get("AttributeName")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
436	            if ttl_spec.get("Enabled", False):
437	                attribute_name = ttl_spec.get("AttributeName")
438	                current_time = int(datetime.now().timestamp())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
445	                    )
446	                    items_to_delete = result.get("Items", [])
447	                    no_expired_items += len(items_to_delete)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
450	                    keys_to_delete = [
451	                        {partition_key: item.get(partition_key)}
452	                        if range_key is None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
453	                        else {
454	                            partition_key: item.get(partition_key),
455	                            range_key: item.get(range_key),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
454	                            partition_key: item.get(partition_key),
455	                            range_key: item.get(range_key),
456	                        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
472	def _get_hash_and_range_key(table_description: DescribeTableOutput) -> [str, str | None]:
473	    key_schema = table_description.get("Table", {}).get("KeySchema", [])
474	    hash_key, range_key = None, None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
472	def _get_hash_and_range_key(table_description: DescribeTableOutput) -> [str, str | None]:
473	    key_schema = table_description.get("Table", {}).get("KeySchema", [])
474	    hash_key, range_key = None, None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
504	
505	            self.thread = start_thread(_run, name="ddb-remove-expired-items")
506	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
555	    def _new_dynamodb_server() -> DynamodbServer:
556	        return DynamodbServer.get()
557	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
589	            with modify_context_region(context, region):
590	                return self.forward_request(context, service_request=service_request)
591	        return self.forward_request(context, service_request=service_request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
589	            with modify_context_region(context, region):
590	                return self.forward_request(context, service_request=service_request)
591	        return self.forward_request(context, service_request=service_request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
590	                return self.forward_request(context, service_request=service_request)
591	        return self.forward_request(context, service_request=service_request)
592	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
590	                return self.forward_request(context, service_request=service_request)
591	        return self.forward_request(context, service_request=service_request)
592	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
621	        url = f"{self.get_forward_url(account_id, region_name)}/shell{req_path}"
622	        result = requests.request(
623	            method=request.method, url=url, headers=request.headers, data=request.data
624	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
621	        url = f"{self.get_forward_url(account_id, region_name)}/shell{req_path}"
622	        result = requests.request(
623	            method=request.method, url=url, headers=request.headers, data=request.data
624	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
642	
643	        billing_mode = create_table_input.get("BillingMode")
644	        provisioned_throughput = create_table_input.get("ProvisionedThroughput")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	        billing_mode = create_table_input.get("BillingMode")
644	        provisioned_throughput = create_table_input.get("ProvisionedThroughput")
645	        if billing_mode == BillingMode.PAY_PER_REQUEST and provisioned_throughput is not None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
650	
651	        result = self.forward_request(context)
652	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
650	
651	        result = self.forward_request(context)
652	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
671	        if table_definitions:
672	            table_content = result.get("Table", {})
673	            table_content.update(table_definitions)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
680	                table_definitions,
681	                table_description.get("LatestStreamLabel"),
682	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
694	            for gsi in gsis:
695	                index_name = gsi.get("IndexName", "")
696	                gsi.update(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
736	
737	        result = self._forward_request(context=context, region=global_table_region)
738	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
736	
737	        result = self._forward_request(context=context, region=global_table_region)
738	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
738	
739	        table_arn = result.get("TableDescription", {}).get("TableArn")
740	        table_arn = self.fix_table_arn(context.account_id, context.region, table_arn)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
738	
739	        table_arn = result.get("TableDescription", {}).get("TableArn")
740	        table_arn = self.fix_table_arn(context.account_id, context.region, table_arn)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
753	
754	        result = self._forward_request(context=context, region=global_table_region)
755	        table_description: TableDescription = result["Table"]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
753	
754	        result = self._forward_request(context=context, region=global_table_region)
755	        table_description: TableDescription = result["Table"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
757	        # Update table properties from LocalStack stores
758	        if table_props := get_store(context.account_id, context.region).table_properties.get(
759	            table_name
760	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
765	        # Update replication details
766	        replicas: Dict[RegionName, ReplicaDescription] = store.REPLICAS.get(table_name, {})
767	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
785	        # update only TableId and SSEDescription if present
786	        if table_definitions := store.table_definitions.get(table_name):
787	            for key in ["TableId", "SSEDescription"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
787	            for key in ["TableId", "SSEDescription"]:
788	                if table_definitions.get(key):
789	                    table_description[key] = table_definitions[key]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
803	                # Terraform depends on this parity for update operations
804	                gsi["ProvisionedThroughput"] = default_values | gsi.get("ProvisionedThroughput", {})
805	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
817	        try:
818	            result = self._forward_request(context=context, region=global_table_region)
819	        except CommonServiceException as exc:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
817	        try:
818	            result = self._forward_request(context=context, region=global_table_region)
819	        except CommonServiceException as exc:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
824	
825	            if table_class := update_table_input.get("TableClass"):
826	                table_definitions = get_store(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
830	
831	            if replica_updates := update_table_input.get("ReplicaUpdates"):
832	                store = get_store(context.account_id, global_table_region)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
834	                # Dict with source region to set of replicated regions
835	                replicas: Dict[RegionName, ReplicaDescription] = store.REPLICAS.get(table_name, {})
836	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
839	                        # Replicated region
840	                        target_region = details.get("RegionName")
841	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
853	                                    RegionName=target_region,
854	                                    KMSMasterKeyId=details.get("KMSMasterKeyId"),
855	                                    ProvisionedThroughputOverride=details.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
854	                                    KMSMasterKeyId=details.get("KMSMasterKeyId"),
855	                                    ProvisionedThroughputOverride=details.get(
856	                                        "ProvisionedThroughputOverride"
857	                                    ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
857	                                    ),
858	                                    GlobalSecondaryIndexes=details.get("GlobalSecondaryIndexes"),
859	                                    ReplicaStatus=ReplicaStatus.ACTIVE,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:880
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
879	
880	            if sse_specification_input := update_table_input.get("SSESpecification"):
881	                # If SSESpecification is changed, update store and return the 'UPDATING' status in the response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:898
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
897	        # TODO: DDB streams must also be created for replicas
898	        if update_table_input.get("StreamSpecification"):
899	            create_dynamodb_stream(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:903
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
902	                update_table_input,
903	                result["TableDescription"].get("LatestStreamLabel"),
904	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
914	    ) -> ListTablesOutput:
915	        response = self.forward_request(context)
916	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
914	    ) -> ListTablesOutput:
915	        response = self.forward_request(context)
916	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
934	
935	        has_return_values = put_item_input.get("ReturnValues") == "ALL_OLD"
936	        stream_type = get_table_stream_type(context.account_id, context.region, table_name)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
942	            service_req["ReturnValues"] = "ALL_OLD"
943	            result = self._forward_request(
944	                context=context, region=global_table_region, service_request=service_req
945	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:943
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
942	            service_req["ReturnValues"] = "ALL_OLD"
943	            result = self._forward_request(
944	                context=context, region=global_table_region, service_request=service_req
945	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
946	        else:
947	            result = self._forward_request(context=context, region=global_table_region)
948	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
946	        else:
947	            result = self._forward_request(context=context, region=global_table_region)
948	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
964	            if has_return_values:
965	                existing_item = result.get("Attributes")
966	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1003
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1002	
1003	        has_return_values = delete_item_input.get("ReturnValues") == "ALL_OLD"
1004	        stream_type = get_table_stream_type(context.account_id, context.region, table_name)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1010	            service_req["ReturnValues"] = "ALL_OLD"
1011	            result = self._forward_request(
1012	                context=context, region=global_table_region, service_request=service_req
1013	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1010	            service_req["ReturnValues"] = "ALL_OLD"
1011	            result = self._forward_request(
1012	                context=context, region=global_table_region, service_request=service_req
1013	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1014	        else:
1015	            result = self._forward_request(context=context, region=global_table_region)
1016	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1015
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1014	        else:
1015	            result = self._forward_request(context=context, region=global_table_region)
1016	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1020	            if has_return_values:
1021	                existing_item = result.get("Attributes")
1022	            else:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1070	
1071	        result = self._forward_request(context=context, region=global_table_region)
1072	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1070	
1071	        result = self._forward_request(context=context, region=global_table_region)
1072	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1107	        global_table_region = self.get_global_table_region(context, table_name)
1108	        result = self._forward_request(context=context, region=global_table_region)
1109	        self.fix_consumed_capacity(get_item_input, result)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1107	        global_table_region = self.get_global_table_region(context, table_name)
1108	        result = self._forward_request(context=context, region=global_table_region)
1109	        self.fix_consumed_capacity(get_item_input, result)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1117	    def query(self, context: RequestContext, query_input: QueryInput) -> QueryOutput:
1118	        index_name = query_input.get("IndexName")
1119	        if index_name:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1128	        global_table_region = self.get_global_table_region(context, table_name)
1129	        result = self._forward_request(context=context, region=global_table_region)
1130	        self.fix_consumed_capacity(query_input, result)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1128	        global_table_region = self.get_global_table_region(context, table_name)
1129	        result = self._forward_request(context=context, region=global_table_region)
1130	        self.fix_consumed_capacity(query_input, result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1136	        global_table_region = self.get_global_table_region(context, table_name)
1137	        result = self._forward_request(context=context, region=global_table_region)
1138	        return result

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1136	        global_table_region = self.get_global_table_region(context, table_name)
1137	        result = self._forward_request(context=context, region=global_table_region)
1138	        return result

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1185	        try:
1186	            result = self.forward_request(context)
1187	        except CommonServiceException as e:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1185	        try:
1186	            result = self.forward_request(context)
1187	        except CommonServiceException as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1229	        # TODO: add global table support
1230	        return self.forward_request(context)
1231	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1229	        # TODO: add global table support
1230	        return self.forward_request(context)
1231	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1252	            for key in ["Put", "Update", "Delete"]:
1253	                inner_item: Put | Delete | Update = item.get(key)
1254	                if inner_item:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1290	
1291	        client_token: str | None = transact_write_items_input.get("ClientRequestToken")
1292	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1297	
1298	        result = self.forward_request(context)
1299	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1297	
1298	        result = self.forward_request(context)
1299	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1331	    ) -> TransactGetItemsOutput:
1332	        return self.forward_request(context)
1333	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1331	    ) -> TransactGetItemsOutput:
1332	        return self.forward_request(context)
1333	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1337	    ) -> ExecuteTransactionOutput:
1338	        result = self.forward_request(context)
1339	        return result

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1337	    ) -> ExecuteTransactionOutput:
1338	        result = self.forward_request(context)
1339	        return result

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1351	        # We found out that 'Parameters' can be an empty list when the request comes from the AWS JS client.
1352	        if execute_statement_input.get("Parameters", None) == []:  # noqa
1353	            raise ValidationException(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1370	
1371	        result = self.forward_request(context)
1372	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1370	
1371	        result = self.forward_request(context)
1372	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1406	        for tag_key in tag_keys or []:
1407	            get_store(context.account_id, context.region).TABLE_TAGS.get(resource_arn, {}).pop(
1408	                tag_key, None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1419	            {"Key": k, "Value": v}
1420	            for k, v in get_store(context.account_id, context.region)
1421	            .TABLE_TAGS.get(resource_arn, {})
1422	            .items()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1438	        backend = get_store(context.account_id, context.region)
1439	        ttl_spec = backend.ttl_specifications.get(table_name)
1440	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1442	        if ttl_spec:
1443	            if ttl_spec.get("Enabled"):
1444	                ttl_status = "ENABLED"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1447	            result = {
1448	                "AttributeName": ttl_spec.get("AttributeName"),
1449	                "TimeToLiveStatus": ttl_status,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1495	    ) -> DescribeGlobalTableOutput:
1496	        details = get_store(context.account_id, context.region).GLOBAL_TABLES.get(global_table_name)
1497	        if not details:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1522	    ) -> UpdateGlobalTableOutput:
1523	        details = get_store(context.account_id, context.region).GLOBAL_TABLES.get(global_table_name)
1524	        if not details:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1529
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1528	            # delete existing
1529	            delete = update.get("Delete")
1530	            if delete:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1534	            # create new
1535	            create = update.get("Create")
1536	            if create:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1569	
1570	        dest_status = table_def.get("KinesisDataStreamDestinationStatus")
1571	        if dest_status not in ["DISABLED", "ENABLE_FAILED", None]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1579
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1578	        table_def["KinesisDataStreamDestinations"] = (
1579	            table_def.get("KinesisDataStreamDestinations") or []
1580	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1617	
1618	        stream_destinations = table_def.get("KinesisDataStreamDestinations")
1619	        if stream_destinations:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1644	        table_def = (
1645	            get_store(context.account_id, context.region).table_definitions.get(table_name) or {}
1646	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1647	
1648	        stream_destinations = table_def.get("KinesisDataStreamDestinations") or []
1649	        return DescribeKinesisStreamingDestinationOutput(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1662	        continuous_backup_description = (
1663	            store.table_properties.get(table_name, {}).get("ContinuousBackupsDescription")
1664	        ) or ContinuousBackupsDescription(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1662	        continuous_backup_description = (
1663	            store.table_properties.get(table_name, {}).get("ContinuousBackupsDescription")
1664	        ) or ContinuousBackupsDescription(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1755	
1756	        table_region = store.TABLE_REGION.get(table_name)
1757	        replicated_at = store.REPLICAS.get(table_name, {}).keys()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1756	        table_region = store.TABLE_REGION.get(table_name)
1757	        replicated_at = store.REPLICAS.get(table_name, {}).keys()
1758	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1778
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1777	            rf"Credential={key}/\2/{region_name}/\4/",
1778	            headers.get("Authorization") or "",
1779	            flags=re.IGNORECASE,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1784	        # returned by dynalite, but not by AWS's DynamoDBLocal
1785	        table_name = request.get("TableName")
1786	        return_cap = request.get("ReturnConsumedCapacity")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1785	        table_name = request.get("TableName")
1786	        return_cap = request.get("ReturnConsumedCapacity")
1787	        if "ConsumedCapacity" not in result and return_cap in ["TOTAL", "INDEXES"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1820	                case {"Put": {"TableName": table_name, "Item": new_item}}:
1821	                    if not (stream_type := tables_stream_type.get(table_name)):
1822	                        continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1851	                case {"Update": {"TableName": table_name, "Key": keys}}:
1852	                    if not (stream_type := tables_stream_type.get(table_name)):
1853	                        continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1883	                case {"Delete": {"TableName": table_name, "Key": keys}}:
1884	                    if not (stream_type := tables_stream_type.get(table_name)):
1885	                        continue

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1922	    ) -> BatchExecuteStatementOutput:
1923	        result = self.forward_request(context)
1924	        return result

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1922	    ) -> BatchExecuteStatementOutput:
1923	        result = self.forward_request(context)
1924	        return result

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:1938
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1937	        for table_name, stream_type in tables_stream_type.items():
1938	            existing_items_for_table_unordered = existing_items.get(table_name, [])
1939	            table_records: StreamRecords = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2091
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2090	    schema = SchemaExtractor.get_table_schema(table_name, account_id, region_name)
2091	    for index in schema["Table"].get("GlobalSecondaryIndexes", []):
2092	        if index["IndexName"] == index_name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2100	    schema = SchemaExtractor.get_table_schema(table_name, account_id, region_name)
2101	    for index in schema["Table"].get("LocalSecondaryIndexes", []):
2102	        if index["IndexName"] == index_name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2111	        return True
2112	    index_query_type = query_data.get("Select")
2113	    index = get_global_secondary_index(account_id, region_name, table_name, index_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2113	    index = get_global_secondary_index(account_id, region_name, table_name, index_name)
2114	    index_projection_type = index.get("Projection").get("ProjectionType")
2115	    if index_query_type == "ALL_ATTRIBUTES" and index_projection_type != "ALL":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2113	    index = get_global_secondary_index(account_id, region_name, table_name, index_name)
2114	    index_projection_type = index.get("Projection").get("ProjectionType")
2115	    if index_query_type == "ALL_ATTRIBUTES" and index_projection_type != "ALL":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2136	
2137	    if table_definition := get_store(account_id, region_name).table_definitions.get(table_name):
2138	        if table_definition.get("KinesisDataStreamDestinationStatus") == "ACTIVE":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2137	    if table_definition := get_store(account_id, region_name).table_definitions.get(table_name):
2138	        if table_definition.get("KinesisDataStreamDestinationStatus") == "ACTIVE":
2139	            is_kinesis = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2224	    stream = data["StreamSpecification"]
2225	    enabled = stream.get("StreamEnabled")
2226	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2245	        )
2246	        return table_schema["Table"].get("StreamSpecification")
2247	    except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/provider.py:2269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2268	    keys = item_keys.items()
2269	    for item in batch.get(table_name, []):
2270	        if keys <= item.items():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/server.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
188	        LOG.debug("Starting DynamoDB Local: %s", cmd)
189	        t = ShellCommandThread(
190	            cmd,
191	            strip_color=True,
192	            log_listener=_log_listener,
193	            auto_restart=True,
194	            name="dynamodb-local",
195	            env_vars=env_vars,
196	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	
186	        existing_key = MANAGED_KMS_KEYS.get(region_name)
187	        if existing_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	    def get_sse_description(cls, account_id: str, region_name: str, data):
205	        if data.get("Enabled"):
206	            kms_master_key_id = data.get("KMSMasterKeyId")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	        if data.get("Enabled"):
206	            kms_master_key_id = data.get("KMSMasterKeyId")
207	            if not kms_master_key_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
240	    original_region = context.region
241	    original_authorization = context.request.headers.get("Authorization")
242	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
285	        for table_name, ttl_spec in ttl_specs.items():
286	            if ttl_spec.get("Enabled", False):
287	                attribute_name = ttl_spec.get("AttributeName")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
286	            if ttl_spec.get("Enabled", False):
287	                attribute_name = ttl_spec.get("AttributeName")
288	                current_time = int(datetime.now().timestamp())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
295	                    )
296	                    items_to_delete = result.get("Items", [])
297	                    no_expired_items += len(items_to_delete)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
300	                    keys_to_delete = [
301	                        {partition_key: item.get(partition_key)}
302	                        if range_key is None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
303	                        else {
304	                            partition_key: item.get(partition_key),
305	                            range_key: item.get(range_key),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
304	                            partition_key: item.get(partition_key),
305	                            range_key: item.get(range_key),
306	                        }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
322	def _get_hash_and_range_key(table_description: DescribeTableOutput) -> [str, str | None]:
323	    key_schema = table_description.get("Table", {}).get("KeySchema", [])
324	    hash_key, range_key = None, None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
322	def _get_hash_and_range_key(table_description: DescribeTableOutput) -> [str, str | None]:
323	    key_schema = table_description.get("Table", {}).get("KeySchema", [])
324	    hash_key, range_key = None, None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
354	
355	            self.thread = start_thread(_run, name="ddb-remove-expired-items")
356	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
403	    def _new_dynamodb_server() -> DynamodbServer:
404	        return DynamodbServer.get()
405	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
437	            with modify_context_region(context, region):
438	                return self.forward_request(context, service_request=service_request)
439	        return self.forward_request(context, service_request=service_request)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
437	            with modify_context_region(context, region):
438	                return self.forward_request(context, service_request=service_request)
439	        return self.forward_request(context, service_request=service_request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
438	                return self.forward_request(context, service_request=service_request)
439	        return self.forward_request(context, service_request=service_request)
440	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
438	                return self.forward_request(context, service_request=service_request)
439	        return self.forward_request(context, service_request=service_request)
440	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
469	        url = f"{self.get_forward_url(account_id, region_name)}/shell{req_path}"
470	        result = requests.request(
471	            method=request.method, url=url, headers=request.headers, data=request.data
472	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
469	        url = f"{self.get_forward_url(account_id, region_name)}/shell{req_path}"
470	        result = requests.request(
471	            method=request.method, url=url, headers=request.headers, data=request.data
472	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
490	
491	        billing_mode = create_table_input.get("BillingMode")
492	        provisioned_throughput = create_table_input.get("ProvisionedThroughput")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
491	        billing_mode = create_table_input.get("BillingMode")
492	        provisioned_throughput = create_table_input.get("ProvisionedThroughput")
493	        if billing_mode == BillingMode.PAY_PER_REQUEST and provisioned_throughput is not None:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
498	
499	        result = self.forward_request(context)
500	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
498	
499	        result = self.forward_request(context)
500	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	        if table_definitions:
520	            table_content = result.get("Table", {})
521	            table_content.update(table_definitions)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
534	            for gsi in gsis:
535	                index_name = gsi.get("IndexName", "")
536	                gsi.update(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
577	
578	        result = self._forward_request(context=context, region=global_table_region)
579	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
577	
578	        result = self._forward_request(context=context, region=global_table_region)
579	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
579	
580	        table_arn = result.get("TableDescription", {}).get("TableArn")
581	        table_arn = self.fix_table_arn(context.account_id, context.region, table_arn)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
579	
580	        table_arn = result.get("TableDescription", {}).get("TableArn")
581	        table_arn = self.fix_table_arn(context.account_id, context.region, table_arn)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
593	
594	        result = self._forward_request(context=context, region=global_table_region)
595	        table_description: TableDescription = result["Table"]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
593	
594	        result = self._forward_request(context=context, region=global_table_region)
595	        table_description: TableDescription = result["Table"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
597	        # Update table properties from LocalStack stores
598	        if table_props := get_store(context.account_id, context.region).table_properties.get(
599	            table_name
600	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
605	        # Update replication details
606	        replicas: Dict[RegionName, ReplicaDescription] = store.REPLICAS.get(table_name, {})
607	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
625	        # update only TableId and SSEDescription if present
626	        if table_definitions := store.table_definitions.get(table_name):
627	            for key in ["TableId", "SSEDescription"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
627	            for key in ["TableId", "SSEDescription"]:
628	                if table_definitions.get(key):
629	                    table_description[key] = table_definitions[key]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	                # Terraform depends on this parity for update operations
644	                gsi["ProvisionedThroughput"] = default_values | gsi.get("ProvisionedThroughput", {})
645	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
657	        try:
658	            self._forward_request(context=context, region=global_table_region)
659	        except CommonServiceException as exc:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
657	        try:
658	            self._forward_request(context=context, region=global_table_region)
659	        except CommonServiceException as exc:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
664	
665	            if table_class := update_table_input.get("TableClass"):
666	                table_definitions = get_store(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
670	
671	            if replica_updates := update_table_input.get("ReplicaUpdates"):
672	                store = get_store(context.account_id, global_table_region)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
674	                # Dict with source region to set of replicated regions
675	                replicas: Dict[RegionName, ReplicaDescription] = store.REPLICAS.get(table_name, {})
676	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
679	                        # Replicated region
680	                        target_region = details.get("RegionName")
681	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
693	                                    RegionName=target_region,
694	                                    KMSMasterKeyId=details.get("KMSMasterKeyId"),
695	                                    ProvisionedThroughputOverride=details.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
694	                                    KMSMasterKeyId=details.get("KMSMasterKeyId"),
695	                                    ProvisionedThroughputOverride=details.get(
696	                                        "ProvisionedThroughputOverride"
697	                                    ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:698
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
697	                                    ),
698	                                    GlobalSecondaryIndexes=details.get("GlobalSecondaryIndexes"),
699	                                    ReplicaStatus=ReplicaStatus.ACTIVE,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
719	
720	            if sse_specification_input := update_table_input.get("SSESpecification"):
721	                # If SSESpecification is changed, update store and return the 'UPDATING' status in the response

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
745	    ) -> ListTablesOutput:
746	        response = self.forward_request(context)
747	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
745	    ) -> ListTablesOutput:
746	        response = self.forward_request(context)
747	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
765	
766	        return self._forward_request(context=context, region=global_table_region)
767	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
765	
766	        return self._forward_request(context=context, region=global_table_region)
767	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
776	
777	        return self._forward_request(context=context, region=global_table_region)
778	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
776	
777	        return self._forward_request(context=context, region=global_table_region)
778	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
788	
789	        return self._forward_request(context=context, region=global_table_region)
790	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
788	
789	        return self._forward_request(context=context, region=global_table_region)
790	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
794	        global_table_region = self.get_global_table_region(context, table_name)
795	        result = self._forward_request(context=context, region=global_table_region)
796	        self.fix_consumed_capacity(get_item_input, result)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
794	        global_table_region = self.get_global_table_region(context, table_name)
795	        result = self._forward_request(context=context, region=global_table_region)
796	        self.fix_consumed_capacity(get_item_input, result)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
804	    def query(self, context: RequestContext, query_input: QueryInput) -> QueryOutput:
805	        index_name = query_input.get("IndexName")
806	        if index_name:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
815	        global_table_region = self.get_global_table_region(context, table_name)
816	        result = self._forward_request(context=context, region=global_table_region)
817	        self.fix_consumed_capacity(query_input, result)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
815	        global_table_region = self.get_global_table_region(context, table_name)
816	        result = self._forward_request(context=context, region=global_table_region)
817	        self.fix_consumed_capacity(query_input, result)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
823	        global_table_region = self.get_global_table_region(context, table_name)
824	        result = self._forward_request(context=context, region=global_table_region)
825	        return result

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
823	        global_table_region = self.get_global_table_region(context, table_name)
824	        result = self._forward_request(context=context, region=global_table_region)
825	        return result

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
851	        try:
852	            result = self.forward_request(context)
853	        except CommonServiceException as e:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:852
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
851	        try:
852	            result = self.forward_request(context)
853	        except CommonServiceException as e:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
884	        # TODO: add global table support
885	        return self.forward_request(context)
886	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
884	        # TODO: add global table support
885	        return self.forward_request(context)
886	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:898
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
897	        # TODO: add global table support
898	        client_token: str | None = transact_write_items_input.get("ClientRequestToken")
899	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
904	
905	        return self.forward_request(context)
906	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
904	
905	        return self.forward_request(context)
906	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
913	    ) -> TransactGetItemsOutput:
914	        return self.forward_request(context)
915	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
913	    ) -> TransactGetItemsOutput:
914	        return self.forward_request(context)
915	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
919	    ) -> ExecuteTransactionOutput:
920	        result = self.forward_request(context)
921	        return result

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
919	    ) -> ExecuteTransactionOutput:
920	        result = self.forward_request(context)
921	        return result

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
933	        # We found out that 'Parameters' can be an empty list when the request comes from the AWS JS client.
934	        if execute_statement_input.get("Parameters", None) == []:  # noqa
935	            raise ValidationException(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:938
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
937	            )
938	        return self.forward_request(context)
939	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:938
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
937	            )
938	        return self.forward_request(context)
939	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
959	        for tag_key in tag_keys or []:
960	            get_store(context.account_id, context.region).TABLE_TAGS.get(resource_arn, {}).pop(
961	                tag_key, None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:973
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
972	            {"Key": k, "Value": v}
973	            for k, v in get_store(context.account_id, context.region)
974	            .TABLE_TAGS.get(resource_arn, {})
975	            .items()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
991	        backend = get_store(context.account_id, context.region)
992	        ttl_spec = backend.ttl_specifications.get(table_name)
993	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
995	        if ttl_spec:
996	            if ttl_spec.get("Enabled"):
997	                ttl_status = "ENABLED"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1001
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1000	            result = {
1001	                "AttributeName": ttl_spec.get("AttributeName"),
1002	                "TimeToLiveStatus": ttl_status,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1049
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1048	    ) -> DescribeGlobalTableOutput:
1049	        details = get_store(context.account_id, context.region).GLOBAL_TABLES.get(global_table_name)
1050	        if not details:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1075	    ) -> UpdateGlobalTableOutput:
1076	        details = get_store(context.account_id, context.region).GLOBAL_TABLES.get(global_table_name)
1077	        if not details:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1082
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1081	            # delete existing
1082	            delete = update.get("Delete")
1083	            if delete:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1087	            # create new
1088	            create = update.get("Create")
1089	            if create:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1121	
1122	        dest_status = table_def.get("KinesisDataStreamDestinationStatus")
1123	        if dest_status not in ["DISABLED", "ENABLE_FAILED", None]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1130	        table_def["KinesisDataStreamDestinations"] = (
1131	            table_def.get("KinesisDataStreamDestinations") or []
1132	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1167	
1168	        stream_destinations = table_def.get("KinesisDataStreamDestinations")
1169	        if stream_destinations:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1194	        table_def = (
1195	            get_store(context.account_id, context.region).table_definitions.get(table_name) or {}
1196	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1197	
1198	        stream_destinations = table_def.get("KinesisDataStreamDestinations") or []
1199	        return DescribeKinesisStreamingDestinationOutput(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1212	        continuous_backup_description = (
1213	            store.table_properties.get(table_name, {}).get("ContinuousBackupsDescription")
1214	        ) or ContinuousBackupsDescription(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1212	        continuous_backup_description = (
1213	            store.table_properties.get(table_name, {}).get("ContinuousBackupsDescription")
1214	        ) or ContinuousBackupsDescription(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1305	
1306	        table_region = store.TABLE_REGION.get(table_name)
1307	        replicated_at = store.REPLICAS.get(table_name, {}).keys()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1306	        table_region = store.TABLE_REGION.get(table_name)
1307	        replicated_at = store.REPLICAS.get(table_name, {}).keys()
1308	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1328
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1327	            rf"Credential={key}/\2/{region_name}/\4/",
1328	            headers.get("Authorization") or "",
1329	            flags=re.IGNORECASE,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1334	        # returned by dynalite, but not by AWS's DynamoDBLocal
1335	        table_name = request.get("TableName")
1336	        return_cap = request.get("ReturnConsumedCapacity")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1335	        table_name = request.get("TableName")
1336	        return_cap = request.get("ReturnConsumedCapacity")
1337	        if "ConsumedCapacity" not in result and return_cap in ["TOTAL", "INDEXES"]:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1362	    ) -> BatchExecuteStatementOutput:
1363	        result = self.forward_request(context)
1364	        return result

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1362	    ) -> BatchExecuteStatementOutput:
1363	        result = self.forward_request(context)
1364	        return result

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1430	    schema = SchemaExtractor.get_table_schema(table_name, account_id, region_name)
1431	    for index in schema["Table"].get("GlobalSecondaryIndexes", []):
1432	        if index["IndexName"] == index_name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1440	    schema = SchemaExtractor.get_table_schema(table_name, account_id, region_name)
1441	    for index in schema["Table"].get("LocalSecondaryIndexes", []):
1442	        if index["IndexName"] == index_name:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1451	        return True
1452	    index_query_type = query_data.get("Select")
1453	    index = get_global_secondary_index(account_id, region_name, table_name, index_name)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1453	    index = get_global_secondary_index(account_id, region_name, table_name, index_name)
1454	    index_projection_type = index.get("Projection").get("ProjectionType")
1455	    if index_query_type == "ALL_ATTRIBUTES" and index_projection_type != "ALL":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/dynamodb/v2/provider.py:1454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1453	    index = get_global_secondary_index(account_id, region_name, table_name, index_name)
1454	    index_projection_type = index.get("Projection").get("ProjectionType")
1455	    if index_query_type == "ALL_ATTRIBUTES" and index_projection_type != "ALL":

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/ec2/resource_providers/aws_ec2_instance.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
235	            if model.get("UserData"):
236	                params["UserData"] = to_str(base64.b64decode(model["UserData"]))
237	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/ec2/resource_providers/aws_ec2_instance.py:236
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
235	            if model.get("UserData"):
236	                params["UserData"] = to_str(base64.b64decode(model["UserData"]))
237	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/ecr/resource_providers/aws_ecr_repository.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
102	                ),
103	                "RepositoryUri": "http://localhost:4566",
104	                "ImageTagMutability": "MUTABLE",
105	                "ImageScanningConfiguration": {"scanOnPush": True},
106	            }
107	        )
108	        return ProgressEvent(
109	            status=OperationStatus.SUCCESS,
110	            resource_model=model,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/edge.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
192	    result = (
193	        start_thread(run_command, quiet=True, name="sudo-edge") if asynchronous else run_command()
194	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	def add_api_destination_authorization(destination, headers, event):
198	    connection_arn = destination.get("ConnectionArn", "")
199	    connection_name = re.search(r"connection\/([a-zA-Z0-9-_]+)\/", connection_arn).group(1)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	
217	    auth_parameters = connection_details.get("AuthParameters", {})
218	    invocation_parameters = auth_parameters.get("InvocationHttpParameters")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	    auth_parameters = connection_details.get("AuthParameters", {})
218	    invocation_parameters = auth_parameters.get("InvocationHttpParameters")
219	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
219	
220	    endpoint = destination.get("InvocationEndpoint")
221	    if invocation_parameters:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	        header_parameters = list_of_parameters_to_object(
223	            invocation_parameters.get("HeaderParameters", [])
224	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	        body_parameters = list_of_parameters_to_object(
228	            invocation_parameters.get("BodyParameters", [])
229	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	
232	        query_parameters = invocation_parameters.get("QueryStringParameters", [])
233	        query_object = list_of_parameters_to_object(query_parameters)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	
242	    auth_type = connection_details.get("AuthorizationType").upper()
243	    auth_parameters = connection_details.get("AuthParameters")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
242	    auth_type = connection_details.get("AuthorizationType").upper()
243	    auth_parameters = connection_details.get("AuthParameters")
244	    match auth_type:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
245	        case ConnectionAuthorizationType.BASIC:
246	            username = auth_secret.get("username", "")
247	            password = auth_secret.get("password", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	            username = auth_secret.get("username", "")
247	            password = auth_secret.get("password", "")
248	            auth = "Basic " + to_str(base64.b64encode(f"{username}:{password}".encode("ascii")))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
247	            password = auth_secret.get("password", "")
248	            auth = "Basic " + to_str(base64.b64encode(f"{username}:{password}".encode("ascii")))
249	            headers.update({"authorization": auth})

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:248
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
247	            password = auth_secret.get("password", "")
248	            auth = "Basic " + to_str(base64.b64encode(f"{username}:{password}".encode("ascii")))
249	            headers.update({"authorization": auth})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	        case ConnectionAuthorizationType.API_KEY:
252	            api_key_name = auth_secret.get("api_key_name", "")
253	            api_key_value = auth_secret.get("api_key_value", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	            api_key_name = auth_secret.get("api_key_name", "")
253	            api_key_value = auth_secret.get("api_key_value", "")
254	            headers.update({api_key_name: api_key_value})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	        case ConnectionAuthorizationType.OAUTH_CLIENT_CREDENTIALS:
257	            oauth_parameters = auth_parameters.get("OAuthParameters", {})
258	            oauth_method = auth_secret.get("http_method")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257	            oauth_parameters = auth_parameters.get("OAuthParameters", {})
258	            oauth_method = auth_secret.get("http_method")
259	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	
260	            oauth_http_parameters = oauth_parameters.get("OAuthHttpParameters", {})
261	            oauth_endpoint = auth_secret.get("authorization_endpoint", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	            oauth_http_parameters = oauth_parameters.get("OAuthHttpParameters", {})
261	            oauth_endpoint = auth_secret.get("authorization_endpoint", "")
262	            query_object = list_of_parameters_to_object(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	            query_object = list_of_parameters_to_object(
263	                oauth_http_parameters.get("QueryStringParameters", [])
264	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
266	
267	            client_id = auth_secret.get("client_id", "")
268	            client_secret = auth_secret.get("client_secret", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
267	            client_id = auth_secret.get("client_id", "")
268	            client_secret = auth_secret.get("client_secret", "")
269	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
270	            oauth_body = list_of_parameters_to_object(
271	                oauth_http_parameters.get("BodyParameters", [])
272	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	            oauth_header = list_of_parameters_to_object(
276	                oauth_http_parameters.get("HeaderParameters", [])
277	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
277	            )
278	            oauth_result = requests.request(
279	                method=oauth_method,
280	                url=oauth_endpoint,
281	                data=json.dumps(oauth_body),
282	                headers=oauth_header,
283	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
277	            )
278	            oauth_result = requests.request(
279	                method=oauth_method,
280	                url=oauth_endpoint,
281	                data=json.dumps(oauth_body),
282	                headers=oauth_header,
283	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
285	
286	            token_type = oauth_data.get("token_type", "")
287	            access_token = oauth_data.get("access_token", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/api_destination.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
286	            token_type = oauth_data.get("token_type", "")
287	            access_token = oauth_data.get("access_token", "")
288	            auth_header = f"{token_type} {access_token}"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/provider.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
183	    """Decode a pagination token from base64 to integer."""
184	    return int.from_bytes(base64.b64decode(token), "big")
185	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/provider.py:184
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
183	    """Decode a pagination token from base64 to integer."""
184	    return int.from_bytes(base64.b64decode(token), "big")
185	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/provider.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
188	    """Encode a pagination token to base64 from integer."""
189	    return base64.b64encode(token.to_bytes(128, "big")).decode("utf-8")
190	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/provider.py:189
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
188	    """Encode a pagination token to base64 from integer."""
189	    return base64.b64encode(token.to_bytes(128, "big")).decode("utf-8")
190	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	    template_replacements = {}
80	    transformer_path_map = input_transformer.get("InputPathsMap", {})
81	    for placeholder, transformer_path in transformer_path_map.items():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	        key = match.group(1)
99	        value = replacements.get(key, "")  # handle non defined placeholders
100	        if isinstance(value, datetime.datetime):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	        """Processes the event and send it to the target."""
201	        if input_ := self.target.get("Input"):
202	            event = json.loads(input_)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	        if not input_:
206	            if input_path := self.target.get("InputPath"):
207	                event = transform_event_with_target_input_path(input_path, event)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	                event = transform_event_with_target_input_path(input_path, event)
208	            if input_transformer := self.target.get("InputTransformer"):
209	                event = self.transform_event_with_target_input_transformer(input_transformer, event)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	        else:
213	            LOG.info("No event to send to target %s", self.target.get("Id"))
214	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
234	            raise ValidationException(
235	                f"Only one of Input, InputPath, or InputTransformer must be provided for target {target.get('Id')}."
236	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	            )
237	        if input_transformer := target.get("InputTransformer"):
238	            self._validate_input_transformer(input_transformer)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
245	        service_principal = ServicePrincipal.events
246	        role_arn = self.target.get("RoleArn")
247	        if role_arn:  # required for cross account

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
266	        input_template = input_transformer["InputTemplate"]
267	        input_paths_map = input_transformer.get("InputPathsMap", {})
268	        placeholders = TRANSFORMER_PLACEHOLDER_PATTERN.findall(input_template)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	                raise ValidationException(
272	                    f"InputTemplate for target {self.target.get('Id')} contains invalid placeholder {placeholder}."
273	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
335	        # Replace wildcards in resource path with PathParameterValues
336	        path_params_values = self.target.get("HttpParameters", {}).get("PathParameterValues", [])
337	        resource_path_segments = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
335	        # Replace wildcards in resource path with PathParameterValues
336	        path_params_values = self.target.get("HttpParameters", {}).get("PathParameterValues", [])
337	        resource_path_segments = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
354	        # Construct query string parameters
355	        query_params = self.target.get("HttpParameters", {}).get("QueryStringParameters", {})
356	        query_string = urlencode(query_params) if query_params else ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
354	        # Construct query string parameters
355	        query_params = self.target.get("HttpParameters", {}).get("QueryStringParameters", {})
356	        query_string = urlencode(query_params) if query_params else ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	        # Construct headers
359	        headers = self.target.get("HttpParameters", {}).get("HeaderParameters", {})
360	        headers = {k: v for k, v in headers.items() if k.lower() not in self.PROHIBITED_HEADERS}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	        # Construct headers
359	        headers = self.target.get("HttpParameters", {}).get("HeaderParameters", {})
360	        headers = {k: v for k, v in headers.items() if k.lower() not in self.PROHIBITED_HEADERS}

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
386	        # Send the HTTP request
387	        response = requests.request(
388	            method=http_method, url=url, headers=headers, data=event_json, timeout=5
389	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
386	        # Send the HTTP request
387	        response = requests.request(
388	            method=http_method, url=url, headers=headers, data=event_json, timeout=5
389	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	        predefined_template_replacements["aws.events.rule-name"] = self.rule_name
408	        predefined_template_replacements["aws.events.event.ingestion-time"] = event.get("time", "")
409	        predefined_template_replacements["aws.events.event"] = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
451	        detail_type = self._get_detail_type(event)
452	        detail = event.get("detail", event)
453	        resources = self._get_resources(event)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
469	    def _get_source(self, event: FormattedEvent | TransformedEvent) -> str:
470	        if isinstance(event, dict) and (source := event.get("source")):
471	            return source

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
475	    def _get_detail_type(self, event: FormattedEvent | TransformedEvent) -> str:
476	        if isinstance(event, dict) and (detail_type := event.get("detail-type")):
477	            return detail_type

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
481	    def _get_resources(self, event: FormattedEvent | TransformedEvent) -> list[str]:
482	        if isinstance(event, dict) and (resources := event.get("resources")):
483	            return resources

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
502	        # get destination endpoint details
503	        method = destination.get("HttpMethod", "GET")
504	        endpoint = destination.get("InvocationEndpoint")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
503	        method = destination.get("HttpMethod", "GET")
504	        endpoint = destination.get("InvocationEndpoint")
505	        state = destination.get("ApiDestinationState") or "ACTIVE"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
504	        endpoint = destination.get("InvocationEndpoint")
505	        state = destination.get("ApiDestinationState") or "ACTIVE"
506	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	        endpoint = add_api_destination_authorization(destination, headers, event)
520	        if http_parameters := self.target.get("HttpParameters"):
521	            endpoint = add_target_http_parameters(http_parameters, endpoint, headers, event)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
522	
523	        result = requests.request(
524	            method=method, url=endpoint, data=json.dumps(event or {}), headers=headers
525	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
522	
523	        result = requests.request(
524	            method=method, url=endpoint, data=json.dumps(event or {}), headers=headers
525	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
616	        queue_url = sqs_queue_url_for_arn(self.target["Arn"])
617	        msg_group_id = self.target.get("SqsParameters", {}).get("MessageGroupId", None)
618	        kwargs = {"MessageGroupId": msg_group_id} if msg_group_id else {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/events/target.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
616	        queue_url = sqs_queue_url_for_arn(self.target["Arn"])
617	        msg_group_id = self.target.get("SqsParameters", {}).get("MessageGroupId", None)
618	        kwargs = {"MessageGroupId": msg_group_id} if msg_group_id else {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	    store = FirehoseProvider.get_store(context.account_id, context.region)
140	    delivery_stream_description = store.delivery_streams.get(delivery_stream_name)
141	    if not delivery_stream_description:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	    if "AWS_ACCESS_KEY_ID" in os.environ and "AWS_SECRET_ACCESS_KEY" in os.environ:
190	        access_key = os.environ.get("AWS_ACCESS_KEY_ID")
191	        secret_key = os.environ.get("AWS_SECRET_ACCESS_KEY")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	        access_key = os.environ.get("AWS_ACCESS_KEY_ID")
191	        secret_key = os.environ.get("AWS_SECRET_ACCESS_KEY")
192	        session_token = os.environ.get("AWS_SESSION_TOKEN")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	        secret_key = os.environ.get("AWS_SECRET_ACCESS_KEY")
192	        session_token = os.environ.get("AWS_SESSION_TOKEN")
193	        awsauth = AWS4Auth(access_key, secret_key, region_name, "es", session_token=session_token)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	    for destination in destinations:
210	        if amazon_open_search_service_destination_description := destination.get(
211	            "AmazonopensearchserviceDestinationDescription"
212	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	            )
218	        if elasticsearch_destination_description := destination.get(
219	            "ElasticsearchDestinationDescription"
220	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	            )
226	        if http_endpoint_destination_description := destination.get(
227	            "HttpEndpointDestinationDescription"
228	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
233	            )
234	        if redshift_destination_description := destination.get("RedshiftDestinationDescription"):
235	            destination["RedshiftDestinationDescription"] = select_from_typed_dict(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
239	            )
240	        if s3_destination_description := destination.get("S3DestinationDescription"):
241	            destination["S3DestinationDescription"] = select_from_typed_dict(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
436	        )
437	        if destinations := delivery_stream_description.get("Destinations"):
438	            delivery_stream_description["Destinations"] = (

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
597	        if "Data" in record:
598	            record["Data"] = base64.b64encode(record["Data"])
599	        return record

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:598
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
597	        if "Data" in record:
598	            record["Data"] = base64.b64encode(record["Data"])
599	        return record

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
634	        store = self.get_store(account_id, region_name)
635	        delivery_stream_description = store.delivery_streams.get(delivery_stream_name)
636	        if not delivery_stream_description:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	
644	        for destination in delivery_stream_description.get("Destinations", []):
645	            # apply processing steps to incoming items

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
648	                proc_config = (
649	                    isinstance(child, dict) and child.get("ProcessingConfiguration") or proc_config
650	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
651	            records = list(unprocessed_records)
652	            if proc_config.get("Enabled") is not False:
653	                for processor in proc_config.get("Processors", []):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
652	            if proc_config.get("Enabled") is not False:
653	                for processor in proc_config.get("Processors", []):
654	                    # TODO: run processors asynchronously, to avoid request timeouts on PutRecord API calls

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
690	                for record in records:
691	                    data = record.get("Data") or record.get("data")
692	                    record_to_send["records"].append({"data": to_str(data)})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:691
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
690	                for record in records:
691	                    data = record.get("Data") or record.get("data")
692	                    record_to_send["records"].append({"data": to_str(data)})

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
696	                try:
697	                    requests.post(url, json=record_to_send, headers=headers)
698	                except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
725	        search_db_index = db_description["IndexName"]
726	        domain_arn = db_description.get("DomainARN")
727	        cluster_endpoint = db_description.get("ClusterEndpoint")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
726	        domain_arn = db_description.get("DomainARN")
727	        cluster_endpoint = db_description.get("ClusterEndpoint")
728	        if cluster_endpoint is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
732	
733	        if db_description.get("S3BackupMode") == ElasticsearchS3BackupMode.AllDocuments:
734	            s3_dest_desc = db_description.get("S3DestinationDescription")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
733	        if db_description.get("S3BackupMode") == ElasticsearchS3BackupMode.AllDocuments:
734	            s3_dest_desc = db_description.get("S3DestinationDescription")
735	            if s3_dest_desc:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
745	                LOG.warning("Passed S3BackupMode without S3Configuration. Cannot backup...")
746	        elif db_description.get("S3BackupMode") == ElasticsearchS3BackupMode.FailedDocumentsOnly:
747	            # TODO support FailedDocumentsOnly as well

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
754	            if "Data" in record:
755	                data = base64.b64decode(record["Data"])
756	            # KinesisAsSource

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:755
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
754	            if "Data" in record:
755	                data = base64.b64decode(record["Data"])
756	            # KinesisAsSource

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
757	            elif "data" in record:
758	                data = base64.b64decode(record["data"])
759	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:758
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
757	            elif "data" in record:
758	                data = base64.b64decode(record["data"])
759	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
779	        def _get_entry(obj, key):
780	            return obj.get(key) or obj.get(first_char_to_lower(key))
781	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
779	        def _get_entry(obj, key):
780	            return obj.get(key) or obj.get(first_char_to_lower(key))
781	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
799	        """Preprocess the list of records by calling the given processor (e.g., Lamnda function)."""
800	        proc_type = processor.get("Type")
801	        parameters = processor.get("Parameters", [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
800	        proc_type = processor.get("Type")
801	        parameters = processor.get("Parameters", [])
802	        parameters = {p["ParameterName"]: p["ParameterValue"] for p in parameters}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
803	        if proc_type == "Lambda":
804	            lambda_arn = parameters.get("LambdaArn")
805	            # TODO: add support for other parameters, e.g., NumberOfRetries, BufferSizeInMBs, BufferIntervalInSeconds, ...

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
820	            response = client.invoke(FunctionName=lambda_arn, Payload=event)
821	            result = json.load(response["Payload"])
822	            records = result.get("records", []) if result else []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
821	            result = json.load(response["Payload"])
822	            records = result.get("records", []) if result else []
823	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:834
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
833	        bucket = s3_bucket_name(s3_destination_description["BucketARN"])
834	        prefix = s3_destination_description.get("Prefix", "")
835	        file_extension = s3_destination_description.get("FileExtension", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
834	        prefix = s3_destination_description.get("Prefix", "")
835	        file_extension = s3_destination_description.get("FileExtension", "")
836	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
836	
837	        if role_arn := s3_destination_description.get("RoleARN"):
838	            factory = connect_to.with_assumed_role(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
845	        )
846	        batched_data = b"".join([base64.b64decode(r.get("Data") or r.get("data")) for r in records])
847	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:846
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
845	        )
846	        batched_data = b"".join([base64.b64decode(r.get("Data") or r.get("data")) for r in records])
847	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
845	        )
846	        batched_data = b"".join([base64.b64decode(r.get("Data") or r.get("data")) for r in records])
847	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
845	        )
846	        batched_data = b"".join([base64.b64decode(r.get("Data") or r.get("data")) for r in records])
847	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:879
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
878	    ):
879	        jdbcurl = redshift_destination_description.get("ClusterJDBCURL")
880	        cluster_id = self._get_cluster_id_from_jdbc_url(jdbcurl)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
881	        db_name = jdbcurl.split("/")[-1]
882	        table_name = redshift_destination_description.get("CopyCommand").get("DataTableName")
883	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
881	        db_name = jdbcurl.split("/")[-1]
882	        table_name = redshift_destination_description.get("CopyCommand").get("DataTableName")
883	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
893	
894	        role_arn = redshift_destination_description.get("RoleARN")
895	        account_id = extract_account_id_from_arn(role_arn)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
932	    def _decode_record(self, record: Dict) -> Dict:
933	        data = base64.b64decode(record.get("Data") or record.get("data"))
934	        data = to_str(data)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:933
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
932	    def _decode_record(self, record: Dict) -> Dict:
933	        data = base64.b64decode(record.get("Data") or record.get("data"))
934	        data = to_str(data)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
932	    def _decode_record(self, record: Dict) -> Dict:
933	        data = base64.b64decode(record.get("Data") or record.get("data"))
934	        data = to_str(data)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/firehose/provider.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
932	    def _decode_record(self, record: Dict) -> Dict:
933	        data = base64.b64decode(record.get("Data") or record.get("data"))
934	        data = to_str(data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kinesis/kinesis_mock_server.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
41	        LOG.debug("starting kinesis process %s with env vars %s", cmd, env_vars)
42	        t = ShellCommandThread(
43	            cmd,
44	            strip_color=True,
45	            env_vars=env_vars,
46	            log_listener=self._log_listener,
47	            auto_restart=True,
48	            name="kinesis-mock",
49	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kms/models.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
146	            if key not in IGNORED_CONTEXT_KEYS:
147	                aad.write(key.encode("utf-8"))
148	                aad.write(value.encode("utf-8"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kms/models.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	                aad.write(key.encode("utf-8"))
148	                aad.write(value.encode("utf-8"))
149	        return aad.getvalue()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kms/models.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
288	            # check if the _custom_key_material_ tag is specified, to use a custom key material for this key
289	            custom_key_material = base64.b64decode(self.tags[TAG_KEY_CUSTOM_KEY_MATERIAL])
290	            # remove the _custom_key_material_ tag from the tags to not readily expose the custom key material

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kms/models.py:289
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
288	            # check if the _custom_key_material_ tag is specified, to use a custom key material for this key
289	            custom_key_material = base64.b64decode(self.tags[TAG_KEY_CUSTOM_KEY_MATERIAL])
290	            # remove the _custom_key_material_ tag from the tags to not readily expose the custom key material

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kms/models.py:764
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
763	        decoded_token = account_id + ":" + region_name + ":" + long_uid()
764	        self.token = to_str(base64.b64encode(to_bytes(decoded_token)))
765	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kms/models.py:764
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
763	        decoded_token = account_id + ":" + region_name + ":" + long_uid()
764	        self.token = to_str(base64.b64encode(to_bytes(decoded_token)))
765	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kms/provider.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
651	        if grant_token:
652	            decoded_token = to_str(base64.b64decode(grant_token))
653	            grant_account_id, grant_region_name, _ = decoded_token.split(":")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kms/provider.py:652
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
651	        if grant_token:
652	            decoded_token = to_str(base64.b64decode(grant_token))
653	            grant_account_id, grant_region_name, _ = decoded_token.split(":")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/kms/utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        raise ValidationException(
41	            'Alias must start with the prefix "alias/". Please see '
42	            "https://docs.aws.amazon.com/kms/latest/developerguide/kms-alias.html"
43	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/event_source_mapping/pollers/kinesis_poller.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
121	                # boto3 automatically decodes records in get_records(), so we must re-encode
122	                "data": to_str(base64.b64encode(record["Data"])),
123	                "approximateArrivalTimestamp": record["ApproximateArrivalTimestamp"].timestamp(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/event_source_mapping/pollers/kinesis_poller.py:122
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
121	                # boto3 automatically decodes records in get_records(), so we must re-encode
122	                "data": to_str(base64.b64encode(record["Data"])),
123	                "approximateArrivalTimestamp": record["ApproximateArrivalTimestamp"].timestamp(),

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/event_source_mapping/pollers/kinesis_poller.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
198	    def parse_data(self, raw_data: str) -> dict | str:
199	        decoded_data = base64.b64decode(raw_data)
200	        return json.loads(decoded_data)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/event_source_mapping/pollers/kinesis_poller.py:199
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
198	    def parse_data(self, raw_data: str) -> dict | str:
199	        decoded_data = base64.b64decode(raw_data)
200	        return json.loads(decoded_data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/event_source_mapping/pollers/kinesis_poller.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
202	    def encode_data(self, parsed_data: dict) -> str:
203	        return base64.b64encode(json.dumps(parsed_data).encode()).decode()
204	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/event_source_mapping/pollers/kinesis_poller.py:203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
202	    def encode_data(self, parsed_data: dict) -> str:
203	        return base64.b64encode(json.dumps(parsed_data).encode()).decode()
204	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/assignment.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
42	        self.environments = defaultdict(dict)
43	        self.provisioning_pool = ThreadPoolExecutor(thread_name_prefix="lambda-provisioning-pool")
44	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/docker_runtime_executor.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
117	            HINT_LOG.error(
118	                "Failed to pull Docker image because Docker is not available in the LocalStack container "
119	                "but required to run Lambda functions. Please add the Docker volume mount "
120	                '"/var/run/docker.sock:/var/run/docker.sock" to your LocalStack startup. '

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/docker_runtime_executor.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
229	    with docker_file_path.open(mode="w") as f:
230	        f.write(prebuild_context.docker_file_content)
231	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/docker_runtime_executor.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
432	        if config.LAMBDA_DEV_PORT_EXPOSE:
433	            self.ip = "127.0.0.1"
434	        self.executor_endpoint.container_address = self.ip

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/docker_runtime_executor.py:509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
508	            LOG.warning(
509	                "WARNING: Docker not available in the LocalStack container but required to run Lambda "
510	                'functions. Please add the Docker volume mount "/var/run/docker.sock:/var/run/docker.sock" to your '
511	                "LocalStack startup. https://docs.localstack.cloud/user-guide/aws/lambda/#docker-not-available"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/event_manager.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
62	            {
63	                "payload": to_str(base64.b64encode(self.invocation.payload)),
64	                "invoked_arn": self.invocation.invoked_arn,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/event_manager.py:63
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
62	            {
63	                "payload": to_str(base64.b64encode(self.invocation.payload)),
64	                "invoked_arn": self.invocation.invoked_arn,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/event_manager.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
79	        invocation = Invocation(
80	            payload=base64.b64decode(invocation_dict["payload"]),
81	            invoked_arn=invocation_dict["invoked_arn"],

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/event_manager.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
79	        invocation = Invocation(
80	            payload=base64.b64decode(invocation_dict["payload"]),
81	            invoked_arn=invocation_dict["invoked_arn"],

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/event_manager.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
140	        # TODO: think about scaling, test it, make it configurable?!
141	        self.invoker_pool = ThreadPoolExecutor(
142	            thread_name_prefix=f"lambda-invoker-{function_id.function_name}:{function_id.qualifier}"
143	        )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/execution_environment.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
137	            "_AWS_XRAY_DAEMON_PORT": "2000",
138	            "_AWS_XRAY_DAEMON_ADDRESS": "127.0.0.1",
139	            # AWS_LAMBDA_DOTNET_PREJIT
140	            "TZ": ":UTC",
141	            # 2) Public AWS RIE interface: https://github.com/aws/aws-lambda-runtime-interface-emulator
142	            "AWS_LAMBDA_FUNCTION_TIMEOUT": self._get_execution_timeout_seconds(),
143	            # 3) Public LocalStack endpoint
144	            "LOCALSTACK_HOSTNAME": self.runtime_executor.get_endpoint_from_executor(),
145	            "EDGE_PORT": str(config.GATEWAY_LISTEN[0].port),
146	            # AWS_ENDPOINT_URL conditionally added below
147	            # 4) Internal LocalStack runtime API
148	            "LOCALSTACK_RUNTIME_ID": self.id,
149	            "LOCALSTACK_RUNTIME_ENDPOINT": self.runtime_executor.get_runtime_endpoint(),
150	            # 5) Account of the function (necessary for extensions API)
151	            "LOCALSTACK_FUNCTION_ACCOUNT_ID": self.function_version.id.account,
152	            # used by the init to spawn the x-ray daemon
153	            # LOCALSTACK_USER conditionally added below
154	        }
155	        # Conditionally added environment variables
156	        if not config.LAMBDA_DISABLE_AWS_ENDPOINT_URL:
157	            env_vars["AWS_ENDPOINT_URL"] = (
158	                f"http://{self.runtime_executor.get_endpoint_from_executor()}:{config.GATEWAY_LISTEN[0].port}"
159	            )
160	        # config.handler is None for image lambdas and will be populated at runtime (e.g., by RIE)
161	        if self.function_version.config.handler:
162	            env_vars["_HANDLER"] = self.function_version.config.handler
163	        # Will be overridden by the runtime itself unless it is a provided runtime
164	        if self.function_version.config.runtime:
165	            env_vars["AWS_EXECUTION_ENV"] = "AWS_Lambda_rapid"
166	        if self.function_version.config.environment:
167	            env_vars.update(self.function_version.config.environment)
168	        if config.LAMBDA_INIT_DEBUG:
169	            # Disable dropping privileges because it breaks debugging
170	            env_vars["LOCALSTACK_USER"] = "root"
171	        # Forcefully overwrite the user might break debugging!
172	        if config.LAMBDA_INIT_USER is not None:
173	            env_vars["LOCALSTACK_USER"] = config.LAMBDA_INIT_USER
174	        if config.LS_LOG in config.TRACE_LOG_LEVELS:
175	            env_vars["LOCALSTACK_INIT_LOG_LEVEL"] = "info"
176	        if config.LAMBDA_INIT_POST_INVOKE_WAIT_MS:
177	            env_vars["LOCALSTACK_POST_INVOKE_WAIT_MS"] = int(config.LAMBDA_INIT_POST_INVOKE_WAIT_MS)
178	        if config.LAMBDA_LIMITS_MAX_FUNCTION_PAYLOAD_SIZE_BYTES:
179	            env_vars["LOCALSTACK_MAX_PAYLOAD_SIZE"] = int(
180	                config.LAMBDA_LIMITS_MAX_FUNCTION_PAYLOAD_SIZE_BYTES
181	            )
182	        return env_vars
183	
184	    # Lifecycle methods
185	    def start(self) -> None:
186	        """

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/executor_endpoint.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
194	        proxies = {"http": "", "https": ""}
195	        response = requests.post(url=invocation_url, json=payload, proxies=proxies)
196	        if not response.ok:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/lambda_models.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
220	        try:
221	            shutil.rmtree(code_path)
222	        except OSError as e:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/lambda_service.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
88	        self.lambda_version_manager_lock = RLock()
89	        self.task_executor = ThreadPoolExecutor(thread_name_prefix="lambda-service-task")
90	        self.assignment_service = AssignmentService()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/lambda_service.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
290	                HINT_LOG.error(
291	                    f"Failed to create the runtime executor for the function {function_name}. "
292	                    "Please ensure that Docker is available in the LocalStack container by adding the volume mount "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/lambda_service.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
298	                HINT_LOG.warning(
299	                    "Lambda functions are created and updated asynchronously in the new lambda provider like in AWS. "
300	                    f"Before invoking {function_name}, please wait until the function transitioned from the state "
301	                    "Pending to Active using: "
302	                    f'"awslocal lambda wait function-active-v2 --function-name {function_name}" '
303	                    "Check out https://docs.localstack.cloud/user-guide/aws/lambda/#function-in-pending-state"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/lambda_service.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
583	    s3_client.upload_fileobj(Fileobj=io.BytesIO(archive_file), Bucket=bucket_name, Key=key)
584	    code_sha256 = to_str(base64.b64encode(sha256(archive_file).digest()))
585	    return S3Code(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/lambda_service.py:584
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
583	    s3_client.upload_fileobj(Fileobj=io.BytesIO(archive_file), Bucket=bucket_name, Key=key)
584	    code_sha256 = to_str(base64.b64encode(sha256(archive_file).digest()))
585	    return S3Code(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/invocation/lambda_service.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
644	    kwargs = {"VersionId": archive_version} if archive_version else {}
645	    archive_file = s3_client.get_object(Bucket=archive_bucket, Key=archive_key, **kwargs)[
646	        "Body"
647	    ].read()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/packages.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	LAMBDA_RUNTIME_VERSION = config.LAMBDA_INIT_RELEASE_VERSION or LAMBDA_RUNTIME_DEFAULT_VERSION
18	LAMBDA_RUNTIME_INIT_URL = "https://github.com/localstack/lambda-runtime-init/releases/download/{version}/aws-lambda-rie-{arch}"
19	
20	"""Unmaintained Java utilities and JUnit integration for LocalStack released to Maven Central.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/packages.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	LOCALSTACK_MAVEN_VERSION = "0.2.21"
26	MAVEN_REPO_URL = "https://repo1.maven.org/maven2"
27	URL_LOCALSTACK_FAT_JAR = (

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/packages.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
69	        st = os.stat(install_location)
70	        os.chmod(install_location, mode=st.st_mode | stat.S_IXUSR | stat.S_IXGRP | stat.S_IXOTH)
71	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/packages.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
69	        st = os.stat(install_location)
70	        os.chmod(install_location, mode=st.st_mode | stat.S_IXUSR | stat.S_IXGRP | stat.S_IXOTH)
71	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/provider.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
913	            LOG.warning(
914	                "The Lambda runtime %s} is deprecated. "
915	                "Please upgrade the runtime for the function %s: "
916	                "https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html",
917	                runtime,
918	                function_name,
919	            )
920	        if snap_start := request.get("SnapStart"):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/provider.py:1196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1195	                LOG.warning(
1196	                    "The Lambda runtime %s is deprecated. "
1197	                    "Please upgrade the runtime for the function %s: "
1198	                    "https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html",
1199	                    runtime,
1200	                    function_name,
1201	                )
1202	            replace_kwargs["runtime"] = request["Runtime"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/provider.py:1601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1600	                trace_context=context.trace_context,
1601	                payload=payload.read() if payload else None,
1602	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/provider.py:1639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1638	            response["LogResult"] = to_str(
1639	                base64.b64encode(to_bytes(invocation_result.logs)[-4096:])
1640	            )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/provider.py:1639
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1638	            response["LogResult"] = to_str(
1639	                base64.b64encode(to_bytes(invocation_result.logs)[-4096:])
1640	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/provider.py:1926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1925	                queue_name = arn["resource"].split("/")[-1]
1926	                queue_url = f"http://sqs.{arn['region']}.domain/{arn['account']}/{queue_name}"
1927	                source_client.get_queue_attributes(QueueUrl=queue_url)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/urlrouter.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
119	
120	    data = restore_payload(request)
121	    headers = request.headers

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/urlrouter.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
145	    is_base64_encoded = not (data.isascii() and content_type_is_text) if data else False
146	    body = base64.b64encode(data).decode() if is_base64_encoded else data
147	    if isinstance(body, bytes):

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/urlrouter.py:146
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
145	    is_base64_encoded = not (data.isascii() and content_type_is_text) if data else False
146	    body = base64.b64encode(data).decode() if is_base64_encoded else data
147	    if isinstance(body, bytes):

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/urlrouter.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
216	            body_bytes = to_bytes(to_str(parsed_result.get("body", "")))
217	            decoded_body_bytes = base64.b64decode(body_bytes)
218	            response.data = decoded_body_bytes

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/lambda_/urlrouter.py:217
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
216	            body_bytes = to_bytes(to_str(parsed_result.get("body", "")))
217	            decoded_body_bytes = base64.b64decode(body_bytes)
218	            response.data = decoded_body_bytes

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/logs/provider.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
369	            payload_gz_encoded = output.getvalue()
370	            event = {"awslogs": {"data": base64.b64encode(output.getvalue()).decode("utf-8")}}
371	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/logs/provider.py:370
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
369	            payload_gz_encoded = output.getvalue()
370	            event = {"awslogs": {"data": base64.b64encode(output.getvalue()).decode("utf-8")}}
371	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
37	INTERNAL_USER_AUTH = ("localstack-internal", "localstack-internal")
38	DEFAULT_BACKEND_HOST = "127.0.0.1"
39	
40	CommandSettings = Dict[str, str]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	        headers["Host"] = host
62	    resp = requests.get(url + "/_cluster/health", headers=headers, verify=False, auth=auth)
63	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	            return SecurityOptions(enabled=False, master_username=None, master_password=None)
190	        if not advanced_security_options.get("InternalUserDatabaseEnabled", False):
191	            LOG.warning(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
195	
196	        master_username = advanced_security_options.get("MasterUserOptions", {}).get(
197	            "MasterUserName", None
198	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
195	
196	        master_username = advanced_security_options.get("MasterUserOptions", {}).get(
197	            "MasterUserName", None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	        )
199	        master_password = advanced_security_options.get("MasterUserOptions", {}).get(
200	            "MasterUserPassword", None
201	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	        )
199	        master_password = advanced_security_options.get("MasterUserOptions", {}).get(
200	            "MasterUserPassword", None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
358	        LOG.info("starting %s: %s with env %s", self.bin_name, cmd, env_vars)
359	        t = ShellCommandThread(
360	            cmd,
361	            env_vars=env_vars,
362	            strip_color=True,
363	            log_listener=self._log_listener,
364	            name="opensearch-cluster",
365	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
371	        # wait for the cluster to be up and running and perform the post-startup setup
372	        threading.Thread(
373	            target=self._post_start_setup,
374	            daemon=True,
375	        ).start()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
469	            "JAVA_HOME": os.path.join(directories.install, "jdk"),
470	            "OPENSEARCH_JAVA_OPTS": os.environ.get("OPENSEARCH_JAVA_OPTS", "-Xms200m -Xmx600m"),
471	            "OPENSEARCH_TMPDIR": directories.tmp,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
478	            prefix = (
479	                f"{os.environ.get('LD_LIBRARY_PATH')}:" if "LD_LIBRARY_PATH" in os.environ else ""
480	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster.py:705
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
704	            **elasticsearch_package.get_installer(self.version).get_java_env_vars(),
705	            "ES_JAVA_OPTS": os.environ.get("ES_JAVA_OPTS", "-Xms200m -Xmx600m"),
706	            "ES_TMPDIR": directories.tmp,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/cluster_manager.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
293	
294	                start_thread(_start_async, name="opensearch-multiplex")
295	            cluster_endpoint = ClusterEndpoint(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/provider.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
180	    # access from another device on the network.
181	    status["Endpoint"] = cluster.url.split("://")[-1].replace("0.0.0.0", localstack_host().host)
182	    status["EngineVersion"] = engine_version

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/provider.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
188	        # the cluster state once it is started, or the CLUSTER_STARTUP_TIMEOUT is reached
189	        threading.Thread(
190	            target=_run_cluster_startup_monitor,
191	            args=(cluster, domain_key.domain_name, domain_key.region),
192	            daemon=True,
193	        ).start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/versions.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
280	    return (
281	        f"https://artifacts.opensearch.org/releases/bundle/opensearch/"
282	        f"{version}/opensearch-{version}-linux-{arch}.tar.gz"
283	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/versions.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
288	    version = str(install_version)
289	    repo = "https://artifacts.elastic.co/downloads/elasticsearch"
290	    if install_version.major <= 6:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/versions.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
329	    while True:
330	        tags_raw = requests.get(
331	            f"https://api.github.com/repos/opensearch-project/OpenSearch/tags?per_page=100&page={i}"
332	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/opensearch/versions.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
330	        tags_raw = requests.get(
331	            f"https://api.github.com/repos/opensearch-project/OpenSearch/tags?per_page=100&page={i}"
332	        )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/plugins.py:682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
681	    # no special significance to 10 workers, seems like a reasonable number given the number of services we have
682	    with ThreadPoolExecutor(max_workers=10) as executor:
683	        executor.map(check, names)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/constants.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	AUTHENTICATED_USERS_ACL_GROUP = "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"
25	ALL_USERS_ACL_GROUP = "http://acs.amazonaws.com/groups/global/AllUsers"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/constants.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	AUTHENTICATED_USERS_ACL_GROUP = "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"
25	ALL_USERS_ACL_GROUP = "http://acs.amazonaws.com/groups/global/AllUsers"
26	LOG_DELIVERY_ACL_GROUP = "http://acs.amazonaws.com/groups/s3/LogDelivery"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/constants.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	ALL_USERS_ACL_GROUP = "http://acs.amazonaws.com/groups/global/AllUsers"
26	LOG_DELIVERY_ACL_GROUP = "http://acs.amazonaws.com/groups/s3/LogDelivery"
27	
28	VALID_ACL_PREDEFINED_GROUPS = {

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/cors.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
106	        request = context.request
107	        is_s3, bucket_name = self.pre_parse_s3_request(context.request)
108	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/cors.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
135	            if is_options_request:
136	                context.operation = self._get_op_from_request(request)
137	                raise BadRequest(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/cors.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
166	
167	                    context.operation = self._get_op_from_request(request)
168	                    raise AccessForbidden(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/cors.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
181	            if is_options_request:
182	                context.operation = self._get_op_from_request(request)
183	                raise AccessForbidden(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/models.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
548	
549	                part_checksum_value = base64.b64decode(s3_part.checksum_value)
550	                if self.checksum_type == ChecksumType.COMPOSITE:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/models.py:549
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
548	
549	                part_checksum_value = base64.b64decode(s3_part.checksum_value)
550	                if self.checksum_type == ChecksumType.COMPOSITE:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/models.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
583	        if has_checksum:
584	            checksum_value = base64.b64encode(checksum_hash.digest()).decode()
585	            if self.checksum_type == ChecksumType.COMPOSITE:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/models.py:584
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
583	        if has_checksum:
584	            checksum_value = base64.b64encode(checksum_hash.digest()).decode()
585	            if self.checksum_type == ChecksumType.COMPOSITE:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/notifications.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
321	            requestParameters={
322	                "sourceIPAddress": "127.0.0.1"
323	            },  # TODO sourceIPAddress was previously extracted from headers ("X-Forwarded-For")
324	            responseElements={

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/notifications.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
643	            "requester": "074255357339",
644	            "source-ip-address": "127.0.0.1",
645	            # TODO previously headers.get("X-Forwarded-For", "127.0.0.1").split(",")[0]
646	        }
647	        if ctx.key_version_id and ctx.key_version_id != "null":
648	            event_details["object"]["version-id"] = ctx.key_version_id
649	
650	        if "ObjectCreated" in ctx.event_type:
651	            entry["DetailType"] = "Object Created"
652	            event_type = ctx.event_type
653	            event_action = event_type[event_type.rindex(":") + 1 :]
654	            if event_action in ["Put", "Post", "Copy"]:
655	                event_type = f"{event_action}Object"
656	            # TODO: what about CompleteMultiformUpload??

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/notifications.py:746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
745	    def __init__(self, num_thread: int = 3):
746	        self.executor = ThreadPoolExecutor(num_thread, thread_name_prefix="s3_ev")
747	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
132	            raise NoCredentialsError()
133	        canonical_request = self.canonical_request(request)
134	        string_to_sign = self.string_to_sign(request, canonical_request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
187	        try:
188	            if not is_presigned_url_request(context):
189	                # validate headers, as some can raise ValueError in Moto

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
210	            context.service = self._service
211	            context.operation = self._get_op_from_request(context.request)
212	            raise

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
371	
372	    add_headers_to_original_request(context, headers)
373	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
432	    sigv4_context, exception = _find_valid_signature_through_ports(context)
433	    add_headers_to_original_request(context, sigv4_context.headers_in_qs)
434	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
562	
563	        if forwarded_from_virtual_host_addressed_request(self._headers):
564	            # FIXME: maybe move this so it happens earlier in the chain when using virtual host?

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
593	        self.path = urlparse.quote(self.path)
594	        self.aws_request = self._get_aws_request()
595	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
608	        self.signed_headers["host"] = updated_netloc
609	        self.aws_request = self._get_aws_request()
610	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:788
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
787	    try:
788	        policy_decoded = json.loads(base64.b64decode(policy).decode("utf-8"))
789	    except ValueError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/presigned_url.py:788
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
787	    try:
788	        policy_decoded = json.loads(base64.b64decode(policy).decode("utf-8"))
789	    except ValueError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:635
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
634	        location_constraint = (
635	            '<?xml version="1.0" encoding="UTF-8"?>\n'
636	            '<LocationConstraint xmlns="http://s3.amazonaws.com/doc/2006-03-01/">{{location}}</LocationConstraint>'
637	        )
638	
639	        location = s3_bucket.bucket_region if s3_bucket.bucket_region != "us-east-1" else ""
640	        location_constraint = location_constraint.replace("{{location}}", location)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
776	            # opening the lock and other requests can check this condition
777	            if if_none_match and object_exists_for_precondition_write(s3_bucket, key):
778	                raise PreconditionFailed(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
783	            elif if_match:
784	                verify_object_equality_precondition_write(s3_bucket, key, if_match)
785	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
785	
786	            s3_stored_object.write(body)
787	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:1707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1706	        decoded_continuation_token = (
1707	            to_str(base64.urlsafe_b64decode(continuation_token.encode()))
1708	            if continuation_token

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:1746
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1745	                is_truncated = True
1746	                next_continuation_token = to_str(base64.urlsafe_b64encode(s3_object.key.encode()))
1747	                break

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:2183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2182	            owner=s3_bucket.owner,
2183	            precondition=object_exists_for_precondition_write(s3_bucket, key),
2184	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:2318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2317	            try:
2318	                stored_s3_part.write(body)
2319	            except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:2505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2504	                )
2505	            if object_exists_for_precondition_write(s3_bucket, key):
2506	                raise PreconditionFailed(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:2524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2523	                )
2524	            verify_object_equality_precondition_write(
2525	                s3_bucket, key, if_match, initiated=s3_multipart.initiated
2526	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/provider.py:4317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4316	        with self._storage_backend.open(bucket, s3_object, mode="w") as s3_stored_object:
4317	            s3_stored_object.write(stream)
4318	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
92	            self.file.seek(self._pos)
93	            data = self.file.read(s)
94	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	
158	            while data := stream.read(S3_CHUNK_SIZE):
159	                file.write(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
158	            while data := stream.read(S3_CHUNK_SIZE):
159	                file.write(data)
160	                etag.update(data)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
158	            while data := stream.read(S3_CHUNK_SIZE):
159	                file.write(data)
160	                etag.update(data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
185	        read = 0
186	        while data := part.read(S3_CHUNK_SIZE):
187	            self.file.write(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186	        while data := part.read(S3_CHUNK_SIZE):
187	            self.file.write(data)
188	            read += len(data)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
186	        while data := part.read(S3_CHUNK_SIZE):
187	            self.file.write(data)
188	            read += len(data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
217	            self._pos = 0
218	            while data := self.read(S3_CHUNK_SIZE):
219	                self.checksum_hash.update(data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
223	        if not self._checksum:
224	            self._checksum = base64.b64encode(self.checksum_hash.digest()).decode()
225	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:224
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
223	        if not self._checksum:
224	            self._checksum = base64.b64encode(self.checksum_hash.digest()).decode()
225	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	            self._pos = 0
234	            while data := self.read(S3_CHUNK_SIZE):
235	                etag.update(data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
247	        """
248	        while data := self.read(S3_CHUNK_SIZE):
249	            if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
341	            if not range_data:
342	                stored_part.write(src_stored_object)
343	                return

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
341	            if not range_data:
342	                stored_part.write(src_stored_object)
343	                return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
345	            object_slice = LimitedStream(src_stored_object, range_data=range_data)
346	            stored_part.write(object_slice)
347	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
345	            object_slice = LimitedStream(src_stored_object, range_data=range_data)
346	            stored_part.write(object_slice)
347	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
440	            dest_stored_object = self.open(dest_bucket, dest_object, mode="w")
441	            dest_stored_object.write(src_stored_object)
442	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
440	            dest_stored_object = self.open(dest_bucket, dest_object, mode="w")
441	            dest_stored_object.write(src_stored_object)
442	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
468	        if self._filesystem.pop(bucket, None):
469	            rmtree(os.path.join(self.root_directory, bucket))
470	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/storage/ephemeral.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
522	        if upload_tmp_dir:
523	            rmtree(upload_tmp_dir, ignore_errors=True)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
423	    byte_digest = codecs.decode(to_bytes(etag.strip('"')), "hex")
424	    return to_str(base64.b64encode(byte_digest))
425	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:424
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
423	    byte_digest = codecs.decode(to_bytes(etag.strip('"')), "hex")
424	    return to_str(base64.b64encode(byte_digest))
425	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
437	    # get the hexdigest from the bytes digest
438	    byte_digest = base64.b64decode(content_md5)
439	    hex_digest = to_str(codecs.encode(byte_digest, "hex"))

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:438
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
437	    # get the hexdigest from the bytes digest
438	    byte_digest = base64.b64decode(content_md5)
439	    hex_digest = to_str(codecs.encode(byte_digest, "hex"))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:1051
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1050	    tok = next(global_version_id_sequence()).to_bytes(length=6) + token_bytes(18)
1051	    return base64.b64encode(tok, altchars=b"._").rstrip(b"=").decode("ascii")
1052	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:1051
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1050	    tok = next(global_version_id_sequence()).to_bytes(length=6) + token_bytes(18)
1051	    return base64.b64encode(tok, altchars=b"._").rstrip(b"=").decode("ascii")
1052	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1065	    """
1066	    return base64.b64decode(version_id, altchars=b"._") < base64.b64decode(other, altchars=b"._")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1065	    """
1066	    return base64.b64decode(version_id, altchars=b"._") < base64.b64decode(other, altchars=b"._")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1065	    """
1066	    return base64.b64decode(version_id, altchars=b"._") < base64.b64decode(other, altchars=b"._")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/utils.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1065	    """
1066	    return base64.b64decode(version_id, altchars=b"._") < base64.b64decode(other, altchars=b"._")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/validation.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
471	
472	    sse_customer_key = base64.b64decode(encryption_key)
473	    if len(sse_customer_key) != 32:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/validation.py:472
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
471	
472	    sse_customer_key = base64.b64decode(encryption_key)
473	    if len(sse_customer_key) != 32:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/validation.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
479	
480	    sse_customer_key_md5 = base64.b64encode(hashlib.md5(sse_customer_key).digest()).decode("utf-8")
481	    if sse_customer_key_md5 != encryption_key_md5:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/validation.py:480
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
479	
480	    sse_customer_key_md5 = base64.b64encode(hashlib.md5(sse_customer_key).digest()).decode("utf-8")
481	    if sse_customer_key_md5 != encryption_key_md5:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/validation.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
491	    try:
492	        checksum = base64.b64decode(checksum_value)
493	    except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/s3/validation.py:492
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
491	    try:
492	        checksum = base64.b64decode(checksum_value)
493	    except Exception:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/secretsmanager/provider.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
889	    if "SecretBinary" in response:
890	        response["SecretBinary"] = base64.b64decode(response["SecretBinary"])
891	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/secretsmanager/provider.py:890
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
889	    if "SecretBinary" in response:
890	        response["SecretBinary"] = base64.b64decode(response["SecretBinary"])
891	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/ses/provider.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
109	    with open(path, "w") as f:
110	        f.write(json.dumps(sent_email, default=_serialize))
111	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/ses/provider.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
371	
372	            payload = SNSPayload(
373	                message_id=response["MessageId"],
374	                sender_email=source,
375	                destination_addresses=recipients,
376	                tags=tags,
377	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/ses/provider.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
427	
428	            payload = SNSPayload(
429	                message_id=response["MessageId"],
430	                sender_email=source,
431	                destination_addresses=recipients,
432	                tags=tags,
433	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/ses/provider.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
488	
489	            payload = SNSPayload(
490	                message_id=message.id,
491	                sender_email=source,
492	                destination_addresses=destinations,
493	                tags=tags,
494	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/constants.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	
30	GCM_URL = "https://fcm.googleapis.com/fcm/send"
31	
32	# Endpoint to access all the PlatformEndpoint sent Messages
33	PLATFORM_ENDPOINT_MSGS_ENDPOINT = "/_aws/sns/platform-endpoint-messages"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/executor.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	        thread_name = f"{self._thread_name_prefix}_{len(self._threads)}"
74	        t = threading.Thread(name=thread_name, target=_worker, args=(work_queue,))
75	        t.daemon = True

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/provider.py:1082
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1081	def get_next_page_token_from_arn(resource_arn: str) -> str:
1082	    return to_str(base64.b64encode(to_bytes(resource_arn)))
1083	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/provider.py:1082
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1081	def get_next_page_token_from_arn(resource_arn: str) -> str:
1082	    return to_str(base64.b64encode(to_bytes(resource_arn)))
1083	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
195	            )
196	            status_code = inv_result.get("StatusCode")
197	            payload = inv_result.get("Payload")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
196	            status_code = inv_result.get("StatusCode")
197	            payload = inv_result.get("Payload")
198	            if payload:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
257	        signature_version = (
258	            topic_attributes.get("signature_version", "1") if topic_attributes else "1"
259	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
405	
406	            if failed_messages := response.get("Failed"):
407	                for failed_msg in failed_messages:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
407	                for failed_msg in failed_messages:
408	                    failure_data = failure_map.get(failed_msg["Id"])
409	                    LOG.info(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
420	                    kwargs = {}
421	                    if msg_attrs := failure_data["entry"].get("MessageAttributes"):
422	                        kwargs["MessageAttributes"] = msg_attrs

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
423	
424	                    if msg_group_id := failure_data["context"].get("MessageGroupId"):
425	                        kwargs["MessageGroupId"] = msg_group_id

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
426	
427	                    if msg_dedup_id := failure_data["context"].get("MessageDeduplicationId"):
428	                        kwargs["MessageDeduplicationId"] = msg_dedup_id

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
499	
500	            response = requests.post(
501	                subscriber["Endpoint"],
502	                headers=message_headers,
503	                data=message_body,
504	                verify=False,
505	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
539	        # which would already have the value from the topic
540	        if json_sub_delivery_policy := subscriber.get("DeliveryPolicy"):
541	            sub_delivery_policy = json.loads(json_sub_delivery_policy)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
541	            sub_delivery_policy = json.loads(json_sub_delivery_policy)
542	            if sub_content_type := sub_delivery_policy.get("requestPolicy", {}).get(
543	                "headerContentType"
544	            ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
541	            sub_delivery_policy = json.loads(json_sub_delivery_policy)
542	            if sub_content_type := sub_delivery_policy.get("requestPolicy", {}).get(
543	                "headerContentType"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
546	
547	        if json_topic_delivery_policy := topic_attributes.get("delivery_policy"):
548	            topic_delivery_policy = json.loads(json_topic_delivery_policy)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
549	            if not (
550	                topic_content_type := topic_delivery_policy.get(subscriber["Protocol"].lower())
551	            ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
552	                return
553	            if content_type := topic_content_type.get("defaultRequestPolicy", {}).get(
554	                "headerContentType"
555	            ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
552	                return
553	            if content_type := topic_content_type.get("defaultRequestPolicy", {}).get(
554	                "headerContentType"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
572	        ses_client = connect_to(aws_access_key_id=account_id, region_name=region).ses
573	        if endpoint := subscriber.get("Endpoint"):
574	            # TODO: legacy value, replace by a more sane value in the future

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
735	            region = extract_region_from_arn(subscriber["Endpoint"])
736	            if role_arn := subscriber.get("SubscriptionRoleArn"):
737	                factory = connect_to.with_assumed_role(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
881	
882	    return app.get("Attributes", {}), endpoint_attributes.get("Attributes", {})
883	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
881	
882	    return app.get("Attributes", {}), endpoint_attributes.get("Attributes", {})
883	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:895
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
894	    """
895	    server_key = app_attributes.get("PlatformCredential", "")
896	    token = endpoint_attributes.get("Token", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
895	    server_key = app_attributes.get("PlatformCredential", "")
896	    token = endpoint_attributes.get("Token", "")
897	    # message is supposed to be a JSON string to GCM

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
903	
904	    response = requests.post(
905	        sns_constants.GCM_URL,
906	        headers=headers,
907	        data=json.dumps(data),
908	    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:950
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
949	    # base64 encode the signature
950	    encoded_signature = base64.b64encode(message_signature)
951	    return to_str(encoded_signature)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:950
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
949	    # base64 encode the signature
950	    encoded_signature = base64.b64encode(message_signature)
951	    return to_str(encoded_signature)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
995	    # FIFO topics do not add the signature in the message
996	    if not subscriber.get("TopicArn", "").endswith(".fifo"):
997	        signature_version = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:998
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
997	        signature_version = (
998	            topic_attributes.get("signature_version", "1") if topic_attributes else "1"
999	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1027	            # https://docs.aws.amazon.com/sns/latest/api/API_MessageAttributeValue.html
1028	            val = base64.b64encode(attr["BinaryValue"]).decode()
1029	        else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1027	            # https://docs.aws.amazon.com/sns/latest/api/API_MessageAttributeValue.html
1028	            val = base64.b64encode(attr["BinaryValue"]).decode()
1029	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1030
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1029	        else:
1030	            val = attr.get("StringValue")
1031	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1040
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1039	def is_raw_message_delivery(subscriber: SnsSubscription) -> bool:
1040	    return subscriber.get("RawMessageDelivery") in ("true", True, "True")
1041	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1043	def is_fifo_topic(subscriber: SnsSubscription) -> bool:
1044	    return subscriber.get("TopicArn", "").endswith(".fifo")
1045	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1074
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1073	    # seems like you need to configure on the Console, leave it on by default now in LocalStack
1074	    protocol = subscriber.get("Protocol")
1075	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1087	        # TODO: on purpose not using walrus operator to show that we get the RoleArn here for CloudWatch
1088	        role_arn = topic_attributes.get(topic_attribute)
1089	        if not role_arn:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1098	
1099	    log_group_name = subscriber.get("TopicArn", "")
1100	    for partition in PARTITION_NAMES:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1107	    delivery["deliveryId"] = long_uid()
1108	    delivery["destination"] = subscriber.get("Endpoint", "")
1109	    delivery["dwellTimeMs"] = 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1120	            "messageId": message_context.message_id,
1121	            "topicArn": subscriber.get("TopicArn"),
1122	            "timestamp": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S.%f%z"),

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1178	    def __init__(self, num_thread: int = 10):
1179	        self.executor = ThreadPoolExecutor(num_thread, thread_name_prefix="sns_pub")
1180	        self.topic_partitioned_executor = TopicPartitionedThreadPoolExecutor(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1179	        self.executor = ThreadPoolExecutor(num_thread, thread_name_prefix="sns_pub")
1180	        self.topic_partitioned_executor = TopicPartitionedThreadPoolExecutor(
1181	            max_workers=num_thread, thread_name_prefix="sns_pub_fifo"
1182	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1206	        subscriber_arn = subscriber["SubscriptionArn"]
1207	        filter_policy = subscription_filter_policy.get(subscriber_arn)
1208	        if not filter_policy:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1210	        # default value is `MessageAttributes`
1211	        match subscriber.get("FilterPolicyScope", "MessageAttributes"):
1212	            case "MessageAttributes":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1230	                    ctx.message.message_id,
1231	                    subscriber.get("Endpoint"),
1232	                    subscriber["Protocol"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1240	            protocol = subscriber["Protocol"]
1241	            notifier = self.batch_topic_notifiers.get(protocol)
1242	            # does the notifier supports batching natively? for now, only SQS supports it

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1277	                    messages_amount,
1278	                    subscriber.get("Endpoint"),
1279	                    subscriber["Protocol"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1296	                            individual_ctx.message.message_id,
1297	                            subscriber.get("Endpoint"),
1298	                            subscriber["Protocol"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1305	    ):
1306	        if (topic_arn := subscriber.get("TopicArn", "")).endswith(".fifo"):
1307	            # TODO: we still need to implement Message deduplication on the topic level with `should_publish` for FIFO

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1343	        """
1344	        subscriber = ctx.store.subscriptions.get(subscription_arn)
1345	        if not subscriber:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sns/publisher.py:1355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1354	            ctx.message.message_id,
1355	            subscriber.get("Endpoint"),
1356	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/provider.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	    code = "InvalidAddress"
131	    message = "The address https://queue.amazonaws.com/ is not valid for this endpoint."
132	    sender_fault = True

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/provider.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
204	    def __init__(self, num_thread: int = 3):
205	        self.executor = ThreadPoolExecutor(
206	            num_thread, thread_name_prefix="sqs-metrics-cloudwatch-dispatcher"
207	        )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/provider.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
463	        self.move_tasks: dict[str, MessageMoveTask] = dict()
464	        self.executor = ThreadPoolExecutor(max_workers=100, thread_name_prefix="sqs-move-message")
465	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/query_api.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
58	    """
59	    return handle_request(request, region.rstrip("."))
60	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/query_api.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
66	def path_strategy_handler(request: Request, region, account_id: str, queue_name: str):
67	    return handle_request(request, region)
68	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/query_api.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
89	
90	    return handle_request(request, region)
91	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/query_api.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
109	
110	    return handle_request(request, region)
111	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/query_api.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
200	        operation, service_request = parser.parse(Request("POST", "/", headers=headers, body=body))
201	        validate_request(operation, service_request).raise_first()
202	    except OperationNotFoundParserError:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/utils.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
127	    try:
128	        handle = base64.b64decode(receipt_handle).decode("utf-8")
129	        parts = handle.split(" ")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/utils.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
127	    try:
128	        handle = base64.b64decode(receipt_handle).decode("utf-8")
129	        parts = handle.split(" ")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/utils.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
144	    handle = f"{long_uid()} {queue_arn} {message.message.get('MessageId')} {message.last_received}"
145	    encoded = base64.b64encode(handle.encode("utf-8"))
146	    return encoded.decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/utils.py:145
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
144	    handle = f"{long_uid()} {queue_arn} {message.message.get('MessageId')} {message.last_received}"
145	    encoded = base64.b64encode(handle.encode("utf-8"))
146	    return encoded.decode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/utils.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
157	    doc = f'{{"taskId":"{task_id}","sourceArn":"{source_arn}"}}'
158	    return to_str(base64.b64encode(to_bytes(doc)))
159	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/utils.py:158
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
157	    doc = f'{{"taskId":"{task_id}","sourceArn":"{source_arn}"}}'
158	    return to_str(base64.b64encode(to_bytes(doc)))
159	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/utils.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
189	def token_generator(item: str) -> str:
190	    base64_bytes = base64.b64encode(item.encode("utf-8"))
191	    next_token = base64_bytes.decode("utf-8")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/sqs/utils.py:190
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
189	def token_generator(item: str) -> str:
190	    base64_bytes = base64.b64encode(item.encode("utf-8"))
191	    next_token = base64_bytes.decode("utf-8")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/intrinsic/function/statesfunction/encoding_decoding/base_64_decode.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
57	        base64_string_bytes = base64_string.encode("ascii")
58	        string_bytes = base64.b64decode(base64_string_bytes)
59	        string = string_bytes.decode("ascii")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/intrinsic/function/statesfunction/encoding_decoding/base_64_decode.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
57	        base64_string_bytes = base64_string.encode("ascii")
58	        string_bytes = base64.b64decode(base64_string_bytes)
59	        string = string_bytes.decode("ascii")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/intrinsic/function/statesfunction/encoding_decoding/base_64_encode.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
57	        string_bytes = string.encode("ascii")
58	        string_base64_bytes = base64.b64encode(string_bytes)
59	        base64_string = string_base64_bytes.decode("ascii")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/intrinsic/function/statesfunction/encoding_decoding/base_64_encode.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
57	        string_bytes = string.encode("ascii")
58	        string_base64_bytes = base64.b64encode(string_bytes)
59	        base64_string = string_base64_bytes.decode("ascii")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/state/state_execution/state_map/iteration/inline_iteration_component.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
83	        worker = self._create_worker(env=env, eval_input=eval_input, job_pool=job_pool)
84	        worker_thread = threading.Thread(target=worker.eval, daemon=True)
85	        TMP_THREADS.append(worker_thread)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/state/state_execution/state_task/service/state_task_service_api_gateway.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
134	    def _get_supported_parameters(self) -> Optional[set[str]]:
135	        return self._SUPPORTED_API_PARAM_BINDINGS.get(self.resource.api_action.lower())
136	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/state/state_execution/state_task/service/state_task_service_api_gateway.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	        query_str = None
158	        query_parameters = parameters.get("QueryParameters")
159	        # TODO: add support for AllowNullValues.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/state/state_execution/state_task/service/state_task_service_api_gateway.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170	    def _headers_of(parameters: TaskParameters) -> Optional[dict]:
171	        headers = parameters.get("Headers", dict())
172	        if headers:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/state/state_execution/state_task/service/state_task_service_api_gateway.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
180	
181	                value = headers.get(key)
182	                if isinstance(value, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/state/state_execution/state_task/service/state_task_service_api_gateway.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
221	            [
222	                parameters.get("Stage", ""),
223	                PATH_USER_REQUEST,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/state/state_execution/state_task/service/state_task_service_api_gateway.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	                PATH_USER_REQUEST,
224	                parameters.get("Path", ""),
225	                StateTaskServiceApiGateway._query_parameters_of(parameters) or "",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/asl/component/state/state_execution/state_task/service/state_task_service_api_gateway.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
307	        headers = self._headers_of(task_parameters)
308	        json_data = task_parameters.get("RequestBody")
309	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/stepfunctions_utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
31	def get_next_page_token_from_arn(resource_arn: str) -> str:
32	    return to_str(base64.b64encode(to_bytes(resource_arn)))
33	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/stepfunctions/stepfunctions_utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
31	def get_next_page_token_from_arn(resource_arn: str) -> str:
32	    return to_str(base64.b64encode(to_bytes(resource_arn)))
33	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/transcribe/provider.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
182	
183	        start_thread(self._run_transcription_job, (store, job_name))
184	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/services/transcribe/provider.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
256	                try:
257	                    download(url + str(model_path.name) + ".zip", model_zip_path, verify_ssl=False)
258	                except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/aws/eventbus_utils.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	    url = config.internal_service_url() + f"/_aws/events/rules/{rule_arn}/trigger"
22	    response = requests.get(url)
23	    if not response.ok:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/aws/lambda_utils.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	            for f in files:
142	                zf.write(os.path.join(root, f), arcname=os.path.join(rel_dir, f))
143	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/aws/util.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
115	    if hasattr(aws_request.body, "read"):
116	        aws_request.body = aws_request.body.read()
117	    context.request = create_http_request(aws_request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/aws/util.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
116	        aws_request.body = aws_request.body.read()
117	    context.request = create_http_request(aws_request)
118	    parser = create_parser(context.service)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/aws/util.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
120	    context.service_request = instance
121	    context.account_id = get_account_id_from_request(context.request)
122	    return context

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/container.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
148	
149	        t = threading.Thread(
150	            target=_run_stream_container_logs,
151	            name=threading._newname("log-stream-%d"),
152	            daemon=True,
153	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	# URL of public HTTP echo server, used primarily for AWS parity/snapshot testing
57	PUBLIC_HTTP_ECHO_SERVER_URL = "http://httpbin.org"
58	
59	WAITER_CHANGE_SET_CREATE_COMPLETE = "change_set_create_complete"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
306	        response = aws_client.s3.list_objects_v2(Bucket=bucket_name)
307	        objects = [{"Key": obj["Key"]} for obj in response.get("Contents", [])]
308	        if objects:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
315	        response = aws_client.s3.list_object_versions(Bucket=bucket_name)
316	        versions = response.get("Versions", [])
317	        versions.extend(response.get("DeleteMarkers", []))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
316	        versions = response.get("Versions", [])
317	        versions.extend(response.get("DeleteMarkers", []))
318	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
442	
443	            if messages := response.get("Messages"):
444	                collected.extend(messages)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
488	            result = aws_client.sqs.get_queue_url(QueueName=queue_url.split("/")[-1])
489	            return result.get("QueueUrl") == queue_url
490	        except ClientError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
540	    def _create_sub(**kwargs):
541	        if kwargs.get("ReturnSubscriptionArn") is None:
542	            kwargs["ReturnSubscriptionArn"] = True

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
632	    ) -> Tuple[str, str, str, HTTPServer]:
633	        server = HTTPServer()
634	        server.start()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
635	        http_servers.append(server)
636	        server.expect_request("/sns-endpoint").respond_with_data(status=200)
637	        endpoint_url = server.url_for("/sns-endpoint")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
635	        http_servers.append(server)
636	        server.expect_request("/sns-endpoint").respond_with_data(status=200)
637	        endpoint_url = server.url_for("/sns-endpoint")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
841	    def _replicate_key(region_from=None, **kwargs):
842	        region_to = kwargs.get("ReplicaRegion")
843	        key_ids.append((region_to, kwargs.get("KeyId")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
842	        region_to = kwargs.get("ReplicaRegion")
843	        key_ids.append((region_to, kwargs.get("KeyId")))
844	        return aws_client_factory(region_name=region_from).kms.replicate_key(**kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1072
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1071	    def format_event(event: dict) -> str:
1072	        if reason := event.get("ResourceStatusReason"):
1073	            reason = reason.replace("\n", "; ")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1161	        ][0]
1162	        outputs = describe_stack_res.get("Outputs", [])
1163	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1163	
1164	        mapped_outputs = {o["OutputKey"]: o.get("OutputValue") for o in outputs}
1165	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1198	                # TODO: CREATE_FAILED should also not lead to further retries
1199	                change_set.get("Status") == "CREATE_COMPLETE"
1200	                and change_set.get("ExecutionStatus") == "AVAILABLE"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1199	                change_set.get("Status") == "CREATE_COMPLETE"
1200	                and change_set.get("ExecutionStatus") == "AVAILABLE"
1201	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1214	                # TODO: CREATE_FAILED should also not lead to further retries
1215	                change_set.get("Status") == "FAILED"
1216	                and change_set.get("ExecutionStatus") == "UNAVAILABLE"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1215	                change_set.get("Status") == "FAILED"
1216	                and change_set.get("ExecutionStatus") == "UNAVAILABLE"
1217	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1243	            s = resp["Stacks"][0]  # since the lookup  uses the id we can only get a single response
1244	            return s.get("StackStatus") in statuses
1245	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1260	
1261	            if check_set.get("ExecutionStatus") == "EXECUTE_FAILED":
1262	                LOG.warning("Change set failed")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1264	
1265	            return check_set.get("ExecutionStatus") == "EXECUTE_COMPLETE"
1266	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1378	    def _create_lambda_function(*args, **kwargs):
1379	        client = kwargs.get("client") or lambda_client
1380	        kwargs["client"] = client

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1381	        kwargs["s3_client"] = s3_client
1382	        func_name = kwargs.get("func_name")
1383	        assert func_name

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1385	
1386	        if not kwargs.get("role"):
1387	            kwargs["role"] = lambda_su_role

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:1640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1639	    def _create_role(iam_client=None, **kwargs):
1640	        if not kwargs.get("RoleName"):
1641	            kwargs["RoleName"] = f"role-{short_uid()}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2103	        response = apigateway_client.create_rest_api(**kwargs)
2104	        api_id = response.get("id")
2105	        rest_apis.append((api_id, client_region_name))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2106	
2107	        return api_id, response.get("name"), response.get("rootResourceId")
2108	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2106	
2107	        return api_id, response.get("name"), response.get("rootResourceId")
2108	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2118	        usage_plans = apigateway_client.get_usage_plans()
2119	        for item in usage_plans.get("items", []):
2120	            api_stages = item.get("apiStages", [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2119	        for item in usage_plans.get("items", []):
2120	            api_stages = item.get("apiStages", [])
2121	            usage_plan_ids.extend(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2121	            usage_plan_ids.extend(
2122	                item.get("id") for api_stage in api_stages if api_stage.get("apiId") == rest_api_id
2123	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2121	            usage_plan_ids.extend(
2122	                item.get("id") for api_stage in api_stages if api_stage.get("apiId") == rest_api_id
2123	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2131	            usage_plan_keys = apigateway_client.get_usage_plan_keys(usagePlanId=usage_plan_id)
2132	            for key in usage_plan_keys.get("items", []):
2133	                apigateway_client.delete_api_key(apiKey=key["id"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2145	        response = apigateway_client.import_rest_api(**kwargs)
2146	        api_id = response.get("id")
2147	        rest_apis.append((api_id, region_name))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2164	            kwargs["name"] = f"graphql-api-testing-name-{short_uid()}"
2165	        if not kwargs.get("authenticationType"):
2166	            kwargs["authenticationType"] = "API_KEY"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
2221	
2222	    httpserver.expect_request("").respond_with_handler(_echo)
2223	    http_endpoint = httpserver.url_for("/")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2221	
2222	    httpserver.expect_request("").respond_with_handler(_echo)
2223	    http_endpoint = httpserver.url_for("/")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2467	        response = aws_client.events.put_rule(**kwargs)
2468	        rules.append((kwargs["Name"], kwargs.get("EventBusName", "default")))
2469	        return response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2497	        rule_name = kwargs["Name"]
2498	        bus_name = kwargs.get("EventBusName", "")
2499	        pattern = kwargs.get("EventPattern", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2498	        bus_name = kwargs.get("EventBusName", "")
2499	        pattern = kwargs.get("EventPattern", {})
2500	        schedule = kwargs.get("ScheduleExpression", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/fixtures.py:2500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2499	        pattern = kwargs.get("EventPattern", {})
2500	        schedule = kwargs.get("ScheduleExpression", "")
2501	        rule_arn = aws_client.events.put_rule(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/in_memory_localstack.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	    # start runtime asynchronously
81	    threading.Thread(target=runtime.run).start()
82	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/marker_report.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	    if config.option.marker_report_tinybird_upload:
120	        project_name = os.environ.get("MARKER_REPORT_PROJECT_NAME", "localstack")
121	        datasource_name = "pytest_markers__v0"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/marker_report.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	        datasource_name = "pytest_markers__v0"
122	        token = os.environ.get("MARKER_REPORT_TINYBIRD_TOKEN")
123	        url = f"https://api.tinybird.co/v0/events?name={datasource_name}&token={token}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/marker_report.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	        token = os.environ.get("MARKER_REPORT_TINYBIRD_TOKEN")
123	        url = f"https://api.tinybird.co/v0/events?name={datasource_name}&token={token}"
124	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/marker_report.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	                    aws_marker=_get_aws_marker_from_markers(x.markers),
136	                    commit_sha=os.environ.get("MARKER_REPORT_COMMIT_SHA", ""),
137	                )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/marker_report.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
143	
144	        response = requests.post(url, data=data, timeout=20)
145	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/stepfunctions/fixtures.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
168	        finally:
169	            shutil.rmtree(
170	                tmp_dir,
171	                ignore_errors=True,
172	                onerror=lambda _, path, exc_info: LOG.error(
173	                    "Error removing temporary MockConfigFile.json: %s, %s", path, exc_info
174	                ),

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/util.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
22	
23	    proc = Process(target=_wrapper)
24	    proc.start()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/pytest/validation_tracking.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	        json.dump(content, fd, indent=2, sort_keys=True)
63	        fd.write("\n")  # add trailing newline for linter and Git compliance
64	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/scenario/cdk_lambda_helper.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
60	        if temp_dir:
61	            shutil.rmtree(temp_dir)
62	        if tmp_zip_path and os.path.exists(tmp_zip_path):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/scenario/cdk_lambda_helper.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
130	        if temp_dir:
131	            shutil.rmtree(temp_dir)
132	        if tmp_zip_path and os.path.exists(tmp_zip_path):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/scenario/cdk_lambda_helper.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	                archive_name = os.path.relpath(file_path, resources_dir)
149	                temp_zip.write(file_path, archive_name)
150	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/scenario/cdk_lambda_helper.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
148	                archive_name = os.path.relpath(file_path, resources_dir)
149	                temp_zip.write(file_path, archive_name)
150	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/scenario/cdk_lambda_helper.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
173	    auth_token = auth_response["authorizationData"][0]["authorizationToken"].encode()
174	    username, password = base64.b64decode(auth_token).decode().split(":")
175	    registry = auth_response["authorizationData"][0]["proxyEndpoint"]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/scenario/cdk_lambda_helper.py:174
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
173	    auth_token = auth_response["authorizationData"][0]["authorizationToken"].encode()
174	    username, password = base64.b64decode(auth_token).decode().split(":")
175	    registry = auth_response["authorizationData"][0]["proxyEndpoint"]

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/scenario/cdk_lambda_helper.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
211	    auth_token = auth_response["authorizationData"][0]["authorizationToken"].encode()
212	    username, password = base64.b64decode(auth_token).decode().split(":")
213	    registry = auth_response["authorizationData"][0]["proxyEndpoint"]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/scenario/cdk_lambda_helper.py:212
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
211	    auth_token = auth_response["authorizationData"][0]["authorizationToken"].encode()
212	    username, password = base64.b64decode(auth_token).decode().split(":")
213	    registry = auth_response["authorizationData"][0]["proxyEndpoint"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/testselection/github.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    """
13	    url = f"https://api.github.com/repos/{REPO_OWNER}/{repo_name}/pulls/{pr_number}"
14	    headers = {"Accept": GITHUB_V3_JSON}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/testselection/github.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
16	        headers["Authorization"] = f"token {token}"
17	    response = requests.get(url, headers=headers)
18	    if response.status_code != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/testselection/github.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    """
28	    url = f"https://api.github.com/repos/{REPO_OWNER}/{repo_name}/pulls?head={REPO_OWNER}:{branch}"
29	    headers = {"Accept": GITHUB_V3_JSON}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/testselection/github.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	        headers["Authorization"] = f"token {token}"
32	    response = requests.get(url, headers=headers)
33	    if response.status_code != 200:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/testselection/scripts/generate_test_selection.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	        for test_file in test_files:
115	            fd.write(test_file)
116	            fd.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/testing/testselection/scripts/generate_test_selection.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	            fd.write(test_file)
116	            fd.write("\n")
117	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/cli.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
58	        full_command = " ".join(_get_parent_commands(ctx) + [ctx.command.name])
59	        publish_cmd_process = Process(
60	            target=_publish_cmd_as_analytics_event,
61	            args=(full_command, [k for k, v in ctx.params.items() if v]),
62	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/client.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	    def track_events(self) -> bool:
29	        return self.response.get("track_events")
30	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/client.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
56	
57	        response = self.session.post(
58	            self.endpoint_session,
59	            headers=self._create_headers(),
60	            json=request.asdict(),
61	            proxies=get_proxies(),
62	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/client.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
96	        # FIXME: fault tolerance/timeouts
97	        response = self.session.post(
98	            endpoint, json={"events": docs}, headers=headers, proxies=get_proxies()
99	        )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/metadata.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
59	        api_key=get_api_key_or_auth_token() or "",  # api key should not be None
60	        system=get_system(),
61	        version=get_version_string(),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/metadata.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
59	        api_key=get_api_key_or_auth_token() or "",  # api key should not be None
60	        system=get_system(),
61	        version=get_version_string(),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/metadata.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
190	            with open("/etc/machine-id") as fd:
191	                machine_id = str(fd.read()).strip()
192	                if machine_id:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/metadata.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
228	
229	    return platform.system().lower()
230	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/metadata.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
228	
229	    return platform.system().lower()
230	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/analytics/metadata.py:229
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
228	
229	    return platform.system().lower()
230	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/archives.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
80	        # https://www.burgundywall.com/post/preserving-file-perms-with-python-zipfile-module
81	        os.chmod(out_path, perm or 0o777)
82	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/archives.py:81
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
80	        # https://www.burgundywall.com/post/preserving-file-perms-with-python-zipfile-module
81	        os.chmod(out_path, perm or 0o777)
82	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/archives.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
91	    mode = "r:gz" if path.endswith("gz") else "r"
92	    with tarfile.open(path, mode) as tar:
93	        tar.extractall(path=target_dir)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/archives.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
118	                    dest = os.path.join(relative, name)
119	                zip_file.write(full_name, dest)
120	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/archives.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
118	                    dest = os.path.join(relative, name)
119	                zip_file.write(full_name, dest)
120	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/archives.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
125	    if not os.path.exists(patch_class_file):
126	        download(class_url, patch_class_file)
127	        run(["zip", target_jar, class_file], cwd=base_dir)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/archives.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
176	        os.remove(match)
177	    download(maven_asset_url, target_file)
178	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/archives.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
190	            try:
191	                download(archive_url, tmp_archive)
192	                break

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/aws_responses.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    response = RequestsResponse()
45	    xmlns = xmlns or "http://%s.amazonaws.com/doc/2010-03-31/" % service
46	    response._content = """<ErrorResponse xmlns="{xmlns}"><Error>

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/aws_responses.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
115	):
116	    is_json = is_json_request(req_headers)
117	    if is_json:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/aws_responses.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	def is_json_request(req_headers: Dict) -> bool:
125	    ctype = req_headers.get("Content-Type", "")
126	    accept = req_headers.get("Accept", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/aws_responses.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	    ctype = req_headers.get("Content-Type", "")
126	    accept = req_headers.get("Accept", "")
127	    return "json" in ctype or "json" in accept

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/aws_responses.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	def is_invalid_html_response(headers, content) -> bool:
131	    content_type = headers.get("Content-Type", "")
132	    return "text/html" in content_type and not str_startswith_ignore_case(content, "<!doctype html")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/aws_responses.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	        content = json.dumps(content)
158	        if not headers.get(HEADER_CONTENT_TYPE):
159	            headers[HEADER_CONTENT_TYPE] = APPLICATION_JSON

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/client.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
57	
58	        return self.session.request(method, url, **kwargs)
59	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/client.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
60	    def get(self, url, **kwargs):
61	        return self.request("GET", url, **kwargs)
62	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/client.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
63	    def head(self, url, **kwargs):
64	        return self.request("HEAD", url, **kwargs)
65	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/client.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
66	    def post(self, url, **kwargs):
67	        return self.request("POST", url, **kwargs)
68	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/client.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
69	    def put(self, url, **kwargs):
70	        return self.request("PUT", url, **kwargs)
71	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/client.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
72	    def patch(self, url, **kwargs):
73	        return self.request("PATCH", url, **kwargs)
74	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/client.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
75	    def delete(self, url, **kwargs):
76	        return self.request("DELETE", url, **kwargs)
77	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/client.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
78	    def options(self, url, **kwargs):
79	        return self.request("OPTIONS", url, **kwargs)
80	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	        if ":api-destination/" in target_arn or ":destination/" in target_arn:
102	            send_event_to_api_destination(target_arn, event, target.get("HttpParameters"))
103	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	            eventbus_name = target_arn.split(":")[-1].split("/")[-1]
109	            detail = event.get("detail") or event
110	            resources = event.get("resources") or [source_arn] if source_arn else []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	            detail = event.get("detail") or event
110	            resources = event.get("resources") or [source_arn] if source_arn else []
111	            events_client.put_events(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	                        "EventBusName": eventbus_name,
115	                        "Source": events_source or event.get("source", source_service) or "",
116	                        "DetailType": events_detail_type or event.get("detail-type", ""),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
115	                        "Source": events_source or event.get("source", source_service) or "",
116	                        "DetailType": events_detail_type or event.get("detail-type", ""),
117	                        "Detail": json.dumps(detail),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	
161	    auth_type = connection.get("AuthorizationType").upper()
162	    auth_parameters = connection.get("AuthParameters")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	    auth_type = connection.get("AuthorizationType").upper()
162	    auth_parameters = connection.get("AuthParameters")
163	    if auth_type == AUTH_BASIC:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	    if auth_type == AUTH_BASIC:
164	        basic_auth_parameters = auth_parameters.get("BasicAuthParameters", {})
165	        username = basic_auth_parameters.get("Username", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        basic_auth_parameters = auth_parameters.get("BasicAuthParameters", {})
165	        username = basic_auth_parameters.get("Username", "")
166	        password = basic_auth_parameters.get("Password", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	        username = basic_auth_parameters.get("Username", "")
166	        password = basic_auth_parameters.get("Password", "")
167	        auth = "Basic " + to_str(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
167	        auth = "Basic " + to_str(
168	            base64.b64encode("{}:{}".format(username, password).encode("ascii"))
169	        )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:168
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
167	        auth = "Basic " + to_str(
168	            base64.b64encode("{}:{}".format(username, password).encode("ascii"))
169	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
172	    if auth_type == AUTH_API_KEY:
173	        api_key_parameters = auth_parameters.get("ApiKeyAuthParameters", {})
174	        api_key_name = api_key_parameters.get("ApiKeyName", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
173	        api_key_parameters = auth_parameters.get("ApiKeyAuthParameters", {})
174	        api_key_name = api_key_parameters.get("ApiKeyName", "")
175	        api_key_value = api_key_parameters.get("ApiKeyValue", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	        api_key_name = api_key_parameters.get("ApiKeyName", "")
175	        api_key_value = api_key_parameters.get("ApiKeyValue", "")
176	        headers.update({api_key_name: api_key_value})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	    if auth_type == AUTH_OAUTH:
179	        oauth_parameters = auth_parameters.get("OAuthParameters", {})
180	        oauth_method = oauth_parameters.get("HttpMethod")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	        oauth_parameters = auth_parameters.get("OAuthParameters", {})
180	        oauth_method = oauth_parameters.get("HttpMethod")
181	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	
182	        oauth_http_parameters = oauth_parameters.get("OAuthHttpParameters", {})
183	        oauth_endpoint = oauth_parameters.get("AuthorizationEndpoint", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	        oauth_http_parameters = oauth_parameters.get("OAuthHttpParameters", {})
183	        oauth_endpoint = oauth_parameters.get("AuthorizationEndpoint", "")
184	        query_object = list_of_parameters_to_object(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	        query_object = list_of_parameters_to_object(
185	            oauth_http_parameters.get("QueryStringParameters", [])
186	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
188	
189	        client_parameters = oauth_parameters.get("ClientParameters", {})
190	        client_id = client_parameters.get("ClientID", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	        client_parameters = oauth_parameters.get("ClientParameters", {})
190	        client_id = client_parameters.get("ClientID", "")
191	        client_secret = client_parameters.get("ClientSecret", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	        client_id = client_parameters.get("ClientID", "")
191	        client_secret = client_parameters.get("ClientSecret", "")
192	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	
193	        oauth_body = list_of_parameters_to_object(oauth_http_parameters.get("BodyParameters", []))
194	        oauth_body.update({"client_id": client_id, "client_secret": client_secret})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
196	        oauth_header = list_of_parameters_to_object(
197	            oauth_http_parameters.get("HeaderParameters", [])
198	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
198	        )
199	        oauth_result = requests.request(
200	            method=oauth_method,
201	            url=oauth_endpoint,
202	            data=json.dumps(oauth_body),
203	            headers=oauth_header,
204	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
198	        )
199	        oauth_result = requests.request(
200	            method=oauth_method,
201	            url=oauth_endpoint,
202	            data=json.dumps(oauth_body),
203	            headers=oauth_header,
204	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	
207	        token_type = oauth_data.get("token_type", "")
208	        access_token = oauth_data.get("access_token", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	        token_type = oauth_data.get("token_type", "")
208	        access_token = oauth_data.get("access_token", "")
209	        auth_header = "{} {}".format(token_type, access_token)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	def list_of_parameters_to_object(items):
216	    return {item.get("Key"): item.get("Value") for item in items}
217	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	def list_of_parameters_to_object(items):
216	    return {item.get("Key"): item.get("Value") for item in items}
217	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	    # get destination endpoint details
232	    method = destination.get("HttpMethod", "GET")
233	    endpoint = destination.get("InvocationEndpoint")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	    method = destination.get("HttpMethod", "GET")
233	    endpoint = destination.get("InvocationEndpoint")
234	    state = destination.get("ApiDestinationState") or "ACTIVE"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
233	    endpoint = destination.get("InvocationEndpoint")
234	    state = destination.get("ApiDestinationState") or "ACTIVE"
235	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
249	
250	    result = requests.request(
251	        method=method, url=endpoint, data=json.dumps(event or {}), headers=headers
252	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
249	
250	    result = requests.request(
251	        method=method, url=endpoint, data=json.dumps(event or {}), headers=headers
252	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	def add_api_destination_authorization(destination, headers, event):
260	    connection_arn = destination.get("ConnectionArn", "")
261	    connection_name = re.search(r"connection\/([a-zA-Z0-9-_]+)\/", connection_arn).group(1)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	
272	    auth_parameters = connection.get("AuthParameters", {})
273	    invocation_parameters = auth_parameters.get("InvocationHttpParameters")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
272	    auth_parameters = connection.get("AuthParameters", {})
273	    invocation_parameters = auth_parameters.get("InvocationHttpParameters")
274	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
274	
275	    endpoint = destination.get("InvocationEndpoint")
276	    if invocation_parameters:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
277	        header_parameters = list_of_parameters_to_object(
278	            invocation_parameters.get("HeaderParameters", [])
279	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
282	        body_parameters = list_of_parameters_to_object(
283	            invocation_parameters.get("BodyParameters", [])
284	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
286	
287	        query_parameters = invocation_parameters.get("QueryStringParameters", [])
288	        query_object = list_of_parameters_to_object(query_parameters)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	def add_target_http_parameters(http_parameters: Dict, endpoint: str, headers: Dict, body):
295	    endpoint = add_path_parameters_to_url(endpoint, http_parameters.get("PathParameterValues", []))
296	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
297	    # The request should prioritze connection header/query parameters over target params if there is an overlap
298	    query_params = http_parameters.get("QueryStringParameters", {})
299	    prev_query_params = extract_query_string_params(endpoint)[1]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
302	
303	    target_headers = http_parameters.get("HeaderParameters", {})
304	    for target_header in target_headers:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/aws/message_forwarding.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
305	        if target_header not in headers:
306	            headers.update({target_header: target_headers.get(target_header)})
307	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/bootstrap.py:1284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
1283	    shutdown_event_lock = threading.RLock()
1284	    signal.signal(signal.SIGINT, shutdown_handler)
1285	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/bootstrap.py:1284
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
1283	    shutdown_event_lock = threading.RLock()
1284	    signal.signal(signal.SIGINT, shutdown_handler)
1285	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/bootstrap.py:1288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1287	    server = LocalstackContainerServer(container)
1288	    log_printer_thread = threading.Thread(
1289	        target=log_printer.run, name="container-log-printer", daemon=True
1290	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/collections.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
370	                )
371	            if overwrite or destination.get(key) in none_values:
372	                destination[key] = value

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/collections.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
403	    """Returns whether the first dict is a sub-dict (subset) of the second dict."""
404	    return all(parent_dict.get(key) == val for key, val in child_dict.items())
405	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/config_listener.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	    data = json.loads(data)
31	    variable = data.get("variable", "")
32	    response._content = "{}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/config_listener.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	        return response
37	    new_value = data.get("value")
38	    update_config_variable(variable, new_value)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/container_client.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
718	        with tempfile.NamedTemporaryFile() as tmp:
719	            tmp.write(file_contents)
720	            tmp.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/container_client.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
718	        with tempfile.NamedTemporaryFile() as tmp:
719	            tmp.write(file_contents)
720	            tmp.flush()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/container_client.py:1193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1192	        f = tempfile.NamedTemporaryFile()
1193	        with tarfile.open(mode="w", fileobj=f) as t:
1194	            abs_path = os.path.abspath(path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/container_client.py:1208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1207	        target_path = Path(target_path)
1208	        with tarfile.open(mode="r", fileobj=io.BytesIO(b"".join(b for b in tardata))) as t:
1209	            if target_path.is_dir():

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/container_client.py:1229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
1228	        try:
1229	            with open(env_file, mode="rt") as f:
1230	                env_file_lines = f.readlines()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/docker_sdk_client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
135	        if target_exists:
136	            stats = json.loads(base64.b64decode(stats).decode("utf-8"))
137	        target_is_dir = target_exists and bool(stats["mode"] & SDK_ISDIR)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/docker_sdk_client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
135	        if target_exists:
136	            stats = json.loads(base64.b64decode(stats).decode("utf-8"))
137	        target_is_dir = target_exists and bool(stats["mode"] & SDK_ISDIR)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/docker_sdk_client.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
525	        try:
526	            network.connect(
527	                container=container_name_or_id,
528	                aliases=aliases,
529	                link_local_ips=link_local_ips,
530	            )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/docker_sdk_client.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
547	            try:
548	                network.disconnect(container_name_or_id)
549	            except NotFound:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/docker_sdk_client.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
637	                # start listener thread
638	                start_worker_thread(wait_for_result)
639	                thread_started.wait()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/docker_sdk_client.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
651	                    if stdin:
652	                        sock.sendall(to_bytes(stdin))
653	                        sock.shutdown(socket.SHUT_WR)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/docker_sdk_client.py:661
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
660	                finally:
661	                    sock.close()
662	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/container_utils/docker_sdk_client.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
916	                    try:
917	                        sock.sendall(stdin)
918	                        sock.shutdown(socket.SHUT_WR)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/coverage_docs.py:1
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	COVERAGE_LINK_BASE = "https://docs.localstack.cloud/references/coverage/"
2	MESSAGE_TEMPLATE = (
3	    f"API %sfor service '%s' not yet implemented or pro feature"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/crypto.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
122	    key_file = io.StringIO()
123	    cert_file.write(to_str(crypto.dump_certificate(crypto.FILETYPE_PEM, cert)))
124	    key_file.write(to_str(crypto.dump_privatekey(crypto.FILETYPE_PEM, k)))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/crypto.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
123	    cert_file.write(to_str(crypto.dump_certificate(crypto.FILETYPE_PEM, cert)))
124	    key_file.write(to_str(crypto.dump_privatekey(crypto.FILETYPE_PEM, k)))
125	    cert_file_content = cert_file.getvalue().strip()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
79	    with open(file, mode, opener=_opener if permissions else None) as f:
80	        f.write(content)
81	        f.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
79	    with open(file, mode, opener=_opener if permissions else None) as f:
80	        f.write(content)
81	        f.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	    with open(file_path, mode) as f:
90	        result = f.read()
91	    return result

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
136	        LOG.info("Updating permissions as file is currently not readable: %s", file_path)
137	        os.chmod(file_path, default_perms)
138	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
136	        LOG.info("Updating permissions as file is currently not readable: %s", file_path)
137	        os.chmod(file_path, default_perms)
138	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
163	        return
164	    idempotent_chmod(path, mode)
165	    for root, dirnames, filenames in os.walk(path):

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
166	        for dirname in dirnames:
167	            idempotent_chmod(os.path.join(root, dirname), mode)
168	        for filename in filenames:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
168	        for filename in filenames:
169	            idempotent_chmod(os.path.join(root, filename), mode)
170	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
179	    try:
180	        os.chmod(path, mode)
181	    except Exception:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:180
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
179	    try:
180	        os.chmod(path, mode)
181	    except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/files.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
213	    else:
214	        shutil.rmtree(path)
215	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	def uses_chunked_encoding(response):
23	    return response.headers.get("Transfer-Encoding", "").lower() == "chunked"
24	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
107	) -> Response:
108	    return requests.request(
109	        url=url, method=method, headers=headers, data=data, auth=NetrcBypassAuth(), verify=False
110	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	    def __getattr__(self, name):
125	        method = requests.__dict__.get(name.lower())
126	        if not method:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	                kwargs["auth"] = NetrcBypassAuth()
132	            url = kwargs.get("url") or (args[1] if name == "request" else args[0])
133	            if not self.verify_ssl and url.startswith("https://") and "verify" not in kwargs:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	    headers = headers or {}
148	    content_type = headers.get("Content-Type", "")
149	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	    try:
202	        r = s.get(url, stream=True, verify=_verify, timeout=timeout, headers=request_headers)
203	        # check status code before attempting to read body

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	        total_size = 0
208	        if r.headers.get("Content-Length"):
209	            total_size = int(r.headers.get("Content-Length"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
208	        if r.headers.get("Content-Length"):
209	            total_size = int(r.headers.get("Content-Length"))
210	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
228	                if chunk:  # filter out keep-alive new chunks
229	                    f.write(chunk)
230	                elif not quiet:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
308	    # if a GitHub API token is set, use it to avoid rate limiting issues
309	    gh_token = os.environ.get("GITHUB_API_TOKEN")
310	    gh_auth_headers = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
315	        # TODO: use regex below to allow different branch names than "master"
316	        url = url.replace("https://github.com", "https://cdn.jsdelivr.net/gh")
317	        # The URL structure is https://cdn.jsdelivr.net/gh/user/repo@branch/file.js

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/http.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
315	        # TODO: use regex below to allow different branch names than "master"
316	        url = url.replace("https://github.com", "https://cdn.jsdelivr.net/gh")
317	        # The URL structure is https://cdn.jsdelivr.net/gh/user/repo@branch/file.js

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/json.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
54	        if isinstance(obj, bytes):
55	            return to_str(base64.b64encode(obj))
56	        return super().default(obj)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/json.py:55
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
54	        if isinstance(obj, bytes):
55	            return to_str(base64.b64encode(obj))
56	        return super().default(obj)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/json.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
92	            _fd = os.open(path, flags, self.mode)
93	            os.chmod(path, mode=self.mode, follow_symlinks=True)
94	            return _fd

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/json.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
92	            _fd = os.open(path, flags, self.mode)
93	            os.chmod(path, mode=self.mode, follow_symlinks=True)
94	            return _fd

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/kinesis/kinesis_connector.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
55	    def retrieve_loop(self, params):
56	        self.sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
57	        self.sock.bind(self.events_file)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/kinesis/kinesis_connector.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
63	                    conn, client_addr = sock.accept()
64	                    thread = FuncThread(
65	                        self.handle_connection,
66	                        conn,
67	                        name="kinesis-event-file-reader-connectionhandler",
68	                    )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/kinesis/kinesis_connector.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
89	            self.sock.shutdown(socket.SHUT_RDWR)
90	            self.sock.close()
91	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/kinesis/kinesis_connector.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	        self.subprocesses_initialized = threading.Event()
195	        self.event_reader = EventFileReaderThread(events_file, listener_function)
196	        self.stream_name = stream_name

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/kinesis/kinesis_connector.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
292	    # start stream consumer
293	    kinesis_processor = KinesisProcessorThread(
294	        stream_name=stream_name,
295	        properties_file=properties_file,
296	        env_vars=env_vars,
297	        listener_function=listener_function,
298	        events_file=events_file,
299	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/lambda_debug_mode/lambda_debug_mode_session.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	
63	        self._watch_thread = Thread(
64	            target=self._watch_logic, args=(), daemon=True, name="LambdaDebugModeConfigWatch"
65	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/lambda_debug_mode/lambda_debug_mode_session.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
103	            with open(self._configuration_file_path, "r") as df:
104	                yaml_configuration_string = df.read()
105	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:81
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
80	        with closing(
81	            socket.socket(socket.AF_INET if ":" not in host else socket.AF_INET6, nw_protocol)
82	        ) as sock:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
82	        ) as sock:
83	            sock.settimeout(1)
84	            if nw_protocol == socket.SOCK_DGRAM:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
86	                    if port == 53:
87	                        dnshost = "127.0.0.1" if host == "localhost" else host
88	                        resolver = dns.resolver.Resolver()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	    try:
114	        response = safe_requests.get(url, verify=False)
115	        return not expect_success or response.status_code < 400

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:177
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
176	        if port.protocol == "tcp":
177	            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
178	        elif port.protocol == "udp":

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:179
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
178	        elif port.protocol == "udp":
179	            sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
180	        else:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:196
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
195	    for i in range(10):
196	        udp = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
197	        udp.bind(("", 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
198	        addr, port = udp.getsockname()
199	        udp.close()
200	        if port not in blocklist:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:216
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
215	    for i in range(50):
216	        tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
217	        tcp.bind(("", 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
218	        addr, port = tcp.getsockname()
219	        tcp.close()
220	        if port not in blocklist and not dynamic_port_range.is_port_reserved(port):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
398	        port = Port.wrap(port)
399	        return self._ports_cache.get(port) is not None
400	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
495	    port: int = 53,
496	    ip_address: str = "127.0.0.1",
497	    qtype: str = "A",
498	    timeout: float = 1.0,
499	    tcp: bool = False,
500	) -> DNSRecord:
501	    LOG.debug("querying %s:%d for name %s", ip_address, port, name)
502	    request = DNSRecord.question(qname=name, qtype=qtype)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/net.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
502	    request = DNSRecord.question(qname=name, qtype=qtype)
503	    reply_bytes = request.send(dest=ip_address, port=port, tcp=tcp, timeout=timeout, ipv6=False)
504	    return DNSRecord.parse(reply_bytes)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/openapi.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	spec_top_info = textwrap.dedent("""
14	openapi: 3.1.0

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/platform.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
5	def is_mac_os() -> bool:
6	    return "darwin" == platform.system().lower()
7	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/platform.py:6
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
5	def is_mac_os() -> bool:
6	    return "darwin" == platform.system().lower()
7	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/platform.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
9	def is_linux() -> bool:
10	    return "linux" == platform.system().lower()
11	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/platform.py:10
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
9	def is_linux() -> bool:
10	    return "linux" == platform.system().lower()
11	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/platform.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
13	def is_windows() -> bool:
14	    return "windows" == platform.system().lower()
15	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/platform.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
13	def is_windows() -> bool:
14	    return "windows" == platform.system().lower()
15	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
104	                    if sys.stdin in r:
105	                        d = os.read(sys.stdin.fileno(), 10240)
106	                        os.write(master_fd, d)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	                        d = os.read(sys.stdin.fileno(), 10240)
106	                        os.write(master_fd, d)
107	                    elif master_fd in r:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	                    elif master_fd in r:
108	                        o = os.read(master_fd, 10240)
109	                        if o:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
109	                        if o:
110	                            os.write(sys.stdout.fileno(), o)
111	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	
112	            FuncThread(pipe_streams, name="pipe-streams").start()
113	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	    q = Queue()
138	    start_worker_thread(_worker)
139	    for i in range(max_secs * 2):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
314	                            if self.outfile not in [None, os.devnull]:
315	                                outstream.write(line)
316	                                outstream.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
381	                s = s.decode("unicode-escape")
382	            return super(CaptureOutput.LogStreamIO, self).write(s)
383	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
443	    def _ident(self):
444	        return threading.current_thread().ident
445	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/run.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
471	                s = s.decode("unicode-escape")
472	            return super(CaptureOutputProcess.LogStreamIO, self).write(s)
473	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
39	        # for certain use cases
40	        self._thread_pool = ThreadPoolExecutor(thread_name_prefix="tcp-proxy", max_workers=64)
41	        self._server_socket = None

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
44	        try:
45	            s_dst = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
46	            with s_src as s_src, s_dst as s_dst:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
46	            with s_src as s_src, s_dst as s_dst:
47	                s_dst.connect((self._target_address, self._target_port))
48	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
53	                    for s in s_read:
54	                        data = s.recv(self._buffer_size)
55	                        if not data:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
62	                            if forward is not None:
63	                                s_dst.sendall(forward)
64	                            elif response is not None:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
64	                            elif response is not None:
65	                                s_src.sendall(response)
66	                                return

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
67	                        elif s == s_dst:
68	                            s_src.sendall(data)
69	        except Exception as e:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:79
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
78	    def do_run(self):
79	        self._server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
80	        self._server_socket.bind((self.host, self.port))

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
81	        self._server_socket.listen(1)
82	        self._server_socket.settimeout(10)
83	        LOG.debug(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/server/tcp_proxy.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
105	            self._server_socket.shutdown(socket.SHUT_RDWR)
106	            self._server_socket.close()
107	        self._thread_pool.shutdown(cancel_futures=True)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/ssl.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
47	    try:
48	        download(SSL_CERT_URL, target_file, timeout=timeout, quiet=True)
49	        LOG.debug("SSL certificate downloaded successfully")

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/ssl.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
52	        try:
53	            download(SSL_CERT_URL_FALLBACK, target_file, timeout=timeout, quiet=True)
54	            LOG.debug("SSL certificate downloaded successfully")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
159	    checksum = zlib.crc32(bytes)
160	    return base64.b64encode(checksum.to_bytes(4, "big")).decode()
161	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:160
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
159	    checksum = zlib.crc32(bytes)
160	    return base64.b64encode(checksum.to_bytes(4, "big")).decode()
161	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
168	    checksum.update(to_bytes(string))
169	    return base64.b64encode(checksum.digest()).decode()
170	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:169
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
168	    checksum.update(to_bytes(string))
169	    return base64.b64encode(checksum.digest()).decode()
170	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
177	    checksum.update(to_bytes(string))
178	    return base64.b64encode(checksum.digest()).decode()
179	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:178
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
177	    checksum.update(to_bytes(string))
178	    return base64.b64encode(checksum.digest()).decode()
179	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
182	    digest = hashlib.sha1(to_bytes(string)).digest()
183	    return base64.b64encode(digest).decode()
184	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:183
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
182	    digest = hashlib.sha1(to_bytes(string)).digest()
183	    return base64.b64encode(digest).decode()
184	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
187	    digest = hashlib.sha256(to_bytes(string)).digest()
188	    return base64.b64encode(digest).decode()
189	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:188
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
187	    digest = hashlib.sha256(to_bytes(string)).digest()
188	    return base64.b64encode(digest).decode()
189	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
191	def base64_to_hex(b64_string: str) -> bytes:
192	    return binascii.hexlify(base64.b64decode(b64_string))
193	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:192
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
191	def base64_to_hex(b64_string: str) -> bytes:
192	    return binascii.hexlify(base64.b64decode(b64_string))
193	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
201	    if "-" in data or "_" in data:
202	        return base64.urlsafe_b64decode(data)
203	    return base64.b64decode(data)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
202	        return base64.urlsafe_b64decode(data)
203	    return base64.b64decode(data)
204	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/strings.py:203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
202	        return base64.urlsafe_b64decode(data)
203	    return base64.b64decode(data)
204	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/testutil.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
176	    with open(full_zip_file, "rb") as file_obj:
177	        zip_file_content = file_obj.read()
178	    rm_rf(tmp_dir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/testutil.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
438	    body = s3_client.get_object(Bucket=bucket, Key=path)["Body"]
439	    result = body.read()
440	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/testutil.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
448	    response = s3_client.list_objects_v2(Bucket=bucket)
449	    keys = [obj["Key"] for obj in response.get("Contents", [])]
450	    return keys

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/testutil.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
464	        response = s3_client.list_objects_v2(Bucket=bucket)
465	        objects = [obj["Key"] for obj in response.get("Contents", [])]
466	        for key in objects:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/testutil.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
479	def send_describe_dynamodb_ttl_request(table_name):
480	    return send_dynamodb_request("", "DescribeTimeToLive", json.dumps({"TableName": table_name}))
481	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/testutil.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
483	def send_update_dynamodb_ttl_request(table_name, ttl_status):
484	    return send_dynamodb_request(
485	        "",
486	        "UpdateTimeToLive",
487	        json.dumps(
488	            {
489	                "TableName": table_name,
490	                "TimeToLiveSpecification": {
491	                    "AttributeName": "ExpireItem",
492	                    "Enabled": ttl_status,
493	                },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/testutil.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
643	        result = page_function(kwargs)
644	        last_evaluated_token = result.get(last_token_attr_name)
645	        collected_items += result.get(list_attr_name, [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/testutil.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
644	        last_evaluated_token = result.get(last_token_attr_name)
645	        collected_items += result.get(list_attr_name, [])
646	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/threads.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
161	
162	    with Pool(size) as pool:
163	        return pool.map(func, arr)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/localstack-core/localstack/utils/venv.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	        with open(pth_file, "a") as fd:
100	            fd.write(line)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	# will only include available services
39	response = requests.get("http://localhost:4566/_localstack/health").content.decode("utf-8")
40	latest_services_pro = [k for k in json.loads(response).get("services").keys()]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	# will only include available services
39	response = requests.get("http://localhost:4566/_localstack/health").content.decode("utf-8")
40	latest_services_pro = [k for k in json.loads(response).get("services").keys()]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	response = requests.get("http://localhost:4566/_localstack/health").content.decode("utf-8")
40	latest_services_pro = [k for k in json.loads(response).get("services").keys()]
41	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	
71	    service_model = service_models.get(service)
72	    op_model = service_model.operation_model(op)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
72	    op_model = service_model.operation_model(op)
73	    parameters = generate_request(op_model) or {}
74	    result = _make_api_call(client, service, op, parameters)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	    result = _make_api_call(client, service, op, parameters)
75	    error_msg = result.get("error_message", "")
76	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	
77	    if result.get("error_code", "") == "InternalError":
78	        # some deeper investigation necessary, check for some common errors here and retry

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
93	            )
94	            parameters = generate_request(op_model) or {}
95	            result = _make_api_call(client, service, op, parameters)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	
121	                    if result.get("error_code", "") != "InternalError":
122	                        break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	                        break
133	                    error_msg = result.get("error_message", "")
134	                else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	                    break
137	    elif result.get("error_code", "") == "UnsupportedOperation" and service == "stepfunctions":
138	        # the stepfunction lib returns 500 for not implemented + UnsupportedOperation

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	        result["status_code"] = 501  # reflect that this is not implemented
140	    if result.get("status_code") in [0, 901, 902, 903]:
141	        # something went wrong, we do not know exactly what/why - just try again one more time

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	            "Detected invalid status code %i for %s.%s. Re-running request with new parameters",
144	            result.get("status_code"),
145	            service,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
147	        )
148	        parameters = generate_request(op_model) or {}  # should be generate_parameters I guess
149	        result = _make_api_call(client, service, op, parameters)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	        result["status_code"] = ce.response["ResponseMetadata"]["HTTPStatusCode"]
160	        result["error_code"] = ce.response.get("Error", {}).get("Code", "Unknown?")
161	        result["error_message"] = ce.response.get("Error", {}).get("Message", "Unknown?")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	        result["status_code"] = ce.response["ResponseMetadata"]["HTTPStatusCode"]
160	        result["error_code"] = ce.response.get("Error", {}).get("Code", "Unknown?")
161	        result["error_message"] = ce.response.get("Error", {}).get("Message", "Unknown?")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	        result["error_code"] = ce.response.get("Error", {}).get("Code", "Unknown?")
161	        result["error_message"] = ce.response.get("Error", {}).get("Message", "Unknown?")
162	    except (ReadTimeoutError, ConnectTimeoutError) as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	        result["error_code"] = ce.response.get("Error", {}).get("Code", "Unknown?")
161	        result["error_message"] = ce.response.get("Error", {}).get("Message", "Unknown?")
162	    except (ReadTimeoutError, ConnectTimeoutError) as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
208	        and row["status_code"] == 500
209	        and row.get("error_code") == "500"
210	        and row.get("error_message", "").lower() == "internal server error"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	        and row.get("error_code") == "500"
210	        and row.get("error_message", "").lower() == "internal server error"
211	    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	        return True
213	    if row["service"] == "dynamodb" and row.get("error_code") == "UnknownOperationException":
214	        return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	        return True
215	    if row["service"] == "lambda" and row["status_code"] == 404 and row.get("error_code") == "404":
216	        return True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
223	        and row["status_code"] == 404
224	        and row.get("error_code") == "404"
225	        and row.get("error_message") is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
224	        and row.get("error_code") == "404"
225	        and row.get("error_message") is not None
226	        and "not found" == row.get("error_message", "").lower()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	        and row.get("error_message") is not None
226	        and "not found" == row.get("error_message", "").lower()
227	    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	        and row["status_code"] == 404
232	        and row.get("error_message") is not None
233	        and "The requested URL was not found on the server" in row.get("error_message")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	        and row.get("error_message") is not None
233	        and "The requested URL was not found on the server" in row.get("error_message")
234	    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
237	        row["status_code"] == 501
238	        and row.get("error_message") is not None
239	        and "not yet implemented" in row.get("error_message", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	        and row.get("error_message") is not None
239	        and "not yet implemented" in row.get("error_message", "")
240	    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	        return True
242	    if row.get("error_message") is not None and "not yet implemented" in row.get(
243	        "error_message", ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	        return True
242	    if row.get("error_message") is not None and "not yet implemented" in row.get(
243	        "error_message", ""
244	    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	        row["status_code"] == 500
250	        and row.get("error_code") == "500"
251	        and not row.get("error_message")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
250	        and row.get("error_code") == "500"
251	        and not row.get("error_message")
252	    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
286	        for service_name in services:
287	            service = service_models.get(service_name)
288	            for op_name in service.operation_names:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
288	            for op_name in service.operation_names:
289	                if op_name in PHANTOM_OPERATIONS.get(service_name, []):
290	                    continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
297	            c.print(f"\n=====  {service_name} =====")
298	            service = service_models.get(service_name)
299	            for op_name in service.operation_names:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/capture_notimplemented_responses.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
299	            for op_name in service.operation_names:
300	                if op_name in PHANTOM_OPERATIONS.get(service_name, []):
301	                    continue

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/generate_minimal_boto3stubs_install.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	    ) as fd:
14	        content = fd.read()
15	        result = re.findall(r"\smypy_boto3_([a-z0-9_]+)\s", content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
192	    with open(file_name, "w") as fd:
193	        fd.write(
194	            """<!doctype html>
195	<html>

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
204	        )
205	        fd.write("  <h1>Diff Report Metrics Coverage</h1>\n")
206	        fd.write("   <h2>Service Coverage</h2>\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
205	        fd.write("  <h1>Diff Report Metrics Coverage</h1>\n")
206	        fd.write("   <h2>Service Coverage</h2>\n")
207	        fd.write(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
206	        fd.write("   <h2>Service Coverage</h2>\n")
207	        fd.write(
208	            "       <div><p>Assumption: the initial test suite is considered to have 100% coverage.</p>\n"
209	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
209	        )
210	        fd.write(f"<p>{service_overview_coverage}</p></div>\n")
211	        fd.write("   <h2>Coverage Details</h2>\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
210	        fd.write(f"<p>{service_overview_coverage}</p></div>\n")
211	        fd.write("   <h2>Coverage Details</h2>\n")
212	        fd.write(f"<div>{coverage_details}</div>")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
211	        fd.write("   <h2>Coverage Details</h2>\n")
212	        fd.write(f"<div>{coverage_details}</div>")
213	        if additional_test_details:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
213	        if additional_test_details:
214	            fd.write("    <h2>Additional Test Coverage</h2>\n")
215	            fd.write(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
214	            fd.write("    <h2>Additional Test Coverage</h2>\n")
215	            fd.write(
216	                "<div>     Note: this is probalby wrong usage of the script. It includes operations that have been covered with the acceptance tests only"
217	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
217	            )
218	            fd.write(f"<p>{additional_test_details}</p></div>\n")
219	        fd.write("</body></html>")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/metrics_coverage/diff_metrics_coverage.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
218	            fd.write(f"<p>{additional_test_details}</p></div>\n")
219	        fd.write("</body></html>")
220	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/render_marker_report.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
56	    with open(filepath, "r") as fd:
57	        return fd.read()
58	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/render_marker_report.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        owners=[o[1] for o in code_owners.of(rel_path)] or ["?"],
77	        file_url=f"https://github.com/{github_repo}/blob/{commit_sha}/{rel_path}",
78	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/render_marker_report.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	            timestamp=datetime.datetime.utcnow().isoformat(),
87	            repo_url=f"https://github.com/{github_repo}",
88	            commit_sha=commit_sha,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/render_marker_report.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
136	    with open(output_path, "wt") as outfile:
137	        outfile.write(rendered_markdown)
138	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/retrieve_legacy_data_from_circleci.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
25	    headers = {"accept": "application/json"}  # , "Circle-Token": api_token}
26	    conn.request(
27	        "GET",
28	        url=url,
29	        headers=headers,
30	    )

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/retrieve_legacy_data_from_circleci.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
31	
32	    res = conn.getresponse()
33	    if res.getcode() == 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/retrieve_legacy_data_from_circleci.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	    if res.getcode() == 200:
34	        data = res.read()
35	        return data

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/retrieve_legacy_data_from_circleci.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
207	                print(f"trying to download {metric_data_url}")
208	                urllib.request.urlretrieve(metric_data_url, metric_report_file_path)
209	

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/retrieve_legacy_data_from_circleci.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
211	                print(f"trying to download {community_cov_url}")
212	                urllib.request.urlretrieve(community_cov_url, community_coverage_file_path)
213	

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/retrieve_legacy_data_from_circleci.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
215	                print(f"trying to download {pro_cov_url}")
216	                urllib.request.urlretrieve(pro_cov_url, pro_coverage_file_path)
217	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	    # print(f"example data:\n {data[0]}\n")
105	    token = os.environ.get("TINYBIRD_PARITY_ANALYTICS_TOKEN", "")
106	    if not token:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
110	    data_to_send = "\n".join(data)
111	    r = requests.post(
112	        "https://api.tinybird.co/v0/events",
113	        params={
114	            "name": data_name,
115	            "token": token,
116	        },
117	        data=data_to_send,
118	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
111	    r = requests.post(
112	        "https://api.tinybird.co/v0/events",
113	        params={
114	            "name": data_name,
115	            "token": token,
116	        },
117	        data=data_to_send,
118	    )
119	    print(f"sent data to tinybird, status code: {r.status_code}: {r.text}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
155	    branch = (
156	        os.environ.get("CIRCLE_BRANCH", "")
157	        or os.environ.get("GITHUB_HEAD_REF", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	        os.environ.get("CIRCLE_BRANCH", "")
157	        or os.environ.get("GITHUB_HEAD_REF", "")
158	        or os.environ.get("GITHUB_REF_NAME", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	        or os.environ.get("GITHUB_HEAD_REF", "")
158	        or os.environ.get("GITHUB_REF_NAME", "")
159	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	    )
160	    workflow_id = os.environ.get("CIRCLE_WORKFLOW_ID", "") or os.environ.get("GITHUB_RUN_ID", "")
161	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	    )
160	    workflow_id = os.environ.get("CIRCLE_WORKFLOW_ID", "") or os.environ.get("GITHUB_RUN_ID", "")
161	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	
162	    build_url = os.environ.get("CIRCLE_BUILD_URL", "")
163	    if not build_url and os.environ.get("GITHUB_SERVER_URL"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	    build_url = os.environ.get("CIRCLE_BUILD_URL", "")
163	    if not build_url and os.environ.get("GITHUB_SERVER_URL"):
164	        # construct the build-url for Github

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        # construct the build-url for Github
165	        server = os.environ.get("GITHUB_SERVER_URL", "")
166	        repo = os.environ.get("GITHUB_REPOSITORY", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	        server = os.environ.get("GITHUB_SERVER_URL", "")
166	        repo = os.environ.get("GITHUB_REPOSITORY", "")
167	        build_url = f"{server}/{repo}/actions/runs/{workflow_id}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	
169	    pull_requests = os.environ.get("CIRCLE_PULL_REQUESTS", "") or os.environ.get("GITHUB_REF", "")
170	    build_num = os.environ.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	
169	    pull_requests = os.environ.get("CIRCLE_PULL_REQUESTS", "") or os.environ.get("GITHUB_REF", "")
170	    build_num = os.environ.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	    pull_requests = os.environ.get("CIRCLE_PULL_REQUESTS", "") or os.environ.get("GITHUB_REF", "")
170	    build_num = os.environ.get(
171	        "CIRCLE_BUILD_NUM", ""
172	    )  # TODO could not find equivalent job-id ENV in github

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	    count: int = 0
207	    build_id = os.environ.get("CIRCLE_WORKFLOW_ID", "") or os.environ.get("GITHUB_RUN_ID", "")
208	    send_metadata_for_build(build_id, timestamp)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	    count: int = 0
207	    build_id = os.environ.get("CIRCLE_WORKFLOW_ID", "") or os.environ.get("GITHUB_RUN_ID", "")
208	    send_metadata_for_build(build_id, timestamp)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	
261	    build_id = os.environ.get("CIRCLE_WORKFLOW_ID", "") or os.environ.get("GITHUB_RUN_ID", "")
262	    with open(file, "r") as csv_obj:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	
261	    build_id = os.environ.get("CIRCLE_WORKFLOW_ID", "") or os.environ.get("GITHUB_RUN_ID", "")
262	    with open(file, "r") as csv_obj:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
290	def main():
291	    token = os.environ.get("TINYBIRD_PARITY_ANALYTICS_TOKEN", "")
292	    metric_report_dir = os.environ.get("METRIC_REPORT_DIR_PATH", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	    token = os.environ.get("TINYBIRD_PARITY_ANALYTICS_TOKEN", "")
292	    metric_report_dir = os.environ.get("METRIC_REPORT_DIR_PATH", "")
293	    impl_coverage_file = os.environ.get("IMPLEMENTATION_COVERAGE_FILE", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
292	    metric_report_dir = os.environ.get("METRIC_REPORT_DIR_PATH", "")
293	    impl_coverage_file = os.environ.get("IMPLEMENTATION_COVERAGE_FILE", "")
294	    source_type = os.environ.get("SOURCE_TYPE", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/localstack_core-4.3.1.dev45/localstack_core-4.3.1.dev45/scripts/tinybird/upload_raw_test_metrics_and_coverage.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
293	    impl_coverage_file = os.environ.get("IMPLEMENTATION_COVERAGE_FILE", "")
294	    source_type = os.environ.get("SOURCE_TYPE", "")
295	    missing_info = (

--------------------------------------------------

Code scanned:
	Total lines of code: 227858
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 195.0
		High: 1131.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 1226.0
		High: 100.0
Files skipped (0):
