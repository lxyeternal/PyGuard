Run started:2025-04-12 10:57:21.514309

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/auth.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	keyring_error_message = dedent(
9	    """\
10	    {}
11	    {}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/completion_refresher.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
35	        else:
36	            self._completer_thread = threading.Thread(
37	                target=self._bg_refresh,
38	                args=(executor, special, callbacks, history, settings),
39	                name="completion_refresh",
40	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/completion_refresher.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
143	        with open(casing_file, "w") as f:
144	            f.write(casing_prefs)
145	    if os.path.isfile(casing_file):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/config.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
13	        return "%s/pgcli/" % expanduser(os.environ["XDG_CONFIG_HOME"])
14	    elif platform.system() == "Windows":
15	        return os.getenv("USERPROFILE") + "\\AppData\\Local\\dbcli\\pgcli\\"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/config.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
13	        return "%s/pgcli/" % expanduser(os.environ["XDG_CONFIG_HOME"])
14	    elif platform.system() == "Windows":
15	        return os.getenv("USERPROFILE") + "\\AppData\\Local\\dbcli\\pgcli\\"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/config.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
13	        return "%s/pgcli/" % expanduser(os.environ["XDG_CONFIG_HOME"])
14	    elif platform.system() == "Windows":
15	        return os.getenv("USERPROFILE") + "\\AppData\\Local\\dbcli\\pgcli\\"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/config.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	    cfg = load_config(config, def_config)
50	    cfg.write()
51	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
504	            with open(os.path.expanduser(pattern), encoding="utf-8") as f:
505	                query = f.read()
506	        except OSError as e:

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
641	        if not user:
642	            user = getuser()
643	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:642
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
641	        if not user:
642	            user = getuser()
643	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
700	            params = {
701	                "local_bind_address": ("127.0.0.1",),
702	                "remote_bind_address": (host, int(port or 5432)),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
724	            atexit.register(self.ssh_tunnel.stop)
725	            host = "127.0.0.1"
726	            port = self.ssh_tunnel.local_bind_ports[0]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:974
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
973	            print("Version:", __version__)
974	            print("Home: http://pgcli.com")
975	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:1909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1908	        # https://github.com/dbcli/pgcli/issues/1102
1909	        dialect = "excel" if platform.system() == "Windows" else "unix"
1910	        output_kwargs["dialect"] = dialect

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:1909
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
1908	        # https://github.com/dbcli/pgcli/issues/1102
1909	        dialect = "excel" if platform.system() == "Windows" else "unix"
1910	        output_kwargs["dialect"] = dialect

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:1909
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
1908	        # https://github.com/dbcli/pgcli/issues/1102
1909	        dialect = "excel" if platform.system() == "Windows" else "unix"
1910	        output_kwargs["dialect"] = dialect

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:1968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1967	        # try ~/.pg_service.conf (if that exists)
1968	        if platform.system() == "Windows":
1969	            service_file = os.getenv("PGSYSCONFDIR") + "\\pg_service.conf"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:1968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
1967	        # try ~/.pg_service.conf (if that exists)
1968	        if platform.system() == "Windows":
1969	            service_file = os.getenv("PGSYSCONFDIR") + "\\pg_service.conf"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/pgcli/main.py:1968
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
1967	        # try ~/.pg_service.conf (if that exists)
1968	        if platform.system() == "Windows":
1969	            service_file = os.getenv("PGSYSCONFDIR") + "\\pg_service.conf"

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/features/environment.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
152	    # Remove temp config directory
153	    shutil.rmtree(context.env_config_home)
154	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/features/steps/basic_commands.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
182	    context.tmpfile_sql_help = tempfile.NamedTemporaryFile(prefix="pgcli_")
183	    context.tmpfile_sql_help.write(rb"\?")
184	    context.tmpfile_sql_help.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/features/steps/iocommands.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
76	    with open(context.tee_file_name) as f:
77	        assert "123456" in f.read()
78	    if os.path.exists(context.tee_file_name):

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_config.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
27	    # trigger an  oserror that isn't "directory already exists"
28	    os.chmod(str(tmpdir), stat.S_IREAD)
29	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_config.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
27	    # trigger an  oserror that isn't "directory already exists"
28	    os.chmod(str(tmpdir), stat.S_IREAD)
29	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_main.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
29	
30	@pytest.mark.skipif(platform.system() == "Windows", reason="Not applicable in windows")
31	@pytest.mark.skipif(not setproctitle, reason="setproctitle not available")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_main.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
29	
30	@pytest.mark.skipif(platform.system() == "Windows", reason="Not applicable in windows")
31	@pytest.mark.skipif(not setproctitle, reason="setproctitle not available")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_main.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
29	
30	@pytest.mark.skipif(platform.system() == "Windows", reason="Not applicable in windows")
31	@pytest.mark.skipif(not setproctitle, reason="setproctitle not available")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_main.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
347	    sqlfile = tmpdir.join("test.sql")
348	    sqlfile.write("SELECT NOW()")
349	    rcfile = str(tmpdir.join("rcfile"))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_main.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
347	    sqlfile = tmpdir.join("test.sql")
348	    sqlfile.write("SELECT NOW()")
349	    rcfile = str(tmpdir.join("rcfile"))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_main.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
493	        with open(tmpdir.join(".pg_service.conf").strpath, "w") as service_conf:
494	            service_conf.write(
495	                """File begins with a comment
496	            that is not a comment

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_main.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
493	        with open(tmpdir.join(".pg_service.conf").strpath, "w") as service_conf:
494	            service_conf.write(
495	                """File begins with a comment
496	            that is not a comment

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_pgcompleter.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
68	    with tempfile.NamedTemporaryFile(mode="w", suffix=".json") as alias_map_file:
69	        alias_map_file.write(json.dumps(alias_map))
70	        alias_map_file.seek(0)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_pgexecute.py:784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
783	        assert executor.short_host == "ec2-11-222-333-444"
784	    with patch.object(executor, "host", "1.2.3.4"):
785	        assert executor.short_host == "1.2.3.4"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_pgexecute.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
784	    with patch.object(executor, "host", "1.2.3.4"):
785	        assert executor.short_host == "1.2.3.4"
786	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_ssh_tunnel.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
42	    expected_tunnel_params = {
43	        "local_bind_address": ("127.0.0.1",),
44	        "remote_bind_address": (db_params["host"], 5432),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_ssh_tunnel.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
60	        db_params["passwd"],
61	        "127.0.0.1",
62	        pgcli.ssh_tunnel.local_bind_ports[0],
63	        "",
64	        notify_callback,
65	    )
66	    mock_ssh_tunnel_forwarder.reset_mock()
67	    mock_pgexecute.reset_mock()
68	
69	    # Test with a full url and with a specific db port

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_ssh_tunnel.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
96	        db_params["passwd"],
97	        "127.0.0.1",
98	        pgcli.ssh_tunnel.local_bind_ports[0],
99	        "",
100	        notify_callback,
101	    )
102	    mock_ssh_tunnel_forwarder.reset_mock()
103	    mock_pgexecute.reset_mock()
104	
105	    # Test with DSN

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgcli-4.3.0/pgcli-4.3.0/tests/test_ssh_tunnel.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	    config["ssh tunnels"][r"^hello-"] = tunnel2_url
156	    config.write()
157	

--------------------------------------------------

Code scanned:
	Total lines of code: 11225
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 32.0
		High: 6.0
Files skipped (0):
