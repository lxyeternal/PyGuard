Run started:2025-04-12 15:16:55.717800

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/client.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
691	                self.log.error(
692	                    "[FEATURE FLAGS] Error loading feature flags: To use feature flags, please set a valid personal_api_key. More information: https://posthog.com/docs/api/overview"
693	                )
694	                if self.debug:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/client.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
696	                        status=401,
697	                        message="You are using a write-only key with feature flags. "
698	                        "To use feature flags, please set a personal_api_key "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/client.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
702	                self.log.warning(
703	                    "[FEATURE FLAGS] PostHog feature flags quota limited, resetting feature flag data.  Learn more about billing limits at https://posthog.com/docs/billing/limits-alerts"
704	                )
705	                # Reset all feature flag data when quota limited

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	
27	US_INGESTION_ENDPOINT = "https://us.i.posthog.com"
28	EU_INGESTION_ENDPOINT = "https://eu.i.posthog.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	US_INGESTION_ENDPOINT = "https://us.i.posthog.com"
28	EU_INGESTION_ENDPOINT = "https://eu.i.posthog.com"
29	DEFAULT_HOST = US_INGESTION_ENDPOINT

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    trimmed_host = remove_trailing_slash(host_or_default)
37	    if trimmed_host in ("https://app.posthog.com", "https://us.posthog.com"):
38	        return US_INGESTION_ENDPOINT

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    trimmed_host = remove_trailing_slash(host_or_default)
37	    if trimmed_host in ("https://app.posthog.com", "https://us.posthog.com"):
38	        return US_INGESTION_ENDPOINT

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	        return US_INGESTION_ENDPOINT
39	    elif trimmed_host == "https://eu.posthog.com":
40	        return EU_INGESTION_ENDPOINT

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	            # whose default encoding is utf-8.
63	            gz.write(data.encode("utf-8"))
64	        data = buf.getvalue()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
65	
66	    res = _session.post(url, data=data, headers=headers, timeout=timeout)
67	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	            log.warning(
91	                "[FEATURE FLAGS] PostHog feature flags quota limited, resetting feature flag data.  Learn more about billing limits at https://posthog.com/docs/billing/limits-alerts"
92	            )
93	            raise QuotaLimitError(res.status_code, "Feature flags quota limited")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
104	    """Post the `kwargs to the decide API endpoint"""
105	    res = post(api_key, host, "/decide/?v=4", gzip, timeout, **kwargs)
106	    return _process_response(res, success_message="Feature flags decided successfully")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	    """Get remote config flag value from remote_config API endpoint"""
111	    return get(personal_api_key, f"/api/projects/@current/feature_flags/{key}/remote_config/", host, timeout)
112	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
117	    """Post the `kwargs` to the batch API endpoint for events"""
118	    res = post(api_key, host, "/batch/", gzip, timeout, **kwargs)
119	    return _process_response(res, success_message="data uploaded successfully", return_json=False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/request.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
123	    url = remove_trailing_slash(host or DEFAULT_HOST) + url
124	    res = requests.get(url, headers={"Authorization": "Bearer %s" % api_key, "User-Agent": USER_AGENT}, timeout=timeout)
125	    return _process_response(res, success_message=f"GET {url} completed successfully")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/sentry/posthog_integration.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    project_id = None  # The Sentry project id, used to send a direct link from PostHog to Sentry
21	    prefix = "https://sentry.io/organizations/"  # URL of a hosted sentry instance (default: https://sentry.io/organizations/)
22	
23	    @staticmethod
24	    def setup_once():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
132	                    ],
133	                    "$exception_personURL": "https://us.i.posthog.com/project/random_key/person/distinct_id",
134	                },
135	            )
136	
137	    def test_basic_capture_exception_with_distinct_id(self):
138	        with mock.patch.object(Client, "capture", return_value=None) as patch_capture:
139	            client = self.client
140	            exception = Exception("test exception")
141	            client.capture_exception(exception, "distinct_id")
142	
143	            self.assertTrue(patch_capture.called)
144	            capture_call = patch_capture.call_args[0]
145	            self.assertEqual(capture_call[0], "distinct_id")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	                    ],
160	                    "$exception_personURL": "https://us.i.posthog.com/project/random_key/person/distinct_id",
161	                },
162	            )
163	
164	    def test_basic_capture_exception_with_correct_host_generation(self):
165	        with mock.patch.object(Client, "capture", return_value=None) as patch_capture:
166	            client = Client(FAKE_TEST_API_KEY, on_error=self.set_fail, host="https://aloha.com")
167	            exception = Exception("test exception")
168	            client.capture_exception(exception, "distinct_id")
169	
170	            self.assertTrue(patch_capture.called)
171	            capture_call = patch_capture.call_args[0]
172	            self.assertEqual(capture_call[0], "distinct_id")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	        with mock.patch.object(Client, "capture", return_value=None) as patch_capture:
166	            client = Client(FAKE_TEST_API_KEY, on_error=self.set_fail, host="https://aloha.com")
167	            exception = Exception("test exception")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	                    ],
187	                    "$exception_personURL": "https://aloha.com/project/random_key/person/distinct_id",
188	                },
189	            )
190	
191	    def test_basic_capture_exception_with_correct_host_generation_for_server_hosts(self):
192	        with mock.patch.object(Client, "capture", return_value=None) as patch_capture:
193	            client = Client(FAKE_TEST_API_KEY, on_error=self.set_fail, host="https://app.posthog.com")
194	            exception = Exception("test exception")
195	            client.capture_exception(exception, "distinct_id")
196	
197	            self.assertTrue(patch_capture.called)
198	            capture_call = patch_capture.call_args[0]
199	            self.assertEqual(capture_call[0], "distinct_id")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
192	        with mock.patch.object(Client, "capture", return_value=None) as patch_capture:
193	            client = Client(FAKE_TEST_API_KEY, on_error=self.set_fail, host="https://app.posthog.com")
194	            exception = Exception("test exception")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
213	                    ],
214	                    "$exception_personURL": "https://app.posthog.com/project/random_key/person/distinct_id",
215	                },
216	            )
217	
218	    def test_basic_capture_exception_with_no_exception_given(self):
219	        with mock.patch.object(Client, "capture", return_value=None) as patch_capture:
220	            client = self.client
221	            try:
222	                raise Exception("test exception")
223	            except Exception:
224	                client.capture_exception(distinct_id="distinct_id")
225	
226	            self.assertTrue(patch_capture.called)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
516	            "random_key",
517	            "https://us.i.posthog.com",
518	            timeout=3,
519	            distinct_id="distinct_id",
520	            groups={},
521	            person_properties=None,
522	            group_properties=None,
523	            disable_geoip=True,
524	        )
525	
526	    @mock.patch("posthog.client.decide")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
533	            FAKE_TEST_API_KEY,
534	            host="https://app.posthog.com",
535	            on_error=self.set_fail,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
558	            "random_key",
559	            "https://us.i.posthog.com",
560	            timeout=12,
561	            distinct_id="distinct_id",
562	            groups={},
563	            person_properties=None,
564	            group_properties=None,
565	            disable_geoip=False,
566	        )
567	
568	    @mock.patch("posthog.client.decide")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:811
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
810	        client = self.client
811	        success, msg = client.page("distinct_id", url="https://posthog.com/contact")
812	        self.assertFalse(self.failed)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
815	        self.assertEqual(msg["distinct_id"], "distinct_id")
816	        self.assertEqual(msg["properties"]["$current_url"], "https://posthog.com/contact")
817	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
820	        distinct_id = uuid4()
821	        success, msg = client.page(distinct_id, url="https://posthog.com/contact")
822	        self.assertFalse(self.failed)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:826
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
825	        self.assertEqual(msg["distinct_id"], str(distinct_id))
826	        self.assertEqual(msg["properties"]["$current_url"], "https://posthog.com/contact")
827	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
831	            "distinct_id",
832	            "https://posthog.com/contact",
833	            {"property": "value"},
834	            timestamp=datetime(2014, 9, 3),
835	            uuid="new-uuid",
836	        )
837	
838	        self.assertTrue(success)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:841
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
840	        self.assertEqual(msg["timestamp"], "2014-09-03T00:00:00+00:00")
841	        self.assertEqual(msg["properties"]["$current_url"], "https://posthog.com/contact")
842	        self.assertEqual(msg["properties"]["property"], "value")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:1004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1003	
1004	        _, identify_msg = client.page("distinct_id", "http://a.com", {"trait": "value"}, disable_geoip=False)
1005	        client.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:1023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1022	            "random_key",
1023	            "https://us.i.posthog.com",
1024	            timeout=3,
1025	            distinct_id="some_id",
1026	            groups={},
1027	            person_properties={"distinct_id": "some_id"},
1028	            group_properties={},
1029	            disable_geoip=True,
1030	        )
1031	        patch_decide.reset_mock()
1032	        client.feature_enabled("random_key", "feature_enabled_distinct_id", disable_geoip=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:1035
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1034	            "random_key",
1035	            "https://us.i.posthog.com",
1036	            timeout=3,
1037	            distinct_id="feature_enabled_distinct_id",
1038	            groups={},
1039	            person_properties={"distinct_id": "feature_enabled_distinct_id"},
1040	            group_properties={},
1041	            disable_geoip=True,
1042	        )
1043	        patch_decide.reset_mock()
1044	        client.get_all_flags_and_payloads("all_flags_payloads_id")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:1047
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1046	            "random_key",
1047	            "https://us.i.posthog.com",
1048	            timeout=3,
1049	            distinct_id="all_flags_payloads_id",
1050	            groups={},
1051	            person_properties={"distinct_id": "all_flags_payloads_id"},
1052	            group_properties={},
1053	            disable_geoip=False,
1054	        )
1055	
1056	    @mock.patch("posthog.client.Poller")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1072	        }
1073	        client = Client(FAKE_TEST_API_KEY, host="http://app2.posthog.com", on_error=self.set_fail, disable_geoip=False)
1074	        client.get_feature_flag(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:1083
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1082	            "random_key",
1083	            "http://app2.posthog.com",
1084	            timeout=3,
1085	            distinct_id="some_id",
1086	            groups={"company": "id:5", "instance": "app.posthog.com"},
1087	            person_properties={"distinct_id": "some_id", "x1": "y1"},
1088	            group_properties={
1089	                "company": {"$group_key": "id:5", "x": "y"},
1090	                "instance": {"$group_key": "app.posthog.com"},
1091	            },
1092	            disable_geoip=False,
1093	        )
1094	
1095	        patch_decide.reset_mock()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1108	            "random_key",
1109	            "http://app2.posthog.com",
1110	            timeout=3,
1111	            distinct_id="some_id",
1112	            groups={"company": "id:5", "instance": "app.posthog.com"},
1113	            person_properties={"distinct_id": "override"},
1114	            group_properties={
1115	                "company": {"$group_key": "group_override"},
1116	                "instance": {"$group_key": "app.posthog.com"},
1117	            },
1118	            disable_geoip=False,
1119	        )
1120	
1121	        patch_decide.reset_mock()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_client.py:1126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1125	            "random_key",
1126	            "http://app2.posthog.com",
1127	            timeout=3,
1128	            distinct_id="some_id",
1129	            groups={},
1130	            person_properties={"distinct_id": "some_id"},
1131	            group_properties={},
1132	            disable_geoip=False,
1133	        )
1134	
1135	    @parameterized.expand(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_exception_capture.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        dedent(
12	            """
13	    from posthog import Posthog
14	    posthog = Posthog('phc_x', host='https://eu.i.posthog.com', enable_exception_autocapture=True, debug=True, on_error=lambda e, batch: print('error handling batch: ', e, batch))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_exception_capture.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        dedent(
41	            """
42	    from posthog import Posthog, Integrations
43	    posthog = Posthog('phc_x', host='https://eu.i.posthog.com', enable_exception_autocapture=True, exception_autocapture_integrations=[Integrations.Django], debug=True, on_error=lambda e, batch: print('error handling batch: ', e, batch))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_feature_flags.py:1216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1215	                logs.output[0],
1216	                "ERROR:posthog:[FEATURE FLAGS] Error loading feature flags: To use feature flags, please set a valid personal_api_key. More information: https://posthog.com/docs/api/overview",
1217	            )
1218	        client.debug = True
1219	        self.assertRaises(APIError, client.load_feature_flags)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_module.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        self.failed = False
18	        self.posthog = Posthog("testsecret", host="http://localhost:8000", on_error=self.failed)
19	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_module.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	    def test_page(self):
44	        self.posthog.page("distinct_id", "https://posthog.com/contact")
45	        self.posthog.flush()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
14	    def test_valid_request(self):
15	        res = batch_post(TEST_API_KEY, batch=[{"distinct_id": "distinct_id", "event": "python event", "type": "track"}])
16	        self.assertEqual(res.status_code, 200)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    def test_invalid_request_error(self):
19	        self.assertRaises(Exception, batch_post, "testsecret", "https://t.posthog.com", False, "[{]")
20	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
36	    def test_should_not_timeout(self):
37	        res = batch_post(
38	            TEST_API_KEY, batch=[{"distinct_id": "distinct_id", "event": "python event", "type": "track"}], timeout=15
39	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
43	        with self.assertRaises(requests.ReadTimeout):
44	            batch_post(
45	                "key", batch=[{"distinct_id": "distinct_id", "event": "python event", "type": "track"}], timeout=0.0001
46	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	    [
82	        ("https://t.posthog.com", "https://t.posthog.com"),
83	        ("https://t.posthog.com/", "https://t.posthog.com/"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	    [
82	        ("https://t.posthog.com", "https://t.posthog.com"),
83	        ("https://t.posthog.com/", "https://t.posthog.com/"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	        ("https://t.posthog.com", "https://t.posthog.com"),
83	        ("https://t.posthog.com/", "https://t.posthog.com/"),
84	        ("t.posthog.com", "t.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	        ("https://t.posthog.com", "https://t.posthog.com"),
83	        ("https://t.posthog.com/", "https://t.posthog.com/"),
84	        ("t.posthog.com", "t.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	        ("t.posthog.com/", "t.posthog.com/"),
86	        ("https://us.posthog.com.rg.proxy.com", "https://us.posthog.com.rg.proxy.com"),
87	        ("app.posthog.com", "app.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	        ("t.posthog.com/", "t.posthog.com/"),
86	        ("https://us.posthog.com.rg.proxy.com", "https://us.posthog.com.rg.proxy.com"),
87	        ("app.posthog.com", "app.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        ("eu.posthog.com", "eu.posthog.com"),
89	        ("https://app.posthog.com", "https://us.i.posthog.com"),
90	        ("https://eu.posthog.com", "https://eu.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        ("eu.posthog.com", "eu.posthog.com"),
89	        ("https://app.posthog.com", "https://us.i.posthog.com"),
90	        ("https://eu.posthog.com", "https://eu.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	        ("https://app.posthog.com", "https://us.i.posthog.com"),
90	        ("https://eu.posthog.com", "https://eu.i.posthog.com"),
91	        ("https://us.posthog.com", "https://us.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	        ("https://app.posthog.com", "https://us.i.posthog.com"),
90	        ("https://eu.posthog.com", "https://eu.i.posthog.com"),
91	        ("https://us.posthog.com", "https://us.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	        ("https://eu.posthog.com", "https://eu.i.posthog.com"),
91	        ("https://us.posthog.com", "https://us.i.posthog.com"),
92	        ("https://app.posthog.com/", "https://us.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	        ("https://eu.posthog.com", "https://eu.i.posthog.com"),
91	        ("https://us.posthog.com", "https://us.i.posthog.com"),
92	        ("https://app.posthog.com/", "https://us.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        ("https://us.posthog.com", "https://us.i.posthog.com"),
92	        ("https://app.posthog.com/", "https://us.i.posthog.com"),
93	        ("https://eu.posthog.com/", "https://eu.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        ("https://us.posthog.com", "https://us.i.posthog.com"),
92	        ("https://app.posthog.com/", "https://us.i.posthog.com"),
93	        ("https://eu.posthog.com/", "https://eu.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        ("https://app.posthog.com/", "https://us.i.posthog.com"),
93	        ("https://eu.posthog.com/", "https://eu.i.posthog.com"),
94	        ("https://us.posthog.com/", "https://us.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        ("https://app.posthog.com/", "https://us.i.posthog.com"),
93	        ("https://eu.posthog.com/", "https://eu.i.posthog.com"),
94	        ("https://us.posthog.com/", "https://us.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	        ("https://eu.posthog.com/", "https://eu.i.posthog.com"),
94	        ("https://us.posthog.com/", "https://us.i.posthog.com"),
95	        (None, "https://us.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	        ("https://eu.posthog.com/", "https://eu.i.posthog.com"),
94	        ("https://us.posthog.com/", "https://us.i.posthog.com"),
95	        (None, "https://us.i.posthog.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_request.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	        ("https://us.posthog.com/", "https://us.i.posthog.com"),
95	        (None, "https://us.i.posthog.com"),
96	    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_utils.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	    def test_remove_slash(self):
88	        self.assertEqual("http://posthog.io", utils.remove_trailing_slash("http://posthog.io/"))
89	        self.assertEqual("http://posthog.io", utils.remove_trailing_slash("http://posthog.io"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_utils.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	    def test_remove_slash(self):
88	        self.assertEqual("http://posthog.io", utils.remove_trailing_slash("http://posthog.io/"))
89	        self.assertEqual("http://posthog.io", utils.remove_trailing_slash("http://posthog.io"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_utils.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        self.assertEqual("http://posthog.io", utils.remove_trailing_slash("http://posthog.io/"))
89	        self.assertEqual("http://posthog.io", utils.remove_trailing_slash("http://posthog.io"))
90	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/posthog/test/test_utils.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        self.assertEqual("http://posthog.io", utils.remove_trailing_slash("http://posthog.io/"))
89	        self.assertEqual("http://posthog.io", utils.remove_trailing_slash("http://posthog.io"))
90	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/posthog-3.24.0/posthog-3.24.0/setup.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	    version=VERSION,
70	    url="https://github.com/posthog/posthog-python",
71	    author="Posthog",

--------------------------------------------------

Code scanned:
	Total lines of code: 11626
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 63.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 72.0
		High: 0.0
Files skipped (0):
