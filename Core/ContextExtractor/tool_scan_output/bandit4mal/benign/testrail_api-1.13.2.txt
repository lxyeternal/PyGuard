Run started:2025-04-12 14:45:57.490144

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/setup.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    packages=find_packages(exclude=("tests", "dev_tools")),
12	    url="https://github.com/tolstislon/testrail-api",
13	    license="MIT License",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	        self.__base_url = f"{_url}/index.php?/api/v2/"
83	        self.__timeout = kwargs.get("timeout", 30)
84	        self.__session = session or requests.Session()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	        self.__session.headers["User-Agent"] = self._user_agent
86	        self.__session.headers.update(kwargs.get("headers", {}))
87	        self.__session.verify = kwargs.get("verify", True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	        self.__session.headers.update(kwargs.get("headers", {}))
87	        self.__session.verify = kwargs.get("verify", True)
88	        self.__retry = kwargs.get("retry", 3)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
87	        self.__session.verify = kwargs.get("verify", True)
88	        self.__retry = kwargs.get("retry", 3)
89	        self.__user_email = _email

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	        self.__retry_exceptions = (KeyError, *retry_exceptions)
93	        self.__exc_iterations = kwargs.get("exc_iterations", 3)
94	        self.__response_handler = response_handler or self.__default_response_handler

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	        """Reading URL"""
117	        if not (_url := url or environ.get(Environ.URL)):
118	            raise TestRailError(f"Url is not set. Use argument url or env {Environ.URL}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	        """Reading email"""
127	        if not (_email := email or environ.get(Environ.EMAIL)):
128	            raise TestRailError(f"Email is not set. Use argument email or env {Environ.EMAIL}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	        """Reading password"""
134	        if not (_password := password or environ.get(Environ.PASSWORD)):
135	            raise TestRailError(f"Password is not set. Use argument password or env {Environ.PASSWORD}")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
184	        """GET method"""
185	        return self.request(
186	            method=METHODS.GET,
187	            endpoint=endpoint,
188	            params=params or {},
189	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
197	        """POST method"""
198	        return self.request(
199	            method=METHODS.POST,
200	            endpoint=endpoint,
201	            params=params or {},
202	            json=json or {},
203	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
211	
212	        self.__get_converter(kwargs.get("params", {}))
213	        self.__post_converter(kwargs.get("json", {}))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	        self.__get_converter(kwargs.get("params", {}))
213	        self.__post_converter(kwargs.get("json", {}))
214	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
216	            try:
217	                response = self.__session.request(method=str(method.value), url=url, timeout=self.__timeout, **kwargs)
218	            except self.__retry_exceptions as exc:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
231	            ):
232	                time.sleep(int(response.headers.get("retry-after", self.__retry)))
233	                continue

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
244	        with file.open("rb") as attachment:
245	            return self.request(method, src, files={"attachment": attachment}, **kwargs)
246	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
249	        file = self._path(file)
250	        response = self.request(method, src, raw=True, **kwargs)
251	        if response.ok:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/testrail_api/_session.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
252	            with file.open("wb") as attachment:
253	                attachment.write(response.content)
254	            return file

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/tests/conftest.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	
19	BASE_HOST = 'https://example.testrail.com/index.php?/api/v2/'
20	
21	
22	class CallbackResponse(responses.CallbackResponse):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/tests/conftest.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	def host():
50	    return 'https://example.testrail.com/'
51	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/tests/test_other.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	    response = api.cases.get_case(1)
129	    assert response.get('count') is 3
130	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/tests/test_other.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	def test_no_response_raise():
144	    api = TRApi('https://asdadadsa.cd', 'asd@asd.com', 'asdasda', exc=False)
145	    with pytest.raises(ConnectionError):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/tests/test_other.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
150	    email = 'asd@asd.com'
151	    api = TRApi('https://asdadadsa.cd', 'asd@asd.com', 'asdasda', exc=False)
152	    assert api.user_email == email

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/tests/test_other.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
156	def test_raise_no_arg(field):
157	    data = {'url': 'https://asdadadsa.cd', 'email': 'asd@asd.com',
158	            'password': 'asdasda'}
159	    del data[field]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/tests/test_other.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	    with pytest.warns(UserWarning):
177	        TRApi('http://asdadadsa.cd', 'asd@asd.com', 'asdasda', exc=False)
178	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/tests/test_other.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
181	def test_http_no_warn():
182	    TRApi('http://asdadadsa.cd', 'asd@asd.com', 'asdasda', warn_ignore=True)
183	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/testrail_api-1.13.2/testrail_api-1.13.2/tests/test_reports.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	def test_run_report(api, mock, url):
18	    report_url, report_template_id = 'https://...383', 1
19	    mock.add_callback(

--------------------------------------------------

Code scanned:
	Total lines of code: 4486
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 0.0
Files skipped (0):
