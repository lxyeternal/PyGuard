Run started:2025-04-12 12:48:25.410210

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/behavior_flags.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	        )
60	        default_docs_url = "https://docs.getdbt.com/reference/global-configs/behavior-changes"
61	        self._behavior_change_event = BehaviorChangeEvent(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/jinja.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	        )
79	        tmp_file.write(source)
80	        filename = tmp_file.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/jinja.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
78	        )
79	        tmp_file.write(source)
80	        filename = tmp_file.name

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
176	    path = convert_path(path)
177	    with open(path, "rb") as handle:
178	        to_return = handle.read().decode("utf-8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
177	    with open(path, "rb") as handle:
178	        to_return = handle.read().decode("utf-8")
179	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
224	        path = convert_path(path)
225	        with open(path, "w") as fh:
226	            fh.write(contents)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
225	        with open(path, "w") as fh:
226	            fh.write(contents)
227	        return True

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
268	        make_directory(os.path.dirname(path))
269	        with open(path, "w", encoding="utf-8") as f:
270	            f.write(str(contents))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
269	        with open(path, "w", encoding="utf-8") as f:
270	            f.write(str(contents))
271	    except Exception as exc:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
296	    path = convert_path(path)
297	    with open(path, "r") as f:
298	        return json.load(f)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
304	        make_directory(os.path.dirname(path))
305	        with open(path, "w", encoding="utf-8") as f:
306	            json.dump(data, f, cls=dbt_common.utils.encoding.JSONEncoder)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
322	    if exception_val.errno == errno.EACCES:
323	        os.chmod(path, stat.S_IWUSR)
324	        func(path)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:323
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
322	    if exception_val.errno == errno.EACCES:
323	        os.chmod(path, stat.S_IWUSR)
324	        func(path)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
350	
351	    shutil.rmtree(path, onerror=onerror)
352	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
521	        message = 'Unknown error: {} (errno={}: "{}")'.format(
522	            str(exc), exc.errno, errno.errorcode.get(exc.errno, "<Unknown!>")
523	        )

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
559	            cmd = [os.path.abspath(exe_pth)] + list(cmd[1:])
560	        proc = subprocess.Popen(
561	            cmd, cwd=cwd, stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=full_env
562	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
591	    connection_timeout = timeout or float(os.getenv("DBT_HTTP_TIMEOUT", 10))
592	    response = requests.get(url, timeout=connection_timeout)
593	    with open(path, "wb") as handle:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
592	    response = requests.get(url, timeout=connection_timeout)
593	    with open(path, "wb") as handle:
594	        for block in response.iter_content(1024 * 64):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
594	        for block in response.iter_content(1024 * 64):
595	            handle.write(block)
596	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
606	        else:
607	            rmdir(to_path)
608	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
639	    tar_dir_name = None
640	    with tarfile.open(tar_path, "r:gz") as tarball:
641	        safe_extract(tarball, dest_dir)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
658	        raise
659	    os.chmod(path, stat.S_IREAD | stat.S_IWRITE)
660	    # on error,this will raise.

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:659
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
658	        raise
659	    os.chmod(path, stat.S_IREAD | stat.S_IWRITE)
660	    # on error,this will raise.

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
702	            shutil.copytree(src, dst, symlinks=True)
703	            rmtree(src)
704	        else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py:715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
714	    path = convert_path(path)
715	    return shutil.rmtree(path, onerror=chmod_and_retry)
716	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/events/base_types.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	def get_thread_name() -> str:
34	    return threading.current_thread().name
35	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/exceptions/system.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        msg = (
12	            "dbt encountered an error when attempting to create a symbolic link. "
13	            "If this error persists, please create an issue at: \n\n"
14	            "https://github.com/dbt-labs/dbt-core"
15	        )
16	
17	        return msg
18	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/record.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
183	            self._recording_file = open(current_recording_path, "w")
184	            self._recording_file.write("[")
185	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/record.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
203	            if self._record_added:
204	                self._recording_file.write(",")
205	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/record.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
249	        if self._recording_file is not None:
250	            self._recording_file.write("]")
251	            self._recording_file.close()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/utils/executor.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
75	    if config.args.single_threaded:
76	        return SingleThreadedExecutor()
77	    else:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/utils/executor.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
77	    else:
78	        return MultiThreadedExecutor(
79	            max_workers=config.threads,
80	            initializer=_thread_initializer,  # type: ignore
81	            initargs=(get_invocation_context(),),  # type: ignore
82	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 4840
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 2.0
Files skipped (0):
