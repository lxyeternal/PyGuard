Run started:2025-04-12 13:49:30.925118

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/airflow_provider_hightouch/__init__.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	        "name": "Hightouch Provider",
8	        "description": "Hightouch API hooks for Airflow <https://hightouch.io/>",
9	        "versions": __version__,
10	        "extra-links": ["airflow_provider_hightouch.operators.hightouch.HightouchLink"],
11	    }

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/airflow_provider_hightouch/hooks/hightouch.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
115	        params = {"runId": sync_request_id}
116	        return self.make_request(
117	            method="GET", endpoint=f"syncs/{sync_id}/runs", data=params
118	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/airflow_provider_hightouch/hooks/hightouch.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
126	        """
127	        return self.make_request(method="GET", endpoint=f"syncs/{sync_id}")
128	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/airflow_provider_hightouch/hooks/hightouch.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
135	        """
136	        return self.make_request(
137	            method="GET", endpoint="syncs", data={"slug": sync_slug}
138	        )[0]["id"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/airflow_provider_hightouch/hooks/hightouch.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
149	        if sync_id:
150	            return self.make_request(
151	                method="POST", endpoint="syncs/trigger", data={"syncId": sync_id}
152	            )["id"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/airflow_provider_hightouch/hooks/hightouch.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
153	        if sync_slug:
154	            return self.make_request(
155	                method="POST", endpoint="syncs/trigger", data={"syncSlug": sync_slug}
156	            )["id"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/airflow_provider_hightouch/operators/hightouch.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    def get_link(self, operator, dttm):
15	        return "https://app.hightouch.io"
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/airflow_provider_hightouch/sensors/hightouch.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    def get_link(self, operator, dttm):
19	        return "https://app.hightouch.io"
20	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/hooks/test_hightouch_hook.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	
66	        requests_mock.get(
67	            "https://test.hightouch.io/api/v1/syncs/1",
68	            json=sync_details_payload(),
69	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/hooks/test_hightouch_hook.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	        requests_mock.get(
67	            "https://test.hightouch.io/api/v1/syncs/1",
68	            json=sync_details_payload(),
69	        )
70	        hook = HightouchHook(api_version="v3")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/hooks/test_hightouch_hook.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
75	    def test_hightouch_submit_sync_with_id(self, requests_mock):
76	        requests_mock.post(
77	            "https://test.hightouch.io/api/v1/syncs/trigger", json={"id": "123"}
78	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/hooks/test_hightouch_hook.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        requests_mock.post(
77	            "https://test.hightouch.io/api/v1/syncs/trigger", json={"id": "123"}
78	        )
79	        hook = HightouchHook()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/hooks/test_hightouch_hook.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
84	    def test_hightouch_submit_sync_with_slug(self, requests_mock):
85	        requests_mock.post(
86	            "https://test.hightouch.io/api/v1/syncs/trigger", json={"id": "123"}
87	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/hooks/test_hightouch_hook.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	        requests_mock.post(
86	            "https://test.hightouch.io/api/v1/syncs/trigger", json={"id": "123"}
87	        )
88	        hook = HightouchHook()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/operators/test_hightouch_operator.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	    def test_hightouch_operator(self, requests_mock):
27	        requests_mock.get(
28	            "https://test.hightouch.io/api/v1/syncs/1/runs",
29	            json={
30	                "data": [
31	                    {
32	                        "id": "42",
33	                        "startedAt": "2022-02-08T16:11:04.712Z",
34	                        "createdAt": "2022-02-08T16:11:04.712Z",
35	                        "finishedAt": "2022-02-08T16:11:11.698Z",
36	                        "querySize": 773,
37	                        "status": "success",
38	                        "completionRatio": 0.54,
39	                        "plannedRows": {
40	                            "addedCount": 773,
41	                            "changedCount": 0,
42	                            "removedCount": 0,
43	                        },
44	                        "successfulRows": {
45	                            "addedCount": 773,
46	                            "changedCount": 0,
47	                            "removedCount": 0,
48	                        },
49	                        "failedRows": {
50	                            "addedCount": 0,
51	                            "changedCount": 0,
52	                            "removedCount": 0,
53	                        },
54	                        "error": None,
55	                    },
56	                    {
57	                        "id": "43",
58	                        "startedAt": "2022-02-08T16:11:04.712Z",
59	                        "createdAt": "2022-02-08T17:44:05.198Z",
60	                        "finishedAt": "2022-02-08T17:44:25.366Z",
61	                        "querySize": 773,
62	                        "status": "success",
63	                        "completionRatio": 0.54,
64	                        "plannedRows": {
65	                            "addedCount": 0,
66	                            "changedCount": 765,
67	                            "removedCount": 0,
68	                        },
69	                        "successfulRows": {
70	                            "addedCount": 0,
71	                            "changedCount": 765,
72	                            "removedCount": 0,
73	                        },
74	                        "failedRows": {
75	                            "addedCount": 0,
76	                            "changedCount": 0,
77	                            "removedCount": 0,
78	                        },
79	                        "error": None,
80	                    },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/operators/test_hightouch_operator.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        requests_mock.get(
28	            "https://test.hightouch.io/api/v1/syncs/1/runs",
29	            json={
30	                "data": [
31	                    {
32	                        "id": "42",
33	                        "startedAt": "2022-02-08T16:11:04.712Z",
34	                        "createdAt": "2022-02-08T16:11:04.712Z",
35	                        "finishedAt": "2022-02-08T16:11:11.698Z",
36	                        "querySize": 773,
37	                        "status": "success",
38	                        "completionRatio": 0.54,
39	                        "plannedRows": {
40	                            "addedCount": 773,
41	                            "changedCount": 0,
42	                            "removedCount": 0,
43	                        },
44	                        "successfulRows": {
45	                            "addedCount": 773,
46	                            "changedCount": 0,
47	                            "removedCount": 0,
48	                        },
49	                        "failedRows": {
50	                            "addedCount": 0,
51	                            "changedCount": 0,
52	                            "removedCount": 0,
53	                        },
54	                        "error": None,
55	                    },
56	                    {
57	                        "id": "43",
58	                        "startedAt": "2022-02-08T16:11:04.712Z",
59	                        "createdAt": "2022-02-08T17:44:05.198Z",
60	                        "finishedAt": "2022-02-08T17:44:25.366Z",
61	                        "querySize": 773,
62	                        "status": "success",
63	                        "completionRatio": 0.54,
64	                        "plannedRows": {
65	                            "addedCount": 0,
66	                            "changedCount": 765,
67	                            "removedCount": 0,
68	                        },
69	                        "successfulRows": {
70	                            "addedCount": 0,
71	                            "changedCount": 765,
72	                            "removedCount": 0,
73	                        },
74	                        "failedRows": {
75	                            "addedCount": 0,
76	                            "changedCount": 0,
77	                            "removedCount": 0,
78	                        },
79	                        "error": None,
80	                    },
81	                ]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/operators/test_hightouch_operator.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	        )
84	        requests_mock.get(
85	            "https://test.hightouch.io/api/v1/syncs/1",
86	            json={
87	                "id": "1",
88	                "slug": "testsync",
89	                "workspaceId": "1",
90	                "createdAt": "2022-02-16T21:37:58.510Z",
91	                "updatedAt": "2022-02-16T21:37:58.510Z",
92	                "destinationId": "1",
93	                "modelId": "1",
94	                "configuration": {
95	                    "mode": "upsert",
96	                    "object": "contacts",
97	                    "mappings": [
98	                        {"to": "email", "from": "email", "type": "standard"},
99	                        {"to": "phone", "from": "phone", "type": "standard"},
100	                    ],
101	                    "objectId": "0-1",
102	                    "externalIdMapping": {
103	                        "to": "firstname",
104	                        "from": "test_id",
105	                        "type": "standard",
106	                    },
107	                    "associationMappings": [],
108	                },
109	                "schedule": {
110	                    "type": "interval",
111	                    "schedule": {"interval": {"unit": "day", "quantity": 1}},
112	                },
113	                "disabled": False,
114	                "status": "success",
115	                "lastRunAt": "2022-02-16T21:37:58.510Z",
116	                "referencedColumns": ["email", "name"],
117	                "primaryKey": "id",
118	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/operators/test_hightouch_operator.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	        requests_mock.get(
85	            "https://test.hightouch.io/api/v1/syncs/1",
86	            json={
87	                "id": "1",
88	                "slug": "testsync",
89	                "workspaceId": "1",
90	                "createdAt": "2022-02-16T21:37:58.510Z",
91	                "updatedAt": "2022-02-16T21:37:58.510Z",
92	                "destinationId": "1",
93	                "modelId": "1",
94	                "configuration": {
95	                    "mode": "upsert",
96	                    "object": "contacts",
97	                    "mappings": [
98	                        {"to": "email", "from": "email", "type": "standard"},
99	                        {"to": "phone", "from": "phone", "type": "standard"},
100	                    ],
101	                    "objectId": "0-1",
102	                    "externalIdMapping": {
103	                        "to": "firstname",
104	                        "from": "test_id",
105	                        "type": "standard",
106	                    },
107	                    "associationMappings": [],
108	                },
109	                "schedule": {
110	                    "type": "interval",
111	                    "schedule": {"interval": {"unit": "day", "quantity": 1}},
112	                },
113	                "disabled": False,
114	                "status": "success",
115	                "lastRunAt": "2022-02-16T21:37:58.510Z",
116	                "referencedColumns": ["email", "name"],
117	                "primaryKey": "id",
118	            },
119	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/operators/test_hightouch_operator.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
119	        )
120	        requests_mock.post(
121	            "https://test.hightouch.io/api/v1/syncs/trigger",
122	            json={"id": "123"},
123	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/operators/test_hightouch_operator.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	        requests_mock.post(
121	            "https://test.hightouch.io/api/v1/syncs/trigger",
122	            json={"id": "123"},
123	        )
124	        operator = HightouchTriggerSyncOperator(task_id="run", sync_id=1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/airflow_provider_hightouch-4.0.0-py3-none-any/tests/operators/test_hightouch_operator.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    "os.environ",
22	    AIRFLOW_CONN_HIGHTOUCH_DEFAULT="http://https%3A%2F%2Ftest.hightouch.io%2F",
23	)

--------------------------------------------------

Code scanned:
	Total lines of code: 751
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 0.0
Files skipped (0):
