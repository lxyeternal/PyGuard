Run started:2025-04-12 10:31:01.112519

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/chromium_downloader.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	DOWNLOADS_FOLDER = Path(__pyppeteer_home__) / 'local-chromium'
28	DEFAULT_DOWNLOAD_HOST = 'https://storage.googleapis.com'
29	DOWNLOAD_HOST = os.environ.get('PYPPETEER_DOWNLOAD_HOST', DEFAULT_DOWNLOAD_HOST)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/chromium_downloader.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	            for chunk in r.stream(10240):
88	                _data.write(chunk)
89	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/chromium_downloader.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
95	            for chunk in r.stream(10240):
96	                _data.write(chunk)
97	                process_bar.update(len(chunk))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/chromium_downloader.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	        with zip_path.open('wb') as f:
115	            f.write(data.getvalue())
116	        if not shutil.which('unzip'):

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/chromium_downloader.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
131	        raise IOError('Failed to extract chromium.')
132	    exec_path.chmod(exec_path.stat().st_mode | stat.S_IXOTH | stat.S_IXGRP | stat.S_IXUSR)
133	    logger.info(f'Chromium extracted to: {path}')

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/connection.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
43	        self._connected = False
44	        self._ws = ws_connect(self._url, max_size=None, loop=self._loop, ping_interval=None, ping_timeout=None)
45	        self._recv_fut = self._loop.create_task(self._recv_loop())

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/connection.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
58	                try:
59	                    resp = await self.connection.recv()
60	                    if resp:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/connection.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
72	        try:
73	            await self.connection.send(msg)
74	        except websockets.ConnectionClosed:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/connection.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
95	        logger_connection.debug(f'SEND: {msg}')
96	        self._loop.create_task(self._async_send(msg, _id))
97	        callback = self._loop.create_future()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/connection.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
162	        if hasattr(self, 'connection'):  # may not have connection
163	            await self.connection.close()
164	        if not self._recv_fut.done():

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/connection.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
169	        self._connected = False
170	        await self._on_close()
171	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/connection.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
173	        """Create new session."""
174	        resp = await self.send(
175	            'Target.attachToTarget',
176	            {'targetId': targetInfo['targetId']}
177	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/connection.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
230	        try:
231	            self._connection.send('Target.sendMessageToTarget', {
232	                'sessionId': self._sessionId,
233	                'message': msg,
234	            })

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/connection.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
285	            raise NetworkError('Connection already closed.')
286	        await self._connection.send('Target.detachFromTarget',
287	                                    {'sessionId': self._sessionId})
288	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	        self.port = get_free_port()
76	        self.url = f'http://127.0.0.1:{self.port}'
77	        self._loop = options.get('loop', asyncio.get_event_loop())

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
127	            if self.temporaryUserDataDir and os.path.exists(self.temporaryUserDataDir):
128	                shutil.rmtree(self.temporaryUserDataDir, ignore_errors=True)
129	                if os.path.exists(self.temporaryUserDataDir):

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
158	        if self.handleSIGINT:
159	            signal.signal(signal.SIGINT, _close_process)
160	        if self.handleSIGTERM:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:159
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
158	        if self.handleSIGINT:
159	            signal.signal(signal.SIGINT, _close_process)
160	        if self.handleSIGTERM:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
160	        if self.handleSIGTERM:
161	            signal.signal(signal.SIGTERM, _close_process)
162	        if not sys.platform.startswith('win'):

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:161
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
160	        if self.handleSIGTERM:
161	            signal.signal(signal.SIGTERM, _close_process)
162	        if not sys.platform.startswith('win'):

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
164	            if self.handleSIGHUP:
165	                signal.signal(signal.SIGHUP, _close_process)
166	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:165
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
164	            if self.handleSIGHUP:
165	                signal.signal(signal.SIGHUP, _close_process)
166	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
228	        try:
229	            with urlopen(url) as f:
230	                data = json.loads(f.read().decode())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/launcher.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
229	            with urlopen(url) as f:
230	                data = json.loads(f.read().decode())
231	            break

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/network_manager.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
509	
510	        rawResponse = base64.b64encode(responseBuffer).decode('ascii')
511	        try:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/network_manager.py:510
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
509	
510	        rawResponse = base64.b64encode(responseBuffer).decode('ascii')
511	        try:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/network_manager.py:658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
657	        if response.get('base64Encoded'):
658	            return base64.b64decode(body)
659	        return body

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/network_manager.py:658
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
657	        if response.get('base64Encoded'):
658	            return base64.b64decode(body)
659	        return body

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/page.py:1244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1243	        else:
1244	            buffer = base64.b64decode(result.get('data', b''))
1245	        _path = options.get('path')

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/page.py:1244
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1243	        else:
1244	            buffer = base64.b64decode(result.get('data', b''))
1245	        _path = options.get('path')

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/page.py:1395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1394	        )
1395	        buffer = base64.b64decode(result.get('data', b''))
1396	        if 'path' in options:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/page.py:1395
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1394	        )
1395	        buffer = base64.b64decode(result.get('data', b''))
1396	        if 'path' in options:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/util.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
23	    """Get free port."""
24	    sock = socket.socket()
25	    sock.bind(('localhost', 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyppeteer-2.0.0/pyppeteer-2.0.0/pyppeteer/util.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
26	    port = sock.getsockname()[1]
27	    sock.close()
28	    del sock

--------------------------------------------------

Code scanned:
	Total lines of code: 6169
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 24.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 8.0
Files skipped (0):
