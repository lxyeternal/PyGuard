Run started:2025-04-12 12:19:40.559641

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	with open(join(dirname(__file__), 'thriftpy', '__init__.py'), 'r') as f:
14	    version = re.match(r".*__version__ = '(.*?)'", f.read(), re.S).group(1)
15	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/setup.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
45	PYPY = "__pypy__" in sys.modules
46	UNIX = platform.system() in ("Linux", "Darwin")
47	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/setup.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
45	PYPY = "__pypy__" in sys.modules
46	UNIX = platform.system() in ("Linux", "Darwin")
47	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/setup.py:46
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
45	PYPY = "__pypy__" in sys.modules
46	UNIX = platform.system() in ("Linux", "Darwin")
47	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/setup.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	      entry_points={},
76	      url="https://thriftpy.readthedocs.org/",
77	      license="MIT",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/setup.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
78	      zip_safe=False,
79	      long_description=open("README.rst").read(),
80	      install_requires=install_requires,

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/_compat.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
17	
18	UNIX = platform.system() in ("Linux", "Darwin")
19	CYTHON = UNIX and not PYPY  # Cython always disabled in pypy and windows

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/_compat.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
17	
18	UNIX = platform.system() in ("Linux", "Darwin")
19	CYTHON = UNIX and not PYPY  # Cython always disabled in pypy and windows

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/contrib/tracking/__init__.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	        self.tracker.init_handshake_info(args)
73	        args.write(self._oprot)
74	        self._oprot.write_message_end()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/contrib/tracking/__init__.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
79	            x = TApplicationException()
80	            x.read(self._iprot)
81	            self._iprot.read_message_end()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/contrib/tracking/__init__.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
84	            result = track_thrift.UpgradeReply()
85	            result.read(self._iprot)
86	            self._iprot.read_message_end()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/contrib/tracking/__init__.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
91	            self.tracker.gen_header(self._header)
92	            self._header.write(self._oprot)
93	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/contrib/tracking/__init__.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
138	            request_header = track_thrift.RequestHeader()
139	            request_header.read(iprot)
140	            self.tracker.handle(request_header)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/contrib/tracking/__init__.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	            args = track_thrift.UpgradeArgs()
151	            args.read(iprot)
152	            self.tracker.handle_handshake_info(args)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/contrib/tracking/__init__.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
171	        args = getattr(self._service, api + "_args")()
172	        args.read(iprot)
173	        iprot.read_message_end()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/parser/parser.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
489	        with open(path) as fh:
490	            data = fh.read()
491	    elif url_scheme in ('http', 'https'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/parser/parser.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
491	    elif url_scheme in ('http', 'https'):
492	        data = urlopen(path).read()
493	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/parser/parser.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
549	
550	    data = source.read()
551	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/tornado.py:69
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
68	        logger.debug('socket connecting')
69	        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0)
70	        if self.ssl_options is None:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/tornado.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
75	        try:
76	            yield self.with_timeout(timeout, self.stream.connect(
77	                (self.host, self.port)))
78	        except (socket.error, OSError, IOError):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/tornado.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
92	        self.stream.set_close_callback(None)
93	        self.stream.close()
94	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/tornado.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
136	    def write(self, buf):
137	        self.__wbuf.write(buf)
138	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/tornado.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
144	        with self.io_exception_context():
145	            return self.stream.write(frame_length + frame)
146	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/tornado.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
193	            logger.exception('thrift exception in handle_stream')
194	            trans.close()
195	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/tornado.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
203	        self._iprot.trans.setvalue(frame)
204	        result = super(TTornadoClient, self)._recv(api)
205	        raise gen.Return(result)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/tornado.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
207	    def close(self):
208	        self._oprot.trans.close()
209	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
58	        if self.unix_socket:
59	            _sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
60	        else:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:61
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
60	        else:
61	            _sock = socket.socket(self.socket_family, socket.SOCK_STREAM)
62	            _sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
81	        if self.sock is not None:
82	            self.sock.settimeout(self.socket_timeout)
83	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
93	            if self.connect_timeout:
94	                self.sock.settimeout(self.connect_timeout)
95	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
95	
96	            self.sock.connect(addr)
97	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
98	            if self.socket_timeout:
99	                self.sock.settimeout(self.socket_timeout)
100	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
107	        try:
108	            buff = self.sock.recv(sz)
109	        except socket.error as e:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
116	                # in lib/cpp/src/transport/TSocket.cpp.
117	                self.close()
118	                # Trigger the check to raise the END_OF_FILE exception below.

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
128	    def write(self, buff):
129	        self.sock.sendall(buff)
130	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
139	            self.sock.shutdown(socket.SHUT_RDWR)
140	            self.sock.close()
141	            self.sock = None

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:183
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
182	            # try remove the sock file it already exists
183	            _sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
184	            try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
184	            try:
185	                _sock.connect(self.unix_socket)
186	            except (socket.error, OSError) as err:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:190
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
189	        else:
190	            _sock = socket.socket(self.socket_family, socket.SOCK_STREAM)
191	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
194	            _sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEPORT, 1)
195	        _sock.settimeout(None)
196	        self.sock = _sock

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
207	        if self.client_timeout:
208	            client.settimeout(self.client_timeout)
209	        return TSocket(sock=client)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/socket.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
216	            self.sock.shutdown(socket.SHUT_RDWR)
217	            self.sock.close()
218	        except (socket.error, OSError):

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/sslsocket.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
69	    def _init_sock(self):
70	        _sock = socket.socket(self.socket_family, socket.SOCK_STREAM)
71	        _sock = self.ssl_context.wrap_socket(_sock,

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/sslsocket.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
117	            sock.shutdown(socket.SHUT_RDWR)
118	            sock.close()
119	            raise

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/thriftpy-0.3.9/thriftpy-0.3.9/thriftpy/transport/sslsocket.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
121	            if self.client_timeout:
122	                ssl_sock.settimeout(self.client_timeout)
123	            return TSocket(sock=ssl_sock)

--------------------------------------------------

Code scanned:
	Total lines of code: 3740
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 36.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 8.0
Files skipped (0):
