Run started:2025-04-12 19:23:56.870569

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/base.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	FOURSIGHT_URL = 'https://foursight.4dnucleome.org/'
14	
15	# FF_MAGIC_CNAME corresponds to data.4dnucleome.org
16	_FF_MAGIC_CNAME = 'fourfront-green.us-east-1.elasticbeanstalk.com'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	    # complete, despite being on the wrong EB application version
144	    if prev_version and beanstalk_info(env).get('VersionLabel') == prev_version:
145	        if travis_build_id:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
176	    try:
177	        counts_res = ff_utils.authorized_request(bs_url + 'counts?format=json',
178	                                                 ff_env=env)
179	        totals = counts_res.json().get('db_es_total').split()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	                                                 ff_env=env)
179	        totals = counts_res.json().get('db_es_total').split()
180	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
237	    # delete initial checks (? not clear why this was happening before)
238	    if fs['foursight'].get('initial_checks'):
239	        del fs['foursight']['initial_checks']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
336	
337	    return True, 'http://' + res['Environments'][0].get('CNAME')
338	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
371	    describe_resp = es.describe_elasticsearch_domain(DomainName=es_name)
372	    endpoint = describe_resp['DomainStatus'].get('Endpoint', None)
373	    is_ready = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
395	    details = resp
396	    endpoint = resp['DBInstances'][0].get('Endpoint')
397	    if endpoint and endpoint.get('Address'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
396	    endpoint = resp['DBInstances'][0].get('Endpoint')
397	    if endpoint and endpoint.get('Address'):
398	        details = endpoint['Address']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
496	               'Authorization': 'token %s' % os.environ['travis_key']}
497	    resp = requests.get(request_url, headers=headers)
498	    if resp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
500	        details = resp.json()
501	        if len(resp.json().get('builds', [])) == 1:
502	            is_ready = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
530	
531	    url = 'https://api.travis-ci.org/build/%s' % build_id
532	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
533	    logger.info("Travis build url: %s" % url)
534	    resp = requests.get(url, headers=headers)
535	    logger.info("Travis build response: %s" % resp.text)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
602	            key, value = var.split('=')
603	            if env_override and env_override.get(key):
604	                options.append(make_envvar_option(key, env_override[key]))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
698	    """
699	    if os.path.exists(config_file) and not os.environ.get("AWS_ACCESS_KEY_ID"):
700	        command = ['bash', '-c', 'source ' + config_file + ' && env']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
734	    """
735	    fs = event.get('_foursight')
736	    if fs and fs.get('check'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
735	    fs = event.get('_foursight')
736	    if fs and fs.get('check'):
737	        if overrides is not None and isinstance(overrides, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
739	        # handles these fields. set full_output as a special case
740	        full_output = fs.get('full_output', '%s started to run' % lambda_name)
741	        brief_output = fs.get('brief_output')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
740	        full_output = fs.get('full_output', '%s started to run' % lambda_name)
741	        brief_output = fs.get('brief_output')
742	        summary = fs.get('summary', fs.get('log_desc'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
741	        brief_output = fs.get('brief_output')
742	        summary = fs.get('summary', fs.get('log_desc'))
743	        description = fs.get('description', fs.get('log_desc'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
741	        brief_output = fs.get('brief_output')
742	        summary = fs.get('summary', fs.get('log_desc'))
743	        description = fs.get('description', fs.get('log_desc'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
742	        summary = fs.get('summary', fs.get('log_desc'))
743	        description = fs.get('description', fs.get('log_desc'))
744	        status = fs.get('status', 'WARN')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
742	        summary = fs.get('summary', fs.get('log_desc'))
743	        description = fs.get('description', fs.get('log_desc'))
744	        status = fs.get('status', 'WARN')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
743	        description = fs.get('description', fs.get('log_desc'))
744	        status = fs.get('status', 'WARN')
745	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
747	                'full_output': full_output, 'brief_output': brief_output}
748	        fs_auth = os.environ.get('FS_AUTH')
749	        headers = {'content-type': "application/json", 'Authorization': fs_auth}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
785	    fs['foursight'] = create_foursight(**fs)
786	    if fs['foursight'].get('initial_checks'):
787	        del fs['foursight']['initial_checks']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
859	
860	    ff_auth = os.environ.get('FS_AUTH')
861	    headers = {'content-type': 'application/json', 'Authorization': ff_auth}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:927
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
926	        describe_resp = es.describe_elasticsearch_domain(DomainName=new)
927	        endpoint = describe_resp['DomainStatus'].get('Endpoint')
928	        if max_tries is not None and tries >= max_tries:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1126	        resp = client.describe_db_instances(DBInstanceIdentifier=snapshot_name)
1127	        endpoint = resp['DBInstances'][0].get('Endpoint')
1128	        if endpoint and endpoint.get('Address'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1127	        endpoint = resp['DBInstances'][0].get('Endpoint')
1128	        if endpoint and endpoint.get('Address'):
1129	            PRINT("We got an endpoint:", endpoint['Address'])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1150	        env = describe_beanstalk_environments(client, EnvironmentNames=[new])
1151	        url = env['Environments'][0].get('CNAME')
1152	        if url is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1173	        env = client.describe_environments(EnvironmentNames=[env_name])
1174	        url = env['Environments'][0].get('CNAME')
1175	        if url is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1197	               'client_secret': secret,
1198	               'audience': 'https://hms-dbmi.auth0.com/api/v2/'}
1199	    headers = {'content-type': 'application/json'}
1200	    res = requests.post('https://hms-dbmi.auth0.com/oauth/token',
1201	                        data=json.dumps(payload),
1202	                        headers=headers)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1199	    headers = {'content-type': 'application/json'}
1200	    res = requests.post('https://hms-dbmi.auth0.com/oauth/token',
1201	                        data=json.dumps(payload),
1202	                        headers=headers)
1203	    jwt = res.json()['access_token']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1199	    headers = {'content-type': 'application/json'}
1200	    res = requests.post('https://hms-dbmi.auth0.com/oauth/token',
1201	                        data=json.dumps(payload),
1202	                        headers=headers)
1203	    jwt = res.json()['access_token']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1204	
1205	    client_url = 'https://hms-dbmi.auth0.com/api/v2/clients/%s' % client
1206	    headers['authorization'] = 'Bearer %s' % jwt

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1207	
1208	    get_res = requests.get(client_url + '?fields=callbacks', headers=headers)
1209	    callbacks = get_res.json()['callbacks']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1213	    update_res = requests.patch(client_url, data=json.dumps(client_data), headers=headers)
1214	    PRINT('auth0 callback urls are: %s' % update_res.json().get('callbacks'))
1215	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1233	               'client_secret': secret,
1234	               'audience': 'https://hms-dbmi.auth0.com/api/v2/'}
1235	    headers = {'content-type': 'application/json'}
1236	    res = requests.post('https://hms-dbmi.auth0.com/oauth/token',
1237	                        data=json.dumps(payload),
1238	                        headers=headers)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1235	    headers = {'content-type': 'application/json'}
1236	    res = requests.post('https://hms-dbmi.auth0.com/oauth/token',
1237	                        data=json.dumps(payload),
1238	                        headers=headers)
1239	    jwt = res.json()['access_token']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1235	    headers = {'content-type': 'application/json'}
1236	    res = requests.post('https://hms-dbmi.auth0.com/oauth/token',
1237	                        data=json.dumps(payload),
1238	                        headers=headers)
1239	    jwt = res.json()['access_token']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1239	    jwt = res.json()['access_token']
1240	    client_url = 'https://hms-dbmi.auth0.com/api/v2/clients/%s' % client
1241	    headers['authorization'] = 'Bearer %s' % jwt

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1242	
1243	    get_res = requests.get(client_url + '?fields=callbacks', headers=headers)
1244	    callbacks = get_res.json()['callbacks']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/beanstalk_utils.py:1256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1255	    update_res = requests.patch(client_url, data=json.dumps(client_data), headers=headers)
1256	    PRINT('auth0 callback urls are: %s' % update_res.json().get('callbacks'))
1257	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/command_utils.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
285	    for project in all_projects or C4_PROJECTS:
286	        base_url = f"https://github.com/{project}/{c4_repo}"
287	        response = requests.get(base_url)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/command_utils.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
286	        base_url = f"https://github.com/{project}/{c4_repo}"
287	        response = requests.get(base_url)
288	        if response.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/command_utils.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
403	        question = question if isinstance(question, str) else ""
404	        if not (instance := Question._static_instances.get(question)):
405	            Question._static_instances[question] = (instance := Question(question, max=max, printf=printf))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/data_utils.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
15	    f_in = io.BytesIO()
16	    f_in.write(content)
17	    f_in.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/data_utils.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
18	    with gzip.GzipFile(fileobj=f_in, mode='rb') as f:
19	        gunzipped_content = f.read()
20	    return gunzipped_content.decode('utf-8')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/data_utils.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
66	        with gzip.open(filename, 'w') as zipfile:
67	            zipfile.write(content.encode('ascii'))
68	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/data_utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	        with io.open(filename, 'w') as outfile:
70	            outfile.write(content)
71	    return filename

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/deployment_utils.py:1092
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1091	        with io.open(to_file, 'w') as file_output_stream:
1092	            file_output_stream.write(output)
1093	        return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/deployment_utils.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1108	                if omittable is None or not omittable(line, expanded_line):
1109	                    to_stream.write(expanded_line)
1110	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ecr_utils.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
104	        """
105	        return base64.b64decode(authorization['authorizationToken']).replace(b'AWS:', b'').decode('utf-8')
106	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ecr_utils.py:105
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
104	        """
105	        return base64.b64decode(authorization['authorizationToken']).replace(b'AWS:', b'').decode('utf-8')
106	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_manager.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
189	        ignored(use_urllib)
190	        res = urllib.request.urlopen(url)
191	        res_body = res.read()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	        },
219	        e.FOURSIGHT_URL_PREFIX: 'https://foursight.genetics.example.com/api/view/',
220	        e.FULL_ENV_PREFIX: 'acme-',
221	        e.HOTSEAT_ENVS: ['acme-hotseat', 'acme-pubdemo'],
222	        e.INDEXER_ENV_NAME: 'acme-indexer',
223	        e.IS_LEGACY: False,
224	        e.ORCHESTRATED_APP: 'cgap',
225	        e.PRD_ENV_NAME: 'acme-prd',
226	        e.PUBLIC_URL_TABLE: [
227	            {
228	                p.NAME: 'cgap',
229	                p.URL: 'https://cgap.genetics.example.com',
230	                p.HOST: 'cgap.genetics.example.com',
231	                p.ENVIRONMENT: 'acme-prd',
232	            },
233	            {
234	                p.NAME: 'stg',
235	                p.URL: 'https://staging.genetics.example.com',
236	                p.HOST: 'staging.genetics.example.com',
237	                p.ENVIRONMENT: 'acme-stg',
238	            },
239	            {
240	                p.NAME: 'testing',
241	                p.URL: 'https://testing.genetics.example.com',
242	                p.HOST: 'testing.genetics.example.com',
243	                p.ENVIRONMENT: 'acme-pubtest',
244	            },
245	            {
246	                p.NAME: 'demo',
247	                p.URL: 'https://demo.genetics.example.com',
248	                p.HOST: 'demo.genetics.example.com',
249	                p.ENVIRONMENT: 'acme-pubdemo',
250	            },
251	        ],
252	        # We don't do stage mirroring in the orchestrated world, and probably should not confuse users by inviting
253	        # these to be set. For extra security, even if you did set them they wouldn't work without enabling mirroring.
254	        # -kmp 24-Jul-2021
255	        # e.STAGE_MIRRORING_ENABLED: False,
256	        # e.STG_ENV_NAME: None,
257	        e.TEST_ENVS: ['acme-test', 'acme-mastertest', 'acme-pubtest'],
258	        e.WEBPROD_PSEUDO_ENV: 'production-data',
259	        e.DEFAULT_WORKFLOW_ENV: 'acme-dev',
260	    }
261	
262	    SAMPLE_TEMPLATE_FOR_FOURFRONT_TESTING = {
263	        e.DEV_DATA_SET_TABLE: {'acme-hotseat': 'prod', 'acme-test': 'test'},
264	        e.DEV_ENV_DOMAIN_SUFFIX: DEV_SUFFIX_FOR_TESTING,
265	        e.FOURSIGHT_BUCKET_TABLE: {
266	            "acme-prd": {CHALICE_STAGE_DEV: "acme-foursight-dev-prd",
267	                         CHALICE_STAGE_PROD: "acme-foursight-prod-prd"},
268	            "acme-stg": {CHALICE_STAGE_DEV: "acme-foursight-dev-stg",
269	                         CHALICE_STAGE_PROD: "acme-foursight-prod-stg"},
270	            ENV_DEFAULT: {CHALICE_STAGE_DEV: "acme-foursight-dev-other",
271	                          CHALICE_STAGE_PROD: "acme-foursight-prod-other"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	                p.NAME: 'cgap',
229	                p.URL: 'https://cgap.genetics.example.com',
230	                p.HOST: 'cgap.genetics.example.com',
231	                p.ENVIRONMENT: 'acme-prd',
232	            },
233	            {
234	                p.NAME: 'stg',
235	                p.URL: 'https://staging.genetics.example.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
234	                p.NAME: 'stg',
235	                p.URL: 'https://staging.genetics.example.com',
236	                p.HOST: 'staging.genetics.example.com',
237	                p.ENVIRONMENT: 'acme-stg',
238	            },
239	            {
240	                p.NAME: 'testing',
241	                p.URL: 'https://testing.genetics.example.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
240	                p.NAME: 'testing',
241	                p.URL: 'https://testing.genetics.example.com',
242	                p.HOST: 'testing.genetics.example.com',
243	                p.ENVIRONMENT: 'acme-pubtest',
244	            },
245	            {
246	                p.NAME: 'demo',
247	                p.URL: 'https://demo.genetics.example.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	                p.NAME: 'demo',
247	                p.URL: 'https://demo.genetics.example.com',
248	                p.HOST: 'demo.genetics.example.com',
249	                p.ENVIRONMENT: 'acme-pubdemo',
250	            },
251	        ],
252	        # We don't do stage mirroring in the orchestrated world, and probably should not confuse users by inviting

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
272	        },
273	        e.FOURSIGHT_URL_PREFIX: 'https://foursight.genetics.example.com/api/view/',
274	        e.FULL_ENV_PREFIX: 'acme-',
275	        e.HOTSEAT_ENVS: ['acme-hotseat'],
276	        e.INDEXER_ENV_NAME: 'acme-indexer',
277	        e.IS_LEGACY: False,
278	        e.ORCHESTRATED_APP: 'fourfront',
279	        e.STAGE_MIRRORING_ENABLED: True,
280	        e.STG_ENV_NAME: 'acme-stg',
281	        e.PRD_ENV_NAME: 'acme-prd',
282	        e.PUBLIC_URL_TABLE: [
283	            {
284	                p.NAME: 'data',
285	                p.URL: 'https://genetics.example.com',
286	                p.HOST: 'genetics.example.com',
287	                p.ENVIRONMENT: 'acme-prd',
288	            },
289	            {
290	                p.NAME: 'staging',
291	                p.URL: 'https://stg.genetics.example.com',
292	                p.HOST: 'stg.genetics.example.com',
293	                p.ENVIRONMENT: 'acme-stg',
294	            },
295	            {
296	                p.NAME: 'test',
297	                p.URL: 'https://testing.genetics.example.com',
298	                p.HOST: 'testing.genetics.example.com',
299	                p.ENVIRONMENT: 'acme-pubtest',
300	            },
301	            {
302	                p.NAME: 'demo',
303	                p.URL: 'https://demo.genetics.example.com',
304	                p.HOST: 'demo.genetics.example.com',
305	                p.ENVIRONMENT: 'acme-pubdemo',
306	            },
307	            {
308	                p.NAME: 'hot',
309	                p.URL: 'https://hot.genetics.example.com',
310	                p.HOST: 'hot.genetics.example.com',
311	                p.ENVIRONMENT: 'acme-hotseat',
312	            },
313	        ],
314	        # We don't do stage mirroring in the orchestrated world, and probably should not confuse users by inviting
315	        # these to be set. For extra security, even if you did set them they wouldn't work without enabling mirroring.
316	        # -kmp 24-Jul-2021
317	        # e.STAGE_MIRRORING_ENABLED: False,
318	        # e.STG_ENV_NAME: None,
319	        e.TEST_ENVS: ['acme-test', 'acme-mastertest', 'acme-pubtest'],
320	        e.WEBPROD_PSEUDO_ENV: 'production-data',
321	        e.PRODUCTION_ECR_REPOSITORY: 'acme-production',
322	        e.DEFAULT_WORKFLOW_ENV: 'acme-dev',
323	    }
324	
325	    @classmethod
326	    def init(cls, env_name=None, ecosystem=None, force=False, raise_load_errors=True, assuming_identity=True):
327	        if force or cls._DECLARED_DATA is None:
328	            cls.load_declared_data(env_name=env_name, ecosystem=ecosystem, raise_load_errors=raise_load_errors,
329	                                   assuming_identity=assuming_identity)
330	
331	    @classmethod
332	    def declared_data(cls):
333	        cls.init(raise_load_errors=False)
334	        return cls._DECLARED_DATA

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
284	                p.NAME: 'data',
285	                p.URL: 'https://genetics.example.com',
286	                p.HOST: 'genetics.example.com',
287	                p.ENVIRONMENT: 'acme-prd',
288	            },
289	            {
290	                p.NAME: 'staging',
291	                p.URL: 'https://stg.genetics.example.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
290	                p.NAME: 'staging',
291	                p.URL: 'https://stg.genetics.example.com',
292	                p.HOST: 'stg.genetics.example.com',
293	                p.ENVIRONMENT: 'acme-stg',
294	            },
295	            {
296	                p.NAME: 'test',
297	                p.URL: 'https://testing.genetics.example.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	                p.NAME: 'test',
297	                p.URL: 'https://testing.genetics.example.com',
298	                p.HOST: 'testing.genetics.example.com',
299	                p.ENVIRONMENT: 'acme-pubtest',
300	            },
301	            {
302	                p.NAME: 'demo',
303	                p.URL: 'https://demo.genetics.example.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	                p.NAME: 'demo',
303	                p.URL: 'https://demo.genetics.example.com',
304	                p.HOST: 'demo.genetics.example.com',
305	                p.ENVIRONMENT: 'acme-pubdemo',
306	            },
307	            {
308	                p.NAME: 'hot',
309	                p.URL: 'https://hot.genetics.example.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
308	                p.NAME: 'hot',
309	                p.URL: 'https://hot.genetics.example.com',
310	                p.HOST: 'hot.genetics.example.com',
311	                p.ENVIRONMENT: 'acme-hotseat',
312	            },
313	        ],
314	        # We don't do stage mirroring in the orchestrated world, and probably should not confuse users by inviting

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils.py:1135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1134	
1135	    if hostname1 == 'localhost' or hostname == '127.0.0.1':
1136	        environment = 'unknown'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils_legacy.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	
100	FF_PUBLIC_URL_STG = 'http://staging.4dnucleome.org'
101	FF_PUBLIC_URL_PRD = 'https://data.4dnucleome.org'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils_legacy.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	FF_PUBLIC_URL_STG = 'http://staging.4dnucleome.org'
101	FF_PUBLIC_URL_PRD = 'https://data.4dnucleome.org'
102	FF_PUBLIC_DOMAIN_STG = 'staging.4dnucleome.org'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils_legacy.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
112	# These names are recently changed but are only used internally to this repo. I did a github-wide search.
113	_CGAP_MGB_PUBLIC_URL_STG = 'https://staging.cgap-mgb.hms.harvard.edu'  # A stopgap for testing that may have to change
114	_CGAP_MGB_PUBLIC_URL_PRD = 'https://cgap-mgb.hms.harvard.edu'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils_legacy.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	_CGAP_MGB_PUBLIC_URL_STG = 'https://staging.cgap-mgb.hms.harvard.edu'  # A stopgap for testing that may have to change
114	_CGAP_MGB_PUBLIC_URL_PRD = 'https://cgap-mgb.hms.harvard.edu'
115	_CGAP_MGB_PUBLIC_DOMAIN_PRD = 'cgap.hms.harvard.edu'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils_legacy.py:566
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
565	# TODO: Figure out if these two actually designate different hosts or if we could make CGAP prettier. -kmp 4-Oct-2021
566	CGAP_FOURSIGHT_URL_PREFIX = "https://u9feld4va7.execute-api.us-east-1.amazonaws.com/api/view/"
567	FF_FOURSIGHT_URL_PREFIX = "https://foursight.4dnucleome.org/view/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils_legacy.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
566	CGAP_FOURSIGHT_URL_PREFIX = "https://u9feld4va7.execute-api.us-east-1.amazonaws.com/api/view/"
567	FF_FOURSIGHT_URL_PREFIX = "https://foursight.4dnucleome.org/view/"
568	
569	
570	def infer_foursight_url_from_env(*, request=None, envname: Optional[EnvName] = None):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/env_utils_legacy.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
708	
709	    if hostname1 == 'localhost' or hostname == '127.0.0.1':
710	        environment = 'unknown'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/es_utils.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	    final_result = []
186	    response = client.mget(body={  # XXX: this could still be slow even if you use is_generator
187	        'docs': [{'_id': _id,
188	                  '_source': ['embedded.*'],
189	                  '_index': index} for _id in uuids]
190	        })

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	                                        with EnvUtils.local_env_utils_for_testing(
183	                                                global_env_bucket=os.environ.get('GLOBAL_ENV_BUCKET'),
184	                                                env_name=(environments[0]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	                                                          if environments
186	                                                          else os.environ.get('ENV_NAME'))):
187	                                            yield mock_boto3

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
248	
249	    some_server = 'http://localhost:8000'
250	    some_auth_key, some_auth_secret = some_auth_tuple = ('mykey', 'mysecret')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
370	        for key, val in mocks.items():
371	            mocked[key] = mocks.get(key) or val
372	        yield

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
499	        expected_verb = expected_event['verb']
500	        expected_url = expected_event.get('url')
501	        if verb != expected_verb:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
503	        self.dt.sleep(expected_event['duration'])
504	        error_message = expected_event.get('error_message')
505	        if error_message:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
523	        parsed_json = json.loads(line)
524	        if parsed_json.get('verb') is None:
525	            PRINT(f"Consuming special non-request replay record.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
526	        else:
527	            PRINT(f"Consuming replay record {parsed_json.get('verb')} {parsed_json.get('url')}")
528	        return parsed_json

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
526	        else:
527	            PRINT(f"Consuming replay record {parsed_json.get('verb')} {parsed_json.get('url')}")
528	        return parsed_json

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
539	        start = datetime.datetime.now()
540	        data = kwargs.get('data')
541	        prefix = f"{self.recording_level * '>'} " if self.recording_level else ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
586	        expected_url = expected_event['url']
587	        kind = "error" if expected_event.get('error_message') else "normal"
588	        PRINT(f" from recording of {kind} result for {expected_verb} {expected_url}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
591	                                 f" expected call {expected_verb} {expected_url}")
592	        if expected_event.get('data') != kwargs.get('data'):  # might or might not have data
593	            raise AssertionError(f"Data mismatch on call {verb} {url}.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
591	                                 f" expected call {expected_verb} {expected_url}")
592	        if expected_event.get('data') != kwargs.get('data'):  # might or might not have data
593	            raise AssertionError(f"Data mismatch on call {verb} {url}.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
594	        self.dt.sleep(expected_event['duration'])
595	        error_message = expected_event.get('error_message')
596	        if error_message:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:678
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
677	            def do_authorized_request(verb, url, **kwargs):
678	                return ff_utils.internal_compute_authorized_request(url, verb=verb, **kwargs)
679	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
703	    healh_json_url = f"{portal_url}/health?format=json"
704	    response = requests.get(healh_json_url)
705	    health_json = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
739	        cls.S3_CLIENT = s3_utils.s3Utils(env=cls.ENV_NAME)
740	        cls.ES_URL = _portal_health_get(portal_url=cls.ENV_PORTAL_URL,
741	                                        namespace=cls.ENV_INDEX_NAMESPACE,
742	                                        key="elasticsearch")
743	        cls.PORTAL_ACCESS_KEY = cls.S3_CLIENT.get_access_keys()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
767	
768	        response = authorized_request(
769	            portal_access_key['server'],
770	            auth=portal_access_key)
771	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_mocks.py:816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
815	    ENV_INDEX_NAMESPACE = 'fourfront-mastertest'
816	    ENV_PORTAL_URL = 'https://mastertest.4dnucleome.org'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	        else:
125	            if res_json.get('@graph') is not None:
126	                final_res = res

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
172	                if res.status_code == 423:
173	                    locked_items = err_reason.get('comment', [])
174	                    if locked_items:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
217	                       retry_fxn=standard_request_with_retries, **kwargs):
218	    return mockable_authorized_request(url=url, auth=auth, ff_env=ff_env, verb=verb, retry_fxn=retry_fxn, **kwargs)
219	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
221	def mockable_authorized_request(url, *, auth, ff_env, verb, retry_fxn, **kwargs):
222	    return internal_compute_authorized_request(url=url, auth=auth, ff_env=ff_env, verb=verb, retry_fxn=retry_fxn,
223	                                               **kwargs)
224	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
245	    use_auth = unified_authentication(auth, ff_env)
246	    headers = kwargs.get('headers')
247	    if not headers:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
295	        url = f"/{obj_id}?{add_on}"
296	        response = vapp.get(url)
297	        if response and response.status_code in [301, 302, 303, 307, 308]:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
305	    # check the queues if check_queue is True
306	    response = authorized_request(get_url, auth=auth, verb='GET')
307	    return get_response_json(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
317	    auth = get_authentication_with_server(key, ff_env)
318	    obj_id = obj_id if obj_id else patch_item.get('accession', patch_item.get('uuid'))
319	    if not obj_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
317	    auth = get_authentication_with_server(key, ff_env)
318	    obj_id = obj_id if obj_id else patch_item.get('accession', patch_item.get('uuid'))
319	    if not obj_id:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
324	    patch_item = json.dumps(patch_item)
325	    response = authorized_request(patch_url, auth=auth, verb='PATCH', data=patch_item)
326	    return get_response_json(response)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:341
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
340	    post_item = json.dumps(post_item)
341	    response = authorized_request(post_url, auth=auth, verb='POST', data=post_item)
342	    return get_response_json(response)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
360	    try:
361	        response = authorized_request(upsert_url, auth=auth, verb='POST', data=upsert_item)
362	    except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
383	    # indexing below is needed because url params are returned in lists
384	    curr_from = int(url_params.get('from', ['0'])[0])  # use query 'from' or 0 if not provided
385	    initial_from = curr_from

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
385	    initial_from = curr_from
386	    search_limit = url_params.get('limit', ['all'])[0]  # use limit=all by default
387	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
390	    url_params['limit'] = [str(page_limit)]
391	    if not url_params.get('sort'):  # sort needed for pagination
392	        url_params['sort'] = ['-date_created']

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
400	        # use a different retry_fxn, since empty searches are returned as 400's
401	        response = authorized_request(search_url, auth=auth, ff_env=ff_env,
402	                                      retry_fxn=search_request_with_retries)
403	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
445	            if isinstance(item, dict):
446	                item_uuid = item.get('uuid')
447	                if item_uuid:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
481	                if isinstance(item, dict):
482	                    item_uuid = item.get('uuid')
483	                    if item_uuid:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
496	    facets = {}
497	    for query_url, info in resp.get('facets', {}).items():
498	        facets[info['title']] = query_url

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
553	    """
554	    item_facets = kwargs.get('item_facets', None)
555	    item_type = 'ExperimentSetReplicate' if item_type is None else item_type

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
612	            for entry in target_files:
613	                if entry.get('quality_metric'):
614	                    # check if it is a list of qc metrics

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
617	                        qc_metric_list = get_metadata(qc_metric_list_uuid, key=key, ff_env=ff_env)
618	                        if not qc_metric_list.get('qc_list'):
619	                            continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
714	    # If it is an experimentset, get qc_metrics for the experiments in the experiment set
715	    if resp.get('experiments_in_set'):
716	        organism = resp['experiments_in_set'][0]['biosample']['biosource'][0]['organism']['name']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
737	
738	    description = resp.get('dataset_label', None)
739	    es_qc_metrics = fetch_files_qc_metrics(resp, associated_files, key=key, ff_env=ff_env)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
761	    links_url = '/'.join([auth['server'], obj_id, '@@links'])
762	    response = authorized_request(links_url, auth=auth, verb='GET')
763	    return get_response_json(response)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
782	    purge_url = '/'.join([auth['server'], obj_id]) + '?purge=True'
783	    response = authorized_request(purge_url, auth=auth, verb='DELETE',
784	                                  retry_fxn=purge_request_with_retries)
785	    return get_response_json(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
795	    if isinstance(obj_id, dict):
796	        obj_id = obj_id.get("accession", obj_id.get("uuid"))
797	        if not obj_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:796
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
795	    if isinstance(obj_id, dict):
796	        obj_id = obj_id.get("accession", obj_id.get("uuid"))
797	        if not obj_id:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
803	    # use an empty patch body
804	    response = authorized_request(patch_url, auth=auth, verb='PATCH', data=json.dumps({}))
805	    return get_response_json(response)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
899	    def get_es_host_local() -> Optional[str]:
900	        return os.environ.get("ES_HOST_LOCAL", None)
901	    health = get_health_page(key=auth)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
905	        es_client = es_utils.create_es_client(es_url, use_aws_auth=True)
906	    namespace_star = health.get('namespace', '') + '*'
907	    # match all given uuids to _id fields

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1011
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1010	        full_url = f"/{base_url}?{add_on}"
1011	        res = portal_vapp.get(full_url)
1012	        return get_response_json(res)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1042	        full_url = f"/{base_url}?{add_on}"
1043	        schemas: Dict[str, Dict] = portal_vapp.get(full_url)
1044	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1047	    for schema_name, schema in schemas.items():
1048	        if allow_abstract or not schema.get('isAbstract'):
1049	            id_field = schema.get('$id')  # some test schemas in local may not have the $id field

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1049
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1048	        if allow_abstract or not schema.get('isAbstract'):
1049	            id_field = schema.get('$id')  # some test schemas in local may not have the $id field
1050	            if id_field or not require_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1077
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1076	    return {
1077	        schema_name: remove_suffix(".json", schema.get('$id').split('/')[-1])
1078	        for schema_name, schema in schemas.items()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1200	            # check if any field from the embedded frame is required
1201	            add_fields = add_from_embedded.get(obj_key)
1202	            if add_fields:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1203	                for a_field in add_fields:
1204	                    field_val = es_item['embedded'].get(a_field)
1205	                    if field_val:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1226	        auth = get_authentication_with_server(key, ff_env)
1227	        page_res = authorized_request(auth['server'] + page, auth=auth, verb='GET')
1228	        ret = get_response_json(page_res)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1390	        # If {"default": {...auth...}, ...} is given, peel off outer wrapper and use the inner {...auth...} part.
1391	        if isinstance(auth, dict) and isinstance(auth.get('default'), dict):
1392	            return auth['default']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1414	    """
1415	    if isinstance(auth, dict) and isinstance(auth.get('default'), dict):
1416	        auth = auth['default']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1461	        try:
1462	            queue_url = client.get_queue_url(
1463	                QueueName=ff_env_index_namespace + queue_name
1464	            ).get('QueueUrl')
1465	            queue_attrs = client.get_queue_attributes(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1464	            ).get('QueueUrl')
1465	            queue_attrs = client.get_queue_attributes(
1466	                QueueUrl=queue_url,
1467	                AttributeNames=['ApproximateNumberOfMessages', 'ApproximateNumberOfMessagesNotVisible']
1468	            ).get('Attributes', {})
1469	        except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1473	        else:
1474	            visible = queue_attrs.get('ApproximateNumberOfMessages', '-1')
1475	            not_vis = queue_attrs.get('ApproximateNumberOfMessagesNotVisible', '-1')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/ff_utils.py:1475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1474	            visible = queue_attrs.get('ApproximateNumberOfMessages', '-1')
1475	            not_vis = queue_attrs.get('ApproximateNumberOfMessagesNotVisible', '-1')
1476	            if (visible and int(visible) > 0) or (not_vis and int(not_vis) > 0):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	                while True:
146	                    chunka = fa.read(chunk_size)
147	                    chunkb = fb.read(chunk_size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	                    chunka = fa.read(chunk_size)
147	                    chunkb = fb.read(chunk_size)
148	                    if chunka != chunkb:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
167	        with open(file, "rb") as file:
168	            for chunk in iter(lambda: file.read(4096), b""):
169	                md5.update(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
205	        # Read some from stdin, if we're at the end, stop reading
206	        bits = f.read(1048576)
207	        if len(bits) == 0:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
252	        if binary is True:
253	            f.write(os.urandom(nbytes))
254	        else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
252	        if binary is True:
253	            f.write(os.urandom(nbytes))
254	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
260	            for n in range(nlines):
261	                f.write("".join(random.choices(string.ascii_letters + string.digits, k=line_length - 1)))
262	                f.write("\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
260	            for n in range(nlines):
261	                f.write("".join(random.choices(string.ascii_letters + string.digits, k=line_length - 1)))
262	                f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
261	                f.write("".join(random.choices(string.ascii_letters + string.digits, k=line_length - 1)))
262	                f.write("\n")
263	            if nremainder > 1:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
261	                f.write("".join(random.choices(string.ascii_letters + string.digits, k=line_length - 1)))
262	                f.write("\n")
263	            if nremainder > 1:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
263	            if nremainder > 1:
264	                f.write("".join(random.choices(string.ascii_letters + string.digits, k=nremainder - 1)))
265	            if nremainder > 0:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
263	            if nremainder > 1:
264	                f.write("".join(random.choices(string.ascii_letters + string.digits, k=nremainder - 1)))
265	            if nremainder > 0:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
265	            if nremainder > 0:
266	                f.write("\n")
267	    return file

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/file_utils.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
265	            if nremainder > 0:
266	                f.write("\n")
267	    return file

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/glacier_utils.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
456	        if parallel:
457	            with ThreadPoolExecutor(max_workers=num_threads) as executor:
458	                futures = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/http_utils.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	        progress = None
27	    response = requests.get(url, stream=True)
28	    if progress:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/http_utils.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	        nbytes_total = None
31	        if isinstance(content_length := response.headers.get("Content-Length"), str) and content_length.isdigit():
32	            nbytes_total = int(content_length)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/jh_utils.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	# env variable, since all that would do is make these functions not work
20	DATA_SERVER = os.environ.get('_JH_FF_SERVER', 'https://data.4dnucleome.org')
21	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/jh_utils.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
247	        # this seems to handle both binary and non-binary files
248	        ff_file = urllib.request.urlopen(file_info['full_href'])
249	        if file_info.get('full_href', '').endswith('.gz'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/misc_utils.py:1535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1534	    with io.open(filename, 'rb' if binary else 'r') as fp:
1535	        return fp.read()
1536	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/misc_utils.py:2893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2892	def get_os_name() -> str:
2893	    if os_name := platform.system():
2894	        if os_name == "Darwin": return "osx"  # noqa

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/misc_utils.py:2893
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
2892	def get_os_name() -> str:
2893	    if os_name := platform.system():
2894	        if os_name == "Darwin": return "osx"  # noqa

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/misc_utils.py:2893
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
2892	def get_os_name() -> str:
2893	    if os_name := platform.system():
2894	        if os_name == "Darwin": return "osx"  # noqa

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/misc_utils.py:2927
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
2926	def run_concurrently(functions: Iterable[Callable], nthreads: int = 4) -> None:
2927	    with concurrent.futures.ThreadPoolExecutor(max_workers=nthreads) as executor:
2928	        concurrent.futures.as_completed([executor.submit(f) for f in functions])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	            init(unspecified=unspecified)
108	            if (isinstance(key_id := key.get("key"), str) and key_id and
109	                isinstance(secret := key.get("secret"), str) and secret):  # noqa

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	            if (isinstance(key_id := key.get("key"), str) and key_id and
109	                isinstance(secret := key.get("secret"), str) and secret):  # noqa
110	                self._key = {"key": key_id, "secret": secret}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	                self._key = {"key": key_id, "secret": secret}
111	                if (isinstance(server, str) and server) or (isinstance(server := key.get("server"), str) and server):
112	                    if server := Portal._normalize_server(server):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	                    if server := Portal._normalize_server(server):
113	                        if isinstance(key_server := key.get("server"), str) and key_server:
114	                            if Portal._normalize_server(key_server) != server:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	    def key_pair(self) -> Optional[Tuple[str, str]]:
182	        return (key.get("key"), key.get("secret")) if (key := self.key) else None
183	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	    def key_pair(self) -> Optional[Tuple[str, str]]:
182	        return (key.get("key"), key.get("secret")) if (key := self.key) else None
183	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	    def key_id(self) -> Optional[str]:
186	        return key.get("key") if (key := self.key) else None
187	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
189	    def secret(self) -> Optional[str]:
190	        return key.get("secret") if (key := self.key) else None
191	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	    def server(self) -> Optional[str]:
202	        return key.get("server") if (key := self.key) and key.get("server") else self._server
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	    def server(self) -> Optional[str]:
202	        return key.get("server") if (key := self.key) and key.get("server") else self._server
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	        if not self.vapp:
239	            response = requests.get(url, allow_redirects=follow, **self._kwargs(**kwargs))
240	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
240	        else:
241	            response = self.vapp.get(url, **self._kwargs(**kwargs))
242	            if response and response.status_code in [301, 302, 303, 307, 308] and follow:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
267	        if not self.vapp:
268	            response = requests.post(url, data=data, json=json, files=files, **self._kwargs(**kwargs))
269	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
270	            if files:
271	                response = self.vapp.post(url, json or data, upload_files=files, **self._kwargs(**kwargs))
272	            else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
335	                                 add_on="check_only=True" if check_only else "")
336	        return self.post(f"/{object_type}{'?check_only=True' if check_only else ''}", data).json()
337	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
349	    def get_health(self) -> OptionalResponse:
350	        return self.get("/health")
351	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
372	    def get_schemas(self) -> dict:
373	        return self.get("/profiles/").json()
374	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
425	        if isinstance(portal_object, dict):
426	            if isinstance(value_types := portal_object.get("@type"), str):
427	                value_types = [value_types] if value_types else []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
429	                value_types = []
430	            if isinstance(data_type := portal_object.get("data_type"), list):
431	                value_types.extend(data_type)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
450	            result = []
451	            queue = deque(super_type_map.get(super_type_name, []))
452	            while queue:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
461	            if isinstance(schema_type := schemas[type_name], dict):
462	                if super_type_name := schema_type.get("rdfs:subClassOf"):
463	                    super_type_name = super_type_name.replace("/profiles/", "").replace(".json", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
464	                    if super_type_name != "Item":
465	                        if not super_type_map.get(super_type_name):
466	                            super_type_map[super_type_name] = [type_name]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
490	            return []
491	        return schemas_super_type_map.get(type_name, [])
492	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
519	                # It appears that the given portal_type is an actual schema dictionary.
520	                portal_type = self.schema_name(portal_type.get("title"))
521	            if not (isinstance(portal_type, str) and portal_type):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
526	        for identifying_property in self.get_identifying_property_names(portal_type):
527	            if not (identifying_value := portal_object.get(identifying_property)):
528	                continue

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
574	                                continue
575	                    if pattern := schema.get("properties", {}).get(identifying_property, {}).get("pattern"):
576	                        if not re.match(pattern, identifying_value):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
574	                                continue
575	                    if pattern := schema.get("properties", {}).get(identifying_property, {}).get("pattern"):
576	                        if not re.match(pattern, identifying_value):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
574	                                continue
575	                    if pattern := schema.get("properties", {}).get(identifying_property, {}).get("pattern"):
576	                        if not re.match(pattern, identifying_value):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:636
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
635	            for identifying_property in [*identifying_properties]:
636	                if portal_object.get(identifying_property) is None:
637	                    identifying_properties.remove(identifying_property)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
675	            """
676	            if property_format := schema.get("properties", {}).get(property_name, {}).get("format"):
677	                if (property_format == "accession") and (property_name == "accession"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
675	            """
676	            if property_format := schema.get("properties", {}).get(property_name, {}).get("format"):
677	                if (property_format == "accession") and (property_name == "accession"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
675	            """
676	            if property_format := schema.get("properties", {}).get(property_name, {}).get("format"):
677	                if (property_format == "accession") and (property_name == "accession"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
687	                return DEFAULT_RESULT
688	        if schema_properties := schema.get("properties"):
689	            if schema_properties.get("accession") and Portal._is_accession_id(value):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
688	        if schema_properties := schema.get("properties"):
689	            if schema_properties.get("accession") and Portal._is_accession_id(value):
690	                # Case: lookup by accession (only by root).

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
691	                return (Portal.LOOKUP_ROOT, ref_validator)
692	            elif schema_property_info_submitted_id := schema_properties.get("submitted_id"):
693	                if schema_property_pattern_submitted_id := schema_property_info_submitted_id.get("pattern"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:693
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
692	            elif schema_property_info_submitted_id := schema_properties.get("submitted_id"):
693	                if schema_property_pattern_submitted_id := schema_property_info_submitted_id.get("pattern"):
694	                    if re.match(schema_property_pattern_submitted_id, value):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
725	            result_kwargs["auth"] = self.key_pair
726	        if isinstance(timeout := kwargs.get("timeout"), int):
727	            result_kwargs["timeout"] = timeout

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
754	            return None, None
755	        if isinstance(env, str) and env and isinstance(key := keys.get(env), dict):
756	            return key, env

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
757	        elif (isinstance(server, str) and (server := Portal._normalize_server(server)) and
758	              (key := [keys[k] for k in keys if Portal._normalize_server(keys[k].get("server")) == server])):
759	            return key[0], env

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:863
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
862	            for endpoint in endpoints:
863	                if (endpoint_path := endpoint.get("path")) and (endpoint_function := endpoint.get("function")):
864	                    endpoint_method = endpoint.get("method", "GET")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:863
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
862	            for endpoint in endpoints:
863	                if (endpoint_path := endpoint.get("path")) and (endpoint_function := endpoint.get("function")):
864	                    endpoint_method = endpoint.get("method", "GET")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
863	                if (endpoint_path := endpoint.get("path")) and (endpoint_function := endpoint.get("function")):
864	                    endpoint_method = endpoint.get("method", "GET")
865	                    def endpoint_wrapper(request):  # noqa

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:880
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
879	            def start_server() -> None:  # noqa
880	                with wsgi_make_server("0.0.0.0", port or 7070, self.vapp.app) as server:
881	                    server.serve_forever()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/portal_utils.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
882	            if asynchronous:
883	                server_thread = Thread(target=start_server)
884	                server_thread.daemon = True

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/progress_bar.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
269	            if callable(interrupt_handler) and (threading.current_thread() == threading.main_thread()):
270	                return signal(SIGINT, interrupt_handler)
271	            return None

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/progress_bar.py:270
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
269	            if callable(interrupt_handler) and (threading.current_thread() == threading.main_thread()):
270	                return signal(SIGINT, interrupt_handler)
271	            return None

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
411	                PRINT(f"Preparing to overwrite {self.file}.")
412	            file_system.prepare_for_overwrite(self.file)
413	        if FILE_SYSTEM_VERBOSE:  # pragma: no cover - Debugging option. Doesn't need testing.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
448	                    with open(file, 'rb') as fp:
449	                        self.files[file] = fp.read()
450	                self._do_not_mirror(file)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
497	        if mode in ('w', 'wt', 'w+', 'w+t', 'wt+'):
498	            return self._open_for_write(file_system=self, file=file, binary=False, encoding=encoding)
499	        elif mode in ('wb', 'w+b', 'wb+'):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
499	        elif mode in ('wb', 'w+b', 'wb+'):
500	            return self._open_for_write(file_system=self, file=file, binary=True, encoding=encoding)
501	        elif mode in ('r', 'rt', 'r+', 'r+t', 'rt+'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
501	        elif mode in ('r', 'rt', 'r+', 'r+t', 'rt+'):
502	            return self._open_for_read(file, binary=False, encoding=encoding)
503	        elif mode in ('rb', 'r+b', 'rb+'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
503	        elif mode in ('rb', 'r+b', 'rb+'):
504	            return self._open_for_read(file, binary=True, encoding=encoding)
505	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
655	        self.status_code = status_code
656	        self.url = url or "http://unknown/"
657	        if json is not None and content is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:935
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
934	            config = configparser.ConfigParser()
935	            config.read(aws_credentials_file)
936	            if not config or not config.sections() or len(config.sections()) <= 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:2272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2271	        self.check_for_kwargs_required_by_mock("upload_fileobj", Bucket=Bucket, Key=Key, **kwargs)
2272	        data = Fileobj.read()
2273	        PRINT(f"Uploading {Fileobj} ({len(data)} bytes) to bucket {Bucket} key {Key}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:2275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2274	        with self.s3_files.open(os.path.join(Bucket, Key), 'wb') as fp:
2275	            fp.write(data)
2276	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:2285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2284	        with self.s3_files.open(os.path.join(Bucket, Key), 'rb') as fp:
2285	            data = fp.read()
2286	        PRINT(f"Downloading bucket {Bucket} key {Key} ({len(data)} bytes) to {Fileobj}")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:2287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2286	        PRINT(f"Downloading bucket {Bucket} key {Key} ({len(data)} bytes) to {Fileobj}")
2287	        Fileobj.write(data)
2288	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/qa_utils.py:2966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2965	
2966	    MOCK_QUEUE_URL_PREFIX = 'https://sqs.us-east-1.amazonaws.com.mock/12345/'  # just something to look like a URL
2967	
2968	    def compute_mock_queue_url(self, queue_name):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/s3_utils.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
319	                                      SSECustomerAlgorithm='AES256')
320	        body_data: Union[bytes, str] = response['Body'].read()
321	        auth_text: str = body_data.decode() if type(body_data) is bytes else body_data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/s3_utils.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
335	        logger.info(str(response))
336	        return response['Body'].read()
337	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/s3_utils.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
522	            if zipped_filename:
523	                ret_files[name] = zipstream.open(zipped_filename).read()
524	        return ret_files

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/s3_utils.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
558	                    s3_file_name = dest_dir + file_name
559	                s3_key = "https://s3.amazonaws.com/%s/%s" % (self.outfile_bucket, s3_file_name)
560	                # just perf optimization so we don't have to copy

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/s3_utils.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
561	                # files twice that we want to further interrogate
562	                the_file = zipstream.open(file_name, 'r').read()
563	                file_to_find = os.path.basename(file_name)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/publish_to_pypi.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	
42	PYPI_BASE_URL = "https://pypi.org"
43	PYPI_API_TOKEN_USERNAME = "__token__"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/publish_to_pypi.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	    if not pypi_username:
106	        pypi_username = os.environ.get("PYPI_USER")
107	    if not pypi_password:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/publish_to_pypi.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	    if not pypi_password:
108	        pypi_password = os.environ.get("PYPI_PASSWORD")
109	    if not pypi_username or not pypi_password:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/publish_to_pypi.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
222	    try:
223	        response = requests.get(url).json()["releases"]
224	    except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/publish_to_pypi.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	        return True
228	    if response.get(package_version):
229	        ERROR_PRINT(f"Package {package_name} {package_version} has already been published to PyPi.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/publish_to_pypi.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
240	    DEBUG_PRINT(f"curl {url}")
241	    response = requests.get(url)
242	    if response.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/publish_to_pypi.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
307	    for pyproject_package_directory in pyproject_package_directories:
308	        package_directory = pyproject_package_directory.get("include")
309	        if package_directory:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/publish_to_pypi.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
309	        if package_directory:
310	            package_directory_from = pyproject_package_directory.get("from")
311	            if package_directory_from:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/update_portal_object.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
665	                            for item in loadxl_unresolved:
666	                                f.write(f"{item}\n")
667	    if debug and loadxl_output:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/view_portal_object.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
841	    if _output_file:
842	        _output_file.write(value)
843	        _output_file.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/scripts/view_portal_object.py:843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
842	        _output_file.write(value)
843	        _output_file.write("\n")
844	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	            if ch == 'r':
128	                s.write('\r')
129	            elif ch == 't':

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
127	            if ch == 'r':
128	                s.write('\r')
129	            elif ch == 't':

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
129	            elif ch == 't':
130	                s.write('\t')
131	            elif ch == 'n':

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
129	            elif ch == 't':
130	                s.write('\t')
131	            elif ch == 'n':

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
131	            elif ch == 'n':
132	                s.write('\n')
133	            elif ch == '\\':

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
131	            elif ch == 'n':
132	                s.write('\n')
133	            elif ch == '\\':

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
133	            elif ch == '\\':
134	                s.write('\\')
135	            else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
133	            elif ch == '\\':
134	                s.write('\\')
135	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
136	                # Rather than err, just leave other sequences as-is.
137	                s.write(f"\\{ch}")
138	            escaping = False

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
136	                # Rather than err, just leave other sequences as-is.
137	                s.write(f"\\{ch}")
138	            escaping = False

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	        else:
142	            s.write(ch)
143	    return s.getvalue()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
141	        else:
142	            s.write(ch)
143	    return s.getvalue()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/sheet_utils.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	    with io.open(filename, 'rb') as fp:
151	        leading_bytes = fp.read(4 * 8)  # 4 bytes is all we need
152	        bom_info = chardet.detect(leading_bytes, should_rename_legacy=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/submitr/custom_excel.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	
78	CUSTOM_COLUMN_MAPPINGS_BASE_URL = "https://raw.githubusercontent.com/smaht-dac/submitr/refs/heads"
79	CUSTOM_COLUMN_MAPPINGS_BRANCH = "master"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/submitr/custom_excel.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	                try:
112	                    custom_column_mappings = requests_get(CUSTOM_COLUMN_MAPPINGS_URL).json()
113	                except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/submitr/custom_excel.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	        def post_process_custom_column_mappings(custom_column_mappings: dict) -> Optional[dict]:
128	            if isinstance(column_mappings := custom_column_mappings.get("column_mappings"), dict):
129	                if isinstance(sheet_mappings := custom_column_mappings.get("sheet_mappings"), dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/submitr/custom_excel.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	            if isinstance(column_mappings := custom_column_mappings.get("column_mappings"), dict):
129	                if isinstance(sheet_mappings := custom_column_mappings.get("sheet_mappings"), dict):
130	                    for sheet_name in list(sheet_mappings.keys()):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/submitr/custom_excel.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	                        if isinstance(sheet_mappings[sheet_name], str):
132	                            if isinstance(column_mappings.get(sheet_mappings[sheet_name]), dict):
133	                                sheet_mappings[sheet_name] = column_mappings.get(sheet_mappings[sheet_name])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/submitr/custom_excel.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	                            if isinstance(column_mappings.get(sheet_mappings[sheet_name]), dict):
133	                                sheet_mappings[sheet_name] = column_mappings.get(sheet_mappings[sheet_name])
134	                            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/submitr/custom_excel.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	                if isinstance(custom_column_mappings, dict) and isinstance(sheet_name, str):
157	                    if isinstance(found_custom_column_mappings := custom_column_mappings.get(sheet_name), dict):
158	                        return found_custom_column_mappings

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/submitr/custom_excel.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	                        if isinstance(found_custom_column_mappings :=
161	                                      custom_column_mappings.get(effective_sheet_name), dict):
162	                            return found_custom_column_mappings

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/submitr/custom_excel.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	            if not (isinstance(custom_column_mappings, dict) and
167	                    isinstance(sheet_name := kwargs.get(ARGUMENT_NAME_SHEET_NAME, None), str) and
168	                    isinstance(custom_column_mappings :=

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/tmpfile_utils.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
27	            if content is not None:
28	                tmp_file.write("\n".join(content) if isinstance(content, list) else content)
29	        yield tmp_file_path

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/tmpfile_utils.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
27	            if content is not None:
28	                tmp_file.write("\n".join(content) if isinstance(content, list) else content)
29	        yield tmp_file_path

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/tmpfile_utils.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
53	    if is_temporary_directory(tmp_directory_name):  # Guard against errant deletion.
54	        shutil.rmtree(tmp_directory_name)
55	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/zip_utils.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
22	    with temporary_directory() as tmp_directory_name:
23	        with tarfile.open(file, "r") as tarf:
24	            tarf.extractall(tmp_directory_name)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/zip_utils.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
44	        with temporary_file(name=os.path.basename(file[:-3] if gz else file[:-4] + ".tar")) as tmp_file_name:
45	            with open(tmp_file_name, "wb") as outputf:
46	                with gzip.open(file, "rb") as inputf:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/zip_utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
45	            with open(tmp_file_name, "wb") as outputf:
46	                with gzip.open(file, "rb") as inputf:
47	                    outputf.write(inputf.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/zip_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
46	                with gzip.open(file, "rb") as inputf:
47	                    outputf.write(inputf.read())
48	                    outputf.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/zip_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
46	                with gzip.open(file, "rb") as inputf:
47	                    outputf.write(inputf.read())
48	                    outputf.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dcicutils-8.18.3/dcicutils-8.18.3/dcicutils/zip_utils.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	                with gzip.open(file, "rb") as inputf:
47	                    outputf.write(inputf.read())
48	                    outputf.close()

--------------------------------------------------

Code scanned:
	Total lines of code: 25775
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 230.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 267.0
		High: 3.0
Files skipped (0):
