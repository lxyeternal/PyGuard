Run started:2025-04-12 18:16:03.415491

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/cloud/cloud_model.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	        try:
64	            response = requests.get(url, timeout = params.TIMEOUT)
65	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/cloud/cloud_model.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
107	            headers = {'Authorization': f'Bearer {_self.api_key}'}
108	            response = requests.post(url, headers=headers, json=email_data, timeout=params.TIMEOUT)
109	        except Exception as e:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/google_model.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
50	        """
51	        self.code_verifier = base64.urlsafe_b64encode(os.urandom(32)).decode('utf-8').rstrip('=')
52	    def generate_code_challenge(self) -> str:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/google_model.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
62	            raise LoginError('Code verifier not generated')
63	        return base64.urlsafe_b64encode(
64	            hashlib.sha256(self.code_verifier.encode('utf-8')).digest()).decode('utf-8').rstrip('=')
65	    def login_google(self) -> str:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/google_model.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        google_auth_endpoint = (
77	            f"https://accounts.google.com/o/oauth2/auth"
78	            f"?client_id={self.google['client_id']}"
79	            f"&redirect_uri={self.google['redirect_uri']}"
80	            f"&response_type=code"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/google_model.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	            st.session_state['GoogleModel.get_google_user_info'] = True
105	            token_url = 'https://oauth2.googleapis.com/token'
106	            token_data = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/google_model.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	                'client_id': self.google['client_id'],
109	                'client_secret': self.google.get('client_secret'),
110	                'redirect_uri': self.google['redirect_uri'],

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/google_model.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
113	            }
114	            token_r = requests.post(token_url, data=token_data, timeout=10)
115	            token_json = token_r.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/google_model.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
118	                st.rerun()
119	            user_info_url = 'https://www.googleapis.com/oauth2/v2/userinfo'
120	            user_info_headers = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/google_model.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	            }
123	            user_info_r = requests.get(user_info_url, headers=user_info_headers, timeout=10)
124	            if user_info_r.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/google_model.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
137	        """
138	        auth_code = st.query_params.get('code')
139	        if auth_code:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/microsoft_model.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
52	        """
53	        self.code_verifier = base64.urlsafe_b64encode(os.urandom(32)).decode('utf-8').rstrip('=')
54	    def generate_code_challenge(self) -> str:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/microsoft_model.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
64	            raise LoginError('Code verifier not generated')
65	        return base64.urlsafe_b64encode(
66	            hashlib.sha256(self.code_verifier.encode('utf-8')).digest()).decode('utf-8').rstrip('=')
67	    def login_microsoft(self) -> str:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/microsoft_model.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        microsoft_auth_endpoint = (
79	            f"https://login.microsoftonline.com/{self.microsoft['tenant_id']}/oauth2/v2.0/authorize"
80	            f"?client_id={self.microsoft['client_id']}"
81	            f"&redirect_uri={self.microsoft['redirect_uri']}"
82	            f"&response_type=code"

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/microsoft_model.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
104	            raise ValueError('Invalid JWT token')
105	        decoded_payload = base64.urlsafe_b64decode(parts[1] + '==')
106	        payload_json = json.loads(decoded_payload)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/microsoft_model.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	            st.session_state['MicrosoftModel.get_microsoft_user_info'] = True
127	            base_url = 'https://login.microsoftonline.com'
128	            token_url = f"{base_url}/{self.microsoft['tenant_id']}/oauth2/v2.0/token"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/microsoft_model.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	                'client_id': self.microsoft['client_id'],
132	                'client_secret': self.microsoft.get('client_secret'),
133	                'redirect_uri': self.microsoft['redirect_uri'],

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/microsoft_model.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
136	            }
137	            token_r = requests.post(token_url, data=token_data, timeout=10)
138	            token_json = token_r.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/models/oauth2/microsoft_model.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	        """
164	        auth_code = st.query_params.get('code')
165	        if auth_code:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/params.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	AUTO_HASH_MAX_USERS:        int     =   30
6	AUTO_HASH_MAX_USERS_LINK:   str     =   "https://github.com/mkhorasani/Streamlit-Authenticator?tab=readme-ov-file#4-setup"
7	PASSWORD_INSTRUCTIONS:      str     =   """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/params.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	PRE_LOGIN_SLEEP_TIME:       float   =   0.7
17	REGISTER_USER_LINK:         str     =   "https://github.com/mkhorasani/Streamlit-Authenticator?tab=readme-ov-file#authenticateregister_user"
18	REMOTE_VARIABLES_LINK:      str     =   "https://raw.githubusercontent.com/mkhorasani/streamlit_authenticator_variables/main/variables"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/params.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	REGISTER_USER_LINK:         str     =   "https://github.com/mkhorasani/Streamlit-Authenticator?tab=readme-ov-file#authenticateregister_user"
18	REMOTE_VARIABLES_LINK:      str     =   "https://raw.githubusercontent.com/mkhorasani/streamlit_authenticator_variables/main/variables"
19	TWO_FACTOR_AUTH_LINK:       str     =   "https://github.com/mkhorasani/Streamlit-Authenticator?tab=readme-ov-file#8-enabling-two-factor-authentication"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/params.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	REMOTE_VARIABLES_LINK:      str     =   "https://raw.githubusercontent.com/mkhorasani/streamlit_authenticator_variables/main/variables"
19	TWO_FACTOR_AUTH_LINK:       str     =   "https://github.com/mkhorasani/Streamlit-Authenticator?tab=readme-ov-file#8-enabling-two-factor-authentication"
20	
21	# CLOUD
22	SEND_EMAIL:                 str     =   "/send_email"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/params.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	SEND_EMAIL:                 str     =   "/send_email"
23	SERVER_URL:                 str     =   "https://mkhorasani.pythonanywhere.com"
24	TIMEOUT:                    int     =   30

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/streamlit_authenticator-0.4.2-py3-none-any/streamlit_authenticator/utilities/encryptor.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
32	        secret_key = hashlib.sha256(secret_key.encode()).digest()[:32]
33	        secret_key = base64.urlsafe_b64encode(secret_key)
34	        self.cipher = Fernet(secret_key)

--------------------------------------------------

Code scanned:
	Total lines of code: 3024
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 0.0
Files skipped (0):
