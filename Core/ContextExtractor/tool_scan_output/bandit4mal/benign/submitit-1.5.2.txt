Run started:2025-04-12 16:59:12.731417

Test results:
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/integration/preemption.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
55	        slurm_mail_type="REQUEUE,BEGIN",
56	        slurm_mail_user=f"{getpass.getuser()}+slurm@meta.com",
57	        # pascal nodes have 80 cpus.

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/integration/preemption.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
55	        slurm_mail_type="REQUEUE,BEGIN",
56	        slurm_mail_user=f"{getpass.getuser()}+slurm@meta.com",
57	        # pascal nodes have 80 cpus.

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/integration/preemption.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
109	        log.info(f"Cleaning up log folder: {LOGS}")
110	        shutil.rmtree(str(LOGS))
111	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
73	    def hostname(self) -> str:
74	        return socket.gethostname()
75	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:74
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
73	    def hostname(self) -> str:
74	        return socket.gethostname()
75	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
152	        handler = SignalHandler(self, paths, submission)
153	        signal.signal(self._usr_sig(), handler.checkpoint_and_try_requeue)
154	        # A priori we don't need other signals anymore,

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:153
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
152	        handler = SignalHandler(self, paths, submission)
153	        signal.signal(self._usr_sig(), handler.checkpoint_and_try_requeue)
154	        # A priori we don't need other signals anymore,

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
155	        # but still log them to make it easier to debug.
156	        signal.signal(signal.SIGTERM, handler.bypass)
157	        signal.signal(signal.SIGCONT, handler.bypass)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:156
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
155	        # but still log them to make it easier to debug.
156	        signal.signal(signal.SIGTERM, handler.bypass)
157	        signal.signal(signal.SIGCONT, handler.bypass)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
156	        signal.signal(signal.SIGTERM, handler.bypass)
157	        signal.signal(signal.SIGCONT, handler.bypass)
158	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:157
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
156	        signal.signal(signal.SIGTERM, handler.bypass)
157	        signal.signal(signal.SIGCONT, handler.bypass)
158	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
202	        self._logger.warning(
203	            f"Caught signal {signal.Signals(signum).name} on {socket.gethostname()}: this job is {case}."
204	        )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
202	        self._logger.warning(
203	            f"Caught signal {signal.Signals(signum).name} on {socket.gethostname()}: this job is {case}."
204	        )

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
233	        # Note: no signal is actually bound to `checkpoint_and_exit` but this is used by plugins.
234	        self._logger.info(f"Caught signal {signal.Signals(signum).name} on {socket.gethostname()}")
235	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/job_environment.py:234
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
233	        # Note: no signal is actually bound to `checkpoint_and_exit` but this is used by plugins.
234	        self._logger.info(f"Caught signal {signal.Signals(signum).name} on {socket.gethostname()}")
235	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/utils.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
230	    # this is used by cloudpickle as well
231	    with open(filename, "rb") as ifile:
232	        return pickle.load(ifile)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/utils.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
235	def cloudpickle_dump(obj: tp.Any, filename: tp.Union[str, Path]) -> None:
236	    with open(filename, "wb") as ofile:
237	        cloudpickle.dump(obj, ofile, pickle.HIGHEST_PROTOCOL)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/utils.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
269	            p_stream, string, std = stream_by_fd[fd]
270	            raw_buf = p_stream.read(2**16)
271	            if not raw_buf:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/utils.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
275	            buf = raw_buf.decode()
276	            string.write(buf)
277	            string.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/utils.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
278	            if verbose:
279	                std.write(buf)
280	                std.flush()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/core/utils.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
330	            print(f"The following command is sent: \"{' '.join(full_command)}\"")
331	        with subprocess.Popen(
332	            full_command,
333	            stdout=subprocess.PIPE,
334	            stderr=subprocess.PIPE,
335	            shell=False,
336	            cwd=self.cwd,
337	            env=self.env,
338	        ) as process:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/local/local.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
77	        if self._process is not None:
78	            self._process.send_signal(signal.SIGINT)
79	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/local/local.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
82	        if self._process is not None:
83	            self._process.send_signal(LocalJobEnvironment._usr_sig())
84	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/local/local.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
289	        self.folder = Path(folder)
290	        signal.signal(signal.SIGTERM, self._forward_signal)  # type: ignore
291	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/local/local.py:290
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
289	        self.folder = Path(folder)
290	        signal.signal(signal.SIGTERM, self._forward_signal)  # type: ignore
291	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/local/local.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
295	            try:
296	                task.send_signal(signum)  # sending kill signal to make sure everything finishes
297	            except Exception:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/local/local.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
323	        for sig in [signal.SIGINT, signal.SIGKILL]:
324	            self._forward_signal(sig)
325	            # if one is still alive after sigterm and sigint, try sigkill after 1s

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/local/local.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
355	            if step == almost_timeout:
356	                self._forward_signal(LocalJobEnvironment._usr_sig())
357	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/local/test_local.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
147	    assert job.state == "RUNNING"
148	    job._process.send_signal(signal.SIGKILL)  # type: ignore
149	    time.sleep(1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/submitit-1.5.2/submitit-1.5.2/submitit/slurm/test_slurm.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
28	        with Path(filepath).open("w") as f:
29	            f.write(msg)
30	

--------------------------------------------------

Code scanned:
	Total lines of code: 4484
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 8.0
Files skipped (0):
