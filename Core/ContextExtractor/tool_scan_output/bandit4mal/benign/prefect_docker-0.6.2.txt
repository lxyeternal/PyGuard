Run started:2025-04-12 13:39:33.797349

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/containers.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	        logger.info(f"Creating container with {image!r} image.")
62	        container = await run_sync_in_worker_thread(
63	            client.containers.create,
64	            image=image,
65	            command=command,
66	            name=name,
67	            detach=detach,
68	            entrypoint=entrypoint,
69	            environment=environment,
70	            **create_kwargs,
71	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/containers.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
110	    with (docker_host or DockerHost()).get_client() as client:
111	        container = await run_sync_in_worker_thread(client.containers.get, container_id)
112	        logger.info(f"Retrieving logs from {container.id!r} container.")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/containers.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
112	        logger.info(f"Retrieving logs from {container.id!r} container.")
113	        logs = await run_sync_in_worker_thread(container.logs, **logs_kwargs)
114	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/containers.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
152	    with (docker_host or DockerHost()).get_client() as client:
153	        container = await run_sync_in_worker_thread(client.containers.get, container_id)
154	        logger.info(f"Starting container {container.id!r}.")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/containers.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
154	        logger.info(f"Starting container {container.id!r}.")
155	        await run_sync_in_worker_thread(container.start, **start_kwargs)
156	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/containers.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	    with (docker_host or DockerHost()).get_client() as client:
195	        container = await run_sync_in_worker_thread(client.containers.get, container_id)
196	        logger.info(f"Stopping container {container.id!r}.")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/containers.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
196	        logger.info(f"Stopping container {container.id!r}.")
197	        await run_sync_in_worker_thread(container.stop, **stop_kwargs)
198	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/containers.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
236	    with (docker_host or DockerHost()).get_client() as client:
237	        container = await run_sync_in_worker_thread(client.containers.get, container_id)
238	        logger.info(f"Removing container {container.id!r}.")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/containers.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
238	        logger.info(f"Removing container {container.id!r}.")
239	        await run_sync_in_worker_thread(container.remove, **remove_kwargs)
240	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/credentials.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    _block_type_name = "Docker Registry Credentials"
32	    _logo_url = "https://cdn.sanity.io/images/3ugk85nk/production/14a315b79990200db7341e42553e23650b34bb96-250x250.png"  # noqa
33	    _description = "Store credentials for interacting with a Docker Registry."

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/deployments/steps.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
224	                    if "stream" in event:
225	                        sys.stdout.write(event["stream"])
226	                        sys.stdout.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/deployments/steps.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
343	            if "status" in event:
344	                sys.stdout.write(event["status"])
345	                if "progress" in event:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/deployments/steps.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
345	                if "progress" in event:
346	                    sys.stdout.write(" " + event["progress"])
347	                sys.stdout.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/deployments/steps.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
346	                    sys.stdout.write(" " + event["progress"])
347	                sys.stdout.write("\n")
348	                sys.stdout.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/host.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    _block_type_name = "Docker Host"
60	    _logo_url = "https://cdn.sanity.io/images/3ugk85nk/production/14a315b79990200db7341e42553e23650b34bb96-250x250.png"  # noqa
61	    _description = "Store settings for interacting with a Docker host."

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/images.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
83	
84	        image = await run_sync_in_worker_thread(client.images.pull, **pull_kwargs)
85	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/worker.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
197	        description=(
198	            "Configuration for containers created by workers. See the [`docker-py` documentation](https://docker-py.readthedocs.io/en/stable/containers.html) for accepted values."
199	        ),
200	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/worker.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
259	                .replace("localhost", "host.docker.internal")
260	                .replace("127.0.0.1", "host.docker.internal")
261	            )
262	        return base_env
263	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/worker.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
317	            # If using a locally hosted API, use a host network on linux
318	            if sys.platform == "linux" and (host == "127.0.0.1" or host == "localhost"):
319	                return "host"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/worker.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
398	    _display_name = "Docker"
399	    _documentation_url = "https://prefecthq.github.io/prefect-docker/worker/"
400	    _logo_url = "https://images.ctfassets.net/gm98wzqotmnx/2IfXXfMq66mrzJBDFFCHTp/6d8f320d9e4fc4393f045673d61ab612/Moby-logo.png?h=250"  # noqa

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/worker.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
399	    _documentation_url = "https://prefecthq.github.io/prefect-docker/worker/"
400	    _logo_url = "https://images.ctfassets.net/gm98wzqotmnx/2IfXXfMq66mrzJBDFFCHTp/6d8f320d9e4fc4393f045673d61ab612/Moby-logo.png?h=250"  # noqa
401	
402	    def __init__(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/worker.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
435	        # be run in a thread to avoid blocking the event loop.
436	        container, created_event = await run_sync_in_worker_thread(
437	            self._create_and_start_container, configuration
438	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/prefect_docker/worker.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
445	        # Monitor the container
446	        container = await run_sync_in_worker_thread(
447	            self._watch_container_safe, container, configuration, created_event
448	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/deployments/test_steps.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    "password": "pass",
32	    "registry_url": "https://registry.com",
33	    "reauth": True,
34	}
35	
36	
37	@pytest.fixture(autouse=True)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
442	
443	@pytest.mark.parametrize("localhost", ["localhost", "127.0.0.1"])
444	async def test_network_mode_defaults_to_host_if_using_localhost_api_on_linux(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
471	    default_docker_worker_job_configuration.env = dict(
472	        PREFECT_API_URL="http://localhost/test"
473	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
488	    default_docker_worker_job_configuration.env = dict(
489	        PREFECT_API_URL="http://foo/test"
490	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
506	    default_docker_worker_job_configuration.env = dict(
507	        PREFECT_API_URL="http://localhost/test"
508	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
531	    default_docker_worker_job_configuration.env = dict(
532	        PREFECT_API_URL="http://localhost/test"
533	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
616	    default_docker_worker_job_configuration.env = dict(
617	        PREFECT_API_URL="http://localhost/api"
618	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
625	    call_env = mock_docker_client.containers.create.call_args[1].get("environment")
626	    assert call_env.get("PREFECT_API_URL") == "http://localhost/api"
627	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
798	        None,
799	        "http://localhost/api",
800	        "http://127.0.0.1:2222/api",
801	        "http://host.docker.internal:10/foo/api",
802	    ],
803	)
804	@pytest.mark.usefixtures("use_hosted_api_server")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
799	        "http://localhost/api",
800	        "http://127.0.0.1:2222/api",
801	        "http://host.docker.internal:10/foo/api",
802	    ],
803	)
804	@pytest.mark.usefixtures("use_hosted_api_server")
805	async def test_warns_if_docker_version_does_not_support_host_gateway_on_linux(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
800	        "http://127.0.0.1:2222/api",
801	        "http://host.docker.internal:10/foo/api",
802	    ],
803	)
804	@pytest.mark.usefixtures("use_hosted_api_server")
805	async def test_warns_if_docker_version_does_not_support_host_gateway_on_linux(
806	    mock_docker_client,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/prefect_docker-0.6.2/prefect_docker-0.6.2/tests/test_worker.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
849	    default_docker_worker_job_configuration.env = {
850	        "PREFECT_API_URL": "http://my-domain.test/api"
851	    }
852	    default_docker_worker_job_configuration.prepare_for_flow_run(flow_run=flow_run)

--------------------------------------------------

Code scanned:
	Total lines of code: 3168
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 16.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 0.0
Files skipped (0):
