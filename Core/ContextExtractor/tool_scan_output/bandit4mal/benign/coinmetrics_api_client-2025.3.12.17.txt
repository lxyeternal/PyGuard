Run started:2025-04-12 10:32:55.740873

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	        api_response = self._data_retrieval_function(self._endpoint, url_params)
120	        self._next_page_token = cast(Optional[str], api_response.get("next_page_token"))
121	        self._current_data_iterator = iter(api_response["data"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
182	                ",".join(
183	                    f'"{first_data_el.get(column)}"' or ""
184	                    for column in columns_to_store

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	                ",".join(
191	                    f'"{data_el.get(column)}"' or "" for column in columns_to_store
192	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
237	            for line in data_generator:
238	                output_file.write(line)
239	        finally:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
309	                            df = df.convert_dtypes()
310	                        if df.dtypes.get("coin_metrics_id") == np.dtype("object"):
311	                            df["coin_metrics_id"] = df["coin_metrics_id"].astype(np.float128)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
591	        for param in self._parallelize_on:
592	            if isinstance(self._url_params.get(param), str) and "," in self._url_params.get(param):  # type: ignore
593	                query_items_dict[param] = self._url_params[param].split(",")  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
591	        for param in self._parallelize_on:
592	            if isinstance(self._url_params.get(param), str) and "," in self._url_params.get(param):  # type: ignore
593	                query_items_dict[param] = self._url_params[param].split(",")  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
672	        if self._height_increment and isinstance(self._height_increment, int):
673	            if self._url_params.get("start_height") and isinstance(self._url_params.get("start_height"), (int, str)):
674	                start_height = int(self._url_params.get("start_height"))  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
672	        if self._height_increment and isinstance(self._height_increment, int):
673	            if self._url_params.get("start_height") and isinstance(self._url_params.get("start_height"), (int, str)):
674	                start_height = int(self._url_params.get("start_height"))  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
673	            if self._url_params.get("start_height") and isinstance(self._url_params.get("start_height"), (int, str)):
674	                start_height = int(self._url_params.get("start_height"))  # type: ignore
675	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
676	                start_height = 0
677	            if self._url_params.get("end_height") and isinstance(self._url_params.get("end_height"), (int, str)):
678	                end_height = int(self._url_params.get("end_height"))  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
676	                start_height = 0
677	            if self._url_params.get("end_height") and isinstance(self._url_params.get("end_height"), (int, str)):
678	                end_height = int(self._url_params.get("end_height"))  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:678
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
677	            if self._url_params.get("end_height") and isinstance(self._url_params.get("end_height"), (int, str)):
678	                end_height = int(self._url_params.get("end_height"))  # type: ignore
679	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
679	            else:
680	                if self._url_params.get("asset"):
681	                    asset = str(self._url_params.get("asset"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
680	                if self._url_params.get("asset"):
681	                    asset = str(self._url_params.get("asset"))
682	                else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
706	        elif self._time_increment and isinstance(self._time_increment, (timedelta, relativedelta, DateOffset)):
707	            if not self._url_params.get("start_time"):
708	                raise ValueError("No start_time specified, cannot use time_increment feature")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
710	                start_time = self.parse_date(
711	                    cast(datetime, self._url_params.get("start_time"))
712	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
714	                    cast(datetime, self._url_params.get("end_time"))
715	                ) if self._url_params.get(
716	                    "end_time") else datetime.utcnow().replace(microsecond=0)
717	                for start, end in generate_ranges(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
713	                end_time = self.parse_date(
714	                    cast(datetime, self._url_params.get("end_time"))
715	                ) if self._url_params.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
966	                f"Invalid parallelization param: {param}, parallelization param must be in {self._url_params.keys()}")
967	        if self._url_params.get(param) is None:
968	            raise ValueError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
969	                f"Invalid parallelization param: {param}, parallelization param is None, must be a non default value")
970	        if not isinstance(self._url_params.get(param), list) and len(self._url_params.get(param).split(",")) < 2:  # type: ignore
971	            raise ValueError(f"Invalid parallelization param: {param} - values must be a list, instead: {self._url_params.get(param)}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
969	                f"Invalid parallelization param: {param}, parallelization param is None, must be a non default value")
970	        if not isinstance(self._url_params.get(param), list) and len(self._url_params.get(param).split(",")) < 2:  # type: ignore
971	            raise ValueError(f"Invalid parallelization param: {param} - values must be a list, instead: {self._url_params.get(param)}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:971
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
970	        if not isinstance(self._url_params.get(param), list) and len(self._url_params.get(param).split(",")) < 2:  # type: ignore
971	            raise ValueError(f"Invalid parallelization param: {param} - values must be a list, instead: {self._url_params.get(param)}")
972	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
979	        for param in self._parallelize_on:
980	            values = data_collection._url_params.get(param)
981	            if values:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
988	        friendly_endpoint_name = data_collection._endpoint.split("/")[-1]
989	        if self._time_increment and data_collection._url_params.get("start_time"):
990	            start_time = cast(datetime, data_collection._url_params.get("start_time")).strftime("%Y-%m-%dT%H-%M-%SZ")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:990
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
989	        if self._time_increment and data_collection._url_params.get("start_time"):
990	            start_time = cast(datetime, data_collection._url_params.get("start_time")).strftime("%Y-%m-%dT%H-%M-%SZ")
991	            file_name = f"{friendly_endpoint_name}/{arg_value}/start_time={start_time}.{file_type}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
991	            file_name = f"{friendly_endpoint_name}/{arg_value}/start_time={start_time}.{file_type}"
992	        elif self._height_increment and data_collection._url_params.get("start_height"):
993	            start_height = cast(int, data_collection._url_params.get("start_height"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_data_collection.py:993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
992	        elif self._height_increment and data_collection._url_params.get("start_height"):
993	            start_height = cast(int, data_collection._url_params.get("start_height"))
994	            file_name = f"{friendly_endpoint_name}/{arg_value}/start_height={start_height}.{file_type}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/_utils.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	        if endpoint == 'catalog':
148	            message += "Use 'catalog-v2' and 'reference-data' instead. For more information, see: https://docs.coinmetrics.io/tutorials-and-examples/user-guides/how-to-migrate-from-catalog-v1-to-catalog-v2 "
149	            message += "\nNote: markets are truncated to 170,000 entries. Data may be out of date."

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
99	        for signal_type in signal_types:
100	            previous_handler = signal.getsignal(signal_type)
101	            if callable(previous_handler):

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
104	                    previous_handler(signum, frame)
105	                signal.signal(signal_type, handler)
106	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:105
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
104	                    previous_handler(signum, frame)
105	                signal.signal(signal_type, handler)
106	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	            api_path_prefix = "community-"
136	        self._api_base_url = "https://{}api.coinmetrics.io/v4".format(api_path_prefix)
137	        self._ws_api_base_url = "wss://{}api.coinmetrics.io/v4".format(api_path_prefix)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:8007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
8006	            start_time = datetime.now()
8007	            resp = self._send_request(actual_url)
8008	            logger.info(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:8017
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
8016	            start_time = datetime.now()
8017	            resp = self._send_request(actual_url)
8018	            logger.debug(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:8023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
8022	        else:
8023	            resp = self._send_request(actual_url)
8024	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:8025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
8024	        try:
8025	            if params.get("format") == "json_stream":
8026	                data = {"data": [json.loads(i) for i in resp.iter_lines()]}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:8059
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
8058	    def _send_request(self, actual_url: str) -> Response:
8059	        response = self._session.get(
8060	            actual_url,
8061	            headers=self._session.headers,
8062	            proxies=self._session.proxies,
8063	            verify=self._session.verify,
8064	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:8065
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
8064	        )
8065	        if response.status_code == 429 or response.headers.get("x-ratelimit-remaining", None) == "0":
8066	            logger.info("Sleeping for a rate limit window because 429 (too many requests) error was returned. Please"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:8066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8065	        if response.status_code == 429 or response.headers.get("x-ratelimit-remaining", None) == "0":
8066	            logger.info("Sleeping for a rate limit window because 429 (too many requests) error was returned. Please"
8067	                        "see Coin Metrics APIV4 documentation for more information: https://docs.coinmetrics.io/api/v4/#tag/Rate-limits")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/api_client.py:8069
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
8068	            time.sleep(int(response.headers["x-ratelimit-reset"]))
8069	            response = self._send_request(actual_url=actual_url)
8070	        return response

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	
33	    _API_BASE_URL = "https://files.coinmetrics.io/api/"
34	    _SUPPORTED_FREQUENCIES = ["1m", "5m", "10m", "15m", "30m", "1h", "1d"]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
232	        """
233	        request_data = self._send_request(self._API_BASE_URL + file_type).json()
234	        result = [directory["name"] for directory in request_data]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
237	    def get_asset_pairs(self, file_type: str, exchange: str) -> List[str]:
238	        request_data = self._send_request(
239	            f"{self._API_BASE_URL}/{file_type}/{exchange}"
240	        ).json()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
254	        if threaded:
255	            with ThreadPoolExecutor() as executor:
256	                for file in list_of_files:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
279	        if output_format == "json.gz":
280	            with self._send_request(self._API_BASE_URL + url, stream=True) as response:
281	                with open(url, "wb") as file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
282	                    for chunk in response.iter_content(chunk_size=1024):
283	                        file.write(chunk)
284	                    logger.info(f"Downloaded file {url}")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
318	        market_quotes_spot = self._API_BASE_URL + route_url
319	        market_quotes_exchange_folders = self._send_request(market_quotes_spot).json()
320	        list_of_files_to_download = []

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
333	            exchange_files_url = market_quotes_spot + f"/{exchange}"
334	            exchange_asset_pair_data = self._send_request(exchange_files_url).json()
335	            exchange_asset_pair_folders = {

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
349	            for asset_pair, asset_pair_url in asset_pair_url_dict.items():
350	                date_files_exchange_asset_pair = self._send_request(
351	                    asset_pair_url
352	                ).json()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
373	        market_trades_url = self._API_BASE_URL + route_url
374	        market_trades_exchanges = self._send_request(market_trades_url).json()
375	        list_of_files_to_download = []

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
387	            exchange_files_url = market_trades_url + f"/{exchange}"
388	            files = self._send_request(exchange_files_url).json()
389	            filtered_exchange_files = self.filter_date_files(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
403	        """
404	        with self._send_request(request_url, stream=True) as resp:
405	            decoded = stream_gzip_decompress(resp.iter_content(chunk_size=1024))

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:405
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
404	        with self._send_request(request_url, stream=True) as resp:
405	            decoded = stream_gzip_decompress(resp.iter_content(chunk_size=1024))
406	            with open(file_name, "w") as file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
406	            with open(file_name, "w") as file:
407	                file.write("[")
408	                for line in decoded:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
409	                    full_line = line.decode("UTF-8").replace("}", "},")
410	                    file.write(full_line)
411	                # This is done in order to remove trailing ',' and add a ']' to conform with JSON spec

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
412	                file.seek(file.tell() - 1, os.SEEK_SET)
413	                file.write("")
414	                file.seek(file.tell() - 1, os.SEEK_SET)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
414	                file.seek(file.tell() - 1, os.SEEK_SET)
415	                file.write("")
416	                file.write("]")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
415	                file.write("")
416	                file.write("]")
417	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
425	        """
426	        with self._send_request(request_url, stream=True) as resp:
427	            decoded_dicts = stream_gzip_decompress_to_dicts(resp.iter_content(1024))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:471
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
470	    def _send_request(self, actual_url: str, stream: bool = False) -> Response:
471	        response = self._session.get(
472	            actual_url, verify=self._verify_ssl_certs, auth=self._auth, stream=stream, proxies=self.proxies  # type: ignore
473	        )

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
486	    for chunk in stream:
487	        rv = dec.decompress(chunk)
488	        if rv:

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/coinmetrics/data_exporter.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
498	    for chunk in stream:
499	        rv = dec.decompress(chunk)
500	        if rv:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/test/test_api_client.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
591	    mocked_obj.assert_called_once_with(
592	        "https://api.coinmetrics.io/v4/catalog/assets?api_key=xxx&assets=btc",
593	        verify=True,
594	        headers=client._session.headers,
595	        proxies={"http": None, "https": None},
596	    )
597	    assert response == [{"asset": "btc", "markets": ["coinbase-btc-usd-spot"]}]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/test/test_api_client.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
600	def test_base_url() -> None:
601	    assert CoinMetricsClient("xxx")._api_base_url == "https://api.coinmetrics.io/v4"
602	    assert CoinMetricsClient("xxx")._api_key_url_str == "api_key=xxx"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/test/test_api_client.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
603	    assert (
604	        CoinMetricsClient()._api_base_url == "https://community-api.coinmetrics.io/v4"
605	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/test/test_custom_exceptions.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
11	
12	client = CoinMetricsClient(str(os.environ.get("CM_API_KEY")))
13	cm_api_key_set = os.environ.get("CM_API_KEY") is not None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/test/test_custom_exceptions.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
12	client = CoinMetricsClient(str(os.environ.get("CM_API_KEY")))
13	cm_api_key_set = os.environ.get("CM_API_KEY") is not None
14	REASON_TO_SKIP = "Need to set CM_API_KEY as an env var in order to run this test"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/test/test_rate_limits.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	
27	    test_thread = threading.Thread(target=target)
28	    test_thread.daemon = True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coinmetrics_api_client-2025.3.12.17/coinmetrics_api_client-2025.3.12.17/test/test_websocket_methods.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
198	    if sequence_id >= 1:
199	        stream.close()
200	

--------------------------------------------------

Code scanned:
	Total lines of code: 13549
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 62.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 69.0
		High: 1.0
Files skipped (0):
