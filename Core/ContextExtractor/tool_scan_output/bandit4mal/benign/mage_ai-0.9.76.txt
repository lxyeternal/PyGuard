Run started:2025-04-12 13:01:34.373735

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	            raise Exception(f'Error not valid BlockType: \
69	                  {function_args.get(f"Question {BlockType.__name__}")}')
70	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	            block_language = BlockLanguage(
72	                                    function_args.get(
73	                                        f'Question {BlockLanguage.__name__}',
74	                                        'python'))
75	        except ValueError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	            print(f'Error not valid BlockLanguage: \
77	                  {function_args.get(f"Question {BlockLanguage.__name__}")}')
78	            block_language = BlockLanguage.PYTHON

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	            pipeline_type = PipelineType(
81	                                    function_args.get(
82	                                        f'Question {PipelineType.__name__}',
83	                                        'python'))
84	        except ValueError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	            print(f'Error not valid PipelineType: \
86	                  {function_args.get(f"Question {PipelineType.__name__}")}')
87	            pipeline_type = PipelineType.PYTHON

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	                config['action_type'] = ActionType(
92	                                            function_args.get(
93	                                                f'Question {ActionType.__name__}'))
94	            except ValueError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	                print(f'Error not valid ActionType: \
96	                    {function_args.get(f"Question {ActionType.__name__}")}')
97	                config['action_type'] = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	                config['data_source'] = DataSource(
111	                                            function_args.get(
112	                                                f'Question {DataSource.__name__}'))
113	            except ValueError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	                print(f'Error not valid DataSource: \
115	                    {function_args.get(f"Question {DataSource.__name__}")}')
116	        output = {}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/hugging_face_client.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
137	            {'Authorization': f'Bearer {self.api_token}'})
138	        response = requests.post(self.api, headers=headers, data=data)
139	        response_json = response.json()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/utils/xgboost.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	    with open(config_path, 'w') as f:
90	        f.write(booster.save_config())
91	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/utils/xgboost.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
151	        image.save(buffered, format='PNG')
152	        img_str = base64.b64encode(buffered.getvalue()).decode()
153	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/utils/xgboost.py:152
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
151	        image.save(buffered, format='PNG')
152	        img_str = base64.b64encode(buffered.getvalue()).decode()
153	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/utils/xgboost.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
196	        with open(image_path, 'rb') as image_file:
197	            encoded_string = base64.b64encode(image_file.read()).decode('utf-8')
198	        return encoded_string, True

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/utils/xgboost.py:197
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
196	        with open(image_path, 'rb') as image_file:
197	            encoded_string = base64.b64encode(image_file.read()).decode('utf-8')
198	        return encoded_string, True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/ai/utils/xgboost.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
196	        with open(image_path, 'rb') as image_file:
197	            encoded_string = base64.b64encode(image_file.read()).decode('utf-8')
198	        return encoded_string, True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/middleware.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	    def initialize(self, **kwargs) -> None:
22	        self.bypass_oauth_check = kwargs.get('bypass_oauth_check', False)
23	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/middleware.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
35	
36	        api_key = self.request.headers.get(HEADER_API_KEY, None)
37	        if not api_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/middleware.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	                try:
40	                    api_key = json.loads(
41	                        self.request.body).get(URL_PARAMETER_API_KEY)
42	                except (JSONDecodeError, UnicodeDecodeError):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/middleware.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	                    # file upload when creating a new feature set
45	                    api_key = self.request.query_arguments.get(
46	                        URL_PARAMETER_API_KEY)
47	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/middleware.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	            else:
48	                api_key = self.request.query_arguments.get(
49	                    URL_PARAMETER_API_KEY)
50	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/middleware.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	
57	        token_from_header = self.request.headers.get(HEADER_OAUTH_TOKEN, None)
58	        if not token_from_header:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/middleware.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	        if not token_from_header:
59	            token_from_header = self.request.headers.get('Authorization')
60	            if token_from_header:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/middleware.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	            else:
63	                token_from_header = self.request.query_arguments.get('HTTP_AUTHORIZATION', None)
64	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/middleware.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	
65	        cookies = parse_cookie_header(self.request.headers.get('Cookie', ''))
66	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/operations/base.py:855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
854	                cookies = SimpleCookie()
855	                cookies.load(cookie_header)
856	            # Handle each cookie:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/resources/DataProviderResource.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
49	            async with aiofiles.open(file_path, mode='r') as file:
50	                content = await file.read()
51	                profiles = list(yaml.safe_load(template_render(content)).keys()) if content else []

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/resources/FolderResource.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
36	        self.check_folder_is_in_project(self.path)
37	        return shutil.rmtree(self.path)
38	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/resources/OauthResource.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
232	                            [
233	                                f'https://api.mage.ai/v1/oauth/{pk}',
234	                                f'redirect_uri={urllib.parse.unquote(redirect_uri)}',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/resources/OauthResource.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	                    'url'
247	                ] = f"https://github.com/login/oauth/authorize?{'&'.join(query_strings)}"
248	            elif provider_instance is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/resources/ProjectResource.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	            async with session.get(
37	                'https://pypi.org/pypi/mage-ai/json',
38	                timeout=3,
39	            ) as response:
40	                response_json = await response.json()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/api/resources/ProjectResource.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
162	                })
163	                f.write(content)
164	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/oauth/constants.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	
27	DEFAULT_GITHUB_HOSTNAME = 'https://github.com'
28	
29	# Github and GHE don't need to be added to this list because they are handled
30	# separately for now.
31	GIT_OAUTH_PROVIDERS = [

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/operation_history/models.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
144	
145	            text = self.storage.read(file_path)
146	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/operation_history/models.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	        self.storage.makedirs(os.path.dirname(file_path), exist_ok=True)
169	        with self.storage.open_to_write(file_path, append=True) as f:
170	            f.write(f'{text}\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/operation_history/models.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
169	        with self.storage.open_to_write(file_path, append=True) as f:
170	            f.write(f'{text}\n')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	            AZURE_HOST,
39	            default='https://login.microsoftonline.com',
40	        ).rstrip('/')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	            MICROSOFT_GRAPH_API_HOST,
43	            default='https://graph.microsoft.com',
44	        ).rstrip('/')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	                client_id=ACTIVE_DIRECTORY_MAGE_CLIENT_ID,
105	                redirect_uri=f'https://api.mage.ai/v1/oauth/{self.provider}',
106	                response_type='code',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	    async def get_access_token_response(self, code: str, **kwargs) -> Awaitable[Dict]:
126	        base_url = get_base_url(kwargs.get('redirect_uri'))
127	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
128	        async with aiohttp.ClientSession() as session:
129	            async with session.post(
130	                f'{self.host}/organizations/oauth2/v2.0/token',
131	                headers={
132	                    'Accept': 'application/json',
133	                },
134	                data=dict(
135	                    client_id=self.client_id,
136	                    client_secret=self.client_secret,
137	                    code=code,
138	                    grant_type='authorization_code',
139	                    redirect_uri=f'{base_url}/oauth',
140	                    tenant=self.directory_id,
141	                ),
142	                timeout=20,
143	            ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
155	        async with aiohttp.ClientSession() as session:
156	            async with session.get(
157	                f'{self.graph_api_host}/v1.0/me',
158	                headers={
159	                    'Content-Type': 'application\\json',
160	                    'Authorization': f'Bearer {access_token}',
161	                },
162	                timeout=10,
163	            ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	                try:
168	                    async with session.get(
169	                        f'{self.graph_api_host}/v1.0/servicePrincipals?$filter=appId eq \'{self.client_id}\'&$select=id',  # noqa: E501
170	                        headers={
171	                            'Content-Type': 'application\\json',
172	                            'Authorization': f'Bearer {access_token}',
173	                        },
174	                        timeout=10,
175	                    ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	
178	                    resource_id = service_principals.get('value')[0].get('id')
179	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	
178	                    resource_id = service_principals.get('value')[0].get('id')
179	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	
180	                    async with session.get(
181	                        f'{self.graph_api_host}/v1.0/servicePrincipals/{resource_id}/appRoles',  # noqa: E501
182	                        headers={
183	                            'Content-Type': 'application\\json',
184	                            'Authorization': f'Bearer {access_token}',
185	                        },
186	                        timeout=10,
187	                    ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	                    app_role_mapping = {
191	                        app_role.get('id'): app_role.get('value')
192	                        for app_role in app_roles.get('value')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
190	                    app_role_mapping = {
191	                        app_role.get('id'): app_role.get('value')
192	                        for app_role in app_roles.get('value')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	                        app_role.get('id'): app_role.get('value')
192	                        for app_role in app_roles.get('value')
193	                    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
194	
195	                    async with session.get(
196	                        f'{self.graph_api_host}/v1.0/me/appRoleAssignments?$filter=resourceId eq {resource_id}',  # noqa: E501
197	                        headers={
198	                            'Content-Type': 'application\\json',
199	                            'Authorization': f'Bearer {access_token}',
200	                        },
201	                        timeout=10,
202	                    ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	
205	                    for assignment in app_role_assignments.get('value'):
206	                        app_role_id = assignment.get('appRoleId')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	                    for assignment in app_role_assignments.get('value'):
206	                        app_role_id = assignment.get('appRoleId')
207	                        app_role = app_role_mapping.get(app_role_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	                        app_role_id = assignment.get('appRoleId')
207	                        app_role = app_role_mapping.get(app_role_id)
208	                        if app_role and app_role in self.roles_mapping:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	        return dict(
216	            email=userinfo_resp.get('userPrincipalName'),
217	            username=userinfo_resp.get('userPrincipalName'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/active_directory.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	            email=userinfo_resp.get('userPrincipalName'),
217	            username=userinfo_resp.get('userPrincipalName'),
218	            user_roles=mage_roles,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/bitbucket.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    def __init__(self):
23	        self.hostname = get_settings_value(BITBUCKET_HOST) or 'https://bitbucket.org'
24	        self.key = get_settings_value(BITBUCKET_OAUTH_KEY)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/gitlab.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    def __init__(self):
18	        self.hostname = get_settings_value(GITLAB_HOST) or 'https://gitlab.com'
19	        if not self.hostname.startswith('http'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/google.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	            response_type='code',
43	            scope='https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile',  # noqa: E501
44	            state=uuid.uuid4().hex,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/google.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	        return dict(
51	            url=f"https://accounts.google.com/o/oauth2/v2/auth?{'&'.join(query_strings)}",
52	            redirect_query_params=redirect_uri_query,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/google.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	            async with session.post(
61	                'https://oauth2.googleapis.com/token',
62	                data=dict(
63	                    code=code,
64	                    client_id=self.client_id,
65	                    client_secret=self.client_secret,
66	                    redirect_uri=f'{base_url}/oauth',
67	                    grant_type='authorization_code',
68	                ),
69	                timeout=20,
70	            ) as response:
71	                data = await response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/google.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	            async with session.get(
80	                'https://www.googleapis.com/oauth2/v3/userinfo',
81	                params=dict(access_token=access_token),
82	                timeout=10,
83	            ) as response:
84	                userinfo_resp = await response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	        try:
57	            response = requests.get(
58	                self.discovery_url,
59	                headers={
60	                    'Accept': 'application/json',
61	                },
62	                timeout=10,
63	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	
72	        self.authorization_endpoint = data.get('authorization_endpoint')
73	        self.token_endpoint = data.get('token_endpoint')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	        self.authorization_endpoint = data.get('authorization_endpoint')
73	        self.token_endpoint = data.get('token_endpoint')
74	        self.userinfo_endpoint = data.get('userinfo_endpoint')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	        self.token_endpoint = data.get('token_endpoint')
74	        self.userinfo_endpoint = data.get('userinfo_endpoint')
75	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	    async def get_access_token_response(self, code: str, **kwargs) -> Awaitable[Dict]:
101	        base_url = get_base_url(kwargs.get('redirect_uri'))
102	        data = dict()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
114	        async with aiohttp.ClientSession() as session:
115	            async with session.post(
116	                self.token_endpoint,
117	                headers={
118	                    'Accept': 'application/json',
119	                },
120	                data=payload,
121	                timeout=20,
122	            ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	        async with aiohttp.ClientSession() as session:
132	            async with session.get(
133	                self.userinfo_endpoint,
134	                headers={
135	                    'Authorization': f'Bearer {access_token}',
136	                },
137	                timeout=10,
138	            ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	
142	        email = userinfo_resp.get('email')
143	        if hasattr(self, 'roles_mapping'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	        if hasattr(self, 'roles_mapping'):
144	            for group in userinfo_resp.get('user_roles', []):
145	                if group in self.roles_mapping:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	        else:
148	            mage_roles.extend(userinfo_resp.get('user_roles', []))
149	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/authentication/providers/oidc.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
151	            email=email,
152	            username=userinfo_resp.get('preferred_username', email),
153	            user_roles=mage_roles,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/autocomplete/utils.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	    async with aiofiles.open(file_path, mode='r') as f:
87	        file_content = await f.read()
88	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/autocomplete/utils.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	
83	@async_cache_file_read(autocomplete_file_cache)
84	async def extract_classes_from_file(file_path: str, cwd: str = None, mode: str = 'r'):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/block_action_object/__init__.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
203	                with open(block_file_absolute_path, 'r') as f:
204	                    content = f.read()
205	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/block_action_object/__init__.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
325	                    with open(block_file_absolute_path, 'r', encoding='utf-8') as f:
326	                        content = f.read()
327	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/dbt/utils.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	        async with aiofiles.open(file_path, mode='r') as f:
66	            content = await f.read()
67	            try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/dbt/utils.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	        with open(file_path, mode='r') as f:
117	            content = f.read()
118	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/file.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	    def set(self, key: str, value: Any) -> None:
128	        with self.storage.open_to_write(self.build_path(key)) as f:
129	            f.write(value)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/file.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
128	        with self.storage.open_to_write(self.build_path(key)) as f:
129	            f.write(value)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/mem_lru.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
118	    with open(file_path, mode, **kwargs) as file:
119	        return load_yaml(file.read()) or {}
120	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/mem_lru.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
115	
116	@cache_file_read(file_cache)
117	def read_yaml_file(file_path, mode: str = 'r', **kwargs):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/mem_lru.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
124	    async with aiofiles.open(file_path, mode, **kwargs) as file:
125	        return load_yaml(await file.read()) or {}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cache/mem_lru.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
121	
122	@async_cache_file_read(file_cache)
123	async def read_yaml_file_async(file_path, mode: str = 'r', **kwargs):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cluster_manager/aws/emr_cluster_manager.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
83	        with open(sparkmagic_config_path) as f:
84	            fcontent = f.read()
85	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cluster_manager/aws/emr_cluster_manager.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	        with open(sparkmagic_config_path, 'w') as f:
93	            f.write(json.dumps(config))
94	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cluster_manager/gcp/cloud_run_service_manager.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        scopes = [
24	            'https://www.googleapis.com/auth/cloud-platform',
25	            'https://www.googleapis.com/auth/compute',
26	        ]
27	        credentials = service_account.Credentials.from_service_account_file(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cluster_manager/gcp/cloud_run_service_manager.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	            'https://www.googleapis.com/auth/cloud-platform',
25	            'https://www.googleapis.com/auth/compute',
26	        ]
27	        credentials = service_account.Credentials.from_service_account_file(
28	            path_to_credentials_json_file,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cluster_manager/kubernetes/workload_manager.py:655
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
654	                '-c',
655	                '[[ -z "${MAGE_ROUTES_BASE_PATH:-${MAGE_BASE_PATH}}" ]] '
656	                '&& BasePath="" '
657	                '|| BasePath="/${MAGE_ROUTES_BASE_PATH:-${MAGE_BASE_PATH}}";'
658	                'curl -s --request GET --url '
659	                'http://localhost:6789${BasePath}/api/statuses?_format=with_activity_details '

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cluster_manager/kubernetes/workload_manager.py:706
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
705	            with open(pre_start_script_path, 'r', encoding='utf-8') as f:
706	                pre_start_script = f.read()
707	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cluster_manager/kubernetes/workload_manager.py:714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
713	            with open(post_start_config.hook_path, 'r', encoding='utf-8') as f:
714	                post_start_script = f.read()
715	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/cluster_manager/kubernetes/workload_manager.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
737	        with open(pre_start_script_path, 'r', encoding='utf-8') as f:
738	            pre_start_script = f.read()
739	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/command_center/settings.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	
20	            content = Template(f.read()).render(**get_template_vars_no_db())
21	            settings = yaml.full_load(content) or {}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/command_center/settings.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
29	    content = yaml.dump(settings)
30	    safe_write(full_path, content)
31	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/command_center/support/constants.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	                page=dict(
17	                    path='https://docs.mage.ai',
18	                    external=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/command_center/support/constants.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	                page=dict(
38	                    path='https://mage.ai/chat',
39	                    external=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/command_center/version_control/projects/utils.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	            type=InteractionInputType.TEXT_FIELD,
82	            placeholder='e.g. https://github.com/mage-ai/mage-ai.git',
83	            value=sync_config.get('remote_repo_link'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/command_center/version_control/remotes/utils.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
147	                ),
148	                placeholder='e.g. https://github.com/mage-ai/mage-ai.git',
149	                name='request.payload.version_control_remote.url',

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data/tabular/reader.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
48	async def run_in_executor(func, *args):
49	    executor = ThreadPoolExecutor()
50	    loop = asyncio.get_running_loop()

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_cleaner/transformer_actions/custom_action.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
44	    action_code = action_code.replace('\t', ' ' * 4)
45	    exec(action_code, {'df': df, 'transformer_action': transformer_action})
46	    while len(custom_actions) != 0:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_integrations/utils/scheduler.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
62	            )
63	            shutil.rmtree(source_output_folder)
64	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_integrations/utils/scheduler.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
239	        with open(source_state_file_path, 'r') as f:
240	            text = f.read()
241	            d = json.loads(text) if text else {}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_integrations/utils/scheduler.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
248	        with open(destination_state_file_path, 'r') as f:
249	            text = f.read()
250	            d = json.loads(text) if text else {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	        ):
164	            block_run = BlockRun.query.get(block_run_id) if block_run_id else None
165	            self.block_run = block_run

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	            self.block_run = block_run
166	            if block_run and block_run.metrics and block_run.metrics.get('hook'):
167	                from mage_ai.data_preparation.models.block.hook.block import HookBlock

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	
170	                hook = Hook.load(**(block_run.metrics.get('hook') or {}))
171	                self.block = HookBlock(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	                )
177	                if block_run.metrics.get('hook_variables'):
178	                    global_vars = merge_dict(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	                        global_vars,
180	                        block_run.metrics.get('hook_variables') or {},
181	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
199	            if not block_run:
200	                block_run = BlockRun.query.get(block_run_id) if block_run_id else None
201	                self.block_run = block_run

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	                self.block_run = block_run
202	            pipeline_run = PipelineRun.query.get(pipeline_run_id) if pipeline_run_id else None
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
242	                if ScheduleInterval.ONCE == schedule_interval:
243	                    end_date = variables.get('_end_date')
244	                    start_date = variables.get('_start_date')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
243	                    end_date = variables.get('_end_date')
244	                    start_date = variables.get('_start_date')
245	                elif ScheduleInterval.HOURLY == schedule_interval:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
269	
270	                run_in_parallel = int(data_integration_metadata.get('run_in_parallel') or 0) == 1
271	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	
272	                upstream_block_uuids = data_integration_metadata.get('upstream_block_uuids')
273	                is_data_integration_child = data_integration_metadata.get('child', False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
272	                upstream_block_uuids = data_integration_metadata.get('upstream_block_uuids')
273	                is_data_integration_child = data_integration_metadata.get('child', False)
274	                is_data_integration_controller = data_integration_metadata.get('controller', False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
273	                is_data_integration_child = data_integration_metadata.get('child', False)
274	                is_data_integration_controller = data_integration_metadata.get('controller', False)
275	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
275	
276	                stream = data_integration_metadata.get('stream')
277	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	                            self.block.template_runtime_configuration[key] = (
292	                                data_integration_metadata.get(key)
293	                            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
302	                block_run_data = block_run.metrics or {}
303	                dynamic_block_index = block_run_data.get('dynamic_block_index', None)
304	                # This is used when there are 2 or more upstream dynamic blocks or dynamic childs.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
304	                # This is used when there are 2 or more upstream dynamic blocks or dynamic childs.
305	                dynamic_block_indexes = block_run_data.get('dynamic_block_indexes', None)
306	                dynamic_upstream_block_uuids = block_run_data.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
305	                dynamic_block_indexes = block_run_data.get('dynamic_block_indexes', None)
306	                dynamic_upstream_block_uuids = block_run_data.get(
307	                    'dynamic_upstream_block_uuids', None
308	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
427	                        for block_run_dict in block_run_dicts:
428	                            block_run_block_uuid = block_run_dict.get('block_uuid')
429	                            block_run_id2 = block_run_dict.get('id')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
428	                            block_run_block_uuid = block_run_dict.get('block_uuid')
429	                            block_run_id2 = block_run_dict.get('id')
430	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
444	                            # Update all the block runs that have a matching original block UUID
445	                            metrics = block_run_dict.get('metrics')
446	                            original_block_uuid = metrics.get('original_block_uuid')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
445	                            metrics = block_run_dict.get('metrics')
446	                            original_block_uuid = metrics.get('original_block_uuid')
447	                            if block_init == original_block_uuid or block_init.uuid == block.uuid:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
474	            if data_integration_metadata and is_original_block:
475	                controller_block_uuid = data_integration_metadata.get('controller_block_uuid')
476	                if on_complete and controller_block_uuid:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
501	
502	                    metrics = block_run_dict.get('metrics') or {}
503	                    controller_block_uuid = metrics.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
502	                    metrics = block_run_dict.get('metrics') or {}
503	                    controller_block_uuid = metrics.get(
504	                        'controller_block_uuid',
505	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
509	
510	                    status = block_run_dict.get('status')
511	                    if status not in status_count:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
520	                    children_length >= 1
521	                    and status_count.get(
522	                        BlockRun.BlockRunStatus.COMPLETED.value,
523	                        0,
524	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
530	                    for up_block_uuid in upstream_block_uuids:
531	                        block_run_dict = block_run_dicts_mapping.get(up_block_uuid)
532	                        if block_run_dict:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
534	                                BlockRun.BlockRunStatus.COMPLETED.value
535	                                == block_run_dict.get(
536	                                    'status',
537	                                ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
545	            elif is_data_integration_child and not is_data_integration_controller:
546	                index = int(data_integration_metadata.get('index') or 0)
547	                if index >= 1:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
547	                if index >= 1:
548	                    controller_block_uuid = data_integration_metadata.get('controller_block_uuid')
549	                    block_run_dict_previous = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
554	
555	                        metrics = block_run_dict.get('metrics')
556	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
560	                        # Same controller
561	                        if controller_block_uuid == metrics.get(
562	                            'controller_block_uuid'
563	                        ) and index - 1 == int(metrics.get('index') or 0):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
562	                            'controller_block_uuid'
563	                        ) and index - 1 == int(metrics.get('index') or 0):
564	                            block_run_dict_previous = block_run_dict

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
568	                            BlockRun.BlockRunStatus.COMPLETED.value
569	                            == block_run_dict_previous.get('status')
570	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
572	                        if not should_execute:
573	                            stream = data_integration_metadata.get('stream')
574	                            self.logger.info(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
827	        if self.block_run and self.block_run.metrics:
828	            extra_options['metadata'] = self.block_run.metrics.get('metadata')
829	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:863
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
862	                        # so this is the temp fix.
863	                        data_integration_uuid = data_integration_settings.get(
864	                            'data_integration_uuid'
865	                        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
913	            if is_source and data_integration_metadata:
914	                execution_partition_previous = data_integration_metadata.get(
915	                    'execution_partition_previous',
916	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:923
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
922	                and data_integration_metadata
923	                and data_integration_metadata.get('controller')
924	                and data_integration_metadata.get('original_block_uuid')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:924
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
923	                and data_integration_metadata.get('controller')
924	                and data_integration_metadata.get('original_block_uuid')
925	            ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
925	            ):
926	                original_block_uuid = data_integration_metadata.get('original_block_uuid')
927	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:932
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
931	
932	                    data_integration_uuid = di_settings.get('data_integration_uuid')
933	                    catalog = di_settings.get('catalog', [])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
932	                    data_integration_uuid = di_settings.get('data_integration_uuid')
933	                    catalog = di_settings.get('catalog', [])
934	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
936	                    if block_run_dicts:
937	                        block_run_block_uuids += [br.get('block_uuid') for br in block_run_dicts]
938	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:942
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
941	                    # stream. The child controller also knows how to fan out and create batches.
942	                    if data_integration_metadata.get('child'):
943	                        # Create a block run for the stream for each batch in that stream.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
943	                        # Create a block run for the stream for each batch in that stream.
944	                        stream = data_integration_metadata.get('stream')
945	                        block_run_metadata = build_block_run_metadata(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:953
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
952	                            logging_tags=logging_tags,
953	                            parent_stream=data_integration_metadata.get('parent_stream'),
954	                            partition=self.execution_partition,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:959
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
958	                        for br_metadata in block_run_metadata:
959	                            index = br_metadata.get('index') or 0
960	                            number_of_batches = br_metadata.get('number_of_batches') or 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:960
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
959	                            index = br_metadata.get('index') or 0
960	                            number_of_batches = br_metadata.get('number_of_batches') or 0
961	                            block_run_block_uuid = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1037
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1036	                                # Create a child block run for every selected stream.
1037	                                stream = stream_dict.get('tap_stream_id')
1038	                                run_in_parallel = stream_dict.get('run_in_parallel', False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1038
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1037	                                stream = stream_dict.get('tap_stream_id')
1038	                                run_in_parallel = stream_dict.get('run_in_parallel', False)
1039	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1079
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1078	                                            run_in_parallel = (
1079	                                                stream_dict[0].get(
1080	                                                    'run_in_parallel',
1081	                                                )
1082	                                                or False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1098
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1097	                                        run_in_parallel = (
1098	                                            stream_dict[0].get(
1099	                                                'run_in_parallel',
1100	                                            )
1101	                                            or False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1116	                            stream = metrics['stream']
1117	                            run_in_parallel = metrics.get('run_in_parallel') or 0
1118	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1280	            if not self.block_run and block_run_id:
1281	                self.block_run = BlockRun.query.get(block_run_id)
1282	            if self.block_run:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1355	            ]
1356	        if kwargs.get('template_runtime_configuration'):
1357	            template_run_configuration = kwargs.get('template_runtime_configuration')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1356	        if kwargs.get('template_runtime_configuration'):
1357	            template_run_configuration = kwargs.get('template_runtime_configuration')
1358	            options += [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1390	
1391	            block_run = BlockRun.query.get(block_run_id)
1392	            update_kwargs = dict(status=status)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1449	        )
1450	        if kwargs.get('block_run_id'):
1451	            default_tags['block_run_id'] = kwargs.get('block_run_id')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1450	        if kwargs.get('block_run_id'):
1451	            default_tags['block_run_id'] = kwargs.get('block_run_id')
1452	        if kwargs.get('pipeline_run_id'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1451	            default_tags['block_run_id'] = kwargs.get('block_run_id')
1452	        if kwargs.get('pipeline_run_id'):
1453	            default_tags['pipeline_run_id'] = kwargs.get('pipeline_run_id')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1452	        if kwargs.get('pipeline_run_id'):
1453	            default_tags['pipeline_run_id'] = kwargs.get('pipeline_run_id')
1454	        return merge_dict(kwargs.get('tags', {}), default_tags)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/block_executor.py:1454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1453	            default_tags['pipeline_run_id'] = kwargs.get('pipeline_run_id')
1454	        return merge_dict(kwargs.get('tags', {}), default_tags)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/streaming_pipeline_executor.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
218	                elif downstream_block.type == BlockType.DATA_EXPORTER:
219	                    sinks_by_uuid[downstream_block.uuid].batch_write(
220	                        __deepcopy(curr_block_output))
221	                if downstream_block.downstream_blocks:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/streaming_pipeline_executor.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
262	            if source.consume_method == SourceConsumeMethod.BATCH_READ:
263	                source.batch_read(handler=handle_batch_events)
264	            elif source.consume_method == SourceConsumeMethod.READ_ASYNC:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/executors/streaming_pipeline_executor.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
270	            elif source.consume_method == SourceConsumeMethod.READ:
271	                source.read(handler=handle_event)
272	        finally:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/__init__.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
156	        finally:
157	            shutil.rmtree(tmp_path)
158	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/__init__.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	                            raise TimeoutError(
247	                                "Connecting to remote timed out, make sure your SSH key is set up properly"  # noqa: E501
248	                                " and your repository host is added as a known host. More information here:"  # noqa: E501
249	                                " https://docs.mage.ai/developing-in-the-cloud/setting-up-git#5-add-github-com-to-known-hosts")  # noqa: E501

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/__init__.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
442	                    if os.path.exists(tmp_full_path):
443	                        shutil.rmtree(tmp_full_path)
444	                    repo_config_writer = repo.config_writer()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/__init__.py:757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
756	
757	            shutil.rmtree(os.path.join(self.repo_path, '.git'))
758	            shutil.copytree(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/__init__.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
766	        finally:
767	            shutil.rmtree(tmp_path)
768	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/api.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	API_ENDPOINT = 'https://api.github.com'
18	logger = Logger().new_server_logger(__name__)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/api.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
284	
285	        shutil.rmtree(os.path.join(git_manager.repo_path, '.git'))
286	        shutil.copytree(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/api.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
293	    finally:
294	        shutil.rmtree(tmp_path)
295	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
19	        project_name, repository_name = repository_name.split('/')
20	        resp = requests.get(
21	            f'https://dev.azure.com/{self.organization}/{project_name}/_apis/git/repositories/{repository_name}/refs?api-version=7.1-preview.1',  # noqa: E501
22	            headers={
23	                'Accept': 'application/json',
24	                'Authorization': f'Bearer {self.access_token}',
25	            },
26	            timeout=10,
27	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	        resp = requests.get(
21	            f'https://dev.azure.com/{self.organization}/{project_name}/_apis/git/repositories/{repository_name}/refs?api-version=7.1-preview.1',  # noqa: E501
22	            headers={

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	        arr = []
31	        for branch in data.get('value', []):
32	            branch_name = branch.get('name')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	        for branch in data.get('value', []):
32	            branch_name = branch.get('name')
33	            if branch_name.startswith('refs/heads/'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	        project_name, repository_name = repository_name.split('/')
39	        resp = requests.get(
40	            f'https://dev.azure.com/{self.organization}/{project_name}/_apis/git/repositories/{repository_name}/pullrequests?api-version=7.1-preview.1',  # noqa: E501
41	            headers={
42	                'Accept': 'application/json',
43	                'Authorization': f'Bearer {self.access_token}',
44	            },
45	            timeout=10,
46	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	        resp = requests.get(
40	            f'https://dev.azure.com/{self.organization}/{project_name}/_apis/git/repositories/{repository_name}/pullrequests?api-version=7.1-preview.1',  # noqa: E501
41	            headers={

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	        arr = []
50	        for pr in data.get('value', []):
51	            arr.append(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	                dict(
53	                    body=pr.get('description'),
54	                    created_at=pr.get('creationDate'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	                    body=pr.get('description'),
54	                    created_at=pr.get('creationDate'),
55	                    id=pr.get('pullRequestId'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	                    created_at=pr.get('creationDate'),
55	                    id=pr.get('pullRequestId'),
56	                    is_merged=pr.get('status') == 'completed',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	                    id=pr.get('pullRequestId'),
56	                    is_merged=pr.get('status') == 'completed',
57	                    merged=pr.get('status') == 'completed',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	                    is_merged=pr.get('status') == 'completed',
57	                    merged=pr.get('status') == 'completed',
58	                    state=pr.get('status'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	                    merged=pr.get('status') == 'completed',
58	                    state=pr.get('status'),
59	                    title=pr.get('title'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	                    state=pr.get('status'),
59	                    title=pr.get('title'),
60	                    url=f'https://dev.azure.com/{self.organization}/{project_name}/_git/{repository_name}/pullrequest/{pr.get("pullRequestId")}',  # noqa: E501

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	                    title=pr.get('title'),
60	                    url=f'https://dev.azure.com/{self.organization}/{project_name}/_git/{repository_name}/pullrequest/{pr.get("pullRequestId")}',  # noqa: E501
61	                    user=pr.get('createdBy', {}).get('displayName'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	                    title=pr.get('title'),
60	                    url=f'https://dev.azure.com/{self.organization}/{project_name}/_git/{repository_name}/pullrequest/{pr.get("pullRequestId")}',  # noqa: E501
61	                    user=pr.get('createdBy', {}).get('displayName'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	                    url=f'https://dev.azure.com/{self.organization}/{project_name}/_git/{repository_name}/pullrequest/{pr.get("pullRequestId")}',  # noqa: E501
61	                    user=pr.get('createdBy', {}).get('displayName'),
62	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	                    url=f'https://dev.azure.com/{self.organization}/{project_name}/_git/{repository_name}/pullrequest/{pr.get("pullRequestId")}',  # noqa: E501
61	                    user=pr.get('createdBy', {}).get('displayName'),
62	                )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
82	
83	        resp = requests.post(
84	            f'https://dev.azure.com/{self.organization}/{project_name}/_apis/git/repositories/{repository_name}/pullrequests?api-version=7.1-preview.1',  # noqa: E501
85	            headers={
86	                'Accept': 'application/json',
87	                'Authorization': f'Bearer {self.access_token}',
88	                'Content-Type': 'application/json',
89	            },
90	            data=json.dumps(data),
91	            timeout=10,
92	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	        resp = requests.post(
84	            f'https://dev.azure.com/{self.organization}/{project_name}/_apis/git/repositories/{repository_name}/pullrequests?api-version=7.1-preview.1',  # noqa: E501
85	            headers={

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	        return dict(
97	            body=pr.get('description'),
98	            created_at=pr.get('creationDate'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	            body=pr.get('description'),
98	            created_at=pr.get('creationDate'),
99	            id=pr.get('pullRequestId'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	            created_at=pr.get('creationDate'),
99	            id=pr.get('pullRequestId'),
100	            is_merged=pr.get('status') == 'completed',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	            id=pr.get('pullRequestId'),
100	            is_merged=pr.get('status') == 'completed',
101	            merged=pr.get('status') == 'completed',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	            is_merged=pr.get('status') == 'completed',
101	            merged=pr.get('status') == 'completed',
102	            state=pr.get('status'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	            merged=pr.get('status') == 'completed',
102	            state=pr.get('status'),
103	            title=pr.get('title'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	            state=pr.get('status'),
103	            title=pr.get('title'),
104	            url=pr.get('url'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	            title=pr.get('title'),
104	            url=pr.get('url'),
105	            user=pr.get('createdBy', {}).get('displayName'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	            url=pr.get('url'),
105	            user=pr.get('createdBy', {}).get('displayName'),
106	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/azure_devops.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	            url=pr.get('url'),
105	            user=pr.get('createdBy', {}).get('displayName'),
106	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
12	    def get_user(self):
13	        resp = requests.get(
14	            'https://api.bitbucket.org/2.0/user',
15	            headers={
16	                'Accept': 'application/json',
17	                'Authorization': f'Bearer {self.access_token}',
18	            },
19	            timeout=10,
20	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        resp = requests.get(
14	            'https://api.bitbucket.org/2.0/user',
15	            headers={
16	                'Accept': 'application/json',
17	                'Authorization': f'Bearer {self.access_token}',
18	            },
19	            timeout=10,
20	        )
21	        data = resp.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	        return dict(
24	            username=data.get('username'),
25	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	    def get_branches(self, repository_name: str):
28	        resp = requests.get(
29	            f'https://api.bitbucket.org/2.0/repositories/{repository_name}/refs/branches',
30	            headers={
31	                'Accept': 'application/json',
32	                'Authorization': f'Bearer {self.access_token}',
33	            },
34	            timeout=10,
35	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	        resp = requests.get(
29	            f'https://api.bitbucket.org/2.0/repositories/{repository_name}/refs/branches',
30	            headers={

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	        arr = []
39	        for branch in data.get('values', []):
40	            arr.append(branch.get('name'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        for branch in data.get('values', []):
40	            arr.append(branch.get('name'))
41	        return arr

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	    def get_pull_requests(self, repository_name: str):
44	        resp = requests.get(
45	            f'https://api.bitbucket.org/2.0/repositories/{repository_name}/pullrequests',
46	            headers={
47	                'Accept': 'application/json',
48	                'Authorization': f'Bearer {self.access_token}',
49	            },
50	            timeout=10,
51	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	        resp = requests.get(
45	            f'https://api.bitbucket.org/2.0/repositories/{repository_name}/pullrequests',
46	            headers={

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	        arr = []
55	        for pr in data.get('values', []):
56	            arr.append(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	                dict(
58	                    body=pr.get('summary', {}).get('raw'),
59	                    created_at=pr.get('created_on'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	                dict(
58	                    body=pr.get('summary', {}).get('raw'),
59	                    created_at=pr.get('created_on'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	                    body=pr.get('summary', {}).get('raw'),
59	                    created_at=pr.get('created_on'),
60	                    id=pr.get('id'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	                    created_at=pr.get('created_on'),
60	                    id=pr.get('id'),
61	                    is_merged=pr.get('state') == 'MERGED',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	                    id=pr.get('id'),
61	                    is_merged=pr.get('state') == 'MERGED',
62	                    last_modified=pr.get('updated_on'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	                    is_merged=pr.get('state') == 'MERGED',
62	                    last_modified=pr.get('updated_on'),
63	                    merged=pr.get('state') == 'MERGED',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
62	                    last_modified=pr.get('updated_on'),
63	                    merged=pr.get('state') == 'MERGED',
64	                    state=pr.get('state'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	                    merged=pr.get('state') == 'MERGED',
64	                    state=pr.get('state'),
65	                    title=pr.get('title'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	                    state=pr.get('state'),
65	                    title=pr.get('title'),
66	                    url=pr.get('links', {}).get('html', {}).get('href'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	                    title=pr.get('title'),
66	                    url=pr.get('links', {}).get('html', {}).get('href'),
67	                    user=pr.get('author', {}).get('display_name'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	                    title=pr.get('title'),
66	                    url=pr.get('links', {}).get('html', {}).get('href'),
67	                    user=pr.get('author', {}).get('display_name'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	                    title=pr.get('title'),
66	                    url=pr.get('links', {}).get('html', {}).get('href'),
67	                    user=pr.get('author', {}).get('display_name'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	                    url=pr.get('links', {}).get('html', {}).get('href'),
67	                    user=pr.get('author', {}).get('display_name'),
68	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
66	                    url=pr.get('links', {}).get('html', {}).get('href'),
67	                    user=pr.get('author', {}).get('display_name'),
68	                )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
95	
96	        resp = requests.post(
97	            f'https://api.bitbucket.org/2.0/repositories/{repository_name}/pullrequests',
98	            headers={
99	                'Accept': 'application/json',
100	                'Authorization': f'Bearer {self.access_token}',
101	                'Content-Type': 'application/json',
102	            },
103	            data=json.dumps(data),
104	            timeout=10,
105	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	        resp = requests.post(
97	            f'https://api.bitbucket.org/2.0/repositories/{repository_name}/pullrequests',
98	            headers={

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	        return dict(
110	            body=pr.get('summary', {}).get('raw'),
111	            created_at=pr.get('created_on'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	        return dict(
110	            body=pr.get('summary', {}).get('raw'),
111	            created_at=pr.get('created_on'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	            body=pr.get('summary', {}).get('raw'),
111	            created_at=pr.get('created_on'),
112	            id=pr.get('id'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	            created_at=pr.get('created_on'),
112	            id=pr.get('id'),
113	            is_merged=pr.get('state') == 'MERGED',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	            id=pr.get('id'),
113	            is_merged=pr.get('state') == 'MERGED',
114	            last_modified=pr.get('updated_on'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	            is_merged=pr.get('state') == 'MERGED',
114	            last_modified=pr.get('updated_on'),
115	            merged=pr.get('state') == 'MERGED',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	            last_modified=pr.get('updated_on'),
115	            merged=pr.get('state') == 'MERGED',
116	            state=pr.get('state'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
115	            merged=pr.get('state') == 'MERGED',
116	            state=pr.get('state'),
117	            title=pr.get('title'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	            state=pr.get('state'),
117	            title=pr.get('title'),
118	            url=pr.get('links', {}).get('html', {}).get('href'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	            title=pr.get('title'),
118	            url=pr.get('links', {}).get('html', {}).get('href'),
119	            user=pr.get('author', {}).get('display_name'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	            title=pr.get('title'),
118	            url=pr.get('links', {}).get('html', {}).get('href'),
119	            user=pr.get('author', {}).get('display_name'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	            title=pr.get('title'),
118	            url=pr.get('links', {}).get('html', {}).get('href'),
119	            user=pr.get('author', {}).get('display_name'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	            url=pr.get('links', {}).get('html', {}).get('href'),
119	            user=pr.get('author', {}).get('display_name'),
120	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/bitbucket.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	            url=pr.get('links', {}).get('html', {}).get('href'),
119	            user=pr.get('author', {}).get('display_name'),
120	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/ghe.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        else:
17	            self.api_endpoint = 'https://api.github.com'
18	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/github.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	        super().__init__(access_token)
10	        self.api_endpoint = 'https://api.github.com'
11	
12	        auth = Auth.Token(access_token)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/github.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
16	        endpoint = f'{self.api_endpoint}/user'
17	        resp = requests.get(
18	            endpoint,
19	            headers={
20	                'Accept': 'application/vnd.github+json',
21	                'Authorization': f'Bearer {self.access_token}',
22	                'X-GitHub-Api-Version': '2022-11-28',
23	            },
24	            timeout=10,
25	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/github.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	        return dict(
29	            username=data.get('login'),
30	            email=data.get('email'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/github.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	            username=data.get('login'),
30	            email=data.get('email'),
31	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        super().__init__(access_token)
14	        self.hostname = get_settings_value(GITLAB_HOST, 'https://gitlab.com')
15	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	        repository_name = quote_plus(repository_name)
23	        resp = requests.get(
24	            f'{self.hostname}/api/v4/projects/{repository_name}/repository/branches',
25	            headers={
26	                'Authorization': f'Bearer {self.access_token}',
27	            },
28	            timeout=10,
29	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	        for branch in data:
34	            arr.append(branch.get('name'))
35	        return arr

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	        repository_name = quote_plus(repository_name)
39	        resp = requests.get(
40	            f'{self.hostname}/api/v4/projects/{repository_name}/merge_requests',
41	            headers={
42	                'Authorization': f'Bearer {self.access_token}',
43	            },
44	            timeout=10,
45	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	                dict(
52	                    body=pr.get('description'),
53	                    created_at=pr.get('created_at'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	                    body=pr.get('description'),
53	                    created_at=pr.get('created_at'),
54	                    id=pr.get('id'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	                    created_at=pr.get('created_at'),
54	                    id=pr.get('id'),
55	                    is_merged=pr.get('state') == 'merged',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	                    id=pr.get('id'),
55	                    is_merged=pr.get('state') == 'merged',
56	                    last_modified=pr.get('updated_at'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	                    is_merged=pr.get('state') == 'merged',
56	                    last_modified=pr.get('updated_at'),
57	                    merged=pr.get('state') == 'merged',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	                    last_modified=pr.get('updated_at'),
57	                    merged=pr.get('state') == 'merged',
58	                    state=pr.get('state'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	                    merged=pr.get('state') == 'merged',
58	                    state=pr.get('state'),
59	                    title=pr.get('title'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	                    state=pr.get('state'),
59	                    title=pr.get('title'),
60	                    url=pr.get('web_url'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	                    title=pr.get('title'),
60	                    url=pr.get('web_url'),
61	                    user=pr.get('author', {}).get('username'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	                    url=pr.get('web_url'),
61	                    user=pr.get('author', {}).get('username'),
62	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	                    url=pr.get('web_url'),
61	                    user=pr.get('author', {}).get('username'),
62	                )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
82	
83	        resp = requests.post(
84	            f'{self.hostname}/api/v4/projects/{repository_name}/merge_requests',
85	            headers={
86	                'Accept': 'application/json',
87	                'Content-Type': 'application/json',
88	                'Authorization': f'Bearer {self.access_token}',
89	            },
90	            data=json.dumps(data),
91	            timeout=10,
92	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	        return dict(
97	            body=pr.get('description'),
98	            created_at=pr.get('created_at'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
97	            body=pr.get('description'),
98	            created_at=pr.get('created_at'),
99	            id=pr.get('id'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	            created_at=pr.get('created_at'),
99	            id=pr.get('id'),
100	            is_merged=pr.get('state') == 'merged',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	            id=pr.get('id'),
100	            is_merged=pr.get('state') == 'merged',
101	            last_modified=pr.get('updated_at'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	            is_merged=pr.get('state') == 'merged',
101	            last_modified=pr.get('updated_at'),
102	            merged=pr.get('state') == 'merged',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	            last_modified=pr.get('updated_at'),
102	            merged=pr.get('state') == 'merged',
103	            state=pr.get('state'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	            merged=pr.get('state') == 'merged',
103	            state=pr.get('state'),
104	            title=pr.get('title'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	            state=pr.get('state'),
104	            title=pr.get('title'),
105	            url=pr.get('web_url'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	            title=pr.get('title'),
105	            url=pr.get('web_url'),
106	            user=pr.get('author', {}).get('username'),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	            url=pr.get('web_url'),
106	            user=pr.get('author', {}).get('username'),
107	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/clients/gitlab.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	            url=pr.get('web_url'),
106	            user=pr.get('author', {}).get('username'),
107	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	                    with open(public_key_file, 'w') as f:
85	                        f.write(base64.b64decode(public_key).decode('utf-8'))
86	                    os.chmod(public_key_file, 0o600)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
84	                    with open(public_key_file, 'w') as f:
85	                        f.write(base64.b64decode(public_key).decode('utf-8'))
86	                    os.chmod(public_key_file, 0o600)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:85
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
84	                    with open(public_key_file, 'w') as f:
85	                        f.write(base64.b64decode(public_key).decode('utf-8'))
86	                    os.chmod(public_key_file, 0o600)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
85	                        f.write(base64.b64decode(public_key).decode('utf-8'))
86	                    os.chmod(public_key_file, 0o600)
87	            except Exception:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:86
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
85	                        f.write(base64.b64decode(public_key).decode('utf-8'))
86	                    os.chmod(public_key_file, 0o600)
87	            except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
108	                    with open(custom_private_key_file, 'w') as f:
109	                        f.write(base64.b64decode(private_key).decode('utf-8'))
110	                    os.chmod(custom_private_key_file, 0o600)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
108	                    with open(custom_private_key_file, 'w') as f:
109	                        f.write(base64.b64decode(private_key).decode('utf-8'))
110	                    os.chmod(custom_private_key_file, 0o600)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:109
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
108	                    with open(custom_private_key_file, 'w') as f:
109	                        f.write(base64.b64decode(private_key).decode('utf-8'))
110	                    os.chmod(custom_private_key_file, 0o600)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
109	                        f.write(base64.b64decode(private_key).decode('utf-8'))
110	                    os.chmod(custom_private_key_file, 0o600)
111	                    private_key_file = custom_private_key_file

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:110
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
109	                        f.write(base64.b64decode(private_key).decode('utf-8'))
110	                    os.chmod(custom_private_key_file, 0o600)
111	                    private_key_file = custom_private_key_file

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
131	                with open(os.path.join(DEFAULT_SSH_KEY_DIRECTORY, 'config'), 'w') as f:
132	                    f.write(config)
133	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	    url = urlsplit(remote_url)
175	    if remote_url.startswith('https://bitbucket.org/'):
176	        url = url._replace(netloc=f'x-token-auth:{token}@{url.netloc}')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/git/utils.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
278	                        raise TimeoutError(
279	                            """
280	Connecting to remote timed out, make sure your SSH key is set up properly
281	and your repository host is added as a known host. More information

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:2039
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
2038	            if BlockType.CHART != self.type:
2039	                exec(custom_code, results)
2040	        elif self.content is not None:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:2041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
2040	        elif self.content is not None:
2041	            exec(self.content, results)
2042	        elif os.path.exists(self.file_path):

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:2044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
2043	            with open(self.file_path) as file:
2044	                exec(file.read(), results)
2045	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:2044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2043	            with open(self.file_path) as file:
2044	                exec(file.read(), results)
2045	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:3310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
3309	            if custom_code is not None:
3310	                exec(custom_code, results)
3311	            elif os.path.exists(self.file_path):

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:3313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
3312	                with open(self.file_path) as file:
3313	                    exec(file.read(), results)
3314	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:3313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
3312	                with open(self.file_path) as file:
3313	                    exec(file.read(), results)
3314	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:4172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
4171	                with open(new_file_path, 'w') as f:
4172	                    f.write(block_content)
4173	            elif os.path.exists(old_file_path):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:4231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
4230	        with open(new_file_path) as f:
4231	            existing_code = f.read()
4232	        load_template(

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:4383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
4382	            )
4383	            exec(self.content, results)
4384	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/__init__.py:4456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
4455	            )
4456	            exec(self.content, results)
4457	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/content.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
99	                ))
100	                exec(f'value_hydrated = {function_string}', results)
101	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/data.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	                if schema:
71	                    f.write(f'{json.dumps(schema)}\n')
72	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/data.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	                for record in records_in_batch:
74	                    f.write(_output(record))
75	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/data.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	        if schema:
85	            io_buffer.write(f'{json.dumps(schema)}\n')
86	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/data.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
87	        for record in records:
88	            io_buffer.write(_output(record))
89	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/mixins.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
165	            with open(catalog_full_path, mode='r') as f:
166	                t = f.read()
167	                if t:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/mixins.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	            async with aiofiles.open(catalog_full_path, mode='r') as f:
184	                t = await f.read()
185	                if t:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/mixins.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
203	            with open(catalog_full_path, mode='w') as f:
204	                f.write(json.dumps(catalog))
205	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/mixins.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
348	                    results = {}
349	                    exec(f'_parse_func = {parse}', results)
350	                    return results['_parse_func'](data)

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/mixins.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
652	        if self.content is not None:
653	            exec(self.content, results)
654	        elif os.path.exists(self.file_path):

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/mixins.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
655	            with open(self.file_path) as file:
656	                exec(file.read(), results)
657	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/mixins.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
655	            with open(self.file_path) as file:
656	                exec(file.read(), results)
657	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/utils.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	        with open(file_path, 'w') as f:
99	            f.write(json.dumps(dict(bookmarks={})))
100	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/utils.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
562	        filename = output_filename(index) if index is not None else None
563	        with variable.open_to_write(filename) as f:
564	            for line in proc.stdout:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/data_integration/utils.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
564	            for line in proc.stdout:
565	                f.write(line.decode()),
566	                print_log_from_line(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/dbt/block_sql.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	            with compiled_path.open('r') as f:
52	                compiled_sql = f.read()
53	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/dbt/profiles.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
71	                asyncio.get_running_loop()
72	                with ThreadPoolExecutor(1) as pool:
73	                    self.__profiles = pool.submit(lambda: asyncio.run(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/dbt/profiles.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
106	                try:
107	                    shutil.rmtree(self.__interpolated_profiles_dir)
108	                except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/dbt/profiles.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
186	            async with aiofiles.open(raw_profiles_full_path, mode='r') as f:
187	                content = await f.read()
188	                profiles = Template(content).render(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/dbt/project.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
76	                asyncio.get_running_loop()
77	                with ThreadPoolExecutor(1) as pool:
78	                    self.__project = pool.submit(lambda: asyncio.run(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/dbt/project.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
106	            async with aiofiles.open(project_full_path, mode='r') as f:
107	                content = await f.read()
108	                project = yaml.safe_load(content)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/dbt/sources.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
72	            with Path(self.__sources_full_path).open('r') as f:
73	                sources = yaml.safe_load(f.read())
74	        except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/dbt/sources.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	
136	        self.__write()
137	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/dbt/sources.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
173	
174	        self.__write()
175	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/integration/__init__.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
157	                for line in proc.stdout:
158	                    f.write(line.decode())
159	                    print_log_from_line(

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/integration/__init__.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
204	
205	            exec(self.content, results)
206	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/integration/__init__.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
334	                output = '\n'.join(output_arr)
335	                f.write(output)
336	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/integration/__init__.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
440	                with open(destination_state_file_path, 'r') as f:
441	                    text = f.read()
442	                    d = json.loads(text) if text else {}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/r/__init__.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	    with open(file_path, "w") as foutput:
62	        foutput.write(execution_code)
63	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/spark/mixins.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
314	        with open(self.spark_jobs_full_path) as f:
315	            content = f.read()
316	            if content:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/spark/mixins.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
330	                with open(self.spark_jobs_full_path) as f:
331	                    content = f.read()
332	                    if content:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/block/spark/mixins.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
339	        with open(self.spark_jobs_full_path, 'w') as f:
340	            f.write(json.dumps(data))
341	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/custom_templates/custom_block_template.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
165	        os.makedirs(os.path.dirname(file_path), exist_ok=True)
166	        safe_write(file_path, content)
167	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/custom_templates/custom_block_template.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
181	    def delete(self) -> None:
182	        shutil.rmtree(os.path.join(self.repo_path, self.uuid))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/custom_templates/custom_pipeline_template.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
159	            with open(self.triggers_file_path, 'r') as f:
160	                content = f.read()
161	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/custom_templates/custom_pipeline_template.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
188	        os.makedirs(os.path.dirname(file_path), exist_ok=True)
189	        safe_write(file_path, content)
190	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/custom_templates/custom_pipeline_template.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
194	        os.makedirs(os.path.dirname(file_path), exist_ok=True)
195	        safe_write(file_path, content)
196	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/custom_templates/custom_pipeline_template.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
197	    def delete(self) -> None:
198	        shutil.rmtree(os.path.join(self.repo_path, self.uuid))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/file.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	
86	        self.write(
87	            repo_path,
88	            dir_path,
89	            filename,
90	            content,
91	            create_directories_if_not_exist=create_directories_if_not_exist,
92	            file_version_only=file_version_only,
93	            overwrite=overwrite,
94	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/file.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
321	                if content:
322	                    f.write(content or '')
323	        self.validate_content(dir_path, filename, content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/file.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
354	            async with aiofiles.open(file_path, **kwargs) as fp:
355	                await fp.write(content or '')
356	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/file.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
374	            with open(self.file_path, encoding='utf-8') as fp:
375	                file_content = fp.read()
376	            return file_content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/file.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
385	            async with aiofiles.open(self.file_path, mode='r', encoding='utf-8') as fp:
386	                file_content = await fp.read()
387	            return file_content

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/file.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
419	    def update_content(self, content: str):
420	        self.write(
421	            self.repo_path,
422	            self.dir_path,
423	            self.filename,
424	            content,
425	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/global_data_product/__init__.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	            with open(file_path_to_use) as fp:
67	                content = fp.read()
68	                if content:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/global_data_product/__init__.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
359	        content = yaml.safe_dump(mapping_new)
360	        safe_write(self.file_path(self.repo_path), content)
361	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/global_hooks/models.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
752	            with open(file_path_to_use, 'r') as fp:
753	                content = fp.read()
754	                if content:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/global_hooks/models.py:1096
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1095	            with open(file_path) as f:
1096	                content_original = f.read()
1097	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/global_hooks/models.py:1102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1101	                content = yaml.safe_dump(data)
1102	                safe_write(file_path, content)
1103	            except Exception as err:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/global_hooks/models.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1104	                if content_original:
1105	                    safe_write(file_path, content_original)
1106	                raise err

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
368	                    with open(source, 'r') as src:
369	                        File.create(file_name, dir_path, src.read(), overwrite=overwrite)
370	                except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
415	        duplicate_pipeline_dict['name'] = duplicate_pipeline_uuid
416	        safe_write(
417	            duplicate_pipeline.config_path,
418	            yaml.dump(duplicate_pipeline_dict),
419	        )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
415	        duplicate_pipeline_dict['name'] = duplicate_pipeline_uuid
416	        safe_write(
417	            duplicate_pipeline.config_path,
418	            yaml.dump(duplicate_pipeline_dict),
419	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:632
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
631	                    try:
632	                        catalog = json.loads(await f.read())
633	                    except Exception as err:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2199	                    shutil.move(path_old, path_new)
2200	                shutil.rmtree(dir_old)
2201	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2226	        if os.path.exists(self.dir_path):
2227	            shutil.rmtree(self.dir_path)
2228	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2301	        if os.path.exists(variables_path):
2302	            shutil.rmtree(variables_path)
2303	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
2320	            if os.path.exists(dir_name):
2321	                shutil.rmtree(dir_name)
2322	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2385	
2386	        safe_write(self.config_path, content)
2387	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2385	
2386	        safe_write(self.config_path, content)
2387	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2444	                async with aiofiles.open(self.catalog_config_path, mode='w') as fp:
2445	                    await fp.write(json.dumps(self.data_integration))
2446	            pipeline_dict = self.to_dict(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2444	                async with aiofiles.open(self.catalog_config_path, mode='w') as fp:
2445	                    await fp.write(json.dumps(self.data_integration))
2446	            pipeline_dict = self.to_dict(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2463	        async with aiofiles.open(test_path, mode='w', encoding='utf-8') as fp:
2464	            await fp.write(content)
2465	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipeline.py:2464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
2463	        async with aiofiles.open(test_path, mode='w', encoding='utf-8') as fp:
2464	            await fp.write(content)
2465	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipelines/integration_pipeline.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	            with open(file_path, 'w') as f:
142	                f.write(json.dumps(dict(bookmarks={})))
143	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipelines/integration_pipeline.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
159	            with open(file_path, 'w') as f:
160	                f.write('')
161	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/pipelines/integration_pipeline.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
171	            with open(file_path, 'w') as f:
172	                f.write(json.dumps(dict(bookmarks={})))
173	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/triggers/__init__.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	        with open(trigger_file_path) as fp:
146	            content = fp.read()
147	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/triggers/__init__.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
326	    trigger_file_path = get_triggers_file_path(pipeline_uuid)
327	    safe_write(trigger_file_path, content)
328	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/triggers/__init__.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
343	    trigger_file_path = get_triggers_file_path(pipeline_uuid)
344	    safe_write(trigger_file_path, content)
345	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/variable.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
418	        #         return __read()
419	        return __read()
420	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/variable.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
551	
552	        return await __read()
553	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/variable.py:711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
710	
711	        with self.storage.open_to_write(self.full_path(filename)) as fi:
712	            yield fi

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/widget/__init__.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
316	        if custom_code is not None and custom_code.strip():
317	            exec(custom_code, results)
318	        elif self.content is not None:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/widget/__init__.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
318	        elif self.content is not None:
319	            exec(self.content, results)
320	        elif os.path.exists(self.file_path):

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/widget/__init__.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
321	            with open(self.file_path) as file:
322	                exec(file.read(), results)
323	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/models/widget/__init__.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
321	            with open(self.file_path) as file:
322	                exec(file.read(), results)
323	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/preferences.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
109	                with open(self.preferences_file_path) as f:
110	                    project_preferences = yaml.full_load(f.read()) or {}
111	        except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/repo_manager.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
95	                    with open(self.metadata_path) as f:
96	                        config_file = Template(f.read()).render(**get_template_vars())
97	                        repo_config = load_yaml(config_file) or {}

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/shared/secrets.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
83	    if os.path.exists(secrets_dir):
84	        shutil.rmtree(secrets_dir)
85	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/shared/secrets.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
265	        with open(key_file, 'r', encoding='utf-8') as f:
266	            key = f.read()
267	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/shared/secrets.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
269	        with open(key_file, 'w', encoding='utf-8') as f:
270	            f.write(key)
271	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/shared/secrets.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
273	        with open(uuid_file, 'r', encoding='utf-8') as f:
274	            key_uuid = f.read()
275	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/shared/secrets.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
277	        with open(uuid_file, 'w', encoding='utf-8') as f:
278	            f.write(key_uuid)
279	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/shared/secrets.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
297	        with open(key_file, 'r', encoding='utf-8') as f:
298	            key = f.read()
299	    except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/shared/secrets.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
303	        with open(uuid_file, 'r', encoding='utf-8') as f:
304	            key_uuid = f.read()
305	    except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/storage/local_storage.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
55	    def remove_dir(self, path: str) -> None:
56	        shutil.rmtree(path, ignore_errors=True)
57	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/storage/local_storage.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
85	            try:
86	                return json.loads(await file.read())
87	            except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/storage/local_storage.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
117	            )
118	            await file.write(fcontent)
119	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/storage/local_storage.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
160	            try:
161	                return await file.read()
162	            except Exception as err:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/storage/local_storage.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
172	            try:
173	                return file.read()
174	            except Exception as err:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/sync/git_sync.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
18	            with open(self.preferences_file_path, 'r', encoding='utf-8') as f:
19	                self.initial_preferences = f.read()
20	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/sync/git_sync.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	            with open(self.preferences_file_path, 'w', encoding='utf-8') as f:
24	                f.write(self.initial_preferences)
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/repo/data_loaders/load_titanic.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    """
17	    url = 'https://raw.githubusercontent.com/datasciencedojo/datasets/master/titanic.csv?raw=True'
18	
19	    return pd.read_csv(url)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/utils.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
34	    shutil.copytree(template_path, dest_path)
35	    chmod(dest_path, stat.S_IRWXU)
36	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/utils.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
61	    with open(dest_path, 'w') as foutput:
62	        foutput.write(template_source)
63	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/utils.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
92	        results = {}
93	        exec(f'_parse_func = {parse}', results)
94	        return results['_parse_func'](value)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/frameworks/execution/models/pipeline/adapter.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
43	
44	        config = await asyncio.to_thread(yaml.safe_load, content)
45	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/bigquery.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        CLIENT_SCOPES = [
61	            'https://www.googleapis.com/auth/drive',
62	            'https://www.googleapis.com/auth/bigquery',
63	        ]
64	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/bigquery.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	            'https://www.googleapis.com/auth/drive',
62	            'https://www.googleapis.com/auth/bigquery',
63	        ]
64	
65	        credentials = kwargs.get('credentials')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/config.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
506	            with self.filepath.open('r') as fin:
507	                config_file = Template(fin.read()).render(
508	                    **get_template_vars(),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/file.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	
38	                return self._read(filepath, format, **kwargs)
39	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/file.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	                    format = self._get_file_format(fp)
48	                df = self._read(fp, format, **kwargs)
49	                dfs.append(df)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/file.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
71	        with self.printer.print_msg(f'Exporting data frame to \'{filepath}\''):
72	            self._write(df, format, filepath, **kwargs)
73	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/google_sheets.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	        scopes = [
60	            'https://www.googleapis.com/auth/spreadsheets',
61	            'https://www.googleapis.com/auth/drive',
62	        ]
63	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/google_sheets.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	            'https://www.googleapis.com/auth/spreadsheets',
61	            'https://www.googleapis.com/auth/drive',
62	        ]
63	
64	        credentials = kwargs.get('credentials')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/io_config.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	        with self.filepath.open('r') as fin:
52	            config = yaml.full_load(fin.read())
53	        profile_settings = config.get(profile)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/postgres.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
129	
130	                host = '127.0.0.1'
131	                port = self.ssh_tunnel.local_bind_port

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/s3.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	                with obj_loc.open('wb') as fin:
78	                    fin.write(response['Body'].read())
79	                return self._read(obj_loc, format, limit, **kwargs)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/s3.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
77	                with obj_loc.open('wb') as fin:
78	                    fin.write(response['Body'].read())
79	                return self._read(obj_loc, format, limit, **kwargs)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/s3.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
78	                    fin.write(response['Body'].read())
79	                return self._read(obj_loc, format, limit, **kwargs)
80	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/s3.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        else:
81	            buffer = BytesIO(response['Body'].read())
82	            return self._read(buffer, format, limit, **kwargs)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/s3.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
81	            buffer = BytesIO(response['Body'].read())
82	            return self._read(buffer, format, limit, **kwargs)
83	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/s3.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	                        obj_loc = temp_dir / f'{name}.hdf5'
113	                        self._write(data, format, obj_loc, **kwargs)
114	                        with obj_loc.open('rb') as fin:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/s3.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
117	                    buffer = BytesIO()
118	                    self._write(data, format, buffer, **kwargs)
119	                    buffer.seek(0)

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/io/s3.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
142	            file.unlink()
143	        temp_dir.rmdir()
144	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/kernels/magic/execution.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
90	        with redirect_stdout(async_stdout):
91	            exec(compiled_code, exec_globals)
92	            if any(stop_event.is_set() for stop_event in stop_events):

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/kernels/magic/kernels/models.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
42	    def __initialize_kernel(self, num_processes: Optional[int] = None) -> None:
43	        self.executor = ThreadPoolExecutor()
44	        self.num_processes = num_processes or DEFAULT_NUM_PROCESSES

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/kernels/magic/kernels/models.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
46	        # These need to go before starting the thread.
47	        self.pool = Pool(processes=self.num_processes)
48	        self.context_manager = SyncManager()

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/kernels/magic/kernels/models.py:47
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
46	        # These need to go before starting the thread.
47	        self.pool = Pool(processes=self.num_processes)
48	        self.context_manager = SyncManager()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/kernels/magic/kernels/models.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
97	
98	        process = Process(self.uuid, message, message_request_uuid=message_request_uuid)
99	        if (

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/kernels/magic/models.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
105	        if process.is_alive() and process.pid:
106	            proc = psutil.Process(process.pid)
107	            if any(

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/orchestration/db/process.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
25	    engine.dispose()
26	    return multiprocessing.Process(target=start_session_and_run, args=new_args)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/orchestration/db/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
14	
15	DEFAULT_POSTGRES_HOST = '127.0.0.1'
16	DEFAULT_POSTGRES_PORT = '5432'

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/orchestration/queue/process_queue.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
187	        """
188	        self.worker_pool_proc = mp.Process(
189	            target=poll_job_and_execute,
190	            args=[
191	                self.queue,
192	                self.size,
193	                self.job_dict,
194	                self.redis_client,
195	                self.client_id,
196	            ],

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/presenters/block_layout/page.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	        os.makedirs(os.path.dirname(file_path), exist_ok=True)
86	        safe_write(file_path, content)
87	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/presenters/block_layout/page.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
88	    def delete(self) -> None:
89	        shutil.rmtree(self.file_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/presenters/design/models.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	            with open(file_path_to_use, 'r') as fp:
138	                content = fp.read()
139	                if content:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/presenters/design/models.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
196	            with open(file_path) as f:
197	                content_original = f.read()
198	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/presenters/design/models.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
202	                content = yaml.safe_dump(data)
203	                safe_write(file_path, content)
204	            except Exception as err:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/presenters/design/models.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
205	                if content_original:
206	                    safe_write(file_path, content_original)
207	                raise err

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/active_kernel.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	            raise Exception(
111	                'PySpark kernel is not installed. Please follow the instructions in '
112	                'https://docs.mage.ai/integrations/spark-pyspark '
113	                'to install it.'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	                    csv_line = table[line] if is_last_line else table[line] + '\n'
68	                    self.write(csv_line.encode('UTF-8'))
69	                except iostream.StreamClosedError:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
67	                    csv_line = table[line] if is_last_line else table[line] + '\n'
68	                    self.write(csv_line.encode('UTF-8'))
69	                except iostream.StreamClosedError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
94	                while True:
95	                    _buffer = file_pointer.read(4096)
96	                    if not _buffer:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	                        break
98	                    self.write(_buffer)
99	            except Exception as e:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
97	                        break
98	                    self.write(_buffer)
99	            except Exception as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
100	                self.set_status(400)
101	                self.write(f'Error fetching file {file_name}.\n{e}')
102	            finally:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
100	                self.set_status(400)
101	                self.write(f'Error fetching file {file_name}.\n{e}')
102	            finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
109	            self.set_status(400)
110	            self.write('Download token is expired.')
111	        except (jwt.exceptions.InvalidSignatureError, jwt.exceptions.DecodeError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
109	            self.set_status(400)
110	            self.write('Download token is expired.')
111	        except (jwt.exceptions.InvalidSignatureError, jwt.exceptions.DecodeError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	            self.set_status(400)
113	            self.write('Download token is invalid.')
114	        except ValueError as e:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
112	            self.set_status(400)
113	            self.write('Download token is invalid.')
114	        except ValueError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	            self.set_status(400)
116	            self.write(f'Attepmt at fetching file outside of project folder: {e}')
117	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
115	            self.set_status(400)
116	            self.write(f'Attepmt at fetching file outside of project folder: {e}')
117	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
131	            for path, relative in zip(file_list, relative_file_list):
132	                zipf.write(path, relative)
133	        zip_file.seek(0)  # set cursor to start of file to prepare for content extraction

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/downloads.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
131	            for path, relative in zip(file_list, relative_file_list):
132	                zipf.write(path, relative)
133	        zip_file.seek(0)  # set cursor to start of file to prepare for content extraction

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/projects.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	                async with session.get(
13	                    'https://pypi.org/pypi/mage-ai/json',
14	                    timeout=3,
15	                ) as response:
16	                    response_json = await response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	
40	        payload = self.get_payload().get('run', {})
41	        pipeline_uuid = payload.get('pipeline_uuid')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	        payload = self.get_payload().get('run', {})
41	        pipeline_uuid = payload.get('pipeline_uuid')
42	        block_uuid = payload.get('block_uuid')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
41	        pipeline_uuid = payload.get('pipeline_uuid')
42	        block_uuid = payload.get('block_uuid')
43	        project = payload.get('project')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
42	        block_uuid = payload.get('block_uuid')
43	        project = payload.get('project')
44	        variables = payload.get('variables', {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	        project = payload.get('project')
44	        variables = payload.get('variables', {})
45	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	
46	        record = payload.get('record', True)
47	        store_variables = payload.get('store_variables', True)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	        record = payload.get('record', True)
47	        store_variables = payload.get('store_variables', True)
48	        run_upstream_blocks = payload.get('run_upstream_blocks', False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	        store_variables = payload.get('store_variables', True)
48	        run_upstream_blocks = payload.get('run_upstream_blocks', False)
49	        incomplete_only = payload.get('incomplete_only', False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	        run_upstream_blocks = payload.get('run_upstream_blocks', False)
49	        incomplete_only = payload.get('incomplete_only', False)
50	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	
51	        pipeline = Pipeline.get(
52	            pipeline_uuid,
53	            repo_path=os.path.join(base_repo_dirname(), project) if project else None,
54	            check_if_exists=False,
55	            all_projects=True,
56	            use_repo_path=True if project else False,
57	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/runs.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	
149	        self.write(dict(
150	            run=output,
151	        ))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/triggers.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
18	    def post(self, pipeline_schedule_id, token: str = None):
19	        pipeline_schedule = PipelineSchedule.query.get(int(pipeline_schedule_id))
20	        if not pipeline_schedule:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/api/triggers.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	
55	        pipeline = Pipeline.get(
56	            pipeline_schedule.pipeline_uuid, repo_path=pipeline_schedule.repo_path
57	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/client/mage.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	    def __init__(self, **kwargs):
12	        self.url_prefix = 'https://backend.mage.ai/api/v1'
13	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/client/mage.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	        try:
31	            remote_id = pipeline.metadata.get('remote_id')
32	            if remote_id is not None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/client/mage.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
41	            else:
42	                response = requests.post(
43	                    data=json.dumps(data),
44	                    headers={
45	                        'Content-Type': 'application/json',
46	                        'X-API-KEY': api_key,
47	                    },
48	                    url=f'{self.url_prefix}/data_cleaning_pipelines',
49	                ).json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/client/mage.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	        try:
66	            response = requests.get(
67	                headers={
68	                    'Content-Type': 'application/json',
69	                    'X-API-KEY': api_key,
70	                },
71	                url=f'{self.url_prefix}/data_cleaning_pipelines/{id}',
72	            ).json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/client/mage.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	            ).json()
73	            return response['data_cleaning_pipeline'].get('pipeline_actions', [])
74	        except Exception:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/docs_server.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
25	        httpd.shutdown()
26	        httpd.server_close()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/execution_manager.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
109	    if os.path.isdir(path):
110	        shutil.rmtree(path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/server.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
178	    def get(self, action_type=None):
179	        self.write(dict(scheduler=dict(status=scheduler_manager.get_status())))
180	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/server.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
185	            scheduler_manager.stop_scheduler()
186	        self.write(dict(scheduler=dict(status=scheduler_manager.get_status())))
187	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/server.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
193	        self.set_header('Content-Type', prometheus_client.CONTENT_TYPE_LATEST)
194	        self.write(prometheus_client.generate_latest(prometheus_client.REGISTRY))
195	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/server.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
217	    if os.path.exists(dst):
218	        shutil.rmtree(dst)
219	    shutil.copytree(src, dst)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/server.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
219	    shutil.copytree(src, dst)
220	    chmod(dst, stat.S_IRWXU)
221	    for path, _, files in os.walk(os.path.abspath(dst)):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/server.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
225	                with open(filepath, encoding='utf-8') as f:
226	                    s = f.read()
227	                s = s.replace(BASE_PATH_PLACEHOLDER, base_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/server.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
231	                with open(filepath, 'w', encoding='utf-8') as f:
232	                    f.write(s)
233	    return dst

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/server.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
468	        with open(file_path, 'w') as f:
469	            f.write(json.dumps({}))
470	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/server.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
736	        with open(metadata_file, 'w') as f:
737	            f.write('')
738	    observer.schedule(event_handler, path=metadata_file)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/terminal_server.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
149	        if buffered:
150	            self.on_pty_read(buffered)
151	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/terminal_server.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	        if self.term_command == 'bash':
154	            self.terminal.ptyproc.write(
155	                "bind 'set enable-bracketed-paste off' # Mage terminal settings command\r")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/utils/execute_custom_code.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
135	
136	    pipeline_config_json = base64.b64decode('{pipeline_config_json_encoded}').decode()
137	    pipeline_config = json.loads(pipeline_config_json)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/utils/execute_custom_code.py:136
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
135	
136	    pipeline_config_json = base64.b64decode('{pipeline_config_json_encoded}').decode()
137	    pipeline_config = json.loads(pipeline_config_json)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/utils/execute_custom_code.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
138	
139	    repo_config_json = base64.b64decode('{repo_config_json_encoded}').decode()
140	    repo_config = json.loads(repo_config_json)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/utils/execute_custom_code.py:139
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
138	
139	    repo_config_json = base64.b64decode('{repo_config_json_encoded}').decode()
140	    repo_config = json.loads(repo_config_json)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/utils/output_display.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
197	    with open(path_to_file, 'r') as file:
198	        content = file.read()
199	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/websocket_server.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
491	                    pipeline_config=pipeline_config,
492	                    pipeline_config_json_encoded=base64.b64encode(
493	                        simplejson.dumps(pipeline_config).encode()
494	                    ).decode(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/websocket_server.py:492
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
491	                    pipeline_config=pipeline_config,
492	                    pipeline_config_json_encoded=base64.b64encode(
493	                        simplejson.dumps(pipeline_config).encode()
494	                    ).decode(),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/websocket_server.py:496
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
495	                    repo_config=repo_config,
496	                    repo_config_json_encoded=base64.b64encode(
497	                        simplejson.dumps(repo_config).encode()
498	                    ).decode(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/websocket_server.py:496
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
495	                    repo_config=repo_config,
496	                    repo_config_json_encoded=base64.b64encode(
497	                        simplejson.dumps(repo_config).encode()
498	                    ).decode(),

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/server/websocket_server.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
618	            queue = multiprocessing.Queue()
619	            proc = multiprocessing.Process(
620	                target=run_pipeline, args=(pipeline, config_copy_path, global_vars, queue)
621	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/airbyte/client.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        self,
14	        base_url: str = 'http://localhost:8000/api/v1',
15	        logger: logging.Logger = None,
16	        password: str = 'password',
17	        timeout: int = 12,
18	        username: str = 'airbyte',
19	    ):
20	        self.base_url = base_url

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/aws/ecs/config.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	
35	        container_metadata = requests.get(ecs_container_metadata_uri).json()
36	        container_name = container_metadata['Name']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/aws/ecs/config.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	        container_name = container_metadata['Name']
37	        task_metadata = requests.get(ecs_container_metadata_uri + '/task').json()
38	        cluster = task_metadata.get('Cluster').split('/')[-1]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/aws/ecs/config.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	        task_metadata = requests.get(ecs_container_metadata_uri + '/task').json()
38	        cluster = task_metadata.get('Cluster').split('/')[-1]
39	        task_definition = task_metadata.get('Family')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/aws/ecs/config.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
38	        cluster = task_metadata.get('Cluster').split('/')[-1]
39	        task_definition = task_metadata.get('Family')
40	        task_arn = task_metadata.get('TaskARN')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/aws/ecs/config.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        task_definition = task_metadata.get('Family')
40	        task_arn = task_metadata.get('TaskARN')
41	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/aws/emr/resource_manager.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
41	            with open(self.local_bootstrap_script_path, 'r', encoding='utf-8') as f:
42	                bootstrap_script_code = f.read()
43	        s3.Client(self.s3_bucket).upload(self.bootstrap_script_path_key, bootstrap_script_code)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
208	    if compute_service.project.emr_config and \
209	            compute_service.project.emr_config.get('master_security_group'):
210	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
210	
211	        master_security_group_name = compute_service.project.emr_config.get('master_security_group')
212	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	            url = f'http://{active_cluster.master_public_dns_name}:{CUSTOM_TCP_PORT}'
217	            response = requests.get(
218	                url,
219	                timeout=3,
220	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
243	        result = compute_service.clusters_and_metadata(deserialize=False)
244	        clusters = result.get('clusters')
245	        if clusters:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
293	    if compute_service.project.emr_config and \
294	            compute_service.project.emr_config.get('master_security_group'):
295	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
295	
296	        master_security_group_name = compute_service.project.emr_config.get('master_security_group')
297	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:303
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
302	        try:
303	            test_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
304	            test_socket.settimeout(timeout)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
303	            test_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
304	            test_socket.settimeout(timeout)
305	            test_socket.connect((active_cluster.master_public_dns_name, SSH_PORT))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
304	            test_socket.settimeout(timeout)
305	            test_socket.connect((active_cluster.master_public_dns_name, SSH_PORT))
306	            status = SetupStepStatus.COMPLETED

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
324	        else:
325	            test_socket.close()
326	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
344	    if compute_service.project.emr_config:
345	        ec2_key_name = compute_service.project.emr_config.get('ec2_key_name')
346	        ec2_key_path = compute_service.project.emr_config.get('ec2_key_path')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/compute/aws/steps.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
345	        ec2_key_name = compute_service.project.emr_config.get('ec2_key_name')
346	        ec2_key_path = compute_service.project.emr_config.get('ec2_key_path')
347	        if ec2_key_name:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/dbt/constants.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	
3	DBT_CLOUD_BASE_URL = 'https://cloud.getdbt.com/api/v2/accounts'
4	
5	DEFAULT_POLL_INTERVAL = 3

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/dbt/dbt.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
21	        if type(config) is dict:
22	            self.config = DbtConfig.load(config=config)
23	        else:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/dbt/dbt.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
41	        """
42	        return self.make_request(
43	            f'/{self.config.account_id}/jobs',
44	            params=dict(
45	                order_by=order_by,
46	                project_id=project_id,
47	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/dbt/dbt.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
73	        """
74	        return self.make_request(
75	            f'/{self.config.account_id}/runs',
76	            params=dict(
77	                include_related=include_related,
78	                job_definition_id=job_definition_id,
79	                order_by=order_by,
80	                offset=offset,
81	                limit=limit,
82	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/dbt/dbt.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
85	    def get_run(self, run_id: int, include_related: List[str] = []):
86	        return self.make_request(
87	            f'/{self.config.account_id}/runs/{run_id}',
88	            params=dict(
89	                include_related=include_related,
90	            ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/dbt/dbt.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
134	        """
135	        job_run_response = self.make_request(
136	            f'/{self.config.account_id}/jobs/{job_id}/run',
137	            method='POST',
138	            payload=dict(
139	                cause=cause,
140	                git_sha=git_sha,
141	                schema_override=schema_override,
142	                dbt_version_override=dbt_version_override,
143	                threads_override=threads_override,
144	                target_name_override=target_name_override,
145	                generate_docs_override=generate_docs_override,
146	                timeout_seconds_override=timeout_seconds_override,
147	                steps_override=steps_override
148	            ),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/discord/discord.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
11	
12	    requests.post(
13	        url=config.webhook_url,
14	        json={
15	            "content": summary
16	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/gcp/cloud_run/cloud_run.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	CLOUD_RUN_CLIENT_SCOPES = [
18	    'https://www.googleapis.com/auth/cloud-platform',
19	    'https://www.googleapis.com/auth/compute',
20	]
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/gcp/cloud_run/cloud_run.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    'https://www.googleapis.com/auth/cloud-platform',
19	    'https://www.googleapis.com/auth/compute',
20	]
21	
22	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/google_chat/google_chat.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
9	) -> None:
10	    requests.post(
11	        url=config.webhook_url,
12	        json={
13	            'text': '*{title}*\n{message}'.format(title=title, message=message),
14	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/constants.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	
26	HIGHTOUCH_BASE_URL = 'https://api.hightouch.com/api/v1'

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/hightouch.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
19	        if type(config) is dict:
20	            self.config = HightouchConfig.load(config=config)
21	        else:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/hightouch.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
28	    def list_sources(self):
29	        return self.make_request('/sources')
30	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/hightouch.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
31	    def get_source(self, source_id: int):
32	        return self.make_request(f'/sources/{source_id}')
33	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/hightouch.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
34	    def list_destinations(self):
35	        return self.make_request('/destinations')
36	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/hightouch.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
37	    def get_destination(self, destination_id: int):
38	        return self.make_request(f'/destinations/{destination_id}')
39	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/hightouch.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
40	    def list_syncs(self):
41	        return self.make_request('/syncs')
42	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/hightouch.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
43	    def get_sync(self, sync_id: int):
44	        return self.make_request(f'/syncs/{sync_id}')
45	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/hightouch.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
46	    def list_sync_runs(self, sync_id: int, params: Dict = dict()):
47	        return self.make_request(f'/syncs/{sync_id}/runs', params=params)
48	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/hightouch/hightouch.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
49	    def trigger_sync(self, sync_id: int, payload: Dict = dict(fullResync=False)):
50	        return self.make_request(f'/syncs/{sync_id}/trigger', method='POST', payload=payload)
51	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/metaplane/metaplane.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	class Metaplane(HttpClient):
63	    BASE_URL = 'https://dev.api.metaplane.dev'
64	    VERSION = 'v1'

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/metaplane/metaplane.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
67	        if type(config) is dict:
68	            self.config = Config.load(config=config)
69	        else:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/metaplane/metaplane.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
127	    def connections(self, include_deleted: bool = False) -> List[Connection]:
128	        return self.make_request(
129	            f'/{self.VERSION}/connections',
130	            params=dict(includeDeleted=include_deleted),
131	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/metaplane/metaplane.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
133	    def monitors(self, connection_id: str, include_deleted: bool = False) -> Monitors:
134	        return self.make_request(
135	            f'/{self.VERSION}/monitors/connection/{connection_id}',
136	            params=dict(includeDeleted=include_deleted),
137	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/metaplane/metaplane.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
139	    def monitor_status(self, monitor_id: str) -> MonitorStatus:
140	        return self.make_request(f'/{self.VERSION}/monitors/status/{monitor_id}')
141	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/metaplane/metaplane.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
142	    def run_monitors(self, monitor_ids: List[str]) -> Dict:
143	        response = self.make_request(f'/{self.VERSION}/monitors/run', method='POST', payload=dict(
144	            testIds=monitor_ids,
145	        ))

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/opsgenie/opsgenie.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
35	    print(f'Creating Opsgenie Alert {payload}')
36	    response = requests.post(url, headers=headers, data=json.dumps(payload))
37	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/slack/slack.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
26	
27	    response = requests.post(
28	        config.webhook_url,
29	        json.dumps(payload),
30	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/spark/api/base.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
164	        url = f'{self.endpoint(host=host)}{path}'
165	        response = await self.__build_request(
166	            'get',
167	            url,
168	            query=query,
169	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/spark/models/applications.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	            with open(self.__cache_file_path()) as f:
74	                content = f.read()
75	                if content:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/spark/models/applications.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
82	        with open(self.__cache_file_path(), 'w') as f:
83	            f.write(json.dumps(data))
84	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/spark/models/applications.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
90	            with open(self.__cache_file_path()) as f:
91	                content = f.read()
92	                if content:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/ssh/aws/emr/models.py:163
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
162	        try:
163	            test_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
164	            test_socket.settimeout(5)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/ssh/aws/emr/models.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
163	            test_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
164	            test_socket.settimeout(5)
165	            test_socket.connect((self._instance.master_public_dns_name, SSH_PORT))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/ssh/aws/emr/models.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
164	            test_socket.settimeout(5)
165	            test_socket.connect((self._instance.master_public_dns_name, SSH_PORT))
166	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/ssh/aws/emr/models.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
212	            with open(absolute_file_path, 'r') as f:
213	                text = f.read()
214	                if text:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/ssh/aws/emr/models.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
284	        if connect:
285	            tunnel.connect()
286	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/ssh/aws/emr/models.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
287	        if reconnect:
288	            tunnel.reconnect()
289	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/ssh/aws/emr/models.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
309	    if tunnel:
310	        tunnel.close()
311	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/ssh/aws/emr/utils.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	    with open(absolute_file_path, 'w') as f:
133	        f.write(simplejson.dumps(
134	            data,
135	            default=encode_complex,
136	            ignore_nan=True,
137	        ))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/ssh/aws/emr/utils.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	        with open(absolute_file_path, 'r') as f:
146	            text = f.read()
147	            if text:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/constants.py:1
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	STITCH_BASE_URL = 'https://api.stitchdata.com/v4'
2	
3	DEFAULT_POLL_INTERVAL = 30
4	DEFAULT_POLL_TIMEOUT = 60 * 30  # 30 minutes

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
25	        if type(config) is dict:
26	            self.config = StitchConfig.load(config=config)
27	        else:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
34	    def list_sources(self):
35	        return self.make_request('/sources')
36	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
34	    def list_sources(self):
35	        return self.make_request('/sources')
36	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
37	    def get_source(self, source_id: int):
38	        return self.make_request(f'/sources/{source_id}')
39	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
37	    def get_source(self, source_id: int):
38	        return self.make_request(f'/sources/{source_id}')
39	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
40	    def list_streams(self, source_id: int, selected: bool = True):
41	        streams = self.make_request(f'/sources/{source_id}/streams')
42	        if selected:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
40	    def list_streams(self, source_id: int, selected: bool = True):
41	        streams = self.make_request(f'/sources/{source_id}/streams')
42	        if selected:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
46	    def list_destinations(self):
47	        return self.make_request('/destinations')
48	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
46	    def list_destinations(self):
47	        return self.make_request('/destinations')
48	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
49	    def get_destination(self, destination_id: int):
50	        return self.make_request(f'/destinations/{destination_id}')
51	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
49	    def get_destination(self, destination_id: int):
50	        return self.make_request(f'/destinations/{destination_id}')
51	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
52	    def list_extractions(self, stitch_client_id: int, page: int = 1):
53	        return self.make_request(f'/{stitch_client_id}/extractions', params=dict(page=page))
54	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
52	    def list_extractions(self, stitch_client_id: int, page: int = 1):
53	        return self.make_request(f'/{stitch_client_id}/extractions', params=dict(page=page))
54	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
55	    def list_loads(self, stitch_client_id: int, page: int = 1):
56	        return self.make_request(f'/{stitch_client_id}/loads', params=dict(page=page))
57	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
55	    def list_loads(self, stitch_client_id: int, page: int = 1):
56	        return self.make_request(f'/{stitch_client_id}/loads', params=dict(page=page))
57	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
182	    ):
183	        response = self.make_request(f'/sources/{source_id}/sync', method='POST', payload=dict())
184	        if 'error' in response:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
182	    ):
183	        response = self.make_request(f'/sources/{source_id}/sync', method='POST', payload=dict())
184	        if 'error' in response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/stitch/stitch.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	        url = f'{STITCH_BASE_URL}/{stitch_client_id}/extractions/{job_name}'
204	        response = requests.get(url, headers=self.headers)
205	        return response.text

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/teams/teams.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
11	    for url in config.webhook_url:
12	        requests.post(
13	            url=url,
14	            json={
15	                'summary': title,
16	                'sections': [{
17	                    'activityTitle': title,
18	                    'activitySubtitle': message,
19	                }],

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/services/telegram/telegram.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
16	
17	    requests.post(
18	        url=config.webhook_url,
19	        json=payload
20	    )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/settings/backends.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
89	                    binary = secret_response['SecretBinary']
90	                    return base64.b64decode(binary)
91	                else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/settings/backends.py:90
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
89	                    binary = secret_response['SecretBinary']
90	                    return base64.b64decode(binary)
91	                else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/settings/models/configuration_option.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	    async with aiofiles.open(full_path, mode='r') as f:
25	        content = await f.read()
26	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/settings/platform/__init__.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
413	
414	    safe_write(platform_settings_full_path(), content)
415	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/settings/platform/__init__.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
527	        with open(full_path, 'r', encoding='utf-8') as f:
528	            content = Template(f.read()).render(**get_template_vars_no_db())
529	            settings = yaml.full_load(content) or {}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/settings/platform/__init__.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
572	    content = yaml.dump(platform_settings)
573	    safe_write(full_path, content)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/settings/repo.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
202	                with open(metadata_path, 'r', encoding='utf-8') as f:
203	                    config_file_raw = f.read()
204	                    repo_config = load_yaml(config_file_raw) or {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/settings/server.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
186	
187	DEFAULT_LOCALHOST_URL = 'http://localhost:6789'
188	MAGE_PUBLIC_HOST = os.getenv('MAGE_PUBLIC_HOST') or DEFAULT_LOCALHOST_URL

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	            fh.seek(file_size - offset)
25	            buffer = fh.read(min(remaining_size, buf_size)).decode(encoding='utf-8')
26	            remaining_size -= buf_size

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	            f.seek(-2, os.SEEK_END)
52	            while f.read(1) != b'\n':
53	                f.seek(-2, os.SEEK_CUR)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
157	        try:
158	            return await file.read()
159	        except Exception as err:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
167	        try:
168	            shutil.rmtree(output_dir)
169	            if verbose:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
218	        async with aiofiles.open(path, 'w') as file:
219	            await file.write('' if data is None else data)
220	        return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
231	    try:
232	        await asyncio.to_thread(os.remove, path)
233	        return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
241	    try:
242	        return await asyncio.to_thread(os.path.exists, path)
243	    except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
253	    try:
254	        await asyncio.to_thread(shutil.move, old_path, new_path)
255	        return True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
268	    try:
269	        await asyncio.to_thread(os.rename, old_path, new_path)
270	        raise Exception(old_path, new_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/files.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
283	    async with aiofiles.open(file_path, 'r') as file:
284	        content = await file.read()
285	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/hash.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
235	    expression = f"__obj_to_set_value{key} = __value"
236	    exec(expression, results)
237	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/http_client.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	        if method == 'GET':
25	            response = requests.get(
26	                url,
27	                headers=self.headers,
28	                params=ignore_keys_with_blank_values(params),
29	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/http_client.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
30	        elif method == 'POST':
31	            response = requests.post(
32	                url,
33	                data=json.dumps(ignore_keys_with_blank_values(payload)),
34	                headers=self.headers,
35	            )

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/io.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
22	
23	        os.chmod(path, mode)
24	        for dirpath, _dirnames, filenames in os.walk(path):

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/io.py:23
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
22	
23	        os.chmod(path, mode)
24	        for dirpath, _dirnames, filenames in os.walk(path):

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/io.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
24	        for dirpath, _dirnames, filenames in os.walk(path):
25	            os.chmod(dirpath, mode)
26	            for filename in filenames:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/io.py:25
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
24	        for dirpath, _dirnames, filenames in os.walk(path):
25	            os.chmod(dirpath, mode)
26	            for filename in filenames:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/io.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
26	            for filename in filenames:
27	                os.chmod(os.path.join(dirpath, filename), mode)
28	    except Exception:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/io.py:27
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
26	            for filename in filenames:
27	                os.chmod(os.path.join(dirpath, filename), mode)
28	    except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/io.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	            else:
48	                fp.write(content)
49	        success = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/io.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	            else:
78	                await fp.write(content)
79	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/io.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
101	            f.seek(-2, os.SEEK_END)
102	            while f.read(1) != b'\n':
103	                f.seek(-2, os.SEEK_CUR)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/multi.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
23	def parallelize(func, arr):
24	    with ThreadPoolExecutor(max_workers=MAX_WORKERS) as pool:
25	        return pool.map(func, arr)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/multi.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
28	def parallelize_multiple_args(func, arr_args):
29	    with ThreadPoolExecutor(max_workers=MAX_WORKERS) as pool:
30	        return pool.map(func, *zip(*arr_args))

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/multi.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
33	def run_parallel_threads(list_of_funcs_and_args_or_kwargs):
34	    with ThreadPoolExecutor(max_workers=MAX_WORKERS) as pool:
35	        for func, args in list_of_funcs_and_args_or_kwargs:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/multi.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
39	def run_parallel(func, arr_args_1, arr_args_2):
40	    with ThreadPoolExecutor(max_workers=MAX_WORKERS) as pool:
41	        return pool.map(func, *arr_args_1, *arr_args_2)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/multi.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
44	def run_parallel_multiple_args(func, *args):
45	    with ThreadPoolExecutor(max_workers=MAX_WORKERS) as pool:
46	        return pool.map(func, *args)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/parsers.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
145	        buffer.seek(0)
146	        data = base64.b64encode(buffer.read()).decode('ascii')
147	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/parsers.py:146
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
145	        buffer.seek(0)
146	        data = base64.b64encode(buffer.read()).decode('ascii')
147	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/parsers.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
145	        buffer.seek(0)
146	        data = base64.b64encode(buffer.read()).decode('ascii')
147	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/parsers.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
152	    data = json_dict['__data__']
153	    data = base64.b64decode(data.encode('ascii'))
154	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/parsers.py:153
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
152	    data = json_dict['__data__']
153	    data = base64.b64decode(data.encode('ascii'))
154	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/shared/utils.py:171
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
170	    print(f'Checking port {port} on host {host}...')
171	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
172	        return s.connect_ex((host, port)) == 0

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/streaming/sinks/base.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
39	        """
40	        self.batch_write([message])
41	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/streaming/sinks/base.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
100	            for record in data:
101	                fp.write(json.dumps(record) + '\n')
102	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/streaming/sinks/generic_io.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	    def write(self, message: Dict):
57	        self.batch_write([message])
58	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/streaming/sinks/google_cloud_pubsub.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
65	        for message in messages:
66	            self.write(message)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/streaming/sinks/postgres.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
46	    def write(self, message: Dict):
47	        self.batch_write([message])
48	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/streaming/sinks/sink_factory.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
99	
100	        exec(content, {'streaming_sink': collect_decorated_objs(decorated_sinks)})
101	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/streaming/sources/nats_js.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
59	        self.loop = asyncio.new_event_loop()
60	        self.thread = threading.Thread(target=self.start_loop, daemon=True)
61	        self.thread.start()

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/streaming/sources/source_factory.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
72	
73	        exec(content, {'streaming_source': collect_decorated_objs(decorated_sources)})
74	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	        with open(self.log_path, 'a') as f:
117	            f.write(format_log_message(log_type=LogType.START, metadata=self.metadata))
118	            f.write(format_log_message(message=current_memory_usage()))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
117	            f.write(format_log_message(log_type=LogType.START, metadata=self.metadata))
118	            f.write(format_log_message(message=current_memory_usage()))
119	        return self

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
126	            with open(self.log_path, 'a') as f:
127	                f.write(format_log_message(message=current_memory_usage()))
128	                f.write(format_log_message(log_type=LogType.END, metadata=self.metadata))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	                f.write(format_log_message(message=current_memory_usage()))
128	                f.write(format_log_message(log_type=LogType.END, metadata=self.metadata))
129	        except Exception as err:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	        async with aiofiles.open(self.log_path, mode='a', encoding='utf-8') as fp:
148	            await fp.write(format_log_message(log_type=LogType.START, metadata=self.metadata))
149	            await fp.write(format_log_message(message=current_memory_usage()))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
148	            await fp.write(format_log_message(log_type=LogType.START, metadata=self.metadata))
149	            await fp.write(format_log_message(message=current_memory_usage()))
150	        return self

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
154	            async with aiofiles.open(self.log_path, mode='a', encoding='utf-8') as fp:
155	                await fp.write(format_log_message(message=current_memory_usage()))
156	                await fp.write(format_log_message(log_type=LogType.END, metadata=self.metadata))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
155	                await fp.write(format_log_message(message=current_memory_usage()))
156	                await fp.write(format_log_message(log_type=LogType.END, metadata=self.metadata))
157	        finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
161	        with open(self.log_path, 'a') as f:
162	            f.write(format_log_message(message=memory))
163	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/manager.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
165	        async with aiofiles.open(self.log_path, mode='a', encoding='utf-8') as fp:
166	            await fp.write(format_log_message(message=memory))
167	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/presenters.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	                with open(file_path, 'r') as file:
103	                    log_contents = file.read()
104	                    df = parse_log_to_polars(log_contents, process_uuid)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/process.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
17	            # Memory usage before
18	            proc = psutil.Process(process_id)
19	            mem_before = proc.memory_info().rss

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/process.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
64	    # Execute the code_string within the namespace
65	    exec(
66	        code_string, namespace, namespace
67	    )  # Now both global and local scopes are the same

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/process.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
96	        with open(file_path, 'r') as file:
97	            code_string = file.read()
98	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/process.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
98	
99	        p = Process(
100	            target=wrapped_func,
101	            args=(
102	                queue,
103	                code_string,
104	                func_name,
105	                *args,
106	            ),
107	            kwargs=kwargs,
108	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/utils.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
617	    stop_event = threading.Event()
618	    monitor_thread = threading.Thread(target=monitor)
619	    monitor_thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/system/memory/utils.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
652	    stop_event = threading.Event()
653	    monitor_thread = threading.Thread(target=thread_target, args=(monitor, new_loop))
654	    monitor_thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/api/endpoints/test_configuration_options.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	            result,
23	            json.loads(f.read()),
24	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/api/endpoints/test_configuration_options_project_platform.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	            result,
43	            json.loads(f.read()),
44	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/api/endpoints/test_custom_designs.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	            result,
23	            json.loads(f.read()),
24	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/api/endpoints/test_custom_designs.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	            result,
31	            json.loads(f.read())[0],
32	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/api/endpoints/test_custom_designs_project_platform.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
44	    with open(os.path.join(CURRENT_FILE_PATH, 'mocks', 'mock_design_project_platform.json')) as f:
45	        arr = json.loads(f.read())
46	        for item in arr:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/api/endpoints/test_custom_designs_project_platform.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
60	    with open(os.path.join(CURRENT_FILE_PATH, 'mocks', 'mock_design_project_platform.json')) as f:
61	        item = json.loads(f.read())[0]
62	        item['project']['full_path'] = os.path.join(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/api/endpoints/test_oauths.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    list_count=1,
27	    build_query=lambda self: dict(redirect_uri=['http://localhost:3000/pipelines']),
28	    result_keys_to_compare=[

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/api/endpoints/test_projects.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
22	        super().tearDown()
23	        shutil.rmtree(self.repo_path)
24	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/authentication/providers/test_active_directory.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	                url = args[0]
34	                if url == 'https://graph.microsoft.com/v1.0/me':
35	                    response.json.return_value = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/authentication/providers/test_active_directory.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	                elif url.startswith(
49	                    'https://graph.microsoft.com/v1.0/servicePrincipals?'
50	                ):
51	                    response.json.return_value = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/authentication/providers/test_active_directory.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	                elif url.startswith(
55	                    'https://graph.microsoft.com/v1.0/servicePrincipals/'
56	                ):
57	                    response.json.return_value = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/authentication/providers/test_active_directory.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	                elif url.startswith(
80	                    'https://graph.microsoft.com/v1.0/me/appRoleAssignments'
81	                ):
82	                    response.json.return_value = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/authentication/providers/test_oidc.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	                instance = OidcProvider()
28	                instance.userinfo_endpoint = 'http://fake.userinfo.endpoint'
29	
30	                # Set the roles_mapping object variable
31	                if case['use_roles_mapping']:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/authentication/providers/test_okta.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	test_parameters = [
8	    ('https://samples.auth0.com', 'test-client-id', 'test-client-secret'),
9	    ('samples.auth0.com', 'test-client-id', 'test-client-secret'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/authentication/providers/test_okta.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    def setUp(self):
17	        self.authorization_endpoint = 'https://samples.auth0.com/authorize'
18	        self.token_endpoint = 'https://samples.auth0.com/oauth/token'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/authentication/providers/test_okta.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        self.authorization_endpoint = 'https://samples.auth0.com/authorize'
18	        self.token_endpoint = 'https://samples.auth0.com/oauth/token'
19	        self.userinfo_endpoint = 'https://samples.auth0.com/userinfo'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/authentication/providers/test_okta.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	        self.token_endpoint = 'https://samples.auth0.com/oauth/token'
19	        self.userinfo_endpoint = 'https://samples.auth0.com/userinfo'
20	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/base_test.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
50	            if os.path.exists(self.repo_path):
51	                shutil.rmtree(self.repo_path)
52	            db_connection.close_session()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/base_test.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
80	        try:
81	            shutil.rmtree(self.repo_path)
82	            shutil.rmtree(get_variables_dir())

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/base_test.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
81	            shutil.rmtree(self.repo_path)
82	            shutil.rmtree(get_variables_dir())
83	        except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/base_test.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
119	        try:
120	            shutil.rmtree(self.repo_path)
121	            shutil.rmtree(get_variables_dir())

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/base_test.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
120	            shutil.rmtree(self.repo_path)
121	            shutil.rmtree(get_variables_dir())
122	        except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/cache/test_pipeline_cache.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	        with open(os.path.join(CURRENT_FILE_PATH, 'example_pipeline.json')) as f:
38	            self.pipeline_json = json.loads(f.read())['pipeline']
39	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/cluster_manager/kubernetes/test_workload_manager.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
24	        with open(pre_start_script_path, 'w') as f:
25	            f.write(
26	                """
27	def get_custom_configs(config):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/cluster_manager/kubernetes/test_workload_manager.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	        with open(pre_start_script_path, 'w') as f:
54	            f.write(
55	                """
56	def wrong_function_name(config):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/cluster_manager/kubernetes/test_workload_manager.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	        with open(pre_start_script_path, 'w') as f:
86	            f.write(
87	                """
88	def wrong_function_name(config):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/cluster_manager/kubernetes/test_workload_manager.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	        # Assert the expected result
134	        expected_result = 'https://example-host/example-path'
135	        self.assertEqual(result, expected_result)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/executors/test_block_executor.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
76	        analyze_outputs = False
77	        callback_url = 'http://example.com/callback'
78	        global_vars = {

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_block.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
29	            with open(fp, 'w') as f:
30	                f.write('')
31	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_dbt_adapter.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	        with (Path(self.project_dir) / 'dbt_project.yml').open("r+") as f:
33	            content = f"{f.read()}".format(
34	                project_name=self.project_name,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_dbt_adapter.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
37	            f.seek(0)
38	            f.write(content)
39	            f.truncate()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_dbt_adapter.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	        with Path(self.profiles_full_path).open('w') as f:
51	            f.write(profiles_yaml)
52	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_dbt_adapter.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
54	    def tearDownClass(self):
55	        shutil.rmtree(self.project_dir)
56	        super().tearDownClass()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_dbt_adapter.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	        with open(file_path, 'w') as f:
74	            f.write('')
75	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_dbt_adapter.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
156	        with open(file_path, 'w') as f:
157	            f.write('')
158	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_dbt_cli.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
71	    def tearDownClass(self):
72	        shutil.rmtree(self.project_dir)
73	        super().tearDownClass()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_profiles.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	
26	        profiles_yaml = """# https://docs.getdbt.com/reference/profiles.yml
27	base:
28	  outputs:
29	    dev:
30	      key1: {{ variables('key1') }}
31	      key2: {{ variables('key2') }}
32	      key3: {{ variables('key3') }}
33	target: dev
34	"""
35	        with Path(self.test_profiles_path).open('w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_profiles.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
35	        with Path(self.test_profiles_path).open('w') as f:
36	            f.write(profiles_yaml)
37	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_profiles.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	        with open(file_path, 'w') as f:
73	            f.write('')
74	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_profiles.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
94	                with interpolated_profiles_full_path.open('r') as f:
95	                    interpolated_profiles = yaml.safe_load(f.read())
96	                self.assertEqual(

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_project.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
43	        Path(self.test_demo_project_path).unlink()
44	        Path(self.test_demo_project_path).parent.rmdir()
45	        Path(self.test_packages_path).unlink()

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/dbt/test_sources.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
28	        (Path(self.repo_path) / 'models' / 'mage_sources.yml').unlink()
29	        (Path(self.repo_path) / 'models').rmdir()
30	        Path(self.test_project_path).unlink()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/platform/test_mixins.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
208	        with open(os.path.join(base_repo_path(), 'mage_platform', 'dbt_project.yml'), 'w') as f:
209	            f.write('')
210	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/platform/test_mixins.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
253	        with open(f'{self.repo_path}/dir3/dbt_project.yml', 'w') as f:
254	            f.write('')
255	        with open(f'{self.repo_path}/dir3/dir4/filename.sql', 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/platform/test_mixins.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
255	        with open(f'{self.repo_path}/dir3/dir4/filename.sql', 'w') as f:
256	            f.write('')
257	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/platform/test_mixins.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
448	        with open(os.path.join(base_repo_path(), 'mage_data/dbt/demo/models/users.sql'), 'w') as f:
449	            f.write('')
450	        with open(os.path.join(base_repo_path(), 'mage_data/dbt/dbt_project.yml'), 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/platform/test_mixins.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
450	        with open(os.path.join(base_repo_path(), 'mage_data/dbt/dbt_project.yml'), 'w') as f:
451	            f.write('')
452	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/platform/test_utils.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
52	        ) as f:
53	            f.write('')
54	        with open(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/platform/test_utils.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
57	        ) as f:
58	            f.write('')
59	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/platform/test_utils.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
67	        ) as f:
68	            f.write('')
69	        with open(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/block/platform/test_utils.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	        ) as f:
73	            f.write('')
74	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/global_hooks/test_global_hooks.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	        content = yaml.safe_dump(build_seed_data(self))
117	        safe_write(file_path, content)
118	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/global_hooks/test_global_hooks.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
557	        with open(global_hooks.file_path()) as f:
558	            data = yaml.safe_load(f.read())
559	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/global_hooks/test_global_hooks.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
622	                content = yaml.safe_dump(build_seed_data(self))
623	                safe_write(file_path, content)
624	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	        with open(block1.file_path, 'w') as file:
63	            file.write("""import pandas as pd
64	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	        with open(block2.file_path, 'w') as file:
71	            file.write("""import pandas as pd
72	@transformer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	        with open(block1.file_path, 'w') as file:
116	            file.write("""import pandas as pd
117	@preprocesser

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	        with open(block2.file_path, 'w') as file:
136	            file.write("""import pandas as pd
137	@transformer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
173	        with open(block1.file_path, 'w') as file:
174	            file.write("""import pandas as pd
175	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186	        with open(block2.file_path, 'w') as file:
187	            file.write("""import pandas as pd
188	@transformer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
234	        with open(block1.file_path, 'w') as file:
235	            file.write("""import pandas as pd
236	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
242	        with open(block2.file_path, 'w') as file:
243	            file.write("""import pandas as pd
244	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
250	        with open(block3.file_path, 'w') as file:
251	            file.write("""import pandas as pd
252	@transformer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
314	        with open(block1.file_path, 'w') as file:
315	            file.write("""import pandas as pd
316	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
322	        with open(block2.file_path, 'w') as file:
323	            file.write("""import pandas as pd
324	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
330	        with open(block3.file_path, 'w') as file:
331	            file.write("""import pandas as pd
332	@transformer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
346	        with open(block3.file_path, 'w') as file:
347	            file.write("""import pandas as pd
348	@transformer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
379	        with open(block1.file_path, 'w') as file:
380	            file.write("""import pandas as pd
381	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:388
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
387	        with open(block2.file_path, 'w') as file:
388	            file.write("""import pandas as pd
389	@sensor

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
410	        with open(block1.file_path, 'w') as file:
411	            file.write("""import pandas as pd
412	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
419	        with open(block1.callback_block.file_path, 'w') as file:
420	            file.write("""
421	@on_success

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
440	        with open(block1.file_path, 'w') as file:
441	            file.write("""import pandas as pd
442	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
447	        with open(block1.callback_block.file_path, 'w') as file:
448	            file.write("""
449	@on_failure

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
629	        with open(block.file_path, 'w') as file:
630	            file.write("""import pandas as pd
631	if 'data_loader' not in globals():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_block.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
652	        with open(block.file_path, 'w') as file:
653	            file.write("""import pandas as pd
654	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_file.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	        with open(file_path, 'w') as f:
49	            f.write('')
50	        self.assertFalse(File.create_parent_directories(file_path))

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_file.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
50	        self.assertFalse(File.create_parent_directories(file_path))
51	        shutil.rmtree(os.path.dirname(file_path))
52	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_file.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
57	        try:
58	            shutil.rmtree(os.path.join(base_repo_path(), 'demo'))
59	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_file.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
61	        try:
62	            shutil.rmtree(os.path.join(base_repo_path(), 'mage_platform'))
63	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_pipeline.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
782	        self.assertTrue(all([uuid in pipelines for uuid in [pipeline3.uuid, pipeline4.uuid]]))
783	        shutil.rmtree(os.path.join(base_repo_path(), 'mage_platform'))
784	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_pipeline.py:798
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
797	
798	        shutil.rmtree(os.path.join(base_repo_path(), 'mage_data1'))
799	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_pipeline.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
882	        with open(block.file_path, 'w') as file:
883	            file.write('''import pandas as pd
884	@data_loader

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_pipeline.py:901
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
900	        with open(block.file_path, 'w') as file:
901	            file.write('''import pandas as pd
902	@transformer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_pipeline.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
916	        with open(block.file_path, 'w') as file:
917	            file.write('''import pandas as pd
918	@data_exporter

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_pipeline.py:933
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
932	        with open(block.file_path, 'w') as file:
933	            file.write(
934	                '''import antigravity
935	            '''

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/models/test_project.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
130	        content = yaml.dump(SETTINGS)
131	        safe_write(platform_settings_full_path(), content)
132	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/storage/shared/test_secrets.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	        with open(os.path.join(data_dir, 'secrets', 'uuid'), 'w') as f:
78	            f.write('  ' + key_uuid + '\n ')
79	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/storage/shared/test_secrets.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
105	                    content = yaml.dump(SETTINGS)
106	                    safe_write(platform_settings_full_path(), content)
107	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/storage/shared/test_secrets.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
114	                    try:
115	                        shutil.rmtree(platform_settings_full_path())
116	                    except Exception:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/storage/shared/test_secrets.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
158	                content = yaml.dump(SETTINGS)
159	                safe_write(platform_settings_full_path(), content)
160	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/sync/test_git_sync.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
20	        with open(os.path.join(self.repo_path, '.preferences.yaml'), 'w') as f:
21	            f.write('test: 123\n')
22	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/sync/test_git_sync.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	        with open(os.path.join(self.repo_path, '.preferences.yaml'), 'w') as f:
41	            f.write('test: 123\n')
42	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_repo_manager.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
35	        )
36	        shutil.rmtree(test1.variables_dir)
37	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_repo_manager.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
49	        )
50	        shutil.rmtree(test2.variables_dir)
51	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_repo_manager.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
58	        del os.environ[MAGE_DATA_DIR_ENV_VAR]
59	        shutil.rmtree(test4.variables_dir)
60	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_repo_manager.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
66	        )
67	        shutil.rmtree(test.variables_dir)
68	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_repo_manager.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
94	        test_dir = os.path.expanduser(os.path.join('~', dir_name))
95	        shutil.rmtree(test_dir)
96	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_repo_manager_project_platform.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
57	        try:
58	            shutil.rmtree(path)
59	        except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_repo_manager_project_platform.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
64	        try:
65	            shutil.rmtree(path)
66	        except Exception:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_templates.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
126	    def test_template_generation_data_loader_specific(self):
127	        redshift_template = """from mage_ai.settings.repo import get_repo_path
128	from mage_ai.io.config import ConfigFileLoader
129	from mage_ai.io.redshift import Redshift
130	from os import path
131	if 'data_loader' not in globals():
132	    from mage_ai.data_preparation.decorators import data_loader
133	if 'test' not in globals():
134	    from mage_ai.data_preparation.decorators import test
135	
136	
137	@data_loader
138	def load_data_from_redshift(*args, **kwargs):
139	    \"\"\"
140	    Template for loading data from a Redshift cluster.
141	    Specify your configuration settings in 'io_config.yaml'.
142	
143	    Docs: https://docs.mage.ai/design/data-loading#redshift
144	    \"\"\"
145	    query = 'your_redshift_selection_query'
146	    config_path = path.join(get_repo_path(), 'io_config.yaml')
147	    config_profile = 'default'
148	
149	    with Redshift.with_config(ConfigFileLoader(config_path, config_profile)) as loader:
150	        return loader.load(query)
151	
152	
153	@test
154	def test_output(output, *args) -> None:
155	    \"\"\"
156	    Template code for testing the output of the block.
157	    \"\"\"
158	    assert output is not None, 'The output is undefined'
159	"""
160	        s3_template = """from mage_ai.settings.repo import get_repo_path

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_templates.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	"""
160	        s3_template = """from mage_ai.settings.repo import get_repo_path
161	from mage_ai.io.config import ConfigFileLoader
162	from mage_ai.io.s3 import S3
163	from os import path
164	if 'data_loader' not in globals():
165	    from mage_ai.data_preparation.decorators import data_loader
166	if 'test' not in globals():
167	    from mage_ai.data_preparation.decorators import test
168	
169	
170	@data_loader
171	def load_from_s3_bucket(*args, **kwargs):
172	    \"\"\"
173	    Template for loading data from a S3 bucket.
174	    Specify your configuration settings in 'io_config.yaml'.
175	
176	    Docs: https://docs.mage.ai/design/data-loading#s3
177	    \"\"\"
178	    config_path = path.join(get_repo_path(), 'io_config.yaml')
179	    config_profile = 'default'
180	
181	    bucket_name = 'your_bucket_name'
182	    object_key = 'your_object_key'
183	
184	    return S3.with_config(ConfigFileLoader(config_path, config_profile)).load(
185	        bucket_name,
186	        object_key,
187	    )
188	
189	
190	@test
191	def test_output(output, *args) -> None:
192	    \"\"\"
193	    Template code for testing the output of the block.
194	    \"\"\"
195	    assert output is not None, 'The output is undefined'
196	"""
197	
198	        config1 = {'data_source': DataSource.REDSHIFT}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_templates.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
320	    def test_template_generation_transformer_action_simple(self):
321	        expected_template = """from mage_ai.data_cleaner.transformer_actions.base import BaseAction
322	from mage_ai.data_cleaner.transformer_actions.constants import ActionType, Axis
323	from mage_ai.data_cleaner.transformer_actions.utils import build_transformer_action
324	from pandas import DataFrame
325	
326	if 'transformer' not in globals():
327	    from mage_ai.data_preparation.decorators import transformer
328	if 'test' not in globals():
329	    from mage_ai.data_preparation.decorators import test
330	
331	
332	@transformer
333	def execute_transformer_action(df: DataFrame, *args, **kwargs) -> DataFrame:
334	    \"\"\"
335	    Execute Transformer Action: ActionType.CLEAN_COLUMN_NAME
336	
337	    Docs: https://docs.mage.ai/guides/transformer-blocks#clean-column-names
338	    \"\"\"
339	    action = build_transformer_action(
340	        df,
341	        action_type=ActionType.CLEAN_COLUMN_NAME,
342	        arguments=df.columns,
343	        axis=Axis.COLUMN,
344	    )
345	
346	    return BaseAction(action).execute(df)
347	
348	
349	@test
350	def test_output(output, *args) -> None:
351	    \"\"\"
352	    Template code for testing the output of the block.
353	    \"\"\"
354	    assert output is not None, 'The output is undefined'
355	"""
356	
357	        config = {'action_type': ActionType.CLEAN_COLUMN_NAME, 'axis': Axis.COLUMN}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_templates.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	    def test_template_generation_transformer_action_action_code(self):
362	        expected_template = """from mage_ai.data_cleaner.transformer_actions.base import BaseAction
363	from mage_ai.data_cleaner.transformer_actions.constants import ActionType, Axis
364	from mage_ai.data_cleaner.transformer_actions.utils import build_transformer_action
365	from pandas import DataFrame
366	
367	if 'transformer' not in globals():
368	    from mage_ai.data_preparation.decorators import transformer
369	if 'test' not in globals():
370	    from mage_ai.data_preparation.decorators import test
371	
372	
373	@transformer
374	def execute_transformer_action(df: DataFrame, *args, **kwargs) -> DataFrame:
375	    \"\"\"
376	    Execute Transformer Action: ActionType.FILTER
377	
378	    Docs: https://docs.mage.ai/guides/transformer-blocks#filter
379	    \"\"\"
380	    action = build_transformer_action(
381	        df,
382	        action_type=ActionType.FILTER,
383	        axis=Axis.ROW,
384	        action_code='',  # Specify your filtering code here
385	    )
386	
387	    return BaseAction(action).execute(df)
388	
389	
390	@test
391	def test_output(output, *args) -> None:
392	    \"\"\"
393	    Template code for testing the output of the block.
394	    \"\"\"
395	    assert output is not None, 'The output is undefined'
396	"""
397	
398	        config = {'action_type': ActionType.FILTER, 'axis': Axis.ROW}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_templates.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
402	    def test_template_generation_transformer_action_action_options(self):
403	        expected_template = """from mage_ai.data_cleaner.transformer_actions.base import BaseAction
404	from mage_ai.data_cleaner.transformer_actions.constants import ActionType, Axis
405	from mage_ai.data_cleaner.transformer_actions.utils import build_transformer_action
406	from pandas import DataFrame
407	
408	if 'transformer' not in globals():
409	    from mage_ai.data_preparation.decorators import transformer
410	if 'test' not in globals():
411	    from mage_ai.data_preparation.decorators import test
412	
413	
414	@transformer
415	def execute_transformer_action(df: DataFrame, *args, **kwargs) -> DataFrame:
416	    \"\"\"
417	    Execute Transformer Action: ActionType.REFORMAT
418	
419	    Docs: https://docs.mage.ai/guides/transformer-blocks#reformat-values
420	    \"\"\"
421	    action = build_transformer_action(
422	        df,
423	        action_type=ActionType.REFORMAT,
424	        arguments=[],  # Specify columns to reformat
425	        axis=Axis.COLUMN,
426	        options={'reformat': None},  # Specify reformat action,
427	    )
428	
429	    return BaseAction(action).execute(df)
430	
431	
432	@test
433	def test_output(output, *args) -> None:
434	    \"\"\"
435	    Template code for testing the output of the block.
436	    \"\"\"
437	    assert output is not None, 'The output is undefined'
438	"""
439	
440	        config = {'action_type': ActionType.REFORMAT, 'axis': Axis.COLUMN}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_templates.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
444	    def test_template_generation_transformer_action_outputs(self):
445	        expected_template = """from mage_ai.data_cleaner.transformer_actions.base import BaseAction
446	from mage_ai.data_cleaner.transformer_actions.constants import ActionType, Axis
447	from mage_ai.data_cleaner.transformer_actions.utils import build_transformer_action
448	from pandas import DataFrame
449	
450	if 'transformer' not in globals():
451	    from mage_ai.data_preparation.decorators import transformer
452	if 'test' not in globals():
453	    from mage_ai.data_preparation.decorators import test
454	
455	
456	@transformer
457	def execute_transformer_action(df: DataFrame, *args, **kwargs) -> DataFrame:
458	    \"\"\"
459	    Execute Transformer Action: ActionType.FIRST
460	
461	    Docs: https://docs.mage.ai/guides/transformer-blocks#aggregation-actions
462	    \"\"\"
463	    action = build_transformer_action(
464	        df,
465	        action_type=ActionType.FIRST,
466	        action_code='',  # Enter filtering condition on rows before aggregation
467	        arguments=[],  # Enter the columns to compute aggregate over
468	        axis=Axis.COLUMN,
469	        options={'groupby_columns': []},  # Enter columns to group by
470	        outputs=[
471	            # The number of outputs below must match the number of arguments
472	            {'uuid': 'new_aggregate_column', 'column_type': 'category'},
473	        ],
474	    )
475	
476	    return BaseAction(action).execute(df)
477	
478	
479	@test
480	def test_output(output, *args) -> None:
481	    \"\"\"
482	    Template code for testing the output of the block.
483	    \"\"\"
484	    assert output is not None, 'The output is undefined'
485	"""
486	
487	        config = {'action_type': ActionType.FIRST, 'axis': Axis.COLUMN}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_templates.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
521	    def test_template_generation_data_exporter_specific(self):
522	        bigquery_template = """from mage_ai.settings.repo import get_repo_path
523	from mage_ai.io.bigquery import BigQuery
524	from mage_ai.io.config import ConfigFileLoader
525	from pandas import DataFrame
526	from os import path
527	
528	if 'data_exporter' not in globals():
529	    from mage_ai.data_preparation.decorators import data_exporter
530	
531	
532	@data_exporter
533	def export_data_to_big_query(df: DataFrame, **kwargs) -> None:
534	    \"\"\"
535	    Template for exporting data to a BigQuery warehouse.
536	    Specify your configuration settings in 'io_config.yaml'.
537	
538	    Docs: https://docs.mage.ai/design/data-loading#bigquery
539	    \"\"\"
540	    table_id = 'your-project.your_dataset.your_table_name'
541	    config_path = path.join(get_repo_path(), 'io_config.yaml')
542	    config_profile = 'default'
543	
544	    BigQuery.with_config(ConfigFileLoader(config_path, config_profile)).export(
545	        df,
546	        table_id,
547	        if_exists='replace',  # Specify resolution policy if table name already exists
548	    )
549	"""
550	        snowflake_template = """from mage_ai.settings.repo import get_repo_path

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_templates.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
549	"""
550	        snowflake_template = """from mage_ai.settings.repo import get_repo_path
551	from mage_ai.io.config import ConfigFileLoader
552	from mage_ai.io.snowflake import Snowflake
553	from pandas import DataFrame
554	from os import path
555	
556	if 'data_exporter' not in globals():
557	    from mage_ai.data_preparation.decorators import data_exporter
558	
559	
560	@data_exporter
561	def export_data_to_snowflake(df: DataFrame, **kwargs) -> None:
562	    \"\"\"
563	    Template for exporting data to a Snowflake warehouse.
564	    Specify your configuration settings in 'io_config.yaml'.
565	
566	    Docs: https://docs.mage.ai/design/data-loading#snowflake
567	    \"\"\"
568	    table_name = 'your_table_name'
569	    database = 'your_database_name'
570	    schema = 'your_schema_name'
571	    config_path = path.join(get_repo_path(), 'io_config.yaml')
572	    config_profile = 'default'
573	
574	    with Snowflake.with_config(ConfigFileLoader(config_path, config_profile)) as loader:
575	        loader.export(
576	            df,
577	            table_name,
578	            database,
579	            schema,
580	            if_exists='replace',  # Specify resolution policy if table already exists
581	        )
582	"""
583	
584	        config1 = {'data_source': DataSource.BIGQUERY}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/data_preparation/test_templates.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
591	    def test_template_generation_data_exporter_streaming(self):
592	        opensearch_template = """connector_type: opensearch
593	host: https://[cluster_name].[region].es.amazonaws.com
594	index_name: test_index
595	
596	# # Whether to verify SSL certificates to authenticate.
597	# verify_certs: true
598	
599	# # Authentication setting
600	# # 1. "@awsauth": Authenticate with AWS Signature Version 4. Need to provide
601	# #.             AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY in environment variables.
602	# # 2. "username:password": Authenticate with username and password.
603	# http_auth: "@awsauth"
604	"""
605	        config = {'data_source': DataSource.OPENSEARCH}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/factory.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
87	    ) as f:
88	        config = f.read()
89	        with open(pipeline.catalog_config_path, 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/factory.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	        with open(pipeline.catalog_config_path, 'w') as f:
90	            f.write(config)
91	    block1 = Block.create(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/factory.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	    with open(block1.file_path, 'w') as f:
98	        f.write(
99	            """config:
100	  host: host

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/factory.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
117	    with open(block3.file_path, 'w') as f:
118	        f.write(
119	            """config:
120	  database: postgres

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/orchestration/db/models/test_schedules.py:1866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1865	                with open(os.path.join(self.repo_path, 'test.log'), 'w') as f:
1866	                    f.write('test')
1867	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/orchestration/db/models/test_schedules.py:1897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1896	                with open(os.path.join(self.repo_path, 'test.log'), 'r') as f:
1897	                    self.assertEqual(f.read(), 'test')
1898	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/orchestration/db/models/test_schedules.py:1972
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1971	                with open(os.path.join(self.repo_path, 'test.log'), 'w') as f:
1972	                    f.write('test')
1973	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/orchestration/db/models/test_schedules.py:2004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2003	                with open(os.path.join(self.repo_path, 'test.log'), 'r') as f:
2004	                    self.assertEqual(f.read(), 'test')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/orchestration/notification/test_sender.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	        email_content += (
40	            '\nOpen http://localhost:6789/pipelines/test_pipeline/runs/'
41	            f'{pipeline_run.id} to check pipeline run results and logs.'
42	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/orchestration/notification/test_sender.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	        message = (
58	            'Failed to run Pipeline `test_pipeline` '
59	            f'with Trigger {pipeline_run.pipeline_schedule.id} '
60	            f'`{pipeline_run.pipeline_schedule.name}` '
61	            f'at execution time `{pipeline_run.execution_date}`. Error: None\n'
62	            f'Open http://localhost:6789/pipelines/test_pipeline/runs/'
63	            f'{pipeline_run.id} to check pipeline run results and logs.'
64	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/orchestration/notification/test_sender.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	        message = (
86	            'Failed to execute pipeline http://localhost:6789/pipelines/test_pipeline/runs/'
87	            f'{pipeline_run.id}. Pipeline uuid: test_pipeline. '
88	            f'Trigger name: {pipeline_run.pipeline_schedule.name}.'
89	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/server/test_server.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
88	        with open(os.path.join(test_dir, 'index.html'), 'r') as f:
89	            self.assertNotEqual(f.read().find('random-test-string-1hasdfh'), 0)
90	        shutil.rmtree(test_dir)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/server/test_server.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
89	            self.assertNotEqual(f.read().find('random-test-string-1hasdfh'), 0)
90	        shutil.rmtree(test_dir)
91	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/server/test_server.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
104	        self.assertTrue(len(os.listdir(test_dir)) > 0)
105	        shutil.rmtree(test_dir)
106	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/server/test_server.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
118	        self.assertTrue(len(os.listdir(os.path.join(test_dir, 'test'))) > 0)
119	        shutil.rmtree(test_dir)
120	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/services/k8s/test_job_manager.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
261	            'image_pull_policy': 'Always',
262	            'env': [dict(name='spark_host', value='127.0.0.1')],
263	            'resources': dict(limits={'cpu': '1000m'}, requests={'cpu': '500m'}),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/services/k8s/test_job_manager.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
274	        self.assertEqual(job.spec.template.spec.containers[0].env, [
275	            dict(name='spark_host', value='127.0.0.1'),
276	            V1EnvVar(name='VAR1', value='VALUE1'),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
30	            with open(os.path.join(CURRENT_FILE_PATH, 'test_profiles1.yml')) as f2:
31	                f.write(f2.read())
32	        with open(os.path.join(self.directory, 'dir1', 'dbt_project.yml'), 'w') as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	            with open(os.path.join(CURRENT_FILE_PATH, 'test_profiles1.yml')) as f2:
31	                f.write(f2.read())
32	        with open(os.path.join(self.directory, 'dir1', 'dbt_project.yml'), 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
33	            with open(os.path.join(CURRENT_FILE_PATH, 'test_dbt_project1.yml')) as f2:
34	                f.write(f2.read())
35	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	            with open(os.path.join(CURRENT_FILE_PATH, 'test_dbt_project1.yml')) as f2:
34	                f.write(f2.read())
35	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
37	            with open(os.path.join(CURRENT_FILE_PATH, 'test_profiles2.yml')) as f2:
38	                f.write(f2.read())
39	        with open(os.path.join(self.directory, 'dir2', 'dbt_project.yml'), 'w') as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	            with open(os.path.join(CURRENT_FILE_PATH, 'test_profiles2.yml')) as f2:
38	                f.write(f2.read())
39	        with open(os.path.join(self.directory, 'dir2', 'dbt_project.yml'), 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	            with open(os.path.join(CURRENT_FILE_PATH, 'test_dbt_project2.yml')) as f2:
41	                f.write(f2.read())
42	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
40	            with open(os.path.join(CURRENT_FILE_PATH, 'test_dbt_project2.yml')) as f2:
41	                f.write(f2.read())
42	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
44	            with open(os.path.join(CURRENT_FILE_PATH, 'test_profiles2.yml')) as f2:
45	                f.write(f2.read())
46	        with open(os.path.join(self.directory, 'dbt', 'dir2', 'dbt_project.yml'), 'w') as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
44	            with open(os.path.join(CURRENT_FILE_PATH, 'test_profiles2.yml')) as f2:
45	                f.write(f2.read())
46	        with open(os.path.join(self.directory, 'dbt', 'dir2', 'dbt_project.yml'), 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	            with open(os.path.join(CURRENT_FILE_PATH, 'test_dbt_project2.yml')) as f2:
48	                f.write(f2.read())
49	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	            with open(os.path.join(CURRENT_FILE_PATH, 'test_dbt_project2.yml')) as f2:
48	                f.write(f2.read())
49	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
51	        try:
52	            shutil.rmtree(self.directory)
53	        except Exception as err:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	            results = [o.to_dict() for o in options]
65	            arr = json.loads(f.read())
66	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	                        results = [o.to_dict() for o in options]
90	                        arr = json.loads(f.read())
91	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
122	            results = [o.to_dict() for o in options]
123	            arr = json.loads(f.read())
124	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/models/test_configuration_option.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
164	                        results = [o.to_dict() for o in options]
165	                        arr = json.loads(f.read())
166	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/test_platform.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
81	        with open(platform_settings_full_path()) as f:
82	            content = Template(f.read()).render(**get_template_vars_no_db())
83	            self.settings = yaml.full_load(content) or {}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/settings/test_platform.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
87	        with open(local_platform_settings_full_path()) as f:
88	            content = Template(f.read()).render(**get_template_vars_no_db())
89	            self.settings_local = yaml.full_load(content) or {}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/mixins.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
361	        ))
362	        safe_write(platform_settings_full_path(), content)
363	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/mixins.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
368	        ))
369	        safe_write(local_platform_settings_full_path(), content)
370	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/mixins.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
408	                try:
409	                    shutil.rmtree(platform_settings_full_path())
410	                except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/mixins.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
412	                try:
413	                    shutil.rmtree(local_platform_settings_full_path())
414	                except Exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/mixins.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
431	    if os.path.exists(dbt_directory):
432	        shutil.rmtree(dbt_directory)
433	    shutil.copytree(source_dir, dbt_directory)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/mixins.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
441	        if os.path.exists(dbt_directory):
442	            shutil.rmtree(dbt_directory)
443	    except Exception as err:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_files.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
21	        with open(os.path.join(self.directory, 'dir1', 'file1.txt'), 'w') as f:
22	            f.write('file1')
23	        with open(os.path.join(self.directory, 'dir2', 'file2.txt'), 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_files.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	        with open(os.path.join(self.directory, 'dir2', 'file2.txt'), 'w') as f:
24	            f.write('file2')
25	        with open(os.path.join(self.directory, 'dir2', 'dir3', 'file2_3.txt'), 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_files.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
25	        with open(os.path.join(self.directory, 'dir2', 'dir3', 'file2_3.txt'), 'w') as f:
26	            f.write('file2_3')
27	        with open(os.path.join(self.directory, 'dir4', 'file4'), 'w') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_files.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
27	        with open(os.path.join(self.directory, 'dir4', 'file4'), 'w') as f:
28	            f.write('file4')
29	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_files.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
30	    def tearDown(self):
31	        shutil.rmtree(self.directory)
32	        super().tearDown()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
16	        with open(file_path, 'w') as fp:
17	            fp.write('MESSAGE1')
18	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
19	        target_mode = stat.S_IRWXU
20	        chmod(file_path, target_mode)
21	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
32	        with open(file_path, 'w') as fp:
33	            fp.write('MESSAGE1')
34	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
34	
35	        safe_write(file_path, 'MESSAGE2')
36	        with open(file_path, 'r') as fp:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
36	        with open(file_path, 'r') as fp:
37	            self.assertEqual(fp.read(), 'MESSAGE2')
38	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
42	        with self.assertRaises(Exception) as err:
43	            safe_write(file_path, 'MESSAGE3', write_func=write_func)
44	            self.assertTrue('Fail to write' in str(err.exception))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
45	        with open(file_path, 'r') as fp:
46	            self.assertEqual(fp.read(), 'MESSAGE2')
47	        os.remove(file_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	        with open(file_path, 'w') as fp:
52	            fp.write('MESSAGE1')
53	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
56	            with open(file_path, 'r') as fp:
57	                self.assertEqual(fp.read(), 'MESSAGE2')
58	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/shared/test_io.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	            with open(file_path, 'r') as fp:
66	                self.assertEqual(fp.read(), 'MESSAGE2')
67	        except RuntimeError as err:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/streaming/sinks/test_influxdb.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	            InfluxDbSink(dict(
10	                url='http://localhost:8086',
11	                token='my-token',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/streaming/sinks/test_influxdb.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	                InfluxDbSink(dict(
20	                    url='http://localhost:80863',
21	                    token='my-token',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/streaming/sources/test_influxdb.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	                dict(
12	                    url='http://localhost:8086',
13	                    token='my-token',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/tests/streaming/sources/test_influxdb.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	                    dict(
24	                        url='http://localhost:80863',
25	                        token='my-token',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/constants.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	
3	API_ENDPOINT = 'https://api.mage.ai/v1/usage_statistics'
4	
5	
6	class EventNameType(StrEnum):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	        created_from = None
76	        if block_action_object and block_action_object.get('object_type'):
77	            created_from = 'block_action_object'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	            created_from = 'block_action_object'
78	            object_type = block_action_object.get('object_type')
79	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	            created_from = 'replicated_block'
90	        elif payload_config and payload_config.get('template_path'):
91	            created_from = 'mage_template'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	
100	            if block_action_object and block_action_object.get('object_type'):
101	                event_properties['action_properties']['block_action_object_type'] = \

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	                event_properties['action_properties']['block_action_object_type'] = \
102	                    block_action_object.get('object_type')
103	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	
104	            if payload_config and payload_config.get('template_path'):
105	                event_properties['action_properties']['template_path'] = payload_config.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
104	            if payload_config and payload_config.get('template_path'):
105	                event_properties['action_properties']['template_path'] = payload_config.get(
106	                    'template_path',
107	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	                event_properties['pipeline'] = dict(
148	                    type=custom_template.pipeline.get('type'),
149	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
346	            trigger_method=pipeline_schedule.schedule_type,
347	            unique_block_types=list(set([b.get('type') for b in block_configs])),
348	            unique_languages=list(set([b.get('language') for b in block_configs])),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
347	            unique_block_types=list(set([b.get('type') for b in block_configs])),
348	            unique_languages=list(set([b.get('language') for b in block_configs])),
349	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
454	            trigger_method=pipeline_schedule.schedule_type,
455	            unique_block_types=list(set([b.get('type') for b in block_configs])),
456	            unique_languages=list(set([b.get('language') for b in block_configs])),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
455	            unique_block_types=list(set([b.get('type') for b in block_configs])),
456	            unique_languages=list(set([b.get('language') for b in block_configs])),
457	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
485	
486	        if project_uuid and not data_to_send.get('project_uuid'):
487	            data_to_send['project_uuid'] = project_uuid

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
490	            async with aiohttp.ClientSession() as session:
491	                async with session.post(
492	                    API_ENDPOINT,
493	                    json=dict(
494	                        api_key=AMPLITUDE_API_KEY,
495	                        event_name=event_name,
496	                        usage_statistics=data_to_send,
497	                    ),
498	                    timeout=3,
499	                ) as response:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
500	                    response_json = await response.json()
501	                    if response_json.get('success'):
502	                        if is_debug():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
530	
531	        if project_uuid and not data_to_send.get('project_uuid'):
532	            data_to_send['project_uuid'] = project_uuid

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:535
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
534	        try:
535	            response = requests.post(
536	                API_ENDPOINT,
537	                json={
538	                    'api_key': AMPLITUDE_API_KEY,
539	                    'event_name': event_name,
540	                    'usage_statistics': data_to_send,
541	                },
542	                timeout=3
543	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
545	            response_json = response.json()
546	            if response_json.get('success'):
547	                if is_debug():

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
564	        try:
565	            return socket.gethostbyname(socket.gethostname())
566	        except Exception:

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/usage_statistics/logger.py:565
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
564	        try:
565	            return socket.gethostbyname(socket.gethostname())
566	        except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/version_control/models.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
84	
85	        output = await proc.stdout.read()
86	        return self.add_outputs(output.decode().split('\n') if output else output)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/version_control/models.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
706	        if os.path.exists(git_path):
707	            shutil.rmtree(git_path)
708	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/setup.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    long_description_content_type='text/markdown',
27	    url='https://github.com/mage-ai/mage-ai',
28	    packages=setuptools.find_packages('.'),

--------------------------------------------------

Code scanned:
	Total lines of code: 149052
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 129.0
		High: 704.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 790.0
		High: 43.0
Files skipped (53):
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_exporters/deltalake/azure_blob_storage.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_exporters/deltalake/gcs.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_exporters/deltalake/s3.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/airtable.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/algolia.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/api.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/azure_blob_storage.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/bigquery.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/chroma.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/deltalake/azure_blob_storage.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/deltalake/gcs.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/deltalake/s3.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/druid.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/duckdb.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/file.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/google_cloud_storage.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/google_sheets.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/mongodb.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/mssql.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/mysql.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/oracledb.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/pinot.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/postgres.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/pyspark/s3.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/qdrant.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/redshift.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/s3.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/snowflake.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/data_loaders/weaviate.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/average.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/clean_column_name.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/count.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/count_distinct.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/diff.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/first.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/fix_syntax_errors.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/impute.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/last.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/median.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/min.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/normalize.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/reformat.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/remove.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/remove_outliers.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/select.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/shift_down.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/shift_up.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/standardize.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/column/sum.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/row/drop_duplicate.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/row/filter.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/row/remove.py (syntax error while parsing AST from file)
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/mage_ai-0.9.76/mage_ai-0.9.76/mage_ai/data_preparation/templates/transformers/transformer_actions/row/sort.py (syntax error while parsing AST from file)
