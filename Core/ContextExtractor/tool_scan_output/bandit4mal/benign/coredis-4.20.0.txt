Run started:2025-04-12 10:32:03.392485

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/client/keydb.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	    return (
51	        f"`{str(command)} <https://docs.keydb.dev/docs/commands#{canonical_command}>`_"
52	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/commands/_utils.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	def redis_command_link(command: CommandName) -> str:
117	    return f'`{str(command)} <https://redis.io/commands/{str(command).lower().replace(" ", "-")}>`_'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/commands/function.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
312	                    raise RuntimeError(
313	                        f"{instance.__class__.__name__} is not a subclass of"
314	                        " coredis.commands.function.Library therefore it's methods cannot be bound "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/commands/pubsub.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
218	            # do not retry if coroutine is cancelled
219	            if await connection.can_read():  # noqa
220	                connection.disconnect()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/commands/pubsub.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
437	                raise PubSubError(f"Pattern: {pattern!r} has no handler registered")
438	        thread = PubSubWorkerThread(self, poll_timeout=poll_timeout)
439	        thread.start()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
75	        if future.cancelled() and self.connection and self.connection.is_connected:
76	            self.connection.disconnect()
77	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
250	        try:
251	            self.disconnect()
252	        except Exception:  # noqa

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
299	        if not self.is_connected:
300	            await self.connect()
301	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
301	
302	        return self._parser.can_read()
303	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
301	
302	        return self._parser.can_read()
303	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
310	        try:
311	            await self._connect()
312	        except (asyncio.CancelledError, RedisError) as err:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
339	
340	        self.disconnect()
341	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
399	        """
400	        self.disconnect()
401	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
519	    async def on_connect(self) -> None:
520	        self._parser.on_connect(self)
521	        await self.perform_handshake()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
562	        if not self.is_connected:
563	            await self.connect()
564	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
606	            if self._transport:
607	                self.disconnect()
608	            raise TimeoutError(

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
622	        if not self.is_connected:
623	            await self.connect()
624	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
644	        if not self.is_connected:
645	            await self.connect()
646	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
691	        if not self.is_connected:
692	            await self.connect()
693	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
727	        self.noreply_set = False
728	        self._parser.on_disconnect()
729	        if self._transport:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:731
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
730	            try:
731	                self._transport.close()
732	            # Raised if event loop is already closed.

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:754
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
753	        self,
754	        host: str = "127.0.0.1",
755	        port: int = 6379,
756	        username: Optional[str] = None,
757	        password: Optional[str] = None,
758	        credential_provider: Optional[AbstractCredentialProvider] = None,
759	        db: Optional[int] = 0,
760	        stream_timeout: Optional[float] = None,
761	        connect_timeout: Optional[float] = None,
762	        ssl_context: Optional[ssl.SSLContext] = None,
763	        encoding: str = "utf-8",
764	        decode_responses: bool = False,
765	        socket_keepalive: Optional[bool] = None,
766	        socket_keepalive_options: Optional[Dict[int, Union[int, bytes]]] = None,
767	        *,
768	        client_name: Optional[str] = None,
769	        protocol_version: Literal[2, 3] = 3,
770	        noreply: bool = False,
771	        noevict: bool = False,
772	        notouch: bool = False,
773	    ):
774	        super().__init__(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
837	                    # causing an error
838	                    transport.close()
839	                    raise

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
839	                    raise
840	            await self.on_connect()
841	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
883	
884	        await self.on_connect()
885	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
895	        self,
896	        host: str = "127.0.0.1",
897	        port: int = 6379,
898	        username: Optional[str] = None,
899	        password: Optional[str] = None,
900	        credential_provider: Optional[AbstractCredentialProvider] = None,
901	        db: Optional[int] = 0,
902	        stream_timeout: Optional[float] = None,
903	        connect_timeout: Optional[float] = None,
904	        ssl_context: Optional[ssl.SSLContext] = None,
905	        encoding: str = "utf-8",
906	        decode_responses: bool = False,
907	        socket_keepalive: Optional[bool] = None,
908	        socket_keepalive_options: Optional[Dict[int, Union[int, bytes]]] = None,
909	        *,
910	        client_name: Optional[str] = None,
911	        protocol_version: Literal[2, 3] = 3,
912	        read_from_replicas: bool = False,
913	        noreply: bool = False,
914	        noevict: bool = False,
915	        notouch: bool = False,
916	    ) -> None:
917	        self.read_from_replicas = read_from_replicas

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/connection.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
946	
947	        await super().on_connect()
948	        if self.read_from_replicas:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/modules/filters.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    """
47	    DOCUMENTATION_URL = "https://redis.io/docs/stack/bloom/"
48	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/modules/graph.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    """
47	    DOCUMENTATION_URL = "https://redis.io/docs/stack/graph/"
48	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/modules/json.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	and a set of commands to operate on it."""
39	    DOCUMENTATION_URL = "https://redis.io/docs/stack/json/"
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/modules/search.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	similarity semantic search on top of text queries."""
58	    DOCUMENTATION_URL = "https://redis.io/docs/stack/search"
59	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/modules/timeseries.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    """
66	    DOCUMENTATION_URL = "https://redis.io/docs/stack/timeseries/"
67	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/parser.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
219	        self.localbuffer.seek(self.bytes_written)
220	        self.bytes_written += self.localbuffer.write(data)
221	        self.localbuffer.seek(self.bytes_read)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/parser.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
307	                        return NOT_ENOUGH_DATA
308	                    data = self.localbuffer.read(length + 2)
309	                    self.bytes_read += length + 2

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/pipeline.py:692
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
691	        try:
692	            return await exec(conn, stack, raise_on_error)
693	        except (ConnectionError, TimeoutError, CancelledError):

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/pipeline.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
708	
709	            return await exec(conn, stack, raise_on_error)
710	        finally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/pipeline.py:932
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
931	
932	        await node_commands.write()
933	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/pipeline.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
933	        try:
934	            await node_commands.read()
935	        except ExecAbortError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/pipeline.py:1002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1001	        for n in node_commands:
1002	            await n.write()
1003	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/pipeline.py:1005
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1004	        for n in node_commands:
1005	            await n.read()
1006	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/coredis/sentinel.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
40	        connection_pool: SentinelConnectionPool,
41	        host: str = "127.0.0.1",
42	        port: int = 6379,
43	        username: Optional[str] = None,
44	        password: Optional[str] = None,
45	        credential_provider: Optional[AbstractCredentialProvider] = None,
46	        db: int = 0,
47	        stream_timeout: Optional[float] = None,
48	        connect_timeout: Optional[float] = None,
49	        ssl_context: Optional[ssl.SSLContext] = None,
50	        encoding: str = "utf-8",
51	        decode_responses: bool = False,
52	        socket_keepalive: Optional[bool] = None,
53	        socket_keepalive_options: Optional[Dict[int, Union[int, bytes]]] = None,
54	        *,
55	        client_name: Optional[str] = None,
56	        protocol_version: Literal[2, 3] = 2,
57	    ):
58	        self.connection_pool: SentinelConnectionPool = weakref.proxy(connection_pool)
59	        super().__init__(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/setup.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	
27	    for r in open(os.path.join(THIS_DIR, "requirements", req_file)).read().splitlines():
28	        req = r.strip()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/setup.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	with open(str(_ROOT_DIR / "README.md")) as f:
83	    long_description = f.read()
84	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/setup.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
121	    long_description_content_type="text/markdown",
122	    url="https://github.com/alisaifee/coredis",
123	    project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/setup.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	    project_urls={
124	        "Source": "https://github.com/alisaifee/coredis",
125	        "Changes": "https://github.com/alisaifee/coredis/releases",
126	        "Documentation": "https://coredis.readthedocs.org",
127	    },
128	    author=__author__,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/setup.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	        "Source": "https://github.com/alisaifee/coredis",
125	        "Changes": "https://github.com/alisaifee/coredis/releases",
126	        "Documentation": "https://coredis.readthedocs.org",
127	    },
128	    author=__author__,
129	    author_email=__email__,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/setup.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	        "Changes": "https://github.com/alisaifee/coredis/releases",
126	        "Documentation": "https://coredis.readthedocs.org",
127	    },
128	    author=__author__,
129	    author_email=__email__,
130	    maintainer=__author__,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
483	    "git"
484	] = r'''
485	# This file helps to compute a version number in source trees obtained from
486	# git-archive tarball (such as those provided by githubs download-from-tag
487	# feature). Distribution tarballs (built by setup.py sdist) and build
488	# directories (produced by setup.py build) will contain a much shorter file
489	# that just contains the computed version number.
490	
491	# This file is released into the public domain.
492	# Generated by versioneer-0.28
493	# https://github.com/python-versioneer/python-versioneer
494	
495	"""Git implementation of _version.py."""
496	
497	import errno
498	import os
499	import re
500	import subprocess
501	import sys
502	from typing import Callable, Dict
503	import functools
504	
505	
506	def get_keywords():
507	    """Get the keywords needed to look up the version information."""
508	    # these strings will be replaced by git during git-archive.
509	    # setup.py/versioneer.py will grep for the variable names, so they must
510	    # each be defined on a line of their own. _version.py will just call
511	    # get_keywords().
512	    git_refnames = "%(DOLLAR)sFormat:%%d%(DOLLAR)s"
513	    git_full = "%(DOLLAR)sFormat:%%H%(DOLLAR)s"
514	    git_date = "%(DOLLAR)sFormat:%%ci%(DOLLAR)s"
515	    keywords = {"refnames": git_refnames, "full": git_full, "date": git_date}
516	    return keywords
517	
518	
519	class VersioneerConfig:
520	    """Container for Versioneer configuration parameters."""
521	
522	
523	def get_config():
524	    """Create, populate and return the VersioneerConfig() object."""
525	    # these strings are filled in when 'setup.py versioneer' creates
526	    # _version.py
527	    cfg = VersioneerConfig()
528	    cfg.VCS = "git"
529	    cfg.style = "%(STYLE)s"
530	    cfg.tag_prefix = "%(TAG_PREFIX)s"
531	    cfg.parentdir_prefix = "%(PARENTDIR_PREFIX)s"
532	    cfg.versionfile_source = "%(VERSIONFILE_SOURCE)s"
533	    cfg.verbose = False
534	    return cfg
535	
536	
537	class NotThisMethod(Exception):
538	    """Exception raised if a method is not valid for the current scenario."""
539	
540	
541	LONG_VERSION_PY: Dict[str, str] = {}
542	HANDLERS: Dict[str, Dict[str, Callable]] = {}
543	
544	
545	def register_vcs_handler(vcs, method):  # decorator
546	    """Create decorator to mark a method as the handler of a VCS."""
547	    def decorate(f):
548	        """Store f in HANDLERS[vcs][method]."""
549	        if vcs not in HANDLERS:
550	            HANDLERS[vcs] = {}
551	        HANDLERS[vcs][method] = f
552	        return f
553	    return decorate
554	
555	
556	def run_command(commands, args, cwd=None, verbose=False, hide_stderr=False,
557	                env=None):
558	    """Call the given command(s)."""
559	    assert isinstance(commands, list)
560	    process = None
561	
562	    popen_kwargs = {}
563	    if sys.platform == "win32":
564	        # This hides the console window if pythonw.exe is used
565	        startupinfo = subprocess.STARTUPINFO()
566	        startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW
567	        popen_kwargs["startupinfo"] = startupinfo
568	
569	    for command in commands:
570	        try:
571	            dispcmd = str([command] + args)
572	            # remember shell=False, so use git.cmd on windows, not just git
573	            process = subprocess.Popen([command] + args, cwd=cwd, env=env,
574	                                       stdout=subprocess.PIPE,
575	                                       stderr=(subprocess.PIPE if hide_stderr
576	                                               else None), **popen_kwargs)
577	            break
578	        except OSError:
579	            e = sys.exc_info()[1]
580	            if e.errno == errno.ENOENT:
581	                continue
582	            if verbose:
583	                print("unable to run %%s" %% dispcmd)
584	                print(e)
585	            return None, None
586	    else:
587	        if verbose:
588	            print("unable to find command, tried %%s" %% (commands,))
589	        return None, None
590	    stdout = process.communicate()[0].strip().decode()
591	    if process.returncode != 0:
592	        if verbose:
593	            print("unable to run %%s (error)" %% dispcmd)
594	            print("stdout was %%s" %% stdout)
595	        return None, process.returncode
596	    return stdout, process.returncode
597	
598	
599	def versions_from_parentdir(parentdir_prefix, root, verbose):
600	    """Try to determine the version from the parent directory name.
601	
602	    Source tarballs conventionally unpack into a directory that includes both
603	    the project name and a version string. We will also support searching up
604	    two directory levels for an appropriately named parent directory
605	    """
606	    rootdirs = []
607	
608	    for _ in range(3):
609	        dirname = os.path.basename(root)
610	        if dirname.startswith(parentdir_prefix):
611	            return {"version": dirname[len(parentdir_prefix):],
612	                    "full-revisionid": None,
613	                    "dirty": False, "error": None, "date": None}
614	        rootdirs.append(root)
615	        root = os.path.dirname(root)  # up a level
616	
617	    if verbose:
618	        print("Tried directories %%s but none started with prefix %%s" %%
619	              (str(rootdirs), parentdir_prefix))
620	    raise NotThisMethod("rootdir doesn't start with parentdir_prefix")
621	
622	
623	@register_vcs_handler("git", "get_keywords")
624	def git_get_keywords(versionfile_abs):
625	    """Extract version information from the given file."""
626	    # the code embedded in _version.py can just fetch the value of these
627	    # keywords. When used from setup.py, we don't want to import _version.py,
628	    # so we do it with a regexp instead. This function is not used from
629	    # _version.py.
630	    keywords = {}
631	    try:
632	        with open(versionfile_abs, "r") as fobj:
633	            for line in fobj:
634	                if line.strip().startswith("git_refnames ="):
635	                    mo = re.search(r'=\s*"(.*)"', line)
636	                    if mo:
637	                        keywords["refnames"] = mo.group(1)
638	                if line.strip().startswith("git_full ="):
639	                    mo = re.search(r'=\s*"(.*)"', line)
640	                    if mo:
641	                        keywords["full"] = mo.group(1)
642	                if line.strip().startswith("git_date ="):
643	                    mo = re.search(r'=\s*"(.*)"', line)
644	                    if mo:
645	                        keywords["date"] = mo.group(1)
646	    except OSError:
647	        pass
648	    return keywords
649	
650	
651	@register_vcs_handler("git", "keywords")
652	def git_versions_from_keywords(keywords, tag_prefix, verbose):
653	    """Get version information from git keywords."""
654	    if "refnames" not in keywords:
655	        raise NotThisMethod("Short version file found")
656	    date = keywords.get("date")
657	    if date is not None:
658	        # Use only the last line.  Previous lines may contain GPG signature
659	        # information.
660	        date = date.splitlines()[-1]
661	
662	        # git-2.2.0 added "%%cI", which expands to an ISO-8601 -compliant
663	        # datestamp. However we prefer "%%ci" (which expands to an "ISO-8601
664	        # -like" string, which we must then edit to make compliant), because
665	        # it's been around since git-1.5.3, and it's too difficult to
666	        # discover which version we're using, or to work around using an
667	        # older one.
668	        date = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
669	    refnames = keywords["refnames"].strip()
670	    if refnames.startswith("$Format"):
671	        if verbose:
672	            print("keywords are unexpanded, not using")
673	        raise NotThisMethod("unexpanded keywords, not a git-archive tarball")
674	    refs = {r.strip() for r in refnames.strip("()").split(",")}
675	    # starting in git-1.8.3, tags are listed as "tag: foo-1.0" instead of
676	    # just "foo-1.0". If we see a "tag: " prefix, prefer those.
677	    TAG = "tag: "
678	    tags = {r[len(TAG):] for r in refs if r.startswith(TAG)}
679	    if not tags:
680	        # Either we're using git < 1.8.3, or there really are no tags. We use
681	        # a heuristic: assume all version tags have a digit. The old git %%d
682	        # expansion behaves like git log --decorate=short and strips out the
683	        # refs/heads/ and refs/tags/ prefixes that would let us distinguish
684	        # between branches and tags. By ignoring refnames without digits, we
685	        # filter out many common branch names like "release" and
686	        # "stabilization", as well as "HEAD" and "master".
687	        tags = {r for r in refs if re.search(r'\d', r)}
688	        if verbose:
689	            print("discarding '%%s', no digits" %% ",".join(refs - tags))
690	    if verbose:
691	        print("likely tags: %%s" %% ",".join(sorted(tags)))
692	    for ref in sorted(tags):
693	        # sorting will prefer e.g. "2.0" over "2.0rc1"
694	        if ref.startswith(tag_prefix):
695	            r = ref[len(tag_prefix):]
696	            # Filter out refs that exactly match prefix or that don't start
697	            # with a number once the prefix is stripped (mostly a concern
698	            # when prefix is '')
699	            if not re.match(r'\d', r):
700	                continue
701	            if verbose:
702	                print("picking %%s" %% r)
703	            return {"version": r,
704	                    "full-revisionid": keywords["full"].strip(),
705	                    "dirty": False, "error": None,
706	                    "date": date}
707	    # no suitable tags, so version is "0+unknown", but full hex is still there
708	    if verbose:
709	        print("no suitable tags, using unknown + full revision id")
710	    return {"version": "0+unknown",
711	            "full-revisionid": keywords["full"].strip(),
712	            "dirty": False, "error": "no suitable tags", "date": None}
713	
714	
715	@register_vcs_handler("git", "pieces_from_vcs")
716	def git_pieces_from_vcs(tag_prefix, root, verbose, runner=run_command):
717	    """Get version from 'git describe' in the root of the source tree.
718	
719	    This only gets called if the git-archive 'subst' keywords were *not*
720	    expanded, and _version.py hasn't already been rewritten with a short
721	    version string, meaning we're inside a checked out source tree.
722	    """
723	    GITS = ["git"]
724	    if sys.platform == "win32":
725	        GITS = ["git.cmd", "git.exe"]
726	
727	    # GIT_DIR can interfere with correct operation of Versioneer.
728	    # It may be intended to be passed to the Versioneer-versioned project,
729	    # but that should not change where we get our version from.
730	    env = os.environ.copy()
731	    env.pop("GIT_DIR", None)
732	    runner = functools.partial(runner, env=env)
733	
734	    _, rc = runner(GITS, ["rev-parse", "--git-dir"], cwd=root,
735	                   hide_stderr=not verbose)
736	    if rc != 0:
737	        if verbose:
738	            print("Directory %%s not under git control" %% root)
739	        raise NotThisMethod("'git rev-parse --git-dir' returned error")
740	
741	    # if there is a tag matching tag_prefix, this yields TAG-NUM-gHEX[-dirty]
742	    # if there isn't one, this yields HEX[-dirty] (no NUM)
743	    describe_out, rc = runner(GITS, [
744	        "describe", "--tags", "--dirty", "--always", "--long",
745	        "--match", f"{tag_prefix}[[:digit:]]*"
746	    ], cwd=root)
747	    # --long was added in git-1.5.5
748	    if describe_out is None:
749	        raise NotThisMethod("'git describe' failed")
750	    describe_out = describe_out.strip()
751	    full_out, rc = runner(GITS, ["rev-parse", "HEAD"], cwd=root)
752	    if full_out is None:
753	        raise NotThisMethod("'git rev-parse' failed")
754	    full_out = full_out.strip()
755	
756	    pieces = {}
757	    pieces["long"] = full_out
758	    pieces["short"] = full_out[:7]  # maybe improved later
759	    pieces["error"] = None
760	
761	    branch_name, rc = runner(GITS, ["rev-parse", "--abbrev-ref", "HEAD"],
762	                             cwd=root)
763	    # --abbrev-ref was added in git-1.6.3
764	    if rc != 0 or branch_name is None:
765	        raise NotThisMethod("'git rev-parse --abbrev-ref' returned error")
766	    branch_name = branch_name.strip()
767	
768	    if branch_name == "HEAD":
769	        # If we aren't exactly on a branch, pick a branch which represents
770	        # the current commit. If all else fails, we are on a branchless
771	        # commit.
772	        branches, rc = runner(GITS, ["branch", "--contains"], cwd=root)
773	        # --contains was added in git-1.5.4
774	        if rc != 0 or branches is None:
775	            raise NotThisMethod("'git branch --contains' returned error")
776	        branches = branches.split("\n")
777	
778	        # Remove the first line if we're running detached
779	        if "(" in branches[0]:
780	            branches.pop(0)
781	
782	        # Strip off the leading "* " from the list of branches.
783	        branches = [branch[2:] for branch in branches]
784	        if "master" in branches:
785	            branch_name = "master"
786	        elif not branches:
787	            branch_name = None
788	        else:
789	            # Pick the first branch that is returned. Good or bad.
790	            branch_name = branches[0]
791	
792	    pieces["branch"] = branch_name
793	
794	    # parse describe_out. It will be like TAG-NUM-gHEX[-dirty] or HEX[-dirty]
795	    # TAG might have hyphens.
796	    git_describe = describe_out
797	
798	    # look for -dirty suffix
799	    dirty = git_describe.endswith("-dirty")
800	    pieces["dirty"] = dirty
801	    if dirty:
802	        git_describe = git_describe[:git_describe.rindex("-dirty")]
803	
804	    # now we have TAG-NUM-gHEX or HEX
805	
806	    if "-" in git_describe:
807	        # TAG-NUM-gHEX
808	        mo = re.search(r'^(.+)-(\d+)-g([0-9a-f]+)$', git_describe)
809	        if not mo:
810	            # unparsable. Maybe git-describe is misbehaving?
811	            pieces["error"] = ("unable to parse git-describe output: '%%s'"
812	                               %% describe_out)
813	            return pieces
814	
815	        # tag
816	        full_tag = mo.group(1)
817	        if not full_tag.startswith(tag_prefix):
818	            if verbose:
819	                fmt = "tag '%%s' doesn't start with prefix '%%s'"
820	                print(fmt %% (full_tag, tag_prefix))
821	            pieces["error"] = ("tag '%%s' doesn't start with prefix '%%s'"
822	                               %% (full_tag, tag_prefix))
823	            return pieces
824	        pieces["closest-tag"] = full_tag[len(tag_prefix):]
825	
826	        # distance: number of commits since tag
827	        pieces["distance"] = int(mo.group(2))
828	
829	        # commit: short hex revision ID
830	        pieces["short"] = mo.group(3)
831	
832	    else:
833	        # HEX: no tags
834	        pieces["closest-tag"] = None
835	        out, rc = runner(GITS, ["rev-list", "HEAD", "--left-right"], cwd=root)
836	        pieces["distance"] = len(out.split())  # total number of commits
837	
838	    # commit date: see ISO-8601 comment in git_versions_from_keywords()
839	    date = runner(GITS, ["show", "-s", "--format=%%ci", "HEAD"], cwd=root)[0].strip()
840	    # Use only the last line.  Previous lines may contain GPG signature
841	    # information.
842	    date = date.splitlines()[-1]
843	    pieces["date"] = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
844	
845	    return pieces
846	
847	
848	def plus_or_dot(pieces):
849	    """Return a + if we don't already have one, else return a ."""
850	    if "+" in pieces.get("closest-tag", ""):
851	        return "."
852	    return "+"
853	
854	
855	def render_pep440(pieces):
856	    """Build up version string, with post-release "local version identifier".
857	
858	    Our goal: TAG[+DISTANCE.gHEX[.dirty]] . Note that if you
859	    get a tagged build and then dirty it, you'll get TAG+0.gHEX.dirty
860	
861	    Exceptions:
862	    1: no tags. git_describe was just HEX. 0+untagged.DISTANCE.gHEX[.dirty]
863	    """
864	    if pieces["closest-tag"]:
865	        rendered = pieces["closest-tag"]
866	        if pieces["distance"] or pieces["dirty"]:
867	            rendered += plus_or_dot(pieces)
868	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
869	            if pieces["dirty"]:
870	                rendered += ".dirty"
871	    else:
872	        # exception #1
873	        rendered = "0+untagged.%%d.g%%s" %% (pieces["distance"],
874	                                          pieces["short"])
875	        if pieces["dirty"]:
876	            rendered += ".dirty"
877	    return rendered
878	
879	
880	def render_pep440_branch(pieces):
881	    """TAG[[.dev0]+DISTANCE.gHEX[.dirty]] .
882	
883	    The ".dev0" means not master branch. Note that .dev0 sorts backwards
884	    (a feature branch will appear "older" than the master branch).
885	
886	    Exceptions:
887	    1: no tags. 0[.dev0]+untagged.DISTANCE.gHEX[.dirty]
888	    """
889	    if pieces["closest-tag"]:
890	        rendered = pieces["closest-tag"]
891	        if pieces["distance"] or pieces["dirty"]:
892	            if pieces["branch"] != "master":
893	                rendered += ".dev0"
894	            rendered += plus_or_dot(pieces)
895	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
896	            if pieces["dirty"]:
897	                rendered += ".dirty"
898	    else:
899	        # exception #1
900	        rendered = "0"
901	        if pieces["branch"] != "master":
902	            rendered += ".dev0"
903	        rendered += "+untagged.%%d.g%%s" %% (pieces["distance"],
904	                                          pieces["short"])
905	        if pieces["dirty"]:
906	            rendered += ".dirty"
907	    return rendered
908	
909	
910	def pep440_split_post(ver):
911	    """Split pep440 version string at the post-release segment.
912	
913	    Returns the release segments before the post-release and the
914	    post-release version number (or -1 if no post-release segment is present).
915	    """
916	    vc = str.split(ver, ".post")
917	    return vc[0], int(vc[1] or 0) if len(vc) == 2 else None
918	
919	
920	def render_pep440_pre(pieces):
921	    """TAG[.postN.devDISTANCE] -- No -dirty.
922	
923	    Exceptions:
924	    1: no tags. 0.post0.devDISTANCE
925	    """
926	    if pieces["closest-tag"]:
927	        if pieces["distance"]:
928	            # update the post release segment
929	            tag_version, post_version = pep440_split_post(pieces["closest-tag"])
930	            rendered = tag_version
931	            if post_version is not None:
932	                rendered += ".post%%d.dev%%d" %% (post_version + 1, pieces["distance"])
933	            else:
934	                rendered += ".post0.dev%%d" %% (pieces["distance"])
935	        else:
936	            # no commits, use the tag as the version
937	            rendered = pieces["closest-tag"]
938	    else:
939	        # exception #1
940	        rendered = "0.post0.dev%%d" %% pieces["distance"]
941	    return rendered
942	
943	
944	def render_pep440_post(pieces):
945	    """TAG[.postDISTANCE[.dev0]+gHEX] .
946	
947	    The ".dev0" means dirty. Note that .dev0 sorts backwards
948	    (a dirty tree will appear "older" than the corresponding clean one),
949	    but you shouldn't be releasing software with -dirty anyways.
950	
951	    Exceptions:
952	    1: no tags. 0.postDISTANCE[.dev0]
953	    """
954	    if pieces["closest-tag"]:
955	        rendered = pieces["closest-tag"]
956	        if pieces["distance"] or pieces["dirty"]:
957	            rendered += ".post%%d" %% pieces["distance"]
958	            if pieces["dirty"]:
959	                rendered += ".dev0"
960	            rendered += plus_or_dot(pieces)
961	            rendered += "g%%s" %% pieces["short"]
962	    else:
963	        # exception #1
964	        rendered = "0.post%%d" %% pieces["distance"]
965	        if pieces["dirty"]:
966	            rendered += ".dev0"
967	        rendered += "+g%%s" %% pieces["short"]
968	    return rendered
969	
970	
971	def render_pep440_post_branch(pieces):
972	    """TAG[.postDISTANCE[.dev0]+gHEX[.dirty]] .
973	
974	    The ".dev0" means not master branch.
975	
976	    Exceptions:
977	    1: no tags. 0.postDISTANCE[.dev0]+gHEX[.dirty]
978	    """
979	    if pieces["closest-tag"]:
980	        rendered = pieces["closest-tag"]
981	        if pieces["distance"] or pieces["dirty"]:
982	            rendered += ".post%%d" %% pieces["distance"]
983	            if pieces["branch"] != "master":
984	                rendered += ".dev0"
985	            rendered += plus_or_dot(pieces)
986	            rendered += "g%%s" %% pieces["short"]
987	            if pieces["dirty"]:
988	                rendered += ".dirty"
989	    else:
990	        # exception #1
991	        rendered = "0.post%%d" %% pieces["distance"]
992	        if pieces["branch"] != "master":
993	            rendered += ".dev0"
994	        rendered += "+g%%s" %% pieces["short"]
995	        if pieces["dirty"]:
996	            rendered += ".dirty"
997	    return rendered
998	
999	
1000	def render_pep440_old(pieces):
1001	    """TAG[.postDISTANCE[.dev0]] .
1002	
1003	    The ".dev0" means dirty.
1004	
1005	    Exceptions:
1006	    1: no tags. 0.postDISTANCE[.dev0]
1007	    """
1008	    if pieces["closest-tag"]:
1009	        rendered = pieces["closest-tag"]
1010	        if pieces["distance"] or pieces["dirty"]:
1011	            rendered += ".post%%d" %% pieces["distance"]
1012	            if pieces["dirty"]:
1013	                rendered += ".dev0"
1014	    else:
1015	        # exception #1
1016	        rendered = "0.post%%d" %% pieces["distance"]
1017	        if pieces["dirty"]:
1018	            rendered += ".dev0"
1019	    return rendered
1020	
1021	
1022	def render_git_describe(pieces):
1023	    """TAG[-DISTANCE-gHEX][-dirty].
1024	
1025	    Like 'git describe --tags --dirty --always'.
1026	
1027	    Exceptions:
1028	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
1029	    """
1030	    if pieces["closest-tag"]:
1031	        rendered = pieces["closest-tag"]
1032	        if pieces["distance"]:
1033	            rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
1034	    else:
1035	        # exception #1
1036	        rendered = pieces["short"]
1037	    if pieces["dirty"]:
1038	        rendered += "-dirty"
1039	    return rendered
1040	
1041	
1042	def render_git_describe_long(pieces):
1043	    """TAG-DISTANCE-gHEX[-dirty].
1044	
1045	    Like 'git describe --tags --dirty --always -long'.
1046	    The distance/hash is unconditional.
1047	
1048	    Exceptions:
1049	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
1050	    """
1051	    if pieces["closest-tag"]:
1052	        rendered = pieces["closest-tag"]
1053	        rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
1054	    else:
1055	        # exception #1
1056	        rendered = pieces["short"]
1057	    if pieces["dirty"]:
1058	        rendered += "-dirty"
1059	    return rendered
1060	
1061	
1062	def render(pieces, style):
1063	    """Render the given version pieces into the requested style."""
1064	    if pieces["error"]:
1065	        return {"version": "unknown",
1066	                "full-revisionid": pieces.get("long"),
1067	                "dirty": None,
1068	                "error": pieces["error"],
1069	                "date": None}
1070	
1071	    if not style or style == "default":
1072	        style = "pep440"  # the default
1073	
1074	    if style == "pep440":
1075	        rendered = render_pep440(pieces)
1076	    elif style == "pep440-branch":
1077	        rendered = render_pep440_branch(pieces)
1078	    elif style == "pep440-pre":
1079	        rendered = render_pep440_pre(pieces)
1080	    elif style == "pep440-post":
1081	        rendered = render_pep440_post(pieces)
1082	    elif style == "pep440-post-branch":
1083	        rendered = render_pep440_post_branch(pieces)
1084	    elif style == "pep440-old":
1085	        rendered = render_pep440_old(pieces)
1086	    elif style == "git-describe":
1087	        rendered = render_git_describe(pieces)
1088	    elif style == "git-describe-long":
1089	        rendered = render_git_describe_long(pieces)
1090	    else:
1091	        raise ValueError("unknown style '%%s'" %% style)
1092	
1093	    return {"version": rendered, "full-revisionid": pieces["long"],
1094	            "dirty": pieces["dirty"], "error": None,
1095	            "date": pieces.get("date")}
1096	
1097	
1098	def get_versions():
1099	    """Get version information or return default if unable to do so."""
1100	    # I am in _version.py, which lives at ROOT/VERSIONFILE_SOURCE. If we have
1101	    # __file__, we can work backwards from there to the root. Some
1102	    # py2exe/bbfreeze/non-CPython implementations don't do __file__, in which
1103	    # case we can only use expanded keywords.
1104	
1105	    cfg = get_config()
1106	    verbose = cfg.verbose
1107	
1108	    try:
1109	        return git_versions_from_keywords(get_keywords(), cfg.tag_prefix,
1110	                                          verbose)
1111	    except NotThisMethod:
1112	        pass
1113	
1114	    try:
1115	        root = os.path.realpath(__file__)
1116	        # versionfile_source is the relative path from the top of the source
1117	        # tree (where the .git directory might live) to this file. Invert
1118	        # this to find the root from __file__.
1119	        for _ in cfg.versionfile_source.split('/'):
1120	            root = os.path.dirname(root)
1121	    except NameError:
1122	        return {"version": "0+unknown", "full-revisionid": None,
1123	                "dirty": None,
1124	                "error": "unable to find root of source tree",
1125	                "date": None}
1126	
1127	    try:
1128	        pieces = git_pieces_from_vcs(cfg.tag_prefix, root, verbose)
1129	        return render(pieces, cfg.style)
1130	    except NotThisMethod:
1131	        pass
1132	
1133	    try:
1134	        if cfg.parentdir_prefix:
1135	            return versions_from_parentdir(cfg.parentdir_prefix, root, verbose)
1136	    except NotThisMethod:
1137	        pass
1138	
1139	    return {"version": "0+unknown", "full-revisionid": None,
1140	            "dirty": None,
1141	            "error": "unable to compute version", "date": None}
1142	'''
1143	
1144	
1145	@register_vcs_handler("git", "get_keywords")
1146	def git_get_keywords(versionfile_abs):
1147	    """Extract version information from the given file."""
1148	    # the code embedded in _version.py can just fetch the value of these

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:1418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1417	        with open(".gitattributes", "a+") as fobj:
1418	            fobj.write(f"{versionfile_source} export-subst\n")
1419	        files.append(".gitattributes")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:1475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1474	        with open(filename) as f:
1475	            contents = f.read()
1476	    except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:1495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1494	    with open(filename, "w") as f:
1495	        f.write(SHORT_VERSION_PY % contents)
1496	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:1992
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1991	                    LONG = LONG_VERSION_PY[cfg.VCS]
1992	                    f.write(
1993	                        LONG
1994	                        % {
1995	                            "DOLLAR": "$",
1996	                            "STYLE": cfg.style,
1997	                            "TAG_PREFIX": cfg.tag_prefix,
1998	                            "PARENTDIR_PREFIX": cfg.parentdir_prefix,
1999	                            "VERSIONFILE_SOURCE": cfg.versionfile_source,
2000	                        }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:2025
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2024	                    LONG = LONG_VERSION_PY[cfg.VCS]
2025	                    f.write(
2026	                        LONG
2027	                        % {
2028	                            "DOLLAR": "$",
2029	                            "STYLE": cfg.style,
2030	                            "TAG_PREFIX": cfg.tag_prefix,
2031	                            "PARENTDIR_PREFIX": cfg.parentdir_prefix,
2032	                            "VERSIONFILE_SOURCE": cfg.versionfile_source,
2033	                        }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:2074
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2073	            with open(manifest_filename, "w") as fobj:
2074	                fobj.write("\n".join(normalized))
2075	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:2169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2168	            with open(os.path.join(root, "setup.cfg"), "a") as f:
2169	                f.write(SAMPLE_CONFIG)
2170	        print(CONFIG_ERROR, file=sys.stderr)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:2176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2175	        LONG = LONG_VERSION_PY[cfg.VCS]
2176	        f.write(
2177	            LONG
2178	            % {
2179	                "DOLLAR": "$",
2180	                "STYLE": cfg.style,
2181	                "TAG_PREFIX": cfg.tag_prefix,
2182	                "PARENTDIR_PREFIX": cfg.parentdir_prefix,
2183	                "VERSIONFILE_SOURCE": cfg.versionfile_source,
2184	            }

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:2191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2190	            with open(ipy, "r") as f:
2191	                old = f.read()
2192	        except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:2199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2198	            with open(ipy, "w") as f:
2199	                f.write(old.replace(OLD_SNIPPET, snippet))
2200	        elif snippet not in old:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/coredis-4.20.0/coredis-4.20.0/versioneer.py:2203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2202	            with open(ipy, "a") as f:
2203	                f.write(snippet)
2204	        else:

--------------------------------------------------

Code scanned:
	Total lines of code: 29052
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 41.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 57.0
		High: 2.0
Files skipped (0):
