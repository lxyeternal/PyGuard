Run started:2025-04-12 15:55:24.683040

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
101	    ) as f:
102	        f.write(data)
103	    return buf.getvalue()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
110	    with PgzipFile(fileobj=io.BytesIO(data), thread=thread, blocksize=blocksize) as f:
111	        return f.read()
112	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
207	            self.mode = WRITE
208	            self._init_write(filename)
209	            self.compress = zlib.compressobj(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
214	            self.blocksize = blocksize  # use 20M blocksize as default
215	            self.pool = ThreadPoolExecutor(max_workers=self.thread)
216	            self.pool_result = []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
291	        elif length < self.blocksize:
292	            self.small_buf.write(data)
293	            if self.small_buf.tell() >= self.blocksize:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
337	        )
338	        self.fileobj.write(cdata[0])  # buffer data
339	        self.fileobj.write(cdata[1])  # body data

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
338	        self.fileobj.write(cdata[0])  # buffer data
339	        self.fileobj.write(cdata[1])  # body data
340	        self.fileobj.write(cdata[2])  # rest data

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
339	        self.fileobj.write(cdata[1])  # body data
340	        self.fileobj.write(cdata[2])  # rest data
341	        write32u(self.fileobj, cdata[3])  # CRC32

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
345	    def _write_member_header(self, compressed_size, raw_size):
346	        self.fileobj.write(b"\037\213")  # magic header, 2 bytes
347	        self.fileobj.write(b"\010")  # compression method, 1 byte

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
346	        self.fileobj.write(b"\037\213")  # magic header, 2 bytes
347	        self.fileobj.write(b"\010")  # compression method, 1 byte
348	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
360	            flags |= FNAME
361	        self.fileobj.write(chr(flags).encode("latin-1"))  # flags, 1 byte
362	        mtime = self._write_mtime

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
365	        write32u(self.fileobj, int(mtime))  # modified time, 4 bytes
366	        self.fileobj.write(b"\002")  # fixed flag (maximum compression), 1 byte
367	        self.fileobj.write(b"\377")  # OS (unknown), 1 byte

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
366	        self.fileobj.write(b"\002")  # fixed flag (maximum compression), 1 byte
367	        self.fileobj.write(b"\377")  # OS (unknown), 1 byte
368	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
370	        # XLEN, 8 bytes
371	        self.fileobj.write(b"\x08\x00")  # extra flag len, 2 bytes
372	        # EXTRA FLAG FORMAT:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
378	        # MEMBER SIZE:   The size of current member
379	        self.fileobj.write(SID)  # subfield ID (IG), 2 bytes
380	        # LEN: 4 bytes

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
380	        # LEN: 4 bytes
381	        self.fileobj.write(b"\x04\x00")  # subfield len (4), 2 bytes
382	        # compressed data size: 16 + 4 + len(fname) + 1 + data + 8

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
386	            member_size -= 1
387	        self.fileobj.write(struct.pack("<I", member_size))  # member size, 4 bytes
388	        if fname:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
388	        if fname:
389	            self.fileobj.write(fname + b"\000")
390	        return member_size

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
407	            self.myfileobj.seek(3, 1)
408	            fByte = self.myfileobj.read(1)
409	            if not fByte:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
412	            self.myfileobj.seek(8, 1)
413	            extra_flag = self.myfileobj.read(8)
414	            if not extra_flag:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
420	                while True:
421	                    s = self.myfileobj.read(1)
422	                    if not s or s == b"\000":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
425	                while True:
426	                    s = self.myfileobj.read(1)
427	                    if not s or s == b"\000":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
441	            self.myfileobj.seek(self.index[-1][0] + self.index[-1][1] - 4)
442	            (isize,) = struct.unpack("<I", self.myfileobj.read(4))
443	            self.index[-1][2] = isize

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
538	        self._read_pool = []
539	        self._pool = ThreadPoolExecutor(max_workers=self.thread)
540	        self._block_buff = b""

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
562	        ## not a good idea to read all of them in memory
563	        body_bytes = dpr.decompress(data, rsize)
564	        crc = zlib.crc32(body_bytes)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:581
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
580	        '''
581	        data = self._fp.read(n)
582	        while len(data) < n:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
582	        while len(data) < n:
583	            b = self._fp.read(n - len(data))
584	            if not b:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
590	    def _read_gzip_header(self):
591	        magic = self._fp.read(2)
592	        if magic == b"":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
616	            while True:
617	                s = self._fp.read(1)
618	                self._header_size += 1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
623	            while True:
624	                s = self._fp.read(1)
625	                self._header_size += 1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
662	                # jump to the next member, if there is one.
663	                self._init_read()
664	                if not self._read_gzip_header():

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
673	                        self._decompress_async(
674	                            self._fp.read(cpr_size), *self._read_eof_crc()
675	                        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
715	            # Read a chunk of data from the file
716	            buf = self._fp.read(io.DEFAULT_BUFFER_SIZE)
717	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:718
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
717	
718	            uncompress = self._decompressor.decompress(buf, size)
719	            if self._decompressor.unconsumed_tail != b"":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/pgzip/pgzip.py:749
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
748	        while c == b"\x00":
749	            c = self._fp.read(1)
750	        if c:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/setup.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	with open('README.md', 'r', encoding='utf-8') as fh:
5	    longDesc = fh.read().replace("CompressionBenchmark.png", "https://raw.githubusercontent.com/pgzip/pgzip/master/CompressionBenchmark.png").replace("DecompressionBenchmark.png", "https://raw.githubusercontent.com/pgzip/pgzip/master/DecompressionBenchmark.png")
6	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/setup.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	with open('README.md', 'r', encoding='utf-8') as fh:
5	    longDesc = fh.read().replace("CompressionBenchmark.png", "https://raw.githubusercontent.com/pgzip/pgzip/master/CompressionBenchmark.png").replace("DecompressionBenchmark.png", "https://raw.githubusercontent.com/pgzip/pgzip/master/DecompressionBenchmark.png")
6	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/setup.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    long_description_content_type="text/markdown",
16	    url='https://github.com/pgzip/pgzip',
17	    license='MIT',

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/tests/test_pgzip.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
17	    with pgzip.open(filename, "wb", compresslevel=6) as f1:
18	        f1.write(DATA1 * 50)
19	        # Try flush and fileno.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/tests/test_pgzip.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
28	    with gzip.open(filename, "rb") as f2:
29	        file_content = f2.read()
30	    assert file_content == DATA1 * 50

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/tests/test_pgzip.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
36	    with gzip.open(filename, "wb") as f1:
37	        f1.write(DATA1 * 500)
38	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/tests/test_pgzip.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	    with pgzip.open(filename, "rb") as f2:
40	        file_content = f2.read()
41	    assert file_content == DATA1 * 500

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pgzip-0.3.5/pgzip-0.3.5/tests/test_pgzip.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	    fh = pgzip.open(filename, "wb", compresslevel=6, thread=4, blocksize=128)
48	    fh.write(DATA1 * 500)
49	    assert not fh.pool._shutdown

--------------------------------------------------

Code scanned:
	Total lines of code: 830
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 40.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 0.0
Files skipped (0):
