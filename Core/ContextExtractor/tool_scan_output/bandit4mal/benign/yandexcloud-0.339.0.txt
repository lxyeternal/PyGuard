Run started:2025-04-12 13:36:44.365997

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/tests/test_endpoints_ovirride.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
42	    service = VPCServiceMock()
43	    server = grpc.server(futures.ThreadPoolExecutor(max_workers=10))
44	    server.add_insecure_port("[::]:" + INSECURE_SERVICE_PORT)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/tests/test_retry_policy.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
56	    service = VPCServiceMock(side_effect)
57	    server = grpc.server(futures.ThreadPoolExecutor(max_workers=10))
58	    server.add_insecure_port("localhost:" + INSECURE_SERVICE_PORT)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/tests/test_service_account_auth.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	        algorithms=["PS256"],
55	        audience="https://iam.api.cloud.yandex.net/iam/v1/tokens",
56	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/tests/test_service_account_auth.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	    assert parsed["iss"] == service_account_key["service_account_id"]
62	    assert parsed["aud"] == "https://iam.api.cloud.yandex.net/iam/v1/tokens"
63	    assert now - 60 <= int(parsed["iat"]) <= now

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/yandexcloud/_auth_fabric.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
13	
14	_MDS_ADDR = "169.254.169.254"
15	_MDS_URL = "http://{}/computeMetadata/v1/instance/service-accounts/default/token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/yandexcloud/_auth_fabric.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	_MDS_ADDR = "169.254.169.254"
15	_MDS_URL = "http://{}/computeMetadata/v1/instance/service-accounts/default/token"
16	_MDS_HEADERS = {"Metadata-Flavor": "Google"}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/yandexcloud/_auth_fabric.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
32	
33	    obj_id = sa_key.get("id")
34	    sa_id = sa_key.get("service_account_id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/yandexcloud/_auth_fabric.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
33	    obj_id = sa_key.get("id")
34	    sa_id = sa_key.get("service_account_id")
35	    private_key = sa_key.get("private_key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/yandexcloud/_auth_fabric.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	    sa_id = sa_key.get("service_account_id")
35	    private_key = sa_key.get("private_key")
36	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/yandexcloud/_auth_fabric.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	    def get_token(self) -> str:
65	        r = requests.get(self.url(), headers=_MDS_HEADERS, timeout=_MDS_TIMEOUT)
66	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/yandexcloud/_auth_fabric.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
86	    def get_token_request(self) -> "CreateIamTokenRequest":
87	        return CreateIamTokenRequest(jwt=self.__prepare_request(self._endpoint))
88	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/yandexcloud/_auth_fabric.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	        exp_utc = datetime.utcfromtimestamp(now + self.__SECONDS_IN_HOUR)
93	        url = f"https://iam.{endpoint}/iam/v1/tokens"
94	        payload = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/yandexcloud-0.339.0/yandexcloud-0.339.0/yandexcloud/_auth_fabric.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	    if len(auth_methods) == 0:
131	        metadata_addr = metadata_addr if metadata_addr is not None else os.environ.get("YC_METADATA_ADDR", _MDS_ADDR)
132	        return MetadataAuth(metadata_addr)

--------------------------------------------------

Code scanned:
	Total lines of code: 149193
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 13.0
		High: 0.0
Files skipped (0):
