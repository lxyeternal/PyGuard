Run started:2025-04-12 10:47:18.688861

Test results:
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/setup.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
8	with open(os.path.join(dir_name, "src", "braintrust", "version.py"), encoding="utf-8") as f:
9	    exec(f.read(), version_contents)
10	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/setup.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
8	with open(os.path.join(dir_name, "src", "braintrust", "version.py"), encoding="utf-8") as f:
9	    exec(f.read(), version_contents)
10	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/setup.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
11	with open(os.path.join(dir_name, "README.md"), "r", encoding="utf-8") as f:
12	    long_description = f.read()
13	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/setup.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	    long_description_content_type="text/markdown",
58	    url="https://www.braintrust.dev",
59	    project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/setup.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    project_urls={
60	        "Source Code": "https://github.com/braintrustdata/braintrust-sdk",
61	        "Bug Tracker": "https://github.com/braintrustdata/braintrust-sdk/issues",
62	    },
63	    classifiers=[

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/setup.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	        "Source Code": "https://github.com/braintrustdata/braintrust-sdk",
61	        "Bug Tracker": "https://github.com/braintrustdata/braintrust-sdk/issues",
62	    },
63	    classifiers=[
64	        "Programming Language :: Python :: 3",

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/audit.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
18	    if j["v"] == 1:
19	        return json.loads(gzip.decompress(base64.b64decode(j["p"])))
20	    else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/audit.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
18	    if j["v"] == 1:
19	        return json.loads(gzip.decompress(base64.b64decode(j["p"])))
20	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/eval.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
323	        "--app-url",
324	        help="Specify a custom braintrust app url. Defaults to https://www.braintrust.dev. This is only necessary if you are using an experimental version of Braintrust",
325	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/eval.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
332	        "--filter",
333	        help="Only run evaluators that match these filters. Each filter is a regular expression (https://docs.python.org/3/library/re.html). For example, --filter metadata.priority='^P0$' input.name='foo.*bar' will only run evaluators that have metadata.priority equal to 'P0' and input.name matching the regular expression 'foo.*bar'.",
334	        nargs="*",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/install/api.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	
60	LATEST_TEMPLATE = "https://braintrust-cf.s3.amazonaws.com/braintrust-latest.yaml"
61	
62	
63	def build_parser(subparsers, parents):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/install/api.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
219	        "--use-global-proxy",
220	        help="Use the global cloudflare proxy (https://braintrustproxy.com)",
221	        default=None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/install/api.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
328	        if args.template is None:
329	            template = "https://braintrust-cf.s3.amazonaws.com/braintrust-latest-vpc.yaml"
330	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/install/api.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
343	            textwrap.dedent(
344	                f"""\
345	            Stack with name {args.name} does not exist. Either create it manually by following
346	            https://www.braintrust.dev/docs/guides/self-hosting/aws or use the --create flag."""

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/install/logs.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
86	
87	        with ThreadPoolExecutor(8) as executor:
88	            events = executor.map(get_events, all_streams)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	            with open(direct_url) as f:
43	                j = json.loads(f.read())
44	                if "url" in j:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	            "--python-platform",
143	            os.environ.get("BRAINTRUST_INTERNAL_PY_BUNDLE_PLATFORM_OVERRIDE", "linux"),
144	            "--python-version",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
144	            "--python-version",
145	            os.environ.get("BRAINTRUST_INTERNAL_PY_BUNDLE_VERSION_OVERRIDE", _py_version()),
146	        ],

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
201	                    arcname = os.path.join(arcdirpath, name)
202	                    zf.write(path, arcname)
203	                for name in filenames:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
201	                    arcname = os.path.join(arcdirpath, name)
202	                    zf.write(path, arcname)
203	                for name in filenames:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
207	                        arcname = os.path.join(arcdirpath, name)
208	                        zf.write(path, arcname)
209	            for source in sources:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
207	                        arcname = os.path.join(arcdirpath, name)
208	                        zf.write(path, arcname)
209	            for source in sources:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
209	            for source in sources:
210	                zf.write(source, os.path.relpath(source))
211	            zf.writestr("register.py", f"import {entry_module_name} as _\n")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
209	            for source in sources:
210	                zf.write(source, os.path.relpath(source))
211	            zf.writestr("register.py", f"import {entry_module_name} as _\n")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
216	                bundle_upload_url,
217	                data=zf.read(),
218	                headers=headers,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
234	        j = {
235	            "project_id": project_ids.get(f.project),
236	            "name": f.name,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
283	                            "type": "slug",
284	                            "project_id": project_ids.get(f.project),
285	                            "slug": f.slug,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	        j = {
292	            "project_id": project_ids.get(p.project),
293	            "name": p.name,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/cli/push.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
368	        "--app-url",
369	        help="Specify a custom Braintrust app url. Defaults to https://www.braintrust.dev. This is only necessary if you are using an experimental version of Braintrust.",
370	    )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/framework.py:1027
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1026	        if self._thread_pool is None:
1027	            self._thread_pool = ThreadPoolExecutor(max_workers=self._max_workers)
1028	        return self._thread_pool

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
278	NOOP_SPAN: Span = _NoopSpan()
279	NOOP_SPAN_PERMALINK = "https://braintrust.dev/noop-span"
280	
281	
282	class BraintrustState:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
314	            memory_cache=LRUCache(
315	                max_size=int(os.environ.get("BRAINTRUST_PROMPT_CACHE_MEMORY_MAX_SIZE", str(1 << 10)))
316	            ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
317	            disk_cache=DiskCache(
318	                cache_dir=os.environ.get(
319	                    "BRAINTRUST_PROMPT_CACHE_DIR", f"{os.environ.get('HOME')}/.braintrust/prompt_cache"
320	                ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
318	                cache_dir=os.environ.get(
319	                    "BRAINTRUST_PROMPT_CACHE_DIR", f"{os.environ.get('HOME')}/.braintrust/prompt_cache"
320	                ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	                ),
321	                max_size=int(os.environ.get("BRAINTRUST_PROMPT_CACHE_DISK_MAX_SIZE", str(1 << 20))),
322	                serializer=lambda x: x.as_dict(),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
376	    def global_bg_logger(self) -> "_BackgroundLogger":
377	        return getattr(self._override_bg_logger, "logger", None) or self._global_bg_logger.get()
378	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
380	    def login_replace_api_conn(self, api_conn: "HTTPConnection"):
381	        self._global_bg_logger.get().internal_replace_api_conn(api_conn)
382	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
461	        try:
462	            resp = self.get("ping")
463	            _state.set_user_info_if_null(resp.json())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
502	    def get(self, path: str, *args: Any, **kwargs: Any) -> requests.Response:
503	        return self.session.get(_urljoin(self.base_url, path), *args, **kwargs)
504	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
505	    def post(self, path: str, *args: Any, **kwargs: Any) -> requests.Response:
506	        return self.session.post(_urljoin(self.base_url, path), *args, **kwargs)
507	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
518	        for i in range(tries):
519	            resp = self.get(f"/{object_type}", params=args)
520	            if i < tries - 1 and not resp.ok:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
529	    def post_json(self, object_type: str, args: Optional[Mapping[str, Any]] = None) -> Any:
530	        resp = self.post(f"/{object_type.lstrip('/')}", json=args)
531	        response_raise_for_status(resp)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
537	# concurrency.
538	HTTP_REQUEST_THREAD_POOL = concurrent.futures.ThreadPoolExecutor(max_workers=cpu_count())
539	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
600	        with self.lock:
601	            logs = [l.get() for l in self.logs]  # unwrap the LazyValues
602	            self.logs = []

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
671	        self.start_thread_lock = threading.RLock()
672	        self.thread = threading.Thread(target=self._publisher, daemon=True)
673	        self.started = False

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
764	                    for batch in batch_set:
765	                        self._submit_logs_request(batch)
766	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
779	                    if result["upload_status"] == "error":
780	                        raise RuntimeError(result.get("error_message"))
781	                except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
796	            try:
797	                unwrapped_items = [item.get() for item in wrapped_items]
798	                batched_items = merge_row_batch(unwrapped_items)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:827
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
826	    def _submit_logs_request(self, items: Sequence[str]):
827	        conn = self.api_conn.get()
828	        dataStr = construct_logs3_data(items)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
832	            start_time = time.time()
833	            resp = conn.post("/logs3", data=dataStr)
834	            if resp.ok:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:895
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
894	            with open(payload_file, "w") as f:
895	                f.write(payload)
896	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1147	            except AugmentedHTTPError as e:
1148	                if args.get("base_experiment") is not None and "base experiment" in str(e):
1149	                    _logger.warning(f"Base experiment {args['base_experiment']} not found.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1344	            try:
1345	                return _state._prompt_cache.get(
1346	                    slug,
1347	                    version=str(version) if version else "latest",
1348	                    project_id=project_id,
1349	                    project_name=project,
1350	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1421	        if app_url is None:
1422	            app_url = os.environ.get("BRAINTRUST_APP_URL", "https://www.braintrust.dev")
1423	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1421	        if app_url is None:
1422	            app_url = os.environ.get("BRAINTRUST_APP_URL", "https://www.braintrust.dev")
1423	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1423	
1424	        app_public_url = os.environ.get("BRAINTRUST_APP_PUBLIC_URL", app_url)
1425	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1426	        if api_key is None:
1427	            api_key = os.environ.get("BRAINTRUST_API_KEY")
1428	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1429	        if org_name is None:
1430	            org_name = os.environ.get("BRAINTRUST_ORG_NAME")
1431	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1440	            app_conn.set_token(api_key)
1441	            resp = app_conn.post("api/apikey/login")
1442	            if not resp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1535	
1536	    return _state.current_span.get()
1537	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1601	        # We assume 'name' is the first positional argument in `start_span`.
1602	        if len(span_args) == 0 and span_kwargs.get("name") is None:
1603	            span_args += (f.__name__,)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1713
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1712	            _state.org_name = orgs["name"]
1713	            _state.api_url = os.environ.get("BRAINTRUST_API_URL", orgs["api_url"])
1714	            _state.proxy_url = os.environ.get("BRAINTRUST_PROXY_URL", orgs["proxy_url"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1714
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1713	            _state.api_url = os.environ.get("BRAINTRUST_API_URL", orgs["api_url"])
1714	            _state.proxy_url = os.environ.get("BRAINTRUST_PROXY_URL", orgs["proxy_url"])
1715	            _state.git_metadata_settings = GitMetadataSettings(**(orgs.get("git_metadata") or {}))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1715
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1714	            _state.proxy_url = os.environ.get("BRAINTRUST_PROXY_URL", orgs["proxy_url"])
1715	            _state.git_metadata_settings = GitMetadataSettings(**(orgs.get("git_metadata") or {}))
1716	            break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1798	            # Base case: AttachmentReference.
1799	            if v.get("type") == "braintrust_attachment" or v.get("type") == "external_attachment":
1800	                return ReadonlyAttachment(cast(AttachmentReference, v))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1799
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1798	            # Base case: AttachmentReference.
1799	            if v.get("type") == "braintrust_attachment" or v.get("type") == "external_attachment":
1800	                return ReadonlyAttachment(cast(AttachmentReference, v))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1845	
1846	    scores = event.get("scores")
1847	    if scores:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1863	
1864	    metadata = event.get("metadata")
1865	    if metadata:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1871	
1872	    metrics = event.get("metrics")
1873	    if metrics:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1884
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1883	
1884	    tags = event.get("tags")
1885	    if tags:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1887	
1888	    span_attributes = event.get("span_attributes")
1889	    if span_attributes:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1896
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1895	
1896	    input = event.get("input")
1897	    inputs = event.get("inputs")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1897
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1896	    input = event.get("input")
1897	    inputs = event.get("inputs")
1898	    if input is not None and inputs is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1909	def _validate_and_sanitize_experiment_log_full_args(event: Mapping[str, Any], has_dataset: bool) -> Mapping[str, Any]:
1910	    input = event.get("input")
1911	    inputs = event.get("inputs")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1910	    input = event.get("input")
1911	    inputs = event.get("inputs")
1912	    if (input is not None and inputs is not None) or (input is None and inputs is None):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1914	
1915	    if event.get("output") is None:
1916	        raise ValueError("output must be specified")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:1917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1916	        raise ValueError("output must be specified")
1917	    if event.get("scores") is None:
1918	        raise ValueError("scores must be specified")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2055	            while True:
2056	                resp = state.api_conn().post(
2057	                    f"btql",
2058	                    json={
2059	                        "query": {
2060	                            **(self._internal_btql or {}),
2061	                            "select": [{"op": "star"}],
2062	                            "from": {
2063	                                "op": "function",
2064	                                "name": {
2065	                                    "op": "ident",
2066	                                    "name": [self.object_type],
2067	                                },
2068	                                "args": [
2069	                                    {
2070	                                        "op": "literal",
2071	                                        "value": self.id,
2072	                                    },
2073	                                ],
2074	                            },
2075	                            "cursor": cursor,
2076	                            "limit": INTERNAL_BTQL_LIMIT,
2077	                        },
2078	                        "use_columnstore": False,
2079	                        "brainstore_realtime": True,
2080	                    },
2081	                    headers={
2082	                        "Accept-Encoding": "gzip",
2083	                    },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2088
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2087	                data = (data or []) + cast(List[TMapping], resp_json["data"])
2088	                if not resp_json.get("cursor", None):
2089	                    break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2090
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2089	                    break
2090	                cursor = resp_json.get("cursor", None)
2091	                iterations += 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2111	        else:
2112	            return max([str(record.get(TRANSACTION_ID_FIELD, "0")) for record in self._refetch()] or ["0"])
2113	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2179	        """The attachment contents. This is a lazy value that will read the attachment contents from disk or memory on first access."""
2180	        return self._data.get()
2181	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2187	        """
2188	        return self._uploader.get()
2189	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2209	            try:
2210	                metadata_response = api_conn.post("/attachment", json=request_params)
2211	                metadata_response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2216	            try:
2217	                data = self._data.get()
2218	            except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2220	
2221	            signed_url = metadata.get("signedUrl")
2222	            headers = metadata.get("headers")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2221	            signed_url = metadata.get("signedUrl")
2222	            headers = metadata.get("headers")
2223	            if not isinstance(signed_url, str) or not isinstance(headers, dict):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2262	            try:
2263	                status_response = api_conn.post("/attachment/status", json=request_params)
2264	                status_response.raise_for_status()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2276	                with open(data, "rb") as f:
2277	                    return f.read()
2278	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2326	        """The attachment contents. This is a lazy value that will read the attachment contents from the external object store on first access."""
2327	        return self._data.get()
2328	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2371	        """The attachment contents. This is a lazy value that will read the attachment contents from the object store on first access."""
2372	        return self._data.get()
2373	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2391	
2392	        response = api_conn.get("/attachment", params=params)
2393	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2415	                obj_conn = HTTPConnection(base_url="", adapter=_http_adapter)
2416	                obj_response = obj_conn.get(download_url)
2417	                obj_response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2462	        object_type=parent_object_type,
2463	        object_id=parent_object_id.get(),
2464	    ).object_id_fields()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2516	        object_type=parent_object_type,
2517	        object_id=parent_object_id.get(),
2518	    ).object_id_fields()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2541	    """
2542	    if event.get("id") is not None:
2543	        raise ValueError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2648	            assert (
2649	                parent_object_id.get() == parent_components_object_id
2650	            ), f"Mismatch between expected span parent object id {parent_object_id.get()} and provided id {parent_components_object_id}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2649	                parent_object_id.get() == parent_components_object_id
2650	            ), f"Mismatch between expected span parent object id {parent_object_id.get()} and provided id {parent_components_object_id}"
2651	            return parent_object_id.get()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2650	            ), f"Mismatch between expected span parent object id {parent_object_id.get()} and provided id {parent_components_object_id}"
2651	            return parent_object_id.get()
2652	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2707	
2708	            output, expected = value.get("output"), value.get("expected")
2709	            ret: _ExperimentDatasetEvent = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2708
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2707	
2708	            output, expected = value.get("output"), value.get("expected")
2709	            ret: _ExperimentDatasetEvent = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2709	            ret: _ExperimentDatasetEvent = {
2710	                "input": value.get("input"),
2711	                "expected": expected if expected is not None else output,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2711	                "expected": expected if expected is not None else output,
2712	                "tags": value.get("tags"),
2713	                "id": value["id"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2752	    def id(self) -> str:
2753	        return self._lazy_metadata.get().experiment.id
2754	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2756	    def name(self) -> str:
2757	        return self._lazy_metadata.get().experiment.name
2758	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2761
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2760	    def data(self) -> Mapping[str, Any]:
2761	        return self._lazy_metadata.get().experiment.full_info
2762	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2764	    def project(self) -> ObjectMetadata:
2765	        return self._lazy_metadata.get().project
2766	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2773
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2772	    def __getattr__(self, name: str) -> Any:
2773	        return self._lazy_metadata.get().experiment.full_info[name]
2774	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2776	        # Ensure the login state is populated by fetching the lazy_metadata.
2777	        self._lazy_metadata.get()
2778	        return _state

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
2911	
2912	        resp = conn.post("/api/base_experiment/get_id", json={"id": self.id})
2913	        if resp.status_code == 400:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2961
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2960	            )
2961	            score_items = summary_items.get("scores", {})
2962	            metric_items = summary_items.get("metrics", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:2962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2961	            score_items = summary_items.get("scores", {})
2962	            metric_items = summary_items.get("metrics", {})
2963	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3063
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3062	    def id(self) -> str:
3063	        return self._lazy_metadata.get().experiment.id
3064	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3067
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3066	        # Ensure the login state is populated by fetching the lazy_metadata.
3067	        self._lazy_metadata.get()
3068	        return _state

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3218	        serializable_partial_record = _deep_copy_event(partial_record)
3219	        if serializable_partial_record.get("metrics", {}).get("end") is not None:
3220	            self._logged_end_time = serializable_partial_record["metrics"]["end"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3218	        serializable_partial_record = _deep_copy_event(partial_record)
3219	        if serializable_partial_record.get("metrics", {}).get("end") is not None:
3220	            self._logged_end_time = serializable_partial_record["metrics"]["end"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3221	
3222	        if len(serializable_partial_record.get("tags", [])) > 0 and self.span_parents:
3223	            raise Exception("Tags can only be logged to the root span")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3227	                **serializable_partial_record,
3228	                **{k: v.get() for k, v in lazy_partial_record.items()},
3229	                **SpanComponentsV3(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3230	                    object_type=self.parent_object_type,
3231	                    object_id=self.parent_object_id.get(),
3232	                ).object_id_fields(),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3291	        else:
3292	            object_id = self.parent_object_id.get()
3293	            compute_object_metadata_args = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3409	    def id(self) -> str:
3410	        return self._lazy_metadata.get().dataset.id
3411	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3413	    def name(self) -> str:
3414	        return self._lazy_metadata.get().dataset.name
3415	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3417	    def data(self):
3418	        return self._lazy_metadata.get().dataset.full_info
3419	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3421	    def project(self):
3422	        return self._lazy_metadata.get().project
3423	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3425	    def __getattr__(self, name: str) -> Any:
3426	        return self._lazy_metadata.get().dataset.full_info[name]
3427	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3429	        # Ensure the login state is populated by fetching the lazy_metadata.
3430	        self._lazy_metadata.get()
3431	        return _state

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3736	
3737	    response_format = params.get("response_format")
3738	    if not response_format or not isinstance(response_format, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3740	
3741	    if response_format.get("type") != "json_schema":
3742	        return params

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3743	
3744	    json_schema = response_format.get("json_schema")
3745	    if not json_schema or not isinstance(json_schema, dict):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3747	
3748	    raw_schema = json_schema.get("schema")
3749	    if raw_schema is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3780	    def id(self) -> str:
3781	        return self._lazy_metadata.get().id
3782	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3784	    def name(self) -> str:
3785	        return self._lazy_metadata.get().name
3786	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3788	    def slug(self) -> str:
3789	        return self._lazy_metadata.get().slug
3790	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3792	    def prompt(self) -> Optional[PromptBlockData]:
3793	        return self._lazy_metadata.get().prompt_data.prompt
3794	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3796	    def version(self) -> str:
3797	        return self._lazy_metadata.get()._xact_id
3798	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3800	    def options(self) -> PromptOptions:
3801	        return self._lazy_metadata.get().prompt_data.options or {}
3802	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3805
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3804	    def __getattr__(self, name: str) -> Any:
3805	        return getattr(self._lazy_metadata.get(), name)
3806	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3815	
3816	        params = self.options.get("params") or {}
3817	        params = {k: v for (k, v) in params.items() if k not in BRAINTRUST_PARAMS}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3824	
3825	        if ret.get("model") is None:
3826	            raise ValueError("No model specified. Either specify it in the prompt or as a default")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3936
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3935	    def org_id(self) -> str:
3936	        return self._lazy_metadata.get().org_id
3937	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3939	    def project(self) -> ObjectMetadata:
3940	        return self._lazy_metadata.get().project
3941	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:3952
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
3951	        # Ensure the login state is populated by fetching the lazy_metadata.
3952	        self._lazy_metadata.get()
3953	        return _state

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/logger.py:4128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
4127	        else:
4128	            object_id = self._lazy_id.get()
4129	            compute_object_metadata_args = None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/disk_cache.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
83	            with gzip.open(file_path, "rb") as f:
84	                data = json.loads(f.read().decode("utf-8"))
85	                if self._deserializer is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/disk_cache.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	                    value = self._serializer(value)
115	                f.write(json.dumps(value).encode("utf-8"))
116	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
18	        try:
19	            shutil.rmtree(self.cache_dir, ignore_errors=True)
20	        except Exception:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
70	        os.makedirs(self.cache_dir, exist_ok=True)
71	        os.chmod(self.cache_dir, 0o444)
72	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:71
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
70	        os.makedirs(self.cache_dir, exist_ok=True)
71	        os.chmod(self.cache_dir, 0o444)
72	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
80	        # Make cache directory unreadable.
81	        os.chmod(self.cache_dir, 0o000)
82	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:81
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
80	        # Make cache directory unreadable.
81	        os.chmod(self.cache_dir, 0o000)
82	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
87	        # Restore permissions so cleanup can happen.
88	        os.chmod(self.cache_dir, 0o777)
89	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:88
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
87	        # Restore permissions so cleanup can happen.
88	        os.chmod(self.cache_dir, 0o777)
89	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
95	        with open(file_path, "w") as f:
96	            f.write("invalid data")
97	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
95	        with open(file_path, "w") as f:
96	            f.write("invalid data")
97	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
108	        # Make cache directory unreadable.
109	        os.chmod(self.cache_dir, 0o000)
110	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:109
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
108	        # Make cache directory unreadable.
109	        os.chmod(self.cache_dir, 0o000)
110	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
115	        # Restore permissions so cleanup can happen.
116	        os.chmod(self.cache_dir, 0o777)
117	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:116
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
115	        # Restore permissions so cleanup can happen.
116	        os.chmod(self.cache_dir, 0o777)
117	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
125	        # Make cache directory read-only.
126	        os.chmod(self.cache_dir, 0o444)
127	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_disk_cache.py:126
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
125	        # Make cache directory read-only.
126	        os.chmod(self.cache_dir, 0o444)
127	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_prompt_cache.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
36	        try:
37	            shutil.rmtree(self.cache_dir, ignore_errors=True)
38	        except Exception:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_prompt_cache.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
101	        # Make cache directory read-only.
102	        os.chmod(self.cache_dir, 0o444)
103	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_prompt_cache.py:102
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
101	        # Make cache directory read-only.
102	        os.chmod(self.cache_dir, 0o444)
103	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_prompt_cache.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
112	        # Restore permissions so cleanup can happen.
113	        os.chmod(self.cache_dir, 0o777)
114	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/prompt_cache/test_prompt_cache.py:113
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
112	        # Restore permissions so cleanup can happen.
113	        os.chmod(self.cache_dir, 0o777)
114	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v1.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
105	
106	        return base64.b64encode(raw_bytes).decode()
107	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v1.py:106
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
105	
106	        return base64.b64encode(raw_bytes).decode()
107	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v1.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
110	        try:
111	            raw_bytes = base64.b64decode(s.encode())
112	            assert raw_bytes[0] == ENCODING_VERSION_NUMBER

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v1.py:111
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
110	        try:
111	            raw_bytes = base64.b64decode(s.encode())
112	            assert raw_bytes[0] == ENCODING_VERSION_NUMBER

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v2.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
134	
135	        return base64.b64encode(raw_bytes).decode()
136	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v2.py:135
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
134	
135	        return base64.b64encode(raw_bytes).decode()
136	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v2.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
139	        try:
140	            raw_bytes = base64.b64decode(s.encode())
141	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v2.py:140
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
139	        try:
140	            raw_bytes = base64.b64decode(s.encode())
141	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v3.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
144	            raw_bytes += bytes(json.dumps(json_obj, separators=(",", ":")).encode())
145	        return base64.b64encode(raw_bytes).decode()
146	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v3.py:145
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
144	            raw_bytes += bytes(json.dumps(json_obj, separators=(",", ":")).encode())
145	        return base64.b64encode(raw_bytes).decode()
146	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v3.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
149	        try:
150	            raw_bytes = base64.b64decode(s.encode())
151	            json_obj = {}

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/span_identifier_v3.py:150
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
149	        try:
150	            raw_bytes = base64.b64decode(s.encode())
151	            json_obj = {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/test_logger.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
309	    span = braintrust.NOOP_SPAN
310	    assert span.permalink() == "https://braintrust.dev/noop-span"
311	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/test_logger.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
312	    link = braintrust.permalink(span.export())
313	    assert link == "https://braintrust.dev/noop-span"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/braintrust-0.0.197/braintrust-0.0.197/src/braintrust/util.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	        full_path = path + (k,)
45	        merge_into_v = merge_into.get(k)
46	        if isinstance(merge_into_v, dict) and isinstance(merge_from_v, dict) and full_path not in merge_paths:

--------------------------------------------------

Code scanned:
	Total lines of code: 10534
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 30.0
		High: 150.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 164.0
		High: 16.0
Files skipped (0):
