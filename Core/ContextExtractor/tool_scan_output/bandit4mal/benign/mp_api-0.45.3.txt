Run started:2025-04-12 10:41:02.130660

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/docs/conf.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	## the Python standard library
120	intersphinx_mapping = {"https://docs.python.org/3.8": None}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
119	        self.base_endpoint = self.endpoint = endpoint or os.getenv(
120	            "MP_API_ENDPOINT", "https://api.materialsproject.org/"
121	        )
122	        self.debug = debug

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
184	            python_info = f"Python/{sys.version.split()[0]}"
185	            platform_info = f"{platform.system()}/{platform.release()}"
186	            user_agent = f"{mp_api_info} ({python_info} {platform_info})"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
184	            python_info = f"Python/{sys.version.split()[0]}"
185	            platform_info = f"{platform.system()}/{platform.release()}"
186	            user_agent = f"{mp_api_info} ({python_info} {platform_info})"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:185
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
184	            python_info = f"Python/{sys.version.split()[0]}"
185	            platform_info = f"{platform.system()}/{platform.release()}"
186	            user_agent = f"{mp_api_info} ({python_info} {platform_info})"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	        """
230	        return requests.get(url=endpoint + "heartbeat").json()["db_version"]
231	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
262	                    url += "/"
263	            response = self.session.post(url, json=payload, verify=True, params=params)
264	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
398	        if "jsonl" in key:
399	            decoded_data = [decoder(jline) for jline in file.read().splitlines()]
400	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
400	        else:
401	            decoded_data = decoder(file.read())
402	            if not isinstance(decoded_data, list):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
501	                for page in pages:
502	                    for obj in page.get("Contents", []):
503	                        key = obj.get("Key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
502	                    for obj in page.get("Contents", []):
503	                        key = obj.get("Key")
504	                        if key and "manifest" not in key:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
552	
553	                byte_data = self._multi_thread(
554	                    self._query_open_data,
555	                    list(s3_params_list.values()),
556	                    pbar,  # type: ignore
557	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
716	
717	        initial_data_tuples = self._multi_thread(
718	            self._submit_request_and_process, initial_params_list
719	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:775
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
774	            if len(rebalance_params) > 0:
775	                rebalance_data_tuples = self._multi_thread(
776	                    self._submit_request_and_process, rebalance_params
777	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
832	        # Warning to select specific fields only for many results
833	        if criteria.get("_all_fields", False) and (total_num_docs / chunk_size > 10):
834	            warnings.warn(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:875
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
874	        # Submit requests and process data
875	        data_tuples = self._multi_thread(
876	            self._submit_request_and_process, params_list, pbar
877	        )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:915
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
914	
915	        with ThreadPoolExecutor(
916	            max_workers=MAPIClientSettings().NUM_PARALLEL_REQUESTS  # type: ignore
917	        ) as executor:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:990
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
989	        try:
990	            response = self.session.get(
991	                url=url,
992	                verify=verify,
993	                params=params,
994	                timeout=timeout,
995	                headers=headers if headers else self.headers,
996	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:1019
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1018	
1019	            meta_total_doc_num = data.get("meta", {}).get("total_doc", 1)
1020	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:1019
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1018	
1019	            meta_total_doc_num = data.get("meta", {}).get("total_doc", 1)
1020	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/core/client.py:1152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1151	        """
1152	        return self._query_resource(  # type: ignore
1153	            criteria=criteria,
1154	            fields=fields,
1155	            suburl=suburl,
1156	            use_document_model=use_document_model,
1157	            chunk_size=1000,
1158	            num_chunks=1,
1159	        ).get("data")
1160	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        # SETTINGS tries to read API key from ~/.config/.pmgrc.yaml
165	        api_key = api_key or os.getenv("MP_API_KEY") or SETTINGS.get("PMG_MAPI_KEY")
166	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	            raise ValueError(
169	                "Please use a new API key from https://materialsproject.org/api "
170	                "Keys for the new API are 32 characters, whereas keys for the legacy "
171	                "API are 16 characters."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
175	        self.endpoint = endpoint or os.getenv(
176	            "MP_API_ENDPOINT", "https://api.materialsproject.org/"
177	        )
178	        self.headers = headers or {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
479	        """
480	        return get(url=self.endpoint + "heartbeat").json()["db_version"]
481	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
489	        """
490	        response = get(url=endpoint + "heartbeat").json()
491	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
491	
492	        error = response.get("error", None)
493	        if error:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:936
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
935	        """
936	        return self.contribs.query_contributions(  # type: ignore
937	            query={"project": "ion_ref_data"},
938	            fields=["identifier", "formula", "data"],
939	            paginate=True,
940	        ).get(
941	            "data"
942	        )  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:1402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1401	                mp_id = doc_dict["material_id"]
1402	                if meta.get(mp_id) is None:
1403	                    meta[mp_id] = [{"task_id": task_id, "calc_type": calc_type}]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:1414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1413	        # check if these task ids exist on NOMAD
1414	        prefix = "https://nomad-lab.eu/prod/rae/api/repo/?"
1415	        if file_patterns is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:1430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1429	        # generate download links for those that exist
1430	        prefix = "https://nomad-lab.eu/prod/rae/api/raw/query?"
1431	        if file_patterns is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:1450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1449	    def _check_nomad_exist(url) -> bool:
1450	        response = get(url=url)
1451	        if response.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:1553
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1552	                entries[prefered_func]["total_energy_per_atom"],
1553	                atomic_energies[run_type_to_dfa.get(prefered_func, prefered_func)],
1554	                normalization=normalization,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/mp_api/client/mprester.py:1578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1577	        """
1578	        _atomic_energies = self.contribs.query_contributions(
1579	            query={"project": "isolated_atom_energies"},
1580	            fields=["formula", *[f"data.{dfa}.energy" for dfa in funcs]],
1581	        ).get("data")
1582	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mp_api-0.45.3/mp_api-0.45.3/tests/test_mprester.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    fake_mp_api_key = "12345678901234567890123456789012"  # 32 chars
43	    default_endpoint = "https://api.materialsproject.org/"
44	
45	    def test_get_structure_by_material_id(self, mpr):

--------------------------------------------------

Code scanned:
	Total lines of code: 8535
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 1.0
Files skipped (0):
