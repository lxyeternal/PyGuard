Run started:2025-04-12 14:04:16.503519

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/envtpl.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
72	    except (Fatal, IOError) as e:
73	        sys.stderr.write("Error: %s\n" % str(e))
74	        sys.exit(1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/envtpl.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	    else:
103	        output = _render_string(stdin_read(), variables, undefined)
104	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/envtpl.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	        with open(output_filename, "wb") as f:
107	            f.write(output.encode("utf-8"))
108	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/envtpl.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
108	    else:
109	        stdout_write(output)
110	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/envtpl.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
128	    if IS_PYTHON_2:
129	        return _unicodify(sys.stdin.read())
130	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/envtpl.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
130	    else:
131	        return io.TextIOWrapper(sys.stdin.buffer, encoding="utf-8").read()
132	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/envtpl.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	    if IS_PYTHON_2:
136	        sys.stdout.write(_unicodify(output))
137	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/envtpl.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
137	    else:
138	        io.TextIOWrapper(sys.stdout.buffer, encoding="utf-8").write(output)
139	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/setup.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	
3	long_description = """
4	envtpl
5	======
6	
7	_Render jinja2 templates on the command line with shell environment variables_
8	
9	Installation
10	------------
11	
12	    pip install envtpl
13	
14	How-to
15	------
16	
17	Say you have a configuration file called whatever.conf that looks like this
18	
19	    foo = 123
20	    bar = "abc"
21	
22	You can use envtpl to set `foo` and `bar` from the command line by creating a file called whatever.conf.tpl
23	
24	    foo = {{ FOO }}
25	    bar = "{{ BAR }}"
26	
27	If you run
28	
29	    FOO=123 BAR=abc envtpl < whatever.conf.tpl > whatever.conf
30	
31	you'll get back the original whatever.conf.
32	
33	You can also specify default values
34	
35	    foo = {{ FOO | default(123) }}
36	    bar = "{{ BAR | default("abc") }}"
37	
38	Running
39	
40	    FOO=456 envtpl < whatever.conf.tpl > whatever.conf
41	
42	will generate
43	
44	    foo = 456
45	    bar = "abc"
46	
47	This is all standard [Jinja2 syntax](http://jinja.pocoo.org/docs/templates/), so you can do things like
48	
49	    {% if BAZ is defined %}
50	    foo = 123
51	    {% else %}
52	    foo = 456
53	    {% endif %}
54	    bar = "abc"
55	
56	If an environment variable is missing, envtpl will throw an error
57	
58	    $ echo '{{ FOO }} {{ BAR }}' | FOO=123 envtpl
59	    Error: 'BAR' is undefined
60	
61	You can change this behaviour to insert empty strings instead by passing the `--allow-missing` flag.
62	
63	Instead of reading from stdin and writing to stdout, you can pass the input filename as an optional positional argument,
64	and set the output filename with the `--output-file` (`-o`) argument.
65	
66	    envtpl -o whatever.conf  whatever.conf.tpl
67	
68	As a convenience, if you don't specify an output filename and the input filename ends with `.tpl`, the output filename will be the input filename without the `.tpl` extension, i.e.
69	
70	    envtpl whatever.conf.tpl
71	    # is equivalent to
72	    envtpl -o whatever.conf whatever.conf.tpl
73	
74	By default, envtpl will **delete** the input template file. You can keep it by passing the `--keep-template` flag.
75	
76	There's a special `environment(prefix='')` function that you can use as a kind of wildcard variable. If you have `hello.tpl`
77	
78	    hello = {{ FOO }}
79	    {% for key, value in environment('MY_') %}{{ key }} = {{ value }}
80	    {% endfor %}
81	
82	and compile it using
83	
84	    FOO=world MY_baz=qux MY_foo=bar envtpl hello.tpl
85	
86	You end up with
87	
88	    hello = world
89	    baz = qux
90	    foo = bar
91	
92	What's the point?
93	-----------------
94	
95	I use this script quite a lot in Docker images. Usually I'll have the CMD execute some file, like /bin/start_container, that sets up the runtime configuration for the container by inserting environment variables into config files before starting the main process. A redis example could look like this
96	
97	    #!/bin/bash
98	    # start_container
99	
100	    envtpl /etc/redis.conf.tpl
101	
102	    redis-server
103	
104	This is the use case I've optimised for, so that's why envtpl by default will delete the original template file.
105	"""  # noqa
106	
107	setup(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/envtpl-0.7.2/envtpl-0.7.2/setup.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	    ],
132	    url="https://github.com/andreasjansson/envtpl",
133	)

--------------------------------------------------

Code scanned:
	Total lines of code: 229
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 8.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 0.0
Files skipped (0):
