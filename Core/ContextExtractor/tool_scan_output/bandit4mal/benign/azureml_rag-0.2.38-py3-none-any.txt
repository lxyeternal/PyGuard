Run started:2025-04-12 10:36:38.723762

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/_configuration.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	        self.credential_scopes = kwargs.pop(
54	            'credential_scopes', ['https://management.azure.com/.default'])
55	        kwargs.setdefault(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/dataset/_configuration.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	        self.credential_scopes = kwargs.pop(
39	            "credential_scopes", ["https://management.azure.com/.default"])
40	        kwargs.setdefault(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/dataset/_serialization.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1047	        """
1048	        return b64encode(attr).decode()
1049	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/dataset/_serialization.py:1048
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1047	        """
1048	        return b64encode(attr).decode()
1049	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/dataset/_serialization.py:1057
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1056	        """
1057	        encoded = b64encode(attr).decode("ascii")
1058	        return encoded.strip("=").replace("+", "-").replace("/", "_")

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/dataset/_serialization.py:1057
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1056	        """
1057	        encoded = b64encode(attr).decode("ascii")
1058	        return encoded.strip("=").replace("+", "-").replace("/", "_")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/dataset/_serialization.py:1850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1849	            attr = attr.text
1850	        return bytearray(b64decode(attr))  # type: ignore
1851	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/dataset/_serialization.py:1850
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1849	            attr = attr.text
1850	        return bytearray(b64decode(attr))  # type: ignore
1851	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/dataset/_serialization.py:1865
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1864	        encoded = attr.replace("-", "+").replace("_", "/")
1865	        return b64decode(encoded)
1866	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/dataset/_serialization.py:1865
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1864	        encoded = attr.replace("-", "+").replace("_", "/")
1865	        return b64decode(encoded)
1866	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/_asset_client/_restclient/runhistory/_configuration.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        self.credential_scopes = kwargs.pop(
46	            'credential_scopes', ['https://management.azure.com/.default'])
47	        kwargs.setdefault(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/data_generation/qa.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
153	        with open(filepath) as f:
154	            template = f.read()
155	        if qa_type == QAType.SUMMARY:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/data_generation/qa.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
162	        with open(filepath) as f:
163	            template = f.read()
164	        return PromptTemplate(template=template, input_variables=["questions"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/documents/__init__.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	            if "dev.azure.com" in remote_url:
150	                remote_url = remote_url.replace("https://ssh.dev.azure.com/v3/", "")
151	                try:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/embeddings/florence.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
34	        try:
35	            res = requests.post(
36	                url=self.embedding_uri,
37	                data=image_bytes,
38	                headers={
39	                    "Content-Type": "application/octet-stream",
40	                    "apim-request-id": str(uuid.uuid4()),
41	                    "Ocp-Apim-Subscription-Key": self.api_key,
42	                },

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/indexes/index_stores.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
162	        """Given a document ID, construct a payload used to delete the corresponding document from the index."""
163	        return {"id": base64.urlsafe_b64encode(document_id.encode("utf-8")).decode("utf-8")}
164	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/indexes/index_stores.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
183	
184	        doc_id_encoded = base64.urlsafe_b64encode(document_id.encode("utf-8")).decode("utf-8")
185	        acs_doc = {

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/indexes/index_stores.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
325	
326	        return DeleteOne({"_id": base64.urlsafe_b64encode(document_id.encode("utf-8")).decode("utf-8")})
327	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/indexes/index_stores.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
342	
343	        doc_id_encoded = base64.urlsafe_b64encode(document_id.encode("utf-8")).decode("utf-8")
344	        azure_cosmos_mongo_vcore_doc = {

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/indexes/index_stores.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
425	        """Given a document ID, construct a payload used to delete the corresponding document from the index."""
426	        return base64.urlsafe_b64encode(document_id.encode("utf-8")).decode("utf-8")
427	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/indexes/index_stores.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
442	
443	        doc_id_encoded = base64.urlsafe_b64encode(document_id.encode("utf-8")).decode("utf-8")
444	        milvus_doc = {

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/indexes/index_stores.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
518	        """Given a document ID, construct a payload used to delete the corresponding document from the index."""
519	        return base64.urlsafe_b64encode(document_id.encode("utf-8")).decode("utf-8")
520	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/indexes/index_stores.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
535	
536	        doc_id_encoded = base64.urlsafe_b64encode(document_id.encode("utf-8")).decode("utf-8")
537	        pinecone_doc = {"id": doc_id_encoded, "values": document_embeddings}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/indexes/index_stores.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
621	
622	        doc_id_encoded = base64.urlsafe_b64encode(document_id.encode("utf-8")).decode("utf-8")
623	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    if isinstance(credential, DefaultAzureCredential):
37	        headers["Authorization"] = f"Bearer {credential.get_token('https://search.azure.com/.default').token}"
38	    elif isinstance(credential, AzureKeyCredential):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	
96	        if self.field_mapping.get("embedding", None) is not None:
97	            logger.info(f"Using embedding field: {self.field_mapping['embedding']}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	            post_payload["vectors"] = [{"value": embedded_query, "fields": self.field_mapping["embedding"], "k": k}]
99	            if kwargs.get("include_embedding_vector", False):
100	                post_payload["select"] += f",{self.field_mapping['embedding']}"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
101	
102	        response = send_post_request(post_url, headers, post_payload)
103	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
113	                            "id": item["id"],
114	                            "doc_id": base64.b64decode(item["id"]).decode("utf8"),
115	                            **(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
113	                            "id": item["id"],
114	                            "doc_id": base64.b64decode(item["id"]).decode("utf8"),
115	                            **(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	                    )
122	                    if self.field_mapping.get("embedding", None) is not None and kwargs.get(
123	                        "include_embedding_vector", False

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	                    )
122	                    if self.field_mapping.get("embedding", None) is not None and kwargs.get(
123	                        "include_embedding_vector", False
124	                    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	                    ):
125	                        doc.metadata["content_vector"] = (item.get(self.field_mapping["embedding"], []),)
126	                    results.append((doc, item["@search.score"]))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	        """Search for similar documents by vector with relevance scores."""
143	        if self.field_mapping.get("embedding", None) is None:
144	            raise ValueError("No embedding field specified in field_mapping")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/acs.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
148	        """Search for similar documents by vector."""
149	        if self.field_mapping.get("embedding", None) is None:
150	            raise ValueError("No embedding field specified in field_mapping")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/langchain/vendor/vectorstores/cosmosdbnosql.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
268	        try:
269	            properties = self._container.read()
270	            vector_embeddings = properties['vectorEmbeddingPolicy']['vectorEmbeddings']

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/mlindex.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1117	                    ) as dest:
1118	                        dest.write(src.read())
1119	        except Exception as e:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/mlindex.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1117	                    ) as dest:
1118	                        dest.write(src.read())
1119	        except Exception as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/mlindex.py:1118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1117	                    ) as dest:
1118	                        dest.write(src.read())
1119	        except Exception as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	            config["api_version"] = (
62	                kwargs.get("api_version") if kwargs.get("api_version") is not None else "2023-03-15-preview"
63	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	            config["api_version"] = (
62	                kwargs.get("api_version") if kwargs.get("api_version") is not None else "2023-03-15-preview"
63	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
91	    try:
92	        if config.get("key") is not None:
93	            config["api_key"] = config.get("key")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	        if config.get("key") is not None:
93	            config["api_key"] = config.get("key")
94	        elif "connection_type" not in config:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        elif "connection_type" not in config:
95	            if config.get("api_key") is None:
96	                config["api_key"] = os.environ.get("OPENAI_API_KEY", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
95	            if config.get("api_key") is None:
96	                config["api_key"] = os.environ.get("OPENAI_API_KEY", None)
97	            if config["api_key"] is None and "azure" in config["api_type"]:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
98	                credential = get_default_azure_credential() if credential is None else credential
99	                config["api_key"] = credential.get_token("https://cognitiveservices.azure.com/.default").token
100	                config["api_type"] = "azure_ad"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	            if config["connection_type"] == "workspace_connection":
103	                connection_id = config.get("connection", {}).get("id", "")
104	                connection = get_connection_by_id_v2(connection_id, credential=credential)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	            if config["connection_type"] == "workspace_connection":
103	                connection_id = config.get("connection", {}).get("id", "")
104	                connection = get_connection_by_id_v2(connection_id, credential=credential)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	                    isinstance(connection, dict)
123	                    and connection.get("properties", {}).get("category", None) == "AzureOpenAI"
124	                ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	                    isinstance(connection, dict)
123	                    and connection.get("properties", {}).get("category", None) == "AzureOpenAI"
124	                ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	                ):
125	                    config["api_base"] = connection.get("properties", {}).get("target")
126	                    connection_metadata = connection.get("properties", {}).get("metadata", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	                ):
125	                    config["api_base"] = connection.get("properties", {}).get("target")
126	                    connection_metadata = connection.get("properties", {}).get("metadata", {})

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	                    config["api_base"] = connection.get("properties", {}).get("target")
126	                    connection_metadata = connection.get("properties", {}).get("metadata", {})
127	                    config["api_version"] = connection_metadata.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	                    config["api_base"] = connection.get("properties", {}).get("target")
126	                    connection_metadata = connection.get("properties", {}).get("metadata", {})
127	                    config["api_version"] = connection_metadata.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	                    connection_metadata = connection.get("properties", {}).get("metadata", {})
127	                    config["api_version"] = connection_metadata.get(
128	                        "apiVersion", connection_metadata.get("ApiVersion", "2023-03-15-preview")
129	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	                    config["api_version"] = connection_metadata.get(
128	                        "apiVersion", connection_metadata.get("ApiVersion", "2023-03-15-preview")
129	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	                    )
130	                    config["api_type"] = connection_metadata.get(
131	                        "apiType", connection_metadata.get("ApiType", "azure")
132	                    ).lower()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	                    config["api_type"] = connection_metadata.get(
131	                        "apiType", connection_metadata.get("ApiType", "azure")
132	                    ).lower()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	                # Add hack to check for "BAKER-OPENAI-API-KEY"
143	                if config.get("connection_type", "workspace_keyvault") == "workspace_keyvault":
144	                    new_args = copy.deepcopy(config)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	            config["api_key"] = os.environ["OPENAI_API_KEY"]
158	            config["api_type"] = os.environ.get("OPENAI_API_TYPE", "azure")
159	            config["api_base"] = os.environ.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
158	            config["api_type"] = os.environ.get("OPENAI_API_TYPE", "azure")
159	            config["api_base"] = os.environ.get(
160	                "OPENAI_API_BASE", openai.api_base if hasattr(openai, "api_base") else openai.base_url
161	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	            )
162	            config["api_version"] = os.environ.get("OPENAI_API_VERSION", openai.api_version)
163	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	    if isinstance(openai.api_type, str) and "azure" in openai.api_type:
167	        config["api_version"] = config.get("api_version", "2023-03-15-preview")
168	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
183	        # The embedding config doesn't specify a connection, but does specify a serverless endpoint instead.
184	        endpoint_id = config.get("endpoint", {}).get("id", "")
185	        if credential is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
183	        # The embedding config doesn't specify a connection, but does specify a serverless endpoint instead.
184	        endpoint_id = config.get("endpoint", {}).get("id", "")
185	        if credential is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
187	
188	        auth_header = f"Bearer {credential.get_token('https://management.azure.com/.default').token}"
189	        endpoint = requests.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
188	        auth_header = f"Bearer {credential.get_token('https://management.azure.com/.default').token}"
189	        endpoint = requests.get(
190	            f"https://management.azure.com{endpoint_id}?api-version=2024-01-01-preview",
191	            headers={"Authorization": auth_header},
192	        ).json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	        endpoint = requests.get(
190	            f"https://management.azure.com{endpoint_id}?api-version=2024-01-01-preview",
191	            headers={"Authorization": auth_header},

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
192	        ).json()
193	        endpoint_keys = requests.post(
194	            f"https://management.azure.com{endpoint_id}/listKeys?api-version=2024-01-01-preview",
195	            headers={"Authorization": auth_header},
196	        ).json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
193	        endpoint_keys = requests.post(
194	            f"https://management.azure.com{endpoint_id}/listKeys?api-version=2024-01-01-preview",
195	            headers={"Authorization": auth_header},

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	
198	        api_base = endpoint.get("properties", {}).get("inferenceEndpoint", {}).get("uri").rstrip("/")
199	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	
198	        api_base = endpoint.get("properties", {}).get("inferenceEndpoint", {}).get("uri").rstrip("/")
199	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	
198	        api_base = endpoint.get("properties", {}).get("inferenceEndpoint", {}).get("uri").rstrip("/")
199	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	        config["api_base"] = f"{api_base}/v1"
202	        config["api_key"] = endpoint_keys.get("primaryKey")
203	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	            # Best-effort model name retrieval
206	            info_response = requests.get(
207	                f"{api_base}/info", headers={"Authorization": f"Bearer {endpoint_keys.get('primaryKey')}"}
208	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	            info_response = requests.get(
207	                f"{api_base}/info", headers={"Authorization": f"Bearer {endpoint_keys.get('primaryKey')}"}
208	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
210	            info_json = info_response.json()
211	            config["model"] = info_json.get("model_name") or info_json.get("served_model_name") or "generic_embed"
212	        except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
210	            info_json = info_response.json()
211	            config["model"] = info_json.get("model_name") or info_json.get("served_model_name") or "generic_embed"
212	        except Exception:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	
215	    elif config.get("connection_type", "").lower() == "workspace_connection":
216	        # The embedding config specifies a workspace connection to a serverless endpoint.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	        # The embedding config specifies a workspace connection to a serverless endpoint.
217	        connection_id = config.get("connection", {}).get("id", "")
218	        connection = get_connection_by_id_v2(connection_id, credential=credential)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	        # The embedding config specifies a workspace connection to a serverless endpoint.
217	        connection_id = config.get("connection", {}).get("id", "")
218	        connection = get_connection_by_id_v2(connection_id, credential=credential)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	                config["model"] = (
226	                    connection.metadata.get("model_name")
227	                    or connection.metadata.get("served_model_name")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
226	                    connection.metadata.get("model_name")
227	                    or connection.metadata.get("served_model_name")
228	                    or "generic_embed"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	                )
230	        elif isinstance(connection, dict) and connection.get("properties", {}).get("category", None) == "Serverless":
231	            api_base = connection.get("properties", {}).get("target").rstrip("/")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	                )
230	        elif isinstance(connection, dict) and connection.get("properties", {}).get("category", None) == "Serverless":
231	            api_base = connection.get("properties", {}).get("target").rstrip("/")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
230	        elif isinstance(connection, dict) and connection.get("properties", {}).get("category", None) == "Serverless":
231	            api_base = connection.get("properties", {}).get("target").rstrip("/")
232	            config["api_base"] = f"{api_base}/v1"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
230	        elif isinstance(connection, dict) and connection.get("properties", {}).get("category", None) == "Serverless":
231	            api_base = connection.get("properties", {}).get("target").rstrip("/")
232	            config["api_base"] = f"{api_base}/v1"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	            config["api_base"] = f"{api_base}/v1"
233	            connection_metadata = connection.get("properties", {}).get("metadata", {})
234	            config["api_type"] = "serverless"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
232	            config["api_base"] = f"{api_base}/v1"
233	            connection_metadata = connection.get("properties", {}).get("metadata", {})
234	            config["api_type"] = "serverless"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
235	            config["model"] = (
236	                connection_metadata.get("model_name") or connection_metadata.get("served_model_name") or "generic_embed"
237	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
235	            config["model"] = (
236	                connection_metadata.get("model_name") or connection_metadata.get("served_model_name") or "generic_embed"
237	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244	    else:
245	        raise ValueError("Unknown connection type " + config.get("connection_type"))
246	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	    model_kwargs = {
260	        "frequency_penalty": model_config.get("frequency_penalty", 0),
261	        "presence_penalty": model_config.get("presence_penalty", 0),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	        "frequency_penalty": model_config.get("frequency_penalty", 0),
261	        "presence_penalty": model_config.get("presence_penalty", 0),
262	    }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
262	    }
263	    if model_config.get("stop") is not None:
264	        model_kwargs["stop"] = model_config.get("stop")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	    if model_config.get("stop") is not None:
264	        model_kwargs["stop"] = model_config.get("stop")
265	    if model_config.get("kind", "").lower() == "open_ai" and model_config.get("api_type", "").lower() == "azure":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
264	        model_kwargs["stop"] = model_config.get("stop")
265	    if model_config.get("kind", "").lower() == "open_ai" and model_config.get("api_type", "").lower() == "azure":
266	        model_config = init_open_ai_from_config(model_config)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
264	        model_kwargs["stop"] = model_config.get("stop")
265	    if model_config.get("kind", "").lower() == "open_ai" and model_config.get("api_type", "").lower() == "azure":
266	        model_config = init_open_ai_from_config(model_config)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	                model=model_config["model"],
277	                max_tokens=model_config.get("max_tokens"),
278	                model_kwargs=model_kwargs,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
278	                model_kwargs=model_kwargs,
279	                openai_api_key=model_config.get("api_key"),
280	                openai_api_base=model_config.get("api_base"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
279	                openai_api_key=model_config.get("api_key"),
280	                openai_api_base=model_config.get("api_base"),
281	                openai_api_type=model_config.get("api_type"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
280	                openai_api_base=model_config.get("api_base"),
281	                openai_api_type=model_config.get("api_type"),
282	                openai_api_version=model_config.get("api_version"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
281	                openai_api_type=model_config.get("api_type"),
282	                openai_api_version=model_config.get("api_version"),
283	                max_retries=model_config.get("max_retries", 3),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
282	                openai_api_version=model_config.get("api_version"),
283	                max_retries=model_config.get("max_retries", 3),
284	                **kwargs,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
285	            )  # type: ignore
286	            if model_config.get("temperature", None) is not None:
287	                llm.temperature = model_config.get("temperature")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
286	            if model_config.get("temperature", None) is not None:
287	                llm.temperature = model_config.get("temperature")
288	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
293	                model=model_config["model"],
294	                max_tokens=model_config.get("max_tokens"),
295	                model_kwargs=model_kwargs,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
295	                model_kwargs=model_kwargs,
296	                openai_api_key=model_config.get("api_key"),
297	                max_retries=model_config.get("max_retries", 3),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
296	                openai_api_key=model_config.get("api_key"),
297	                max_retries=model_config.get("max_retries", 3),
298	                **kwargs,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
299	            )  # type: ignore
300	            if model_config.get("temperature", None) is not None:
301	                llm.temperature = model_config.get("temperature")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
300	            if model_config.get("temperature", None) is not None:
301	                llm.temperature = model_config.get("temperature")
302	    elif model_config.get("kind", "").lower() == "open_ai" and model_config.get("api_type", "").lower() == "open_ai":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
301	                llm.temperature = model_config.get("temperature")
302	    elif model_config.get("kind", "").lower() == "open_ai" and model_config.get("api_type", "").lower() == "open_ai":
303	        logger.info(f"Initializing OpenAI with model {model_config['model']} with kwargs: {model_kwargs}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
301	                llm.temperature = model_config.get("temperature")
302	    elif model_config.get("kind", "").lower() == "open_ai" and model_config.get("api_type", "").lower() == "open_ai":
303	        logger.info(f"Initializing OpenAI with model {model_config['model']} with kwargs: {model_kwargs}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
306	            model=model_config["model"],
307	            max_tokens=model_config.get("max_tokens"),
308	            model_kwargs=model_kwargs,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
308	            model_kwargs=model_kwargs,
309	            openai_api_key=model_config.get("api_key"),
310	            **kwargs,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
311	        )  # type: ignore
312	        if model_config.get("temperature", None) is not None:
313	            llm.temperature = model_config.get("temperature")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
312	        if model_config.get("temperature", None) is not None:
313	            llm.temperature = model_config.get("temperature")
314	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/models.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
314	    else:
315	        raise ValueError(f"Unsupported llm kind: {model_config.get('kind')}")
316	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crack_and_chunk.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
62	        for chunk in chunks:
63	            f.write(chunk.dumps())
64	            f.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crack_and_chunk.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
63	            f.write(chunk.dumps())
64	            f.write("\n")
65	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	    for link in soup.find_all("a"):
71	        url = link.get("href")
72	        if url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	    # Fetch URL
121	    r = requests.get(url)
122	    if r.status_code == HTTPStatus.MOVED_PERMANENTLY and r.headers.get("location") and redirectsRemaining > 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	    r = requests.get(url)
122	    if r.status_code == HTTPStatus.MOVED_PERMANENTLY and r.headers.get("location") and redirectsRemaining > 0:
123	        return download(r.headers.get("location"), destination, writtenFiles, links, redirectsRemaining - 1)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
122	    if r.status_code == HTTPStatus.MOVED_PERMANENTLY and r.headers.get("location") and redirectsRemaining > 0:
123	        return download(r.headers.get("location"), destination, writtenFiles, links, redirectsRemaining - 1)
124	    elif r.status_code != HTTPStatus.OK:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	    if r.status_code == HTTPStatus.MOVED_PERMANENTLY and r.headers.get("location") and redirectsRemaining > 0:
123	        return download(r.headers.get("location"), destination, writtenFiles, links, redirectsRemaining - 1)
124	    elif r.status_code != HTTPStatus.OK:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	    # Get extension
129	    extension = try_get_extension_for_media_type(url, r.headers.get("content-type"))
130	    if extension is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
130	    if extension is None:
131	        logger.info(f"Skipping unsupported url {url} with media type {r.headers.get('content-type')}")
132	        return

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
134	    # Check content length
135	    content_length = r.headers.get("content-length")
136	    if content_length and int(content_length) > maxFileSize:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
157	    with open(output_dest, "wb") as f:
158	        f.write(data)
159	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	        logger.info(f"Starting crawl with args: {json.dumps(args, indent=2)}")
164	        max_crawl_time = args.get("max_crawl_time", 60)
165	        max_crawl_depth = args.get("max_crawl_depth", 0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        max_crawl_time = args.get("max_crawl_time", 60)
165	        max_crawl_depth = args.get("max_crawl_depth", 0)
166	        max_files = args.get("max_files", 1000)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	        max_crawl_depth = args.get("max_crawl_depth", 0)
166	        max_files = args.get("max_files", 1000)
167	        max_redirects = args.get("max_redirects", 3)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
166	        max_files = args.get("max_files", 1000)
167	        max_redirects = args.get("max_redirects", 3)
168	        max_download_time = args.get("max_download_time", 15)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
167	        max_redirects = args.get("max_redirects", 3)
168	        max_download_time = args.get("max_download_time", 15)
169	        max_file_size = args.get("max_file_size", 5000000)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	        max_download_time = args.get("max_download_time", 15)
169	        max_file_size = args.get("max_file_size", 5000000)
170	        support_http = args.get("support_http", False)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
169	        max_file_size = args.get("max_file_size", 5000000)
170	        support_http = args.get("support_http", False)
171	        output_path = args.get("output_path", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
170	        support_http = args.get("support_http", False)
171	        output_path = args.get("output_path", None)
172	        url = args.get("url", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
171	        output_path = args.get("output_path", None)
172	        url = args.get("url", None)
173	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/crawl_url.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
195	                        with time_limit(max_download_time):
196	                            download(
197	                                link,
198	                                output_path,
199	                                writtenFiles,
200	                                links,
201	                                logger,
202	                                redirectsRemaining,
203	                                max_file_size,
204	                                supportHttp=support_http,
205	                            )

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/embed.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
283	            # Replace concurrent futures with multiprocessing Pool
284	            with mp.Pool(processes=num_workers) as pool:
285	                # Start processes to take chunks from the queue and embed them

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/embed.py:284
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
283	            # Replace concurrent futures with multiprocessing Pool
284	            with mp.Pool(processes=num_workers) as pool:
285	                # Start processes to take chunks from the queue and embed them

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/image_embed_index.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
92	                    image_bytes = im.read()
93	                    converted_string = base64.b64encode(image_bytes)
94	                    base64_string = converted_string.decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/image_embed_index.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
92	                    image_bytes = im.read()
93	                    converted_string = base64.b64encode(image_bytes)
94	                    base64_string = converted_string.decode()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/update_acs.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
432	            logger.error(
433	                "Floats quota exceeded on Azure Cognitive Search Service. For more information check these docs: https://github.com/Azure/cognitive-search-vector-pr#storage-and-vector-index-size-limits"
434	            )
435	            logger.error(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/update_acs.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
435	            logger.error(
436	                "The usage statistic of an index can be checked using this REST API: https://learn.microsoft.com/en-us/rest/api/searchservice/get-index-statistics "
437	            )
438	            activity_logger.activity_info["error_classification"] = "UserError"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	    """Validate default AOAI deployments and attempt creation if does not exist."""
73	    resource_group_name = model_params.get("resource_group", resource_group)
74	    deployment_name = model_params["deployment_id"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	    try:
83	        response = client.deployments.get(
84	            resource_group_name=resource_group_name,
85	            account_name=account_name,
86	            deployment_name=deployment_name,
87	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
94	        proxy_subscription_id = hub_workspace_details["subscriptions"]
95	        proxy_resource_group = hub_workspace_details.get("resourceGroups", hub_workspace_details["resourcegroups"])
96	        proxy_workspace_name = hub_workspace_details["workspaces"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	        client.deployments.get.metadata["url"] = proxy_url
113	        response = client.deployments.get(
114	            resource_group_name=proxy_resource_group,
115	            account_name=account_name,
116	            deployment_name=deployment_name,
117	            api_version=api_version,
118	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
150	    openai.api_version = model_params["openai_api_version"]
151	    openai.api_key = model_params.get("openai_api_key")
152	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	                    api_version=model_params["openai_api_version"],
252	                    api_key=model_params.get("openai_api_key"),
253	                    azure_ad_token_provider=model_params.get("azure_ad_token_provider"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
252	                    api_key=model_params.get("openai_api_key"),
253	                    azure_ad_token_provider=model_params.get("azure_ad_token_provider"),
254	                    deployment=model_params["deployment_id"],

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254	                    deployment=model_params["deployment_id"],
255	                    batch_size=model_params.get("batch_size"),
256	                    max_retries=model_params.get("embedding_ctx_length"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
255	                    batch_size=model_params.get("batch_size"),
256	                    max_retries=model_params.get("embedding_ctx_length"),
257	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
321	    if isinstance(connection, dict):
322	        return connection.get("name") == "Default_AzureOpenAI"
323	    return connection.name == "Default_AzureOpenAI"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
358	            connection_metadata = get_metadata_from_connection(llm_connection)
359	            completion_params["openai_api_type"] = connection_metadata.get(
360	                "apiType", connection_metadata.get("ApiType", "azure")
361	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
359	            completion_params["openai_api_type"] = connection_metadata.get(
360	                "apiType", connection_metadata.get("ApiType", "azure")
361	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
361	            )
362	            completion_params["openai_api_version"] = connection_metadata.get(
363	                "apiVersion",
364	                connection_metadata.get("ApiVersion", "2023-03-15-preview"),
365	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
363	                "apiVersion",
364	                connection_metadata.get("ApiVersion", "2023-03-15-preview"),
365	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
408	            connection_metadata = get_metadata_from_connection(embeddings_connection)
409	            embedding_params["openai_api_type"] = connection_metadata.get(
410	                "apiType", connection_metadata.get("ApiType", "azure")
411	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
409	            embedding_params["openai_api_type"] = connection_metadata.get(
410	                "apiType", connection_metadata.get("ApiType", "azure")
411	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
411	            )
412	            embedding_params["openai_api_version"] = connection_metadata.get(
413	                "apiVersion",
414	                connection_metadata.get("ApiVersion", "2023-03-15-preview"),
415	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
413	                "apiVersion",
414	                connection_metadata.get("ApiVersion", "2023-03-15-preview"),
415	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	    """Get model info from OpenAI."""
452	    endpoint = f"https://api.openai.com/v1/models/{model}"
453	    headers = {"Authorization": f"Bearer {key}"}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
454	    try:
455	        response = requests.get(endpoint, headers=headers)
456	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
508	    #  Do not validate ACS if inputs are not sufficient
509	    if not acs_config or not acs_config.get("index_name") or not acs_connection_id:
510	        activity_logger.info("[Validate Deployments]: ACS config or ACS connection id is missing. Skip ACS validation.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
516	
517	    index_name = acs_config.get("index_name")
518	    if (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
536	    acs_metadata = get_metadata_from_connection(acs_connection)
537	    acs_config["api_version"] = acs_metadata.get("apiVersion", ACS_API_VERSION)
538	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
593	    if (embeddings_model and embeddings_model.startswith("azure_open_ai")) or (
594	        llm_config and llm_config.get("type") == "azure_open_ai"
595	    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:596
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
595	    ):
596	        completion_to_check = "Completion model" if (llm_config and llm_config.get("type") == "azure_open_ai") else ""
597	        embeddings_to_check = "Embeddings model" if embeddings_model.startswith("azure_open_ai") else ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
611	    if (embeddings_model and embeddings_model.startswith("open_ai")) or (
612	        llm_config and llm_config.get("type") == "open_ai"
613	    ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
613	    ):
614	        completion_to_check = "Completion model" if (llm_config and llm_config.get("type") == "open_ai") else ""
615	        embeddings_to_check = "Embeddings model" if embeddings_model.startswith("open_ai") else ""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
638	    if args.embeddings_connection_id is None:
639	        args.embeddings_connection_id = os.environ.get("AZUREML_WORKSPACE_CONNECTION_ID_AOAI_EMBEDDING", None)
640	        activity_logger.info(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
644	    if args.llm_connection_id is None:
645	        args.embeddings_connection_id = os.environ.get("AZUREML_WORKSPACE_CONNECTION_ID_AOAI_COMPLETION", None)
646	        activity_logger.info(f"Get default LLM connection id from environment variable: {args.llm_connection_id}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/tasks/validate_deployments.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
648	    if args.index_connection_id is None:
649	        args.index_connection_id = os.environ.get("AZUREML_WORKSPACE_CONNECTION_ID_ACS", None)
650	        activity_logger.info(f"Get default ACS connection id from environment variable: {args.index_connection_id}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
43	
44	    if config.get("connection_type", None) == "workspace_keyvault":
45	        from azureml.core import Run, Workspace

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	                ws = Workspace(
53	                    subscription_id=config.get("connection", {}).get("subscription"),
54	                    resource_group=config.get("connection", {}).get("resource_group"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	                ws = Workspace(
53	                    subscription_id=config.get("connection", {}).get("subscription"),
54	                    resource_group=config.get("connection", {}).get("resource_group"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	                    subscription_id=config.get("connection", {}).get("subscription"),
54	                    resource_group=config.get("connection", {}).get("resource_group"),
55	                    workspace_name=config.get("connection", {}).get("workspace"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	                    subscription_id=config.get("connection", {}).get("subscription"),
54	                    resource_group=config.get("connection", {}).get("resource_group"),
55	                    workspace_name=config.get("connection", {}).get("workspace"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	                    resource_group=config.get("connection", {}).get("resource_group"),
55	                    workspace_name=config.get("connection", {}).get("workspace"),
56	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	                    resource_group=config.get("connection", {}).get("resource_group"),
55	                    workspace_name=config.get("connection", {}).get("workspace"),
56	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	            except Exception as e:
58	                logger.warning(f"Could not get workspace '{config.get('connection', {}).get('workspace')}': {e}")
59	                # Fall back to looking for key in environment.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	            except Exception as e:
58	                logger.warning(f"Could not get workspace '{config.get('connection', {}).get('workspace')}': {e}")
59	                # Fall back to looking for key in environment.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	
62	                key = os.environ.get(config.get("connection", {}).get("key"))
63	                if key is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	
62	                key = os.environ.get(config.get("connection", {}).get("key"))
63	                if key is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	
62	                key = os.environ.get(config.get("connection", {}).get("key"))
63	                if key is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	                    raise ValueError(
65	                        f"Could not get workspace '{config.get('connection', {}).get('workspace')}' and no key named '{config.get('connection', {}).get('key')}' in environment"
66	                    ) from e

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	                    raise ValueError(
65	                        f"Could not get workspace '{config.get('connection', {}).get('workspace')}' and no key named '{config.get('connection', {}).get('key')}' in environment"
66	                    ) from e

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	                    raise ValueError(
65	                        f"Could not get workspace '{config.get('connection', {}).get('workspace')}' and no key named '{config.get('connection', {}).get('key')}' in environment"
66	                    ) from e

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	                    raise ValueError(
65	                        f"Could not get workspace '{config.get('connection', {}).get('workspace')}' and no key named '{config.get('connection', {}).get('key')}' in environment"
66	                    ) from e

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	        keyvault = ws.get_default_keyvault()
70	        connection_credential = AzureKeyCredential(keyvault.get_secret(config.get("connection", {}).get("key")))
71	    elif config.get("connection_type", None) == "workspace_connection":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	        keyvault = ws.get_default_keyvault()
70	        connection_credential = AzureKeyCredential(keyvault.get_secret(config.get("connection", {}).get("key")))
71	    elif config.get("connection_type", None) == "workspace_connection":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        connection_credential = AzureKeyCredential(keyvault.get_secret(config.get("connection", {}).get("key")))
71	    elif config.get("connection_type", None) == "workspace_connection":
72	        connection_id = config.get("connection", {}).get("id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	    elif config.get("connection_type", None) == "workspace_connection":
72	        connection_id = config.get("connection", {}).get("id")
73	        connection = get_connection_by_id_v2(connection_id, credential=credential)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
71	    elif config.get("connection_type", None) == "workspace_connection":
72	        connection_id = config.get("connection", {}).get("id")
73	        connection = get_connection_by_id_v2(connection_id, credential=credential)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	        connection_credential = connection_to_credential(connection, credential=credential, data_plane=data_plane)
75	    elif config.get("connection_type", None) == "environment":
76	        import os

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	
78	        key = os.environ.get(config.get("connection", {}).get("key", "OPENAI_API_KEY"))
79	        connection_credential = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	
78	        key = os.environ.get(config.get("connection", {}).get("key", "OPENAI_API_KEY"))
79	        connection_credential = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	
78	        key = os.environ.get(config.get("connection", {}).get("key", "OPENAI_API_KEY"))
79	        connection_credential = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	        props = connection["properties"]
110	        auth_type = props.get("authType", props.get("AuthType"))
111	        if auth_type == "ApiKey":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	        props = connection["properties"]
110	        auth_type = props.get("authType", props.get("AuthType"))
111	        if auth_type == "ApiKey":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
117	
118	            return AccessToken(props["credentials"]["pat"], props.get("expiresOn", None))
119	        elif auth_type == "AAD":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
121	                logger.info(
122	                    f"The '{connection.get('name', 'no-name connection')}' is an AAD auth type CognitiveSearch connection."
123	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	                logger.info(
127	                    f"The '{connection.get('name', 'no-name connection')}' is an AAD auth type AzureOpenAI connection."
128	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
140	            if (
141	                connection.get("metadata", {})
142	                .get("azureml.flow.connection_type", connection.get("ApiType", connection.get("apiType", "")))
143	                .lower()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
140	            if (
141	                connection.get("metadata", {})
142	                .get("azureml.flow.connection_type", connection.get("ApiType", connection.get("apiType", "")))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	                connection.get("metadata", {})
142	                .get("azureml.flow.connection_type", connection.get("ApiType", connection.get("apiType", "")))
143	                .lower()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	                connection.get("metadata", {})
142	                .get("azureml.flow.connection_type", connection.get("ApiType", connection.get("apiType", "")))
143	                .lower()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	        if not connection.credentials or isinstance(connection.credentials, NoneCredentialConfiguration):
163	            if connection.properties.get("authType", connection.properties.get("AuthType", "")).lower() == "aad":
164	                logger.info(f"The connection '{connection.name}' is a {type(connection)} with AAD auth type.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	        if not connection.credentials or isinstance(connection.credentials, NoneCredentialConfiguration):
163	            if connection.properties.get("authType", connection.properties.get("AuthType", "")).lower() == "aad":
164	                logger.info(f"The connection '{connection.name}' is a {type(connection)} with AAD auth type.")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
175	            raise ValueError(
176	                f"Unknown auth type '{connection.properties.get('authType', 'None')}' for connection '{connection.name}'"
177	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	        elif connection.credentials.type.lower() == "custom_keys":
199	            if connection._metadata.get("azureml.flow.connection_type", "").lower() == "openai":
200	                from azure.core.credentials import AzureKeyCredential

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
240	
241	    default_client_id = os.environ.get("DEFAULT_IDENTITY_CLIENT_ID", None)
242	    if default_client_id:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	        logger.info("Using DefaultAzureCredential.")
247	        logger.info(f"AZURE_CLIENT_ID: {os.environ.get('AZURE_CLIENT_ID', None)}")
248	        return DefaultAzureCredential(process_timeout=60)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
257	
258	    scopes = "https://cognitiveservices.azure.com/.default" if data_plane else "https://management.azure.com/.default"
259	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
257	
258	    scopes = "https://cognitiveservices.azure.com/.default" if data_plane else "https://management.azure.com/.default"
259	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
263	
264	    is_obo_enabled = os.environ.get("AZUREML_OBO_ENABLED", "False") == "True"
265	    if is_obo_enabled:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
274	        logger.info(f"Getting the token provider with DefaultAzureCredential. scopes: {scopes}.")
275	        logger.info(f"AZURE_CLIENT_ID: {os.environ.get('AZURE_CLIENT_ID', None)}")
276	        return get_bearer_token_provider(get_default_azure_credential(), scopes)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
282	
283	    is_obo_enabled = os.environ.get("AZUREML_OBO_ENABLED", "False") == "True"
284	    if is_obo_enabled:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
288	        logger.info("Using DefaultAzureCredential for authentication.")
289	        logger.info(f"AZURE_CLIENT_ID: {os.environ.get('AZURE_CLIENT_ID', None)}")
290	        credential = get_default_azure_credential()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
356	    if credential is None:
357	        if os.environ.get("AZUREML_RUN_ID", None) is not None:
358	            from azureml.dataprep.api._aml_auth._azureml_token_authentication import AzureMLTokenAuthentication

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
378	
379	        if os.environ.get("AZUREML_RUN_ID", None) is not None:
380	            # In AzureML Run context, we need to use workspaces internal endpoint that will accept AzureMLToken auth.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:382
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
381	            ml_client.connections._operation._client._base_url = (
382	                f"{os.environ.get('AZUREML_SERVICE_ENDPOINT')}/rp/workspaces"
383	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
410	                if isinstance(connection.credentials, AadCredentialConfiguration):
411	                    if connection.properties.get("authType") is None:
412	                        connection.properties["authType"] = "AAD"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
501	        if credential:
502	            bearer_token = credential.get_token("https://management.azure.com/.default").token
503	        if not bearer_token:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
504	            if hasattr(workspace._auth, "get_token"):
505	                bearer_token = workspace._auth.get_token("https://management.azure.com/.default").token
506	            else:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:513
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
512	    url = f"{endpoint}/rp/workspaces/subscriptions/{workspace.subscription_id}/resourcegroups/{workspace.resource_group}/providers/Microsoft.MachineLearningServices/workspaces/{workspace.name}/connections/{name}/listsecrets?api-version=2023-02-01-preview"
513	    resp = send_post_request(url, {"Authorization": f"Bearer {bearer_token}", "content-type": "application/json"}, {})
514	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
557	    """Create a connection in a workspace."""
558	    url = f"https://management.azure.com/subscriptions/{workspace.subscription_id}/resourcegroups/{workspace.resource_group}/providers/Microsoft.MachineLearningServices/workspaces/{workspace.name}/connections/{name}?api-version=2023-04-01-preview"
559	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
559	
560	    resp = send_put_request(
561	        url,
562	        {
563	            "Authorization": f"Bearer {workspace._auth.get_token('https://management.azure.com/.default').token}",
564	            "content-type": "application/json",
565	        },
566	        {
567	            "properties": {
568	                "category": category,
569	                "target": target,
570	                "authType": auth_type,
571	                "credentials": credentials,
572	                "metadata": metadata,
573	            }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/connections.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
562	        {
563	            "Authorization": f"Bearer {workspace._auth.get_token('https://management.azure.com/.default').token}",
564	            "content-type": "application/json",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/git.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	            authentication["username"] = username_match.group(1)
80	        git_repo_branch.git_url = re.sub(r"https:\/\/.*@(.*)", r"https://\1", git_repo_branch.git_url)
81	        git_repo_branch.git_url = git_repo_branch.git_url.replace(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/logging.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
377	        )
378	        _status_log.write("\n")
379	        _status_log.flush()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azureml_rag-0.2.38-py3-none-any/azureml/rag/utils/requests.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
54	    with create_session_with_retry() as session:
55	        response = session.post(url, data=json.dumps(payload), headers=headers)
56	        # Raise an exception if the response contains an HTTP error status code

--------------------------------------------------

Code scanned:
	Total lines of code: 36711
	Total lines skipped (#nosec): 3

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 208.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 227.0
		High: 7.0
Files skipped (0):
