Run started:2025-04-12 13:56:43.934300

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/__main__.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
184	        with open(hass_options_file, "rb") as _file:
185	            hass_options = json_loads(_file.read())
186	    else:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/constants.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
91	# config default values
92	DEFAULT_HOST: Final[str] = "0.0.0.0"
93	DEFAULT_PORT: Final[int] = 8095

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/constants.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	MASS_LOGO_ONLINE: Final[str] = (
117	    "https://github.com/home-assistant/brands/raw/master/custom_integrations/mass/icon%402x.png"
118	)
119	ENCRYPT_SUFFIX = "_encrypted_"
120	CONFIGURABLE_CORE_CONTROLLERS = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/constants.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
487	    label="Icon",
488	    description="Material design icon for this player. "
489	    "\n\nSee https://pictogrammers.com/library/mdi/",
490	    category="generic",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/cache.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
114	            try:
115	                data = await asyncio.to_thread(json_loads, db_row["data"])
116	            except Exception as exc:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/cache.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	            return
147	        data = await asyncio.to_thread(json_dumps, data)
148	        await self.database.insert_or_replace(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/config.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
92	        assert server_id
93	        fernet_key = base64.urlsafe_b64encode(server_id.encode()[:32])
94	        self._fernet = Fernet(fernet_key)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/config.py:797
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
796	                async with aiofiles.open(filename, encoding="utf-8") as _file:
797	                    self._data = json_loads(await _file.read())
798	                    LOGGER.debug("Loaded persistent settings from %s", filename)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/config.py:899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
898	        async with aiofiles.open(self.filename, "w", encoding="utf-8") as _file:
899	            await _file.write(json_dumps(self._data, indent=True))
900	        LOGGER.debug("Saved data to persistent storage")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/metadata.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175	        self._collage_images_dir = os.path.join(self.mass.cache_path, "collage_images")
176	        if not await asyncio.to_thread(os.path.exists, self._collage_images_dir):
177	            await asyncio.to_thread(os.mkdir, self._collage_images_dir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/metadata.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
176	        if not await asyncio.to_thread(os.path.exists, self._collage_images_dir):
177	            await asyncio.to_thread(os.mkdir, self._collage_images_dir)
178	        self.mass.streams.register_dynamic_route("/imageproxy", self.handle_imageproxy)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/metadata.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
374	        if base64:
375	            enc_image = b64encode(thumbnail).decode()
376	            thumbnail = f"data:image/{image_format};base64,{enc_image}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/metadata.py:375
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
374	        if base64:
375	            enc_image = b64encode(thumbnail).decode()
376	            thumbnail = f"data:image/{image_format};base64,{enc_image}"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/metadata.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
428	            async with aiofiles.open(file_path, "wb") as _file:
429	                await _file.write(img_data)
430	            del img_data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/music.py:1381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1380	            db_path_backup = db_path + ".backup"
1381	            await asyncio.to_thread(shutil.copyfile, db_path, db_path_backup)
1382	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/music.py:1398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1397	                await self.database.close()
1398	                await asyncio.to_thread(os.remove, db_path)
1399	                self.database = DatabaseConnection(db_path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/music.py:1573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1572	        db_path = os.path.join(self.mass.storage_path, "library.db")
1573	        await asyncio.to_thread(os.remove, db_path)
1574	        await self._setup_database()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
133	        if os.path.isdir(prev_cache_dir):
134	            shutil.rmtree(prev_cache_dir)
135	        # prefer /tmp/.audio as audio cache dir

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
218	                type=ConfigEntryType.STRING,
219	                default_value="0.0.0.0",
220	                options=[ConfigValueOption(x, x) for x in {"0.0.0.0", *ip_addresses}],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
219	                default_value="0.0.0.0",
220	                options=[ConfigValueOption(x, x) for x in {"0.0.0.0", *ip_addresses}],
221	                label="Bind to IP/interface",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
264	            self._audio_cache_dir = os.path.join(os.path.expanduser("~"), ".audio")
265	        if not await asyncio.to_thread(os.path.isdir, self._audio_cache_dir):
266	            await asyncio.to_thread(os.makedirs, self._audio_cache_dir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
265	        if not await asyncio.to_thread(os.path.isdir, self._audio_cache_dir):
266	            await asyncio.to_thread(os.makedirs, self._audio_cache_dir)
267	        # enable cache by default if we have enough free space only

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
352	        """Stream single queueitem audio to a player."""
353	        self._log_request(request)
354	        queue_id = request.match_info["queue_id"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
457	            try:
458	                await resp.write(chunk)
459	            except (BrokenPipeError, ConnectionResetError, ConnectionError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
471	                try:
472	                    await resp.write(chunk)
473	                except (BrokenPipeError, ConnectionResetError, ConnectionError):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
478	        """Stream Queue Flow audio to player."""
479	        self._log_request(request)
480	        queue_id = request.match_info["queue_id"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
559	            try:
560	                await resp.write(chunk)
561	            except (BrokenPipeError, ConnectionResetError, ConnectionError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
587	            length_b = chr(int(length / 16)).encode()
588	            await resp.write(length_b + metadata)
589	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
593	        """Handle special 'command' request for a player."""
594	        self._log_request(request)
595	        queue_id = request.match_info["queue_id"]

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
602	        """Stream announcement audio to a player."""
603	        self._log_request(request)
604	        player_id = request.match_info["player_id"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
662	            try:
663	                await resp.write(chunk)
664	            except (BrokenPipeError, ConnectionResetError):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
676	        """Stream PluginSource audio to a player."""
677	        self._log_request(request)
678	        plugin_source_id = request.match_info["plugin_source"]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
731	            try:
732	                await resp.write(chunk)
733	            except (BrokenPipeError, ConnectionResetError, ConnectionError):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/streams.py:1267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1266	        if foldersize > max_cache_size:
1267	            await asyncio.to_thread(_clean_old_files, foldersize)
1268	        # reschedule self

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/webserver.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
125	                type=ConfigEntryType.STRING,
126	                default_value="0.0.0.0",
127	                options=[ConfigValueOption(x, x) for x in {"0.0.0.0", *ip_addresses}],

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/webserver.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
126	                default_value="0.0.0.0",
127	                options=[ConfigValueOption(x, x) for x in {"0.0.0.0", *ip_addresses}],
128	                label="Bind to IP/interface",

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/webserver.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
177	            if config.get_value(CONF_EXPOSE_SERVER):
178	                bind_ip = "0.0.0.0"
179	                self.publish_ip = default_publish_ip

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/webserver.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
212	        async for chunk in get_preview_stream(self.mass, provider_instance_id_or_domain, item_id):
213	            await resp.write(chunk)
214	        return resp

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/controllers/webserver.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	            return web.Response(status=400, text="Body required")
234	        cmd_data = await request.read()
235	        self.logger.log(VERBOSE_LOG_LEVEL, "Received on JSONRPC API: %s", cmd_data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
95	                self._cache_file = cached_cache_path
96	                if await asyncio.to_thread(os.path.exists, self._cache_file):
97	                    # cache file already exists from a previous session,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
140	                while wait_loops < 2000:
141	                    chunk = await file.read(chunksize)
142	                    if chunk:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
154	
155	        if await asyncio.to_thread(os.path.exists, self._cache_file):
156	            if self._fetch_task is None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
211	                await asyncio.sleep(0.1)
212	                if not await asyncio.to_thread(os.path.exists, self._cache_file):
213	                    continue

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
213	                    continue
214	                if await asyncio.to_thread(os.path.getsize, self._cache_file) > 64000:
215	                    break

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
301	    async with aiofiles.open(fadeout_filename, "wb") as outfile:
302	        await outfile.write(fade_out_part)
303	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
978	    # Write all the contents in
979	    file.write(main_header)
980	    file.write(format_chunk)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
979	    file.write(main_header)
980	    file.write(format_chunk)
981	    file.write(data_chunk)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:981
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
980	    file.write(format_chunk)
981	    file.write(data_chunk)
982	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1104	        resp.raise_for_status()
1105	        raw_data = await resp.read()
1106	        encoding = resp.charset or await detect_charset(raw_data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:1209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1208	    if not streamdetails.size:
1209	        stat = await asyncio.to_thread(os.stat, filename)
1210	        streamdetails.size = stat.st_size

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:1237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1236	        while True:
1237	            data = await _file.read(chunk_size)
1238	            if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/audio.py:1253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1252	        for path in files_list:
1253	            await f.write(f"file '{path}'\n")
1254	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/didl_lite.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        return (
27	            '<DIDL-Lite xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:upnp="urn:schemas-upnp-org:metadata-1-0/upnp/" xmlns="urn:schemas-upnp-org:metadata-1-0/DIDL-Lite/" xmlns:dlna="urn:schemas-dlna-org:metadata-1-0/">'
28	            f'<item id="flowmode" parentID="0" restricted="1">'
29	            f"<dc:title>{xmlescape(title)}</dc:title>"
30	            f"<upnp:albumArtURI>{xmlescape(image_url)}</upnp:albumArtURI>"
31	            f"<dc:queueItemId>{media.uri}</dc:queueItemId>"
32	            "<upnp:class>object.item.audioItem.audioBroadcast</upnp:class>"
33	            f"<upnp:mimeType>audio/{ext}</upnp:mimeType>"
34	            f'<res protocolInfo="http-get:*:audio/{ext}:DLNA.ORG_PN={ext.upper()};DLNA.ORG_OP=01;DLNA.ORG_CI=0;DLNA.ORG_FLAGS=0d500000000000000000000000000000">{xmlescape(media.uri)}</res>'
35	            "</item>"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/didl_lite.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    return (
41	        '<DIDL-Lite xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:upnp="urn:schemas-upnp-org:metadata-1-0/upnp/" xmlns="urn:schemas-upnp-org:metadata-1-0/DIDL-Lite/" xmlns:r="urn:schemas-rinconnetworks-com:metadata-1-0/">'
42	        f'<item id="{media.queue_item_id or xmlescape(media.uri)}" restricted="true" parentID="{media.queue_id or ""}">'
43	        f"<dc:title>{xmlescape(media.title or media.uri)}</dc:title>"
44	        f"<dc:creator>{xmlescape(media.artist or '')}</dc:creator>"
45	        f"<upnp:album>{xmlescape(media.album or '')}</upnp:album>"
46	        f"<upnp:artist>{xmlescape(media.artist or '')}</upnp:artist>"
47	        f"<upnp:duration>{int(media.duration or 0)}</upnp:duration>"
48	        f"<dc:queueItemId>{xmlescape(media.queue_item_id)}</dc:queueItemId>"
49	        f"<dc:description>Music Assistant</dc:description>"
50	        f"<upnp:albumArtURI>{xmlescape(image_url)}</upnp:albumArtURI>"
51	        "<upnp:class>object.item.audioItem.musicTrack</upnp:class>"
52	        f"<upnp:mimeType>audio/{ext}</upnp:mimeType>"
53	        f'<res duration="{duration_str}" protocolInfo="http-get:*:audio/{ext}:DLNA.ORG_PN={ext.upper()};DLNA.ORG_OP=01;DLNA.ORG_CI=0;DLNA.ORG_FLAGS=0d500000000000000000000000000000">{xmlescape(media.uri)}</res>'
54	        '<desc id="cdudn" nameSpace="urn:schemas-rinconnetworks-com:metadata-1-0/">RINCON_AssociatedZPUDN</desc>'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/ffmpeg.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
173	                    return
174	                await self.write(chunk)
175	            self.logger.debug("Audio data source exhausted in %.2fs", time.time() - start)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
41	            async with mass.http_session.get(path_or_url, raise_for_status=True) as resp:
42	                return await resp.read()
43	        except ClientError as err:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
46	    if path_or_url.startswith("data:image"):
47	        return b64decode(path_or_url.split(",")[-1])
48	    # handle FILE location (of type image)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:47
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
46	    if path_or_url.startswith("data:image"):
47	        return b64decode(path_or_url.split(",")[-1])
48	    # handle FILE location (of type image)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
49	    if path_or_url.endswith(("jpg", "JPG", "png", "PNG", "jpeg")):
50	        if await asyncio.to_thread(os.path.isfile, path_or_url):
51	            async with aiofiles.open(path_or_url, "rb") as _file:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	            async with aiofiles.open(path_or_url, "rb") as _file:
52	                return await _file.read()
53	    # use ffmpeg for embedded images

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
88	    image_format = image_format.upper()
89	    return await asyncio.to_thread(_create_image)
90	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
100	
101	    collage = await asyncio.to_thread(_new_collage)
102	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
120	                if img_data:
121	                    await asyncio.to_thread(_add_to_collage, img_data, x_co, y_co)
122	                    del img_data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	
130	    return await asyncio.to_thread(_save_collage)
131	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/images.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	    async with aiofiles.open(icon_path) as _file:
138	        xml_data = await _file.read()
139	        return xml_data.replace("\n", "").strip()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/json.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
30	    if isinstance(obj, bytes):
31	        return base64.b64encode(obj).decode("ascii")
32	    if isinstance(obj, DO_NOT_SERIALIZE_TYPES):

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/json.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
30	    if isinstance(obj, bytes):
31	        return base64.b64encode(obj).decode("ascii")
32	    if isinstance(obj, DO_NOT_SERIALIZE_TYPES):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/process.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
113	        while True:
114	            chunk = await self.read(n)
115	            if len(chunk) == 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/process.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
136	            return b""
137	        return await self.proc.stdout.read(n)
138	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/process.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
142	            raise RuntimeError("write called while process already done")
143	        self.proc.stdin.write(data)
144	        with suppress(BrokenPipeError, ConnectionResetError):

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/process.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
218	        if send_signal and self.returncode is None:
219	            self.proc.send_signal(SIGINT)
220	        if self.proc.stdin and not self.proc.stdin.is_closing():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/tags.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
263	        """Return musicbrainz_recordingid tag if present."""
264	        if tag := self.tags.get("UFID:http://musicbrainz.org"):
265	            return tag

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/tags.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
432	    """Parse tags from a media file (or URL). Async friendly."""
433	    return await asyncio.to_thread(parse_tags, input_file, file_size, require_duration)
434	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/tags.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
563	            result["musicbrainzreleasegroupid"] = tags["TXXX:MusicBrainz Release Group Id"].text[0]
564	        if "UFID:http://musicbrainz.org" in tags:
565	            result["musicbrainzrecordingid"] = tags["UFID:http://musicbrainz.org"].data.decode()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/tags.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
564	        if "UFID:http://musicbrainz.org" in tags:
565	            result["musicbrainzrecordingid"] = tags["UFID:http://musicbrainz.org"].data.decode()
566	        if "TXXX:MusicBrainz Track Id" in tags:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/tags.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
609	    ) as ffmpeg:
610	        return await ffmpeg.read(-1)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/uri.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	    try:
36	        if uri.startswith("https://open."):
37	            # public share URL (e.g. Spotify or Qobuz, not sure about others)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/uri.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	            item_id = uri.split("/")[4].split("?")[0]
43	        elif uri.startswith("https://tidal.com/browse/"):
44	            # Tidal public share URL

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/uri.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	            media_type = MediaType(media_type_str)
65	        elif "/" in uri and await asyncio.to_thread(os.path.isfile, uri):
66	            # Translate a local file (which is not from a file provider!) to the builtin provider

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	
42	HA_WHEELS = "https://wheels.home-assistant.io/musllinux/"
43	
44	T = TypeVar("T")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
251	
252	    return await asyncio.to_thread(call)
253	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:259
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
258	    def _is_port_in_use() -> bool:
259	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as _sock:
260	            try:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
260	            try:
261	                _sock.bind(("0.0.0.0", port))
262	            except OSError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
265	
266	    return await asyncio.to_thread(_is_port_in_use)
267	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	
288	    return await asyncio.to_thread(_resolve)
289	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
293	    try:
294	        return await asyncio.to_thread(socket.inet_pton, socket.AF_INET, ip_string)
295	    except OSError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
295	    except OSError:
296	        return await asyncio.to_thread(socket.inet_pton, socket.AF_INET6, ip_string)
297	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
309	
310	    return await asyncio.to_thread(_get_folder_size, folderpath)
311	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
398	    try:
399	        return await asyncio.to_thread(pkg_version, pkg_name)
400	    except PackageNotFoundError:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
408	        try:
409	            urllib.request.urlopen("http://supervisor/core", timeout=1)
410	        except urllib.error.URLError as err:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:409
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
408	        try:
409	            urllib.request.urlopen("http://supervisor/core", timeout=1)
410	        except urllib.error.URLError as err:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
416	
417	    return await asyncio.to_thread(_check)
418	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
441	    try:
442	        return await asyncio.to_thread(_get_provider_module, domain)
443	    except ImportError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
448	    # this will fail if something else is wrong (as it should)
449	    return await asyncio.to_thread(_get_provider_module, domain)
450	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
465	
466	    return await asyncio.to_thread(_has_tmpfs_mount)
467	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
479	
480	    return await asyncio.to_thread(_get_free_space, folder)
481	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
493	
494	    return await asyncio.to_thread(_get_free_space, folder)
495	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
509	    """Remove file path (if it exists)."""
510	    if not await asyncio.to_thread(os.path.exists, file_path):
511	        return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
511	        return
512	    await asyncio.to_thread(os.remove, file_path)
513	    LOGGER.log(VERBOSE_LOG_LEVEL, "Removed file: %s", file_path)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
539	        await task
540	    await agen.aclose()
541	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/util.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
545	    try:
546	        detected = await asyncio.to_thread(chardet.detect, data)
547	        if detected and detected["encoding"] and detected["confidence"] > 0.75:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/helpers/webserver.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
71	        # set host to None to bind to all addresses on both IPv4 and IPv6
72	        host = None if bind_ip == "0.0.0.0" else bind_ip
73	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/mass.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
261	        async with aiofiles.open(logfile) as _file:
262	            return str(await _file.read())
263	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/mass.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
298	
299	        if ENABLE_DEBUG and not isinstance(threading.current_thread(), threading._MainThread):  # type: ignore[attr-defined]
300	            raise RuntimeError(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/mass.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
365	                return existing
366	        if ENABLE_DEBUG and not isinstance(threading.current_thread(), threading._MainThread):  # type: ignore[attr-defined]
367	            raise RuntimeError(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/mass.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
424	
425	        if ENABLE_DEBUG and not isinstance(threading.current_thread(), threading._MainThread):  # type: ignore[attr-defined]
426	            raise RuntimeError(

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/mass.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
585	            try:
586	                await provider.unload(is_removed)
587	            except Exception as err:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/mass.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
801	                info = AsyncServiceInfo(service_type, name)
802	                await info.async_request(zeroconf, 3000)
803	            await prov.on_mdns_service_state_change(name, state_change, info)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/helpers.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
107	    base_path = os.path.join(os.path.dirname(__file__), "bin")
108	    system = platform.system().lower().replace("darwin", "macos")
109	    architecture = platform.machine().lower()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/helpers.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
107	    base_path = os.path.join(os.path.dirname(__file__), "bin")
108	    system = platform.system().lower().replace("darwin", "macos")
109	    architecture = platform.machine().lower()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/helpers.py:108
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
107	    base_path = os.path.join(os.path.dirname(__file__), "bin")
108	    system = platform.system().lower().replace("darwin", "macos")
109	    architecture = platform.machine().lower()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
165	        self._dacp_server = await asyncio.start_server(
166	            self._handle_dacp_request, "0.0.0.0", dacp_port
167	        )
168	        zeroconf_type = "_dacp._tcp.local."

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
180	            },
181	            server=f"{socket.gethostname()}.local",
182	        )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py:181
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
180	            },
181	            server=f"{socket.gethostname()}.local",
182	        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
239	        if self._dacp_server:
240	            self._dacp_server.close()
241	        # shutdown DACP zeroconf service

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/provider.py:675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
674	        finally:
675	            writer.close()
676	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
280	        self._cliraop_proc = AsyncProcess(cliraop_args, stdin=True, stderr=True, name="cliraop")
281	        if platform.system() == "Darwin":
282	            os.environ["DYLD_LIBRARY_PATH"] = "/usr/local/lib"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
280	        self._cliraop_proc = AsyncProcess(cliraop_args, stdin=True, stderr=True, name="cliraop")
281	        if platform.system() == "Darwin":
282	            os.environ["DYLD_LIBRARY_PATH"] = "/usr/local/lib"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py:281
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
280	        self._cliraop_proc = AsyncProcess(cliraop_args, stdin=True, stderr=True, name="cliraop")
281	        if platform.system() == "Darwin":
282	            os.environ["DYLD_LIBRARY_PATH"] = "/usr/local/lib"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
320	        assert self._ffmpeg_proc
321	        await self._ffmpeg_proc.write(chunk)
322	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
341	            with suppress(BrokenPipeError), open(named_pipe, "w") as f:
342	                f.write(command)
343	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
346	        self.airplay_player.last_command_sent = time.time()
347	        await asyncio.to_thread(send_data)
348	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/airplay/raop.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
383	                break
384	            await self._cliraop_proc.write(chunk)
385	            self._stream_bytes_sent += len(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
128	        ) as _file:
129	            self._decrypt_client_id = await _file.read()
130	        async with aiofiles.open(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
132	        ) as _file:
133	            self._decrypt_private_key = await _file.read()
134	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
367	            raise MediaNotFoundError("No stream URL found for song.")
368	        key_id = base64.b64decode(uri.split(",")[1])
369	        return StreamDetails(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:368
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
367	            raise MediaNotFoundError("No stream URL found for song.")
368	        key_id = base64.b64decode(uri.split(",")[1])
369	        return StreamDetails(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:646
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
645	        """Get data from api."""
646	        url = f"https://api.music.apple.com/v1/{endpoint}"
647	        headers = {"Authorization": f"Bearer {DEVELOPER_TOKEN}"}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:689
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
688	        """Post data on api."""
689	        url = f"https://api.music.apple.com/v1/{endpoint}"
690	        headers = {"Authorization": f"Bearer {DEVELOPER_TOKEN}"}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
720	        """Get the stream URL for a song from Apple Music."""
721	        playback_url = "https://play.music.apple.com/WebObjects/MZPlay.woa/wa/webPlayback"
722	        data = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
765	            "accept": "application/json",
766	            "origin": "https://music.apple.com",
767	            "referer": "https://music.apple.com/",
768	            "accept-encoding": "gzip, deflate, br",
769	            "content-type": "application/json;charset=utf-8",
770	            "user-agent": (
771	                "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)"
772	                " Chrome/110.0.0.0 Safari/537.36"
773	            ),
774	        }
775	
776	    async def _get_decryption_key(
777	        self, license_url: str, key_id: bytes, uri: str, item_id: str

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:767
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
766	            "origin": "https://music.apple.com",
767	            "referer": "https://music.apple.com/",
768	            "accept-encoding": "gzip, deflate, br",
769	            "content-type": "application/json;charset=utf-8",
770	            "user-agent": (
771	                "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)"
772	                " Chrome/110.0.0.0 Safari/537.36"
773	            ),
774	        }
775	
776	    async def _get_decryption_key(
777	        self, license_url: str, key_id: bytes, uri: str, item_id: str
778	    ) -> str:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
813	        pssh_data.key_ids.append(key_id)
814	        init_data = base64.b64encode(pssh_data.SerializeToString()).decode("utf-8")
815	        return PSSH.new(system_id=PSSH.SystemId.Widevine, init_data=init_data)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:814
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
813	        pssh_data.key_ids.append(key_id)
814	        init_data = base64.b64encode(pssh_data.SerializeToString()).decode("utf-8")
815	        return PSSH.new(system_id=PSSH.SystemId.Widevine, init_data=init_data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:819
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
818	        """Get the license for a song based on the challenge."""
819	        challenge_b64 = base64.b64encode(challenge).decode("utf-8")
820	        data = {

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/apple_music/__init__.py:819
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
818	        """Get the license for a song based on the challenge."""
819	        challenge_b64 = base64.b64encode(challenge).decode("utf-8")
820	        data = {

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
124	        auth_file_path = os.path.join(storage_path, f"audible_auth_{uuid4().hex}.json")
125	        await asyncio.to_thread(auth.to_file, auth_file_path)
126	        values[CONF_AUTH_FILE] = auth_file_path

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
248	                self.logger.debug("Access token expired, refreshing")
249	                await asyncio.to_thread(auth.refresh_access_token)
250	                await asyncio.to_thread(auth.to_file, self.auth_file)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/__init__.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
249	                await asyncio.to_thread(auth.refresh_access_token)
250	                await asyncio.to_thread(auth.to_file, self.auth_file)
251	                self._AUTH_CACHE[self.instance_id] = auth

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	    logger.debug("Loading authenticator from file %s and caching it", path)
51	    auth = await asyncio.to_thread(audible.Authenticator.from_file, path)
52	    _AUTH_CACHE[path] = auth

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
561	        """Deregister this provider from Audible."""
562	        await asyncio.to_thread(self.client.auth.deregister_device)
563	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py:586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
585	    locale_obj = audible.localization.Locale(locale)
586	    code_verifier = await asyncio.to_thread(audible.login.create_code_verifier)
587	    oauth_url, serial = await asyncio.to_thread(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
586	    code_verifier = await asyncio.to_thread(audible.login.create_code_verifier)
587	    oauth_url, serial = await asyncio.to_thread(
588	        audible.login.build_oauth_url,
589	        country_code=locale_obj.country_code,
590	        domain=locale_obj.domain,
591	        market_place_id=locale_obj.market_place_id,
592	        code_verifier=code_verifier,
593	        with_username=False,
594	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py:626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
625	    authorization_code = authorization_codes[0]
626	    registration_data = await asyncio.to_thread(
627	        audible.register.register,
628	        authorization_code=authorization_code,
629	        code_verifier=code_verifier.encode(),
630	        domain=auth.locale.domain,
631	        serial=serial,
632	    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
638	    """Async file exists check."""
639	    return await asyncio.to_thread(os.path.exists, path)
640	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/audible/audible_helper.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
643	    """Async file delete."""
644	    await asyncio.to_thread(os.remove, path)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
141	        self._playlists_dir = os.path.join(self.mass.storage_path, "playlists")
142	        if not await asyncio.to_thread(os.path.exists, self._playlists_dir):
143	            await asyncio.to_thread(os.mkdir, self._playlists_dir)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
142	        if not await asyncio.to_thread(os.path.exists, self._playlists_dir):
143	            await asyncio.to_thread(os.mkdir, self._playlists_dir)
144	        await super().loaded_in_mass()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py:667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
666	        playlist_file = os.path.join(self._playlists_dir, playlist_id)
667	        if not await asyncio.to_thread(os.path.isfile, playlist_file):
668	            return []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/builtin/__init__.py:683
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
682	        ):
683	            await _file.write("\n".join(lines))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	CONF_ACTION_AUTH = "auth"
87	DEEZER_AUTH_URL = "https://connect.deezer.com/oauth/auth.php"
88	RELAY_URL = "https://deezer.oauth.jonathanbangert.com/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
87	DEEZER_AUTH_URL = "https://connect.deezer.com/oauth/auth.php"
88	RELAY_URL = "https://deezer.oauth.jonathanbangert.com/"
89	DEEZER_PERMS = "basic_access,email,offline_access,manage_library,\

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	    response = await http_session.post(
100	        "https://connect.deezer.com/oauth/access_token.php",
101	        params={"code": code, "app_id": app_id, "secret": app_secret},
102	        ssl=False,
103	    )
104	    if response.status != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/deezer/__init__.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
155	            required=True,
156	            description="See https://www.dumpmedia.com/deezplus/deezer-arl.html",
157	            value=values.get(CONF_ARL_TOKEN) if values else None,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/deezer/gw_client.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	GW_LIGHT_URL = "https://www.deezer.com/ajax/gw-light.php"
22	
23	
24	class DeezerGWError(BaseException):

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/deezer/gw_client.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
102	        parameters |= params
103	        result = await self.session.request(
104	            http_method,
105	            GW_LIGHT_URL,
106	            params=parameters,
107	            timeout=30,
108	            json=args,
109	            headers={"User-Agent": USER_AGENT_HEADER},
110	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/deezer/gw_client.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
153	        url_response = await self.session.post(
154	            "https://media.deezer.com/v1/get_url",
155	            json=url_data,
156	            headers={"User-Agent": USER_AGENT_HEADER},
157	        )
158	        result_json = await url_response.json()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/dlna/__init__.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
418	            if allow_network_scan and use_multicast:
419	                await async_search(on_response, target=(str(IPv4Address("255.255.255.255")), 1900))
420	            else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/fanarttv/__init__.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	            label="VIP Member Personal API Key (optional)",
81	            description="Support this metadata provider by becoming a VIP Member, "
82	            "resulting in higher rate limits and faster response times among other benefits. "
83	            "See https://wiki.fanart.tv/General/personal%20api/ for more information.",
84	            required=False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/fanarttv/__init__.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
163	        """Get data from api."""
164	        url = f"http://webservice.fanart.tv/v3/{endpoint}"
165	        headers = {

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
276	        abs_path = self.get_absolute_path(item_path)
277	        for item in await asyncio.to_thread(sorted_scandir, self.base_path, abs_path, sort=True):
278	            if not item.is_dir and ("." not in item.filename or not item.ext):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
369	
370	        await asyncio.to_thread(run_sync)
371	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
700	            async with aiofiles.open(playlist_filename, mode="rb") as _file:
701	                playlist_data_raw = await _file.read()
702	                encoding = await detect_charset(playlist_data_raw)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
747	        async with TaskManager(self.mass, 25) as tm:
748	            for item in await asyncio.to_thread(sorted_scandir, self.base_path, prov_podcast_id):
749	                if "." not in item.relative_path or item.is_dir:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
793	        async with aiofiles.open(playlist_filename, encoding="utf-8") as _file:
794	            playlist_data = await _file.read()
795	        for file_path in prov_track_ids:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
800	        async with aiofiles.open(playlist_filename, "w", encoding="utf-8") as _file:
801	            await _file.write(playlist_data)
802	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:814
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
813	        async with aiofiles.open(playlist_filename, encoding="utf-8") as _file:
814	            playlist_data = await _file.read()
815	        # get current contents first

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
828	        async with aiofiles.open(playlist_filename, "w", encoding="utf-8") as _file:
829	            await _file.write(playlist_data)
830	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
838	        async with aiofiles.open(playlist_filename, "w", encoding="utf-8") as _file:
839	            await _file.write("#EXTM3U\n")
840	        return await self.get_playlist(filename)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1043
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1042	            async with aiofiles.open(nfo_file) as _file:
1043	                data = await _file.read()
1044	            info = await asyncio.to_thread(xmltodict.parse, data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1043	                data = await _file.read()
1044	            info = await asyncio.to_thread(xmltodict.parse, data)
1045	            info = info["artist"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1141	            abs_path = self.get_absolute_path(file_item.parent_path)
1142	            for _item in await asyncio.to_thread(sorted_scandir, self.base_path, abs_path):
1143	                if "." not in _item.relative_path or _item.is_dir:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1157	                        async with aiofiles.open(_item.absolute_path, encoding="utf-8") as _file:
1158	                            description = await _file.read()
1159	                        audio_book.metadata.description = description

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1418	                async with aiofiles.open(nfo_file) as _file:
1419	                    data = await _file.read()
1420	                info = await asyncio.to_thread(xmltodict.parse, data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1419	                    data = await _file.read()
1420	                info = await asyncio.to_thread(xmltodict.parse, data)
1421	                info = info["album"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1459	        abs_path = self.get_absolute_path(folder)
1460	        folder_files = await asyncio.to_thread(sorted_scandir, self.base_path, abs_path, sort=False)
1461	        for item in folder_files:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1504	            async with aiofiles.open(temp_file_name, "w") as _file:
1505	                await _file.write("test")
1506	            await asyncio.to_thread(os.remove, temp_file_name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1505	                await _file.write("test")
1506	            await asyncio.to_thread(os.remove, temp_file_name)
1507	            self.write_access = True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1536	        # run in thread because strictly taken this may be blocking IO
1537	        return await asyncio.to_thread(_create_item)
1538	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1687	            abs_path = self.get_absolute_path(audiobook_file_item.parent_path)
1688	            for item in await asyncio.to_thread(
1689	                sorted_scandir, self.base_path, abs_path, sort=True
1690	            ):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/__init__.py:1740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1739	            async with aiofiles.open(metadata_file) as _file:
1740	                data.update(json_loads(await _file.read()))
1741	        await self.cache.set(podcast_folder, data, base_key=cache_base_key)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_local/constants.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    default_value="various_artists",
16	    help_link="https://music-assistant.io/music-providers/filesystem/#tagging-files",
17	    required=False,

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
200	
201	        if platform.system() == "Darwin":
202	            # NOTE: MacOS does not support special characters in the username/password

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
200	
201	        if platform.system() == "Darwin":
202	            # NOTE: MacOS does not support special characters in the username/password

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py:201
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
200	
201	        if platform.system() == "Darwin":
202	            # NOTE: MacOS does not support special characters in the username/password

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
211	
212	        elif platform.system() == "Linux":
213	            options = ["rw"]

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
211	
212	        elif platform.system() == "Linux":
213	            options = ["rw"]

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py:212
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
211	
212	        elif platform.system() == "Linux":
213	            options = ["rw"]

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
232	        else:
233	            msg = f"SMB provider is not supported on {platform.system()}"
234	            raise LoginFailed(msg)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
232	        else:
233	            msg = f"SMB provider is not supported on {platform.system()}"
234	            raise LoginFailed(msg)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/filesystem_smb/__init__.py:233
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
232	        else:
233	            msg = f"SMB provider is not supported on {platform.system()}"
234	            raise LoginFailed(msg)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/gpodder/__init__.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	
297	            if base_url.rstrip("/") == "https://gpodder.net":
298	                raise LoginFailed("Do not use gpodder.net. See docs for explanation.")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	                required=True,
115	                default_value="http://supervisor/core/api",
116	                value="http://supervisor/core/api",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
115	                default_value="http://supervisor/core/api",
116	                value="http://supervisor/core/api",
117	                hidden=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	                required=True,
145	                description="URL to your Home Assistant instance (e.g. http://192.168.1.1:8123)",
146	                value=cast("str", values.get(CONF_URL)) if values else None,

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
308	        try:
309	            await self.hass.connect(ssl=bool(self.config.get_value(CONF_VERIFY_SSL)))
310	        except BaseHassClientError as err:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/hass/__init__.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
330	            self._listen_task.cancel()
331	        await self.hass.disconnect()
332	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/ibroadcast/__init__.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
276	                    provider_instance=self.instance_id,
277	                    url=f"https://media.ibroadcast.com/?view=container&container_id={artist_id}&type=artists",
278	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/ibroadcast/__init__.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
310	                    audio_format=AudioFormat(content_type=ContentType.MPEG),
311	                    url=f"https://media.ibroadcast.com/?view=container&container_id={album_id}&type=albums",
312	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	        }
160	        url = "https://itunes.apple.com/search?"
161	        result.podcasts = await self._perform_search(url, params)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py:319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
318	        params = {"id": itunes_id}
319	        url = "https://itunes.apple.com/lookup?"
320	        response = await self.mass.http_session.get(url, params=params)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/itunes_podcasts/__init__.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
388	        country = str(self.config.get_value(CONF_LOCALE))
389	        url = f"https://rss.marketingtools.apple.com/api/v2/{country}/podcasts/top/15/podcasts.json"
390	        response = await self.mass.http_session.get(url)

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
148	            app_version=self.mass.version,
149	            device_name=socket.gethostname(),
150	            device_id=device_id,

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/jellyfin/__init__.py:149
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
148	            app_version=self.mass.version,
149	            device_name=socket.gethostname(),
150	            device_id=device_id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
403	        """Get data from api."""
404	        url = f"http://musicbrainz.org/ws/2/{endpoint}"
405	        headers = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/musicbrainz/__init__.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
405	        headers = {
406	            "User-Agent": f"Music Assistant/{self.mass.version} (https://music-assistant.io)"
407	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/opensubsonic/__init__.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	            required=True,
61	            description="Base URL for the server, e.g. https://subsonic.mydomain.tld",
62	        ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	    # show GDM discovery (if we do not yet have any server details)
165	    if values is None or not values.get(CONF_LOCAL_SERVER_IP):
166	        entries.append(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	            required=True,
185	            value=cast("str", values.get(CONF_LOCAL_SERVER_IP)) if values else None,
186	        ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
193	            default_value=32400,
194	            value=cast("int", values.get(CONF_LOCAL_SERVER_PORT)) if values else None,
195	        ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	            action=CONF_AUTH_TOKEN,
219	            value=cast("str | None", values.get(CONF_AUTH_TOKEN)) if values else None,
220	            hidden=True,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
226	    # not yet have this info or we/user invalidated it.
227	    if values and values.get(CONF_AUTH_TOKEN):
228	        conf_libraries = ConfigEntry(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
242	        ):
243	            token = mass.config.decrypt_string(str(values.get(CONF_AUTH_TOKEN)))
244	            server_http_ip = str(values.get(CONF_LOCAL_SERVER_IP))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
243	            token = mass.config.decrypt_string(str(values.get(CONF_AUTH_TOKEN)))
244	            server_http_ip = str(values.get(CONF_LOCAL_SERVER_IP))
245	            server_http_port = str(values.get(CONF_LOCAL_SERVER_PORT))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
244	            server_http_ip = str(values.get(CONF_LOCAL_SERVER_IP))
245	            server_http_port = str(values.get(CONF_LOCAL_SERVER_PORT))
246	            server_http_ssl = bool(values.get(CONF_LOCAL_SERVER_SSL))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
245	            server_http_port = str(values.get(CONF_LOCAL_SERVER_PORT))
246	            server_http_ssl = bool(values.get(CONF_LOCAL_SERVER_SSL))
247	            server_http_verify_cert = bool(values.get(CONF_LOCAL_SERVER_VERIFY_CERT))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	            server_http_ssl = bool(values.get(CONF_LOCAL_SERVER_SSL))
247	            server_http_verify_cert = bool(values.get(CONF_LOCAL_SERVER_VERIFY_CERT))
248	            if not (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/__init__.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
274	    # show authentication options
275	    if values is None or not values.get(CONF_AUTH_TOKEN):
276	        entries.append(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	
57	    if cache := await mass.cache.get(cache_key, checksum=auth_token):
58	        return cast("list[str]", cache)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	            entry = gdm.entries[0]
74	            data = entry.get("data")
75	            local_server_ip = entry.get("from")[0]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	            data = entry.get("data")
75	            local_server_ip = entry.get("from")[0]
76	            local_server_port = data.get("Port")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/plex/helpers.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	            local_server_ip = entry.get("from")[0]
76	            local_server_port = data.get("Port")
77	            return local_server_ip, local_server_port

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
500	                    provider_instance=self.instance_id,
501	                    url=f"https://open.qobuz.com/artist/{artist_obj['id']}",
502	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
542	                    ),
543	                    url=f"https://open.qobuz.com/album/{album_obj['id']}",
544	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
606	                    ),
607	                    url=f"https://open.qobuz.com/track/{track_obj['id']}",
608	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
686	                    provider_instance=self.instance_id,
687	                    url=f"https://open.qobuz.com/playlist/{playlist_obj['id']}",
688	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
747	        self.logger.debug("Handling GET request to %s", endpoint)
748	        url = f"http://www.qobuz.com/api.json/0.2/{endpoint}"
749	        headers = {"X-App-Id": app_var(0)}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/qobuz/__init__.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
800	            data = {}
801	        url = f"http://www.qobuz.com/api.json/0.2/{endpoint}"
802	        params["app_id"] = app_var(0)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/siriusxm/__init__.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
157	        # Set up the sxm server for streaming
158	        bind_ip = "127.0.0.1"
159	        bind_port = await select_free_port(8100, 9999)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	CONF_HELP_LINK = (
74	    "https://raw.githubusercontent.com/badaix/snapcast/refs/heads/master/server/etc/snapserver.conf"
75	)
76	
77	# snapcast has fixed sample rate/bit depth so make this config entry static and hidden
78	CONF_ENTRY_SAMPLE_RATES_SNAPCAST = create_sample_rates_config_entry(
79	    supported_sample_rates=[48000], supported_bit_depths=[16], hidden=True

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
81	
82	DEFAULT_SNAPSERVER_IP = "127.0.0.1"
83	DEFAULT_SNAPSERVER_PORT = 1705

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
302	        if self._use_builtin_server:
303	            self._snapcast_server_host = "127.0.0.1"
304	            self._snapcast_server_control_port = DEFAULT_SNAPSERVER_PORT

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
590	                stream_path = "tcp://" + stream._stream["uri"]["host"]
591	            stream_path = stream_path.replace("0.0.0.0", self._snapcast_server_host)
592	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py:744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
743	                    port=port,
744	                    server=f"{socket.gethostname()}.local",
745	                )

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/__init__.py:744
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
743	                    port=port,
744	                    server=f"{socket.gethostname()}.local",
745	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
68	        self._stopped = True
69	        self.websocket.close()
70	        self.websocket_thread.join()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
84	        ):
85	            send(
86	                {
87	                    "jsonrpc": "2.0",
88	                    "error": {"code": -32601, "message": "Method not found"},
89	                    "id": id,
90	                }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
137	            def handle_result(result: dict[str, Any]):
138	                send(
139	                    {
140	                        "jsonrpc": "2.0",
141	                        "result": self._create_properties(result),
142	                        "id": id,
143	                    }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
149	        # always acknowledge the request
150	        send({"jsonrpc": "2.0", "result": "ok", "id": id})
151	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
153	        """Send log message to Snapcast."""
154	        send(
155	            {
156	                "jsonrpc": "2.0",
157	                "method": "Plugin.Stream.Log",
158	                "params": {"severity": severity, "message": message},
159	            }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
163	        """Send properties to Snapcast."""
164	        send(
165	            {
166	                "jsonrpc": "2.0",
167	                "method": "Plugin.Stream.Player.Properties",
168	                "params": properties,
169	            }

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
173	        """Send stream ready notification to Snapcast."""
174	        send({"jsonrpc": "2.0", "method": "Plugin.Stream.Ready"})
175	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
283	            self._request_callbacks[msg_id] = callback
284	        self.websocket.send(json.dumps(command_msg))
285	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/snapcast/control.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
331	            except Exception as e:
332	                send(
333	                    {
334	                        "jsonrpc": "2.0",
335	                        "error": {"code": -32700, "message": "Parse error", "data": str(e)},
336	                        "id": id,
337	                    }

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
94	        # disconnect all players
95	        await asyncio.gather(*(player.unload() for player in self.sonos_players.values()))
96	        self.sonos_players = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
616	        """Handle PLAY MEDIA using the legacy upnp api."""
617	        xml_data = f"""
618	            <s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"
619	                s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
620	                <s:Body>
621	                    <u:SetAVTransportURI xmlns:u="urn:schemas-upnp-org:service:AVTransport:1">
622	                        <InstanceID>0</InstanceID>
623	                        <CurrentURI>{media.uri}</CurrentURI>
624	                        <CurrentURIMetaData>{create_didl_metadata_str(media)}</CurrentURIMetaData>
625	                    </u:SetAVTransportURI>

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos/provider.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
649	        """Handle enqueuing of the next queue item using the legacy unpnp api."""
650	        xml_data = f"""
651	            <s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
652	                <s:Body>
653	                    <u:SetNextAVTransportURI xmlns:u="urn:schemas-upnp-org:service:AVTransport:1">
654	                        <InstanceID>0</InstanceID>
655	                        <NextURI>{media.uri}</NextURI>
656	                        <NextURIMetaData>{create_didl_metadata_str(media)}</NextURIMetaData>
657	                    </u:SetNextAVTransportURI>

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
202	            return
203	        await asyncio.to_thread(sonos_player.soco.stop)
204	        self.mass.call_later(2, sonos_player.poll_speaker)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
214	            return
215	        await asyncio.to_thread(sonos_player.soco.play)
216	        sonos_player.mass_player.poll_interval = 5

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
231	            return
232	        await asyncio.to_thread(sonos_player.soco.pause)
233	        self.mass.call_later(2, sonos_player.poll_speaker)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
241	
242	        await asyncio.to_thread(set_volume_level, player_id, volume_level)
243	        self.mass.call_later(2, sonos_player.poll_speaker)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
251	
252	        await asyncio.to_thread(set_volume_mute, player_id, muted)
253	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
284	        sonos_player = self.sonosplayers[player_id]
285	        mass_player = self.mass.players.get(player_id)
286	        assert mass_player

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
294	        didl_metadata = create_didl_metadata(media)
295	        await asyncio.to_thread(sonos_player.soco.play_uri, media.uri, meta=didl_metadata)
296	        self.mass.call_later(2, sonos_player.poll_speaker)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
316	
317	            await asyncio.to_thread(set_crossfade)
318	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
319	        try:
320	            await asyncio.to_thread(
321	                sonos_player.soco.avTransport.SetNextAVTransportURI,
322	                [("InstanceID", 0), ("NextURI", media.uri), ("NextURIMetaData", didl_metadata)],
323	                timeout=60,
324	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
406	
407	        await asyncio.to_thread(do_discover)
408	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
419	        # check if existing player changed IP
420	        if existing := self.sonosplayers.get(player_id):
421	            if existing.soco.ip_address != soco.ip_address:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
434	        self.logger.debug("Adding new player: %s", speaker_info)
435	        if not (mass_player := self.mass.players.get(soco.uid)):
436	            mass_player = Player(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
468	    """Discover the HouseHold ID of S1 speaker(s) the network."""
469	    if cache := await mass.cache.get("sonos_household_ids"):
470	        return cast("list[str]", cache)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
479	
480	    all_sonos_ips = await asyncio.to_thread(get_all_sonos_ips)
481	    for ip_address in all_sonos_ips:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/__init__.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
481	    for ip_address in all_sonos_ips:
482	        async with mass.http_session.get(f"http://{ip_address}:1400/status/zp") as resp:
483	            if resp.status == 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
260	        try:
261	            await asyncio.to_thread(self.ping)
262	            self._speaker_activity("ping")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
303	        async with self.sonos_prov.topology_condition:
304	            group: list[SonosPlayer] = await asyncio.to_thread(self._join, members)
305	            await self.wait_for_groups([group])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
309	        async with self.sonos_prov.topology_condition:
310	            await asyncio.to_thread(self._unjoin)
311	            await self.wait_for_groups([[self]])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
331	
332	        await asyncio.to_thread(_poll)
333	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/sonos_s1/player.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
532	                return group.split(",")
533	            return await asyncio.to_thread(_get_soco_group)
534	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
322	            stream_type=StreamType.HLS
323	            if url.startswith("https://cf-hls-media.sndcdn.com")
324	            else StreamType.HTTP,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/soundcloud/__init__.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
348	                    provider_instance=self.instance_id,
349	                    url=f"https://soundcloud.com/{permalink}",
350	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	
91	CALLBACK_REDIRECT_URL = "https://music-assistant.io/callback"
92	
93	LIKED_SONGS_FAKE_PLAYLIST_ID_PREFIX = "liked_songs"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
153	            query_string = urlencode(params)
154	            url = f"https://accounts.spotify.com/authorize?{query_string}"
155	            result = await auth_helper.authenticate(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	        async with mass.http_session.post(
166	            "https://accounts.spotify.com/api/token", data=params
167	        ) as response:
168	            result = await response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
373	                endpoint = spotify_artists["artists"]["next"]
374	                endpoint = endpoint.replace("https://api.spotify.com/v1/", "")
375	            else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
403	                    provider_instance=self.instance_id,
404	                    url="https://open.spotify.com/collection/tracks",
405	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
413	                type=ImageType.THUMB,
414	                path="https://misc.scdn.co/liked-songs/liked-songs-64.png",
415	                provider=self.lookup_key,

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:613
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
612	                try:
613	                    chunk = await asyncio.wait_for(librespot_proc.read(64000), timeout=5)
614	                    yield chunk

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
835	            async with self.mass.http_session.post(
836	                "https://accounts.spotify.com/api/token", data=params
837	            ) as response:
838	                if response.status != 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:914
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
913	        """Get data from api."""
914	        url = f"https://api.spotify.com/v1/{endpoint}"
915	        kwargs["market"] = "from_token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:953
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
952	        """Delete data from api."""
953	        url = f"https://api.spotify.com/v1/{endpoint}"
954	        auth_info = kwargs.pop("auth_info", await self.login())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:978
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
977	        """Put data on api."""
978	        url = f"https://api.spotify.com/v1/{endpoint}"
979	        auth_info = kwargs.pop("auth_info", await self.login())

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/__init__.py:1004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1003	        """Post data on api."""
1004	        url = f"https://api.spotify.com/v1/{endpoint}"
1005	        auth_info = kwargs.pop("auth_info", await self.login())

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/helpers.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
23	    base_path = os.path.join(os.path.dirname(__file__), "bin")
24	    system = platform.system().lower().replace("darwin", "macos")
25	    architecture = platform.machine().lower()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/helpers.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
23	    base_path = os.path.join(os.path.dirname(__file__), "bin")
24	    system = platform.system().lower().replace("darwin", "macos")
25	    architecture = platform.machine().lower()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify/helpers.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
23	    base_path = os.path.join(os.path.dirname(__file__), "bin")
24	    system = platform.system().lower().replace("darwin", "macos")
25	    architecture = platform.machine().lower()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify_connect/__init__.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
264	            self._stop_called = True
265	            self.mass.create_task(self.unload())
266	            return

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/spotify_connect/events.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
90	req.add_header("Content-Length", len(jsondataasbytes))
91	response = urllib.request.urlopen(req, jsondataasbytes)  # noqa: S310

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/squeezelite/__init__.py:963
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
962	            try:
963	                await resp.write(chunk)
964	            except (BrokenPipeError, ConnectionResetError, ConnectionError):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
284	            metadata.links.add(
285	                MediaItemLink(type=LinkType.WIKIPEDIA, url=f"https://wikipedia.org/wiki/{link}")
286	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
288	            metadata.links.add(
289	                MediaItemLink(type=LinkType.ALLMUSIC, url=f"https://www.allmusic.com/album/{link}")
290	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/theaudiodb/__init__.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
399	        """Get data from api."""
400	        url = f"https://theaudiodb.com/api/v1/json/{app_var(3)}/{endpoint}"
401	        async with (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
94	
95	BROWSE_URL = "https://tidal.com/browse"
96	RESOURCES_URL = "https://resources.tidal.com/images"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	BROWSE_URL = "https://tidal.com/browse"
96	RESOURCES_URL = "https://resources.tidal.com/images"
97	
98	DEFAULT_LIMIT = 50

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
311	
312	    BASE_URL: str = "https://api.tidal.com/v1"
313	    BASE_URL_V2: str = "https://api.tidal.com/v2"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
312	    BASE_URL: str = "https://api.tidal.com/v1"
313	    BASE_URL_V2: str = "https://api.tidal.com/v2"
314	    OPEN_API_URL: str = "https://openapi.tidal.com/v2"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
313	    BASE_URL_V2: str = "https://api.tidal.com/v2"
314	    OPEN_API_URL: str = "https://openapi.tidal.com/v2"
315	
316	    throttler = ThrottlerManager(rate_limit=1, period=2)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py:1330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1329	                page_path,
1330	                base_url="https://listen.tidal.com/v1",
1331	                params={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py:1611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1610	                    # not working for musicbrainz lookups
1611	                    url=f"https://tidal.com/artist/{artist_id}",
1612	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py:1651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1650	                    ),
1651	                    url=f"https://tidal.com/album/{album_id}",
1652	                    available=album_obj.get("streamReady", True),  # Default to available

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/__init__.py:1739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1738	                    ),
1739	                    url=f"https://tidal.com/track/{track_id}",
1740	                    available=track_obj["streamReady"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	TOKEN_TYPE = "Bearer"
24	AUTH_URL = "https://auth.tidal.com/v1/oauth2"
25	REDIRECT_URI = "https://tidal.com/android/login/auth"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	AUTH_URL = "https://auth.tidal.com/v1/oauth2"
25	REDIRECT_URI = "https://tidal.com/android/login/auth"
26	
27	
28	@dataclass
29	class TidalUser:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
216	
217	        url = f"https://login.tidal.com/authorize?{urllib.parse.urlencode(params)}"
218	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tidal/auth_manager.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
281	        headers = {"Authorization": f"Bearer {token_data['access_token']}"}
282	        sessions_url = "https://api.tidal.com/v1/sessions"
283	
284	        # Again use mass.http_session
285	        async with http_session.get(sessions_url, headers=headers) as response:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/tunein/__init__.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
283	        else:
284	            url = f"https://opml.radiotime.com/{endpoint}"
285	            kwargs["formats"] = "ogg,aac,wma,mp3,hls"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	CONF_PO_TOKEN_SERVER_URL = "po_token_server_url"
87	DEFAULT_PO_TOKEN_SERVER_URL = "http://127.0.0.1:4416"
88	
89	YTM_DOMAIN = "https://music.youtube.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/ytmusic/__init__.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	
89	YTM_DOMAIN = "https://music.youtube.com"
90	YTM_COOKIE_DOMAIN = ".youtube.com"

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/music_assistant-2.5.1/music_assistant-2.5.1/music_assistant/providers/ytmusic/helpers.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
350	    cookie = SimpleCookie()
351	    cookie.load(rawdata=raw_cookie_str)
352	    netscape_cookie = "# Netscape HTTP Cookie File\n"

--------------------------------------------------

Code scanned:
	Total lines of code: 48051
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 108.0
		High: 199.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 291.0
		High: 16.0
Files skipped (0):
