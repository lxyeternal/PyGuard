Run started:2025-04-12 18:17:30.255433

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	
42	BUG_REPORT = """\
43	Cloudflare may have changed their technique, or there may be a bug in the script.
44	
45	Please read https://github.com/Anorov/cloudflare-scrape#updates, then file a \
46	bug report at https://github.com/Anorov/cloudflare-scrape/issues."\
47	"""
48	
49	ANSWER_ACCEPT_ERROR = """\

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	
49	ANSWER_ACCEPT_ERROR = """\
50	The challenge answer was not properly accepted by Cloudflare. This can occur if \
51	the target website is under heavy load, or if Cloudflare is experiencing issues. You can
52	potentially resolve this by increasing the challenge answer delay (default: 8 seconds). \
53	For example: cfscrape.create_scraper(delay=15)
54	
55	If increasing the delay does not help, please open a GitHub issue at \
56	https://github.com/Anorov/cloudflare-scrape/issues\
57	"""
58	
59	# Remove a few problematic TLSv1.0 ciphers from the defaults
60	DEFAULT_CIPHERS += ":!ECDHE+SHA:!AES128-SHA:!AESCCM:!DHE:!ARIA"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	
69	        if conn.conn_kw.get("ssl_context"):
70	            conn.conn_kw["ssl_context"].set_ciphers(DEFAULT_CIPHERS)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	            resp.status_code in (503, 429)
107	            and resp.headers.get("Server", "").startswith("cloudflare")
108	            and b"jschl_vc" in resp.content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
115	            resp.status_code == 403
116	            and resp.headers.get("Server", "").startswith("cloudflare")
117	            and b"/cdn-cgi/l/chk_captcha" in resp.content

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
120	    def request(self, method, url, *args, **kwargs):
121	        resp = super(CloudflareScraper, self).request(method, url, *args, **kwargs)
122	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	        return (
136	            self.cookies.get("cf_clearance", None, domain=cookie_domain) or
137	            (resp and resp.cookies.get("cf_clearance", None, domain=cookie_domain))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	            self.cookies.get("cf_clearance", None, domain=cookie_domain) or
137	            (resp and resp.cookies.get("cf_clearance", None, domain=cookie_domain))
138	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
218	        # Send the challenge response and handle the redirect manually
219	        redirect = self.request(method, submit_url, **cloudflare_kwargs)
220	        if "Location" in redirect.headers:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
233	                )
234	                return self.request(method, redirect_url, **original_kwargs)
235	            return self.request(method, redirect.headers["Location"], **original_kwargs)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
234	                return self.request(method, redirect_url, **original_kwargs)
235	            return self.request(method, redirect.headers["Location"], **original_kwargs)
236	        elif "Set-Cookie" in redirect.headers:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
237	            if 'cf_clearance' in redirect.headers['Set-Cookie']:
238	                resp = self.request(self.org_method, submit_url, cookies = redirect.cookies)
239	                return resp

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
240	            else:
241	                return self.request(method, submit_url, **original_kwargs)
242	        else:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
242	        else:
243	            resp = self.request(self.org_method, submit_url, **cloudflare_kwargs)
244	            return resp

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
268	            # The `a.value` to be returned is tacked onto the end.
269	            challenge = """
270	                var document = {
271	                    createElement: function () {
272	                      return { firstChild: { href: "http://%s/" } }
273	                    },
274	                    getElementById: function () {
275	                      return {"innerHTML": "%s"};
276	                    }
277	                  };
278	
279	                %s; a.value
280	            """ % (
281	                domain,
282	                innerHTML,
283	                challenge,
284	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
285	            # Encode the challenge for security while preserving quotes and spacing.
286	            challenge = b64encode(challenge.encode("utf-8")).decode("ascii")
287	            # Use the provided delay, parsed delay, or default to 8 secs

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:286
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
285	            # Encode the challenge for security while preserving quotes and spacing.
286	            challenge = b64encode(challenge.encode("utf-8")).decode("ascii")
287	            # Use the provided delay, parsed delay, or default to 8 secs

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
331	                raise EnvironmentError(
332	                    "Missing Node.js runtime. Node is required and must be in the PATH (check with `node -v`). Your Node binary may be called `nodejs` rather than `node`, in which case you may need to run `apt-get install nodejs-legacy` on some Debian-based systems. (Please read the cfscrape"
333	                    " README's Dependencies section: https://github.com/Anorov/cloudflare-scrape#dependencies."
334	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
382	        try:
383	            resp = scraper.get(url, **kwargs)
384	            resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
402	            {
403	                "__cfduid": scraper.cookies.get("__cfduid", "", domain=cookie_domain),
404	                "cf_clearance": scraper.cookies.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/cfscrape/__init__.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
403	                "__cfduid": scraper.cookies.get("__cfduid", "", domain=cookie_domain),
404	                "cf_clearance": scraper.cookies.get(
405	                    "cf_clearance", "", domain=cookie_domain
406	                ),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/setup.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
10	    with open(readme_md) as f:
11	        return f.read()
12	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
14	with open(os.path.join(base_path, "cfscrape", "__init__.py")) as f:
15	    VERSION = re.compile(r'.*__version__ = "(.*?)"', re.S).match(f.read()).group(1)
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/setup.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    version=VERSION,
21	    description='A simple Python module to bypass Cloudflare\'s anti-bot page. See https://github.com/Anorov/cloudflare-scrape for more information.',
22	    long_description=get_long_description(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cfscrape-2.1.1/cfscrape-2.1.1/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    author_email="anorov.vorona@gmail.com",
26	    url="https://github.com/Anorov/cloudflare-scrape",
27	    keywords=["cloudflare", "scraping"],

--------------------------------------------------

Code scanned:
	Total lines of code: 381
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 1.0
Files skipped (0):
