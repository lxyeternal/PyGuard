Run started:2025-04-12 12:45:37.378222

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/checksum.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
69	        while True:
70	            data = fp.read(blocksize)
71	            if not data:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/cli_groups/_init_group.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    "-t",
38	    default="https://github.com/awslabs/seed-farmer.git",
39	    help="The template URL. If not specified, the default template repo is `https://github.com/awslabs/seed-farmer`",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/cli_groups/_init_group.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    default="https://github.com/awslabs/seed-farmer.git",
39	    help="The template URL. If not specified, the default template repo is `https://github.com/awslabs/seed-farmer`",
40	    required=False,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/cli_groups/_init_group.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	    "-t",
74	    default="https://github.com/awslabs/seed-farmer.git",
75	    help=(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/cli_groups/_init_group.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
75	    help=(
76	        "The template URL. If not specified, the default template repo is " "`https://github.com/awslabs/seed-farmer`"
77	    ),
78	    required=False,
79	)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
335	                threads = _group.concurrency if _group.concurrency else len(_group.modules)
336	                with concurrent.futures.ThreadPoolExecutor(max_workers=threads, thread_name_prefix="Deploy") as workers:
337	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
338	                    def _exec_deploy(mdo: ModuleDeployObject) -> ModuleDeploymentResponse:
339	                        threading.current_thread().name = (
340	                            f"{threading.current_thread().name}-{mdo.group_name}_{mdo.module_name}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
339	                        threading.current_thread().name = (
340	                            f"{threading.current_thread().name}-{mdo.group_name}_{mdo.module_name}"
341	                        ).replace("_", "-")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
385	
386	    with concurrent.futures.ThreadPoolExecutor(
387	        max_workers=len(deployment_manifest.target_accounts_regions), thread_name_prefix="Prime-Accounts"
388	    ) as workers:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
393	
394	            threading.current_thread().name = (
395	                f"{threading.current_thread().name}-{target_account_id}_{target_region}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
394	            threading.current_thread().name = (
395	                f"{threading.current_thread().name}-{target_account_id}_{target_region}"
396	            ).replace("_", "-")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
446	
447	    with concurrent.futures.ThreadPoolExecutor(
448	        max_workers=len(deployment_manifest.target_accounts_regions), thread_name_prefix="Teardown-Accounts"
449	    ) as workers:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
453	            target_region = args["region"]
454	            threading.current_thread().name = (
455	                f"{threading.current_thread().name}-{target_account_id}_{target_region}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:455
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
454	            threading.current_thread().name = (
455	                f"{threading.current_thread().name}-{target_account_id}_{target_region}"
456	            ).replace("_", "-")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:527
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
526	                threads = _group.concurrency if _group.concurrency else len(_group.modules)
527	                with concurrent.futures.ThreadPoolExecutor(
528	                    max_workers=threads, thread_name_prefix="Destroy"
529	                ) as workers:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
531	                    def _exec_destroy(mdo: ModuleDeployObject) -> Optional[ModuleDeploymentResponse]:
532	                        threading.current_thread().name = (
533	                            f"{threading.current_thread().name}-{mdo.group_name}_{mdo.module_name}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
532	                        threading.current_thread().name = (
533	                            f"{threading.current_thread().name}-{mdo.group_name}_{mdo.module_name}"
534	                        ).replace("_", "-")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/commands/_deployment_commands.py:685
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
684	            ).hexdigest()
685	            module.deployspec_md5 = hashlib.md5(open(deployspec_path, "rb").read()).hexdigest()
686	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/archive_support.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
45	
46	        signed_request = create_signed_request(
47	            endpoint=archive_url,
48	            session=session,
49	            credentials=credentials,
50	            headers={"x-amz-content-sha256": hashlib.sha256("".encode("utf-8")).hexdigest()},
51	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/archive_support.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	        )
52	        return requests.get(url=signed_request.url, headers=signed_request.headers, allow_redirects=True)  # type: ignore[arg-type]
53	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/archive_support.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
64	
65	    return requests.get(
66	        url=archive_url,
67	        allow_redirects=True,
68	        auth=auth,
69	    )

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/archive_support.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
73	    if archive_name.endswith(".tar.gz"):
74	        with tarfile.open(archive_name, "r:gz") as tar_file:
75	            all_members = tar_file.getmembers()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/archive_support.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
106	
107	    with open(archive_name, "wb") as archive_file:
108	        archive_file.write(response.content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/archive_support.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
107	    with open(archive_name, "wb") as archive_file:
108	        archive_file.write(response.content)
109	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/archive_support.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
119	
120	        os.rmdir(os.path.join(extracted_dir_path, embedded_dir))
121	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/archive_support.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
132	    query_params = parse_qs(parsed_url.query)
133	    if not query_params.get("module"):
134	        raise InvalidConfigurationError(f"module query param required : {archive_url}")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/deploy_utils.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
95	
96	    with concurrent.futures.ThreadPoolExecutor(max_workers=len(deployment_manifest.target_accounts_regions)) as workers:
97	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/metadata_support.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	            with open(Path(mms.metadata_fullpath()), "r") as metadatafile:
72	                j = metadatafile.read()
73	            return cast(Dict[str, Any], json.loads(j))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/metadata_support.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	    with open(p, "r") as datafile:
112	        j = datafile.read()
113	    return p, dict(json.loads(j))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/metadata_support.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
119	    with open(p, "w") as outfile:
120	        outfile.write(json.dumps(data))
121	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/metadata_support.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
169	        _logger.debug(f"The entire jq command: {jq_command}")
170	        os.system(f"{jq_command} > tmp-metadata")
171	        data = json.loads(open("tmp-metadata", "r").read())

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/metadata_support.py:170
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
169	        _logger.debug(f"The entire jq command: {jq_command}")
170	        os.system(f"{jq_command} > tmp-metadata")
171	        data = json.loads(open("tmp-metadata", "r").read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/metadata_support.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
170	        os.system(f"{jq_command} > tmp-metadata")
171	        data = json.loads(open("tmp-metadata", "r").read())
172	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/module_init.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	
68	    if template_url == "https://github.com/awslabs/seed-farmer.git":
69	        checkout_branch = "init-module-cdkv2" if module_type == "cdkv2" else "init-module"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/seed_farmer-6.0.0-py3-none-any/seedfarmer/mgmt/module_init.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
97	    checkout_branch = (
98	        "init-project" if template_url == "https://github.com/awslabs/seed-farmer.git" else template_branch
99	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 8279
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 34.0
		High: 1.0
Files skipped (0):
