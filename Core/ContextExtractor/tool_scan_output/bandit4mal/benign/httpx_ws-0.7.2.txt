Run started:2025-04-12 12:53:12.626277

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
105	        if self._should_close_task is None:
106	            self._executor = concurrent.futures.ThreadPoolExecutor()
107	            self._should_close_task = self._executor.submit(self._should_close.wait)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
111	    def __enter__(self) -> "WebSocketSession":
112	        self._background_receive_task = threading.Thread(
113	            target=self._background_receive, args=(self._max_message_size_bytes,)
114	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
118	        if self._keepalive_ping_interval_seconds is not None:
119	            self._background_keepalive_ping_task = threading.Thread(
120	                target=self._background_keepalive_ping,
121	                args=(
122	                    self._keepalive_ping_interval_seconds,
123	                    self._keepalive_ping_timeout_seconds,
124	                ),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
185	            with self._write_lock:
186	                self.stream.write(data)
187	        except httpcore.WriteError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
459	                with self._write_lock:
460	                    self.stream.write(data)
461	            except httpcore.WriteError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
487	                        with self._write_lock:
488	                            self.stream.write(data)
489	                        continue

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
561	    def _read_stream(self, max_bytes: int) -> bytes:
562	        data = self.stream.read(max_bytes)
563	        if data == b"":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
709	            async with self._write_lock:
710	                await self.stream.write(data)
711	        except httpcore.WriteError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:985
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
984	                async with self._write_lock:
985	                    await self.stream.write(data)
986	            except httpcore.WriteError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:1013
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1012	                        async with self._write_lock:
1013	                            await self.stream.write(data)
1014	                        continue

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:1061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1060	    async def _read_stream(self, max_bytes: int) -> bytes:
1061	        data = await self.stream.read(max_bytes)
1062	        if data == b"":

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1072	        "upgrade": "websocket",
1073	        "sec-websocket-key": base64.b64encode(secrets.token_bytes(16)).decode("utf-8"),
1074	        "sec-websocket-version": "13",

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/_api.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1072	        "upgrade": "websocket",
1073	        "sec-websocket-key": base64.b64encode(secrets.token_bytes(16)).decode("utf-8"),
1074	        "sec-websocket-version": "13",

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/transport.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
194	            }
195	            return await self._handle_ws_request(request, scope)
196	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/httpx_ws/transport.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
196	
197	        return await super().handle_async_request(request)
198	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	    description='WebSockets support for HTTPX',
8	    long_description='# HTTPX WS\n\n<p align="center">\n    <em>WebSockets support for HTTPX</em>\n</p>\n\n[![build](https://github.com/frankie567/httpx-ws/workflows/Build/badge.svg)](https://github.com/frankie567/httpx-ws/actions)\n[![codecov](https://codecov.io/gh/frankie567/httpx-ws/branch/main/graph/badge.svg?token=fL49kIvrj6)](https://codecov.io/gh/frankie567/httpx-ws)\n[![All Contributors](https://img.shields.io/badge/all_contributors-2-orange.svg?style=flat-square)](#contributors-)\n[![PyPI version](https://badge.fury.io/py/httpx-ws.svg)](https://badge.fury.io/py/httpx-ws)\n[![Downloads](https://pepy.tech/badge/httpx-ws)](https://pepy.tech/project/httpx-ws)\n\n---\n\n**Documentation**: <a href="https://frankie567.github.io/httpx-ws/" target="_blank">https://frankie567.github.io/httpx-ws/</a>\n\n**Source Code**: <a href="https://github.com/frankie567/httpx-ws" target="_blank">https://github.com/frankie567/httpx-ws</a>\n\n---\n\n## Installation\n\n```bash\npip install httpx-ws\n```\n\n## Features\n\n- [x] Sync and async client\n- [x] Helper methods to send text, binary and JSON data\n- [x] Helper methods to receive text, binary and JSON data\n- [x] Automatic ping/pong answers\n- [x] HTTPX transport to test WebSockets defined in ASGI apps\n- [x] Automatic keepalive ping\n- [x] `asyncio` and [Trio](https://trio.readthedocs.io/) support through [AnyIO](https://anyio.readthedocs.io/)\n\n## Contributors âœ¨\n\nThanks goes to these wonderful people ([emoji key](https://allcontributors.org/docs/en/emoji-key)):\n\n<!-- ALL-CONTRIBUTORS-LIST:START - Do not remove or modify this section -->\n<!-- prettier-ignore-start -->\n<!-- markdownlint-disable -->\n<table>\n  <tbody>\n    <tr>\n      <td align="center" valign="top" width="14.28%"><a href="http://francoisvoron.com"><img src="https://avatars.githubusercontent.com/u/1144727?v=4?s=100" width="100px;" alt="FranÃ§ois Voron"/><br /><sub><b>FranÃ§ois Voron</b></sub></a><br /><a href="#maintenance-frankie567" title="Maintenance">ğŸš§</a> <a href="https://github.com/frankie567/httpx-ws/commits?author=frankie567" title="Code">ğŸ’»</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="http://kousikmitra.github.io"><img src="https://avatars.githubusercontent.com/u/15109533?v=4?s=100" width="100px;" alt="Kousik Mitra"/><br /><sub><b>Kousik Mitra</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/commits?author=kousikmitra" title="Code">ğŸ’»</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="https://github.com/davidbrochart"><img src="https://avatars.githubusercontent.com/u/4711805?v=4?s=100" width="100px;" alt="David Brochart"/><br /><sub><b>David Brochart</b></sub></a><br /><a href="#platform-davidbrochart" title="Packaging/porting to new platform">ğŸ“¦</a> <a href="https://github.com/frankie567/httpx-ws/commits?author=davidbrochart" title="Code">ğŸ’»</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="https://github.com/ysmu"><img src="https://avatars.githubusercontent.com/u/17018576?v=4?s=100" width="100px;" alt="ysmu"/><br /><sub><b>ysmu</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3Aysmu" title="Bug reports">ğŸ›</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="https://samforeman.me"><img src="https://avatars.githubusercontent.com/u/5234251?v=4?s=100" width="100px;" alt="Sam Foreman"/><br /><sub><b>Sam Foreman</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3Asaforem2" title="Bug reports">ğŸ›</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="http://maparent.ca/"><img src="https://avatars.githubusercontent.com/u/202691?v=4?s=100" width="100px;" alt="Marc-Antoine Parent"/><br /><sub><b>Marc-Antoine Parent</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3Amaparent" title="Bug reports">ğŸ›</a> <a href="https://github.com/frankie567/httpx-ws/commits?author=maparent" title="Code">ğŸ’»</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="https://www.fastapiexpert.com/"><img src="https://avatars.githubusercontent.com/u/7353520?v=4?s=100" width="100px;" alt="Marcelo Trylesinski"/><br /><sub><b>Marcelo Trylesinski</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3AKludex" title="Bug reports">ğŸ›</a> <a href="#research-Kludex" title="Research">ğŸ”¬</a></td>\n    </tr>\n    <tr>\n      <td align="center" valign="top" width="14.28%"><a href="https://lit.link/MtkN1"><img src="https://avatars.githubusercontent.com/u/51289448?v=4?s=100" width="100px;" alt="MtkN1"/><br /><sub><b>MtkN1</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3AMtkN1" title="Bug reports">ğŸ›</a> <a href="#research-MtkN1" title="Research">ğŸ”¬</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="http://www.tomchristie.com/"><img src="https://avatars.githubusercontent.com/u/647359?v=4?s=100" width="100px;" alt="Tom Christie"/><br /><sub><b>Tom Christie</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3Atomchristie" title="Bug reports">ğŸ›</a> <a href="#research-tomchristie" title="Research">ğŸ”¬</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="https://github.com/dmontagu"><img src="https://avatars.githubusercontent.com/u/35119617?v=4?s=100" width="100px;" alt="David Montague"/><br /><sub><b>David Montague</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3Admontagu" title="Bug reports">ğŸ›</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="https://github.com/WSH032"><img src="https://avatars.githubusercontent.com/u/126865849?v=4?s=100" width="100px;" alt="Sean Wang"/><br /><sub><b>Sean Wang</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/commits?author=WSH032" title="Code">ğŸ’»</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="https://github.com/agronholm"><img src="https://avatars.githubusercontent.com/u/130003?v=4?s=100" width="100px;" alt="Alex GrÃ¶nholm"/><br /><sub><b>Alex GrÃ¶nholm</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3Aagronholm" title="Bug reports">ğŸ›</a> <a href="https://github.com/frankie567/httpx-ws/commits?author=agronholm" title="Code">ğŸ’»</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="https://github.com/ro-oliveira95"><img src="https://avatars.githubusercontent.com/u/27009864?v=4?s=100" width="100px;" alt="Rodrigo de Oliveira Neto"/><br /><sub><b>Rodrigo de Oliveira Neto</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3Aro-oliveira95" title="Bug reports">ğŸ›</a> <a href="https://github.com/frankie567/httpx-ws/commits?author=ro-oliveira95" title="Code">ğŸ’»</a></td>\n      <td align="center" valign="top" width="14.28%"><a href="https://tinymind.me/GreyElaina"><img src="https://avatars.githubusercontent.com/u/31543961?v=4?s=100" width="100px;" alt="Elaina"/><br /><sub><b>Elaina</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/commits?author=GreyElaina" title="Code">ğŸ’»</a></td>\n    </tr>\n    <tr>\n      <td align="center" valign="top" width="14.28%"><a href="https://runsisi.com"><img src="https://avatars.githubusercontent.com/u/2339258?v=4?s=100" width="100px;" alt="runsisi"/><br /><sub><b>runsisi</b></sub></a><br /><a href="https://github.com/frankie567/httpx-ws/issues?q=author%3Arunsisi" title="Bug reports">ğŸ›</a> <a href="#research-runsisi" title="Research">ğŸ”¬</a></td>\n    </tr>\n  </tbody>\n</table>\n\n<!-- markdownlint-restore -->\n<!-- prettier-ignore-end -->\n\n<!-- ALL-CONTRIBUTORS-LIST:END -->\n\nThis project follows the [all-contributors](https://github.com/all-contributors/all-contributors) specification. Contributions of any kind welcome!\n\n## Development\n\n### Setup environment\n\nWe use [Hatch](https://hatch.pypa.io/latest/install/) to manage the development environment and production build. Ensure it\'s installed on your system.\n\n### Run unit tests\n\nYou can run all the tests with:\n\n```bash\nhatch run test\n```\n\n### Format the code\n\nExecute the following command to apply linting and check typing:\n\n```bash\nhatch run lint\n```\n\n## License\n\nThis project is licensed under the terms of the MIT license.\n',
9	    author_email='FranÃ§ois Voron <fvoron@gmail.com>',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    with httpx.Client(
38	        base_url="http://localhost:8000", transport=httpx.MockTransport(handler)
39	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        with pytest.raises(WebSocketUpgradeError):
41	            with connect_ws("http://socket/ws", client):
42	                pass

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    async with httpx.AsyncClient(
45	        base_url="http://localhost:8000", transport=httpx.MockTransport(handler)
46	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        with pytest.raises(WebSocketUpgradeError):
48	            async with aconnect_ws("http://socket/ws", client):
49	                pass

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
79	            with WebSocketSession(stream) as websocket_session:
80	                websocket_session.send(wsproto.events.Ping())
81	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
107	            async with AsyncWebSocketSession(stream) as websocket_session:
108	                await websocket_session.send(wsproto.events.Ping())
109	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
120	
121	            await websocket.close()
122	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
125	                try:
126	                    with connect_ws("http://socket/ws", client) as ws:
127	                        ws.send(wsproto.events.TextMessage(data="CLIENT_MESSAGE"))

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
126	                    with connect_ws("http://socket/ws", client) as ws:
127	                        ws.send(wsproto.events.TextMessage(data="CLIENT_MESSAGE"))
128	                except WebSocketDisconnect:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	                try:
135	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
136	                        await aws.send(

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
135	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
136	                        await aws.send(
137	                            wsproto.events.TextMessage(data="CLIENT_MESSAGE")
138	                        )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
156	
157	            await websocket.close()
158	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
161	                try:
162	                    with connect_ws("http://socket/ws", client) as ws:
163	                        ws.send_text("CLIENT_MESSAGE")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	                try:
171	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
172	                        await aws.send_text("CLIENT_MESSAGE")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
190	
191	            await websocket.close()
192	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
195	                try:
196	                    with connect_ws("http://socket/ws", client) as ws:
197	                        ws.send_bytes(b"CLIENT_MESSAGE")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
204	                try:
205	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
206	                        await aws.send_bytes(b"CLIENT_MESSAGE")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
226	
227	            await websocket.close()
228	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:232
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
231	                try:
232	                    with connect_ws("http://socket/ws", client) as ws:
233	                        ws.send_json({"message": "CLIENT_MESSAGE"}, mode=mode)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
240	                try:
241	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
242	                        await aws.send_json({"message": "CLIENT_MESSAGE"}, mode=mode)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
358	
359	            await websocket.close()
360	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
363	                try:
364	                    with connect_ws("http://socket/ws", client) as ws:
365	                        event = ws.receive()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
374	                try:
375	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
376	                        event = await aws.receive()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
400	
401	            await websocket.close()
402	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
406	                    with connect_ws(
407	                        "http://socket/ws", client, max_message_size_bytes=1024
408	                    ) as ws:
409	                        event = ws.receive()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
419	                    async with aconnect_ws(
420	                        "http://socket/ws",
421	                        aclient,
422	                        keepalive_ping_interval_seconds=None,
423	                    ) as aws:
424	                        event = await aws.receive()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
435	
436	            await websocket.close()
437	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
440	                try:
441	                    with connect_ws("http://socket/ws", client) as ws:
442	                        data = ws.receive_text()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
450	                try:
451	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
452	                        data = await aws.receive_text()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
464	
465	            await websocket.close()
466	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
469	                try:
470	                    with connect_ws("http://socket/ws", client) as ws:
471	                        with pytest.raises(WebSocketInvalidTypeReceived):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
479	                try:
480	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
481	                        with pytest.raises(WebSocketInvalidTypeReceived):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
491	
492	            await websocket.close()
493	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
496	                try:
497	                    with connect_ws("http://socket/ws", client) as ws:
498	                        data = ws.receive_bytes()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
506	                try:
507	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
508	                        data = await aws.receive_bytes()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
520	
521	            await websocket.close()
522	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
524	            with httpx.Client(transport=httpx.HTTPTransport(uds=socket)) as client:
525	                with connect_ws("http://socket/ws", client) as ws:
526	                    with pytest.raises(WebSocketInvalidTypeReceived):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
531	            ) as aclient:
532	                async with aconnect_ws("http://socket/ws", aclient) as aws:
533	                    with pytest.raises(WebSocketInvalidTypeReceived):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
544	
545	            await websocket.close()
546	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
549	                try:
550	                    with connect_ws("http://socket/ws", client) as ws:
551	                        data = ws.receive_json(mode=mode)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
559	                try:
560	                    async with aconnect_ws("http://socket/ws", aclient) as aws:
561	                        data = await aws.receive_json(mode=mode)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
584	                    event = self.events_to_send.pop(0)
585	                    return self.connection.send(event)
586	                except IndexError:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
622	                    event = self.events_to_send.pop(0)
623	                    return self.connection.send(event)
624	                except IndexError:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
665	                        self.ping_answered += 1
666	                        return self.connection.send(event)
667	                    except queue.Empty:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
747	                        self.ping_answered += 1
748	                        return self.connection.send(event)
749	                    except anyio.WouldBlock:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
759	                        self.ping_received += 1
760	                        await self.send_events.send(event.response())
761	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
819	        with httpx.Client(transport=httpx.HTTPTransport(uds=socket)) as client:
820	            with connect_ws("http://socket/ws", client) as ws:
821	                ping_callback = ws.ping()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
827	        ) as aclient:
828	            async with aconnect_ws("http://socket/ws", aclient) as aws:
829	                aping_callback = await aws.ping()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
847	        with httpx.Client(transport=httpx.HTTPTransport(uds=socket)) as client:
848	            with connect_ws("http://socket/ws", client) as ws:
849	                ws.close(code=1001, reason="CLOSE_REASON")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:849
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
848	            with connect_ws("http://socket/ws", client) as ws:
849	                ws.close(code=1001, reason="CLOSE_REASON")
850	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
853	        ) as aclient:
854	            async with aconnect_ws("http://socket/ws", aclient) as aws:
855	                await aws.close(code=1001, reason="CLOSE_REASON")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:855
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
854	            async with aconnect_ws("http://socket/ws", aclient) as aws:
855	                await aws.close(code=1001, reason="CLOSE_REASON")
856	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:866
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
865	        await websocket.accept()
866	        await websocket.close()
867	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
869	        with httpx.Client(transport=httpx.HTTPTransport(uds=socket)) as client:
870	            with connect_ws("http://socket/ws", client) as ws:
871	                with pytest.raises(WebSocketDisconnect):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
876	        ) as aclient:
877	            async with aconnect_ws("http://socket/ws", aclient) as aws:
878	                with pytest.raises(WebSocketDisconnect):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:888
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
887	    ) as mock_connect_ws:
888	        with connect_ws("http://socket/ws"):
889	            pass

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
898	    ) as mock_aconnect_ws:
899	        async with aconnect_ws("http://socket/ws"):
900	            pass

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:934
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
933	    with httpx.Client(
934	        base_url="http://localhost:8000", transport=httpx.MockTransport(handler)
935	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:937
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
936	        with connect_ws(
937	            "http://socket/ws",
938	            client,
939	            subprotocols=["custom_protocol", "unsupported_protocol"],
940	        ) as ws:
941	            assert isinstance(ws.response, httpx.Response)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:946
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
945	    async with httpx.AsyncClient(
946	        base_url="http://localhost:8000", transport=httpx.MockTransport(async_handler)
947	    ) as client:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:949
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
948	        async with aconnect_ws(
949	            "http://socket/ws",
950	            client,
951	            subprotocols=["custom_protocol", "unsupported_protocol"],
952	        ) as aws:
953	            assert isinstance(aws.response, httpx.Response)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:971
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
970	            await websocket.receive_text()
971	        await websocket.close()
972	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
976	            with connect_ws(
977	                "http://socket/ws", client, keepalive_ping_interval_seconds=None
978	            ) as ws:
979	                for _ in range(50):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:1009
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1008	        with httpx.Client(transport=httpx.HTTPTransport(uds=socket)) as client:
1009	            with connect_ws("http://socket/ws", client) as ws:
1010	                with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:1010
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1009	            with connect_ws("http://socket/ws", client) as ws:
1010	                with concurrent.futures.ThreadPoolExecutor(max_workers=10) as executor:
1011	                    for _ in range(10):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_api.py:1017
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1016	        ) as aclient:
1017	            async with aconnect_ws("http://socket/ws", aclient) as aws:
1018	                async with anyio.create_task_group() as tg:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
27	        "upgrade": "websocket",
28	        "sec-websocket-key": base64.b64encode(secrets.token_bytes(16)).decode("utf-8"),
29	        "sec-websocket-version": "13",

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
27	        "upgrade": "websocket",
28	        "sec-websocket-key": base64.b64encode(secrets.token_bytes(16)).decode("utf-8"),
29	        "sec-websocket-version": "13",

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
55	        async def app(scope, receive, send):
56	            await send({"type": "websocket.accept"})
57	            message = await receive()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
65	            text_event = wsproto.events.TextMessage("CLIENT_MESSAGE")
66	            await stream.write(connection.send(text_event))
67	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
68	            bytes_event = wsproto.events.BytesMessage(b"CLIENT_MESSAGE")
69	            await stream.write(connection.send(bytes_event))
70	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
71	            close_event = wsproto.events.CloseConnection(1000)
72	            await stream.write(connection.send(close_event))
73	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
82	        async def app(scope, receive, send):
83	            await send({"type": "websocket.accept"})
84	            await receive()

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
89	                ping_event = wsproto.events.Ping(b"PING")
90	                await stream.write(connection.send(ping_event))
91	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
93	        async def app(scope, receive, send):
94	            await send({"type": "websocket.accept"})
95	            await send({"type": "websocket.send", "text": "SERVER_MESSAGE"})

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
94	            await send({"type": "websocket.accept"})
95	            await send({"type": "websocket.send", "text": "SERVER_MESSAGE"})
96	            await send({"type": "websocket.send", "bytes": b"SERVER_MESSAGE"})

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
95	            await send({"type": "websocket.send", "text": "SERVER_MESSAGE"})
96	            await send({"type": "websocket.send", "bytes": b"SERVER_MESSAGE"})
97	            await send({"type": "websocket.close", "code": 1000, "reason": ""})

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
96	            await send({"type": "websocket.send", "bytes": b"SERVER_MESSAGE"})
97	            await send({"type": "websocket.close", "code": 1000, "reason": ""})
98	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
114	        async def app(scope, receive, send):
115	            await send({"type": "websocket.accept"})
116	            await send({"type": "websocket.foo"})

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
115	            await send({"type": "websocket.accept"})
116	            await send({"type": "websocket.foo"})
117	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
123	        async def app(scope, receive, send):
124	            await send({"type": "websocket.close", "code": 1000, "reason": ""})
125	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
148	        await websocket.receive_text()
149	        await websocket.close()
150	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	        async with ASGIWebSocketTransport(app=test_app) as transport:
163	            request = httpx.Request("GET", "http://localhost:8000/http")
164	            response = await transport.handle_async_request(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
163	            request = httpx.Request("GET", "http://localhost:8000/http")
164	            response = await transport.handle_async_request(request)
165	            assert response.status_code == 200

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
185	            )
186	            response = await transport.handle_async_request(request)
187	            assert response.status_code == 101

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
171	            ("wss://localhost:8000/ws", {}),
172	            ("http://localhost:8000/ws", {"upgrade": "websocket"}),
173	        ],

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
199	        await websocket.send_text("SERVER_MESSAGE")
200	        await websocket.close()
201	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpx_ws-0.7.2/httpx_ws-0.7.2/tests/test_transport.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
220	        await websocket.receive_text()
221	        await websocket.close()
222	

--------------------------------------------------

Code scanned:
	Total lines of code: 2557
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 46.0
		High: 58.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 102.0
		High: 2.0
Files skipped (0):
