Run started:2025-04-13 01:13:10.958316

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_buffered_producer/_buffered_producer_dispatcher.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
53	        if not executor:
54	            self._executor = ThreadPoolExecutor()
55	        elif isinstance(executor, ThreadPoolExecutor):

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_buffered_producer/_buffered_producer_dispatcher.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
58	        elif isinstance(executor, int):
59	            self._executor = ThreadPoolExecutor(executor)
60	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_constants.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	CONTAINER_PREFIX = "eventhub.pysdk-"
40	JWT_TOKEN_SCOPE = "https://eventhubs.azure.net//.default"
41	MGMT_OPERATION = b"com.microsoft:eventhub"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_eventprocessor/event_processor.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
363	        self._running = True
364	        thread = threading.Thread(target=self._load_balancing)
365	        thread.daemon = True

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_producer_client.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
307	
308	        self._buffered_send(
309	            event_data_batch,
310	            partition_id=pid,
311	            partition_key=pkey,
312	            timeout_time=timeout_time,
313	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_producer_client.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
325	        timeout_time = time.time() + timeout if timeout else None
326	        self._buffered_send(
327	            event,
328	            partition_id=partition_id,
329	            partition_key=partition_key,
330	            timeout_time=timeout_time,
331	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_producer_client.py:623
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
622	            try:
623	                cast(EventHubProducer, self._producers[pid]).send(
624	                    event_data, partition_key=partition_key, timeout=send_timeout
625	                )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_producer_client.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
627	                self._start_producer(pid, send_timeout)
628	                cast(EventHubProducer, self._producers[pid]).send(
629	                    event_data, partition_key=partition_key, timeout=send_timeout
630	                )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_producer_client.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
728	            try:
729	                cast(EventHubProducer, self._producers[partition_id]).send(
730	                    batch, partition_key=pkey, timeout=send_timeout
731	                )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_producer_client.py:741
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
740	                self._start_producer(partition_id, send_timeout)
741	                cast(EventHubProducer, self._producers[partition_id]).send(
742	                    batch, partition_key=pkey, timeout=send_timeout
743	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
214	    def __exit__(self, *args: Any) -> None:
215	        self.close()
216	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
239	            if not self.state:
240	                self._transport.connect()
241	                self._set_state(ConnectionState.START)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
248	                if self.state != ConnectionState.HDR_EXCH:
249	                    self._disconnect()
250	                    raise ValueError("Did not receive reciprocal protocol header. Disconnecting.")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
268	        self._set_state(ConnectionState.END)
269	        self._transport.close()
270	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
315	
316	        if self._can_write():
317	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
350	        try:
351	            if self._can_write():
352	                if self._network_trace:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
353	                    _LOGGER.debug("-> EmptyFrame()", extra=self._network_trace_params)
354	                self._transport.write(EMPTY_FRAME)
355	                self._last_frame_sent_time = time.time()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
369	            _LOGGER.debug("-> Header(%r)", HEADER_FRAME, extra=self._network_trace_params)
370	        self._transport.write(HEADER_FRAME)
371	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
430	            _LOGGER.error("OPEN frame received on a channel that is not 0.", extra=self._network_trace_params)
431	            self.close(
432	                error=AMQPError(
433	                    condition=ErrorCondition.NotAllowed, description="OPEN frame received on a channel that is not 0."
434	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
438	            _LOGGER.error("OPEN frame received in the OPENED state.", extra=self._network_trace_params)
439	            self.close()
440	        if frame[4]:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
447	            # The error amqp:invalid-field shall be set in the error.condition field of the CLOSE frame.
448	            self.close(
449	                error=AMQPError(
450	                    condition=ErrorCondition.InvalidField,
451	                    description="Failed parsing OPEN frame: Max frame size is less than supported minimum.",
452	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
467	        else:
468	            self.close(
469	                error=AMQPError(
470	                    condition=ErrorCondition.IllegalState,
471	                    description=f"connection is an illegal state: {self.state}",
472	                )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
504	        if self.state in disconnect_states:
505	            self._disconnect()
506	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
515	        self._set_state(ConnectionState.CLOSE_RCVD)
516	        self._outgoing_close(error=close_error)
517	        self._disconnect()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
516	        self._outgoing_close(error=close_error)
517	        self._disconnect()
518	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
569	            # close the connection
570	            self.close(
571	                error=AMQPError(
572	                    condition=ErrorCondition.ConnectionCloseForced, description="Invalid channel number received"
573	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
624	            if performative == 24:
625	                self._incoming_close(channel, fields)
626	                return True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
665	            )
666	            self.close(
667	                error=AMQPError(
668	                    condition=ErrorCondition.ConnectionCloseForced,
669	                    description="No frame received for the idle timeout.",
670	                ),
671	                wait=False,
672	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
742	                    )
743	                    self.close(
744	                        error=AMQPError(
745	                            condition=ErrorCondition.ConnectionCloseForced,
746	                            description="No frame received for the idle timeout.",
747	                        ),
748	                        wait=False,
749	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
756	            for _ in range(batch):
757	                if self._can_read():
758	                    if self._read_frame(wait=wait, **kwargs):

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
756	            for _ in range(batch):
757	                if self._can_read():
758	                    if self._read_frame(wait=wait, **kwargs):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:842
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
841	        """
842	        self._connect()
843	        self._outgoing_open()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:869
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
868	                return
869	            self._outgoing_close(error=error)
870	            if error:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_connection.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
889	        finally:
890	            self._disconnect()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_frame.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	
100	        header = output.write(struct.pack('!B', # pylint: disable=unused-variable
101	                             (
102	                                    self.fin << 7 |  # FIN
103	                                    self.rsv1 << 6 |  # RSV1
104	                                    self.rsv2 << 5 |  # RSV2
105	                                    self.rsv3 << 4 |  # RSV3
106	                                    self.opcode
107	                             )))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_frame.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	        if length < 126:
113	            output.write(struct.pack('!B', mask_bit | length))
114	        elif length < 65536:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_frame.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	        elif length < 65536:
115	            output.write(struct.pack('!BH', mask_bit | 126, length))
116	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_frame.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	        else:
117	            output.write(struct.pack('!BQ', mask_bit | 127, length))
118	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_frame.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
120	            masking_key = os.urandom(4)
121	            output.write(masking_key)
122	            mask_payload(masking_key, payload)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_frame.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
122	            mask_payload(masking_key, payload)
123	        output.write(payload)
124	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_headers.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
58	    random_bytes: bytes = os.urandom(16)
59	    return base64.b64encode(random_bytes)
60	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_headers.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
58	    random_bytes: bytes = os.urandom(16)
59	    return base64.b64encode(random_bytes)
60	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
75	                )
76	                self._socket.sendall(f'CONNECT {self._ws_url.hostname}:{self._ws_url.port} HTTP/1.1\r\n\r\n'.encode())
77	                proxy_response = parse_proxy_response(self._socket.recv(1024))

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
76	                self._socket.sendall(f'CONNECT {self._ws_url.hostname}:{self._ws_url.port} HTTP/1.1\r\n\r\n'.encode())
77	                proxy_response = parse_proxy_response(self._socket.recv(1024))
78	                if not proxy_response[0].startswith(b'HTTP/'):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
78	                if not proxy_response[0].startswith(b'HTTP/'):
79	                    self._socket.close()
80	                    raise ConnectionError('Received invalid response from the proxy')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
82	                if int(proxy_response[1]) < 100 or int(proxy_response[1]) > 999:
83	                    self._socket.close()
84	                    raise ConnectionError('Received invalid status code from the proxy')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
86	                if proxy_response[1] != b'200':
87	                    self._socket.close()
88	                    raise ConnectionError('Could not connect to the proxy')

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
113	            self._socket.setblocking(True)
114	            self._socket.settimeout(self._timeout)
115	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
125	            # start the handshake
126	            self._socket.sendall(self._headers)
127	            self._conn_status = ConnectionStatus.CONNECTING

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
143	            line = []
144	            data = self._socket.recv(1)
145	            while data != b'\n':

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
146	                line.append(data)
147	                data = self._socket.recv(1)
148	            line.append(data)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
285	        if frame.opcode == Opcode.CLOSE:
286	            self.close()
287	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
296	            try:
297	                chunk = self._socket.recv(min(4096,to_receive))
298	                if not chunk:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
320	            try:
321	                sent = self._socket.send(payload)
322	            except ValueError:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
320	            try:
321	                sent = self._socket.send(payload)
322	            except ValueError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
358	            self._socket.shutdown(socket.SHUT_RDWR)
359	            self._socket.close()
360	        except OSError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
397	                )
398	                self._stream_writer.write(
399	                    f'CONNECT {self._ws_url.hostname}:{self._ws_url.port} HTTP/1.1\r\n\r\n'.encode()
400	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
403	                if not proxy_response[0].startswith(b'HTTP/'):
404	                    self._stream_writer.close()
405	                    raise ConnectionError('Received invalid response from the proxy')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
407	                if int(proxy_response[1]) < 100 or int(proxy_response[1]) > 999:
408	                    self._stream_writer.close()
409	                    raise ConnectionError('Received invalid status code from the proxy')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
411	                if proxy_response[1] != b'200':
412	                    self._stream_writer.close()
413	                    raise ConnectionError('Could not connect to the proxy')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
415	                if proxy_response[2] != b'Connection established':
416	                    self._stream_writer.close()
417	                    raise ConnectionError('Could not connect to the proxy')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
435	            # start the handshake
436	            self._stream_writer.write(self._headers)
437	            await self._stream_writer.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
563	        if frame.opcode == Opcode.CLOSE and self._conn_status == ConnectionStatus.OPEN:
564	            await self.close()
565	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
579	        try:
580	            self._stream_writer.write(payload)
581	            await self._stream_writer.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_protocol.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
608	        # shut down the socket
609	        self._stream_writer.close()
610	        await asyncio.sleep(0)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
209	            if self.sock and not self.connected:
210	                self.sock.close()
211	                self.sock = None

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
219	        if prev != bocking_timeout:
220	            sock.settimeout(bocking_timeout)
221	        try:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
236	            if bocking_timeout != prev:
237	                sock.settimeout(prev)
238	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
244	        if prev != non_bocking_timeout:
245	            sock.settimeout(non_bocking_timeout)
246	        try:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
261	            if non_bocking_timeout != prev:
262	                sock.settimeout(prev)
263	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
265	    def _init_socket(self, socket_settings, socket_timeout):
266	        self.sock.settimeout(None)  # set socket back to blocking mode
267	        self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, 1)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
280	        self._setup_transport()
281	        self.sock.settimeout(socket_timeout)  # set socket to blocking with timeout
282	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
349	                    )
350	                self.sock.close()
351	                self.sock = None

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
359	                frame_header = memoryview(bytearray(8))
360	                read_frame_buffer.write(read(8, buffer=frame_header, initial=True))
361	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
382	                if size > SIGNED_INT_MAX:
383	                    read_frame_buffer.write(read(SIGNED_INT_MAX, buffer=payload))
384	                    read_frame_buffer.write(read(size - SIGNED_INT_MAX, buffer=payload[SIGNED_INT_MAX:]))

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
383	                    read_frame_buffer.write(read(SIGNED_INT_MAX, buffer=payload))
384	                    read_frame_buffer.write(read(size - SIGNED_INT_MAX, buffer=payload[SIGNED_INT_MAX:]))
385	                else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:386
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
385	                else:
386	                    read_frame_buffer.write(read(payload_size, buffer=payload))
387	            except (socket.timeout, TimeoutError):

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
417	        try:
418	            header, channel, payload = self.read(**kwargs)
419	            if not payload:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
685	            )
686	            self.sock.connect()
687	        except WebSocketConnectionError as exc:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:695
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
694	        except (ConnectionError, SSLError) as exc:  # type: ignore
695	            self.close()
696	            raise ConnectionError("Websocket failed to establish connection: %r" % exc) from exc

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
698	            _LOGGER.info("Websocket connection failed: %r", e, extra=self.network_trace_params)
699	            self.close()
700	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
752	        if self.sock:
753	            self.sock.close()
754	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:833
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
832	        except (WebSocketTimeoutException, SSLError, WebSocketConnectionClosedException) as exc:  # type: ignore
833	            self.close()
834	            raise ConnectionError("Websocket failed to establish connection: %r" % exc) from exc

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
836	            _LOGGER.info("Websocket connection failed: %r", e, extra=self.network_trace_params)
837	            self.close()
838	            raise

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
859	                while n:
860	                    data = self.sock.recv()
861	                    if len(data) <= n:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/_transport.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
889	        if self.sock:
890	            self.sock.close()
891	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
195	    async def __aexit__(self, *args) -> None:
196	        await self.close()
197	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
222	            if not self.state:
223	                await self._transport.connect()
224	                await self._set_state(ConnectionState.START)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
230	                if self.state != ConnectionState.HDR_EXCH:
231	                    await self._disconnect()
232	                    raise ValueError("Did not receive reciprocal protocol header. Disconnecting.")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
250	        await self._set_state(ConnectionState.END)
251	        await self._transport.close()
252	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
301	
302	        if self._can_write():
303	            try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
341	        try:
342	            if self._can_write():
343	                if self._network_trace:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
344	                    _LOGGER.debug("-> EmptyFrame()", extra=self._network_trace_params)
345	                await self._transport.write(EMPTY_FRAME)
346	                self._last_frame_sent_time = time.time()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
358	            _LOGGER.debug("-> Header(%r)", HEADER_FRAME, extra=self._network_trace_params)
359	        await self._transport.write(HEADER_FRAME)
360	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
418	            _LOGGER.error("OPEN frame received on a channel that is not 0.", extra=self._network_trace_params)
419	            await self.close(
420	                error=AMQPError(
421	                    condition=ErrorCondition.NotAllowed,
422	                    description="OPEN frame received on a channel that is not 0.",
423	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
427	            _LOGGER.error("OPEN frame received in the OPENED state.", extra=self._network_trace_params)
428	            await self.close()
429	        if frame[4]:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
436	            # The error amqp:invalid-field shall be set in the error.condition field of the CLOSE frame.
437	            await self.close(
438	                error=AMQPError(
439	                    condition=ErrorCondition.InvalidField,
440	                    description="Failed parsing OPEN frame: Max frame size is less than supported minimum.",
441	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
456	        else:
457	            await self.close(
458	                error=AMQPError(
459	                    condition=ErrorCondition.IllegalState,
460	                    description=f"Connection is an illegal state: {self.state}",
461	                )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
493	        if self.state in disconnect_states:
494	            await self._disconnect()
495	            return

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
508	        await self._set_state(ConnectionState.CLOSE_RCVD)
509	        await self._outgoing_close(error=close_error)
510	        await self._disconnect()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
509	        await self._outgoing_close(error=close_error)
510	        await self._disconnect()
511	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:563
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
562	            # close the connection
563	            await self.close(
564	                error=AMQPError(
565	                    condition=ErrorCondition.ConnectionCloseForced, description="Invalid channel number received"
566	                )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
618	            if performative == 24:
619	                await self._incoming_close(channel, fields)
620	                return True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:659
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
658	            )
659	            await self.close(
660	                error=AMQPError(
661	                    condition=ErrorCondition.ConnectionCloseForced,
662	                    description="No frame received for the idle timeout.",
663	                ),
664	                wait=False,
665	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
736	                    )
737	                    await self.close(
738	                        error=AMQPError(
739	                            condition=ErrorCondition.ConnectionCloseForced,
740	                            description="No frame received for the idle timeout.",
741	                        ),
742	                        wait=False,
743	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
752	            for _ in range(batch):
753	                if self._can_read():
754	                    if await self._read_frame(wait=wait, **kwargs):

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:753
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
752	            for _ in range(batch):
753	                if self._can_read():
754	                    if await self._read_frame(wait=wait, **kwargs):

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
834	        """
835	        await self._connect()
836	        await self._outgoing_open()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:862
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
861	                return
862	            await self._outgoing_close(error=error)
863	            if error:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_connection_async.py:883
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
882	        finally:
883	            await self._disconnect()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
72	        try:
73	            header, channel, payload = await asyncio.wait_for(self.read(**kwargs), timeout=timeout)
74	            if not payload:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
72	        try:
73	            header, channel, payload = await asyncio.wait_for(self.read(**kwargs), timeout=timeout)
74	            if not payload:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
91	                frame_header = memoryview(bytearray(8))
92	                read_frame_buffer.write(await self._read(8, buffer=frame_header, initial=True))
93	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
91	                frame_header = memoryview(bytearray(8))
92	                read_frame_buffer.write(await self._read(8, buffer=frame_header, initial=True))
93	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
91	                frame_header = memoryview(bytearray(8))
92	                read_frame_buffer.write(await self._read(8, buffer=frame_header, initial=True))
93	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	                if size > SIGNED_INT_MAX:
114	                    read_frame_buffer.write(await self._read(SIGNED_INT_MAX, buffer=payload))
115	                    read_frame_buffer.write(await self._read(size - SIGNED_INT_MAX, buffer=payload[SIGNED_INT_MAX:]))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
113	                if size > SIGNED_INT_MAX:
114	                    read_frame_buffer.write(await self._read(SIGNED_INT_MAX, buffer=payload))
115	                    read_frame_buffer.write(await self._read(size - SIGNED_INT_MAX, buffer=payload[SIGNED_INT_MAX:]))

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
113	                if size > SIGNED_INT_MAX:
114	                    read_frame_buffer.write(await self._read(SIGNED_INT_MAX, buffer=payload))
115	                    read_frame_buffer.write(await self._read(size - SIGNED_INT_MAX, buffer=payload[SIGNED_INT_MAX:]))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	                    read_frame_buffer.write(await self._read(SIGNED_INT_MAX, buffer=payload))
115	                    read_frame_buffer.write(await self._read(size - SIGNED_INT_MAX, buffer=payload[SIGNED_INT_MAX:]))
116	                else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
114	                    read_frame_buffer.write(await self._read(SIGNED_INT_MAX, buffer=payload))
115	                    read_frame_buffer.write(await self._read(size - SIGNED_INT_MAX, buffer=payload[SIGNED_INT_MAX:]))
116	                else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
114	                    read_frame_buffer.write(await self._read(SIGNED_INT_MAX, buffer=payload))
115	                    read_frame_buffer.write(await self._read(size - SIGNED_INT_MAX, buffer=payload[SIGNED_INT_MAX:]))
116	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	                else:
117	                    read_frame_buffer.write(await self._read(payload_size, buffer=payload))
118	            except (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	                else:
117	                    read_frame_buffer.write(await self._read(payload_size, buffer=payload))
118	            except (

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
116	                else:
117	                    read_frame_buffer.write(await self._read(payload_size, buffer=payload))
118	            except (

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
124	            ):
125	                read_frame_buffer.write(self._read_buffer.getvalue())
126	                self._read_buffer = read_frame_buffer

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
143	            try:
144	                await self._write(s)
145	            except socket.timeout:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
160	
161	        await self.write(data)
162	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
270	            if self.writer and not self.connected:
271	                self.writer.close()
272	                await self.writer.wait_closed()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
364	        try:
365	            self.writer.write(s)
366	            await self.writer.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
374	                    # Closing the writer closes the underlying socket.
375	                    self.writer.close()
376	                    if self.sslopts:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
389	            return
390	        await self.write(TLS_HEADER_FRAME)
391	        _, returned_header = await self.receive_frame(verify_frame_type=None)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
458	            )
459	            await self.sock.connect()
460	        except WebSocketConnectionError as exc:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
503	        async with self.socket_lock:
504	            await self.sock.close()
505	            self.connected = False

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
584	
585	            self.sock = await self.session.ws_connect(
586	                url=url,
587	                timeout=self.socket_timeout,  # timeout for connect
588	                protocols=[AMQP_WS_SUBPROTOCOL],
589	                autoclose=False,
590	                proxy=http_proxy_host,
591	                proxy_auth=http_proxy_auth,
592	                ssl=self.sslopts if self._use_tls else None,
593	                heartbeat=DEFAULT_WEBSOCKET_HEARTBEAT_SECONDS,
594	            )

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
643	        async with self.socket_lock:
644	            await self.sock.close()
645	            await self.session.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/aio/_transport_async.py:645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
644	            await self.sock.close()
645	            await self.session.close()
646	            self.connected = False

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/endpoints.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	if _CAN_ADD_DOCSTRING:
166	    Source.__doc__ = """
167	    For containers which do not implement address resolution (and do not admit spontaneous link

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/endpoints.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
240	if _CAN_ADD_DOCSTRING:
241	    Target.__doc__ = """
242	    For containers which do not implement address resolution (and do not admit spontaneous link attachment

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/message.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
130	if _CAN_ADD_DOCSTRING:
131	    Properties.__doc__ = """
132	    Immutable properties of the Message.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/message.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	if _CAN_ADD_DOCSTRING:
213	    Message.__doc__ = """
214	    An annotated message consists of the bare message plus sections for annotation at the head and tail

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/performatives.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	if _CAN_ADD_DOCSTRING:
48	    OpenFrame.__doc__ = """
49	    OPEN performative. Negotiate Connection parameters.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/performatives.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
134	if _CAN_ADD_DOCSTRING:
135	    BeginFrame.__doc__ = """
136	    BEGIN performative. Begin a Session on a channel.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/performatives.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	if _CAN_ADD_DOCSTRING:
209	    AttachFrame.__doc__ = """
210	    ATTACH performative. Attach a Link to a Session.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/performatives.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
304	if _CAN_ADD_DOCSTRING:
305	    FlowFrame.__doc__ = """
306	    FLOW performative. Update link state.

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/utils.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
50	    sign_key = "%s\n%d" % (encoded_uri, ttl)
51	    signature = b64encode(HMAC(encoded_key, sign_key.encode("utf-8"), sha256).digest())
52	    result = {"sr": audience, "sig": signature, "se": str(ttl)}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/_pyamqp/utils.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
50	    sign_key = "%s\n%d" % (encoded_uri, ttl)
51	    signature = b64encode(HMAC(encoded_key, sign_key.encode("utf-8"), sha256).digest())
52	    result = {"sr": audience, "sig": signature, "se": str(ttl)}

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/aio/_producer_client_async.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
285	        timeout_time = time.time() + timeout if timeout else None
286	        await self._buffered_send(
287	            event_data_batch,
288	            partition_id=pid,
289	            partition_key=pkey,
290	            timeout_time=timeout_time,
291	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/aio/_producer_client_async.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
303	        timeout_time = time.time() + timeout if timeout else None
304	        await self._buffered_send(
305	            event,
306	            partition_id=partition_id,
307	            partition_key=partition_key,
308	            timeout_time=timeout_time,
309	        )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/aio/_producer_client_async.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
586	            try:
587	                await cast(EventHubProducer, self._producers[pid]).send(
588	                    event_data, partition_key=partition_key, timeout=timeout
589	                )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/aio/_producer_client_async.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
591	                await self._start_producer(pid, timeout)
592	                await cast(EventHubProducer, self._producers[pid]).send(
593	                    event_data, partition_key=partition_key, timeout=timeout
594	                )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/aio/_producer_client_async.py:690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
689	            try:
690	                await cast(EventHubProducer, self._producers[partition_id]).send(
691	                    batch, partition_key=pkey, timeout=timeout
692	                )

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/azure/eventhub/aio/_producer_client_async.py:697
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
696	                await self._start_producer(partition_id, timeout)
697	                await cast(EventHubProducer, self._producers[partition_id]).send(
698	                    batch, partition_key=pkey, timeout=timeout
699	                )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/async_samples/authenticate_with_azure_sas_credential_async.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
30	    signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
31	    signature = url_parse_quote(base64.b64encode(signed_hmac_sha256.digest()))
32	    return "SharedAccessSignature sr={}&sig={}&se={}&skn={}".format(uri, signature, expiry, sas_name)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/async_samples/authenticate_with_azure_sas_credential_async.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
30	    signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
31	    signature = url_parse_quote(base64.b64encode(signed_hmac_sha256.digest()))
32	    return "SharedAccessSignature sr={}&sig={}&se={}&skn={}".format(uri, signature, expiry, sas_name)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/async_samples/authenticate_with_sas_token_async.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
31	    signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
32	    signature = url_parse_quote(base64.b64encode(signed_hmac_sha256.digest()))
33	    return "SharedAccessSignature sr={}&sig={}&se={}&skn={}".format(uri, signature, expiry, sas_name)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/async_samples/authenticate_with_sas_token_async.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
31	    signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
32	    signature = url_parse_quote(base64.b64encode(signed_hmac_sha256.digest()))
33	    return "SharedAccessSignature sr={}&sig={}&se={}&skn={}".format(uri, signature, expiry, sas_name)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/async_samples/iot_hub_connection_string_receive_async.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	    sign_key = "%s\n%d" % (encoded_uri, ttl)
41	    signature = b64encode(HMAC(b64decode(key), sign_key.encode("utf-8"), sha256).digest())
42	    result = {"sr": uri, "sig": signature, "se": str(ttl)}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/async_samples/iot_hub_connection_string_receive_async.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
40	    sign_key = "%s\n%d" % (encoded_uri, ttl)
41	    signature = b64encode(HMAC(b64decode(key), sign_key.encode("utf-8"), sha256).digest())
42	    result = {"sr": uri, "sig": signature, "se": str(ttl)}

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/async_samples/iot_hub_connection_string_receive_async.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
40	    sign_key = "%s\n%d" % (encoded_uri, ttl)
41	    signature = b64encode(HMAC(b64decode(key), sign_key.encode("utf-8"), sha256).digest())
42	    result = {"sr": uri, "sig": signature, "se": str(ttl)}

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/async_samples/iot_hub_connection_string_receive_async.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
40	    sign_key = "%s\n%d" % (encoded_uri, ttl)
41	    signature = b64encode(HMAC(b64decode(key), sign_key.encode("utf-8"), sha256).digest())
42	    result = {"sr": uri, "sig": signature, "se": str(ttl)}

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/async_samples/proxy_async.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
21	HTTP_PROXY: Dict[str, Union[str, int]] = {
22	    "proxy_hostname": "127.0.0.1",  # proxy hostname.
23	    "proxy_port": 3128,  # proxy port.
24	    "username": "admin",  # username used for proxy authentication if needed.
25	    "password": "123456",  # password used for proxy authentication if needed.
26	}
27	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/sync_samples/authenticate_with_azure_sas_credential.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
28	    signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
29	    signature = url_parse_quote(base64.b64encode(signed_hmac_sha256.digest()))
30	    return "SharedAccessSignature sr={}&sig={}&se={}&skn={}".format(uri, signature, expiry, sas_name)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/sync_samples/authenticate_with_azure_sas_credential.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
28	    signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
29	    signature = url_parse_quote(base64.b64encode(signed_hmac_sha256.digest()))
30	    return "SharedAccessSignature sr={}&sig={}&se={}&skn={}".format(uri, signature, expiry, sas_name)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/sync_samples/authenticate_with_sas_token.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
28	    signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
29	    signature = url_parse_quote(base64.b64encode(signed_hmac_sha256.digest()))
30	    return "SharedAccessSignature sr={}&sig={}&se={}&skn={}".format(uri, signature, expiry, sas_name)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/sync_samples/authenticate_with_sas_token.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
28	    signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
29	    signature = url_parse_quote(base64.b64encode(signed_hmac_sha256.digest()))
30	    return "SharedAccessSignature sr={}&sig={}&se={}&skn={}".format(uri, signature, expiry, sas_name)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/sync_samples/proxy.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
19	HTTP_PROXY: Dict[str, Union[str, int]] = {
20	    "proxy_hostname": "127.0.0.1",  # proxy hostname.
21	    "proxy_port": 3128,  # proxy port.
22	    "username": "admin",  # username used for proxy authentication if needed.
23	    "password": "123456",  # password used for proxy authentication if needed.
24	}
25	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/sync_samples/recv_for_period.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	    try:
60	        thread = threading.Thread(
61	            target=consumer_client.receive,
62	            kwargs={
63	                "on_event": on_event,
64	                "on_partition_initialize": on_partition_initialize,
65	                "on_partition_close": on_partition_close,
66	                "on_error": on_error,
67	                "starting_position": "-1",  # "-1" is from the beginning of the partition.
68	            },

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/samples/sync_samples/sample_code_eventhub.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
219	
220	    worker = threading.Thread(
221	        target=consumer.receive,
222	        kwargs={
223	            "on_event": on_event,
224	            "starting_position": "-1",  # "-1" is from the beginning of the partition.
225	        },

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/setup.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	with open(os.path.join(package_folder_path, "_version.py"), "r") as fd:
27	    version = re.search(r'^VERSION\s*=\s*[\'"]([^\'"]*)[\'"]', fd.read(), re.MULTILINE).group(1)
28	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/setup.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	with open("README.md") as f:
33	    readme = f.read()
34	with open("CHANGELOG.md") as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/setup.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	with open("CHANGELOG.md") as f:
35	    changelog = f.read()
36	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/setup.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    author_email="azpysdkhelp@microsoft.com",
55	    url="https://github.com/Azure/azure-sdk-for-python/tree/main/sdk/eventhub/azure-eventhub",
56	    keywords="azure, azure sdk",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/conftest.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	        return
169	    base_url = os.environ.get("EVENTHUB_RESOURCE_MANAGER_URL", "https://management.azure.com/")
170	    credential_scopes = ["{}.default".format(base_url)]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/conftest.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
194	
195	    base_url = os.environ.get("EVENTHUB_RESOURCE_MANAGER_URL", "https://management.azure.com/")
196	    credential_scopes = ["{}.default".format(base_url)]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/conftest.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	
234	    base_url = os.environ.get("EVENTHUB_RESOURCE_MANAGER_URL", "https://management.azure.com/")
235	    credential_scopes = ["{}.default".format(base_url)]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/eventhub_preparer.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	            self.resource = FakeResource(name=name, id=name)
239	            connection_string = "https://microsoft.com"
240	        return {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/eventhub_preparer.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
296	            self.resource = FakeResource(name=name, id=name)
297	            connection_string = "https://microsoft.com"
298	        return {

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/asynctests/test_auth_async.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
223	        context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
224	        await asyncio.to_thread(context.load_verify_locations, certifi.where())
225	        purpose = ssl.Purpose.SERVER_AUTH

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/asynctests/test_auth_async.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
225	        purpose = ssl.Purpose.SERVER_AUTH
226	        await asyncio.to_thread(context.load_default_certs, purpose=purpose)
227	        return context

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/asynctests/test_properties_async.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	    sys.platform.startswith("win"),
105	    reason="Large negative timestamp to datetime conversion fails on Windows with: https://bugs.python.org/issue36439",
106	)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_auth.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
52	    with consumer_client:
53	        worker = threading.Thread(
54	            target=consumer_client.receive,
55	            args=(on_event,),
56	            kwargs={"partition_id": "0", "starting_position": "-1"},
57	        )

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_auth.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
211	    with consumer:
212	        thread = threading.Thread(
213	            target=consumer.receive,
214	            args=(on_event,),
215	            kwargs={"on_error": on_error, "starting_position": "-1"},
216	        )

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_auth.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
260	    with consumer:
261	        thread2 = threading.Thread(
262	            target=consumer.receive,
263	            args=(on_event,),
264	            kwargs={"on_error": on_error, "starting_position": "-1"},
265	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_eventprocessor.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	
69	    thread1 = threading.Thread(target=event_processor1.start)
70	    thread1.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_eventprocessor.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	
83	    thread2 = threading.Thread(target=event_processor2.start)
84	    thread2.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_eventprocessor.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	
147	    thread = threading.Thread(target=event_processor.start)
148	    thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_eventprocessor.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
216	
217	    thread = threading.Thread(target=event_processor.start)
218	    thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_eventprocessor.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
285	    )
286	    thread = threading.Thread(target=event_processor.start)
287	    thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_eventprocessor.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
341	    )
342	    thread = threading.Thread(target=event_processor.start)
343	    thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_eventprocessor.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
425	    event_processor._ownership_manager = ownership_manager
426	    thread = threading.Thread(target=event_processor.start)
427	    thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_eventprocessor.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
492	    )
493	    thread = threading.Thread(target=event_processor.start)
494	    thread.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/livetest/synctests/test_properties.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	    sys.platform.startswith("win"),
102	    reason="Large negative timestamp to datetime conversion fails on Windows with: https://bugs.python.org/issue36439",
103	)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/scripts/pyamqp/preload_eventhub_script_for_receiving.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
73	
74	    executor = ThreadPoolExecutor()
75	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/scripts/pyamqp/sync_receive.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	
81	    thread = threading.Thread(target=target, kwargs=kwargs)
82	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/scripts/pyamqp/sync_receive.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	
83	    monitor_thread = threading.Thread(target=monitor)
84	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/scripts/pyamqp/sync_send.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
113	
114	        with ThreadPoolExecutor(max_workers=parallel_thread_count) as executor:
115	            run_flag = [True]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/asynctests/test_client_creation_async.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	    producer = EventHubProducerClient("fake.host.com", "fake_eh", None, custom_endpoint_address="https://12.34.56.78")
16	    assert producer._config.custom_endpoint_hostname == "12.34.56.78"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/asynctests/test_client_creation_async.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
15	    producer = EventHubProducerClient("fake.host.com", "fake_eh", None, custom_endpoint_address="https://12.34.56.78")
16	    assert producer._config.custom_endpoint_hostname == "12.34.56.78"
17	    assert producer._config.transport_type == TransportType.AmqpOverWebsocket

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/asynctests/test_client_creation_async.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    producer = EventHubProducerClient(
28	        "fake.host.com", "fake_eh", None, custom_endpoint_address="https://fake.endpoint.com:200"
29	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/asynctests/test_client_creation_async.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    consumer = EventHubConsumerClient(
50	        "fake.host.com", "fake_eh", "fake_group", None, custom_endpoint_address="https://12.34.56.78/"
51	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/asynctests/test_client_creation_async.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
51	    )
52	    assert consumer._config.custom_endpoint_hostname == "12.34.56.78"
53	    assert consumer._config.transport_type == TransportType.AmqpOverWebsocket

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/asynctests/test_client_creation_async.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    consumer = EventHubConsumerClient(
64	        "fake.host.com", "fake_eh", "fake_group", None, custom_endpoint_address="https://fake.endpoint.com:200"
65	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/test_client_creation.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	
22	    producer = EventHubProducerClient("fake.host.com", "fake_eh", None, custom_endpoint_address="https://12.34.56.78")
23	    assert producer._config.custom_endpoint_hostname == "12.34.56.78"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/test_client_creation.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
22	    producer = EventHubProducerClient("fake.host.com", "fake_eh", None, custom_endpoint_address="https://12.34.56.78")
23	    assert producer._config.custom_endpoint_hostname == "12.34.56.78"
24	    assert producer._config.transport_type == TransportType.AmqpOverWebsocket

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/test_client_creation.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    producer = EventHubProducerClient(
35	        "fake.host.com", "fake_eh", None, custom_endpoint_address="https://fake.endpoint.com:200"
36	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/test_client_creation.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    consumer = EventHubConsumerClient(
57	        "fake.host.com", "fake_eh", "fake_group", None, custom_endpoint_address="https://12.34.56.78/"
58	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/test_client_creation.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
58	    )
59	    assert consumer._config.custom_endpoint_hostname == "12.34.56.78"
60	    assert consumer._config.transport_type == TransportType.AmqpOverWebsocket

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/test_client_creation.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	    consumer = EventHubConsumerClient(
71	        "fake.host.com", "fake_eh", "fake_group", None, custom_endpoint_address="https://fake.endpoint.com:200"
72	    )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_eventhub-5.15.0b2/azure_eventhub-5.15.0b2/tests/unittest/test_partition_resolver.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
44	        pr = PartitionResolver(partitions)
45	        exc = ThreadPoolExecutor()
46	

--------------------------------------------------

Code scanned:
	Total lines of code: 37034
	Total lines skipped (#nosec): 1

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 39.0
		High: 170.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 201.0
		High: 8.0
Files skipped (0):
