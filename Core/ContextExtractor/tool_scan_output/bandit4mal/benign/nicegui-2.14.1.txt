Run started:2025-04-12 13:35:35.767726

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	RELAY_HOST = 'https://on-air.nicegui.io/'
25	
26	
27	@dataclass(**KWONLY_SLOTS)
28	class Stream:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	            headers.update({'Accept-Encoding': 'identity', 'X-Forwarded-Prefix': data['prefix']})
54	            url = 'http://test' + data['path']
55	            request = self.client.build_request(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
54	            url = 'http://test' + data['path']
55	            request = self.client.build_request(
56	                data['method'],
57	                url,
58	                params=data['params'],
59	                headers=headers,
60	                content=data['body'],
61	            )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
61	            )
62	            response = await self.client.send(request)
63	            self.client.cookies.clear()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
100	            data['params']['nicegui_chunk_size'] = 1024
101	            request = self.client.build_request(
102	                data['method'],
103	                url,
104	                params=data['params'],
105	                headers=headers,
106	            )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
106	            )
107	            response = await self.streaming_client.send(request, stream=True)
108	            stream_id = str(uuid4())

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
128	        async def _handle_close_stream(stream_id: str) -> None:
129	            await self.streams[stream_id].response.aclose()
130	            del self.streams[stream_id]

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
162	                return
163	            Client.instances[client_id].handle_disconnect(data['sid'])
164	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
214	            print('Sorry, you have reached the time limit of this NiceGUI On Air preview.', flush=True)
215	            await self.connect()
216	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
227	            if self.relay.connected:
228	                await asyncio.wait_for(self.disconnect(), timeout=5)
229	            self.log.debug('Connecting...')

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
229	            self.log.debug('Connecting...')
230	            await self.relay.connect(
231	                f'{RELAY_HOST}?device_token={self.token}',
232	                socketio_path='/on_air/socket.io',
233	                transports=['websocket', 'polling'],  # favor websocket over polling
234	                wait_timeout=5,
235	            )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
250	        if self.relay.connected:
251	            await self.relay.disconnect()
252	        for stream in self.streams.values():

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
252	        for stream in self.streams.values():
253	            await stream.response.aclose()
254	        self.streams.clear()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
272	    if core.air:
273	        background_tasks.create(core.air.connect())
274	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/air.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
278	    if core.air:
279	        background_tasks.create(core.air.disconnect())

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/app/app.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
136	        if self.config.reload:
137	            os.kill(os.getppid(), getattr(signal, 'CTRL_C_EVENT' if platform.system() == 'Windows' else 'SIGINT'))
138	        else:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/app/app.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
136	        if self.config.reload:
137	            os.kill(os.getppid(), getattr(signal, 'CTRL_C_EVENT' if platform.system() == 'Windows' else 'SIGINT'))
138	        else:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/app/app.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
136	        if self.config.reload:
137	            os.kill(os.getppid(), getattr(signal, 'CTRL_C_EVENT' if platform.system() == 'Windows' else 'SIGINT'))
138	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/client.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
349	        if self._deleted:
350	            helpers.warn_once('Client has been deleted but is still being used. '
351	                              'This is most likely a bug in your application code. '
352	                              'See https://github.com/zauberzeug/nicegui/issues/3028 for more information.',
353	                              stack_info=True)
354	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/elements/dark_mode.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	            helpers.warn_once(
33	                '`ui.dark_mode` is not supported on pages with `dark=None` while running with `tailwind=True` (the default). '
34	                'See https://github.com/zauberzeug/nicegui/issues/3753 for more information.'
35	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/elements/image.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
56	    pil_image.save(buffer, image_format)
57	    base64_encoded = base64.b64encode(buffer.getvalue())
58	    base64_string = base64_encoded.decode('utf-8')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/elements/image.py:57
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
56	    pil_image.save(buffer, image_format)
57	    base64_encoded = base64.b64encode(buffer.getvalue())
58	    base64_string = base64_encoded.decode('utf-8')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/elements/leaflet.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	        self.tile_layer(
64	            url_template=r'https://{s}.tile.osm.org/{z}/{x}/{y}.png',
65	            options={'attribution': '&copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/elements/leaflet.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	            url_template=r'https://{s}.tile.osm.org/{z}/{x}/{y}.png',
65	            options={'attribution': '&copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors'},
66	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/favicon.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
80	def _char_to_svg(char: str) -> str:
81	    return f'''
82	        <svg viewBox="0 0 128 128" width="128" height="128" xmlns="http://www.w3.org/2000/svg" >
83	            <style>
84	                @supports (-moz-appearance:none) {{
85	                    text {{
86	                        font-size: 100px;
87	                        transform: translateY(0.1em);
88	                    }}
89	                }}
90	                text {{
91	                    font-family: Arial, sans-serif;
92	                }}
93	            </style>
94	            <text y=".9em" font-size="128" font-family="Georgia, sans-serif">{char}</text>
95	        </svg>

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/favicon.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
106	    media_type = media_type.split(':')[1].split(';')[0]
107	    return media_type, base64.b64decode(base64_image)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/favicon.py:107
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
106	    media_type = media_type.split(':')[1].split(';')[0]
107	    return media_type, base64.b64decode(base64_image)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/helpers.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
58	    """Check if the port is open by checking if a TCP connection can be established."""
59	    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
60	    try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/helpers.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
60	    try:
61	        sock.connect((host, port))
62	    except (ConnectionRefusedError, TimeoutError):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/helpers.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
68	    finally:
69	        sock.close()
70	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/helpers.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
94	
95	    host = host if host != '0.0.0.0' else '127.0.0.1'
96	    thread = threading.Thread(target=in_thread, args=(host, port), daemon=True)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/helpers.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
94	
95	    host = host if host != '0.0.0.0' else '127.0.0.1'
96	    thread = threading.Thread(target=in_thread, args=(host, port), daemon=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/helpers.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
95	    host = host if host != '0.0.0.0' else '127.0.0.1'
96	    thread = threading.Thread(target=in_thread, args=(host, port), daemon=True)
97	    thread.start()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/middlewares.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
8	    async def dispatch(self, request: Request, call_next: RequestResponseEndpoint) -> Response:
9	        prefix = request.headers.get('X-Forwarded-Prefix', '')
10	        response = await call_next(request)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/native/native_mode.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
114	    args = host, port, title, width, height, fullscreen, frameless, native.method_queue, native.response_queue
115	    process = mp.Process(target=_open_window, args=args, daemon=True)
116	    process.start()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/native/native_mode.py:129
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
128	        try:
129	            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
130	                s.bind(('localhost', port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/nicegui.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
132	    background_tasks.create(core.app.storage.prune_tab_storage(), name='prune tab storage')
133	    air.connect()
134	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/nicegui.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
139	        app.native.main_window.signal_server_shutdown()
140	    air.disconnect()
141	    app.stop()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/nicegui.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
186	    if client:
187	        client.handle_disconnect(sid)
188	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/run.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
11	
12	process_pool = ProcessPoolExecutor()
13	thread_pool = ThreadPoolExecutor()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/run.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
12	process_pool = ProcessPoolExecutor()
13	thread_pool = ThreadPoolExecutor()
14	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/scripts/pack.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	DESCRIPTION = '''
11	Build a package of your NiceGUI app

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/scripts/pack.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
51	        if Path(directory).exists():
52	            Path(directory).rmdir()
53	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/scripts/pack.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
53	
54	    command = ['pyinstaller'] if platform.system() == 'Windows' else ['python', '-m', 'PyInstaller']
55	    command.extend(['--name', args.name])

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/scripts/pack.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
53	
54	    command = ['pyinstaller'] if platform.system() == 'Windows' else ['python', '-m', 'PyInstaller']
55	    command.extend(['--name', args.name])

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/scripts/pack.py:54
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
53	
54	    command = ['pyinstaller'] if platform.system() == 'Windows' else ['python', '-m', 'PyInstaller']
55	    command.extend(['--name', args.name])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	
54	    path = Path(os.environ.get('NICEGUI_STORAGE_PATH', '.nicegui')).resolve()
55	    """Path to use for local persistence. Defaults to ".nicegui"."""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	
57	    redis_url = os.environ.get('NICEGUI_REDIS_URL', None)
58	    """URL to use for shared persistent storage via Redis. Defaults to None, which means local file storage is used."""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
59	
60	    redis_key_prefix = os.environ.get('NICEGUI_REDIS_KEY_PREFIX', 'nicegui:')
61	    """Prefix for Redis keys. Defaults to "nicegui:"."""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	        """
86	        request: Optional[Request] = request_contextvar.get()
87	        if request is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	            if self._is_in_auto_index_context():
89	                raise RuntimeError('app.storage.browser can only be used with page builder functions '
90	                                   '(https://nicegui.io/documentation/page)')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	        """
108	        request: Optional[Request] = request_contextvar.get()
109	        if request is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
110	            if self._is_in_auto_index_context():
111	                raise RuntimeError('app.storage.user can only be used with page builder functions '
112	                                   '(https://nicegui.io/documentation/page)')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	        if self._is_in_auto_index_context():
145	            raise RuntimeError('app.storage.client can only be used with page builder functions '
146	                               '(https://nicegui.io/documentation/page)')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	        if self._is_in_auto_index_context():
153	            raise RuntimeError('app.storage.tab can only be used with page builder functions '
154	                               '(https://nicegui.io/documentation/page)')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
156	        if not client.has_socket_connection:
157	            raise RuntimeError('app.storage.tab can only be used with a client connection; '
158	                               'see https://nicegui.io/documentation/page#wait_for_client_connection to await it')

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/storage.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
207	        if self.path.exists():
208	            self.path.rmdir()
209	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/testing/screen.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	        app.on_connect(self.connected.set)
36	        self.url = f'http://localhost:{self.PORT}'
37	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/testing/screen.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	        """Start the webserver in a separate thread. This is the equivalent of `ui.run()` in a normal script."""
40	        self.server_thread = threading.Thread(target=ui.run, kwargs=self.ui_run_kwargs)
41	        self.server_thread.start()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/testing/screen_plugin.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
82	    if DOWNLOAD_DIR.exists():
83	        shutil.rmtree(DOWNLOAD_DIR)
84	    if logs:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/testing/user.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
37	        self.notify = UserNotify()
38	        self.download = UserDownload(self)
39	        self.javascript_rules: Dict[re.Pattern, Callable[[re.Match], Any]] = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/testing/user_plugin.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    async with core.app.router.lifespan_context(core.app):
47	        async with httpx.AsyncClient(transport=httpx.ASGITransport(core.app), base_url='http://test') as client:
48	            yield User(client)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/testing/user_plugin.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	    async with core.app.router.lifespan_context(core.app):
65	        yield lambda: User(httpx.AsyncClient(transport=httpx.ASGITransport(core.app), base_url='http://test'))
66	    ui.navigate = Navigate()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/ui_run.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
175	        show = False
176	        host = host or '127.0.0.1'
177	        port = port or native_module.find_open_port()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/ui_run.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
178	        width, height = window_size or (800, 600)
179	        native_host = '127.0.0.1' if host == '0.0.0.0' else host
180	        native_module.activate(native_host, port, title, width, height, fullscreen, frameless)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/ui_run.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
178	        width, height = window_size or (800, 600)
179	        native_host = '127.0.0.1' if host == '0.0.0.0' else host
180	        native_module.activate(native_host, port, title, width, height, fullscreen, frameless)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/ui_run.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
182	        port = port or 8080
183	        host = host or '0.0.0.0'
184	    assert host is not None

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/welcome.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
21	        return
22	    ips = set((await run.io_bound(_get_all_ips)) if host == '0.0.0.0' else [])
23	    ips.discard('127.0.0.1')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/welcome.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
22	    ips = set((await run.io_bound(_get_all_ips)) if host == '0.0.0.0' else [])
23	    ips.discard('127.0.0.1')
24	    sorted_ips = ['localhost' if host == '0.0.0.0' else host, *sorted(ips)]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nicegui-2.14.1/nicegui-2.14.1/nicegui/welcome.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
23	    ips.discard('127.0.0.1')
24	    sorted_ips = ['localhost' if host == '0.0.0.0' else host, *sorted(ips)]
25	    urls = [(f'http://{ip}:{port}' if port != '80' else f'http://{ip}') for ip in sorted_ips]

--------------------------------------------------

Code scanned:
	Total lines of code: 24594
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 39.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 64.0
		High: 6.0
Files skipped (0):
