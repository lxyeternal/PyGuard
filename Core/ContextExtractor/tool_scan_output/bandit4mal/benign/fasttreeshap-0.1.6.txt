Run started:2025-04-12 10:26:18.389903

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/datasets.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	
11	github_data_url = "https://github.com/slundberg/shap/raw/master/data/"
12	
13	def imagenet50(display=False, resolution=224): # pylint: disable=unused-argument

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/datasets.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
232	    """
233	    rank_data_url = 'https://raw.githubusercontent.com/Microsoft/LightGBM/master/examples/lambdarank/'
234	    x_train, y_train = sklearn.datasets.load_svmlight_file(cache(rank_data_url + 'rank.train'))

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/datasets.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
251	    if not os.path.isfile(file_path):
252	        urlretrieve(url, file_path)
253	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
380	                except ValueError as e:
381	                        raise ValueError("This reshape error is often caused by passing a bad data matrix to SHAP. " \
382	                                         "See https://github.com/slundberg/shap/issues/580") from e

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
401	                    except ValueError as e:
402	                        raise Exception("This reshape error is often caused by passing a bad data matrix to SHAP. " \
403	                                         "See https://github.com/slundberg/shap/issues/580") from e

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
409	                if type(X) != catboost.Pool:
410	                    X = catboost.Pool(X, cat_features=self.model.cat_feature_indices)
411	                phi = self.model.original_model.get_feature_importance(data=X, fstr_type='ShapValues')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1521	        # load the model parameters
1522	        self.base_score = self.read('f')
1523	        self.num_feature = self.read('I')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1522	        self.base_score = self.read('f')
1523	        self.num_feature = self.read('I')
1524	        self.num_class = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1523	        self.num_feature = self.read('I')
1524	        self.num_class = self.read('i')
1525	        self.contain_extra_attrs = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1524	        self.num_class = self.read('i')
1525	        self.contain_extra_attrs = self.read('i')
1526	        self.contain_eval_metrics = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1525	        self.contain_extra_attrs = self.read('i')
1526	        self.contain_eval_metrics = self.read('i')
1527	        self.read_arr('i', 29) # reserved

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1527	        self.read_arr('i', 29) # reserved
1528	        self.name_obj_len = self.read('Q')
1529	        self.name_obj = self.read_str(self.name_obj_len)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1529	        self.name_obj = self.read_str(self.name_obj_len)
1530	        self.name_gbm_len = self.read('Q')
1531	        self.name_gbm = self.read_str(self.name_gbm_len)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1542	        # load the gbtree specific parameters
1543	        self.num_trees = self.read('i')
1544	        self.num_roots = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1543	        self.num_trees = self.read('i')
1544	        self.num_roots = self.read('i')
1545	        self.num_feature = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1544	        self.num_roots = self.read('i')
1545	        self.num_feature = self.read('i')
1546	        self.pad_32bit = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1545	        self.num_feature = self.read('i')
1546	        self.pad_32bit = self.read('i')
1547	        self.num_pbuffer_deprecated = self.read('Q')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1546	        self.pad_32bit = self.read('i')
1547	        self.num_pbuffer_deprecated = self.read('Q')
1548	        self.num_output_group = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1548
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1547	        self.num_pbuffer_deprecated = self.read('Q')
1548	        self.num_output_group = self.read('i')
1549	        self.size_leaf_vector = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1548	        self.num_output_group = self.read('i')
1549	        self.size_leaf_vector = self.read('i')
1550	        self.read_arr('i', 32) # reserved

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1570	            # load the per-tree params
1571	            self.num_roots[i] = self.read('i')
1572	            self.num_nodes[i] = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1571	            self.num_roots[i] = self.read('i')
1572	            self.num_nodes[i] = self.read('i')
1573	            self.num_deleted[i] = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1572	            self.num_nodes[i] = self.read('i')
1573	            self.num_deleted[i] = self.read('i')
1574	            self.max_depth[i] = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1573	            self.num_deleted[i] = self.read('i')
1574	            self.max_depth[i] = self.read('i')
1575	            self.num_feature[i] = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1574	            self.max_depth[i] = self.read('i')
1575	            self.num_feature[i] = self.read('i')
1576	            self.size_leaf_vector[i] = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1575	            self.num_feature[i] = self.read('i')
1576	            self.size_leaf_vector[i] = self.read('i')
1577	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1586
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1585	            for j in range(self.num_nodes[i]):
1586	                self.node_parents[-1][j] = self.read('i')
1587	                self.node_cleft[-1][j] = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1586	                self.node_parents[-1][j] = self.read('i')
1587	                self.node_cleft[-1][j] = self.read('i')
1588	                self.node_cright[-1][j] = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1587	                self.node_cleft[-1][j] = self.read('i')
1588	                self.node_cright[-1][j] = self.read('i')
1589	                self.node_sindex[-1][j] = self.read('I')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1588	                self.node_cright[-1][j] = self.read('i')
1589	                self.node_sindex[-1][j] = self.read('I')
1590	                self.node_info[-1][j] = self.read('f')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1589	                self.node_sindex[-1][j] = self.read('I')
1590	                self.node_info[-1][j] = self.read('f')
1591	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1597	            for j in range(self.num_nodes[i]):
1598	                self.loss_chg[-1][j] = self.read('f')
1599	                self.sum_hess[-1][j] = self.read('f')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1598	                self.loss_chg[-1][j] = self.read('f')
1599	                self.sum_hess[-1][j] = self.read('f')
1600	                self.base_weight[-1][j] = self.read('f')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1599	                self.sum_hess[-1][j] = self.read('f')
1600	                self.base_weight[-1][j] = self.read('f')
1601	                self.leaf_child_cnt[-1][j] = self.read('i')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/explainers/_tree.py:1601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1600	                self.base_weight[-1][j] = self.read('f')
1601	                self.leaf_child_cnt[-1][j] = self.read('i')
1602	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
242	    with io.open(bundle_path, encoding="utf-8") as f:
243	        bundle_data = f.read()
244	    return "<script charset='utf-8'>{bundle_data}</script>".format(bundle_data=bundle_data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
250	    with open(logo_path, "rb") as f:
251	        logo_data = f.read()
252	    logo_data = base64.b64encode(logo_data).decode('utf-8')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
251	        logo_data = f.read()
252	    logo_data = base64.b64encode(logo_data).decode('utf-8')
253	    display(HTML(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:252
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
251	        logo_data = f.read()
252	    logo_data = base64.b64encode(logo_data).decode('utf-8')
253	    display(HTML(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
280	    if full_html:
281	        out_file.write("<html><head><meta http-equiv='content-type' content='text/html'; charset='utf-8'>")
282	    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
282	    
283	    out_file.write("<script>\n")
284	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	    with open(bundle_path, "r", encoding="utf-8") as f:
288	        bundle_data = f.read()
289	    out_file.write(bundle_data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
288	        bundle_data = f.read()
289	    out_file.write(bundle_data)
290	    out_file.write("</script>")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
289	    out_file.write(bundle_data)
290	    out_file.write("</script>")
291	    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
292	    if full_html:
293	        out_file.write("</head><body>\n")
294	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
294	
295	    out_file.write(plot.html())
296	    

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_force.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
297	    if full_html:
298	        out_file.write("</body></html>\n")
299	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/plots/_image.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	    
265	    image_viz_script = f"""
266	        <script>
267	            
268	            var {uuid}_heatmap_flat_state = null;
269	            var {uuid}_opacity = 0.35
270	            
271	            function onMouseHoverFlat_{uuid}(id) {{
272	                if ({uuid}_heatmap_flat_state === null) {{
273	                    document.getElementById(id).style.backgroundColor  = "grey";
274	                    {uuid}_update_image_and_overlay(id);
275	                }}            
276	            }}
277	            
278	            function onMouseOutFlat_{uuid}(id) {{
279	                if ({uuid}_heatmap_flat_state === null) {{
280	                    document.getElementById(id).style.backgroundColor  = "transparent";
281	                    {uuid}_update_image_and_overlay(null);
282	                }}                
283	            }}
284	
285	            function onMouseClickFlat_{uuid}(id) {{
286	                if ({uuid}_heatmap_flat_state === null) {{
287	                    document.getElementById(id).style.backgroundColor  = "grey";
288	                    document.getElementById('{uuid}_opacity').style.display  = "block";
289	                    {uuid}_update_image_and_overlay(id);
290	                    {uuid}_heatmap_flat_state = id;
291	                }}
292	                else {{
293	                    if ({uuid}_heatmap_flat_state === id) {{
294	                        document.getElementById(id).style.backgroundColor  = "transparent";
295	                        document.getElementById('{uuid}_opacity').style.display  = "none";
296	                        {uuid}_update_image_and_overlay(null);
297	                        {uuid}_heatmap_flat_state = null;
298	                    }}
299	                    else {{
300	                        document.getElementById({uuid}_heatmap_flat_state).style.backgroundColor  = "transparent";
301	                        document.getElementById(id).style.backgroundColor  = "grey";
302	                        {uuid}_update_image_and_overlay(id)
303	                        {uuid}_heatmap_flat_state = id
304	                    }}
305	                }}
306	            }}         
307	
308	            const {uuid}_image_data_matrix = {image_data_json};
309	            const {uuid}_image_data_gray_scale = {image_data_gray_scale_json};
310	            const {uuid}_image_height = {image_height};
311	            const {uuid}_image_width = {image_width};
312	            const {uuid}_shap_values_color_dict = {shap_values_color_dict_json};
313	            
314	            {uuid}_canvas = document.getElementById('{uuid}_image_canvas');
315	            {uuid}_context = {uuid}_canvas.getContext('2d');
316	            
317	            var {uuid}_imageData = {uuid}_convert_image_matrix_to_data({uuid}_image_data_matrix, {image_height}, {image_width}, {uuid}_context);            
318	            var {uuid}_currImagData = {uuid}_imageData;
319	            
320	            
321	            {uuid}_trackTransforms({uuid}_context);
322	            initial_scale_factor = Math.min({uuid}_canvas.height/{uuid}_image_height,{uuid}_canvas.width/{uuid}_image_width);
323	            {uuid}_context.scale(initial_scale_factor, initial_scale_factor);
324	            
325	            function {uuid}_update_image_and_overlay(selected_id) {{
326	                if (selected_id == null) {{
327	                    {uuid}_currImagData = {uuid}_imageData;
328	                    {uuid}_redraw();
329	                }}
330	                else {{
331	                    {uuid}_currImagData = {uuid}_blend_image_shap_map({uuid}_image_data_gray_scale, {uuid}_shap_values_color_dict[selected_id], {image_height}, {image_width}, {uuid}_opacity, {uuid}_context);
332	                    {uuid}_redraw();
333	                }}
334	            }}
335	            
336	            function {uuid}_set_opacity(value) {{
337	                {uuid}_opacity = value/100;
338	                
339	                if ({uuid}_heatmap_flat_state !== null ) {{
340	                    {uuid}_currImagData = {uuid}_blend_image_shap_map({uuid}_image_data_gray_scale, {uuid}_shap_values_color_dict[{uuid}_heatmap_flat_state], {image_height}, {image_width}, {uuid}_opacity, {uuid}_context);                    
341	                    {uuid}_redraw();
342	                }}
343	            }}
344	            
345	            function {uuid}_redraw() {{
346	
347	                // Clear the entire canvas
348	                var p1 = {uuid}_context.transformedPoint(0, 0);
349	                var p2 = {uuid}_context.transformedPoint({uuid}_canvas.width, {uuid}_canvas.height);
350	                {uuid}_context.clearRect(p1.x, p1.y, p2.x - p1.x, p2.y - p1.y);
351	
352	                {uuid}_context.save();
353	                {uuid}_context.setTransform(1, 0, 0, 1, 0, 0);
354	                {uuid}_context.clearRect(0, 0, {uuid}_canvas.width, {uuid}_canvas.height);
355	                {uuid}_context.restore();
356	
357	                createImageBitmap({uuid}_currImagData, {{ premultiplyAlpha: 'premultiply' }}).then(function(imgBitmap) {{
358	                    {uuid}_context.drawImage(imgBitmap, 0, 0);
359	                }});
360	            }}
361	            {uuid}_redraw();
362	            {uuid}_context.save();
363	
364	            var lastX = {uuid}_canvas.width / 2,
365	                lastY = {uuid}_canvas.height / 2;
366	
367	            var dragStart, dragged;
368	
369	            {uuid}_canvas.addEventListener('mousedown', function(evt) {{
370	                document.body.style.mozUserSelect = document.body.style.webkitUserSelect = document.body.style.userSelect = 'none';
371	                lastX = evt.offsetX || (evt.pageX - {uuid}_canvas.offsetLeft);
372	                lastY = evt.offsetY || (evt.pageY - {uuid}_canvas.offsetTop);
373	                dragStart = {uuid}_context.transformedPoint(lastX, lastY);
374	                dragged = false;
375	                document.getElementById('{uuid}_image_canvas').style.cursor = 'grabbing';
376	            }}, false);
377	
378	            {uuid}_canvas.addEventListener('mousemove', function(evt) {{
379	                lastX = evt.offsetX || (evt.pageX - {uuid}_canvas.offsetLeft);
380	                lastY = evt.offsetY || (evt.pageY - {uuid}_canvas.offsetTop);
381	                dragged = true;
382	                if (dragStart) {{
383	                    var pt = {uuid}_context.transformedPoint(lastX, lastY);
384	                    {uuid}_context.translate(pt.x - dragStart.x, pt.y - dragStart.y);
385	                    {uuid}_redraw();
386	                }}
387	            }}, false);
388	
389	            {uuid}_canvas.addEventListener('mouseup', function(evt) {{
390	                dragStart = null;
391	                document.getElementById('{uuid}_image_canvas').style.cursor = 'grab';
392	            }}, false);
393	
394	            var scaleFactor = 1.1;
395	
396	            var {uuid}_zoom = function(clicks) {{
397	                var pt = {uuid}_context.transformedPoint(lastX, lastY);
398	                {uuid}_context.translate(pt.x, pt.y);
399	                var factor = Math.pow(scaleFactor, clicks);
400	                {uuid}_context.scale(factor, factor);
401	                {uuid}_context.translate(-pt.x, -pt.y);
402	                {uuid}_redraw();
403	            }}
404	            
405	            var {uuid}_reset = function(clicks) {{
406	                {uuid}_context.restore();
407	                {uuid}_redraw();
408	                {uuid}_context.save();
409	            }}
410	            
411	            var handleScroll = function(evt) {{
412	                var delta = evt.wheelDelta ? evt.wheelDelta / 40 : evt.detail ? -evt.detail : 0;
413	                if (delta) {uuid}_zoom(delta);
414	                return evt.preventDefault() && false;
415	            }}
416	
417	            {uuid}_canvas.addEventListener('DOMMouseScroll', handleScroll, false);
418	            {uuid}_canvas.addEventListener('mousewheel', handleScroll, false);
419	
420	
421	
422	            function {uuid}_trackTransforms(ctx) {{
423	                var svg = document.createElementNS("http://www.w3.org/2000/svg", 'svg');
424	                var xform = svg.createSVGMatrix();
425	                ctx.getTransform = function() {{
426	                    return xform;
427	                }}
428	
429	                var savedTransforms = [];
430	                var save = ctx.save;
431	                ctx.save = function() {{
432	                    savedTransforms.push(xform.translate(0, 0));
433	                    return save.call(ctx);
434	                }}
435	
436	                var restore = ctx.restore;
437	                ctx.restore = function() {{
438	                    xform = savedTransforms.pop();
439	                    return restore.call(ctx);
440	                }}
441	
442	                var scale = ctx.scale;
443	                ctx.scale = function(sx, sy) {{
444	                    xform = xform.scaleNonUniform(sx, sy);
445	                    return scale.call(ctx, sx, sy);
446	                }}
447	
448	                var rotate = ctx.rotate;
449	                ctx.rotate = function(radians) {{
450	                    xform = xform.rotate(radians * 180 / Math.PI);
451	                    return rotate.call(ctx, radians);
452	                }}
453	
454	                var translate = ctx.translate;
455	                ctx.translate = function(dx, dy) {{
456	                    xform = xform.translate(dx, dy);
457	                    return translate.call(ctx, dx, dy);
458	                }}
459	
460	                var transform = ctx.transform;
461	                ctx.transform = function(a, b, c, d, e, f) {{
462	                    var m2 = svg.createSVGMatrix();
463	                    m2.a = a;
464	                    m2.b = b;
465	                    m2.c = c;
466	                    m2.d = d;
467	                    m2.e = e;
468	                    m2.f = f;
469	                    xform = xform.multiply(m2);
470	                    return transform.call(ctx, a, b, c, d, e, f);
471	                }}
472	
473	                var setTransform = ctx.setTransform;
474	                ctx.setTransform = function(a, b, c, d, e, f) {{
475	                    xform.a = a;
476	                    xform.b = b;
477	                    xform.c = c;
478	                    xform.d = d;
479	                    xform.e = e;
480	                    xform.f = f;
481	                    return setTransform.call(ctx, a, b, c, d, e, f);
482	                }}
483	
484	                var pt = svg.createSVGPoint();
485	                ctx.transformedPoint = function(x, y) {{
486	                    pt.x = x;
487	                    pt.y = y;
488	                    return pt.matrixTransform(xform.inverse());
489	                }}
490	            }}
491	            
492	
493	            function {uuid}_convert_image_matrix_to_data(image_data_matrix, image_height, image_width, context) {{
494	
495	                var imageData = context.createImageData(image_height, image_width);
496	
497	                for(var row_index = 0; row_index < image_height; row_index++) {{
498	                    for(var col_index = 0; col_index < image_width; col_index++) {{
499	
500	                        index = (row_index * image_width + col_index) * 4;
501	
502	                        imageData.data[index + 0] = image_data_matrix[row_index][col_index][0];
503	                        imageData.data[index + 1] = image_data_matrix[row_index][col_index][1];
504	                        imageData.data[index + 2] = image_data_matrix[row_index][col_index][2];
505	                        imageData.data[index + 3] = 255;
506	                    }}
507	                }}
508	                
509	                return imageData;
510	            }}
511	            
512	            function {uuid}_blend_image_shap_map(image_data_matrix, shap_color_map, image_height, image_width, alpha, context) {{
513	                var blendedImageData = context.createImageData(image_height, image_width);

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/fasttreeshap/utils/image.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	    """
60	    image = cv2.imread(path_to_image)
61	    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB) 

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/setup.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
33	    with codecs.open(os.path.join(here, *parts), 'r') as fp:
34	        return fp.read()
35	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	def find_version(*file_paths):
38	    version_file = read(*file_paths)
39	    version_match = re.search(r"^__version__ = ['\"]([^'\"]*)['\"]", version_file, re.M)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fasttreeshap-0.1.6/fasttreeshap-0.1.6/setup.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	        long_description_content_type="text/markdown",
140	        url='http://github.com/linkedin/fasttreeshap',
141	        author='Jilei Yang',

--------------------------------------------------

Code scanned:
	Total lines of code: 11937
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 45.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 51.0
		High: 1.0
Files skipped (0):
