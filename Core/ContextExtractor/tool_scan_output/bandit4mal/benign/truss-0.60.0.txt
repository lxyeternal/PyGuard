Run started:2025-04-12 11:12:18.324064

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/definitions.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
197	            if isinstance(base_image, str):
198	                doc_link = "https://docs.baseten.co/chains-reference/sdk#class-truss-chains-dockerimage"
199	                raise ChainsUsageError(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/code_gen.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	_MODEL_CLS_NAME = "TrussChainletModel"
50	_TRUSS_GIT = "git+https://github.com/basetenlabs/truss.git"
51	_TRUSS_PIP_PATTERN = re.compile(

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/code_gen.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
398	    if chainlet_dir.exists():
399	        shutil.rmtree(chainlet_dir)
400	    chainlet_dir.mkdir(exist_ok=False, parents=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
224	    def __init__(self, port: int, **kwargs):
225	        remote_url = f"http://localhost:{port}"
226	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
232	    def is_live(self) -> bool:
233	        response = self._send_request(self._service_url, "GET")
234	        if response.status_code == 200:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
238	    def is_ready(self) -> bool:
239	        response = self._send_request(self._service_url, "GET")
240	        if response.status_code == 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
380	        headers = self._remote._auth_service.authenticate().header()
381	        response = requests.post(
382	            self.run_remote_url, json=json_data, headers=headers, stream=True
383	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
388	
389	        if response.headers.get("transfer-encoding") == "chunked":
390	            # Case of streaming response, the backend does not set an encoding, so

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
623	        )
624	        with framework.ChainletImporter.import_target(
625	            source, entrypoint
626	        ) as entrypoint_cls:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py:724
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
723	            try:
724	                with framework.ChainletImporter.import_target(
725	                    self._source, self._entrypoint
726	                ) as entrypoint_cls:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/deployment/deployment_client.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
814	    def watch(self) -> None:
815	        with concurrent.futures.ThreadPoolExecutor() as executor:
816	            # Perform one initial patch at startup.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/framework.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	_DOCS_URL_CHAINING = (
46	    "https://docs.baseten.co/chains/concepts#depends-call-other-chainlets"
47	)
48	_DOCS_URL_LOCAL = "https://docs.baseten.co/chains/guide#local-development"
49	_DOCS_URL_STREAMING = "https://docs.baseten.co/chains/guide#streaming"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/framework.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	)
48	_DOCS_URL_LOCAL = "https://docs.baseten.co/chains/guide#local-development"
49	_DOCS_URL_STREAMING = "https://docs.baseten.co/chains/guide#streaming"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/framework.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	_DOCS_URL_LOCAL = "https://docs.baseten.co/chains/guide#local-development"
49	_DOCS_URL_STREAMING = "https://docs.baseten.co/chains/guide#streaming"
50	
51	# A "neutral dummy" endpoint descriptor if validation fails, this allows to safely
52	# continue checking for more errors.
53	_DUMMY_ENDPOINT_DESCRIPTOR = definitions.EndpointAPIDescriptor(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/framework.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
129	        if self.has_errors:
130	            sys.stderr.write(self.format_errors())
131	            sys.stderr.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/framework.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
130	            sys.stderr.write(self.format_errors())
131	            sys.stderr.write("\n")
132	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/framework.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
515	        warnings.warn(
516	            f"`{cls.endpoint_method_name}` must be an async (coroutine) function in future releases. "
517	            "Replace `def run_remote(...)` with `async def run_remote(...)`. "
518	            "Local testing and execution can be done with  "
519	            "`asyncio.run(my_chainlet.run_remote(...))`.\n"
520	            "Note on concurrency: previously sync functions were run in threads by the "
521	            "Truss server.\n"
522	            "For some frameworks this was **unsafe** (e.g. in torch the CUDA context "
523	            "is not thread-safe).\n"
524	            "Additionally, python threads hold the GIL and therefore might not give "
525	            "actual throughput gains.\n"
526	            "To achieve safe and performant concurrency, use framework-specific async "
527	            "APIs (e.g. AsyncLLMEngine for vLLM) or generic async batching like such "
528	            "as https://github.com/hussein-awala/async-batcher.",
529	            DeprecationWarning,

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/pydantic_numpy.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
75	            try:
76	                data = base64.b64decode(value[cls.data_key])
77	                array = np.frombuffer(data, dtype=value[cls.dtype_key]).reshape(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/pydantic_numpy.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
75	            try:
76	                data = base64.b64decode(value[cls.data_key])
77	                array = np.frombuffer(data, dtype=value[cls.dtype_key]).reshape(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/pydantic_numpy.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
102	            return {
103	                cls.data_key: base64.b64encode(obj.array.tobytes()).decode("utf-8"),
104	                cls.shape_key: obj.array.shape,

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/pydantic_numpy.py:103
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
102	            return {
103	                cls.data_key: base64.b64encode(obj.array.tobytes()).decode("utf-8"),
104	                cls.shape_key: obj.array.shape,

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/stub.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
121	        with self._sync_num_requests as num_requests:
122	            self._maybe_warn_for_overload(num_requests)
123	            yield client

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/stub.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
146	        async with self._async_num_requests as num_requests:
147	            self._maybe_warn_for_overload(num_requests)
148	            yield client

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
123	    token = _trace_parent_context.set(
124	        request.headers.get(definitions.OTEL_TRACE_PARENT_HEADER_KEY, "")
125	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	def get_trace_parent() -> Optional[str]:
142	    return _trace_parent_context.get()
143	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/remote_chainlet/utils.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
215	    else:
216	        if mod := sys.modules.get(error.exception_module_name):
217	            exception_cls = getattr(mod, error.exception_cls_name, None)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss-chains/truss_chains/utils.py:114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
113	def get_free_port() -> int:
114	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
115	        s.bind(("", 0))  # Bind to a free port provided by the host.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/api/__init__.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    """
20	    remote_url = "https://app.baseten.co"
21	    remote_config = RemoteConfig(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/base/constants.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	TRTLLM_MIN_MEMORY_REQUEST_GI = 16
39	HF_MODELS_API_URL = "https://huggingface.co/api/models"
40	HF_ACCESS_TOKEN_KEY = "hf_access_token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/base/trt_llm_config.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
258	                logger.warning(
259	                    f"Found extra fields {list(extra_runtime_fields.keys())} in build configuration, unspecified runtime fields will be configured using these values."
260	                    " This configuration of deprecated fields is scheduled for removal, please upgrade to the latest truss version and update configs according to https://docs.baseten.co/performance/engine-builder-config."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/cli/cli.py:1181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1180	            missing_token_text = (
1181	                "`hf_access_token` must be provided in secrets to build a gated model. "
1182	                "Please see https://docs.baseten.co/deploy/guides/private-model for configuration instructions."
1183	            )
1184	            console.print(missing_token_text, style="red")
1185	            sys.exit(1)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/cli/cli.py:1282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1281	    with open(USER_TRUSSRC_PATH, "r") as f:
1282	        original_content = f.read()
1283	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/cli/cli.py:1290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1289	        with open(USER_TRUSSRC_PATH, "w") as f:
1290	            f.write(edited_content)
1291	            click.echo(f"Changes saved to {USER_TRUSSRC_PATH}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/cli/remote_cli.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    # can do so manually in the .trussrc file.
24	    remote_url = "https://app.baseten.co"
25	    api_key = inquirer.secret(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/contexts/image_builder/cache_warmer.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	        else:
159	            base_url = "https://storage.googleapis.com"
160	            url = f"{base_url}/{bucket_name}/{blob.name}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	API_URL_MAPPING = {
15	    "https://app.baseten.co": "https://api.baseten.co",
16	    "https://app.staging.baseten.co": "https://api.staging.baseten.co",
17	    "https://app.dev.baseten.co": "https://api.mc-dev.baseten.co",
18	    # For local development, this is how we map URLs
19	    "http://localhost:8000": "http://api.localhost:8000",
20	}
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    "https://app.baseten.co": "https://api.baseten.co",
16	    "https://app.staging.baseten.co": "https://api.staging.baseten.co",
17	    "https://app.dev.baseten.co": "https://api.mc-dev.baseten.co",
18	    # For local development, this is how we map URLs
19	    "http://localhost:8000": "http://api.localhost:8000",
20	}
21	
22	# If a non-standard domain is used with the baseten remote, default to

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    "https://app.staging.baseten.co": "https://api.staging.baseten.co",
17	    "https://app.dev.baseten.co": "https://api.mc-dev.baseten.co",
18	    # For local development, this is how we map URLs
19	    "http://localhost:8000": "http://api.localhost:8000",
20	}
21	
22	# If a non-standard domain is used with the baseten remote, default to
23	# using the production api routes

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    # For local development, this is how we map URLs
19	    "http://localhost:8000": "http://api.localhost:8000",
20	}
21	
22	# If a non-standard domain is used with the baseten remote, default to
23	# using the production api routes
24	DEFAULT_API_DOMAIN = "https://api.baseten.co"
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	API_URL_MAPPING = {
15	    "https://app.baseten.co": "https://api.baseten.co",
16	    "https://app.staging.baseten.co": "https://api.staging.baseten.co",
17	    "https://app.dev.baseten.co": "https://api.mc-dev.baseten.co",
18	    # For local development, this is how we map URLs
19	    "http://localhost:8000": "http://api.localhost:8000",
20	}
21	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    "https://app.baseten.co": "https://api.baseten.co",
16	    "https://app.staging.baseten.co": "https://api.staging.baseten.co",
17	    "https://app.dev.baseten.co": "https://api.mc-dev.baseten.co",
18	    # For local development, this is how we map URLs
19	    "http://localhost:8000": "http://api.localhost:8000",
20	}
21	
22	# If a non-standard domain is used with the baseten remote, default to

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    "https://app.staging.baseten.co": "https://api.staging.baseten.co",
17	    "https://app.dev.baseten.co": "https://api.mc-dev.baseten.co",
18	    # For local development, this is how we map URLs
19	    "http://localhost:8000": "http://api.localhost:8000",
20	}
21	
22	# If a non-standard domain is used with the baseten remote, default to
23	# using the production api routes

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    # For local development, this is how we map URLs
19	    "http://localhost:8000": "http://api.localhost:8000",
20	}
21	
22	# If a non-standard domain is used with the baseten remote, default to
23	# using the production api routes
24	DEFAULT_API_DOMAIN = "https://api.baseten.co"
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	# using the production api routes
24	DEFAULT_API_DOMAIN = "https://api.baseten.co"
25	
26	
27	def _oracle_data_to_graphql_mutation(oracle: b10_types.OracleData) -> str:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	        # Ensure we strip off trailing '/' to denormalize URLs.
69	        rest_api_url = API_URL_MAPPING.get(remote_url.strip("/"), DEFAULT_API_DOMAIN)
70	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
91	
92	        resp = requests.post(
93	            self._graphql_api_url,
94	            data={"query": query_string},
95	            headers=headers,
96	            timeout=120,
97	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	        resp_dict = resp.json()
104	        errors = resp_dict.get("errors")
105	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	            message = errors[0]["message"]
108	            error_code = errors[0].get("extensions", {}).get("code")
109	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	            message = errors[0]["message"]
108	            error_code = errors[0].get("extensions", {}).get("code")
109	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
506	        headers = self._auth_token.header()
507	        resp = requests.get(
508	            f"{self._rest_api_url}/v1/models/{model_id}/deployments/{deployment_id}",
509	            headers=headers,
510	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
519	        data = {"name": name, "value": value}
520	        resp = requests.post(
521	            f"{self._rest_api_url}/v1/secrets", headers=headers, json=data
522	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/api.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
530	        headers = self._auth_token.header()
531	        resp = requests.get(f"{self._rest_api_url}/v1/secrets", headers=headers)
532	        if not resp.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/remote.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
377	
378	        published = kwargs.get("published", False)
379	        (service_url_path, model_id, model_version_id) = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/remote.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	
448	        truss_hash = dev_version.get("truss_hash", None)
449	        truss_signature = dev_version.get("truss_signature", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/remote.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
448	        truss_hash = dev_version.get("truss_hash", None)
449	        truss_signature = dev_version.get("truss_signature", None)
450	        if not (truss_hash and truss_signature):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/remote.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
524	        if not resp["succeeded"]:
525	            needs_full_deploy = resp.get("needs_full_deploy", None)
526	            if needs_full_deploy:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/remote.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
539	                PatchStatus.SUCCESS,
540	                resp.get(
541	                    "success_message", f"Model {model_name} patched successfully."
542	                ),

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/service.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
125	    def predict(self, model_request_body: Dict) -> Any:
126	        response = self._send_request(
127	            self.predict_url, "POST", data=model_request_body, stream=True
128	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/service.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	
130	        if response.headers.get("transfer-encoding") == "chunked":
131	            # Case of streaming response, the backend does not set an encoding, so

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/utils/tar.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
58	
59	    with tarfile.open(temp_file.name, "w:") as tar, progress_context:
60	        for file_path in files_to_include:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/utils/tar.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
61	            arcname = str(file_path.relative_to(source_dir))
62	            with file_path.open("rb") as file_obj:
63	                file_obj_with_progress = (

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/utils/transfer.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
15	def base64_encoded_json_str(obj):
16	    return base64.b64encode(str.encode(json.dumps(obj))).decode("utf-8")
17	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/baseten/utils/transfer.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
15	def base64_encoded_json_str(obj):
16	    return base64.b64encode(str.encode(json.dumps(obj))).decode("utf-8")
17	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/remote_factory.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	    config = ConfigParser()
25	    config.read(USER_TRUSSRC_PATH)
26	    return config

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/remote_factory.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
30	    with open(USER_TRUSSRC_PATH, "w") as configfile:
31	        config.write(configfile)
32	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/truss_remote.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
74	        if method == "GET":
75	            response = requests.request(method, url, headers=headers, stream=stream)
76	        elif method == "POST":

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/truss_remote.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
78	                raise ValueError("POST request must have data")
79	            response = requests.request(
80	                method, url, json=data, headers=headers, stream=stream
81	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/truss_remote.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
113	        liveness_url = f"{self._service_url}/"
114	        response = self._send_request(liveness_url, "GET", {})
115	        return response.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/truss_remote.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
128	        readiness_url = f"{self._service_url}/v1/models/model"
129	        response = self._send_request(readiness_url, "GET", {})
130	        return response.status_code == 200

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/remote/truss_remote.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
142	        """
143	        return self._send_request(self.predict_url, "POST", data=model_request_body)
144	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/application.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    app_state.proxy_client = httpx.AsyncClient(
56	        base_url=f"http://localhost:{app_state.inference_server_port}", limits=limits
57	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/endpoints.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
17	
18	@control_app.get("/")
19	def index():

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/endpoints.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
40	
41	    inf_serv_req = client.build_request(
42	        request.method,
43	        url,
44	        headers=request.headers.raw,
45	        content=request_body,
46	        timeout=timeout,
47	    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/endpoints.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
40	
41	    inf_serv_req = client.build_request(
42	        request.method,
43	        url,
44	        headers=request.headers.raw,
45	        content=request_body,
46	        timeout=timeout,
47	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/endpoints.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
98	
99	@control_app.post("/control/patch")
100	async def patch(request: Request) -> Dict[str, str]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/endpoints.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
113	
114	@control_app.get("/control/truss_hash")
115	async def truss_hash(request: Request) -> Dict[str, Any]:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/endpoints.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
119	
120	@control_app.post("/control/restart_inference_server")
121	async def restart_inference_server(request: Request) -> Dict[str, str]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/endpoints.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
126	
127	@control_app.get("/control/has_partially_applied_patch")
128	async def has_partially_applied_patch(request: Request) -> Dict[str, Any]:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/endpoints.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
134	
135	@control_app.post("/control/stop_inference_server")
136	async def stop_inference_server(request: Request) -> Dict[str, str]:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/helpers/inference_server_controller.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
49	        if oversee_inference_server:
50	            self._inference_server_overseer_thread = threading.Thread(
51	                target=self._check_and_recover_inference_server
52	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/helpers/inference_server_starter.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	    """
32	    patch_ping_url = os.environ.get("PATCH_PING_URL_TRUSS")
33	    if patch_ping_url is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/helpers/inference_server_starter.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
47	                )
48	                resp = requests.post(patch_ping_url, json=payload)
49	                resp.raise_for_status()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/helpers/truss_patch/model_code_patch_applier.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
28	                )
29	            file.write(content)
30	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/control/control/server.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
39	                ],
40	                "control_server_host": "0.0.0.0",
41	                "control_server_port": self._control_server_port,
42	                "inference_server_port": self._inference_server_port,
43	            }
44	        )
45	
46	        application.state.logger.info(
47	            f"Starting live reload server on port {self._control_server_port}"
48	        )
49	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/common/patches/whisper/patch.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	        with open(download_target, "rb") as f:
31	            model_bytes = f.read()
32	        if hashlib.sha256(model_bytes).hexdigest() == expected_sha256:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/common/patches/whisper/patch.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
38	
39	    with urllib.request.urlopen(url) as source, open(download_target, "wb") as output:
40	        with tqdm(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/common/patches/whisper/patch.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
49	            while True:
50	                buffer = source.read(8192)
51	                if not buffer:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/common/patches/whisper/patch.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	
54	                output.write(buffer)
55	                loop.update(len(buffer))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/common/patches/whisper/patch.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
56	
57	    model_bytes = open(download_target, "rb").read()
58	    if hashlib.sha256(model_bytes).hexdigest() != expected_sha256:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/common/tracing.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	            # Get rid of newlines and whitespace.
41	            self._file.write(json.dumps(json.loads(span.to_json())))
42	            self._file.write("\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/common/tracing.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	            self._file.write(json.dumps(json.loads(span.to_json())))
42	            self._file.write("\n")
43	        self._file.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/common/tracing.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	        honeycomb_exporter = oltp_exporter.OTLPSpanExporter(
90	            endpoint="https://api.honeycomb.io/v1/traces",
91	            headers={

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
41	
42	NUM_LOAD_RETRIES = int(os.environ.get("NUM_LOAD_RETRIES_TRUSS", "1"))
43	STREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS = 60

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
346	        self._predict_semaphore = Semaphore(
347	            self._config.get("runtime", {}).get(
348	                "predict_concurrency", DEFAULT_PREDICT_CONCURRENCY
349	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
346	        self._predict_semaphore = Semaphore(
347	            self._config.get("runtime", {}).get(
348	                "predict_concurrency", DEFAULT_PREDICT_CONCURRENCY

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
382	        if self._status == ModelWrapper.Status.NOT_READY:
383	            thread = Thread(target=self.load)
384	            thread.start()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
417	        apply_patches(
418	            self._config.get("apply_library_patches", True),
419	            self._config["requirements"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
452	                    raise ImportError(
453	                        f"During import of `{model_class_file_path}`. "
454	                        f"Since Truss v0.9.36 relative imports (starting with '.') in "

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
647	        # before a timeout is triggered.
648	        streaming_read_timeout = self._config.get("runtime", {}).get(
649	            "streaming_read_timeout", STREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS
650	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
647	        # before a timeout is triggered.
648	        streaming_read_timeout = self._config.get("runtime", {}).get(
649	            "streaming_read_timeout", STREAMING_RESPONSE_QUEUE_READ_TIMEOUT_SECS

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:679
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
678	                    chunk = await asyncio.wait_for(
679	                        response_queue.get(), timeout=streaming_read_timeout
680	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
728	        # we can differentiate by looking at the user agent (e.g. OpenAI/Python 1.61.0)
729	        user_agent = request.headers.get("user-agent", "")
730	        if "openai" in user_agent.lower():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/model_wrapper.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
732	        # TODO(nikhil): determine if we can safely deprecate this behavior.
733	        return request.headers.get("accept") == "application/json"
734	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
205	
206	        return await self._execute_request(
207	            model=model,
208	            method=model.chat_completions,
209	            method_name=MethodName.CHAT_COMPLETIONS,
210	            request=request,
211	            body_raw=body_raw,
212	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
205	
206	        return await self._execute_request(
207	            model=model,
208	            method=model.chat_completions,
209	            method_name=MethodName.CHAT_COMPLETIONS,
210	            request=request,
211	            body_raw=body_raw,
212	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
227	
228	        return await self._execute_request(
229	            model=model,
230	            method=model.completions,
231	            method_name=MethodName.COMPLETIONS,
232	            request=request,
233	            body_raw=body_raw,
234	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
227	
228	        return await self._execute_request(
229	            model=model,
230	            method=model.completions,
231	            method_name=MethodName.COMPLETIONS,
232	            request=request,
233	            body_raw=body_raw,
234	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
240	
241	        return await self._execute_request(
242	            model=model,
243	            method=model,  # We overwrote __call__ on ModelWrapper
244	            method_name=MethodName.PREDICT,
245	            request=request,
246	            body_raw=body_raw,
247	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
240	
241	        return await self._execute_request(
242	            model=model,
243	            method=model,  # We overwrote __call__ on ModelWrapper
244	            method_name=MethodName.PREDICT,
245	            request=request,
246	            body_raw=body_raw,
247	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
323	            with open(config_or_path, encoding="utf-8") as config_file:
324	                config = yaml.safe_load(config_file)
325	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
345	        self.cleanup()
346	        self._model.start_load_thread()
347	        asyncio.create_task(self._shutdown_if_load_fails())

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
428	            "DEBUG"
429	            if self._config["runtime"].get("enable_debug_logs", False)
430	            else "INFO"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/server/truss_server.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
437	            http="h11",
438	            host="0.0.0.0",
439	            port=self._http_port,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/shared/lazy_data_resolver.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	        self._uses_b10_cache = (
64	            os.environ.get(BASETEN_FS_ENABLED_ENV_VAR, "False") == "True"
65	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/shared/lazy_data_resolver.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
83	        # Streaming download to keep memory usage low
84	        resp = requests.get(
85	            URL, allow_redirects=True, stream=True, timeout=BLOB_DOWNLOAD_TIMEOUT_SECS
86	        )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/shared/lazy_data_resolver.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
123	
124	        with ThreadPoolExecutor(NUM_WORKERS) as executor:
125	            futures = {}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/shared/secrets_resolver.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	
6	SECRETS_DOC_LINK = "https://truss.baseten.co/guides/secrets"
7	
8	
9	class SecretNotFound(Exception):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/shared/secrets_resolver.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	            with secret_path.open() as secret_file:
30	                secret_value = secret_file.read()
31	        return secret_value

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/shared/util.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
35	    try:
36	        affinity_count = len(psutil.Process().cpu_affinity())
37	        if affinity_count > 0:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/shared/util.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
45	            with open("/sys/fs/cgroup/cpu,cpuacct/cpu.cfs_quota_us") as f:
46	                quota = int(f.read())
47	            with open("/sys/fs/cgroup/cpu,cpuacct/cpu.cfs_period_us") as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/shared/util.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	            with open("/sys/fs/cgroup/cpu,cpuacct/cpu.cfs_period_us") as f:
48	                period = int(f.read())
49	            cgroups_count = int(quota / period)

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/shared/util.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
66	    try:
67	        parent = psutil.Process(parent_pid)
68	    except psutil.NoSuchProcess:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/model/model.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	    def preprocess(self, request: dict):
23	        audio_base64 = request.get("audio")
24	        audio_url = request.get("url")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/model/model.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	        audio_base64 = request.get("audio")
24	        audio_url = request.get("url")
25	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/model/model.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
37	        if audio_base64:
38	            binary_data = base64.b64decode(audio_base64.encode("utf-8"))
39	        elif audio_url:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/model/model.py:38
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
37	        if audio_base64:
38	            binary_data = base64.b64decode(audio_base64.encode("utf-8"))
39	        elif audio_url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/model/model.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        elif audio_url:
40	            resp = requests.get(audio_url)
41	            binary_data = resp.content

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/assets.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
14	        if not os.path.exists(file_path):
15	            urllib.request.urlretrieve(url, file_path)
16	    return ASSETS_DIR

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/assets.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        [
22	            "https://raw.githubusercontent.com/openai/whisper/main/whisper/assets/multilingual.tiktoken",
23	            "https://raw.githubusercontent.com/openai/whisper/main/whisper/assets/mel_filters.npz",
24	        ]
25	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/assets.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	            "https://raw.githubusercontent.com/openai/whisper/main/whisper/assets/multilingual.tiktoken",
23	            "https://raw.githubusercontent.com/openai/whisper/main/whisper/assets/mel_filters.npz",
24	        ]
25	    )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/tokenizer.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
137	    ranks = {
138	        base64.b64decode(token): int(rank)
139	        for token, rank in (line.split() for line in open(vocab_path) if line)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/tokenizer.py:138
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
137	    ranks = {
138	        base64.b64decode(token): int(rank)
139	        for token, rank in (line.split() for line in open(vocab_path) if line)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/templates/trtllm-audio/packages/whisper_trt/utils.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
75	    assert wav_path.endswith(".wav"), f"Only support .wav format, but got {wav_path}"
76	    waveform, sample_rate = soundfile.read(wav_path)
77	    assert sample_rate == 16000, f"Only support 16k sample rate, but got {sample_rate}"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/conftest.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
272	    try:
273	        url = f"http://localhost:{port}/{filename}"
274	        # Add arbitrary get params to get that they don't cause issues, the

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/conftest.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	    try:
303	        url = f"http://localhost:{port}/{filename}"
304	        # Add arbitrary get params to get that they don't cause issues, the

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/conftest.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
492	    with (packages_path / "test.py").open("w") as file:
493	        file.write("""X = 1""")
494	    yield truss_dir_path

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/conftest.py:509
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
508	                        {
509	                            "image_url": "https://github.com/pytorch/hub/raw/master/images/dog.jpg"
510	                        }
511	                    ]

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/conftest.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
584	            "--host",
585	            "0.0.0.0",
586	        ],
587	        cwd=str(test_data_path / "patch_ping_test_server"),
588	    )
589	    base_url = f"http://127.0.0.1:{port}"
590	    retry_secs = 10
591	    sleep_between_retries = 1
592	    for _ in range(int(retry_secs / sleep_between_retries)):
593	        time.sleep(sleep_between_retries)
594	        try:
595	            resp = requests.get(f"{base_url}/health")
596	        except requests.exceptions.ConnectionError:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/conftest.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
588	    )
589	    base_url = f"http://127.0.0.1:{port}"
590	    retry_secs = 10

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/conftest.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
594	        try:
595	            resp = requests.get(f"{base_url}/health")
596	        except requests.exceptions.ConnectionError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/contexts/image_builder/test_serving_image_builder.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
62	        with open(tmp_path / "requirements.txt", "r") as f:
63	            requirements_content = f.read()
64	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/contexts/image_builder/test_serving_image_builder.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	        with open(f"{BASE_DIR}/../../../templates/server/requirements.txt", "r") as f:
66	            base_requirements_content = f.read()
67	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/contexts/image_builder/test_serving_image_builder.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
268	        with open(tmp_path / "Dockerfile", "r") as f:
269	            gen_docker_file = f.read()
270	            assert secret_mount in gen_docker_file

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/contexts/local_loader/test_truss_module_finder.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
153	    with (model_dir_path / "model.py").open("w") as f:
154	        f.write(model_file_content)
155	    if util_file_content is not None:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/contexts/local_loader/test_truss_module_finder.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
156	        with (model_dir_path / "util.py").open("w") as f:
157	            f.write(util_file_content)
158	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/contexts/local_loader/test_truss_module_finder.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
162	        with (submodule_path / "subfile.py").open("w") as f:
163	            f.write(submodule_file_content)
164	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/contexts/local_loader/test_truss_module_finder.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
170	        with (test_module_path / "test.py").open("w") as f:
171	            f.write(additional_module_file_content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
46	    with (custom_model_truss_dir / "model" / "dummy").open("w") as file:
47	        file.write("content")
48	    patches = calc_truss_patch(custom_model_truss_dir, prev_sign)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	    with (custom_model_truss_dir / "model" / "model.py").open("w") as model_file:
93	        model_file.write(new_model_file_content)
94	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
223	    ).open("w") as package_file:
224	        package_file.write(new_package_file_content)
225	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
249	        with (custom_model_truss_dir / filename).open("w") as req_file:
250	            req_file.write(requirements_contents)
251	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
254	        with (custom_model_truss_dir / filename).open("w") as req_file:
255	            req_file.write(requirements_contents)
256	        config.requirements_file = filename

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
279	        with (custom_model_truss_dir / filename).open("w") as req_file:
280	            req_file.write(requirements_contents)
281	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
285	        with (custom_model_truss_dir / filename).open("w") as req_file:
286	            req_file.write(requirements_contents)
287	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
311	        with (custom_model_truss_dir / filename).open("w") as req_file:
312	            req_file.write(requirements_contents)
313	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
317	        with (custom_model_truss_dir / filename).open("w") as req_file:
318	            req_file.write(requirements_contents)
319	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
350	        with (custom_model_truss_dir / filename).open("w") as req_file:
351	            req_file.write(requirements_contents)
352	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
356	        with (custom_model_truss_dir / filename).open("w") as req_file:
357	            req_file.write(requirements_contents)
358	        config.requirements_file = filename

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
396	        with (custom_model_truss_dir / filename).open("w") as req_file:
397	            req_file.write(requirements_contents)
398	        config.requirements_file = filename

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
449	        with (custom_model_truss_dir / filename).open("w") as req_file:
450	            req_file.write(requirements_contents)
451	        config.requirements_file = filename

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
476	        with (custom_model_truss_dir / filename).open("w") as req_file:
477	            req_file.write(requirements_contents)
478	        config.requirements_file = filename

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
554	        config.requirements[0] = (
555	            "git+https://github.com/huggingface/transformers.git#egg=transformers"
556	        )
557	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
560	        config_pre_op=lambda config: config.requirements.append(
561	            "git+https://github.com/huggingface/transformers.git"
562	        ),
563	        config_op=update_requests_version,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
577	                action=Action.UPDATE,
578	                requirement="git+https://github.com/huggingface/transformers.git#egg=transformers",
579	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
588	        config.requirements[0] = (
589	            "git+https://github.com/huggingface/transformers.git@111111"
590	        )
591	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
594	        config_pre_op=lambda config: config.requirements.append(
595	            "git+https://github.com/huggingface/transformers.git@000000"
596	        ),
597	        config_op=update_requests_version,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
611	                action=Action.UPDATE,
612	                requirement="git+https://github.com/huggingface/transformers.git@111111",
613	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
623	            "requests==1.0.0",
624	            "git+https://github.com/huggingface/transformers.git@111111",
625	        ]
626	
627	    def config_op(config: TrussConfig):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:653
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
652	            "jinja==4.0.0",
653	            "git+https://github.com/huggingface/transformers.git@111111#egg=transformers",
654	        ]
655	
656	    def config_op(config: TrussConfig):
657	        config.requirements = ["requests==2.0.0", "numpy>=1.8"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:677
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
676	                action=Action.REMOVE,
677	                requirement="git+https://github.com/huggingface/transformers.git@111111#egg=transformers",
678	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_calc_patch.py:948
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
947	            "ignores url-based requirement without egg tag",
948	            ["git+https://github.com/huggingface/transformers.git@000000"],
949	            [],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/patch/test_truss_dir_patch_applier.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	def test_python_requirement_patch(custom_model_truss_dir: Path):
54	    req = "git+https://github.com/huggingface/transformers.git"
55	    applier = TrussDirPatchApplier(custom_model_truss_dir, TEST_LOGGER)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_api.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	def baseten_api(mock_auth_service):
86	    return BasetenApi("https://app.test.com", mock_auth_service)
87	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	_TEST_REMOTE_URL = "http://test_remote.com"
18	_TEST_REMOTE_GRAPHQL_PATH = "http://test_remote.com/graphql/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	_TEST_REMOTE_URL = "http://test_remote.com"
18	_TEST_REMOTE_GRAPHQL_PATH = "http://test_remote.com/graphql/"
19	
20	
21	def assert_request_matches_expected_query(request, expected_query) -> None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
40	    with requests_mock.Mocker() as m:
41	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_version_response)
42	        service = remote.get_service(model_identifier=ModelVersionId("version_id"))

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
51	    with requests_mock.Mocker() as m:
52	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_version_response)
53	        with pytest.raises(RemoteError):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
71	    with requests_mock.Mocker() as m:
72	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)
73	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
99	    with requests_mock.Mocker() as m:
100	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)
101	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
127	    with requests_mock.Mocker() as m:
128	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)
129	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
156	    with requests_mock.Mocker() as m:
157	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)
158	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
167	    with requests_mock.Mocker() as m:
168	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)
169	        with pytest.raises(RemoteError):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
186	    with requests_mock.Mocker() as m:
187	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)
188	        th = TrussHandle(custom_model_truss_dir_with_pre_and_post)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
218	    with requests_mock.Mocker() as m:
219	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)
220	        th = TrussHandle(custom_model_truss_dir_with_pre_and_post)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
250	    with requests_mock.Mocker() as m:
251	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)
252	        th = TrussHandle(custom_model_truss_dir_with_pre_and_post)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
271	    with requests_mock.Mocker() as m:
272	        m.post(
273	            _TEST_REMOTE_GRAPHQL_PATH,
274	            [
275	                {"json": {"data": {"chains": []}}},
276	                {
277	                    "json": {
278	                        "data": {
279	                            "deploy_chain_atomic": {
280	                                "chain_id": "new-chain-id",
281	                                "chain_deployment_id": "new-chain-deployment-id",
282	                                "entrypoint_model_id": "new-entrypoint-model-id",
283	                                "entrypoint_model_version_id": "new-entrypoint-model-version-id",
284	                            }

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
367	    with requests_mock.Mocker() as m:
368	        m.post(
369	            _TEST_REMOTE_GRAPHQL_PATH,
370	            [
371	                {"json": {"data": {"chains": []}}},
372	                {
373	                    "json": {
374	                        "data": {
375	                            "deploy_chain_atomic": {
376	                                "chain_id": "new-chain-id",
377	                                "chain_deployment_id": "new-chain-deployment-id",
378	                                "entrypoint_model_id": "new-entrypoint-model-id",
379	                                "entrypoint_model_version_id": "new-entrypoint-model-version-id",
380	                            }

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
461	    with requests_mock.Mocker() as m:
462	        m.post(
463	            _TEST_REMOTE_GRAPHQL_PATH,
464	            [
465	                {
466	                    "json": {
467	                        "data": {
468	                            "chains": [{"id": "old-chain-id", "name": "old_chain"}]
469	                        }
470	                    }
471	                },
472	                {
473	                    "json": {
474	                        "data": {
475	                            "deploy_chain_atomic": {
476	                                "chain_id": "new-chain-id",
477	                                "chain_deployment_id": "new-chain-deployment-id",
478	                                "entrypoint_model_id": "new-entrypoint-model-id",
479	                                "entrypoint_model_version_id": "new-entrypoint-model-version-id",
480	                            }

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:565
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
564	    with requests_mock.Mocker() as m:
565	        m.post(
566	            _TEST_REMOTE_GRAPHQL_PATH,
567	            [
568	                {
569	                    "json": {
570	                        "data": {
571	                            "chains": [{"id": "old-chain-id", "name": "old_chain"}]
572	                        }
573	                    }
574	                },
575	                {
576	                    "json": {
577	                        "data": {
578	                            "deploy_chain_atomic": {
579	                                "chain_id": "new-chain-id",
580	                                "chain_deployment_id": "new-chain-deployment-id",
581	                                "entrypoint_model_id": "new-entrypoint-model-id",
582	                                "entrypoint_model_version_id": "new-entrypoint-model-version-id",
583	                            }

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_remote.py:676
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
675	    with requests_mock.Mocker() as m:
676	        m.post(_TEST_REMOTE_GRAPHQL_PATH, json=model_response)
677	        th = TrussHandle(custom_model_truss_dir_with_pre_and_post)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	    url = service.URLConfig.invocation_url(
6	        "https://api.baseten.co", service.URLConfig.MODEL, "123", "789", is_draft=False
7	    )
8	    assert url == "https://model-123.api.baseten.co/deployment/789/predict"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	    )
8	    assert url == "https://model-123.api.baseten.co/deployment/789/predict"
9	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	    url = service.URLConfig.invocation_url(
13	        "https://api.baseten.co", service.URLConfig.MODEL, "123", "789", is_draft=True
14	    )
15	    assert url == "https://model-123.api.baseten.co/development/predict"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    )
15	    assert url == "https://model-123.api.baseten.co/development/predict"
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    url = service.URLConfig.invocation_url(
20	        "https://api.baseten.co", service.URLConfig.CHAIN, "abc", "666", is_draft=False
21	    )
22	    assert url == "https://chain-abc.api.baseten.co/deployment/666/run_remote"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    )
22	    assert url == "https://chain-abc.api.baseten.co/deployment/666/run_remote"
23	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	    url = service.URLConfig.invocation_url(
27	        "https://api.baseten.co", service.URLConfig.CHAIN, "abc", "666", is_draft=True
28	    )
29	    assert url == "https://chain-abc.api.baseten.co/development/run_remote"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	    )
29	    assert url == "https://chain-abc.api.baseten.co/development/run_remote"
30	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	    url = service.URLConfig.status_page_url(
34	        "https://app.baseten.co", service.URLConfig.MODEL, "123"
35	    )
36	    assert url == "https://app.baseten.co/models/123/overview"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	    )
36	    assert url == "https://app.baseten.co/models/123/overview"
37	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    url = service.URLConfig.status_page_url(
41	        "https://app.baseten.co", service.URLConfig.CHAIN, "abc"
42	    )
43	    assert url == "https://app.baseten.co/chains/abc/overview"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	    )
43	    assert url == "https://app.baseten.co/chains/abc/overview"
44	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	def test_model_logs_url():
47	    url = service.URLConfig.model_logs_url("https://app.baseten.co", "123", "789")
48	    assert url == "https://app.baseten.co/models/123/logs/789"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	    url = service.URLConfig.model_logs_url("https://app.baseten.co", "123", "789")
48	    assert url == "https://app.baseten.co/models/123/logs/789"
49	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    url = service.URLConfig.chainlet_logs_url(
53	        "https://app.baseten.co", "abc", "666", "543"
54	    )
55	    assert url == "https://app.baseten.co/chains/abc/logs/666/543"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/baseten/test_service.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    )
55	    assert url == "https://app.baseten.co/chains/abc/logs/666/543"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/test_remote_factory.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	
7	SAMPLE_CONFIG = {"api_key": "test_key", "remote_url": "http://test.com"}
8	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/test_remote_factory.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	SAMPLE_TRUSSRC = """
10	[test]
11	remote_provider=test_remote
12	api_key=test_key
13	remote_url=http://test.com
14	"""
15	
16	SAMPLE_TRUSSRC_NO_REMOTE = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/test_remote_factory.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	
16	SAMPLE_TRUSSRC_NO_REMOTE = """
17	[test]
18	api_key=test_key
19	remote_url=http://test.com
20	"""
21	
22	SAMPLE_TRUSSRC_NO_PARAMS = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/test_truss_remote.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	
8	TEST_SERVICE_URL = "http://test.com"
9	
10	
11	class TrussTestService(TrussService):

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/test_truss_remote.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
18	    def is_live(self) -> bool:
19	        response = self._send_request(self._service_url, "GET")
20	        if response.status_code == 200:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/test_truss_remote.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
24	    def is_ready(self) -> bool:
25	        response = self._send_request(self._service_url, "GET")
26	        if response.status_code == 200:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/remote/test_truss_remote.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
90	    with pytest.raises(ValueError):
91	        service._send_request(TEST_SERVICE_URL, "POST")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/helpers/test_model_container_patch_applier.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
177	            item={
178	                "url": "https://raw.githubusercontent.com/basetenlabs/truss/main/docs/favicon.svg",
179	                "local_data_path": "truss_icon",
180	            },
181	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/helpers/test_requirement_name_identifier.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	        (
14	            "git+https://github.com/huggingface/transformers.git#egg=transformers",
15	            "git+github.com/huggingface/transformers.git",
16	        ),
17	        (
18	            "git+https://github.com/huggingface/transformers.git",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/helpers/test_requirement_name_identifier.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        (
18	            "git+https://github.com/huggingface/transformers.git",
19	            "git+github.com/huggingface/transformers.git",
20	        ),
21	        (
22	            "git+https://github.com/huggingface/transformers.git@main#egg=transformers",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/helpers/test_requirement_name_identifier.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        (
22	            "git+https://github.com/huggingface/transformers.git@main#egg=transformers",
23	            "git+github.com/huggingface/transformers.git",
24	        ),
25	        (
26	            " git+https://github.com/huggingface/transformers.git ",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/helpers/test_requirement_name_identifier.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        (
26	            " git+https://github.com/huggingface/transformers.git ",
27	            "git+github.com/huggingface/transformers.git",
28	        ),
29	        ("pytorch==1.0", "pytorch"),
30	        ("pytorch>=1.0", "pytorch"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/helpers/test_requirement_name_identifier.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	            "handles url-based requirement with egg tag",
68	            "git+https://github.com/huggingface/transformers.git@main#egg=transformers",
69	            RequirementMeta(
70	                requirement="git+https://github.com/huggingface/transformers.git@main#egg=transformers",
71	                name="git+github.com/huggingface/transformers.git",
72	                is_url_based_requirement=True,
73	                egg_tag=["transformers"],
74	            ),
75	        ),
76	        (
77	            "handles url-based requirement without egg tag",
78	            "git+https://github.com/huggingface/transformers.git",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/helpers/test_requirement_name_identifier.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	            RequirementMeta(
70	                requirement="git+https://github.com/huggingface/transformers.git@main#egg=transformers",
71	                name="git+github.com/huggingface/transformers.git",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/helpers/test_requirement_name_identifier.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	            "handles url-based requirement without egg tag",
78	            "git+https://github.com/huggingface/transformers.git",
79	            RequirementMeta(
80	                requirement="git+https://github.com/huggingface/transformers.git",
81	                name="git+github.com/huggingface/transformers.git",
82	                is_url_based_requirement=True,
83	                egg_tag=None,
84	            ),
85	        ),
86	    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/helpers/test_requirement_name_identifier.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	            RequirementMeta(
80	                requirement="git+https://github.com/huggingface/transformers.git",
81	                name="git+github.com/huggingface/transformers.git",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	    async with httpx.AsyncClient(
80	        transport=transport, base_url="http://localhost:8080"
81	    ) as async_client:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
113	    with (app.state.inference_server_home / "model" / "model.py").open() as model_file:
114	        new_model_file_content = model_file.read()
115	    assert new_model_file_content == mock_model_file_content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	
57	    ctrl_url = f"http://localhost:{control_server.control_server_port}"
58	    _patch(identity_model_code, control_server)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
64	        time.sleep(random.uniform(0, 0.5))
65	        resp = requests.post(f"{ctrl_url}/v1/models/model:predict", json=inp)
66	        return resp.json()

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
67	
68	    with ThreadPool(10) as p:
69	        inputs = list(range(0, num_requests))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	
86	    ctrl_url = f"http://localhost:{control_server.control_server_port}"
87	    _patch(stream_model_code, control_server)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
88	
89	    resp = requests.post(f"{ctrl_url}/v1/models/model:predict", json={}, stream=True)
90	    assert resp.headers.get("transfer-encoding") == "chunked"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	    resp = requests.post(f"{ctrl_url}/v1/models/model:predict", json={}, stream=True)
90	    assert resp.headers.get("transfer-encoding") == "chunked"
91	    assert resp.content == "01234".encode("utf-8")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	def test_truss_control_server_health_check(control_server: ControlServerDetails):
96	    ctrl_url = f"http://localhost:{control_server.control_server_port}"
97	    resp = requests.get(f"{ctrl_url}/v1/models/model")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
96	    ctrl_url = f"http://localhost:{control_server.control_server_port}"
97	    resp = requests.get(f"{ctrl_url}/v1/models/model")
98	    assert resp.status_code == 200

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:144
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
143	        # Try to bind to the given port
144	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
145	            s.bind(("localhost", port))

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
153	    try:
154	        proc = psutil.Process(pid)
155	        for child_proc in proc.children(recursive=True):

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
163	    try:
164	        proc = psutil.Process(pid)
165	    except psutil.NoSuchProcess:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
188	            os.environ["PATCH_PING_URL_TRUSS"] = (
189	                f"http://localhost:{patch_ping_server_port}"
190	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
217	                self.end_headers()
218	                self.wfile.write(
219	                    bytes(json.dumps({"is_current": True}), encoding="utf-8")
220	                )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
217	                self.end_headers()
218	                self.wfile.write(
219	                    bytes(json.dumps({"is_current": True}), encoding="utf-8")
220	                )

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
221	
222	        httpd = HTTPServer(("localhost", patch_ping_server_port), Handler)
223	        httpd.serve_forever()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
225	    stdout_capture_file = tempfile.NamedTemporaryFile()
226	    subproc = Process(target=start_truss_server, args=(stdout_capture_file.name,))
227	    subproc.start()

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
229	    if with_patch_ping_flow:
230	        patch_ping_server_proc = Process(target=start_patch_ping_server)
231	        patch_ping_server_proc.start()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
248	def _patch(model_code: str, control_server: ControlServerDetails):
249	    ctrl_url = f"http://localhost:{control_server.control_server_port}"
250	    resp = requests.get(f"{ctrl_url}/control/truss_hash")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	    ctrl_url = f"http://localhost:{control_server.control_server_port}"
250	    resp = requests.get(f"{ctrl_url}/control/truss_hash")
251	    truss_hash = resp.json()["result"]

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/control/control/test_server_integration.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
252	
253	    resp = requests.post(
254	        f"{ctrl_url}/control/patch",
255	        json={
256	            "hash": "dummy",
257	            "prev_hash": truss_hash,
258	            "patches": [
259	                {
260	                    "type": "model_code",
261	                    "body": {
262	                        "action": "UPDATE",
263	                        "path": "model.py",
264	                        "content": model_code,
265	                    },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_dynamic_config_resolver.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	            "RandInt": {
15	                "predict_url": "https://model-id.api.baseten.co/deployment/deployment-id/predict"
16	            }
17	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_dynamic_config_resolver.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	            "RandInt": {
62	                "predict_url": "https://model-id.api.baseten.co/deployment/deployment-id/predict"
63	            }
64	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    ):
23	        return f"""
24	pointers:
25	- uid: foo
26	  file_name: foo-name
27	  hashtype: hash-type
28	  hash: foo-hash
29	  size: 100
30	  resolution:
31	    url: https://foo-rl
32	    expiration_timestamp: {foo_expiry_timestamp}
33	- uid: bar
34	  file_name: bar-name
35	  hashtype: hash-type
36	  hash: bar-hash
37	  size: 1000
38	  resolution:
39	    url: https://bar-rl
40	    expiration_timestamp: {bar_expiry_timestamp}
41	"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    ):
23	        return f"""
24	pointers:
25	- uid: foo
26	  file_name: foo-name
27	  hashtype: hash-type
28	  hash: foo-hash
29	  size: 100
30	  resolution:
31	    url: https://foo-rl
32	    expiration_timestamp: {foo_expiry_timestamp}
33	- uid: bar
34	  file_name: bar-name
35	  hashtype: hash-type
36	  hash: bar-hash
37	  size: 1000
38	  resolution:
39	    url: https://bar-rl
40	    expiration_timestamp: {bar_expiry_timestamp}
41	"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	            assert ldr._bptr_resolution == {
92	                "foo-name": ("https://foo-rl", "foo-hash", 100),
93	                "bar-name": ("https://bar-rl", "bar-hash", 1000),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	                "foo-name": ("https://foo-rl", "foo-hash", 100),
93	                "bar-name": ("https://bar-rl", "bar-hash", 1000),
94	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py:129
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
128	                resp = {"file_name": file_name, "url": url}
129	                m.get(url, json=resp)
130	            ldr.fetch()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
174	            for _, (url, _, _) in ldr._bptr_resolution.items():
175	                m.get(url, status_code=500)
176	            with pytest.raises(RuntimeError):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	                resp = {"file_name": file_name, "url": url}
219	                m.get(url, json=resp)
220	            ldr.fetch()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	                resp = {"file_name": file_name, "url": url}
272	                m.get(url, json=resp)
273	            ldr.fetch()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	                (CACHE_DIR / hash).write_text(json.dumps(resp))
321	                m.get(url, json=resp)
322	            ldr.fetch()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_lazy_data_resolver_v2.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	                "resolution": {
21	                    "url": "https://raw.githubusercontent.com/basetenlabs/truss/00e01b679afbe353b0b2fe4de6b138d912bb7167/.circleci/config.yml",
22	                    "expiration_timestamp": expiration_timestamp,
23	                },
24	                "uid": "8c6b2f215f0333437cdc3fe7c79be0c802847d2f2a0ccdc0bb251814e63cf375",
25	                "file_name": TARGET_FILE.as_posix(),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/core/server/test_secrets_resolver.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	    with (tmp_path / "secret_key").open("w") as f:
24	        f.write("secret_value_from_mounted_secrets")
25	    with _secrets_mount_dir(tmp_path), _override_env_var(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/server/test_model_wrapper.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	    model_wrapper.load()
94	    assert model_wrapper._config.get("runtime").get("streaming_read_timeout") == 5
95	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/server/test_model_wrapper.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
93	    model_wrapper.load()
94	    assert model_wrapper._config.get("runtime").get("streaming_read_timeout") == 5
95	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/server/test_truss_server.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
28	    stdout_capture_file = tempfile.NamedTemporaryFile()
29	    subproc = Process(target=start_truss_server, args=(stdout_capture_file.name,))
30	    subproc.start()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/templates/server/test_truss_server.py:47
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
46	        # Try to bind to the given port
47	        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
48	            s.bind(("localhost", port))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_control_truss_patching.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
394	        update_model_code(truss_dir, new_model_code)
395	        url = f"http://host.docker.internal:9089/{filename}"
396	        th.add_external_data_item(url, filename)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_control_truss_patching.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
407	                ExternalDataItem(
408	                    url=f"http://host.docker.internal:9089/{new_filename}",
409	                    local_data_path=filename,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_custom_server.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	            raise Exception(f"Failed to start container: {e}")
29	        truss_server_addr = "http://localhost:8090"
30	        full_url = f"{truss_server_addr}/v1/models/model:predict"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_custom_server.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
31	
32	        response = requests.post(full_url, json={})
33	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_docker.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    resp = get_urls_from_container(docker_container)
20	    assert resp == {19051: ["http://0.0.0.0:19051", "http://:::19051"]}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_docker.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    resp = get_urls_from_container(docker_container)
20	    assert resp == {19051: ["http://0.0.0.0:19051", "http://:::19051"]}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	DEFAULT_LOG_ERROR = "Internal Server Error"
35	PREDICT_URL = "http://localhost:8090/v1/models/model:predict"
36	COMPLETIONS_URL = "http://localhost:8090/v1/completions"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	PREDICT_URL = "http://localhost:8090/v1/models/model:predict"
36	COMPLETIONS_URL = "http://localhost:8090/v1/completions"
37	CHAT_COMPLETIONS_URL = "http://localhost:8090/v1/chat/completions"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	COMPLETIONS_URL = "http://localhost:8090/v1/completions"
37	CHAT_COMPLETIONS_URL = "http://localhost:8090/v1/chat/completions"
38	
39	
40	@pytest.fixture
41	def anyio_backend():

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
81	        try:
82	            self.ret = self._target(*self._args, **self._kwargs)
83	        except BaseException as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
173	
174	        truss_server_addr = "http://localhost:8090"
175	
176	        def handle_request_exception(func):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
186	        def _test_liveness_probe(expected_code):
187	            live = requests.get(f"{truss_server_addr}/")
188	            assert live.status_code == expected_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
192	        def _test_readiness_probe(expected_code):
193	            ready = requests.get(f"{truss_server_addr}/v1/models/model")
194	            assert ready.status_code == expected_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
198	        def _test_is_loaded(expected_code):
199	            ready = requests.get(f"{truss_server_addr}/v1/models/model/loaded")
200	            assert ready.status_code == expected_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	        def _test_ping(expected_code):
205	            ping = requests.get(f"{truss_server_addr}/ping")
206	            assert ping.status_code == expected_code

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
210	        def _test_invocations(expected_code):
211	            invocations = requests.post(
212	                f"{truss_server_addr}/v1/models/model:predict", json={}
213	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
238	        def make_request():
239	            requests.post(PREDICT_URL, json={}, timeout=3)
240	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
265	        # The prediction imports torch which is specified in a requirements.txt and returns if GPU is available.
266	        response = requests.post(PREDICT_URL, json={})
267	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
278	
279	        response = requests.post(PREDICT_URL, json={})
280	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
290	
291	        response = requests.post(PREDICT_URL, json={})
292	        assert response.json() == {

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
304	
305	        response = requests.post(PREDICT_URL, json={}, stream=True)
306	        assert response.headers.get("transfer-encoding") == "chunked"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
305	        response = requests.post(PREDICT_URL, json={}, stream=True)
306	        assert response.headers.get("transfer-encoding") == "chunked"
307	        assert [

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
310	
311	        predict_non_stream_response = requests.post(
312	            PREDICT_URL, json={}, stream=True, headers={"accept": "application/json"}
313	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
328	        with pytest.raises(requests.exceptions.ChunkedEncodingError):
329	            response = requests.post(PREDICT_URL, json={}, stream=True)
330	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
351	
352	        predict_error_response = requests.post(
353	            PREDICT_URL, json={"throw_error": True}, stream=True, timeout=2
354	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
364	        # Test that we are able to continue to make requests successfully
365	        predict_non_error_response = requests.post(
366	            PREDICT_URL, json={"throw_error": False}, stream=True, timeout=2
367	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
411	
412	        response = requests.post(PREDICT_URL, json={})
413	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:425
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
424	
425	        response = requests.post(PREDICT_URL, json={})
426	        assert "error" in response.json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
438	
439	        response = requests.post(PREDICT_URL, json={})
440	        assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
474	
475	        response = requests.post(PREDICT_URL, json={}, stream=True)
476	        logging.info(response.content)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
514	            time.sleep(delay)
515	            response = requests.post(PREDICT_URL, json={}, stream=True)
516	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
519	
520	        with ThreadPoolExecutor() as e:
521	            # We use concurrent.futures.wait instead of the timeout property

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
567	            time.sleep(delay)
568	            response = requests.post(PREDICT_URL, json={})
569	            assert response.status_code == 200

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
571	
572	        with ThreadPoolExecutor() as e:
573	            # We use concurrent.futures.wait instead of the timeout property

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
602	
603	        response = requests.post(PREDICT_URL, json={})
604	        assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:627
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
626	
627	        response = requests.post(PREDICT_URL, json={})
628	        assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
649	
650	        response = requests.post(PREDICT_URL, json={})
651	        assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:669
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
668	
669	        response = requests.post(PREDICT_URL, json={})
670	        assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
695	
696	        response = requests.post(PREDICT_URL, json={})
697	        assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
721	
722	        response = requests.post(PREDICT_URL, json={})
723	        assert response.status_code == 500

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
754	
755	        truss_server_addr = "http://localhost:8090"
756	
757	        def _test_liveness_probe(expected_code):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
757	        def _test_liveness_probe(expected_code):
758	            live = requests.get(f"{truss_server_addr}/")
759	            assert live.status_code == expected_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
761	        def _test_readiness_probe(expected_code):
762	            ready = requests.get(f"{truss_server_addr}/v1/models/model")
763	            assert ready.status_code == expected_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:766
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
765	        def _test_is_loaded(expected_code):
766	            ready = requests.get(f"{truss_server_addr}/v1/models/model/loaded")
767	            assert ready.status_code == expected_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
769	        def _test_ping(expected_code):
770	            ping = requests.get(f"{truss_server_addr}/ping")
771	            assert ping.status_code == expected_code

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
773	        def _test_invocations(expected_code):
774	            invocations = requests.post(f"{truss_server_addr}/invocations", json={})
775	            assert invocations.status_code == expected_code

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
801	        predict_call = Thread(
802	            target=lambda: requests.post(
803	                f"{truss_server_addr}/v1/models/model:predict", json={}
804	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:847
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
846	        assert "Executing model.load with environment: staging" in container.logs()
847	        response = requests.post(PREDICT_URL, json={})
848	        assert response.json() == "staging"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
858	        assert "Executing model.load with environment: None" in container.logs()
859	        response = requests.post(PREDICT_URL, json={})
860	        assert response.json() is None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1019	
1020	        truss_server_addr = "http://localhost:8090"
1021	        for _ in range(5):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1022	            time.sleep(1)
1023	            healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1024	            if healthy.status_code == 503:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1067
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1066	
1067	        truss_server_addr = "http://localhost:8090"
1068	
1069	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1069
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1068	
1069	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1070	        assert healthy.status_code == 503

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1093	        )
1094	        truss_server_addr = "http://localhost:8090"
1095	
1096	        time.sleep(5)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1097
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1096	        time.sleep(5)
1097	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1098	        assert healthy.status_code == 503

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1104	
1105	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1106	        assert healthy.status_code == 503

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1107	        assert container.logs().count("Health check failed.") == 1
1108	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1109	        assert healthy.status_code == 503

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1132	        time.sleep(5)
1133	        truss_server_addr = "http://localhost:8090"
1134	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1133	        truss_server_addr = "http://localhost:8090"
1134	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1135	        assert healthy.status_code == 503

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1136	        time.sleep(10)
1137	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1138	        assert healthy.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1141	        for response in healthy_responses:
1142	            predict_response = requests.post(PREDICT_URL, json={"healthy": response})
1143	            assert predict_response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1143	            assert predict_response.status_code == 200
1144	            healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1145	            assert healthy.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1148	        for response in not_healthy_responses:
1149	            predict_response = requests.post(PREDICT_URL, json={"healthy": response})
1150	            assert predict_response.status_code == 200

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1150	            assert predict_response.status_code == 200
1151	            healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1152	            assert healthy.status_code == 503

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1164	
1165	        truss_server_addr = "http://localhost:8090"
1166	
1167	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1166	
1167	        healthy = requests.get(f"{truss_server_addr}/v1/models/model")
1168	        assert healthy.status_code == 200

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1181	    with tempfile.NamedTemporaryFile() as patched_file:
1182	        patched_file.write(modified_content.encode("utf-8"))
1183	        patched_file.flush()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1201	        async with httpx.AsyncClient() as client:
1202	            response = await client.post(PREDICT_URL, json=data)
1203	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1209	        )
1210	        await predict_request({"seconds": 0, "task": 0})  # Warm up server.
1211	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1209	        )
1210	        await predict_request({"seconds": 0, "task": 0})  # Warm up server.
1211	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1213	        # They should both finish successfully since the server grace period is 120 s.
1214	        task_0 = asyncio.create_task(predict_request({"seconds": 2, "task": 0}))
1215	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1213	        # They should both finish successfully since the server grace period is 120 s.
1214	        task_0 = asyncio.create_task(predict_request({"seconds": 2, "task": 0}))
1215	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1215	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.
1216	        task_1 = asyncio.create_task(predict_request({"seconds": 2, "task": 1}))
1217	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1215	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.
1216	        task_1 = asyncio.create_task(predict_request({"seconds": 2, "task": 1}))
1217	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1234	        container.restart()
1235	        wait_for_truss("http://localhost:8090", container, True)
1236	        await predict_request({"seconds": 0, "task": 0})  # Warm up server.

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1235	        wait_for_truss("http://localhost:8090", container, True)
1236	        await predict_request({"seconds": 0, "task": 0})  # Warm up server.
1237	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1235	        wait_for_truss("http://localhost:8090", container, True)
1236	        await predict_request({"seconds": 0, "task": 0})  # Warm up server.
1237	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1237	
1238	        task_2 = asyncio.create_task(predict_request({"seconds": 2, "task": 2}))
1239	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1237	
1238	        task_2 = asyncio.create_task(predict_request({"seconds": 2, "task": 2}))
1239	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1239	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.
1240	        task_3 = asyncio.create_task(predict_request({"seconds": 2, "task": 3}))
1241	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1239	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.
1240	        task_3 = asyncio.create_task(predict_request({"seconds": 2, "task": 3}))
1241	        await asyncio.sleep(0.1)  # Yield to event loop to make above task run.

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1300	        headers_0 = _make_otel_headers()
1301	        predict_response = requests.post(
1302	            PREDICT_URL, json={}, stream=True, headers=headers_0
1303	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1307	        headers_1 = _make_otel_headers()
1308	        predict_response = requests.post(
1309	            PREDICT_URL, json={}, stream=True, headers=headers_1
1310	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1310	        )
1311	        assert predict_response.headers.get("transfer-encoding") == "chunked"
1312	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1314	        headers_2 = _make_otel_headers()
1315	        predict_non_stream_response = requests.post(
1316	            PREDICT_URL,
1317	            json={},
1318	            stream=True,
1319	            headers={**headers_2, "accept": "application/json"},
1320	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1374	
1375	        response = requests.post(PREDICT_URL, json={"code": status.HTTP_204_NO_CONTENT})
1376	        assert response.status_code == 204

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1379	
1380	        response = requests.post(
1381	            PREDICT_URL, json={"code": status.HTTP_500_INTERNAL_SERVER_ERROR}
1382	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1405	        # A request for which response is not completely read.
1406	        predict_response = requests.post(PREDICT_URL, json={}, stream=True)
1407	        assert (

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1436	
1437	        response = requests.post(PREDICT_URL, json={"test": 123})
1438	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1571	
1572	        response = requests.post(PREDICT_URL, json={})
1573	        assert response.status_code == 500

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1611	            ) as client:
1612	                response = client.post(PREDICT_URL, json={}, timeout=1.0)
1613	                response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1643	            ) as client:
1644	                response = client.post(PREDICT_URL, json={}, timeout=1.0)
1645	                response.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1698	        print("Make warmup request")
1699	        make_request(consume_chunks=True, timeout=0.55, task_id=0)
1700	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1699
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1698	        print("Make warmup request")
1699	        make_request(consume_chunks=True, timeout=0.55, task_id=0)
1700	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1700	
1701	        with ThreadPoolExecutor() as executor:
1702	            # Start two requests and hold them without consuming all chunks

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1710	            with pytest.raises(httpx.ReadTimeout):
1711	                make_request(True, timeout=0.55, task_id=3)
1712	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1711
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1710	            with pytest.raises(httpx.ReadTimeout):
1711	                make_request(True, timeout=0.55, task_id=3)
1712	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1716	
1717	        result = make_request(True, timeout=0.55, task_id=4)
1718	        print(f"Final chunks: {result}")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1716	
1717	        result = make_request(True, timeout=0.55, task_id=4)
1718	        print(f"Final chunks: {result}")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1747	
1748	        response = requests.post(PREDICT_URL, json={"increment": 1})
1749	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1752
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1751	
1752	        response = requests.post(COMPLETIONS_URL, json={"increment": 2})
1753	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1755	
1756	        response = requests.post(CHAT_COMPLETIONS_URL, json={"increment": 3})
1757	        assert response.status_code == 404

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1785	
1786	        response = requests.post(PREDICT_URL, json={"nums": ["1", "2"]}, stream=True)
1787	        assert response.headers.get("transfer-encoding") == "chunked"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1786	        response = requests.post(PREDICT_URL, json={"nums": ["1", "2"]}, stream=True)
1787	        assert response.headers.get("transfer-encoding") == "chunked"
1788	        assert [

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1818
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1817	
1818	        response = requests.post(PREDICT_URL, json={"nums": ["1", "2"]})
1819	        assert response.status_code == 200

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1847	
1848	        response = requests.post(
1849	            CHAT_COMPLETIONS_URL,
1850	            json={"nums": ["1", "2"]},
1851	            stream=True,
1852	            # Despite requesting json, we should still stream results back.
1853	            headers={
1854	                "accept": "application/json",
1855	                "user-agent": "OpenAI/Python 1.61.0",
1856	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_inference.py:1858
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1857	        )
1858	        assert response.headers.get("transfer-encoding") == "chunked"
1859	        assert [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	DEFAULT_CONFIG = """model_name: test-truss"""
14	TRUSS_SERVER_ADDR = "http://localhost:8090"
15	INFERENCE_URL = f"{TRUSS_SERVER_ADDR}/v1/models/model:predict"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
27	
28	        response = requests.post(INFERENCE_URL, json={"prompt": "value"})
29	        assert response.json() == {"prompt": "value"}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	
31	        schema_response = requests.get(SCHEMA_URL)
32	        assert schema_response.status_code == 404

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
54	
55	        response = requests.post(INFERENCE_URL, json={"prompt": "value"})
56	        assert response.json() == ["hello"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	
58	        schema_response = requests.get(SCHEMA_URL)
59	        assert schema_response.status_code == 404

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
86	
87	        schema_response = requests.get(SCHEMA_URL)
88	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
104	        json_input = {"prompt": "value"}
105	        response = requests.post(INFERENCE_URL, json=json_input)
106	        assert response.json() == {"generated_text": "value"}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
110	        print(byte_input)
111	        response = requests.post(
112	            INFERENCE_URL,
113	            data=byte_input,
114	            headers={"Content-Type": "application/octet-stream"},
115	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
118	        # An invalid input
119	        response = requests.post(INFERENCE_URL, json={"bad_key": "value"})
120	        assert response.status_code == 400

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	        # Schema response.
130	        schema_response = requests.get(SCHEMA_URL)
131	        schema = schema_response.json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
172	        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)
173	        response = requests.post(INFERENCE_URL, json={"prompt": "value"})
174	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
176	
177	        schema_response = requests.get(SCHEMA_URL)
178	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
225	
226	        response = requests.post(INFERENCE_URL, json={"prompt": "value"})
227	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
229	
230	        schema_response = requests.get(SCHEMA_URL)
231	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
270	
271	        response = requests.post(INFERENCE_URL, json={"prompt": "value"})
272	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
274	
275	        schema_response = requests.get(SCHEMA_URL)
276	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
321	
322	        response = requests.post(INFERENCE_URL, json={"prompt": "value"})
323	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
325	
326	        schema_response = requests.get(SCHEMA_URL)
327	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
372	
373	        response = requests.post(
374	            INFERENCE_URL, json={"prompt": "value", "stream": False}
375	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
379	
380	        response = requests.post(
381	            INFERENCE_URL, json={"prompt": "value", "stream": True}
382	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
386	
387	        schema_response = requests.get(SCHEMA_URL)
388	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
441	
442	        response = requests.post(
443	            INFERENCE_URL, json={"prompt": "value", "stream": False}
444	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
448	
449	        schema_response = requests.get(SCHEMA_URL)
450	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_gatherer.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
18	    sub_module.unlink()
19	    subdir.rmdir()
20	    ext_pkg_top_module.unlink()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
434	        for req in file_requirements:
435	            req_file.write(f"{req}\n")
436	    th.update_requirements_from_file(str(req_file_path))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
475	    with data_filepath.open("w") as data_file:
476	        data_file.write("test")
477	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
482	    with scaf_data_filepath.open() as data_file:
483	        assert data_file.read() == "test"
484	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
489	    with file1_path.open("w") as data_file:
490	        data_file.write("test1")
491	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
493	    with file2_path.open("w") as data_file:
494	        data_file.write("test2")
495	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
497	    with file2_path.open("w") as data_file:
498	        data_file.write("{}")
499	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
514	    with file_path.open("w") as data_file:
515	        data_file.write("test")
516	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
521	    with scaf_file_path.open() as data_file:
522	        assert data_file.read() == "test"
523	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:606
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
605	        ) as model_code_file:
606	            model_code_file.write(
607	                """
608	class Model:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
665	        with model_code_file_path.open("w") as model_code_file:
666	            model_code_file.write(bad_model_code)
667	        with pytest.raises(RetryError) as exc_info:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
679	        with model_code_file_path.open("w") as model_code_file:
680	            model_code_file.write(good_model_code)
681	        result = th.docker_predict([1], tag=tag)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
693	    port = patch_ping_test_server
694	    patch_ping_url = f"http://host.docker.internal:{port}/{patch_path}"
695	    th = TrussHandle(custom_model_control)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
701	        # Make sure the patch ping url was actually hit
702	        stats = requests.get(f"http://127.0.0.1:{port}/stats").json()
703	        assert stats[f"{patch_path}_called_count"] == expected_call_count

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:702
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
701	        # Make sure the patch ping url was actually hit
702	        stats = requests.get(f"http://127.0.0.1:{port}/stats").json()
703	        assert stats[f"{patch_path}_called_count"] == expected_call_count

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_truss_handle.py:790
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
789	def _read_readme(readme_correct_path: Path) -> str:
790	    return readme_correct_path.open().read().replace("\n", "")
791	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_util.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	TEST_DOWNLOAD_URL = "http://example.com/some-download-url"
10	
11	
12	def test_download(tmp_path):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_util.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
14	    with patch.dict(os.environ, {}), requests_mock.Mocker() as m:
15	        m.get(TEST_DOWNLOAD_URL, content=mocked_download_content)
16	        external_data = ExternalData.from_list(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_util.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	        with open(tmp_path / "foo", "rb") as f:
22	            content = f.read()
23	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_util.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	    with patch.dict(os.environ, {}), requests_mock.Mocker() as m:
30	        m.get(TEST_DOWNLOAD_URL, content=mocked_download_content)
31	        external_data = ExternalData.from_list(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_util.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
36	        with open(tmp_path / "foo" / "bar" / "baz", "rb") as f:
37	            content = f.read()
38	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/trt_llm/config_checks.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	    """
38	    response = requests.get(f"{HF_MODELS_API_URL}/{model_id}")
39	    return response.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/trt_llm/validation.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	                            (
33	                                "Model class `__init__` method is required to have `trt_llm` as an argument. Please add that argument.\n  "
34	                                "Or if you want to use the automatically generated model class then remove the `model.py` file.\n "
35	                                "Refer to https://docs.baseten.co/performance/engine-builder-customization for details on engine object usage."
36	                            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/build.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	    with open(model_file_path, "r") as f:
55	        content = f.read()
56	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/build.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	    with open(model_file_path, "w") as f:
60	        f.write(content)
61	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/truss_handle.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
138	
139	            return requests.post(
140	                url,
141	                data=binary_data,
142	                headers={"Content-Type": "application/octet-stream"},
143	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/truss_handle.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
144	
145	        return requests.post(url, json=request)
146	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/truss_handle.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
336	            )
337	        model_base_url = f"http://localhost:{local_port}/v1/models/model"
338	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/truss_handle.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
428	
429	        if resp.headers.get("transfer-encoding") == "chunked":
430	            # Streaming responses come back just as bytes, so we don't make assumptions

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/truss_handle.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
744	        model_base_url = _get_url_from_container(container)
745	        resp = requests.post(
746	            f"{model_base_url}/control/patch", json=patch_request.to_dict()
747	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/truss_handle.py:765
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
764	        model_base_url = _get_url_from_container(container)
765	        resp = requests.get(f"{model_base_url}/control/truss_hash")
766	        resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/truss_handle.py:791
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
790	        model_base_url = _get_url_from_container(container)
791	        resp = requests.get(f"{model_base_url}/control/has_partially_applied_patch")
792	        resp.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/truss_handle/truss_handle.py:1075
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1074	        with attempt:
1075	            response = requests.get(url)
1076	            return response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/util/download.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	def _b10cp_path() -> Optional[str]:
40	    return os.environ.get(B10CP_PATH_TRUSS_ENV_VAR_NAME)
41	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/util/download.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	    # Streaming download to keep memory usage low
78	    resp = requests.get(
79	        URL, allow_redirects=True, stream=True, timeout=BLOB_DOWNLOAD_TIMEOUT_SECS
80	    )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/util/path.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
50	def remove_tree_path(target: Path) -> None:
51	    return shutil.rmtree(str(target))
52	

--------------------------------------------------

Code scanned:
	Total lines of code: 26247
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 121.0
		High: 306.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 419.0
		High: 8.0
Files skipped (0):
