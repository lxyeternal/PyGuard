Run started:2025-04-12 16:56:17.224275

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/blob.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	
35	HOST = os.environ.get('STORAGE_EMULATOR_HOST', 'storage.googleapis.com')
36	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/blob.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
106	        headers = None if auto_decompress else {'accept-encoding': 'gzip'}
107	        return await self.bucket.storage.download(
108	            self.bucket.name,
109	            self.name,
110	            timeout=timeout,
111	            session=session,
112	            headers=headers,
113	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/blob.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
119	    ) -> Dict[str, Any]:
120	        metadata = await self.bucket.storage.upload(
121	            self.bucket.name,
122	            self.name,
123	            data,
124	            content_type=content_type,
125	            session=session,
126	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/blob.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	        # Try to sign locally if available
163	        client_email = token.service_data.get('client_email')
164	        private_key = token.service_data.get('private_key')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/blob.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	        client_email = token.service_data.get('client_email')
164	        private_key = token.service_data.get('private_key')
165	        if not client_email or not private_key:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/bucket.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	            )
76	            items.extend([x['name'] for x in content.get('items', [])])
77	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/bucket.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	
78	            params['pageToken'] = content.get('nextPageToken', '')
79	            if not params['pageToken']:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	SCOPES = [
44	    'https://www.googleapis.com/auth/devstorage.read_write',
45	]
46	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	
54	    host = os.environ.get('STORAGE_EMULATOR_HOST')
55	    if host:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
61	
62	    return False, 'https://www.googleapis.com'
63	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	    def content_length(self) -> int:
132	        return int(self._response.headers.get('content-length', 0))
133	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
140	        else:
141	            chunk = await self._response.content.read(size)
142	        return chunk

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
177	
178	        token = await self.token.get()
179	        return {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
195	        params = params or {}
196	        if not params.get('pageToken'):
197	            params['pageToken'] = ''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	        while True:
202	            resp = await s.get(url, headers=headers,
203	                               params=params or {},
204	                               timeout=timeout)
205	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
206	            content: Dict[str, Any] = await resp.json(content_type=None)
207	            for item in content.get('items', []):
208	                buckets.append(Bucket(self, item['id']))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	
210	            params['pageToken'] = content.get('nextPageToken', '')
211	            if not params['pageToken']:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
280	        s = AioSession(session) if session else self.session
281	        resp = await s.post(
282	            url, headers=headers, params=params, timeout=timeout,
283	            data=metadata_,
284	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
287	
288	        while not data.get('done') and data.get('rewriteToken'):
289	            params['rewriteToken'] = data['rewriteToken']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
287	
288	        while not data.get('done') and data.get('rewriteToken'):
289	            params['rewriteToken'] = data['rewriteToken']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
289	            params['rewriteToken'] = data['rewriteToken']
290	            resp = await s.post(
291	                url, headers=headers, params=params,
292	                timeout=timeout, data=metadata_,
293	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
329	    ) -> bytes:
330	        return await self._download(
331	            bucket, object_name, headers=headers,
332	            timeout=timeout, params={'alt': 'media'},
333	            session=session,
334	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
343	        ) as file_object:
344	            await file_object.write(
345	                await self.download(bucket, object_name, **kwargs),
346	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
344	            await file_object.write(
345	                await self.download(bucket, object_name, **kwargs),
346	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
353	    ) -> Dict[str, Any]:
354	        data = await self._download(
355	            bucket, object_name, headers=headers,
356	            timeout=timeout, params={'alt': 'json'},
357	            session=session,
358	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
402	        s = AioSession(session) if session else self.session
403	        resp = await s.get(
404	            url, headers=headers, params=params or {},
405	            timeout=timeout,
406	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
483	        ) as file_object:
484	            contents = await file_object.read()
485	            return await self.upload(bucket, object_name, contents, **kwargs)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
484	            contents = await file_object.read()
485	            return await self.upload(bucket, object_name, contents, **kwargs)
486	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:522
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
521	            while True:
522	                chunk = input_stream.read(chunk_size)
523	                if not chunk:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
529	
530	                gzipped_file.write(chunk_bytes)
531	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
603	            # the 'raw' property.
604	            response = await s.get(
605	                url, headers=headers, params=params or {},
606	                timeout=timeout, stream=True,
607	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
607	            )
608	            data = response.raw.read()  # type: ignore[attr-defined]
609	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
609	        else:
610	            response = await s.get(
611	                url, headers=headers, params=params or {},
612	                timeout=timeout, auto_decompress=auto_decompress,
613	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
617	            try:
618	                data = await response.read()
619	            except (AttributeError, TypeError):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
642	            return StreamResponse(
643	                s.get(
644	                    url, headers=headers, params=params or {},
645	                    timeout=timeout, stream=True,
646	                ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:649
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
648	        return StreamResponse(
649	            await s.get(
650	                url, headers=headers, params=params or {},
651	                timeout=timeout,
652	            ),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
666	        s = AioSession(session) if session else self.session
667	        resp = await s.post(
668	            url, data=stream, headers=headers, params=params,
669	            timeout=timeout,
670	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:698
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
697	
698	        raw_body: AnyStr = stream.read()
699	        if isinstance(raw_body, str):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
721	
722	        resp = await s.post(
723	            url, data=body, headers=headers, params=params,
724	            timeout=timeout,
725	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
737	        # https://cloud.google.com/storage/docs/json_api/v1/how-tos/resumable-upload
738	        session_uri = await self._initiate_upload(
739	            url, object_name, params,
740	            headers, metadata=metadata,
741	            session=session,
742	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
742	        )
743	        return await self._do_upload(
744	            session_uri, stream, headers=headers,
745	            session=session, timeout=timeout,
746	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
779	        s = AioSession(session) if session else self.session
780	        resp = await s.post(
781	            url, headers=post_headers, params=params,
782	            data=metadata_, timeout=timeout,
783	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gcloud_aio_storage-9.4.0/gcloud_aio_storage-9.4.0/gcloud/aio/storage/storage.py:864
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
863	        s = AioSession(session) if session else self.session
864	        resp = await s.get(
865	            url, headers=headers, params=params or {},
866	            timeout=timeout,
867	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 1131
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 41.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 0.0
Files skipped (0):
