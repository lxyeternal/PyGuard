Run started:2025-04-12 17:30:14.416883

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/docs/conf.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    "external_links": [
31	        {"name": "Dashboard", "url": "https://getmontecarlo.com"},
32	        {"name": "API reference", "url": "https://apidocs.getmontecarlo.com/"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/docs/conf.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	        {"name": "Dashboard", "url": "https://getmontecarlo.com"},
32	        {"name": "API reference", "url": "https://apidocs.getmontecarlo.com/"},
33	        {"name": "Product docs", "url": "https://docs.getmontecarlo.com/"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/docs/conf.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	        {"name": "API reference", "url": "https://apidocs.getmontecarlo.com/"},
33	        {"name": "Product docs", "url": "https://docs.getmontecarlo.com/"},
34	    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	DEFAULT_TAGS_PAGE_SIZE = 10
48	DOCKER_HUB_TAGS_BASE_URL = "https://hub.docker.com/v2/namespaces/"
49	
50	# Adapted from https://docs.aws.amazon.com/lambda/latest/dg/API_Invoke.html#API_Invoke_RequestSyntax
51	LAMBDA_ARN_REGEX = re.compile(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	
113	        dry_run = kwargs.get("dry_run", False)
114	        agent_request = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
122	
123	        if kwargs.get("dc_id"):
124	            agent_request["data_collector_id"] = kwargs["dc_id"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	
126	        if kwargs.get("agent_id"):
127	            agent_request["agent_id"] = kwargs["agent_id"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        # append base64 encoded mTLS certs to credentials if provided
165	        if kwargs.get("client_certificate") and kwargs.get("private_key"):
166	            creds = json.loads(agent_request.get("credentials", "{}"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	        # append base64 encoded mTLS certs to credentials if provided
165	        if kwargs.get("client_certificate") and kwargs.get("private_key"):
166	            creds = json.loads(agent_request.get("credentials", "{}"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
165	        if kwargs.get("client_certificate") and kwargs.get("private_key"):
166	            creds = json.loads(agent_request.get("credentials", "{}"))
167	            creds["client_certificate"] = read_as_base64(kwargs["client_certificate"]).decode(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
218	        for agent in self._user_service.agents:
219	            is_active = not agent.get("isDeleted")
220	            if not show_inactive and not is_active:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
221	                continue
222	            full_type = f"{agent.get('agentType', '')} / {agent.get('platform', '')}"
223	            last_updated = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
221	                continue
222	            full_type = f"{agent.get('agentType', '')} / {agent.get('platform', '')}"
223	            last_updated = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
228	                ).strftime("%Y-%m-%d %H:%M:%S")
229	                if agent.get("lastUpdatedTime")
230	                else "-"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
224	                datetime.fromisoformat(
225	                    agent.get(
226	                        "lastUpdatedTime",
227	                    )  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
234	                [
235	                    agent.get("uuid") or "",
236	                    full_type,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
236	                    full_type,
237	                    agent.get("dc_id") or "",
238	                    agent.get("endpoint") or "",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
237	                    agent.get("dc_id") or "",
238	                    agent.get("endpoint") or "",
239	                    agent.get("imageVersion") or "-",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
238	                    agent.get("endpoint") or "",
239	                    agent.get("imageVersion") or "-",
240	                    last_updated,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:290
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
289	        agent = self._user_service.get_agent(agent_id)
290	        if agent.get("agentType") != "REMOTE_AGENT":  # type: ignore
291	            storage_query = Query()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
376	                "timestamp": event.timestamp,
377	                "commands": event.payload.get("commands") if event.payload else {},  # type: ignore
378	                "operation_name": (event.payload.get("operation_name") if event.payload else None),  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
377	                "commands": event.payload.get("commands") if event.payload else {},  # type: ignore
378	                "operation_name": (event.payload.get("operation_name") if event.payload else None),  # type: ignore
379	                "trace_id": event.payload.get("trace_id") if event.payload else None,  # type: ignore

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
378	                "operation_name": (event.payload.get("operation_name") if event.payload else None),  # type: ignore
379	                "trace_id": event.payload.get("trace_id") if event.payload else None,  # type: ignore
380	            }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
416	        infra_details = self._get_aws_infra_details(**kwargs)
417	        click.echo(infra_details.get("template"))
418	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:422
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
421	        infra_details = self._get_aws_infra_details(**kwargs)
422	        parameters = infra_details.get("parameters")
423	        click.echo(json.dumps(parameters, indent=4))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
441	    def _choose_image(self, agent_id: str, image_tag: Optional[str] = None) -> Optional[str]:
442	        platform = self._user_service.get_agent(agent_id).get("platform")  # type: ignore
443	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/agents/agent.py:474
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
473	        )
474	        response = requests.get(url=url)
475	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/collector/validation.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
200	
201	        executor = ThreadPoolExecutor(max_workers=4)
202	        # Start the load operations and mark each future with its URL

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/common/common.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
50	    with open(path, "rb") as fp:
51	        return base64.b64encode(fp.read())
52	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/common/common.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
50	    with open(path, "rb") as fp:
51	        return base64.b64encode(fp.read())
52	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/config.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	        self._config = config_parser or configparser.ConfigParser()
43	        self._config.read(self._profile_config_file)
44	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/config.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	        with open(self._profile_config_file, "w") as cf:
71	            self._config.write(cf)
72	

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/data_exports/data_exports.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
130	        mkdirs(os.path.dirname(destination))
131	        urllib.request.urlretrieve(data_export_url, destination)
132	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/data_exports/data_exports.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
148	            AwsClientWrapper(profile_name=aws_profile).upload_stream_to_s3(
149	                data=requests.get(data_export_url, stream=True).raw, bucket=bucket, key=key
150	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/discovery/networking.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
229	            f"redshift security groups - {redshift_security_groups}.",
230	            "https://docs.getmontecarlo.com/docs/network-connectivity#ip-filtering",
231	        ]
232	
233	    @staticmethod
234	    def _get_rs_cross_account_verbiage(
235	        dc_resource_props: DcResourceProperties, does_redshift_dc_share_an_account: bool
236	    ) -> List[str]:
237	        """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/discovery/networking.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	            f"1. Data Collector AWS Account ID: {dc_resource_props.collector_arn.account}",
247	            "https://docs.getmontecarlo.com/docs/peering-templates#create-peering-cross-account-assumable-role-cloudformation-stack",
248	            "",
249	        ]
250	
251	    @staticmethod
252	    def _get_rs_requester_verbiage(
253	        dc_resource_props: DcResourceProperties,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/discovery/networking.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
277	            *cross_role_verbiage,
278	            "https://docs.getmontecarlo.com/docs/peering-templates#create-requester-cloudformation-stack",
279	            "",
280	        ]
281	
282	    @staticmethod
283	    def _get_rs_accepter_verbiage(
284	        dc_resource_props: DcResourceProperties,
285	        redshift_security_groups: List[str],
286	        redshift_routes: Iterator[str],
287	    ) -> List[str]:
288	        """
289	        Generate verbiage for accepter stack.
290	        """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/discovery/networking.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
299	            ],
300	            "https://docs.getmontecarlo.com/docs/peering-templates#create-accepter-cloudformation-stack",
301	            "",
302	        ]
303	
304	    @staticmethod
305	    def _get_overlap_verbiage(collector_vpc_range: str, redshift_vpc_range: str) -> str:
306	        """
307	        Generate verbiage for overlaps.
308	        """
309	        return (
310	            f"Collector range ({collector_vpc_range}) overlaps with "
311	            f"resource ({redshift_vpc_range}). "

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/iac/mc_config_service.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
377	            ) as f:
378	                f.write(compiled_mc_config.to_yaml())
379	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/iac/mc_config_service.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
400	                with open(os.path.join(self.project_dir, PROJECT_CONFIG_FILENAME_YML), "r") as f:
401	                    contents = f.read()
402	            except FileNotFoundError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/iac/mc_config_service.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
403	                with open(os.path.join(self.project_dir, PROJECT_CONFIG_FILENAME_YAML), "r") as f:
404	                    contents = f.read()
405	                project_config_file_name = PROJECT_CONFIG_FILENAME_YAML

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/insights/data_insights.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
138	        mkdirs(os.path.dirname(destination))
139	        urllib.request.urlretrieve(insight_url, destination)
140	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/insights/data_insights.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	            AwsClientWrapper(profile_name=aws_profile).upload_stream_to_s3(
157	                data=requests.get(insight_url, stream=True).raw, bucket=bucket, key=key
158	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/integrations/commands.py:1595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1594	    "--repo-url",
1595	    help="Repository URL as ssh://[user@]server/project.git or the shorter "
1596	    "form [user@]server:project.git for ssh. For https, use https://server/project.git.",
1597	    required=True,

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/integrations/commands.py:2439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
2438	def add_streaming_system(ctx, **kwargs):
2439	    StreamingOnboardingService(
2440	        config=ctx["config"],
2441	        mc_client=create_mc_client(ctx),
2442	        command_name="integrations add_streaming_system",
2443	    ).create_streaming_system(**kwargs)
2444	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/integrations/onboarding/data_lake/databricks.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    "MC_INTEGRATION_GATEWAY_URL",
26	    "https://integrations.getmontecarlo.com/databricks/metadata",
27	)
28	# Secret scope and name defined in the data collector:
29	# https://github.com/monte-carlo-data/data-collector/blob/e5db61eacd10e0388acd9ff8a32fe60644b36797/lambdas/api_lambdas/execute_databricks_actions.py#L61  # noqa

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/integrations/onboarding/fields.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
165	PRESTO_CERT_PREFIX = "certificates/presto/"
166	AWS_RDS_CA_CERT = "https://s3.amazonaws.com/rds-downloads/rds-combined-ca-bundle.pem"
167	
168	# Connections to friendly name (i.e. human presentable) map
169	GQL_TO_FRIENDLY_CONNECTION_MAP = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/settings.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	# Default MCD API endpoint when no env or config file setting is available
13	MCD_DEFAULT_API_ENDPOINT = "https://api.getmontecarlo.com/graphql"
14	
15	# MCD ID header (for use in local development and testing)
16	MCD_USER_ID_HEADER = os.getenv("MCD_USER_ID_HEADER")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
45	        """
46	        response = self._make_request(
47	            query=query,
48	            service=service,
49	            variables=variables,
50	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	        if response:
52	            if self._abort_on_error and response.get("errors"):
53	                complain_and_abort(response["errors"])

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
67	        """
68	        response = self._make_request(
69	            query=query,
70	            variables=(self.convert_snakes_to_camels(variables) if variables else variables),
71	            service=service,
72	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	        assert response, "No response from server"
74	        data = response.get("data", {}).get(operation)
75	        if data:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
73	        assert response, "No response from server"
74	        data = response.get("data", {}).get(operation)
75	        if data:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
79	                data = BoxList(data)
80	        parsed_response = MonolithResponse(data=data, errors=response.get("errors"))
81	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
119	
120	        response = self._post(headers=headers, payload=payload)
121	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
126	    def _post(self, headers: Dict, payload: Dict) -> requests.Response:
127	        return requests.post(self._endpoint, json=payload, headers=headers)
128	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
181	        """
182	        return self.get_stack_details(stack_id)["Stacks"][0].get("Parameters")
183	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
278	            for cluster in page["Clusters"]:
279	                yield client.describe_cluster(ClusterId=cluster["Id"]).get("Cluster")
280	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/montecarlodata/utils.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
372	        ):
373	            if page and page.get("Subscriptions"):
374	                yield page["Subscriptions"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    author_email="info@montecarlodata.com",
26	    url="https://www.montecarlodata.com/",
27	    packages=find_packages(exclude=["tests*"]),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/iac/test_mc_config_service.py:1060
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1059	        with open(f"{project_dir}/expected.yml", "r") as f:
1060	            expected_yaml = f.read()
1061	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/iac/test_mc_config_service.py:1063
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1062	        with open(output_path, "r") as f:
1063	            output_yaml = f.read()
1064	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/iac/test_mc_config_service.py:1085
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1084	        with open(output_path, "r") as f:
1085	            output_yaml = f.read()
1086	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/iac/test_mc_config_service.py:1206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1205	        dir = self._get_temp_dir("convert_to_mac")
1206	        shutil.rmtree(dir, ignore_errors=True)
1207	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/iac/test_mc_config_service.py:1250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1249	        monitors_file = os.path.join(self._get_project_dir("convert_to_mac"), "monitors_uuids")
1250	        shutil.rmtree(dir, ignore_errors=True)
1251	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/iac/test_mc_config_service.py:1361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1360	        dir = self._get_temp_dir("get_template")
1361	        shutil.rmtree(dir, ignore_errors=True)
1362	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_airflow_keys.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	        mcd_token="67890",
15	        mcd_api_endpoint="https://api.getmontecarlo.com/graphql",
16	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_base_onboarding.py:609
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
608	        fivetran_password = "fivetran_password"
609	        fivetran_url = "https://api.fivetran.com/v1/"
610	
611	        kwargs = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_collector_management.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	_SAMPLE_GATEWAY_ID = "gateway_id"
25	_SAMPLE_TEMPLATE_URI = "https://s3.amazonaws.com/bucket/public/customer_templates/id.json"
26	_SAMPLE_INVALID_LAUNCH_URL = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_collector_management.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	_SAMPLE_INVALID_LAUNCH_URL = (
27	    "https://test.com/cf/home?"
28	    "region=us-east-1#/stacks/create/review?stackName=monte-carlo&malformed"
29	)
30	_SAMPLE_VALID_LAUNCH_URL = (
31	    f"https://test.com/cf/home?"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_collector_management.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	_SAMPLE_VALID_LAUNCH_URL = (
31	    f"https://test.com/cf/home?"
32	    f"region=us-east-1#/stacks/create/review?"
33	    f"stackName=monte-carlo&templateURL={_SAMPLE_TEMPLATE_URI}"
34	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_common_resources.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
215	            "storageType": "GCS",
216	            "endpoint": "https://example.com",
217	            "isDeleted": False,
218	            "imageVersion": "800",
219	        }
220	        self._user_service_mock.get_collector.return_value = Box(
221	            {**_SAMPLE_COLLECTOR, "agents": [gcp_remote_agent_data]}
222	        )
223	        self._user_service_mock.get_collector_agent.return_value = Box(gcp_remote_agent_data)
224	        with self.assertRaises(click.exceptions.Abort):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_common_resources.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
532	                "OutputKey": "PublicIP",
533	                "OutputValue": "127.0.0.1",
534	                "Description": "Does stuff",
535	            },
536	            {
537	                "OutputKey": "QueryLogEventQueue",
538	                "OutputValue": q_out,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_common_user.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    mcd_token="5678",
15	    mcd_api_endpoint="https://api.getmontecarlo.com/graphql",
16	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_config.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	        "mcd_token": "a-test-token-with-fifty-six-characters-for-verifications",
15	        "mcd_api_endpoint": "https://api.getmontecarlo.com/graphql",
16	        "mcd_agent_image_host": "docker.io",
17	        "mcd_agent_image_org": "montecarlodata",
18	        "mcd_agent_image_repo": "agent",
19	    }
20	)
21	
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_data_exports.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	SAMPLE_DATA_EXPORT = "MONITORS"
16	SAMPLE_DATA_EXPORT_URL = "https://montecarlodata.com"
17	SAMPLE_S3_DESTINATION = "s3://bucket/prefix/object"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_data_exports.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	        with self.assertRaises(click.exceptions.Abort):
82	            self._service.get_data_export(data_export=SAMPLE_DATA_EXPORT, destination="http://foo")
83	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_data_insights.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	SAMPLE_INSIGHT = "key_assets"
16	SAMPLE_INSIGHT_URL = "https://montecarlodata.com"
17	SAMPLE_S3_DESTINATION = "s3://bucket/prefix/object"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_data_insights.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        with self.assertRaises(click.exceptions.Abort):
65	            self._service.get_insight(insight=SAMPLE_INSIGHT, destination="http://foo")
66	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_fivetran_onboarding.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    "fivetranApiPassword": "my-fivetran-api-password",
26	    "fivetranBaseUrl": "https://api.fivetran.com",
27	    "collectorId": "my-collector-id",
28	}
29	
30	
31	class FivetranOnboardingTest(TestCase):
32	    def setUp(self) -> None:
33	        self._user_service_mock = Mock(autospec=UserService)
34	        self._request_wrapper_mock = Mock(autospec=GqlWrapper)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_gql_util.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
64	        self.assertEqual(
65	            self._service.make_request(
66	                query=_SAMPLE_QUERY,
67	                service=_SAMPLE_SERVICE,
68	                variables=_SAMPLE_VARIABLES,
69	            ),
70	            _SAMPLE_RESPONSE["data"],

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_gql_util.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
71	        )
72	        request_mock.assert_called_once_with(**self._build_request())
73	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_gql_util.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
94	        self.assertEqual(
95	            self._service.make_request(
96	                query=_SAMPLE_QUERY,
97	                service=_SAMPLE_SERVICE,
98	                variables=_SAMPLE_VARIABLES,
99	            ),
100	            _SAMPLE_RESPONSE["data"],

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_gql_util.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
161	        with self.assertRaises(click.exceptions.Abort):
162	            self._service.make_request(
163	                query=_SAMPLE_QUERY,
164	                service=_SAMPLE_SERVICE,
165	                variables=_SAMPLE_VARIABLES,
166	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_gql_util.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
166	            )
167	        request_mock.assert_called_once_with(**self._build_request())
168	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_integration_keys.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        mcd_token="67890",
22	        mcd_api_endpoint="https://api.getmontecarlo.com/graphql",
23	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_network_discovery.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
24	                "vpc_id": "vpc-1234",
25	                "public_ip": "127.0.0.1",
26	                "cloud_watch_log_vpc_endpoint": "vpce-1234",
27	                "template_version": "2340",
28	                "api_gateway_id": "foo",
29	                "private_s3_bucket_arn": "arn:aws:s3:::bucket",
30	                "security_group": "sg-1234",
31	            },
32	            "parameters": {
33	                "enable_gateway_access_logging": "False",
34	                "create_event_infra": "False",
35	                "existing_s3_vpce": "N/A",
36	                "worker_lambda_concurrent_executions": "42",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_network_discovery.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
336	                f"security groups - {sg}.",
337	                "https://docs.getmontecarlo.com/docs/network-connectivity#ip-filtering",
338	            ],
339	        )
340	
341	    def test_get_rs_cross_account_verbiage(self):
342	        props = copy.deepcopy(SAMPLE_DC_PROPS)
343	        props.resource_props = SAMPLE_RESOURCE_PROPS

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_network_discovery.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
349	                "1. Data Collector AWS Account ID: 1234",
350	                "https://docs.getmontecarlo.com/docs/peering-templates#create-peering-cross-account-assumable-role-cloudformation-stack",
351	                "",
352	            ],
353	        )
354	
355	    def test_get_rs_cross_account_verbiage_in_same_account(self):
356	        props = copy.deepcopy(SAMPLE_DC_PROPS)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_network_discovery.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
377	                "output of the previous stack>",
378	                "https://docs.getmontecarlo.com/docs/peering-templates#create-requester-cloudformation-stack",
379	                "",
380	            ],
381	        )
382	
383	    def test_get_rs_accepter_verbiage(self):
384	        sg, routes = ["a"], ["b"]
385	        props = copy.deepcopy(SAMPLE_DC_PROPS)
386	        props.resource_props = SAMPLE_RESOURCE_PROPS
387	        props.resource_arn = AWSArn(SAMPLE_RESOURCE_PROPS.cluster_namespace_arn)
388	
389	        self.assertEqual(
390	            self._service._get_rs_accepter_verbiage(props, sg, routes),
391	            [

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_network_discovery.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
397	                "4. Resource / Warehouse Route Table #1: 'b'",
398	                "https://docs.getmontecarlo.com/docs/peering-templates#create-accepter-cloudformation-stack",
399	                "",
400	            ],
401	        )
402	
403	    def test_get_overlap_verbiage(self):
404	        self.assertEqual(
405	            self._service._get_overlap_verbiage("a", "b"),
406	            "Collector range (a) overlaps with resource (b). Peering is not possible when peered VPCs use overlapping "
407	            "CIDR blocks. Please redeploy the collector with a custom CIDR block then rerun recommender.",

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_report_onboarding.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
64	        file_path, service_json = "foo", "bar"
65	        base64_key = base64.b64encode(service_json.encode("utf-8"))
66	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_report_onboarding.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
64	        file_path, service_json = "foo", "bar"
65	        base64_key = base64.b64encode(service_json.encode("utf-8"))
66	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_runner.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
58	def test_validate(script_runner: ScriptRunner, requests_mock: RequestsMocker) -> None:
59	    requests_mock.post(
60	        MCD_DEFAULT_API_ENDPOINT,
61	        json={
62	            "data": {
63	                "getUser": {
64	                    "firstName": "Test",
65	                    "lastName": "Runner",
66	                },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_streaming_onboarding.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
135	            secret="secret",
136	            url="http://confluent.com",
137	            dc_id="c16e3efc-0d54-4088-9514-372a38506e62",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_streaming_onboarding.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	                secret="secret",
160	                url="http://confluent.com",
161	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_streaming_onboarding.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	            confluent_env=None,
170	            url="http://confluent.com",
171	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_warehouse_onboarding.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
64	        private_key = "private_key"
65	        base64_private_key = base64.b64encode(private_key.encode("utf-8"))
66	        input_options = {"private_key": file_path, **_SAMPLE_BASE_OPTIONS}

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_warehouse_onboarding.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
64	        private_key = "private_key"
65	        base64_private_key = base64.b64encode(private_key.encode("utf-8"))
66	        input_options = {"private_key": file_path, **_SAMPLE_BASE_OPTIONS}

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_warehouse_onboarding.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
94	        passphrase = "foobar123"
95	        base64_private_key = base64.b64encode(private_key.encode("utf-8"))
96	        input_options = {

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_warehouse_onboarding.py:95
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
94	        passphrase = "foobar123"
95	        base64_private_key = base64.b64encode(private_key.encode("utf-8"))
96	        input_options = {

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_warehouse_onboarding.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
125	        file_path, service_json = "foo", "bar"
126	        base64_service_json = base64.b64encode(service_json.encode("utf-8"))
127	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/montecarlodata-0.131.0/montecarlodata-0.131.0/tests/test_warehouse_onboarding.py:126
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
125	        file_path, service_json = "foo", "bar"
126	        base64_service_json = base64.b64encode(service_json.encode("utf-8"))
127	

--------------------------------------------------

Code scanned:
	Total lines of code: 22358
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 62.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 98.0
		High: 5.0
Files skipped (0):
