Run started:2025-04-12 18:21:29.476819

Test results:
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_client.py:2177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
2176	            )
2177	        res = requests.request(
2178	            method,
2179	            url,
2180	            headers=headers,
2181	            timeout=Constants.DEFAULT_API_CALL_TIMEOUT_SECONDS,
2182	            params=params or {},
2183	            json=body,
2184	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_client.py:2191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2190	
2191	            if not isinstance(res_data, dict) or not res_data.get('metadata'):
2192	                # We can't parse the response, raise a generic error

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_client.py:2196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2195	            # This is a bauplan error
2196	            if not res_data.get('error'):
2197	                # This is the old response error, catalog is not updated yet

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_client.py:2201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
2200	                    'type': 'APIError',
2201	                    'message': res_data.get('metadata', {})['error'],
2202	                    'context': {},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_common.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	
37	    API_ENDPOINT = 'https://commander-poc.use1.aprod.bauplanlabs.com'
38	    CATALOG_ENDPOINT = 'https://catalog.use1.aprod.bauplanlabs.com'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_common.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    API_ENDPOINT = 'https://commander-poc.use1.aprod.bauplanlabs.com'
38	    CATALOG_ENDPOINT = 'https://catalog.use1.aprod.bauplanlabs.com'
39	    CATALOG_MAX_RECORDS = 500

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_common.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
71	
72	CLIENT_HOSTNAME = socket.gethostname()

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_common.py:72
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
71	
72	CLIENT_HOSTNAME = socket.gethostname()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_profile.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
234	    if env == 'local':
235	        return 'http://localhost:2758'
236	    if env == 'dev':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_profile.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
236	    if env == 'dev':
237	        return 'https://commander-poc.use1.adev.bauplanlabs.com'
238	    if env == 'qa':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_profile.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
238	    if env == 'qa':
239	        return 'https://commander-poc.use1.aqa.bauplanlabs.com'
240	    return Constants.API_ENDPOINT

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_profile.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
251	    if env == 'local':
252	        return 'http://localhost:35432'
253	    if env == 'dev':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_profile.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	    if env == 'dev':
254	        return 'https://catalog.use1.adev.bauplanlabs.com'
255	    if env == 'qa':

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_profile.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
255	    if env == 'qa':
256	        return 'https://catalog.use1.aqa.bauplanlabs.com'
257	    return Constants.CATALOG_ENDPOINT

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_project_manager.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
155	        try:
156	            encrypted_value = b64encode(
157	                pem.encrypt(
158	                    # The secret value has the project_id as a prefix
159	                    f'{project_id}={value}'.encode(),
160	                    padding.OAEP(
161	                        mgf=padding.MGF1(algorithm=hashes.SHA256()), algorithm=hashes.SHA256(), label=None
162	                    ),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_project_manager.py:156
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
155	        try:
156	            encrypted_value = b64encode(
157	                pem.encrypt(
158	                    # The secret value has the project_id as a prefix
159	                    f'{project_id}={value}'.encode(),
160	                    padding.OAEP(
161	                        mgf=padding.MGF1(algorithm=hashes.SHA256()), algorithm=hashes.SHA256(), label=None
162	                    ),

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_query.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
229	            tables = []
230	            with concurrent.futures.ThreadPoolExecutor(num_threads) as executor:
231	                for reader in readers:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_query.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
427	        readers = []
428	        with concurrent.futures.ThreadPoolExecutor(num_endpoints) as executor:
429	            for e in endpoints:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan/_query.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
480	            futures = []
481	            with concurrent.futures.ThreadPoolExecutor() as executor:
482	                for reader in readers:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan_cli/__main__.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
16	    def run(self) -> int:
17	        signal.signal(signal.SIGINT, self.forward_signal_to_child)
18	        signal.signal(signal.SIGTERM, self.forward_signal_to_child)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan_cli/__main__.py:17
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
16	    def run(self) -> int:
17	        signal.signal(signal.SIGINT, self.forward_signal_to_child)
18	        signal.signal(signal.SIGTERM, self.forward_signal_to_child)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan_cli/__main__.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
17	        signal.signal(signal.SIGINT, self.forward_signal_to_child)
18	        signal.signal(signal.SIGTERM, self.forward_signal_to_child)
19	        self.child_process = subprocess.Popen(self.command)  # nosec

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bauplan-0.0.3a375-py3-none-win_amd64/bauplan_cli/__main__.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
17	        signal.signal(signal.SIGINT, self.forward_signal_to_child)
18	        signal.signal(signal.SIGTERM, self.forward_signal_to_child)
19	        self.child_process = subprocess.Popen(self.command)  # nosec

--------------------------------------------------

Code scanned:
	Total lines of code: 7874
	Total lines skipped (#nosec): 2

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 4.0
Files skipped (0):
