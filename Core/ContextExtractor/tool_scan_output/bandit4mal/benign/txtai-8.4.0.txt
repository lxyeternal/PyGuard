Run started:2025-04-12 11:23:36.121241

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/setup.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
137	    long_description_content_type="text/markdown",
138	    url="https://github.com/neuml/txtai",
139	    project_urls={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/setup.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	    project_urls={
140	        "Documentation": "https://github.com/neuml/txtai",
141	        "Issue Tracker": "https://github.com/neuml/txtai/issues",
142	        "Source Code": "https://github.com/neuml/txtai",
143	    },
144	    license="Apache 2.0: http://www.apache.org/licenses/LICENSE-2.0",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/setup.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
140	        "Documentation": "https://github.com/neuml/txtai",
141	        "Issue Tracker": "https://github.com/neuml/txtai/issues",
142	        "Source Code": "https://github.com/neuml/txtai",
143	    },
144	    license="Apache 2.0: http://www.apache.org/licenses/LICENSE-2.0",
145	    packages=find_packages(where="src/python"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/setup.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	        "Issue Tracker": "https://github.com/neuml/txtai/issues",
142	        "Source Code": "https://github.com/neuml/txtai",
143	    },
144	    license="Apache 2.0: http://www.apache.org/licenses/LICENSE-2.0",
145	    packages=find_packages(where="src/python"),
146	    package_dir={"": "src/python"},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/setup.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	    },
144	    license="Apache 2.0: http://www.apache.org/licenses/LICENSE-2.0",
145	    packages=find_packages(where="src/python"),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/ann/base.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
147	                "settings": settings,
148	                "system": f"{platform.system()} ({platform.machine()})",
149	                "txtai": __version__,

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/ann/base.py:148
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
147	                "settings": settings,
148	                "system": f"{platform.system()} ({platform.machine()})",
149	                "txtai": __version__,

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/ann/faiss.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
15	
16	if platform.system() == "Darwin":
17	    # Workaround for a Faiss issue causing segmentation faults on macOS. See txtai FAQ for more.

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/ann/faiss.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
15	
16	if platform.system() == "Darwin":
17	    # Workaround for a Faiss issue causing segmentation faults on macOS. See txtai FAQ for more.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/api/application.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
84	    # Load YAML settings
85	    config = Application.read(os.environ.get("CONFIG"))
86	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/api/responses/json.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
33	        if isinstance(o, bytes):
34	            return base64.b64encode(o).decode("utf-8")
35	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/api/responses/json.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
33	        if isinstance(o, bytes):
34	            return base64.b64encode(o).decode("utf-8")
35	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/app/base.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
63	        # Initialize member variables
64	        self.config, self.documents, self.embeddings = Application.read(config), None, None
65	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/app/base.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
170	                    if not self.pool:
171	                        self.pool = ThreadPool()
172	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/archive/tar.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
19	
20	        with tarfile.open(output, f"w:{compression}" if compression else "w") as tar:
21	            tar.add(path, arcname=".")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/archive/tar.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
26	
27	        with tarfile.open(path, f"r:{compression}" if compression else "r") as tar:
28	            # Validate paths

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/archive/zip.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
24	                    # Write file to zip
25	                    zfile.write(os.path.join(root, f), arcname=name)
26	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/cloud/hub.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
81	        with open(path, "r", encoding="utf-8") as f:
82	            content = f.read()
83	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/cloud/hub.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
91	            with tempfile.NamedTemporaryFile(mode="w", delete=False) as tmp:
92	                tmp.write(content)
93	                attributes = tmp.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/cloud/hub.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
91	            with tempfile.NamedTemporaryFile(mode="w", delete=False) as tmp:
92	                tmp.write(content)
93	                attributes = tmp.name

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/console/base.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
205	            try:
206	                return Application.read(path)
207	            # pylint: disable=W0702

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/pipeline/audio/microphone.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
115	            # Read chunk
116	            chunk, _ = stream.read(chunksize)
117	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/pipeline/data/filetohtml.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	            # Read first 1024 bytes, ignore encoding errors and strip leading/trailing whitespace
182	            content = f.read(1024)
183	            content = content.decode("ascii", errors="ignore").lower().strip()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/pipeline/data/textractor.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	            # Retrieve and write data to temporary file
117	            output.write(self.retrieve(url))
118	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/pipeline/data/textractor.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
116	            # Retrieve and write data to temporary file
117	            output.write(self.retrieve(url))
118	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/pipeline/data/textractor.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	            with open(url, "rb") as f:
135	                return f.read()
136	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/pipeline/data/textractor.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
137	        # Remote file
138	        with contextlib.closing(urlopen(Request(url, headers=self.headers))) as connection:
139	            return connection.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/pipeline/data/textractor.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
138	        with contextlib.closing(urlopen(Request(url, headers=self.headers))) as connection:
139	            return connection.read()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/pipeline/train/hfonnx.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
104	            with open(temp, "wb") as f:
105	                f.write(output.getbuffer())
106	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/scoring/tfidf.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
185	        results = []
186	        with ThreadPool(threads) as pool:
187	            for result in pool.starmap(self.search, [(x, limit) for x in queries]):

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/vectors/words.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
169	        # Convert all documents to embedding arrays, stream embeddings to disk to control memory usage
170	        with Pool(parallel, initializer=create, initargs=args) as pool:
171	            with tempfile.NamedTemporaryFile(mode="wb", suffix=".npy", delete=False) as output:

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/vectors/words.py:170
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
169	        # Convert all documents to embedding arrays, stream embeddings to disk to control memory usage
170	        with Pool(parallel, initializer=create, initargs=args) as pool:
171	            with tempfile.NamedTemporaryFile(mode="wb", suffix=".npy", delete=False) as output:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/workflow/execute.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
72	            if not self.thread:
73	                self.thread = ThreadPool(self.workers)
74	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/workflow/execute.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
79	                # Importing torch.multiprocessing will register torch shared memory serialization for cuda
80	                self.process = Pool(self.workers, context=torch.multiprocessing.get_context("spawn"))
81	

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/workflow/task/retrieve.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
57	        # Retrieve URL
58	        urlretrieve(element, path)
59	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/workflow/task/service.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
52	        if self.batch:
53	            elements = self.request(elements)
54	        else:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/workflow/task/service.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
54	        else:
55	            elements = [self.request(element) for element in elements]
56	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/workflow/task/service.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
85	        if self.method and self.method.lower() == "get":
86	            response = requests.get(self.url, params=params)
87	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/txtai-8.4.0/txtai-8.4.0/src/python/txtai/workflow/task/service.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
87	        else:
88	            response = requests.post(self.url, json=params)
89	

--------------------------------------------------

Code scanned:
	Total lines of code: 16409
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 30.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 4.0
Files skipped (0):
