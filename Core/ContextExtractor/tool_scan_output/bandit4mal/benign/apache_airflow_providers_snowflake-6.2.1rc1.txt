Run started:2025-04-12 14:50:19.277365

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/get_provider_info.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        "name": "Snowflake",
28	        "description": "`Snowflake <https://www.snowflake.com/>`__\n",
29	        "integrations": [
30	            {
31	                "integration-name": "Snowflake",
32	                "external-doc-url": "https://snowflake.com/",
33	                "how-to-guide": [
34	                    "/docs/apache-airflow-providers-snowflake/operators/snowflake.rst",
35	                    "/docs/apache-airflow-providers-snowflake/operators/snowpark.rst",
36	                ],
37	                "logo": "/docs/integration-logos/Snowflake.png",
38	                "tags": ["service"],
39	            }
40	        ],
41	        "operators": [
42	            {
43	                "integration-name": "Snowflake",
44	                "python-modules": [
45	                    "airflow.providers.snowflake.operators.snowflake",
46	                    "airflow.providers.snowflake.operators.snowpark",
47	                ],
48	            }
49	        ],
50	        "task-decorators": [
51	            {
52	                "class-name": "airflow.providers.snowflake.decorators.snowpark.snowpark_task",
53	                "name": "snowpark",
54	            }
55	        ],
56	        "hooks": [
57	            {
58	                "integration-name": "Snowflake",
59	                "python-modules": [
60	                    "airflow.providers.snowflake.hooks.snowflake",
61	                    "airflow.providers.snowflake.hooks.snowflake_sql_api",
62	                ],
63	            }
64	        ],
65	        "transfers": [
66	            {
67	                "source-integration-name": "Amazon Simple Storage Service (S3)",
68	                "target-integration-name": "Snowflake",
69	                "python-module": "airflow.providers.snowflake.transfers.copy_into_snowflake",
70	                "how-to-guide": "/docs/apache-airflow-providers-snowflake/operators/copy_into_snowflake.rst",
71	            },
72	            {
73	                "source-integration-name": "Google Cloud Storage (GCS)",
74	                "target-integration-name": "Snowflake",
75	                "python-module": "airflow.providers.snowflake.transfers.copy_into_snowflake",
76	            },
77	            {
78	                "source-integration-name": "Microsoft Azure Blob Storage",
79	                "target-integration-name": "Snowflake",
80	                "python-module": "airflow.providers.snowflake.transfers.copy_into_snowflake",
81	            },
82	        ],
83	        "connection-types": [
84	            {
85	                "hook-class-name": "airflow.providers.snowflake.hooks.snowflake.SnowflakeHook",
86	                "connection-type": "snowflake",
87	            }
88	        ],
89	        "triggers": [
90	            {
91	                "integration-name": "Snowflake",
92	                "python-modules": ["airflow.providers.snowflake.triggers.snowflake_trigger"],
93	            }
94	        ],
95	    }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/get_provider_info.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	                "integration-name": "Snowflake",
32	                "external-doc-url": "https://snowflake.com/",
33	                "how-to-guide": [
34	                    "/docs/apache-airflow-providers-snowflake/operators/snowflake.rst",
35	                    "/docs/apache-airflow-providers-snowflake/operators/snowpark.rst",
36	                ],
37	                "logo": "/docs/integration-logos/Snowflake.png",
38	                "tags": ["service"],
39	            }
40	        ],
41	        "operators": [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	
107	        private_key_file = conn.extra_dejson.get(
108	            "extra__snowflake__private_key_file"
109	        ) or conn.extra_dejson.get("private_key_file")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	            "extra__snowflake__private_key_file"
109	        ) or conn.extra_dejson.get("private_key_file")
110	        private_key_content = conn.extra_dejson.get(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	        ) or conn.extra_dejson.get("private_key_file")
110	        private_key_content = conn.extra_dejson.get(
111	            "extra__snowflake__private_key_content"
112	        ) or conn.extra_dejson.get("private_key_content")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	            "extra__snowflake__private_key_content"
112	        ) or conn.extra_dejson.get("private_key_content")
113	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
179	        }
180	        response = requests.post(url, json=data, headers=headers, params=params)
181	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	        if all(
202	            [conn_config.get("refresh_token"), conn_config.get("client_id"), conn_config.get("client_secret")]
203	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	        if all(
202	            [conn_config.get("refresh_token"), conn_config.get("client_id"), conn_config.get("client_secret")]
203	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	        if all(
202	            [conn_config.get("refresh_token"), conn_config.get("client_id"), conn_config.get("client_secret")]
203	        ):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	            "refresh_token": conn_config["refresh_token"],
242	            "redirect_uri": conn_config.get("redirect_uri", "https://localhost.com"),
243	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
241	            "refresh_token": conn_config["refresh_token"],
242	            "redirect_uri": conn_config.get("redirect_uri", "https://localhost.com"),
243	        }

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
243	        }
244	        response = requests.post(
245	            url,
246	            data=data,
247	            headers={
248	                "Content-Type": "application/x-www-form-urlencoded",
249	            },
250	            auth=HTTPBasicAuth(conn_config["client_id"], conn_config["client_secret"]),  # type: ignore[arg-type]
251	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
280	            try:
281	                response = requests.get(url, headers=header, params=params)
282	                response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
294	        elif status_code == 200:
295	            if resp_statement_handles := resp.get("statementHandles"):
296	                statement_handles = resp_statement_handles

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
296	                statement_handles = resp_statement_handles
297	            elif resp_statement_handle := resp.get("statementHandle"):
298	                statement_handles = [resp_statement_handle]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
316	        header, params, url = self.get_request_url_header_params(query_id)
317	        response = requests.get(url, params=params, headers=header)
318	        status_code = response.status_code

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/hooks/snowflake_sql_api.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
331	            aiohttp.ClientSession(headers=header) as session,
332	            session.get(url, params=params) as response,
333	        ):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/utils/sql_api_generate_jwt.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
171	        # Base64-encode the value and prepend the prefix 'SHA256:'.
172	        public_key_fp = "SHA256:" + base64.b64encode(sha256hash.digest()).decode("utf-8")
173	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/src/airflow/providers/snowflake/utils/sql_api_generate_jwt.py:172
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
171	        # Base64-encode the value and prepend the prefix 'SHA256:'.
172	        public_key_fp = "SHA256:" + base64.b64encode(sha256hash.digest()).decode("utf-8")
173	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/tests/unit/snowflake/hooks/test_snowflake_sql_api.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
305	        params = {"requestId": str(req_id), "page": 2, "pageSize": 10}
306	        mock_geturl_header_params.return_value = HEADERS, params, "https://test/airflow/"
307	        hook = SnowflakeSqlApiHook("mock_conn_id")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/tests/unit/snowflake/hooks/test_snowflake_sql_api.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
308	        with mock.patch.object(hook.log, "error"), RequestsMock() as requests_mock:
309	            requests_mock.get(url="https://test/airflow/", json={"foo": "bar"}, status=500)
310	            with pytest.raises(AirflowException, match='Response: {"foo": "bar"}, Status Code: 500'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/tests/unit/snowflake/hooks/test_snowflake_sql_api.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
308	        with mock.patch.object(hook.log, "error"), RequestsMock() as requests_mock:
309	            requests_mock.get(url="https://test/airflow/", json={"foo": "bar"}, status=500)
310	            with pytest.raises(AirflowException, match='Response: {"foo": "bar"}, Status Code: 500'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/tests/unit/snowflake/hooks/test_snowflake_sql_api.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
324	        assert header == HEADERS
325	        assert url == "https://airflow.af_region.snowflakecomputing.com/api/v2/statements/uuid"
326	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/tests/unit/snowflake/hooks/test_snowflake_sql_api.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
372	                "refresh_token": CONN_PARAMS_OAUTH["refresh_token"],
373	                "redirect_uri": "https://localhost.com",
374	            },
375	            headers={"Content-Type": "application/x-www-form-urlencoded"},
376	            auth=BASIC_AUTH,
377	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/tests/unit/snowflake/hooks/test_snowflake_sql_api.py:638
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
637	        hook = SnowflakeSqlApiHook(snowflake_conn_id="test_conn", **hook_params)
638	        assert hook.database == hook_params.get("database", None)
639	        assert hook.schema == hook_params.get("schema", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/tests/unit/snowflake/hooks/test_snowflake_sql_api.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
638	        assert hook.database == hook_params.get("database", None)
639	        assert hook.schema == hook_params.get("schema", None)
640	        assert hook.warehouse == hook_params.get("warehouse", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/tests/unit/snowflake/hooks/test_snowflake_sql_api.py:640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
639	        assert hook.schema == hook_params.get("schema", None)
640	        assert hook.warehouse == hook_params.get("warehouse", None)
641	        assert hook.role == hook_params.get("role", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/apache_airflow_providers_snowflake-6.2.1rc1/apache_airflow_providers_snowflake-6.2.1rc1/tests/unit/snowflake/hooks/test_snowflake_sql_api.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
640	        assert hook.warehouse == hook_params.get("warehouse", None)
641	        assert hook.role == hook_params.get("role", None)
642	

--------------------------------------------------

Code scanned:
	Total lines of code: 6255
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 1.0
Files skipped (0):
