Run started:2025-04-12 14:21:19.675788

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/_metakernel.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	            'text': "MetaKernel Magics",
87	            'url': "https://metakernel.readthedocs.io/en/latest/source/README.html",
88	        },
89	    ]
90	    language_info = {

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/_metakernel.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
457	        with open(self.hist_file) as fid:
458	            self.hist_cache = json.loads(fid.read() or "[]")
459	        return {'status': 'ok', 'history': [(None, None, h) for h in self.hist_cache]}

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/_metakernel.py:872
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
871	                        with open(os.path.join(dirname, filename), 'wb') as f:
872	                            f.write(data)
873	                    try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/_metakernel.py:988
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
987	        """
988	        sys.stderr.write(format_message(*objects, **kwargs))
989	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/_metakernel.py:993
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
992	        """
993	        sys.stdout.write(format_message(*objects, **kwargs))
994	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magic.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
22	        if msg:
23	            sys.stderr.write(msg)
24	        raise Exception(msg)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magic.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
119	                if filename and os.path.exists(filename):
120	                    with open(filename) as f: return f.read()
121	                else:

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/activity_magic.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
73	        self.results_html.layout.visibility = "hidden"
74	        self.results_button.layout.visibility = "visible" if (getpass.getuser() in self.instructors) else "hidden"
75	        self.prev_button.disabled = index == 0

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/activity_magic.py:74
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
73	        self.results_html.layout.visibility = "hidden"
74	        self.results_button.layout.visibility = "visible" if (getpass.getuser() in self.instructors) else "hidden"
75	        self.prev_button.disabled = index == 0

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/activity_magic.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
166	        with portalocker.Lock(self.results_filename, "a+") as g:
167	            g.write("%s::%s::%s::%s\n" % (self.id, getpass.getuser(), datetime.datetime.today(), sender.description))
168	            g.flush()

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/activity_magic.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
166	        with portalocker.Lock(self.results_filename, "a+") as g:
167	            g.write("%s::%s::%s::%s\n" % (self.id, getpass.getuser(), datetime.datetime.today(), sender.description))
168	            g.flush()

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/activity_magic.py:167
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
166	        with portalocker.Lock(self.results_filename, "a+") as g:
167	            g.write("%s::%s::%s::%s\n" % (self.id, getpass.getuser(), datetime.datetime.today(), sender.description))
168	            g.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/activity_magic.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
294	        with open(filename, "w") as fp:
295	            fp.write(self.code)
296	        activity = Activity()

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/activity_magic.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
298	        # Make sure results file is writable:
299	        os.chmod(activity.results_filename, 0o777)
300	        # Ok, let's test it (MetaKernel):

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/activity_magic.py:299
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
298	        # Make sure results file is writable:
299	        os.chmod(activity.results_filename, 0o777)
300	        # Ok, let's test it (MetaKernel):

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/blockly_magic.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
64	                    urlopen = urllib.urlopen
65	                page_template = urlopen(page_from_origin).read().decode("utf-8")
66	            else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/blockly_magic.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	        else:
85	            self.kernel.Display(IFrame("https://developers-dot-devsite-v2-prod.appspot.com/blockly/blockly-demo/blockly-demo", width='100%', height=height))
86	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/conversation_magic.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	        """
15	        html = """
16	<div id="disqus_thread"></div>
17	<script>
18	(function() { // DON'T EDIT BELOW THIS LINE
19	    var d = document, s = d.createElement('script');
20	    s.src = '//%s.disqus.com/embed.js';
21	    s.setAttribute('data-timestamp', +new Date());
22	    (d.head || d.body).appendChild(s);
23	})();
24	</script>
25	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
26	""" % id
27	        self.kernel.Display(HTML(html))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/debug_magic.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	
25	        html_code = """
26	<style type="text/css">
27	      .breakpoints {width: 1.5em;}
28	      .styled-background { background-color: #ff7; }
29	</style>
30	
31	<div class="animation" align="left" width="400">
32	  <button onclick="step()">Step</button>
33	  <button onclick="play()">Play</button>
34	  <button onclick="pause()">Pause</button>
35	  <button onclick="stop()">Stop</button>
36	  <button onclick="clear_breakpoints()">Clear Breakpoints</button>
37	  <button onclick="reset()">Reset</button><br/>
38	  Speed: <input type="range" id="speed" min="1" max="100"/>
39	  Inspect: <input type="text" id="inspect" onkeydown="if (event.keyCode == 13) inspector()"/>
40	  <table width="100%">
41	  <tr>
42	    <td width="50%" style="vertical-align: top"><div id="result_stream"/></td>
43	    <td width="50%" style="vertical-align: top"><div id="result_output"/></td>
44	  </tr>
45	  </table>
46	</div>
47	
48	<script>
49	
50	function inspector() {
51	    var v = document.getElementById("inspect").value;
52	    document.getElementById("inspect").value = "";
53	    var msg_id = kernel.execute("~~META~~: inspect " + v,
54	                                callbacks,
55	                                {silent: false});
56	}
57	
58	function clear_breakpoints() {
59	    for (var n = 0 ; n < cell.code_mirror.doc.size; n++) {
60	        cell.code_mirror.setGutterMarker(n, "breakpoints", null);
61	    }
62	}
63	
64	function makeMarker() {
65	    var marker = document.createElement("div");
66	    marker.style.color = "#822";
67	    marker.innerHTML = "â—";
68	    return marker;
69	}
70	
71	function breakpoint_q(line) {
72	    var info = cell.code_mirror.lineInfo(line - 1);
73	    return (info && info.gutterMarkers != null);
74	}
75	
76	var cell = IPython.notebook.get_selected_cell();
77	if (cell) {
78	    // The following can be replaced once get_prev_cell is fixed
79	    // see https://github.com/ipython/ipython/pull/6565
80	    var index = IPython.notebook.find_cell_index(cell);
81	    cell = IPython.notebook.get_cell(index - 1);
82	    cell.code_mirror.setOption("lineNumbers", true);
83	    if (cell.code_mirror.getOption("gutters").length < 2) {
84	        cell.code_mirror.setOption("gutters", ["CodeMirror-linenumbers", "breakpoints"]);
85	        cell.code_mirror.refresh();
86	        cell.code_mirror.on("gutterClick", function(cm, n) {
87	          var info = cm.lineInfo(n);
88	          cm.setGutterMarker(n, "breakpoints", info.gutterMarkers ? null : makeMarker());
89	        });
90	    }
91	}
92	
93	var mt;
94	var i;
95	
96	function highlight(cell, data) {
97	    if (cell) {
98	        var line1 = data[0];
99	        var col1 = data[1];
100	        var line2 = data[2];
101	        var col2 = data[3];
102	        if (mt) {
103	            mt.clear();
104	        }
105	        mt = cell.code_mirror.markText({line: line1 - 1, ch: col1 - 1},
106	                                       {line: line2 - 1, ch: col2 },
107	                                       {className: "styled-background"});
108	    }
109	}
110	
111	var running = false;  // is it running?
112	var timer = null;
113	var kernel = IPython.notebook.kernel;
114	
115	function handle_output(out){
116	    var res = null;
117	    var data = null;
118	    if (out.msg_type == "stream") {
119	        res = out.content.text;
120	        document.getElementById("result_stream").innerText = res.toString() + document.getElementById("result_stream").innerText;
121	    } else if (out.msg_type === "pyout") {
122	        // if output is a python object
123	        res = out.content.data["text/plain"];
124	        document.getElementById("result_stream").innerText = res.toString() + document.getElementById("result_stream").innerText;
125	    } else if (out.msg_type == "pyerr") {
126	        // if output is a python error
127	        res = out.content.data["text/plain"];
128	        document.getElementById("result_stream").innerText = res.toString() + document.getElementById("result_stream").innerText;
129	    } else if (out.msg_type == "execute_result") {
130	        var str = out.content.data["text/plain"];
131	        if (str.indexOf("\\"highlight: ") >= 0) { // is a highlight response:
132	            data = JSON.parse(str.substring(12, str.length - 1));
133	            var speed = Number(document.getElementById("speed").value);
134	            if (data) {
135	                var breakp = breakpoint_q(data[0]);
136	                if (speed < 100 || !running || breakp) { // max_speed
137	                    highlight(cell, data);
138	                }
139	            }
140	            if (running) {
141	                if (data && breakpoint_q(data[0])) {
142	                    pause();
143	                } else {
144	                    timer = setTimeout(step, 2000/speed);
145	                }
146	            }
147	        } else { // display result
148	            res = str;
149	            if (res.indexOf("u") == 0)
150	                res = res.substring(2, res.length - 1) + "\\n";
151	            if (res) {
152	                document.getElementById("result_output").innerText = res.toString() + document.getElementById("result_output").innerText;
153	            }
154	        }
155	    } else {
156	        // if output is something we haven't thought of
157	        res = out.toString();
158	        document.getElementById("result_stream").innerText = res.toString() + document.getElementById("result_stream").innerText;
159	    }
160	}
161	
162	var callbacks = { 'iopub' : {'output' : handle_output}};
163	
164	function pause() {
165	    running = false;
166	    document.getElementById("result_output").innerText = "Pause\\n" + document.getElementById("result_output").innerText;
167	    if (timer) {
168	        clearInterval(timer);
169	        timer = null;
170	    }
171	}
172	
173	function play() {
174	    pause();
175	    running = true;
176	    step();
177	}
178	
179	function step() {
180	    var msg_id = kernel.execute("~~META~~: step",
181	                                callbacks,
182	                                {silent: false});
183	}
184	
185	function stop() {
186	    pause();
187	    if (mt) {
188	        mt.clear();
189	    }
190	    var msg_id = kernel.execute("~~META~~: stop",
191	                                callbacks,
192	                                {silent: false});
193	}
194	
195	function reset() {
196	    stop();
197	    document.getElementById("result_output").innerText = "";
198	    document.getElementById("result_stream").innerText = "";
199	    var msg_id = kernel.execute("~~META~~: reset",
200	                                callbacks,
201	                                {silent: false});
202	}
203	
204	</script>
205	"""
206	        import time

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/download_magic.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
20	    def download(url, filename):
21	        g = urllib.request.urlopen(url)
22	        with open(filename, 'wb') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/download_magic.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
22	        with open(filename, 'wb') as f:
23	            f.write(g.read())        
24	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/download_magic.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	        with open(filename, 'wb') as f:
23	            f.write(g.read())        
24	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/edit_magic.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
26	        filename = os.path.abspath(filename)
27	        with open(filename) as f: text = f.read()
28	        self.kernel.payload.append({"source": "set_next_input",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/file_magic.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	                fp = open(filename, "w")
51	            fp.write(self.code)
52	            fp.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/include_magic.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
29	            filename = os.path.abspath(filename)
30	            with open(filename) as f: text += f.read() + "\n"
31	        if self.code.lstrip().startswith(prefix):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/install_magic.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        if package == "calico-publish":
18	            self.kernel.do_execute("!ipython install-nbextension https://bitbucket.org/ipre/calico/raw/master/notebooks/nbextensions/calico-publish.js")
19	        elif package == "calico-spell-check":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/install_magic.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        elif package == "calico-spell-check":
20	            self.kernel.do_execute("!ipython install-nbextension https://bitbucket.org/ipre/calico/downloads/calico-spell-check-1.0.zip")
21	        elif package == "calico-cell-tools":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/install_magic.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        elif package == "calico-cell-tools":
22	            self.kernel.do_execute("!ipython install-nbextension https://bitbucket.org/ipre/calico/downloads/calico-cell-tools-1.0.zip")
23	        elif package == "calico-document-tools":

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/install_magic.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        elif package == "calico-document-tools":
24	            self.kernel.do_execute("!ipython install-nbextension https://bitbucket.org/ipre/calico/downloads/calico-document-tools-1.0.zip")
25	        self.enable_extension(package)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/install_magic.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
34	        filename = os.path.abspath(filename)
35	        text = open(filename).read()
36	        if ('IPython.load_extensions("%s");' % name) in text:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/install_magic.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
49	        with open(filename, "w") as fp:
50	            fp.write(text)
51	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/install_magic_magic.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
18	    def download(url, filename):
19	        g = urllib.request.urlopen(url)
20	        with open(filename, 'wb') as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/install_magic_magic.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
20	        with open(filename, 'wb') as f:
21	            f.write(g.read())
22	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/install_magic_magic.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	        with open(filename, 'wb') as f:
21	            f.write(g.read())
22	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/jigsaw_magic.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
17	def download(url):
18	    g = urlopen(url)
19	    return g.read().decode("utf-8")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/jigsaw_magic.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
18	    g = urlopen(url)
19	    return g.read().decode("utf-8")
20	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/jigsaw_magic.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        workspace_filename = workspace + ".xml"
47	        html_text = download("https://calysto.github.io/jigsaw/" + language + ".html")
48	        html_filename = workspace + ".html"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/jigsaw_magic.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
50	        with open(html_filename, "w") as fp:
51	            fp.write(html_text)
52	        # Display iframe:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/load_magic.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	            self.kernel.payload.append({"source": "set_next_input",
24	                                        "text": f.read()})
25	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/macro_magic.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
115	            try:
116	                with open(macro_file) as mf: data = ast.literal_eval(mf.read())
117	            except:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/macro_magic.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
123	        filename = os.path.join(local_macros_dir, "macros.json")
124	        with open(filename, "w") as macros: macros.write(str(self.learned))
125	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/python_magic.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
20	            block.body.append(last)
21	            retval = exec(compile(block, "python cell", mode="exec"), env)
22	        else:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/python_magic.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
22	        else:
23	            exec(compile(block, "python cell", mode="exec"), env)
24	            retval = eval(compile(ast.Expression(last.value),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/tests/test_download_magic.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	    kernel = get_kernel(EvalKernel)
11	    kernel.do_execute("%download --filename TEST.txt https://raw.githubusercontent.com/calysto/metakernel/main/LICENSE.txt")
12	    text = get_log_text(kernel)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/tests/test_download_magic.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	    kernel.do_execute("%download https://raw.githubusercontent.com/calysto/metakernel/main/LICENSE.txt")
19	    text = get_log_text(kernel)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/tests/test_file_magic.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
45	    import shutil
46	    shutil.rmtree("/tmp/tmp", ignore_errors=True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/tests/test_install_magic_magic.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    kernel = get_kernel(EvalKernel)
16	    kernel.do_execute("%install_magic https://raw.githubusercontent.com/calysto/metakernel/main/metakernel/magics/cd_magic.py")
17	    text = get_log_text(kernel)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/magics/tutor_magic.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	        
72	        url = "https://pythontutor.com/iframe-embed.html#code="
73	        url += quote(self.code)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/pexpect.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
40	            try:
41	                sig = signal.signal(signal.SIGINT, signal.SIG_DFL)
42	            except ValueError:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/pexpect.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
40	            try:
41	                sig = signal.signal(signal.SIGINT, signal.SIG_DFL)
42	            except ValueError:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/pexpect.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
51	            if sig:
52	                signal.signal(signal.SIGINT, sig)
53	    return child

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/pexpect.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
51	            if sig:
52	                signal.signal(signal.SIGINT, sig)
53	    return child

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/tests/test_metakernel.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
94	    with open(kernel.hist_file, 'rb') as fid:
95	        text = fid.read().decode('utf-8', 'replace')
96	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/tests/test_replwrap.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
78	
79	        if platform.system() == 'Darwin':
80	            raise unittest.SkipTest("This test fails on macOS because of REPL differences")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/tests/test_replwrap.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
78	
79	        if platform.system() == 'Darwin':
80	            raise unittest.SkipTest("This test fails on macOS because of REPL differences")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/tests/test_replwrap.py:79
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
78	
79	        if platform.system() == 'Darwin':
80	            raise unittest.SkipTest("This test fails on macOS because of REPL differences")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/metakernel-0.30.3/metakernel-0.30.3/metakernel/tests/utils.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	    try:
59	        _ = requests.head('http://google.com', timeout=3)
60	        return True

--------------------------------------------------

Code scanned:
	Total lines of code: 5985
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 35.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 49.0
		High: 8.0
Files skipped (0):
