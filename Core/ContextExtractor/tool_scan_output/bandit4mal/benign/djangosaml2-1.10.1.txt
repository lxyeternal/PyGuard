Run started:2025-04-12 11:22:09.659745

Test results:
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/conf.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
47	    conf = SPConfig()
48	    conf.load(copy.deepcopy(settings.SAML_CONFIG))
49	    return conf

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
146	    def b64_for_post(self, xml_text, encoding="utf-8"):
147	        return base64.b64encode(xml_text.encode(encoding)).decode("ascii")
148	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:147
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
146	    def b64_for_post(self, xml_text, encoding="utf-8"):
147	        return base64.b64encode(xml_text.encode(encoding)).decode("ascii")
148	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
154	        )
155	        idp_id = "https://idp.example.com/simplesaml/saml2/idp/metadata.php"
156	        self.assertEqual(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
207	        self.assertIn(
208	            "AuthnRequest xmlns", base64.b64decode(saml_request).decode("utf-8")
209	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:208
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
207	        self.assertIn(
208	            "AuthnRequest xmlns", base64.b64decode(saml_request).decode("utf-8")
209	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
227	                    response = self.client.get(
228	                        reverse("saml2_login") + "?next=http://evil.com"
229	                    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
237	                    response = self.client.get(
238	                        reverse("saml2_login") + "?next=http://evil.com"
239	                    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
287	                        response = self.client.get(
288	                            reverse("saml2_login") + "?next=http://evil.com"
289	                        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
299	                        response = self.client.get(
300	                            reverse("saml2_login") + "?next=http://evil.com"
301	                        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
311	        response = self.client.get(
312	            reverse("saml2_login") + "?idp=<b>https://unknown.org</b>"
313	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
314	        self.assertContains(
315	            response, "&lt;b&gt;https://unknown.org&lt;/b&gt;", status_code=403
316	        )
317	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
405	        for i in range(1, 4):
406	            link = "/login/?idp=https://idp%d.example.com/simplesaml/saml2/idp/metadata.php&next=/"
407	            self.assertContains(response, link % i)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
412	            {
413	                "idp": "https://idp2.example.com/simplesaml/saml2/idp/metadata.php",
414	                "next": "/",
415	            },
416	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
443	        response = self.client.get(reverse("saml2_login"))
444	        saml2_req = saml2_from_httpredirect_request(response.url)
445	        session_id = get_session_id_from_saml2(saml2_req)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:479
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
478	        response = client.get(reverse("saml2_login"))
479	        saml2_req = saml2_from_httpredirect_request(response.url)
480	        session_id = get_session_id_from_saml2(saml2_req)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
511	        response = self.client.get(reverse("saml2_login"))
512	        saml2_req = saml2_from_httpredirect_request(response.url)
513	        session_id = get_session_id_from_saml2(saml2_req)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
560	        response = self.client.get(reverse("saml2_login"))
561	        saml2_req = saml2_from_httpredirect_request(response.url)
562	        session_id = get_session_id_from_saml2(saml2_req)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:610
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
609	        response = self.client.get(reverse("saml2_login"))
610	        saml2_req = saml2_from_httpredirect_request(response.url)
611	        session_id = get_session_id_from_saml2(saml2_req)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
642	        middleware = SamlSessionMiddleware(dummy_get_response)
643	        middleware.process_request(request)
644	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:664
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
663	        middleware = SamlSessionMiddleware(dummy_get_response)
664	        middleware.process_request(request)
665	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:738
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
737	        # now simulate a logout response sent by the idp
738	        expected_request = """<samlp:LogoutRequest xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" ID="XXXXXXXXXXXXXXXXXXXXXX" Version="2.0" Destination="https://idp.example.com/simplesaml/saml2/idp/SingleLogoutService.php" Reason=""><saml:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://sp.example.com/saml2/metadata/</saml:Issuer><saml:NameID SPNameQualifier="http://sp.example.com/saml2/metadata/" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient">1f87035b4c1325b296a53d92097e6b3fa36d7e30ee82e3fcb0680d60243c1f03</saml:NameID><samlp:SessionIndex>a0123456789abcdef0123456789abcdef</samlp:SessionIndex></samlp:LogoutRequest>"""
739	
740	        request_id = re.findall(r' ID="(.*?)" ', expected_request)[0]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
742	
743	        saml_response = """<?xml version='1.0' encoding='UTF-8'?>
744	<samlp:LogoutResponse xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" Destination="http://sp.example.com/saml2/ls/" ID="a140848e7ce2bce834d7264ecdde0151" InResponseTo="{}" IssueInstant="{}" Version="2.0"><saml:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">https://idp.example.com/simplesaml/saml2/idp/metadata.php</saml:Issuer><samlp:Status><samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></samlp:Status></samlp:LogoutResponse>""".format(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
767	        instant = datetime.datetime.now().strftime("%Y-%m-%dT%H:%M:%SZ")
768	        saml_request = """<?xml version='1.0' encoding='UTF-8'?>
769	<samlp:LogoutRequest xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" ID="_9961abbaae6d06d251226cb25e38bf8f468036e57e" Version="2.0" IssueInstant="{}" Destination="http://sp.example.com/saml2/ls/"><saml:Issuer>https://idp.example.com/simplesaml/saml2/idp/metadata.php</saml:Issuer><saml:NameID SPNameQualifier="http://sp.example.com/saml2/metadata/" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient">{}</saml:NameID><samlp:SessionIndex>_1837687b7bc9faad85839dbeb319627889f3021757</samlp:SessionIndex></samlp:LogoutRequest>""".format(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:810
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
809	        # now simulate a logout response sent by the idp
810	        expected_request = """<samlp:LogoutRequest xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" ID="XXXXXXXXXXXXXXXXXXXXXX" Version="2.0" Destination="https://idp.example.com/simplesaml/saml2/idp/SingleLogoutService.php" Reason=""><saml:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://sp.example.com/saml2/metadata/</saml:Issuer><saml:NameID SPNameQualifier="http://sp.example.com/saml2/metadata/" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient">1f87035b4c1325b296a53d92097e6b3fa36d7e30ee82e3fcb0680d60243c1f03</saml:NameID><samlp:SessionIndex>a0123456789abcdef0123456789abcdef</samlp:SessionIndex></samlp:LogoutRequest>"""
811	
812	        request_id = re.findall(r' ID="(.*?)" ', expected_request)[0]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
814	
815	        saml_response = """<?xml version='1.0' encoding='UTF-8'?>
816	<samlp:LogoutResponse xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" Destination="http://sp.example.com/saml2/ls/" ID="a140848e7ce2bce834d7264ecdde0151" InResponseTo="{}" IssueInstant="{}" Version="2.0"><saml:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">https://idp.example.com/simplesaml/saml2/idp/metadata.php</saml:Issuer><samlp:Status><samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" /></samlp:Status></samlp:LogoutResponse>""".format(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
837	        instant = datetime.datetime.now().strftime("%Y-%m-%dT%H:%M:%SZ")
838	        saml_request = '<samlp:LogoutRequest xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" ID="_9961abbaae6d06d251226cb25e38bf8f468036e57e" Version="2.0" IssueInstant="{}" Destination="http://sp.example.com/saml2/ls/"><saml:Issuer>https://idp.example.com/simplesaml/saml2/idp/metadata.php</saml:Issuer><saml:NameID SPNameQualifier="http://sp.example.com/saml2/metadata/" Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient">{}</saml:NameID><samlp:SessionIndex>_1837687b7bc9faad85839dbeb319627889f3021757</samlp:SessionIndex></samlp:LogoutRequest>'.format(
839	            instant, "invalid-subject-id"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:900
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
899	        self.assertEqual(response.status_code, 302)
900	        self.assertIn("https://that-ds.org/ds", response.url)
901	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:890
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
889	
890	    @override_settings(SAML2_DISCO_URL="https://that-ds.org/ds")
891	    def test_discovery_service(self):

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
904	    config = SPConfig()
905	    config.load({"entityid": "testentity"})
906	    return config

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:911
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
910	    config = SPConfig()
911	    config.load({"entityid": "testentity_callable"})
912	    return config

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
916	    config = SPConfig()
917	    config.load(
918	        conf.create_conf(
919	            sp_host="sp.example.com",
920	            idp_hosts=["idp.example.com"],
921	            metadata_file="remote_metadata_one_idp.xml",
922	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
946	        middleware = SamlSessionMiddleware(dummy_get_response)
947	        middleware.process_request(request)
948	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:997
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
996	            middleware = SamlSessionMiddleware(dummy_get_response)
997	            middleware.process_request(request)
998	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:1026
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1025	            middleware = SamlSessionMiddleware(dummy_get_response)
1026	            middleware.process_request(request)
1027	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/__init__.py:1056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1055	            middleware = SamlSessionMiddleware(dummy_get_response)
1056	            middleware.process_request(request)
1057	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/auth_response.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	    uid,
22	    audience="http://sp.example.com/saml2/metadata/",
23	    acs_url="http://sp.example.com/saml2/acs/",
24	    metadata_url="http://sp.example.com/saml2/metadata/",
25	    attribute_statements=None,
26	):
27	    """Generates a fresh signed authentication response
28	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/auth_response.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    audience="http://sp.example.com/saml2/metadata/",
23	    acs_url="http://sp.example.com/saml2/acs/",
24	    metadata_url="http://sp.example.com/saml2/metadata/",
25	    attribute_statements=None,
26	):
27	    """Generates a fresh signed authentication response
28	
29	    Params:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/auth_response.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    acs_url="http://sp.example.com/saml2/acs/",
24	    metadata_url="http://sp.example.com/saml2/metadata/",
25	    attribute_statements=None,
26	):
27	    """Generates a fresh signed authentication response
28	
29	    Params:
30	        session_id: The session ID to generate the reponse for. Login set an

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/auth_response.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	    saml_response_tpl = (
59	        "<?xml version='1.0' encoding='UTF-8'?>"
60	        '<samlp:Response xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Destination="%(acs_url)s" ID="id-88b9f586a2a3a639f9327485cc37c40a" InResponseTo="%(session_id)s" IssueInstant="%(timestamp)s" Version="2.0">'
61	        '<saml:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">'
62	        "https://idp.example.com/simplesaml/saml2/idp/metadata.php"
63	        "</saml:Issuer>"
64	        "<samlp:Status>"
65	        '<samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success" />'
66	        "</samlp:Status>"
67	        '<saml:Assertion ID="id-093952102ceb73436e49cb91c58b0578" IssueInstant="%(timestamp)s" Version="2.0">'
68	        '<saml:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">'
69	        "https://idp.example.com/simplesaml/saml2/idp/metadata.php"
70	        "</saml:Issuer>"
71	        "<saml:Subject>"
72	        '<saml:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" NameQualifier="" SPNameQualifier="%(metadata_url)s">'
73	        "1f87035b4c1325b296a53d92097e6b3fa36d7e30ee82e3fcb0680d60243c1f03"
74	        "</saml:NameID>"
75	        '<saml:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer">'
76	        '<saml:SubjectConfirmationData InResponseTo="%(session_id)s" NotOnOrAfter="%(tomorrow)s" Recipient="%(acs_url)s" />'
77	        "</saml:SubjectConfirmation>"
78	        "</saml:Subject>"
79	        '<saml:Conditions NotBefore="%(yesterday)s" NotOnOrAfter="%(tomorrow)s">'
80	        "<saml:AudienceRestriction>"
81	        "<saml:Audience>"
82	        "%(audience)s"
83	        "</saml:Audience>"
84	        "</saml:AudienceRestriction>"
85	        "</saml:Conditions>"
86	        '<saml:AuthnStatement AuthnInstant="%(timestamp)s" SessionIndex="%(session_id)s">'
87	        "<saml:AuthnContext>"
88	        "<saml:AuthnContextClassRef>"
89	        "urn:oasis:names:tc:SAML:2.0:ac:classes:Password"
90	        "</saml:AuthnContextClassRef>"
91	        "</saml:AuthnContext>"
92	        "</saml:AuthnStatement>"
93	        "%(attribute_statements)s"
94	        "</saml:Assertion>"
95	        "</samlp:Response>"
96	    )
97	    return saml_response_tpl % {
98	        "session_id": session_id,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/conf.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	        "xmlsec_binary": xmlsec_path,
44	        "entityid": "http://%s/saml2/metadata/" % sp_host,
45	        "attribute_map_dir": os.path.join(BASEDIR, "attribute-maps"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/conf.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	                    "assertion_consumer_service": [
52	                        ("http://%s/saml2/acs/" % sp_host, saml2.BINDING_HTTP_POST),
53	                    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/conf.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	                    "single_logout_service": [
55	                        ("http://%s/saml2/ls/" % sp_host, saml2.BINDING_HTTP_REDIRECT),
56	                    ],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/conf.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	            "display_name": [("Ejemplo", "es"), ("Example", "en")],
91	            "url": [("http://www.example.es", "es"), ("http://www.example.com", "en")],
92	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/conf.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	            "display_name": [("Ejemplo", "es"), ("Example", "en")],
91	            "url": [("http://www.example.es", "es"), ("http://www.example.com", "en")],
92	        },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/conf.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
101	    for idp in idp_hosts:
102	        entity_id = "https://%s/simplesaml/saml2/idp/metadata.php" % idp
103	        config["service"]["sp"]["idp"][entity_id] = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/conf.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	            "single_sign_on_service": {
105	                saml2.BINDING_HTTP_REDIRECT: "https://%s/simplesaml/saml2/idp/SSOService.php"
106	                % idp,
107	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/tests/conf.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	            "single_logout_service": {
109	                saml2.BINDING_HTTP_REDIRECT: "https://%s/simplesaml/saml2/idp/SingleLogoutService.php"
110	                % idp,
111	            },

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/utils.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
141	
142	    inflated_saml2req = base64.b64decode(b64_inflated_saml2req)
143	    deflated_saml2req = zlib.decompress(inflated_saml2req, -15)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/utils.py:142
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
141	
142	    inflated_saml2req = base64.b64decode(b64_inflated_saml2req)
143	    deflated_saml2req = zlib.decompress(inflated_saml2req, -15)

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/utils.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
142	    inflated_saml2req = base64.b64decode(b64_inflated_saml2req)
143	    deflated_saml2req = zlib.decompress(inflated_saml2req, -15)
144	    return deflated_saml2req

--------------------------------------------------
>> Issue: [B306:blacklist] zlib.decompress
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/utils.py:143
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b306-zlib-decompress
142	    inflated_saml2req = base64.b64decode(b64_inflated_saml2req)
143	    deflated_saml2req = zlib.decompress(inflated_saml2req, -15)
144	    return deflated_saml2req

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/utils.py:246
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
245	        logger.warning(
246	            "django-csp could not be found, not updating Content-Security-Policy. Please "
247	            "make sure CSP is configured. This can be done by your reverse proxy, "
248	            "django-csp or a custom CSP handler via SAML_CSP_HANDLER. See "

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/views.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
366	
367	                session_id, request_xml = client.create_authn_request(
368	                    location, binding=binding, **sso_kwargs
369	                )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/views.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
373	                        request_xml = str(request_xml)
374	                    saml_request = base64.b64encode(bytes(request_xml, "UTF-8")).decode(
375	                        "utf-8"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/views.py:374
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
373	                        request_xml = str(request_xml)
374	                    saml_request = base64.b64encode(bytes(request_xml, "UTF-8")).decode(
375	                        "utf-8"

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/djangosaml2/views.py:822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
821	
822	            http_info = client.handle_logout_request(
823	                data["SAMLRequest"],
824	                subject_id,
825	                binding,
826	                relay_state=data.get("RelayState", ""),
827	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/setup.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	def read(*rnames):
23	    return codecs.open(
24	        os.path.join(os.path.dirname(__file__), *rnames), encoding="utf-8"
25	    ).read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/setup.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
31	    description="pysaml2 integration for Django",
32	    long_description=read("README.md"),
33	    long_description_content_type="text/markdown",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/setup.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	    maintainer="Giuseppe De Marco",
59	    url="https://github.com/IdentityPython/djangosaml2",
60	    download_url="https://pypi.org/project/djangosaml2/",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/djangosaml2-1.10.1/djangosaml2-1.10.1/setup.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    url="https://github.com/IdentityPython/djangosaml2",
60	    download_url="https://pypi.org/project/djangosaml2/",
61	    license="Apache 2.0",

--------------------------------------------------

Code scanned:
	Total lines of code: 2716
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 24.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 56.0
		High: 5.0
Files skipped (0):
