Run started:2025-04-12 11:01:27.821286

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/dispatch_to_qa.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
58	
59	    override_endpoint = kwargs.get("override_endpoint")
60	    if override_endpoint:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/dispatch_to_qa.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	    
85	    if not kwargs.get('trace_id'):
86	        qna_data['trace_id'] = add_langfuse_trace(qna_endpoint)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/dispatch_to_qa.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
124	    """
125	    qna_endpoint, qna_data = prep_request_payload(user_input, chat_history, vector_name, stream, **kwargs)
126	    header = get_header(vector_name)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/dispatch_to_qa.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
130	    try:
131	        qna_response = requests.post(qna_endpoint, json=qna_data, stream=stream, headers=header)
132	        qna_response.raise_for_status()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/dispatch_to_qa.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
180	    """    
181	    qna_endpoint, qna_data = prep_request_payload(user_input, chat_history, vector_name, stream, **kwargs)
182	    header = get_header(vector_name)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/dispatch_to_qa.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
188	        async with aiohttp.ClientSession() as session:
189	            async with session.post(qna_endpoint, json=qna_data, headers=header) as resp:
190	                resp.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/fastapi/base.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	def create_fastapi_app(origins = ["*"],
17	                       origin_regex = r"https://(.*\.)?sunholo\.com"):
18	    """Creates and configures a FastAPI app for GenAI with Socket.IO integration.
19	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/flask/vac_routes.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
287	
288	                    thread = threading.Thread(target=run_async)
289	                    thread.start()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/langserve.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
45	    try:
46	        response = requests.get(endpoint, headers = header)
47	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/pubsub.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
22	    log.debug(f'process_pubsub: {data}')
23	    message_data = base64.b64decode(data['message']['data']).decode('utf-8')
24	    messageId = data['message'].get('messageId')

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/pubsub.py:23
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
22	    log.debug(f'process_pubsub: {data}')
23	    message_data = base64.b64decode(data['message']['data']).decode('utf-8')
24	    messageId = data['message'].get('messageId')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/special_commands.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	            with open(chat_file_path, 'w') as file:
70	                file.write(f"## Thread history at {the_datetime}\nUser: {user_input}\n")
71	                for message in chat_history:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/special_commands.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
69	            with open(chat_file_path, 'w') as file:
70	                file.write(f"## Thread history at {the_datetime}\nUser: {user_input}\n")
71	                for message in chat_history:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/special_commands.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
71	                for message in chat_history:
72	                    file.write(f"{message}\n")
73	            gs_file = app_to_store(chat_file_path, vector_name, via_bucket_pubsub=True, bucket=bucket)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/special_commands.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
71	                for message in chat_history:
72	                    file.write(f"{message}\n")
73	            gs_file = app_to_store(chat_file_path, vector_name, via_bucket_pubsub=True, bucket=bucket)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/agents/swagger.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
172	            'title': 'Sunholo Multivac API - ${_BRANCH_NAME}',
173	            'description': 'Multivac (Multi-VAC) Cloud. Generate API keys (MULTIVAC_API_KEY) to enable access to private services. See more at https://dev.sunholo.com/',
174	            'version': '0.1.0'
175	        },
176	        'host': '${_ENDPOINTS_HOST}',
177	        'basePath': '/v1',
178	        'schemes': ['https'],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/azure/blobs.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    """
15	    blob_url_pattern = r"https://(.*).blob.core.windows.net/(.*)/(.*)"
16	    match = re.match(blob_url_pattern, message_data)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/azure/blobs.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    # Extract the account name, container name, and blob name from the URL
38	    blob_url_pattern = r"https://(.*).blob.core.windows.net/(.*)/(.*)"
39	    match = re.match(blob_url_pattern, message_data)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/discord.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	    source_documents = []
22	    if bot_output.get('source_documents', None) is not None:
23	        source_documents = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/discord.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
24	        for doc in bot_output['source_documents']:
25	            metadata = doc.get("metadata",{})
26	            filtered_metadata = {}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/discord.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
26	            filtered_metadata = {}
27	            if metadata.get("source", None) is not None:
28	                filtered_metadata["source"] = metadata["source"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/discord.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
28	                filtered_metadata["source"] = metadata["source"]
29	            if metadata.get("type", None) is not None:
30	                filtered_metadata["type"] = metadata["type"]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/discord.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	    return {
38	        'result': bot_output.get('answer', "No answer available"),
39	        'source_documents': source_documents

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/discord.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
60	    log.info(f'Sending discord this data: {data}')
61	    response = requests.post(webhook_url, json=data,
62	                            headers={'Content-Type': 'application/json'})
63	    log.debug(f'Sent data to discord: {response}')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/github_webhook.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	async def get_installation_access_token(jwt, installation_id):
32	    url = f"https://api.github.com/app/installations/{installation_id}/access_tokens"
33	    headers = {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/github_webhook.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	    owner, repo, pr_number = parts[-4], parts[-3], parts[-1]
47	    return f"https://patch-diff.githubusercontent.com/raw/{owner}/{repo}/pull/{pr_number}.diff"
48	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/github_webhook.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
53	    owner, repo = parts[-4], parts[-3]
54	    url = f"https://api.github.com/repos/{owner}/{repo}/git/trees/{branch}?recursive=1"
55	    async with httpx.AsyncClient() as client:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/github_webhook.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
65	                # Decode the base64 content
66	                decoded_content = base64.b64decode(content).decode('utf-8')
67	                files[item['path']] = decoded_content

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/github_webhook.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
65	                # Decode the base64 content
66	                decoded_content = base64.b64decode(content).decode('utf-8')
67	                files[item['path']] = decoded_content

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/github_webhook.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	    owner, repo, pr_number = parts[-4], parts[-3], parts[-1]
75	    url = f"https://api.github.com/repos/{owner}/{repo}/pulls/{pr_number}"
76	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/bots/github_webhook.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	                            + "This bot is  powered by "
247	                            + "[Sunholo Multivac](https://www.sunholo.com/).\n"
248	                            + f"It used the model {model}, used {prompt_tokens} prompt tokens, "
249	                            + f"and {completion_tokens} completion tokens in total."
250	                        },
251	                        headers=headers,
252	                    )
253	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/doc_handling.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
194	                with tempfile.NamedTemporaryFile(mode='w+', delete=False) as temp_file:
195	                    temp_file.write(summary)
196	                    temp_file.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/doc_handling.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
194	                with tempfile.NamedTemporaryFile(mode='w+', delete=False) as temp_file:
195	                    temp_file.write(summary)
196	                    temp_file.flush()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/encode_metadata.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
35	    if isinstance(content, str):
36	        message_data = base64.b64encode(content.encode('utf-8')).decode('utf-8')
37	    else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/encode_metadata.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
35	    if isinstance(content, str):
36	        message_data = base64.b64encode(content.encode('utf-8')).decode('utf-8')
37	    else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/images.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
13	    if image_base64 and len(image_base64) > 100:
14	        image_data = base64.b64decode(image_base64)
15	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/images.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
13	    if image_base64 and len(image_base64) > 100:
14	        image_data = base64.b64decode(image_base64)
15	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/images.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
24	        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as temp_image:
25	            temp_image.write(image_data)
26	            temp_image.flush()  # Make sure all data is written to the file

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/images.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
24	        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as temp_image:
25	            temp_image.write(image_data)
26	            temp_image.flush()  # Make sure all data is written to the file

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/message_data.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
248	            download_stream = blob_client.download_blob()
249	            file.write(download_stream.readall())
250	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/message_data.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
248	            download_stream = blob_client.download_blob()
249	            file.write(download_stream.readall())
250	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/pdfs.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
45	        with open(output_filename, 'wb') as out:
46	            pdf_writer.write(out)
47	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/process_chunker_data.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	
56	    elif message_data.startswith("https://drive.google.com") or message_data.startswith("https://docs.google.com"):
57	        chunks, metadata = handle_google_drive_message(message_data, metadata, vector_name)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/process_chunker_data.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	
56	    elif message_data.startswith("https://drive.google.com") or message_data.startswith("https://docs.google.com"):
57	        chunks, metadata = handle_google_drive_message(message_data, metadata, vector_name)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/chunker/process_chunker_data.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
59	    #TODO: support more git service URLs
60	    elif message_data.startswith("https://github.com"):
61	        chunks, metadata = handle_github_message(message_data, metadata, vector_name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/chat_vac.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
43	            with open(path, 'r', encoding='utf-8') as file:
44	                file_content = file.read()
45	            read_input = file_content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/chat_vac.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	                temp_file.seek(0)
67	                read_input = temp_file.read()
68	                console.print(f"[bold yellow]Total words: [{len(read_input.split())}] - watch out for high token costs! Use !clear_read to reset[/bold yellow]")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/chat_vac.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
88	        port = proxies[agent_name]['port']
89	        url = f"http://127.0.0.1:{port}"
90	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/cli.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	                    title="Sunholo GenAIOps Assistant CLI",
50	                    subtitle="Documentation at https://dev.sunholo.com/")
51	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/cli_init.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
148	    with open(cloudbuild_path, 'r') as file:
149	        content = file.read()
150	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/cli_init.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
157	    with open(cloudbuild_path, 'w') as file:
158	        file.write(content)
159	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/run_proxy.py:17
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
16	    """Check if a given port is in use on the localhost."""
17	    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
18	        return s.connect_ex(('localhost', port)) == 0

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/run_proxy.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	
137	    return f"http://127.0.0.1:{port}"
138	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/run_proxy.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
212	        for service_name, info in proxies.items():
213	            url = f"http://127.0.0.1:{info['port']}"
214	            table.add_row(service_name, 

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/cli/run_proxy.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
266	
267	    return f"http://127.0.0.1:{port}"
268	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/database/database.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
187	    with open(filepath, 'r') as file:
188	        sql = file.read()
189	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/embedder/embed_chunk.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
40	    
41	    message_data = base64.b64decode(data['message']['data']).decode('utf-8')
42	    messageId = data['message'].get('messageId')

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/embedder/embed_chunk.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
40	    
41	    message_data = base64.b64decode(data['message']['data']).decode('utf-8')
42	    messageId = data['message'].get('messageId')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/excel/plugin.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
55	        with open(conf_file_path, "w") as conf_file:
56	            conf_file.write("[Interpreter]\n")
57	            conf_file.write(f"PYTHONPATH={python_executable}\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/excel/plugin.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	            conf_file.write("[Interpreter]\n")
57	            conf_file.write(f"PYTHONPATH={python_executable}\n")
58	        console.print(f"Created {conf_file_path} with PYTHONPATH set to {python_executable}")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/gcs/add_file.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
53	        header, encoded = base64_data.split(",", 1)
54	        data = base64.b64decode(encoded)
55	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/gcs/add_file.py:54
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
53	        header, encoded = base64_data.split(",", 1)
54	        data = base64.b64decode(encoded)
55	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/gcs/add_file.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
57	        with open(filename, "wb") as f:
58	            f.write(data)
59	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/gcs/download_url.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	    if object_name.startswith("gs://"):
175	        public_url = object_name.replace("gs://", "https://storage.cloud.google.com")
176	    else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/gcs/download_url.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	    else:
177	        public_url = f"https://storage.cloud.google.com/{bucket_name}/{quote(object_name)}"
178	    filename = os.path.basename(object_name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/genai/file_handling.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
256	            # Download the file bytes asynchronously
257	            file_bytes = await asyncio.to_thread(get_bytes_from_gcs, img_url)
258	            if not file_bytes:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/genai/file_handling.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
286	            async with aiofiles.open(file_path, 'wb') as f:
287	                await f.write(file_bytes)
288	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/genai/file_handling.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
286	            async with aiofiles.open(file_path, 'wb') as f:
287	                await f.write(file_bytes)
288	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/genai/file_handling.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
290	                if not genai_lib:
291	                    downloaded_content = await asyncio.to_thread(
292	                            partial(genai.upload_file, name=api_name, mime_type=mime_type, display_name=display_name), 
293	                            file_path  # Use the unsanitized path for filesystem access
294	                        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/genai/file_handling.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
312	                    async with upload_semaphore:
313	                        downloaded_content = await asyncio.to_thread(
314	                            client.files.upload, 
315	                            path=file_path,  # Use the unsanitized path for filesystem access
316	                            config=dict(mime_type=mime_type, display_name=display_name, name=api_name)
317	                        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/genai/images.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
39	            with open(temp_file_path, 'wb') as temp_file:
40	                temp_file.write(image_bytes)
41	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/genai/images.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
39	            with open(temp_file_path, 'wb') as temp_file:
40	                temp_file.write(image_bytes)
41	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/invoke/invoke_vac_utils.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
26	
27	            response = requests.post(service_url, files=files, data=form_data)
28	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/invoke/invoke_vac_utils.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
44	            headers = {"Content-Type": "application/json"}
45	            response = requests.post(service_url, headers=headers, data=json.dumps(json_data))
46	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/llamaindex/import_files.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
105	    
106	    if message_data.startswith("gs://") or message_data.startswith("https://drive.google.com"):
107	        log.info(f"rag.import_files for {message_data}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/llamaindex/import_files.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	    else:
121	        log.warning("Only gs:// and https://drive data is supported for llamaindex")
122	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/llamaindex/llamaindex_class.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	        with tempfile.NamedTemporaryFile(delete=False, suffix='.txt') as temp_file:
71	            temp_file.write(text.encode('utf-8'))
72	            temp_filename = temp_file.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/llamaindex/llamaindex_class.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
70	        with tempfile.NamedTemporaryFile(delete=False, suffix='.txt') as temp_file:
71	            temp_file.write(text.encode('utf-8'))
72	            temp_filename = temp_file.name

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/ollama/ollama_images.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	        print(f"Enter your message to {args.model} (Ctrl+D to send):")
48	        user_input = sys.stdin.read().strip()
49	    else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/pubsub/process_pubsub.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
27	    """
28	    message_data = base64.b64decode(data['message']['data']).decode('utf-8')
29	    attributes = data['message'].get('attributes', {})

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/pubsub/process_pubsub.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
27	    """
28	    message_data = base64.b64decode(data['message']['data']).decode('utf-8')
29	    attributes = data['message'].get('attributes', {})

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/senses/stream_voice.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
278	            if self.stream and self.stream.active:
279	                self.stream.write(processed_audio)
280	                if is_final_chunk:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/senses/stream_voice.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
282	                    final_silence = np.zeros(int(0.1 * self.sample_rate), dtype=np.int16)
283	                    self.stream.write(final_silence)
284	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/senses/stream_voice.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
290	                ) as temp_stream:
291	                    temp_stream.write(processed_audio)
292	                    if is_final_chunk:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/senses/stream_voice.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
292	                    if is_final_chunk:
293	                        temp_stream.write(np.zeros(int(0.1 * self.sample_rate), dtype=np.int16))
294	            

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/senses/stream_voice.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
320	            try:
321	                self.stream.write(final_silence)
322	                time.sleep(0.1)  # Let the final audio finish playing

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/senses/stream_voice.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
332	        # Start audio playback thread
333	        player_thread = threading.Thread(target=self.audio_player)
334	        player_thread.start()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/senses/stream_voice.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
337	            # Process text chunks in parallel
338	            with ThreadPoolExecutor(max_workers=3) as executor:
339	                futures = []

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/senses/stream_voice.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
476	                            help='Audio sample rate in Hz')
477	    common_args.add_argument('--voice_name', default='en-GB-Journey-D', help='A voice name from supported list at https://cloud.google.com/text-to-speech/docs/voices')
478	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/templates/agent/app.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
14	    import os
15	    app.run(host="0.0.0.0", port=int(os.environ.get("PORT", 8080)), debug=True)
16	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/templates/project/app.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
15	    import os
16	    app.run(host="0.0.0.0", port=int(os.environ.get("PORT", 8080)), debug=True)
17	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/templates/system_services/app.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
48	    import uvicorn
49	    uvicorn.run(app, host="0.0.0.0", port=int(os.environ.get("PORT", 8080)), debug=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/terraform/tfvars_editor.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
84	            with open(self.tfvars_file, 'w') as file:
85	                file.write("")  # Create an empty tfvars file
86	                

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/terraform/tfvars_editor.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	            for key, value in self.tfvars_data.items():
115	                file.write(f'{key} = {json.dumps(value, indent=2)}\n')
116	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/tools/web_browser.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
386	            # Execute the operation
387	            exec(f"element.{operation}")
388	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/tools/web_browser.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
532	
533	        encoded_image = base64.b64encode(screenshot_bytes).decode('utf-8')
534	        

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/tools/web_browser.py:533
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
532	
533	        encoded_image = base64.b64encode(screenshot_bytes).decode('utf-8')
534	        

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/big_context.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
139	                        with open(file_path, 'r', encoding='utf-8') as infile:
140	                            outfile.write(f"--- Start of {file_path} ---\n")
141	                            outfile.write(infile.read())

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/big_context.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
140	                            outfile.write(f"--- Start of {file_path} ---\n")
141	                            outfile.write(infile.read())
142	                            outfile.write(f"\n--- End of {file_path} ---\n\n")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/big_context.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
140	                            outfile.write(f"--- Start of {file_path} ---\n")
141	                            outfile.write(infile.read())
142	                            outfile.write(f"\n--- End of {file_path} ---\n\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/big_context.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	                            outfile.write(infile.read())
142	                            outfile.write(f"\n--- End of {file_path} ---\n\n")
143	                    except (IOError, UnicodeDecodeError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/big_context.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
146	                    print(f"Skipping file (not a recognised text file extension): {file_path}")
147	        outfile.write("\n--- File Tree ---\n")
148	        outfile.write("\n".join(file_tree))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/big_context.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
147	        outfile.write("\n--- File Tree ---\n")
148	        outfile.write("\n".join(file_tree))
149	    

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/gcp.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
90	        socket.setdefaulttimeout(1)
91	        socket.socket().connect(('metadata.google.internal', 80))
92	        is_gcp_cached = True

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/gcp.py:91
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
90	        socket.setdefaulttimeout(1)
91	        socket.socket().connect(('metadata.google.internal', 80))
92	        is_gcp_cached = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/gcp.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
152	    
153	    metadata_server_url = f'http://metadata.google.internal/computeMetadata/v1/{stem}'
154	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/gcp.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	
157	    response = requests.get(metadata_server_url, headers=headers)
158	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/user_ids.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
6	def generate_user_id():
7	    data = f"{socket.gethostname()}-{platform.platform()}-{platform.processor()}"
8	    hashed_id = hashlib.sha256(data.encode('utf-8')).hexdigest()

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/utils/user_ids.py:7
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
6	def generate_user_id():
7	    data = f"{socket.gethostname()}-{platform.platform()}-{platform.processor()}"
8	    hashed_id = hashlib.sha256(data.encode('utf-8')).hexdigest()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
280	        for ext in listed_extensions:
281	            if ext.get('display_name') == display_name:
282	                raise NameError(f"display_name {display_name} already exists.  Delete it or rename your new extension")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
329	            for ext in exts:
330	                if ext.get('display_name') == extension_display_name:
331	                    log.info(f"Found extension_id for '{extension_display_name}'")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	        for ext in listed_extensions:
400	            if ext.get('display_name') == 'Code Interpreter':
401	                code_interpreter_exists = True

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
428	                    "name": filename,
429	                    "contents": base64.b64encode(open(filename, "rb").read()).decode()
430	                }

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:429
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
428	                    "name": filename,
429	                    "contents": base64.b64encode(open(filename, "rb").read()).decode()
430	                }

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
428	                    "name": filename,
429	                    "contents": base64.b64encode(open(filename, "rb").read()).decode()
430	                }

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
441	
442	        if response.get('execution_error'):
443	            #TODO: setup iteration many times with a timeout

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
443	            #TODO: setup iteration many times with a timeout
444	            log.error(f"Code Execution Response failed with: {response.get('execution_error')} - maybe retry?")
445	            new_query = f"""

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
446	<original_query>{query}</original_query>
447	<original_output>{response.get('generated_code')}</original_output>
448	The code above failed with this error:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
448	The code above failed with this error:
449	<code_error>{response.get('execution_error')}</code_error>
450	Please try again again to satisfy the original query.

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
456	            
457	            if response.get('execution_error'):
458	                log.error(f"Code Execution Response failed twice: {response.get('execution_error')}")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
457	            if response.get('execution_error'):
458	                log.error(f"Code Execution Response failed twice: {response.get('execution_error')}")
459	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
479	        ):
480	            file_name = output_file.get("name")
481	            file_contents = base64.b64decode(output_file.get("contents"))

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
480	            file_name = output_file.get("name")
481	            file_contents = base64.b64decode(output_file.get("contents"))
482	            if save_files_locally:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:481
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
480	            file_name = output_file.get("name")
481	            file_contents = base64.b64decode(output_file.get("contents"))
482	            if save_files_locally:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
480	            file_name = output_file.get("name")
481	            file_contents = base64.b64decode(output_file.get("contents"))
482	            if save_files_locally:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
482	            if save_files_locally:
483	                open(file_name, "wb").write(file_contents)
484	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:488
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
487	                file_html_content = ('<img src="data:image/png;base64, '
488	                                     f'{output_file.get("contents")}" />')
489	            elif file_name.endswith(".json"):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:526
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
525	        result = ""
526	        code = response.get('generated_code')
527	        if 'execution_result' in response and response['execution_result'] != "":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
529	                summary="Executed Code Output",
530	                content=response.get('execution_result'))
531	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
535	
536	        if response.get('execution_error', None):
537	            result += result_template.format(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:539
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
538	                summary="Generated Code Raised a (Possibly Non-Fatal) Exception",
539	                content=response.get('execution_error', None))
540	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
543	            content=self.parse_files_to_html(
544	                response.get('output_files', []),
545	                save_files_locally=True))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/src/sunholo/vertex/extensions_class.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
557	            with open(save_file_name or 'code_execution_results.html', 'w') as file:
558	                file.write(html_content)
559	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/tests/test_chat_history.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    ({"embeds": []}, ""),
15	    ({"embeds": [{"type": "image", "url": "https://example.com/image.png"}]}, '[{"type": "image", "url": "https://example.com/image.png"}]')
16	])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/tests/test_chat_history.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    ({"embeds": []}, ""),
15	    ({"embeds": [{"type": "image", "url": "https://example.com/image.png"}]}, '[{"type": "image", "url": "https://example.com/image.png"}]')
16	])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/tests/test_genai2.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	    import pathlib
114	    gs_uri = "https://storage.googleapis.com/sunholo-public-podcasts/emissary-person.png"
115	    file_bytes = requests.get(gs_uri).content

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/sunholo-0.128.0/sunholo-0.128.0/tests/test_genai2.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
114	    gs_uri = "https://storage.googleapis.com/sunholo-public-podcasts/emissary-person.png"
115	    file_bytes = requests.get(gs_uri).content
116	    file_path = pathlib.Path('person.png')

--------------------------------------------------

Code scanned:
	Total lines of code: 16537
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 94.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 123.0
		High: 14.0
Files skipped (0):
