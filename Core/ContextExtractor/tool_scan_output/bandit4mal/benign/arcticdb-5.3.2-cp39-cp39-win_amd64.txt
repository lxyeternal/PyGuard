Run started:2025-04-12 12:03:53.826690

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticc/pb2/__init__.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	        raise RuntimeError(
11	            "Your environment uses protobuf 3 which does not officially support Python>=3.11.\n"
12	            "Since the support of protobuf 3 for Python ended in 23Q2, we recommend adapting your environment\n"
13	            "to use protobuf 4 before trying to downgrade to Python 3.10 to continue using protobuf 3.\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticc/pb2/__init__.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	        raise RuntimeError(
18	            "Your environment uses protobuf 4 which does not support Python<=3.6.\n"
19	            "We recommend updating your environment to use the minimum supported version of Python.\n"
20	            "For more information, see: https://devguide.python.org/versions/#supported-versions"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticc/pb2/__init__.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	        raise RuntimeError(
24	            "Your environment uses protobuf 5 which does not support Python<=3.7.\n"
25	            "We recommend updating your environment to use the minimum supported version of Python.\n"
26	            "For more information, see: https://devguide.python.org/versions/#supported-versions"

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/azure_library_adapter.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
60	        self._container = self._query_params.Container
61	        if platform.system() != "Linux" and (self._query_params.CA_cert_path or self._query_params.CA_cert_dir):
62	            raise ValueError("You have provided `ca_cert_path` or `ca_cert_dir` in the URI which is only supported on Linux. " \

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/azure_library_adapter.py:61
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
60	        self._container = self._query_params.Container
61	        if platform.system() != "Linux" and (self._query_params.CA_cert_path or self._query_params.CA_cert_dir):
62	            raise ValueError("You have provided `ca_cert_path` or `ca_cert_dir` in the URI which is only supported on Linux. " \

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/azure_library_adapter.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
65	        self._ca_cert_dir = self._query_params.CA_cert_dir
66	        if not self._ca_cert_path and not self._ca_cert_dir and platform.system() == "Linux":
67	            if ssl.get_default_verify_paths().cafile is not None:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/azure_library_adapter.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
65	        self._ca_cert_dir = self._query_params.CA_cert_dir
66	        if not self._ca_cert_path and not self._ca_cert_dir and platform.system() == "Linux":
67	            if ssl.get_default_verify_paths().cafile is not None:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/gcpxml_library_adapter.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
129	
130	        if platform.system() != "Linux" and (query_params.CA_cert_path or query_params.CA_cert_dir):
131	            raise ValueError(

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/gcpxml_library_adapter.py:130
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
129	
130	        if platform.system() != "Linux" and (query_params.CA_cert_path or query_params.CA_cert_dir):
131	            raise ValueError(

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/gcpxml_library_adapter.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
136	        self._ca_cert_dir = query_params.CA_cert_dir
137	        if not self._ca_cert_path and not self._ca_cert_dir and platform.system() == "Linux":
138	            if ssl.get_default_verify_paths().cafile is not None:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/gcpxml_library_adapter.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
136	        self._ca_cert_dir = query_params.CA_cert_dir
137	        if not self._ca_cert_path and not self._ca_cert_dir and platform.system() == "Linux":
138	            if ssl.get_default_verify_paths().cafile is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/s3_library_adapter.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	            raise ValueError(
84	                "The support of 'force_uri_lib_config=false' has been dropped due to security concerns. Please refer to"
85	                " https://github.com/man-group/ArcticDB/pull/803 for more information."
86	            )

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/s3_library_adapter.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
92	        self._encoding_version = encoding_version
93	        if platform.system() != "Linux" and (self._query_params.CA_cert_path or self._query_params.CA_cert_dir):
94	            raise ValueError(

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/s3_library_adapter.py:93
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
92	        self._encoding_version = encoding_version
93	        if platform.system() != "Linux" and (self._query_params.CA_cert_path or self._query_params.CA_cert_dir):
94	            raise ValueError(

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/s3_library_adapter.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
99	        self._ca_cert_dir = self._query_params.CA_cert_dir
100	        if not self._ca_cert_path and not self._ca_cert_dir and platform.system() == "Linux":
101	            if ssl.get_default_verify_paths().cafile is not None:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/adapters/s3_library_adapter.py:100
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
99	        self._ca_cert_dir = self._query_params.CA_cert_dir
100	        if not self._ca_cert_path and not self._ca_cert_dir and platform.system() == "Linux":
101	            if ssl.get_default_verify_paths().cafile is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/config.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
125	    with open(p, "r") as _if:
126	        return converter.loads(_if.read())
127	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/config.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
135	    with open(p, "w") as of:
136	        of.write(converter.dumps(config))
137	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/scripts/update_storage.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	        required=True,
82	        help="URI for Arctic instance to fix, see https://docs.arcticdb.io/api/arcticdb#arcticdb.Arctic.__init__",
83	    )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/azure.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
165	            GracefulProcessUtils.terminate(self._p)
166	        safer_rmtree(self, self.working_dir)
167	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/lmdb.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
50	
51	        safer_rmtree(self, self.db_dir)
52	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/mongo.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
127	        self.mongo_uri = f"mongodb://localhost:{self._port}"
128	        wait_for_server_to_come_up(f"http://localhost:{self._port}", "mongod", self._p)
129	        self._client = get_mongo_client(self.mongo_uri)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/mongo.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	    try:
153	        res = requests.get(f"http://{host}")
154	    except requests.exceptions.ConnectionError:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
106	            self.arctic_uri += "&ssl=True"
107	        if platform.system() == "Linux":
108	            if factory.client_cert_file:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
106	            self.arctic_uri += "&ssl=True"
107	        if platform.system() == "Linux":
108	            if factory.client_cert_file:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:107
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
106	            self.arctic_uri += "&ssl=True"
107	        if platform.system() == "Linux":
108	            if factory.client_cert_file:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
307	    account_id = (
308	        boto3.client("sts", aws_access_key_id=out.default_key.id, aws_secret_access_key=out.default_key.secret)
309	        .get_caller_identity()
310	        .get("Account")
311	    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
426	    with open(config_file_path, "w") as config_file:
427	        config_file.write(aws_credentials)
428	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
426	    with open(config_file_path, "w") as config_file:
427	        config_file.write(aws_credentials)
428	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:506
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
505	    out.default_key = Key(id="access key", secret="secret key", user_name="unknown user")
506	    out.endpoint = "http://test"
507	    out.region = "us-east-1"

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
519	            return "s3"
520	        elif host == "127.0.0.1":
521	            return "iam"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
527	    def __call__(self, environ, start_response):
528	        path_info: bytes = environ.get("PATH_INFO", "")
529	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:542
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
541	                length = int(environ["CONTENT_LENGTH"])
542	                body = environ["wsgi.input"].read(length).decode("ascii")
543	                self._reqs_till_rate_limit = int(body)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:584
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
583	    werkzeug.run_simple(
584	        "0.0.0.0",
585	        port,
586	        HostDispatcherApplication(create_backend_app),
587	        threaded=True,
588	        ssl_context=(cert_file, key_file) if cert_file and key_file else None,
589	    )
590	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
593	    werkzeug.run_simple(
594	        "0.0.0.0",
595	        port,
596	        GcpHostDispatcherApplication(create_backend_app),
597	        threaded=True,
598	        ssl_context=(cert_file, key_file) if cert_file and key_file else None,
599	    )
600	

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:671
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
670	        )  # In py3.7, multiprocess with forking will lead to seg fault in moto, possibly due to the handling of file descriptors
671	        self._p = spawn_context.Process(
672	            target=run_s3_server,
673	            args=(
674	                port,
675	                self.key_file if self.http_protocol == "https" else None,
676	                self.cert_file if self.http_protocol == "https" else None,
677	            ),

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
687	            except AssertionError as e:  # Thrown by wait_for_server_to_come_up
688	                sys.stderr.write(repr(e))
689	                GracefulProcessUtils.terminate(self._p)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:688
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
687	            except AssertionError as e:  # Thrown by wait_for_server_to_come_up
688	                sys.stderr.write(repr(e))
689	                GracefulProcessUtils.terminate(self._p)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
733	        # The number is the remaining requests before permission checks kick in
734	        requests.post(self._iam_endpoint + "/moto-api/reset-auth", "0" if enforcing else "inf")
735	        self._enforcing_permissions = enforcing

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
758	                # where we try to clean up the bucket but it's already gone
759	                is_win_37 = platform.system() == "Windows" and sys.version_info[:2] == (3, 7)
760	                if e.response["Error"]["Code"] != "NoSuchBucket" and not is_win_37:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:759
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
758	                # where we try to clean up the bucket but it's already gone
759	                is_win_37 = platform.system() == "Windows" and sys.version_info[:2] == (3, 7)
760	                if e.response["Error"]["Code"] != "NoSuchBucket" and not is_win_37:

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:759
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
758	                # where we try to clean up the bucket but it's already gone
759	                is_win_37 = platform.system() == "Windows" and sys.version_info[:2] == (3, 7)
760	                if e.response["Error"]["Code"] != "NoSuchBucket" and not is_win_37:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:763
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
762	        else:
763	            requests.post(
764	                self._iam_endpoint + "/moto-api/reset", verify=False
765	            )  # If CA cert verify fails, it will take ages for this line to finish

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/s3.py:803
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
802	        )  # In py3.7, multiprocess with forking will lead to seg fault in moto, possibly due to the handling of file descriptors
803	        self._p = spawn_context.Process(
804	            target=run_gcp_server,
805	            args=(
806	                port,
807	                self.key_file if self.http_protocol == "https" else None,
808	                self.cert_file if self.http_protocol == "https" else None,
809	            ),

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
31	
32	_WINDOWS = platform.system() == "Windows"
33	_DEBUG = os.getenv("ACTIONS_RUNNER_DEBUG", default=None) in (1, "True")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
31	
32	_WINDOWS = platform.system() == "Windows"
33	_DEBUG = os.getenv("ACTIONS_RUNNER_DEBUG", default=None) in (1, "True")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/utils.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
31	
32	_WINDOWS = platform.system() == "Windows"
33	_DEBUG = os.getenv("ACTIONS_RUNNER_DEBUG", default=None) in (1, "True")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/utils.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	        """Start the subprocess with flags so it can be gracefully ``terminate``d even on Windows"""
62	        if isinstance(cmd, str) and not kwargs.get("shell"):
63	            cmd = cmd.split()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/utils.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
110	        try:
111	            response = requests.get(url, timeout=req_timeout, verify=False)  # head() confuses Mongo
112	            if response.status_code < 500:  # We might not have permission, so not requiring 2XX response

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/utils.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
143	    with handler:
144	        shutil.rmtree(path, ignore_errors=False)
145	    if handler.had_exception:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/storage_fixtures/utils.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
147	        with handler:  # Even with ignore_errors=True, rmtree might still throw on Windows....
148	            shutil.rmtree(path, ignore_errors=True)
149	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/environment_setup.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
500	                symbol = self.get_symbol_name(row, col)
501	                lib.write(symbol, df)
502	                self.logger().info(f"Dataframe stored at {symbol} for {time.time() - st} sec")

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/environment_setup.py:501
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
500	                symbol = self.get_symbol_name(row, col)
501	                lib.write(symbol, df)
502	                self.logger().info(f"Dataframe stored at {symbol} for {time.time() - st} sec")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/environment_setup.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
616	                if self.with_metadata:
617	                    lib.write(symbol, df, metadata=meta)
618	                else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/environment_setup.py:617
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
616	                if self.with_metadata:
617	                    lib.write(symbol, df, metadata=meta)
618	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/environment_setup.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
618	                else:
619	                    lib.write(symbol, df)
620	            if self.with_snapshot:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/environment_setup.py:619
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
618	                else:
619	                    lib.write(symbol, df)
620	            if self.with_snapshot:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/environment_setup.py:726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
725	        lib = setup.get_modifiable_library()
726	        lib.write(symbol, setup.generate_dataframe(10,10))
727	        ac = setup.get_arctic_client_modifiable()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/environment_setup.py:726
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
725	        lib = setup.get_modifiable_library()
726	        lib.write(symbol, setup.generate_dataframe(10,10))
727	        ac = setup.get_arctic_client_modifiable()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:394
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
393	    df = sample_dataframe()
394	    version_store.write("symbol", df)
395	    version_store.write("pickled", {"a": 1}, pickle_on_failure=True)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
394	    version_store.write("symbol", df)
395	    version_store.write("pickled", {"a": 1}, pickle_on_failure=True)
396	    version_store.snapshot("mysnap")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
396	    version_store.snapshot("mysnap")
397	    version_store.write("rec_norm", data={"a": np.arange(5), "b": np.arange(8), "c": None}, recursive_normalizers=True)
398	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
551	        for version, version_info in symbol_versions.items():
552	            source_vit = source_lib.read(symbol, as_of=version)
553	            for target_lib in target_libs:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
553	            for target_lib in target_libs:
554	                target_vit = target_lib.read(symbol, as_of=version)
555	                try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
571	        for symbol, version_info in symbol_versions.items():
572	            source_vit = source_lib.read(symbol, as_of=snapshot)
573	            for target_lib in target_libs:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
573	            for target_lib in target_libs:
574	                target_vit = target_lib.read(symbol, as_of=snapshot)
575	                try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:725
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
724	def generic_filter_test(lib, symbol, arctic_query, expected):
725	    received = lib.read(symbol, query_builder=arctic_query).data
726	    if not np.array_equal(expected, received):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:727
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
726	    if not np.array_equal(expected, received):
727	        original_df = lib.read(symbol).data
728	        print(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
744	def generic_filter_test_dynamic(lib, symbol, arctic_query, queried_slices):
745	    received = lib.read(symbol, query_builder=arctic_query).data
746	    assert len(received) == sum([len(queried_slice) for queried_slice in queried_slices])

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
756	    if not arrays_equal:
757	        original_df = lib.read(symbol).data
758	        print(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:783
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
782	def generic_filter_test_nans(lib, symbol, arctic_query, expected):
783	    received = lib.read(symbol, query_builder=arctic_query).data
784	    assert expected.shape == received.shape

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
801	    q = QueryBuilder().groupby(grouping_column).agg(aggs_dict)
802	    received = lib.read(symbol, query_builder=q).data
803	    received = received.reindex(columns=sorted(received.columns))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
811	    q = QueryBuilder().groupby(grouping_column).agg(aggs_dict)
812	    received = lib.read(symbol, query_builder=q).data
813	    received = received.reindex(columns=sorted(received.columns))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:882
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
881	    # Pandas doesn't have a good date_range equivalent in resample, so just use read for that
882	    original_data = lib.read(sym, date_range=date_range).data
883	    # Pandas 1.X needs None as the first argument to agg with named aggregators

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/test.py:910
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
909	        q = q.resample(rule, closed=closed, label=label, offset=offset).agg(aggregations)
910	    received = lib.read(sym, date_range=date_range, query_builder=q).data
911	    received = received.reindex(columns=sorted(received.columns))

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/venv.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
85	    def tear_down_venv(self):
86	        shutil.rmtree(self.path, ignore_errors=True)
87	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/venv.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
146	            with open(python_path, "w") as python_file:
147	                python_file.write("\n".join(python_commands))
148	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/util/venv.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
146	            with open(python_path, "w") as python_file:
147	                python_file.write("\n".join(python_commands))
148	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/_normalization.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
202	        raise ArcticDbNotYetImplemented(
203	            "PyArrow-backed pandas DataFrame and Series are not currently supported by ArcticDB. \n"
204	            "Please convert your pandas DataFrame and Series to use NumPy array before using them with ArcticDB. \n"
205	            "If you are interested in the support of PyArrow-backed pandas DataFrame and Series, please upvote this \n"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/_normalization.py:1044
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1043	        else:
1044	            return ExtType(MsgPackSerialization.PY_PICKLE_3, packb(Pickler.write(obj)))
1045	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/_normalization.py:1066
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1065	            data = unpackb(data, raw=True)
1066	            return Pickler.read(data)
1067	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/_normalization.py:1070
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1069	            data = unpackb(data, raw=False)
1070	            return Pickler.read(data)
1071	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/_store.py:1107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1106	        read_options.set_batch_throw_on_error(throw_on_error)
1107	        read_results = self.version_store.batch_read(symbols, version_queries, read_queries, read_options)
1108	        versioned_items = []

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/_store.py:1393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1392	        )
1393	        cxx_versioned_items = self.version_store.batch_write(
1394	            symbols, items, norm_metas, udms, prune_previous_version, validate_index, throw_on_error
1395	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/library.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
398	        """
399	        return self.lib.read(**self._to_read_request()._asdict())
400	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/library.py:601
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
600	    def __getitem__(self, symbol: str) -> VersionedItem:
601	        return self.read(symbol)
602	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/library.py:760
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
759	
760	        return self._nvs.write(
761	            symbol=symbol,
762	            data=data,
763	            metadata=metadata,
764	            prune_previous_version=prune_previous_versions,
765	            pickle_on_failure=False,
766	            parallel=staged,
767	            validate_index=validate_index,
768	            norm_failure_options_msg="Using write_pickle will allow the object to be written. However, many operations "
769	                                     "(such as date_range filtering and column selection) will not work on pickled data.",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/library.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
811	        """
812	        return self._nvs.write(
813	            symbol=symbol,
814	            data=data,
815	            metadata=metadata,
816	            prune_previous_version=prune_previous_versions,
817	            pickle_on_failure=True,
818	            parallel=staged,
819	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/arcticdb/version_store/library.py:1647
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1646	        else:
1647	            return self._nvs.read(
1648	                symbol=symbol,
1649	                as_of=as_of,
1650	                date_range=date_range,
1651	                row_range=row_range,
1652	                columns=columns,
1653	                query_builder=query_builder,
1654	                implement_read_index=True,
1655	                iterate_snapshots_if_tombstoned=False
1656	            )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/basic_functions.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
332	        # TODO: We can use dirs_exist_ok=True on copytree instead of removing first if we run with python version >=3.8
333	        rmtree(ModificationFunctions.ARCTIC_DIR)
334	        copytree(ModificationFunctions.ARCTIC_DIR_ORIGINAL, ModificationFunctions.ARCTIC_DIR)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/bi_benchmarks.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
99	            print("DF for iterration xSize original ready: ", num)
100	            self.lib.write(f"{self.symbol}{num}", _df)
101	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/bi_benchmarks.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
137	    def time_query_readall(self, times_bigger):
138	        self.lib.read(f"{self.symbol}{times_bigger}")
139	    

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/bi_benchmarks.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
141	    def peakmem_query_readall(self, times_bigger):
142	        self.lib.read(f"{self.symbol}{times_bigger}")
143	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/bi_benchmarks.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
147	        q = get_query_groupby_city_count_all( q)
148	        df = self.lib.read(f"{self.symbol}{times_bigger}", query_builder=q)
149	        return df.data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/bi_benchmarks.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
162	        q = get_query_groupby_city_count_isin_filter(q)   
163	        df = self.lib.read(f"{self.symbol}{times_bigger}", query_builder=q)
164	        return df.data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/bi_benchmarks.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
177	        q = get_query_groupby_city_count_filter_two_aggregations(q) 
178	        df = self.lib.read(f"{self.symbol}{times_bigger}", query_builder=q)
179	        return df.data

--------------------------------------------------
>> Issue: [B819:urlretrieve] urllib.request.urlretrieve
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/common.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b819_urlretrieve.html
96	    name = get_filename_from_url(url)
97	    urllib.request.urlretrieve(url, name)
98	    print("File downloaded: ", name)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/common.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	    '''
105	    name = download_file("http://www.cwi.nl/~boncz/PublicBIbenchmark/CityMaxCapita/CityMaxCapita_1.csv.bz2")
106	    name = decompress_bz2_file(name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/common.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	    with bz2.open(name, 'rb') as input_file:
130	        decompressed_data = input_file.read()
131	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/common.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	    with open(new_name, 'wb') as output_file:
133	        output_file.write(decompressed_data)
134	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/comparison_benchmarks.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
44	        lib = ac.create_library(ComparisonBenchmarks.LIB_NAME)
45	        lib.write(symbol=ComparisonBenchmarks.SYMBOL, data=df)
46	        return (df, dict)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/comparison_benchmarks.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
85	        df, dict = tpl
86	        self.lib.write("symbol", df)
87	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/persistent_query_builder.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
69	        for rows in num_rows:
70	            lib.write(f"{rows}_rows", generate_benchmark_df(rows))
71	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/persistent_query_builder.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
75	        q = q.groupby("id1").agg({"v1": "sum"})
76	        self.lib.read(f"{num_rows}_rows", query_builder=q)
77	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/persistent_query_builder.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	        q = q.groupby("id3").agg({"v1": "sum", "v3": "sum"})
81	        self.lib.read(f"{num_rows}_rows", query_builder=q)
82	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/persistent_query_builder.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
85	        q = q.groupby("id6").agg({"v1": "sum", "v2": "sum"})
86	        self.lib.read(f"{num_rows}_rows", query_builder=q)
87	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/persistent_query_builder.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
90	        q = q.groupby("id3").agg({"v1": "max", "v2": "min"})
91	        self.lib.read(f"{num_rows}_rows", query_builder=q)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
119	        sym = self.setup_env.get_symbol_name(num_rows, None)
120	        self.to_write_df = self.setup_env.get_library().read(symbol=sym).data
121	        self.last_20 = self.setup_env.get_last_x_percent_date_range(num_rows, 20)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
129	        sym = self.setup_env.get_symbol_name(num_rows, None)
130	        self.setup_env.get_library().read(symbol=sym)
131	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
133	        sym = self.setup_env.get_symbol_name(num_rows, None)
134	        self.setup_env.get_library().read(symbol=sym)
135	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
137	        sym = self.setup_env.get_symbol_name(num_rows, None)
138	        self.write_library.write(symbol=sym, data=self.to_write_df)
139	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
141	        sym = self.setup_env.get_symbol_name(num_rows, None)
142	        self.write_library.write(symbol=sym, data=self.to_write_df)
143	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	        sym = self.setup_env.get_symbol_name(num_rows, None)
147	        self.setup_env.get_library().read(symbol=sym, columns=COLS).data
148	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
151	        sym = self.setup_env.get_symbol_name(num_rows, None)
152	        self.setup_env.get_library().read(symbol=sym, columns=COLS).data           
153	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
156	        sym = self.setup_env.get_symbol_name(num_rows, None)
157	        self.setup_env.get_library().read(symbol=sym, columns=COLS).data
158	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	        sym = self.setup_env.get_symbol_name(num_rows, None)
162	        self.setup_env.get_library().read(symbol=sym, columns=COLS).data           
163	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
165	        lib = self.write_library
166	        lib.write(f"sym", self.to_write_df, staged=True)
167	        lib._nvs.compact_incomplete(f"sym", False, False)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	        lib = self.write_library
171	        lib.write(f"sym", self.to_write_df, staged=True)
172	        lib._nvs.compact_incomplete(f"sym", False, False)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175	        sym = self.setup_env.get_symbol_name(num_rows, None)
176	        self.setup_env.get_library().read(symbol=sym, date_range=self.last_20).data
177	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
179	        sym = self.setup_env.get_symbol_name(num_rows, None)
180	        self.setup_env.get_library().read(symbol=sym, date_range=self.last_20).data
181	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write_wide.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	        sym = self.storage.get_symbol_name(num_rows, num_cols)
74	        self.to_write_df = self.storage.get_library().read(symbol=sym).data
75	        ##

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write_wide.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	        sym = self.storage.get_symbol_name(num_rows, num_cols)
83	        self.storage.get_library().read(symbol=sym)
84	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write_wide.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
86	        sym = self.storage.get_symbol_name(num_rows, num_cols)
87	        self.storage.get_library().read(symbol=sym)
88	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write_wide.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
90	        sym = self.storage.get_symbol_name(num_rows, num_cols)
91	        self.write_library.write(symbol=sym, data=self.to_write_df)
92	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/real_read_write_wide.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
94	        sym = self.storage.get_symbol_name(num_rows, num_cols)
95	        self.write_library.write(symbol=sym, data=self.to_write_df)        
96	 

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/version_chain.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
48	                for i in range(num_versions):
49	                    lib.write(symbol, small_df)
50	                    if (i == math.floor(deleted * num_versions)):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/version_chain.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
61	            # Throws an error if version is deleted
62	            self.lib.read(symbol, as_of=0)
63	        except(NoSuchVersionException):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/arcticdb-5.3.2-cp39-cp39-win_amd64/benchmarks/version_chain.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	            # Throws an error if version is deleted
69	            self.lib.read(symbol, as_of=datetime.datetime.utcfromtimestamp(0))
70	        except(NoSuchVersionException):

--------------------------------------------------

Code scanned:
	Total lines of code: 22239
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 107.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 119.0
		High: 9.0
Files skipped (0):
