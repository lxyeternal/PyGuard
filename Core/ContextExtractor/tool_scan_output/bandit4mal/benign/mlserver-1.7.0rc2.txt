Run started:2025-04-12 10:18:35.298294

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
44	    if response.status != 200:
45	        result = await response.read()
46	        error_response = json.loads(result) if len(result) else {"error": ""}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	        # Drop "binary_data_size" from `paramaters` as we decoded the output
143	        parameters = response_output.get("parameters")
144	        if parameters is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
155	        model_name=infer_response["model_name"],
156	        model_version=infer_response.get("model_version", None),
157	        id=infer_response.get("id", None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
156	        model_version=infer_response.get("model_version", None),
157	        id=infer_response.get("id", None),
158	        parameters=infer_response.get("parameters", None),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
157	        id=infer_response.get("id", None),
158	        parameters=infer_response.get("parameters", None),
159	        outputs=outputs,

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
221	    return (
222	        TritonRequest.from_inference_request(batched.merged_request, binary_data),
223	        batched,

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
221	    return (
222	        TritonRequest.from_inference_request(batched.merged_request, binary_data),
223	        batched,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
357	    while True:
358	        input_items = await queue_in.get()
359	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
394	            while True:
395	                batch_output = await queue.get()
396	                for item in batch_output:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
397	                    try:
398	                        await f.write(item.item)
399	                        await f.write(b"\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batch_processing.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
398	                        await f.write(item.item)
399	                        await f.write(b"\n")
400	                    except Exception as e:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batching/adaptive.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
37	    async def predict(self, req: InferenceRequest) -> InferenceResponse:
38	        internal_id, _ = await self._queue_request(req)
39	        self._start_batcher_if_needed()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batching/adaptive.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
131	                while len(to_batch) < self._max_batch_size:
132	                    internal_id, inference_request = await self._get_request(
133	                        timeout=timeout
134	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batching/adaptive.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	        if not self._requests.empty():
148	            return await self._requests.get()
149	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/batching/adaptive.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
149	
150	        read_op = self._requests.get()
151	        return await wait_for(read_op, timeout=timeout)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/cli/build.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
28	        logger.info(f"Writing Dockerfile in {dockerfile_path}")
29	        dockerfile_handler.write(dockerfile)
30	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/cli/build.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
28	        logger.info(f"Writing Dockerfile in {dockerfile_path}")
29	        dockerfile_handler.write(dockerfile)
30	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/cli/build.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
36	            logger.info(f"Writing .dockerignore in {dockerignore_path}")
37	            dockerignore_handler.write(Dockerignore)
38	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/cli/build.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
36	            logger.info(f"Writing .dockerignore in {dockerignore_path}")
37	            dockerignore_handler.write(Dockerignore)
38	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/cli/constants.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	DockerfileName = "Dockerfile"
4	DockerfileTemplate = """
5	FROM continuumio/miniconda3:24.4.0-0 AS env-builder
6	SHELL ["/bin/bash", "-c"]
7	
8	ARG MLSERVER_ENV_NAME="mlserver-custom-env" \\
9	    MLSERVER_ENV_TARBALL="./envs/base.tar.gz"
10	
11	RUN conda config --add channels conda-forge && \\
12	    conda install conda-libmamba-solver==23.7.0 && \\
13	    conda config --set solver libmamba && \\
14	    conda install conda-pack
15	
16	# The `[]` character range will ensure that Docker doesn't complain if the
17	# files don't exist:
18	# https://stackoverflow.com/a/65138098/5015573
19	COPY \\
20	    ./environment.ym[l] \\
21	    ./environment.yam[l] \\
22	    ./conda.ym[l] \\
23	    ./conda.yam[l] \\
24	    .
25	RUN mkdir $(dirname $MLSERVER_ENV_TARBALL); \\
26	    for envFile in environment.yml environment.yaml conda.yml conda.yaml; do \\
27	        if [[ -f $envFile ]]; then \\
28	            conda env create \
29	                --name $MLSERVER_ENV_NAME \\
30	                --file $envFile; \\
31	            conda-pack --ignore-missing-files \
32	                -n $MLSERVER_ENV_NAME \\
33	                -o $MLSERVER_ENV_TARBALL; \\
34	        fi \\
35	    done; \\
36	    chmod -R 776 $(dirname $MLSERVER_ENV_TARBALL)
37	
38	FROM {base_image}
39	SHELL ["/bin/bash", "-c"]
40	
41	# Copy all potential sources for custom environments
42	COPY \\
43	    --chown=1000 \\
44	    --from=env-builder \\
45	    /envs/base.tar.g[z] \\
46	    ./envs/base.tar.gz
47	COPY \\
48	    ./settings.jso[n] \\
49	    ./model-settings.jso[n] \\
50	    ./requirements.tx[t] \\
51	    .
52	
53	USER root
54	# Install dependencies system-wide, to ensure that they are available for every
55	# user and give permissions to (future) environment folder.
56	RUN ./hack/build-env.sh . && \\
57	    mkdir -p ./envs/base && \\
58	    chown -R 1000:0 ./envs/base && \\
59	    chmod -R 776 ./envs/base && \\
60	    rm -rf /root/.cache/pip
61	USER 1000
62	
63	# Copy everything else
64	COPY . .
65	
66	# Override MLServer's own `CMD` to activate the embedded environment
67	# (optionally activating the hot-loaded one as well).
68	CMD source ./hack/activate-env.sh ./envs/base.tar.gz && \\
69	    mlserver start $MLSERVER_MODELS_DIR
70	"""
71	
72	DockerignoreName = ".dockerignore"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/cli/main.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	# TODO: Update to have template(s) in the SeldonIO org
67	@click.option("-t", "--template", default="https://github.com/EthicalML/sml-security/")
68	@click_async

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/codecs/base64.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
23	    as_bytes = _ensure_bytes(elem)
24	    b64_encoded = base64.b64encode(as_bytes)
25	    if use_bytes:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/codecs/base64.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
23	    as_bytes = _ensure_bytes(elem)
24	    b64_encoded = base64.b64encode(as_bytes)
25	    if use_bytes:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/codecs/base64.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
36	    try:
37	        return base64.b64decode(as_bytes, validate=True)
38	    except binascii.Error:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/codecs/base64.py:37
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
36	    try:
37	        return base64.b64decode(as_bytes, validate=True)
38	    except binascii.Error:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/env.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
17	    logger.info(f"Extracting environment tarball from {tarball_path}...")
18	    with tarfile.open(tarball_path, "r") as tarball:
19	        tarball.extractall(path=env_path)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/env.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
30	    # Disable IO buffering since it's handled explicitly below
31	    with open(tarball_path, "rb", buffering=0) as env_file:
32	        buffer = bytearray(buffer_size)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/env.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
155	        if self._delete_env:
156	            shutil.rmtree(self._env_path)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/grpc/server.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
71	        self._server = aio.server(
72	            ThreadPoolExecutor(max_workers=DefaultGrpcWorkers),
73	            interceptors=tuple(self._interceptors),

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/parallel/dispatcher.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
139	        self._process_responses_task = None
140	        self._executor = ThreadPoolExecutor()
141	        self._async_responses = AsyncResponses()

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/parallel/registry.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
65	        # Register sigchld signal handler (saving original to restore it later)
66	        self._original_sigchld_handler = signal.getsignal(signal.SIGCHLD)
67	        signal.signal(

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/parallel/registry.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
66	        self._original_sigchld_handler = signal.getsignal(signal.SIGCHLD)
67	        signal.signal(
68	            signal.SIGCHLD,
69	            lambda *args: asyncio.create_task(self._handle_worker_stop(*args)),
70	        )

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/parallel/registry.py:67
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
66	        self._original_sigchld_handler = signal.getsignal(signal.SIGCHLD)
67	        signal.signal(
68	            signal.SIGCHLD,
69	            lambda *args: asyncio.create_task(self._handle_worker_stop(*args)),
70	        )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/parallel/registry.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
287	        # Reset signal handler
288	        signal.signal(signal.SIGCHLD, self._original_sigchld_handler)
289	        await asyncio.gather(

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/parallel/registry.py:288
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
287	        # Reset signal handler
288	        signal.signal(signal.SIGCHLD, self._original_sigchld_handler)
289	        await asyncio.gather(

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/parallel/worker.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
56	        if self.__executor is None:
57	            self.__executor = ThreadPoolExecutor()
58	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/mlserver-1.7.0rc2/mlserver-1.7.0rc2/mlserver/settings.py:211
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
210	    # HTTP Server settings
211	    host: str = "0.0.0.0"
212	    """Host where to listen for connections."""

--------------------------------------------------

Code scanned:
	Total lines of code: 8220
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 7.0
		High: 30.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 33.0
		High: 4.0
Files skipped (0):
