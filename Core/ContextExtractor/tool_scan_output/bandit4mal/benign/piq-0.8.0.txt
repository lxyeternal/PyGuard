Run started:2025-04-12 11:46:55.323995

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/brisque.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	    if '1.5.0' in torch.__version__:
45	        warnings.warn(f'BRISQUE does not support back propagation due to bug in torch={torch.__version__}.'
46	                      f'Update torch to the latest version to access full functionality of the BRIQSUE.'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/brisque.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
228	def _score_svr(features: torch.Tensor) -> torch.Tensor:
229	    url = 'https://github.com/photosynthesis-team/piq/' \
230	          'releases/download/v0.4.0/brisque_svm_weights.pt'
231	    sv_coef, sv = load_url(url, map_location=features.device)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/clip_iqa.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	OPENAI_CLIP_STD = (0.26862954, 0.26130258, 0.27577711)
24	TOKENS_URL = "https://github.com/photosynthesis-team/piq/releases/download/v0.7.1/clipiqa_tokens.pt"
25	
26	
27	class CLIPIQA(_Loss):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/feature_extractors/clip.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	PIQ_CLIP_MODEL_PATH = (
19	    "https://github.com/photosynthesis-team/piq/releases/download/v0.7.1/RN50.pt"
20	)
21	OPENIQA_CLIP_MODEL_PATH = (
22	    "https://openaipublic.azureedge.net/clip/models/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/feature_extractors/clip.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	OPENIQA_CLIP_MODEL_PATH = (
22	    "https://openaipublic.azureedge.net/clip/models/"
23	    "afeb0e10f9e5a86da6080e35cf09123aca3b358a0c3e3b6c78a7b63bc04b6762/RN50.pt"
24	)
25	
26	
27	def _download(url: str, root: str) -> str:
28	    r"""Downloads model's weights and caches them. If already downloaded - loads from cache.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/feature_extractors/clip.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	        if is_sha256_hash(expected_sha256):
49	            if hashlib.sha256(open(download_target, "rb").read()).hexdigest() == expected_sha256:
50	                return download_target

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/feature_extractors/clip.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
57	
58	    with urlopen(url) as source, open(download_target, "wb") as output:
59	        while True:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/feature_extractors/clip.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	        while True:
60	            buff = source.read(8192)
61	            if not buff:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/feature_extractors/clip.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
63	
64	            output.write(buff)
65	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/feature_extractors/clip.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	    if is_sha256_hash(expected_sha256):
68	        if hashlib.sha256(open(download_target, "rb").read()).hexdigest() != expected_sha256:
69	            raise RuntimeError("Model has been downloaded but the SHA256 checksum does not match")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/feature_extractors/fid_inception.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	FID_WEIGHTS_URL = \
24	    'https://github.com/mseitzer/pytorch-fid/releases/download/fid_weights/pt_inception-2015-12-05-6726825d.pth'
25	
26	
27	class InceptionV3(nn.Module):
28	    r"""Pretrained InceptionV3 network returning feature maps"""

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/gs.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
198	        _validate_input([x_features, y_features], dim_range=(2, 2), size_range=(1, 2))
199	        with Pool(self.num_workers) as p:
200	            self.features = x_features.detach().cpu().numpy()

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/gs.py:199
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
198	        _validate_input([x_features, y_features], dim_range=(2, 2), size_range=(1, 2))
199	        with Pool(self.num_workers) as p:
200	            self.features = x_features.detach().cpu().numpy()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/perceptual.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
361	    """
362	    _weights_url = "https://github.com/photosynthesis-team/" + \
363	        "photosynthesis.metrics/releases/download/v0.4.0/lpips_weights.pt"
364	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/perceptual.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
401	    """
402	    _weights_url = "https://github.com/photosynthesis-team/piq/releases/download/v0.4.1/dists_weights.pt"
403	
404	    def __init__(self, reduction: str = "mean", mean: List[float] = IMAGENET_MEAN,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/pieapp.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
131	    """
132	    _weights_url = "https://github.com/photosynthesis-team/piq/releases/download/v0.5.4/PieAPPv0.1.pth"
133	
134	    def __init__(self, reduction: str = "mean", data_range: Union[int, float] = 1.0, stride: int = 27,

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/utils/common.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
183	    
184	    with urlopen(url) as source, open(download_target, "wb") as output:
185	        while True:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/utils/common.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
185	        while True:
186	            buff = source.read(8192)
187	            if not buff:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/piq/utils/common.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
189	
190	            output.write(buff)
191	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/setup.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
9	    with open(os.path.join(here, rel_path), 'r') as fp:
10	        return fp.read().splitlines()
11	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	with open("README.rst", "r") as f, open("requirements.txt", "r") as g:
24	    long_description = f.read()
25	    required = g.read().splitlines()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	    long_description = f.read()
25	    required = g.read().splitlines()
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/piq-0.8.0/piq-0.8.0/setup.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	    long_description_content_type="text/x-rst",
36	    url="https://github.com/photosynthesis-team/piq",
37	    install_requires=required,

--------------------------------------------------

Code scanned:
	Total lines of code: 5889
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 22.0
		High: 1.0
Files skipped (0):
