Run started:2025-04-12 18:12:33.429889

Test results:
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/operate.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
243	    logger.info("Removing directory %s", p)
244	    shutil.rmtree(p, ignore_errors=True)
245	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/operate.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
247	def clear_image_leftovers(project_spec: BigflowProjectSpec):
248	    _rmtree(project_spec.project_dir / ".image")
249	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/operate.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
251	def clear_dags_leftovers(project_spec: BigflowProjectSpec):
252	    _rmtree(project_spec.project_dir / ".dags")
253	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/operate.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
275	def clear_package_leftovers(project_spec: BigflowProjectSpec):
276	    _rmtree(project_spec.project_dir / "build")
277	    _rmtree(project_spec.project_dir / "dist")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/operate.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
276	    _rmtree(project_spec.project_dir / "build")
277	    _rmtree(project_spec.project_dir / "dist")
278	    _rmtree(project_spec.project_dir / f"{project_spec.name}.egg")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/operate.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
277	    _rmtree(project_spec.project_dir / "dist")
278	    _rmtree(project_spec.project_dir / f"{project_spec.name}.egg")
279	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/pip.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
65	        logger.info("Write pip requirements file: %s", requirements_txt)
66	        out.write(textwrap.dedent(f"""\
67	            # *** autogenerated: don't edit ***
68	            # $source-hash: {source_hash}
69	            # $source-file: {requirements_in}
70	            #
71	            # run 'bigflow build-requirements {requirements_in}' to update this file
72	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/pip.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
73	        """))
74	        out.write(reqs_content)
75	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/reflect.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
216	        logger.info("Unpack %s to %s", pkg, tempdir)
217	        tarfile.open(pkg).extractall(tempdir)
218	        pkgdir = _expect_single_file(tempdir, "*")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/build/spec.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
221	        raise ValueError(
222	            "The project configuration is invalid. "
223	            "Check the documentation how to create a valid `setup.py`: "
224	            "https://github.com/allegro/bigflow/blob/master/docs/project_structure_and_build.md"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/cli.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
411	                        action=VaultEndpointVerifyAction,
412	                        help='Can be "true", "false", a path to certificate PEM file or a path to '
413	                             'directory with PEM files (see the link for details). '
414	                             'Enables/disables vault endpoint TLS certificate verification. Enabled by default. '
415	                             'Disabling makes execution vulnerable for MITM attacks - do it only when justified and in trusted environments. '
416	                             'For details see: https://requests.readthedocs.io/en/latest/user/advanced/#ssl-cert-verification',
417	                        dest='vault_endpoint_verify',

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/cli.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
819	                    self.last_incomplete_msg = msg
820	                self.stream.write(msg)
821	                self.stream.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/commons.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
152	            try:
153	                raw: bytes = self.stream.read()
154	            except (ValueError, EOFError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/commons.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
248	            input = input.encode()
249	        process.stdin.write(input)
250	        process.stdin.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/configuration.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	
52	        s.write(env_name)
53	        s.write(" config:\n")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/configuration.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
52	        s.write(env_name)
53	        s.write(" config:\n")
54	        pp.pprint(self.resolve(env_name))

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/dagbuilder.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
19	    logger.info("clearing dags_output_dir %s", dags_dir_path)
20	    shutil.rmtree(str(dags_dir_path.resolve()))
21	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/deploy.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
284	    headers = {'X-Vault-Token': vault_secret}
285	    response = requests.get(vault_endpoint, headers=headers, verify=vault_endpoint_verify)
286	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/resources.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	    with open(file_path, 'w+') as f:
133	        f.write(body)
134	    return file_path

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/testing/isolate.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
165	
166	            process = mp_context.Process(
167	                name=f"isolated-test--{self.id}",
168	                target=self.run0, args=[client_ch, tblib_enabled],
169	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/bigflow/version.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
106	        env = {"GIT_INDEX_FILE": tf.name}
107	        tf.write(indexf.read_bytes())
108	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	with open("README.md", "r") as fh:
8	    long_description = fh.read()
9	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
17	    version_globals = {}
18	    exec(version_file.read(), version_globals)
19	    version = version_globals['__version__']

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
17	    version_globals = {}
18	    exec(version_file.read(), version_globals)
19	    version = version_globals['__version__']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/setup.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	    long_description_content_type="text/markdown",
30	    url="https://github.com/allegro/bigflow",
31	    packages=setuptools.find_packages(exclude=('test', 'e2e')),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_dev.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	            description="Sample bigflow project",
42	            url="http://example.org",
43	            version="1.2.3",

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_dist.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
40	    if dir_path.exists() and dir_path.is_dir():
41	        shutil.rmtree(dir_path)
42	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_dist.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
135	        with open(os.path.join(module_dir, module_file_name), 'r') as f:
136	            content = f.read()
137	            if substring not in content:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_dist.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
249	        with open(dag_file_path, 'r') as f:
250	            return workflow_id in f.read()
251	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_dist.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
307	        image_dir_path = Path('image_dir')
308	        rmdir(image_dir_path)
309	        export_docker_image_to_file.side_effect = Exception('export failed')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_pip.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	
36	        req_in.write_text("""
37	        --extra-index-url https://example.org/python/repo

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_spec.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	            'description': "No",
105	            'url': "http://example.org/myproject",
106	        }
107	        s.test_framework = 'pytest'
108	        s.export_image_tar = False
109	
110	        # when

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_spec.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
148	        description="Sample bigflow project",
149	        url="http://example.org",
150	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_spec.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
161	        description="Sample bigflow project",
162	        url="http://example.org",
163	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/buildd/test_spec.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	        description="Sample bigflow project",
175	        url="http://example.org",
176	    )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/cli/test_cli.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
544	
545	        shutil.rmtree(Path.cwd() / ".image", ignore_errors=True)
546	        self._touch_file('image-123.tar', '', '.image')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/cli/test_cli.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
569	        # given
570	        shutil.rmtree(Path.cwd() / ".image", ignore_errors=True)
571	        self._touch_file('imageinfo-123.toml', '', '.image')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/cli/test_cli.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
642	        # given
643	        shutil.rmtree(Path.cwd() / ".image", ignore_errors=True)
644	        self._touch_file('imageinfo-123.toml', '', '.image')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/test_deploy.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	TEST_VAULT_ENDPOINT = 'https://example.com/v1/gcp/token'
22	TEST_VAULT_SECRET = 'secret'

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/test_deploy.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
244	            for version in [version1, version2]:
245	                f.write(f'{docker_repository}:{version}\n')
246	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bigflow-1.11.3/bigflow-1.11.3/test/test_scaffold.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
177	    def tearDown(self):
178	        shutil.rmtree(self.tmp_dir)
179	

--------------------------------------------------

Code scanned:
	Total lines of code: 9523
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 30.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 1.0
Files skipped (0):
