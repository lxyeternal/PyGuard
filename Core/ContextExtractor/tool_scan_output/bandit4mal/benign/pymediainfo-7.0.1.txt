Run started:2025-04-12 12:10:43.908324

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	#: Base URL for downloading MediaInfo library
26	BASE_URL: str = "https://mediaarea.net/download/binary/libmediainfo0"
27	
28	#: Version of the bundled MediaInfo library
29	MEDIAINFO_VERSION: str = "24.12"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
47	    blake2b = hashlib.blake2b()
48	    with open(file_path, "rb") as f:
49	        while chunk := f.read(chunksize):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
48	    with open(file_path, "rb") as f:
49	        while chunk := f.read(chunksize):
50	            blake2b.update(chunk)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	        key = (self.platform, self.arch)
100	        expected = MEDIAINFO_HASHES.get(key)
101	        # Check expected hash exists

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
119	        """Download the compressed file from upstream URL."""
120	        response = requests.get(url, stream=True, timeout=timeout)
121	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
121	        response.raise_for_status()
122	        with open(outpath, "wb") as f:
123	            for chunk in response.iter_content(chunk_size=8192):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
123	            for chunk in response.iter_content(chunk_size=8192):
124	                f.write(chunk)
125	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
123	            for chunk in response.iter_content(chunk_size=8192):
124	                f.write(chunk)
125	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
157	        elif compressed_file.endswith(".tar.bz2") and self.platform == "darwin":
158	            with tarfile.open(file) as fd:
159	                kwargs: dict[str, Any] = {}

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
330	    if args.auto:
331	        args.platform = platform.system().lower()
332	        args.arch = platform.machine().lower()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
330	    if args.auto:
331	        args.platform = platform.system().lower()
332	        args.arch = platform.machine().lower()

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/scripts/download_library.py:331
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
330	    if args.auto:
331	        args.platform = platform.system().lower()
332	        args.arch = platform.machine().lower()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/src/pymediainfo/__init__.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
494	                warnings.warn(
495	                    "This version of MediaInfo (v{}) does not support resetting all "
496	                    "options to their default values, passing it custom options is not recommended "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/src/pymediainfo/__init__.py:516
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
515	            while True:
516	                buffer = filename.read(buffer_size)
517	                if buffer:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
40	        with open(os.path.join(data_dir, "sample.xml"), "r", encoding="utf-8") as f:
41	            self.xml_data = f.read()
42	        self.media_info = MediaInfo(self.xml_data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
73	        with open(os.path.join(data_dir, "issue100.xml"), encoding="utf-8") as f:
74	            media_info = MediaInfo(f.read())
75	        general_tracks = [track for track in media_info.tracks if track.track_type == "General"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
88	        with open(os.path.join(data_dir, "invalid.xml"), "r", encoding="utf-8") as f:
89	            self.xml_data = f.read()
90	

--------------------------------------------------
>> Issue: [B827:httpserver] http.server.HTTPServer
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b827_httpserver.html
175	        # Pick a random port so that parallel tests (e.g. via 'tox -p') do not clash
176	        self.httpd = http.server.HTTPServer(("", 0), HandlerClass)
177	        port = self.httpd.socket.getsockname()[1]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
177	        port = self.httpd.socket.getsockname()[1]
178	        self.url = f"http://127.0.0.1:{port}/sample.mkv"
179	        threading.Thread(target=self.httpd.serve_forever).start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
178	        self.url = f"http://127.0.0.1:{port}/sample.mkv"
179	        threading.Thread(target=self.httpd.serve_forever).start()
180	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
222	    def test_normalize_filename_url(self) -> None:
223	        filename = MediaInfo._normalize_filename("https://localhost")
224	        self.assertEqual(filename, "https://localhost")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
223	        filename = MediaInfo._normalize_filename("https://localhost")
224	        self.assertEqual(filename, "https://localhost")
225	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
359	    for _ in range(thread_count):
360	        thread = threading.Thread(target=target)
361	        thread.start()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymediainfo-7.0.1/pymediainfo-7.0.1/tests/test_pymediainfo.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
417	        with open(os.path.join(data_dir, "other_track.xml"), encoding="utf-8") as f:
418	            self.mi_other = MediaInfo(f.read())
419	

--------------------------------------------------

Code scanned:
	Total lines of code: 1167
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 23.0
		High: 1.0
Files skipped (0):
