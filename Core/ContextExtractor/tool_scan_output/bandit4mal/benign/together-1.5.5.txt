Run started:2025-04-12 15:22:30.147500

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	        try:
130	            retry_ms_header = response_headers.get("retry-after-ms", None)
131	            return float(retry_ms_header) / 1000

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	        # Next, try parsing `retry-after` header as seconds (allowing nonstandard floats).
136	        retry_header = str(response_headers.get("retry-after"))
137	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	            assert isinstance(resp.data, dict)
340	            error_resp = resp.data.get("error")
341	            assert isinstance(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:449
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
448	            raise error.APIConnectionError(
449	                "Unrecognized HTTP method %r. This may indicate a bug in the "
450	                "Together SDK. Please contact us by filling out https://www.together.ai/contact for "
451	                "assistance." % (options.method,)
452	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
490	        try:
491	            result = _thread_context.session.request(
492	                options.method,
493	                abs_url,
494	                headers=headers,
495	                data=data,
496	                files=options.files,
497	                stream=stream,
498	                timeout=request_timeout or self.timeout,
499	                proxies=_thread_context.session.proxies,
500	                allow_redirects=options.allow_redirects,
501	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:491
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
490	        try:
491	            result = _thread_context.session.request(
492	                options.method,
493	                abs_url,
494	                headers=headers,
495	                data=data,
496	                files=options.files,
497	                stream=stream,
498	                timeout=request_timeout or self.timeout,
499	                proxies=_thread_context.session.proxies,
500	                allow_redirects=options.allow_redirects,
501	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
507	            if remaining_retries > 0:
508	                return self._retry_request(
509	                    options,
510	                    remaining_retries=remaining_retries,
511	                    response_headers=result_headers,
512	                    stream=stream,
513	                    request_timeout=request_timeout,
514	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
507	            if remaining_retries > 0:
508	                return self._retry_request(
509	                    options,
510	                    remaining_retries=remaining_retries,
511	                    response_headers=result_headers,
512	                    stream=stream,
513	                    request_timeout=request_timeout,
514	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
522	            if remaining_retries > 0:
523	                return self._retry_request(
524	                    options,
525	                    remaining_retries=remaining_retries,
526	                    response_headers=result_headers,
527	                    stream=stream,
528	                    request_timeout=request_timeout,
529	                )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
522	            if remaining_retries > 0:
523	                return self._retry_request(
524	                    options,
525	                    remaining_retries=remaining_retries,
526	                    response_headers=result_headers,
527	                    stream=stream,
528	                    request_timeout=request_timeout,
529	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
544	                if remaining_retries > 0:
545	                    return self._retry_request(
546	                        options,
547	                        remaining_retries=remaining_retries,
548	                        response_headers=result_headers,
549	                        stream=stream,
550	                        request_timeout=request_timeout,
551	                    )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
544	                if remaining_retries > 0:
545	                    return self._retry_request(
546	                        options,
547	                        remaining_retries=remaining_retries,
548	                        response_headers=result_headers,
549	                        stream=stream,
550	                        request_timeout=request_timeout,
551	                    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
559	            response_code=status_code,
560	            processing_ms=result_headers.get("x-total-time"),
561	            request_id=result_headers.get("CF-RAY"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
560	            processing_ms=result_headers.get("x-total-time"),
561	            request_id=result_headers.get("CF-RAY"),
562	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
590	        try:
591	            result = await session.request(
592	                method=options.method,
593	                url=abs_url,
594	                headers=headers,
595	                data=data,
596	                timeout=timeout,
597	                allow_redirects=options.allow_redirects,
598	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
590	        try:
591	            result = await session.request(
592	                method=options.method,
593	                url=abs_url,
594	                headers=headers,
595	                data=data,
596	                timeout=timeout,
597	                allow_redirects=options.allow_redirects,
598	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
602	                response_code=result.status,
603	                processing_ms=result.headers.get("x-total-time"),
604	                request_id=result.headers.get("CF-RAY"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
603	                processing_ms=result.headers.get("x-total-time"),
604	                request_id=result.headers.get("CF-RAY"),
605	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:621
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
620	        """Returns the response(s) and a bool indicating whether it is a stream."""
621	        content_type = result.headers.get("Content-Type", "")
622	        if stream and "text/event-stream" in content_type:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
650	        """Returns the response(s) and a bool indicating whether it is a stream."""
651	        if stream and "text/event-stream" in result.headers.get("Content-Type", ""):
652	            return (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
689	        try:
690	            content_type = rheaders.get("Content-Type", "")
691	            if isinstance(rbody, bytes):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/abstract/api_requestor.py:717
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
716	    async def __aenter__(self) -> aiohttp.ClientSession:
717	        self._session = together.aiosession.get()
718	        if self._session is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/cli/api/finetune.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	_CONFIRMATION_MESSAGE = (
31	    "You are about to create a fine-tuning job. "
32	    "The cost of your job will be determined by the model size, the number of tokens "
33	    "in the training file, the number of tokens in the validation file, the number of epochs, and "
34	    "the number of evaluations. Visit https://www.together.ai/pricing to get a price estimate.\n"
35	    "You can pass `-y` or `--confirm` to your command to skip this message.\n\n"
36	    "Do you want to proceed?"
37	)
38	
39	
40	class DownloadCheckpointTypeChoice(click.Choice):
41	    def __init__(self) -> None:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/cli/api/images.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
75	        if choice.b64_json:
76	            data = base64.b64decode(choice.b64_json)
77	        elif choice.url:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/cli/api/images.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
75	        if choice.b64_json:
76	            data = base64.b64decode(choice.b64_json)
77	        elif choice.url:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/cli/api/images.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
77	        elif choice.url:
78	            data = requests.get(choice.url).content
79	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/constants.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	# API defaults
12	BASE_URL = "https://api.together.xyz/v1"
13	
14	# Download defaults
15	DOWNLOAD_BLOCK_SIZE = 10 * 1024 * 1024  # 10 MB

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/constants.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	# Messages
19	MISSING_API_KEY_MESSAGE = """TOGETHER_API_KEY not found.
20	Please set it as an environment variable or set it as together.api_key
21	Find your TOGETHER_API_KEY at https://api.together.xyz/settings/api-keys"""
22	
23	# Minimum number of samples required for fine-tuning file
24	MIN_SAMPLES = 1

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/filemanager.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
51	
52	        os.chmod(src.as_posix(), stat.S_IMODE(cache_dir_mode))
53	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/filemanager.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
51	
52	        os.chmod(src.as_posix(), stat.S_IMODE(cache_dir_mode))
53	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/filemanager.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	
68	    parts = headers.get("Content-Range", "").split(" ")
69	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/filemanager.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	
93	    content_type = str(headers.get("content-type"))
94	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/filemanager.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	                if not fetch_metadata:
214	                    file_size = int(response.headers.get("content-length", 0))
215	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/filemanager.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
226	                        pbar.update(len(chunk))
227	                        temp_file.write(chunk)
228	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/filemanager.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
226	                        pbar.update(len(chunk))
227	                        temp_file.write(chunk)
228	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/filemanager.py:309
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
308	
309	        response, _, _ = requestor.request(
310	            options=TogetherRequest(
311	                method="POST",
312	                url=url,
313	            ),

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/filemanager.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
367	                else:
368	                    response, _, _ = requestor.request(
369	                        options=TogetherRequest(
370	                            method="PUT",
371	                            url=url,
372	                            params=wrapped_file,
373	                        ),

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/types/audio_speech.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
107	                    # decode base64
108	                    audio = base64.b64decode(stream_event_response.response.data.b64)
109	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/types/audio_speech.py:108
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
107	                    # decode base64
108	                    audio = base64.b64decode(stream_event_response.response.data.b64)
109	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/utils/files.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
237	        with file.open(encoding="utf-8") as f:
238	            f.read()
239	        report_dict["utf8"] = True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/together-1.5.5/together-1.5.5/src/together/utils/files.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
255	                        message=(
256	                            f"Error parsing file. Invalid format on line {idx + 1} of the input file. "
257	                            "Datasets must follow text, conversational, or instruction format. For more"

--------------------------------------------------

Code scanned:
	Total lines of code: 7347
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 38.0
		High: 3.0
Files skipped (0):
