Run started:2025-04-12 18:22:40.379581

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	
75	        resp = requests.get(
76	            url=f"{self.host}/datasets/api/v2/datasets/{dataset_name}/r/main",
77	            params=data,
78	            headers=headers,
79	            cookies=self.odl_cookie,
80	            timeout=TIMEOUT,
81	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
106	
107	        resp = requests.get(
108	            url=f"{self.host}/datasets/api/v2/downloadCheck/{dataset_id}/main/{path}",
109	            headers=headers,
110	            cookies=self.odl_cookie,
111	            timeout=TIMEOUT,
112	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
131	
132	        resp = requests.get(
133	            url=f"{self.host}/datasets/resolve/{dataset_id}/main/{dataset_dict['name']}",
134	            headers=headers,
135	            cookies=self.odl_cookie,
136	            allow_redirects=False,
137	            timeout=TIMEOUT,
138	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
146	        parsed_dataset_name = quote(dataset_name.replace("/", ","))
147	        resp = requests.get(
148	            url=f"{self.host}{computed_url}datasets/{parsed_dataset_name}",
149	            headers=base_headers,
150	            cookies=self.odl_cookie,
151	            timeout=TIMEOUT,
152	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
169	            file_path = file_path[1:]
170	        resp = requests.post(
171	            url=f"{self.host}{computed_url}preUpload/{dataset}/{branch}/{file_path}",
172	            data=json.dumps(req),
173	            headers=headers,
174	            cookies=self.odl_cookie,
175	            timeout=TIMEOUT,
176	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
188	            file_path = file_path.split('/', 1)[-1]
189	        resp = requests.post(
190	            url=f"{self.host}{computed_url}postUpload/{dataset}/{branch}/{file_path}",
191	            data=json.dumps(req),
192	            headers=headers,
193	            cookies=self.odl_cookie,
194	            timeout=TIMEOUT,
195	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
204	        headers = self.http_authorization_header()
205	        resp = requests.post(
206	            url=f"{self.host}/datasets/api/v2/datasets",
207	            data=json.dumps(req),
208	            headers=headers,
209	            cookies=self.odl_cookie,
210	            timeout=TIMEOUT,
211	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
225	        headers = self.http_authorization_header()
226	        resp = requests.post(
227	            url=f"{self.host}/datasets/api/v2/datasets/{parsed_dataset_name}/commit",
228	            data=json.dumps(req[1]),
229	            headers=headers,
230	            cookies=self.odl_cookie,
231	            timeout=TIMEOUT,
232	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
266	
267	        resp = requests.post(
268	            url=f"{self.host}{computed_url}datasets/{dataset_repo_name}/actions/changeState?state={permission}",
269	            headers=headers,
270	            cookies=self.odl_cookie,
271	            timeout=TIMEOUT,
272	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
284	        """track the operation of getting dataset files"""
285	        resp = requests.post(
286	            url=f"{self.host}/datasets/api/v2/track/datasets/cli/ls/{dataset_name}",
287	            headers=base_headers,
288	            cookies=self.odl_cookie,
289	            timeout=TIMEOUT,
290	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
301	        body = {"path": file_path}
302	        resp = requests.post(
303	            url=f"{self.host}/datasets/api/v2/track/datasets/cli/download/{dataset_name}",
304	            headers=headers,
305	            cookies=self.odl_cookie,
306	            data=body,
307	            timeout=TIMEOUT,
308	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
322	
323	        resp = requests.post(
324	            url=f"{self.host}/datasets/api/v2/datasets/{dataset_name}/actions/validate",
325	            headers=headers,
326	            cookies=self.odl_cookie,
327	            timeout=TIMEOUT,
328	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/api.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
352	        body = {"content": content, "type": text_type}
353	        resp = requests.post(
354	            url=f"{self.host}/datasets/api/v2/datasets/textAudit",
355	            headers=headers,
356	            cookies=self.odl_cookie,
357	            data=json.dumps(body),
358	            timeout=TIMEOUT,
359	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/client/uaa.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
21	        data = json.dumps(client_id)
22	        resp = requests.post(url=auth_url,
23	                             data=data,
24	                             headers={
25	                                 "Content-Type": "application/json",
26	                                 "Cookie": f"ssouid={sso_uid}",
27	                             }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/constants.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	odl_clientId = "kmz3bkwzlaa3wrq8pvwa"
28	endpoint = "https://openxlab.org.cn"
29	uaa_url_prefix = "https://sso.openxlab.org.cn/gw/uaa-be"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/constants.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	endpoint = "https://openxlab.org.cn"
29	uaa_url_prefix = "https://sso.openxlab.org.cn/gw/uaa-be"
30	
31	
32	computed_url = "/datasets/api/v2/"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/handler/get_dataset_repository.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	            # add a new line to print progress of big file
117	            sys.stdout.write("\n")
118	            download_url = client.get_api().get_dataset_download_urls(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
43	                        break
44	                    cache.write(chunk)
45	                    self.range_curser += len(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	    def start(self):
52	        threading.Thread(target=self.__run, daemon=True).start()
53	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
72	def fetch_data(url: str, headers: dict):
73	    resp = requests.get(url, stream=True, timeout=TIMEOUT, headers=headers)
74	    return resp

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
127	            self.__download_record = []
128	            threading.Thread(target=self.__supervise, daemon=True).start()
129	            # main

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	        try:
137	            resp = requests.get(self.url, stream=True, timeout=TIMEOUT)
138	            # time.sleep(1)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
298	        # Register Ctrl+C handler for windows to interrupt thread
299	        signal.signal(signal.SIGINT, ctrl_c_handler)
300	        for start, end in self.__ask_for_work(self.blocks_num):

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:299
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
298	        # Register Ctrl+C handler for windows to interrupt thread
299	        signal.signal(signal.SIGINT, ctrl_c_handler)
300	        for start, end in self.__ask_for_work(self.blocks_num):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
392	                with open(cache_filename, "rb") as cache_file:
393	                    data = cache_file.read(chunk_size)
394	                    while data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
394	                    while data:
395	                        f.write(data)
396	                        f.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
396	                        f.flush()
397	                        data = cache_file.read(chunk_size)
398	        self.clear()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
402	    def __whistleblower(self, saying: str):
403	        sys.stdout.write(saying)
404	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
409	        with open(filename, "rb") as f:
410	            data = f.read(chunk_size)
411	            while data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
412	                md5.update(data)
413	                data = f.read(chunk_size)
414	        return md5.hexdigest()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/downloader.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
445	                if chunk:
446	                    f.write(chunk)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/upload.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
54	
55	signal.signal(signal.SIGINT, signal_handler)
56	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/upload.py:55
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
54	
55	signal.signal(signal.SIGINT, signal_handler)
56	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/upload.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	            with open(self.ckpt_file_path, "w", encoding="utf-8") as f:
116	                f.write(self.to_json())
117	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/upload.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
161	                with open(self.ckpt_file_path, "r") as f:
162	                    content = f.read()
163	                    ckpt_info = json.loads(content)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/io/upload.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
193	                            f.seek(offset)
194	                            with io.BufferedReader(io.BytesIO(f.read(read_size))) as data:
195	                                put_resp = put_file(url=part_put_url, data=data)

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/utility/concurrency.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
34	
35	    with ThreadPoolExecutor(max_workers=workers) as executor:
36	        futures = [executor.submit(wrapper, *args) for _ in range(workers)]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/utility/concurrency.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	        results = []
38	        threading.Thread(target=wait_result, args=[futures, results], daemon=True).start()
39	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/utility/concurrency.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
49	def concurrent_map(func: Callable, workers: int, iters: Iterable):
50	    with ThreadPoolExecutor(max_workers=workers) as executor:
51	        results = executor.map(func, iters)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/utility/concurrency.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
55	def is_mac():
56	    return platform.system() == "Darwin"
57	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/utility/concurrency.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
55	def is_mac():
56	    return platform.system() == "Darwin"
57	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/utility/concurrency.py:56
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
55	def is_mac():
56	    return platform.system() == "Darwin"
57	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/utils.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	def get_api_token_from_env():
24	    return os.environ.get("OPENDATALAB-API-TOKEN", "")
25	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/utils.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
150	        while True:
151	            data = f.read(buf_size)
152	            if not data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/dataset/utils.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
182	        while True:
183	            data = f.read(buf_size)
184	            if not data:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/clients/modelapi_client.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
28	        print(f"payload:{payload}")
29	        response = requests.post(self.endpoint, files=payload["files"], data=data, headers=headers)
30	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/clients/modelapi_client.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
103	
104	            image_bytes = base64.b64decode(image_data)
105	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/clients/modelapi_client.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
103	
104	            image_bytes = base64.b64decode(image_data)
105	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/clients/modelapi_client.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	            with open(file_path, "wb") as file:
107	                file.write(image_bytes)
108	            output_file_list.append(file_path)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/clients/openapi_client.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
21	            ignore = [ignore]
22	        client_from = os.environ.get('CLIENT_FROM', '0')
23	        payload = {"userName": username, "repositoryName": repository, "modelNames": model_name, "filePaths": filepath,

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/clients/openapi_client.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
173	        # print(f"headers:{headers}, body:{payload}")
174	        response = requests.post(f"{self.endpoint}{path}", json=payload, headers=headers)
175	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/clients/upload_service_client.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
40	        print(f"headers:{headers}, body:{payload}")
41	        response = requests.post(f"{self.endpoint}{path}", json=payload, headers=headers)
42	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/common/constants.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	
8	model_openapi_url_prefix_dev = "https://dev.openxlab.org.cn/api/v1"
9	model_openapi_url_prefix_staging = "https://staging.openxlab.org.cn/api/v1"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/common/constants.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	model_openapi_url_prefix_dev = "https://dev.openxlab.org.cn/api/v1"
9	model_openapi_url_prefix_staging = "https://staging.openxlab.org.cn/api/v1"
10	model_openapi_url_prefix_prod = "https://openapi.openxlab.org.cn/api/v1"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/common/constants.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	model_openapi_url_prefix_staging = "https://staging.openxlab.org.cn/api/v1"
10	model_openapi_url_prefix_prod = "https://openapi.openxlab.org.cn/api/v1"
11	model_url_prefix_dev = "http://10.1.100.130:10019"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/common/constants.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
10	model_openapi_url_prefix_prod = "https://openapi.openxlab.org.cn/api/v1"
11	model_url_prefix_dev = "http://10.1.100.130:10019"
12	model_cache_path = os.path.join(os.path.expanduser("~"), ".cache", "model")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/common/constants.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	# oss_endpoint = 'https://openmmlab-open.oss-cn-shanghai.aliyuncs.com'
36	oss_endpoint = "https://oss-cn-shanghai.aliyuncs.com"
37	oss_bucket_domain_dev = "openmmlab-open.oss-cn-shanghai.aliyuncs.com"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/common/constants.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	default_metafile_template_name = "metafile.yaml"
44	river_pass_url_dev = "http://106.14.134.80:10006/getFile"
45	river_pass_url_staging = "http://riverpass.staging.openxlab.org.cn/getFile"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/common/constants.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	river_pass_url_dev = "http://106.14.134.80:10006/getFile"
45	river_pass_url_staging = "http://riverpass.staging.openxlab.org.cn/getFile"
46	river_pass_url_prod = "http://riverpass.openxlab.org.cn/getFile"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/common/constants.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	river_pass_url_staging = "http://riverpass.staging.openxlab.org.cn/getFile"
46	river_pass_url_prod = "http://riverpass.openxlab.org.cn/getFile"
47	river_pass_url = river_pass_url_prod

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/common/thread_pool.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
5	    def __init__(self, max_workers=5):
6	        self.executor = ThreadPoolExecutor(max_workers=max_workers)
7	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/handler/download_file.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
162	
163	    response = requests.get(url, stream=True)
164	    response.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/handler/download_file.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
164	    response.raise_for_status()
165	    total_size_in_bytes = int(response.headers.get("content-length", 0))
166	    block_size = 1024

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/handler/download_file.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	            progress_bar.update(len(data))
171	            f.write(data)
172	    progress_bar.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/handler/download_file.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
182	        if file_size <= 128:  # 如果文件小于等于128字节
183	            combined_block = file.read(file_size)  # 只读取一次，并将所有数据组合在一起
184	            hasher.update(combined_block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/handler/download_file.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
186	            file.seek(0)  # 将文件指针移动到文件开头
187	            first_block = file.read(64)
188	            hasher.update(first_block)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/handler/download_file.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
189	            file.seek(-64, 2)  # 将文件指针移动到文件末尾-64处
190	            last_block = file.read(64)
191	            hasher.update(last_block)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/model/handler/model_inference.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	            # if input is a URL
76	            response = requests.get(input_str)
77	            input_data = response.content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/utils/auth.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	            with open(config_path, encoding='utf-8') as f:
21	                config_content = f.read()
22	            config_dict = json.loads(config_content)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/utils/file.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
7	    with open(file_name, encoding='utf-8') as f:
8	        content = f.read()
9	    return content

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/clients/auth_client.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
32	        headers = http_common_header()
33	        response = requests.post(f"{self.endpoint}{path}", json=payload, headers=headers)
34	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/clients/version_client.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
47	        headers = http_common_header()
48	        response = requests.post(f"{self.endpoint}{path}", json=payload, headers=headers)
49	        response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/commands/login_command.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	            return
28	        print("openxlab: You can find your Access key & Secrete Key in your browser here: "
29	              "https://sso.openxlab.org.cn/usercenter?tab=secret")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/handler/user_config.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	            raise Exception(
58	                'Please login openxlab and config ak/sk, try "openxlab login" '
59	                "and refer to https://openxlab.org.cn/docs/developers/鉴权管理.html"
60	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/handler/user_config.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
92	        with open(get_config_path(), mode="w", encoding="utf-8") as f:
93	            f.write(config_json)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/handler/user_token.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	AUTH_CLIENT = AuthClient("https://openapi.openxlab.org.cn/api/v1/sso-be/api/v1/open/")
25	VERSION_CLIENT = VersionClient("https://openxlab.org.cn/gw/openxlab-xlab/")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/handler/user_token.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	AUTH_CLIENT = AuthClient("https://openapi.openxlab.org.cn/api/v1/sso-be/api/v1/open/")
25	VERSION_CLIENT = VersionClient("https://openxlab.org.cn/gw/openxlab-xlab/")
26	# AUTH_CLIENT = AuthClient("https://staging.openxlab.org.cn/api/v1/sso-be/api/v1/open/")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/handler/user_token.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
40	        raw_hmac = hmac_obj.digest()
41	        return base64.b64encode(raw_hmac).decode("utf-8")
42	    except KeyError as e:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/handler/user_token.py:41
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
40	        raw_hmac = hmac_obj.digest()
41	        return base64.b64encode(raw_hmac).decode("utf-8")
42	    except KeyError as e:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/handler/user_token.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
141	    """
142	    index_url = "https://pypi.org/simple" if use_official_index else None
143	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/handler/user_token.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
324	        with open(get_token_path(), mode="w", encoding="utf-8") as f:
325	            f.write(token_json)
326	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/openxlab-0.1.2/openxlab-0.1.2/openxlab/xlab/handler/user_token.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
359	                with open(get_version_path(), mode="w", encoding="utf-8") as f:
360	                    f.write(cache_json)
361	        except Exception as e:

--------------------------------------------------

Code scanned:
	Total lines of code: 4723
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 62.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 77.0
		High: 5.0
Files skipped (0):
