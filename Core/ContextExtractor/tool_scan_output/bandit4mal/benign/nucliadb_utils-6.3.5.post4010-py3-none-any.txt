Run started:2025-04-12 17:10:20.149458

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/aiopynecone/client.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	DEFAULT_TIMEOUT = 30
80	CONTROL_PLANE_BASE_URL = "https://api.pinecone.io/"
81	BASE_API_HEADERS = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/authentication.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	
77	            raw_security_groups: Optional[str] = request.headers.get(self.security_groups_header)
78	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/authentication.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
129	            async def websocket_wrapper(*args: typing.Any, **kwargs: typing.Any) -> None:
130	                websocket = kwargs.get("websocket", args[idx])
131	                assert isinstance(websocket, WebSocket)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/authentication.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
133	                if not has_required_scope(websocket, scopes_list):
134	                    await websocket.close()
135	                else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/authentication.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	            async def async_wrapper(*args: typing.Any, **kwargs: typing.Any) -> Response:
144	                request = kwargs.get("request", None)
145	                assert isinstance(request, Request)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/encryption/__init__.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
59	        try:
60	            secret_key = base64.b64decode(encoded_secret_key)
61	        except binascii.Error as ex:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/encryption/__init__.py:60
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
59	        try:
60	            secret_key = base64.b64decode(encoded_secret_key)
61	        except binascii.Error as ex:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
35	    metrics_port: int = 3030
36	    metrics_host: str = "0.0.0.0"
37	    serving_port: int = 8080

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
37	    serving_port: int = 8080
38	    serving_host: str = "0.0.0.0"
39	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
74	        default=None,
75	        description="GCS JSON credentials of a service account encoded in Base64: https://cloud.google.com/iam/docs/service-account-overview",  # noqa
76	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        default=None,
79	        description="GCS Bucket name where files are stored: https://cloud.google.com/storage/docs/buckets",
80	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	        default=None,
83	        description="GCS Bucket location: https://cloud.google.com/storage/docs/locations",
84	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
86	        default=None,
87	        description="Google Cloud Project ID: https://cloud.google.com/resource-manager/docs/creating-managing-projects",  # noqa
88	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	        default={},
91	        description="Map of labels with which GCS buckets will be labeled with: https://cloud.google.com/storage/docs/tags-and-labels",  # noqa
92	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
92	    )
93	    gcs_endpoint_url: str = "https://www.googleapis.com"
94	
95	    s3_client_id: Optional[str] = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
104	        default={},
105	        description="Map of tags with which S3 buckets will be tagged with: https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketTagging.html",  # noqa
106	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
122	        default=None,
123	        description="Azure Account URL. The driver implementation uses Azure's default credential authentication method: https://learn.microsoft.com/en-us/python/api/azure-identity/azure.identity.defaultazurecredential?view=azure-python",  # noqa
124	        examples=["https://<storageaccountname>.blob.core.windows.net"],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
123	        description="Azure Account URL. The driver implementation uses Azure's default credential authentication method: https://learn.microsoft.com/en-us/python/api/azure-identity/azure.identity.defaultazurecredential?view=azure-python",  # noqa
124	        examples=["https://<storageaccountname>.blob.core.windows.net"],
125	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
136	    nuclia_service_account: Optional[str] = None
137	    nuclia_public_url: str = "https://{zone}.nuclia.cloud"
138	    nuclia_processing_cluster_url: str = "http://processing-api.processing.svc.cluster.local:8080"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
137	    nuclia_public_url: str = "https://{zone}.nuclia.cloud"
138	    nuclia_processing_cluster_url: str = "http://processing-api.processing.svc.cluster.local:8080"
139	    nuclia_inner_predict_url: str = "http://predict.learning.svc.cluster.local:8080"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
138	    nuclia_processing_cluster_url: str = "http://processing-api.processing.svc.cluster.local:8080"
139	    nuclia_inner_predict_url: str = "http://predict.learning.svc.cluster.local:8080"
140	    learning_internal_svc_base_url: str = "http://{service}.learning.svc.cluster.local:8080"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/settings.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
139	    nuclia_inner_predict_url: str = "http://predict.learning.svc.cluster.local:8080"
140	    learning_internal_svc_base_url: str = "http://{service}.learning.svc.cluster.local:8080"
141	
142	    nuclia_zone: str = "europe-1"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	
67	DEFAULT_SCOPES = ["https://www.googleapis.com/auth/devstorage.read_write"]
68	MAX_TRIES = 4

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
117	        await self.copy(origin_uri, destination_uri, origin_bucket_name, destination_bucket_name)
118	        await self.storage.delete_upload(origin_uri, origin_bucket_name)
119	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
145	        headers.update({"Content-Type": "application/json"})
146	        async with self.storage.session.post(url, headers=headers) as resp:
147	            if resp.status == 404:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	        )
204	        async with self.storage.session.get(
205	            url, headers=headers, params={"alt": "media"}, timeout=-1
206	        ) as api_resp:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
213	                try:
214	                    chunk = await api_resp.content.read(OBJECT_DATA_CHUNK_SIZE)
215	                except Exception as ex:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
238	            # If there is a temporal url
239	            await self.storage.delete_upload(self.field.upload_uri, self.field.bucket_name)
240	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
283	        )
284	        async with self.storage.session.post(
285	            init_url,
286	            headers=headers,
287	            data=metadata,
288	        ) as call:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
370	            try:
371	                await self.storage.delete_upload(self.field.old_uri, self.field.bucket_name)
372	            except GoogleCloudException as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
415	        headers = await self.storage.get_access_headers()
416	        async with self.storage.session.get(url, headers=headers) as api_resp:
417	            if api_resp.status == 200:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
456	        labels: Optional[Dict[str, str]] = None,
457	        url: str = "https://www.googleapis.com",
458	        scopes: Optional[List[str]] = None,
459	        anonymous: bool = False,
460	    ):
461	        if anonymous:
462	            self._json_credentials = None
463	            self._credentials = google.auth.credentials.AnonymousCredentials()
464	        else:
465	            if account_credentials is None:
466	                self._json_credentials = None
467	            elif isinstance(account_credentials, str) and account_credentials.strip() == "":
468	                self._json_credentials = None
469	            else:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:470
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
469	            else:
470	                self._json_credentials = json.loads(base64.b64decode(account_credentials))
471	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:470
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
469	            else:
470	                self._json_credentials = json.loads(base64.b64decode(account_credentials))
471	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
523	    async def finalize(self):
524	        await self.session.close()
525	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:567
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
566	        url = f"{self.object_base_url}/{bucket_name}/o"
567	        async with self.session.get(
568	            url,
569	            headers=headers,
570	        ) as resp:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:593
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
592	    async def _create_bucket(self, url, headers, bucket_name, labels):
593	        async with self.session.post(
594	            url,
595	            headers=headers,
596	            json={
597	                "name": bucket_name,
598	                "location": self._location,
599	                "labels": labels,
600	                "iamConfiguration": {
601	                    "publicAccessPrevention": "enforced",
602	                    "uniformBucketLevelAccess": {
603	                        "enabled": True,
604	                    },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:704
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
703	            params["startOffset"] = start
704	        async with self.session.get(
705	            url,
706	            headers=headers,
707	            params=params,
708	        ) as resp:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:719
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
718	
719	        page_token = data.get("nextPageToken")
720	        while page_token is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:722
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
721	            headers = await self.get_access_headers()
722	            async with self.session.get(
723	                url,
724	                headers=headers,
725	                params={"prefix": prefix, "pageToken": page_token},
726	            ) as resp:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
727	                data = await resp.json()
728	                items = data.get("items", [])
729	                if len(items) == 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:733
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
732	                    yield ObjectInfo(name=item["name"])
733	                page_token = data.get("nextPageToken")
734	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:757
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
756	        )
757	        async with self.session.post(url, headers=headers, data=data) as resp:
758	            if resp.status != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:764
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
763	def parse_object_metadata(object_data: dict[str, Any], key: str) -> ObjectMetadata:
764	    custom_metadata: dict[str, str] = object_data.get("metadata") or {}
765	    # Lowercase all keys for backwards compatibility with old custom metadata

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
768	    # Parse size
769	    custom_size = custom_metadata.get("size")
770	    if not custom_size or custom_size == "0":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
770	    if not custom_size or custom_size == "0":
771	        data_size = object_data.get("size")
772	        size = int(data_size) if data_size else 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
776	    # Parse content-type
777	    content_type = custom_metadata.get("content_type") or object_data.get("contentType") or ""
778	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
776	    # Parse content-type
777	    content_type = custom_metadata.get("content_type") or object_data.get("contentType") or ""
778	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/gcs.py:780
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
779	    # Parse filename
780	    filename = custom_metadata.get("filename") or key.split("/")[-1]
781	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/local.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	
108	                data = await resp.read(chunk_size)
109	                if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/local.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
154	        async with aiofiles.open(metadata_init_url, "w+") as resp:
155	            await resp.write(raw_metadata)
156	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/local.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	
169	        await self._handler.write(data)
170	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/local.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
198	            async with aiofiles.open(metadata_path, "r") as metadata:
199	                raw_metadata = await metadata.read()
200	                metadata_dict = json.loads(raw_metadata)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/local.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
258	        try:
259	            shutil.rmtree(path)
260	            deleted = True

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/local.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
276	        try:
277	            shutil.rmtree(path)
278	            deleted = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/local.py:310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
309	        with open(path, "wb") as file:
310	            file.write(data)
311	        metadata_path = f"{path}.metadata"

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/local.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
317	        with open(metadata_path, "w") as file:
318	            file.write(json.dumps(metadata.model_dump()))

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
112	            bucket = self.field.bucket_name
113	        downloader = await self._download(uri, bucket, range=range)
114	        stream = downloader["Body"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
114	        stream = downloader["Body"]
115	        data = await stream.read(CHUNK_SIZE)
116	        while True:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
119	            yield data
120	            data = await stream.read(CHUNK_SIZE)
121	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
127	            bucket_name = self.field.bucket_name
128	            await self.storage._s3aioclient.abort_multipart_upload(
129	                Bucket=bucket_name, Key=upload_file_id, UploadId=mpu["UploadId"]
130	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
177	    async def _create_multipart(self, bucket_name: str, upload_id: str, cf: CloudFile):
178	        return await self.storage._s3aioclient.create_multipart_upload(
179	            Bucket=bucket_name,
180	            Key=upload_id,
181	            Metadata={
182	                "FILENAME": cf.filename,
183	                "SIZE": str(cf.size),
184	                "CONTENT_TYPE": cf.content_type,
185	            },

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
234	            try:
235	                await self.storage.delete_upload(
236	                    uri=self.field.old_uri, bucket_name=self.field.old_bucket
237	                )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
244	        if self.field.resumable_uri != "":
245	            await self._complete_multipart_upload()
246	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
271	        }
272	        await self.storage._s3aioclient.complete_multipart_upload(
273	            Bucket=self.field.bucket_name,
274	            Key=self.field.upload_uri,
275	            UploadId=self.field.resumable_uri,
276	            MultipartUpload=part_info,
277	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
330	        await self.copy(origin_uri, destination_uri, origin_bucket_name, destination_bucket_name)
331	        await self.storage.delete_upload(origin_uri, origin_bucket_name)
332	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:589
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
588	    if base64_filename:
589	        filename = base64.b64decode(base64_filename).decode()
590	    else:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/s3.py:589
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
588	    if base64_filename:
589	        filename = base64.b64decode(base64_filename).decode()
590	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/storage.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	        pb = BrainResource()
234	        pb.ParseFromString(bytes_buffer.read())
235	        bytes_buffer.flush()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/storage.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
361	    ):
362	        decoded_payload = base64.b64decode(payload)
363	        cf = CloudFile()

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/storage.py:362
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
361	    ):
362	        decoded_payload = base64.b64decode(payload)
363	        cf = CloudFile()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/storage.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
378	            while True:
379	                data = alldata.read(CHUNK_SIZE)
380	                if data == b"":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/storage.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
409	            while True:
410	                data = alldata.read(CHUNK_SIZE)
411	                if data == b"":

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/storage.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
447	            if data is not None:
448	                result.write(data)
449	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/storage.py:456
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
455	        async for data in self.downloadbytescf_iterator(cf):
456	            result.write(data)
457	        result.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/storage.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
488	        pb = PBKlass()
489	        pb.ParseFromString(payload.read())
490	        return pb

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/storages/storage.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
545	            raise KeyError(f'Stream message data not found for key "{key}"')
546	        return bytes_buffer.read()
547	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/__init__.py:30
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
29	        try:
30	            sock = socket.socket()
31	            sock.bind(("", port))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/__init__.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
31	            sock.bind(("", port))
32	            sock.close()
33	            return port

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/__init__.py:38
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
37	    # give up and let OS pick a free port
38	    sock = socket.socket()
39	    sock.bind(("", 0))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/__init__.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
40	    port = sock.getsockname()[1]
41	    sock.close()
42	    return port

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/gcs.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	        try:
69	            response = requests.get(f"http://{self.host}:{self.get_port()}/storage/v1/b")
70	            return response.status_code == 200

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/gcs.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	    else:
82	        public_api_url = f"http://172.17.0.1:{port}"
83	    yield public_api_url

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/gcs.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
124	        project=storage_settings.gcs_project,
125	        executor=ThreadPoolExecutor(1),
126	        deadletter_bucket=extended_storage_settings.gcs_deadletter_bucket,

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/nats.py:39
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
38	    def check(self):
39	        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
40	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/nats.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
40	        try:
41	            s.connect((self.host, int(self.get_port())))
42	            return True

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/nats.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
62	    # cleanup nats
63	    nc = await nats.connect(servers=[natsd])
64	    await nc.drain()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/nats.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
64	    await nc.drain()
65	    await nc.close()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/tests/s3.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	        try:
49	            response = requests.get(f"http://{self.host}:{self.get_port()}")
50	            return response.status_code == 404

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb_utils-6.3.5.post4010-py3-none-any/nucliadb_utils/utilities.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
159	            indexing_bucket=extended_storage_settings.gcs_indexing_bucket,
160	            executor=ThreadPoolExecutor(extended_storage_settings.gcs_threads),
161	            labels=storage_settings.gcs_bucket_labels,

--------------------------------------------------

Code scanned:
	Total lines of code: 6353
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 64.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 83.0
		High: 7.0
Files skipped (0):
