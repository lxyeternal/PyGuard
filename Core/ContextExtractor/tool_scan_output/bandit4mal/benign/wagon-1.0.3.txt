Run started:2025-04-12 16:39:35.116265

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
24	    # intentionally *not* adding an encoding option to open
25	    return codecs.open(os.path.join(here, *parts), 'r').read()
26	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/setup.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	    version='1.0.3',
31	    url='https://github.com/cloudify-cosmo/wagon',
32	    author='Cloudify',

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/setup.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
36	    description='Creates Python Wheel based archives with dependencies',
37	    long_description=read('README.rst'),
38	    py_modules=['wagon'],

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
30	
31	TEST_TAR = 'https://github.com/pallets/flask/archive/0.10.1.tar.gz'  # NOQA
32	TEST_ZIP = 'https://github.com/pallets/flask/archive/0.10.1.zip'  # NOQA

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	TEST_TAR = 'https://github.com/pallets/flask/archive/0.10.1.tar.gz'  # NOQA
32	TEST_ZIP = 'https://github.com/pallets/flask/archive/0.10.1.zip'  # NOQA
33	TEST_PACKAGE_NAME = 'Flask'

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
39	def _wagon(command):
40	    process = subprocess.Popen(
41	        [sys.executable, '-m', 'wagon'] + command,
42	        stdout=subprocess.PIPE,
43	        stderr=subprocess.PIPE
44	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	        with pytest.raises(wagon.WagonError) as ex:
74	            wagon._download_file('http://www.google.com/x.tar.gz', 'file')
75	        assert "Failed to download file" in str(ex)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
88	        tempdir = tempfile.mkdtemp()
89	        with open(os.path.join(tempdir, 'content.file'), 'w') as f:
90	            f.write('CONTENT')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	        with open(os.path.join(tempdir, 'content.file'), 'w') as f:
90	            f.write('CONTENT')
91	        wagon._tar(tempdir, 'tar.file')

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
89	        with open(os.path.join(tempdir, 'content.file'), 'w') as f:
90	            f.write('CONTENT')
91	        wagon._tar(tempdir, 'tar.file')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
91	        wagon._tar(tempdir, 'tar.file')
92	        shutil.rmtree(tempdir, ignore_errors=True)
93	        assert tarfile.is_tarfile('tar.file')

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
93	        assert tarfile.is_tarfile('tar.file')
94	        with closing(tarfile.open('tar.file', 'r:gz')) as tar:
95	            members = tar.getnames()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
116	        finally:
117	            shutil.rmtree(virtualenv_path, ignore_errors=True)
118	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
124	        finally:
125	            shutil.rmtree('package', ignore_errors=True)
126	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
129	        os.close(fd)
130	        with open(requirements_file_path, 'w') as requirements_file:
131	            requirements_file.write('non_existing_package')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
130	        with open(requirements_file_path, 'w') as requirements_file:
131	            requirements_file.write('non_existing_package')
132	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
130	        with open(requirements_file_path, 'w') as requirements_file:
131	            requirements_file.write('non_existing_package')
132	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
139	        finally:
140	            shutil.rmtree('package', ignore_errors=True)
141	            os.remove(requirements_file_path)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
159	        finally:
160	            shutil.rmtree(virtualenv_path, ignore_errors=True)
161	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
199	        finally:
200	            shutil.rmtree(tempdir, ignore_errors=True)
201	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
413	            os.remove(os.path.join(dir_with_wheels, wheel))
414	            with open(os.path.join(dir_with_wheels, new_wheel), 'w') as whl:
415	                whl.write('wheel_content')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
414	            with open(os.path.join(dir_with_wheels, new_wheel), 'w') as whl:
415	                whl.write('wheel_content')
416	            if once:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
414	            with open(os.path.join(dir_with_wheels, new_wheel), 'w') as whl:
415	                whl.write('wheel_content')
416	            if once:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
431	    for wheel in wheels:
432	        with open(os.path.join(dir_with_wheels, wheel), 'w') as whl:
433	            whl.write('wheel_content')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
432	        with open(os.path.join(dir_with_wheels, wheel), 'w') as whl:
433	            whl.write('wheel_content')
434	    yield dir_with_wheels

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
432	        with open(os.path.join(dir_with_wheels, wheel), 'w') as whl:
433	            whl.write('wheel_content')
434	    yield dir_with_wheels

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
434	    yield dir_with_wheels
435	    shutil.rmtree(dir_with_wheels, ignore_errors=True)
436	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
443	        # We fill it up so that it fails.
444	        with open(source_input, 'w') as f:
445	            f.write('something')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
444	        with open(source_input, 'w') as f:
445	            f.write('something')
446	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
444	        with open(source_input, 'w') as f:
445	            f.write('something')
446	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:462
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
461	        finally:
462	            shutil.rmtree(source_input, ignore_errors=True)
463	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:508
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
507	        if os.path.isdir(self.package_name):
508	            shutil.rmtree(self.package_name, ignore_errors=True)
509	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:521
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
520	            wagon._unzip(self.archive_name, '.')
521	        with open(os.path.join(
522	                self.package_name,
523	                wagon.METADATA_FILE_NAME)) as f:
524	            metadata = json.loads(f.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
523	                wagon.METADATA_FILE_NAME)) as f:
524	            metadata = json.loads(f.read())
525	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
587	        with tempfile.NamedTemporaryFile(delete=False) as f:
588	            f.write(b'virtualenv==13.1.2')
589	        result = _wagon([

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
587	        with tempfile.NamedTemporaryFile(delete=False) as f:
588	            f.write(b'virtualenv==13.1.2')
589	        result = _wagon([

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:600
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
599	        temp_dir = tempfile.mkdtemp()
600	        shutil.rmtree(temp_dir, ignore_errors=True)
601	        package = 'wheel'

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
615	        finally:
616	            shutil.rmtree(temp_dir, ignore_errors=True)
617	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:641
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
640	        os.close(fd)
641	        with open(requirements_file_path, 'w') as requirements_file:
642	            requirements_file.write('wheel')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
641	        with open(requirements_file_path, 'w') as requirements_file:
642	            requirements_file.write('wheel')
643	        result = _wagon([

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
641	        with open(requirements_file_path, 'w') as requirements_file:
642	            requirements_file.write('wheel')
643	        result = _wagon([

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
685	
686	        with open(temp_file_path, 'w') as f:
687	            f.write(temp_file_content)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
686	        with open(temp_file_path, 'w') as f:
687	            f.write(temp_file_content)
688	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
686	        with open(temp_file_path, 'w') as f:
687	            f.write(temp_file_content)
688	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:707
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
706	
707	        with open(temp_file_path) as f:
708	            file_content = f.readline()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
711	
712	        shutil.rmtree(
713	            temp_dir_path,
714	            ignore_errors=True,
715	        )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
719	    def setup_method(self, test_method):
720	        shutil.rmtree('test_env', ignore_errors=True)
721	        wagon._make_virtualenv('test_env')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:729
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
728	        if os.path.isdir('test_env'):
729	            shutil.rmtree('test_env', ignore_errors=True)
730	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
776	        # We fill it up so that it fails.
777	        with open(invalid_wagon, 'w') as f:
778	            f.write('something')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:778
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
777	        with open(invalid_wagon, 'w') as f:
778	            f.write('something')
779	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:778
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
777	        with open(invalid_wagon, 'w') as f:
778	            f.write('something')
779	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
830	        finally:
831	            shutil.rmtree(tempdir, ignore_errors=True)
832	            if os.path.isfile(archive_name):

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/tests/test_wagon.py:845
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
844	        os.remove(self.archive_path)
845	        shutil.rmtree(self.extracted_source, ignore_errors=True)
846	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	
64	DEFAULT_INDEX_SOURCE_URL_TEMPLATE = 'https://pypi.python.org/pypi/{0}/json'
65	IS_VIRTUALENV = sys.prefix != sys.base_prefix

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
123	            if len(output) > 0:
124	                self._aggr.write(output)
125	                self.logger.log(self.log_level, output)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
123	            if len(output) > 0:
124	                self._aggr.write(output)
125	                self.logger.log(self.log_level, output)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
135	        logger.debug('Executing: %r', cmd)
136	    process = subprocess.Popen(
137	        cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
138	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
297	    try:
298	        response = urlopen(url)
299	        # Sometimes bytes are returned here and sometimes strings.

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
297	    try:
298	        response = urlopen(url)
299	        # Sometimes bytes are returned here and sometimes strings.

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
300	        try:
301	            response.text = response.read().decode('utf-8')
302	        except UnicodeDecodeError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
302	        except UnicodeDecodeError:
303	            response.text = response.read()
304	        response.code = 200

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
345	                source_dir = os.path.dirname(source)
346	                zip_file.write(
347	                    file_path, os.path.relpath(file_path, source_dir))
348	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
345	                source_dir = os.path.dirname(source)
346	                zip_file.write(
347	                    file_path, os.path.relpath(file_path, source_dir))
348	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
357	    logger.info('Creating tgz archive: %s...', destination)
358	    with closing(tarfile.open(destination, 'w:gz')) as tar:
359	        tar.add(source, arcname=os.path.basename(source))

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
363	    logger.debug('Extracting tgz %s to %s...', archive, destination)
364	    with closing(tarfile.open(name=archive)) as tar:
365	        tar.extractall(path=destination, members=tar.getmembers())

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
572	    output_path = os.path.join(workdir, METADATA_FILE_NAME)
573	    with open(output_path, 'w') as f:
574	        logger.debug('Writing metadata to file: %s', output_path)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
574	        logger.debug('Writing metadata to file: %s', output_path)
575	        f.write(formatted_metadata)
576	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
574	        logger.debug('Writing metadata to file: %s', output_path)
575	        f.write(formatted_metadata)
576	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
693	        except Exception:
694	            shutil.rmtree(tmpdir)
695	            raise

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
708	def _get_metadata(source_path):
709	    with open(os.path.join(source_path, METADATA_FILE_NAME)) as metadata_file:
710	        metadata = json.loads(metadata_file.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:710
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
709	    with open(os.path.join(source_path, METADATA_FILE_NAME)) as metadata_file:
710	        metadata = json.loads(metadata_file.read())
711	    return metadata

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
768	        if processed_source != source:
769	            shutil.rmtree(processed_source, ignore_errors=True)
770	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:853
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
852	        logger.debug('Removing work directory...')
853	        shutil.rmtree(tempdir, ignore_errors=True)
854	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
938	        if processed_source != source:
939	            shutil.rmtree(os.path.dirname(
940	                processed_source), ignore_errors=True)
941	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:979
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
978	    finally:
979	        shutil.rmtree(tmpenv)
980	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
988	        if processed_source != source:
989	            shutil.rmtree(processed_source)
990	    return validation_errors

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:1000
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
999	    metadata = _get_metadata(processed_source)
1000	    shutil.rmtree(processed_source)
1001	    return metadata

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:1008
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1007	
1008	    shutil.rmtree(
1009	        processed_source,
1010	        ignore_errors=True,
1011	    )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:1031
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1030	
1031	    shutil.rmtree(
1032	        processed_source,
1033	        ignore_errors=True,
1034	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:1084
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1083	        raise WagonError(
1084	            'Could not find auditwheel. '
1085	            'Please make sure auditwheel is installed and is in the PATH.\n'
1086	            'Please see https://github.com/pypa/auditwheel for more info.')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:1249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1248	    source_help = (
1249	        'The source from which to create the archive. '
1250	        'Possible formats are:'
1251	        'PACKAGE_NAME, PACKAGE_NAME==PACKAGE_VERSION, '
1252	        'https://github.com/org/repo/archive/branch.extension, '
1253	        '/path/to/github/like/archive, '
1254	        '/path/to/package/where/setup.py/resides'
1255	    )
1256	    command.add_argument('SOURCE', help=source_help)
1257	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wagon-1.0.3/wagon-1.0.3/wagon.py:1420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1419	    description = (
1420	        'Use auditwheel to repair all wheels in a wagon. \n\n'
1421	        'Note that this requires a specific environment where\n'
1422	        'auditwheel can work and you must install auditwheel\n'
1423	        'manually. For more information, '
1424	        'see https://github.com/pypa/auditwheel.'
1425	    )
1426	
1427	    command = parser.add_parser(
1428	        'repair',

--------------------------------------------------

Code scanned:
	Total lines of code: 1942
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 74.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 82.0
		High: 0.0
Files skipped (0):
