Run started:2025-04-13 06:55:32.027359

Test results:
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/__init__.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
96	        if isinstance(request_thread_pool, int):
97	            request_thread_pool = ThreadPoolExecutor(request_thread_pool)
98	        return RemoteDBConnection(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/common.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
95	        raise TypeError(
96	            f"Unknown data type {type(data)}. "
97	            "Please check "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/jinaai.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	
23	API_URL = "https://api.jina.ai/v1/embeddings"
24	
25	
26	def is_valid_url(text):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/jinaai.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
87	        if isinstance(image, bytes):
88	            image_dict = {"image": base64.b64encode(image).decode("utf-8")}
89	        elif isinstance(image, (str, Path)):

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/jinaai.py:88
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
87	        if isinstance(image, bytes):
88	            image_dict = {"image": base64.b64encode(image).decode("utf-8")}
89	        elif isinstance(image, (str, Path)):

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/jinaai.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
103	            image_bytes = buffered.getvalue()
104	            image_dict = {"image": base64.b64encode(image_bytes).decode("utf-8")}
105	        else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/jinaai.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
103	            image_bytes = buffered.getvalue()
104	            image_dict = {"image": base64.b64encode(image_bytes).decode("utf-8")}
105	        else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/jinaai.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
111	                image_bytes = buffered.getvalue()
112	                image_dict = {"image": base64.b64encode(image_bytes).decode("utf-8")}
113	            else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/jinaai.py:112
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
111	                image_bytes = buffered.getvalue()
112	                image_dict = {"image": base64.b64encode(image_bytes).decode("utf-8")}
113	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/jinaai.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	        if JinaEmbeddings._session is None:
226	            if self.api_key is None and os.environ.get("JINA_API_KEY") is None:
227	                api_key_not_found_help("jina")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/jinaai.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
227	                api_key_not_found_help("jina")
228	            api_key = self.api_key or os.environ.get("JINA_API_KEY")
229	            JinaEmbeddings._session = requests.Session()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/ollama.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    name: str = "nomic-embed-text"
26	    host: str = "http://localhost:11434"
27	    options: Optional[dict] = None  # type = ollama.Options

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/open_clip.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
120	        """
121	        with concurrent.futures.ThreadPoolExecutor() as executor:
122	            futures = [

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/utils.py:269
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
268	    try:
269	        with urllib.request.urlopen(url) as conn:
270	            return conn.read()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/embeddings/watsonx.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	DEFAULT_WATSONX_URL = "https://us-south.ml.cloud.ibm.com"
16	
17	MODELS_DIMS = {

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/query.py:1360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1359	
1360	        with ThreadPoolExecutor() as executor:
1361	            fts_future = executor.submit(self._fts_query.with_row_id(True).to_arrow)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/remote/db.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	            logging.warning(
254	                "embedding_functions is not yet supported on LanceDB Cloud."
255	                "Please vote https://github.com/lancedb/lancedb/issues/626 "
256	                "for this feature."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/rerankers/jinaai.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	API_URL = "https://api.jina.ai/v1/rerank"
14	
15	
16	class JinaReranker(Reranker):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/rerankers/jinaai.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	
52	        if os.environ.get("JINA_API_KEY") is None and self.api_key is None:
53	            raise ValueError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/rerankers/jinaai.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
56	            )
57	        self.api_key = self.api_key or os.environ.get("JINA_API_KEY")
58	        self._session = requests.Session()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/rerankers/jinaai.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
65	        docs = result_set[self.column].to_pylist()
66	        response = self._client.post(  # type: ignore
67	            API_URL,
68	            json={
69	                "query": query,
70	                "documents": docs,
71	                "model": self.model_name,
72	                "top_n": self.top_n,
73	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/lancedb-0.21.2-cp39-abi3-win_amd64/lancedb/table.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
157	        raise TypeError(
158	            f"Unknown data type {type(data)}. "
159	            "Please check "

--------------------------------------------------

Code scanned:
	Total lines of code: 12621
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 12.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 3.0
Files skipped (0):
