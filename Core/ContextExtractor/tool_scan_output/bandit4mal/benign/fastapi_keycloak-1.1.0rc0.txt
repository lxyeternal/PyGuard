Run started:2025-04-12 10:25:42.223615

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
194	        decoded_token = self._decode_token(token=value)
195	        if ((not decoded_token.get("resource_access").get(
196	                "realm-management")
197	            and

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
194	        decoded_token = self._decode_token(token=value)
195	        if ((not decoded_token.get("resource_access").get(
196	                "realm-management")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	            and
198	             (not decoded_token.get("resource_access").get(
199	                 "master-realm")) # Keycloak 26 return "master-realm"
200	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	            and
198	             (not decoded_token.get("resource_access").get(
199	                 "master-realm")) # Keycloak 26 return "master-realm"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	                )
201	                or not decoded_token.get("resource_access").get("account")):
202	            raise AssertionError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
200	                )
201	                or not decoded_token.get("resource_access").get("account")):
202	            raise AssertionError(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
280	                for field in extra_fields:
281	                    user.extra_fields[field] = decoded_token.get(field, None)
282	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
293	        """
294	        response = requests.get(
295	            url=f"{self.realm_uri}/.well-known/openid-configuration",
296	            timeout=self.timeout,
297	            verify=self.ssl_verification
298	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
328	
329	        return requests.request(
330	            method=method.name,
331	            url=f"{self.server_url}{relative_path}",
332	            data=json.dumps(payload),
333	            headers=headers,
334	            timeout=self.timeout,
335	            verify=self.ssl_verification
336	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:357
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
356	        }
357	        response = requests.post(url=self.token_uri, headers=headers, data=data, timeout=self.timeout, verify=self.ssl_verification)
358	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
378	        """
379	        response = requests.get(url=self.realm_uri, timeout=self.timeout, verify=self.ssl_verification)
380	        public_key = response.json()["public_key"]

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
397	        keycloak_roles = self.get_roles(roles)
398	        return self._admin_request(
399	            url=f"{self.users_uri}/{user_id}/role-mappings/realm",
400	            data=[role.__dict__ for role in keycloak_roles],
401	            method=HTTPMethod.POST,
402	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
418	        keycloak_roles = self.get_roles(roles)
419	        return self._admin_request(
420	            url=f"{self.users_uri}/{user_id}/role-mappings/realm",
421	            data=[role.__dict__ for role in keycloak_roles],
422	            method=HTTPMethod.DELETE,
423	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
459	        """
460	        return self._admin_request(
461	            url=f"{self.users_uri}/{user_id}/role-mappings/realm", method=HTTPMethod.GET
462	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
476	        """
477	        response = self._admin_request(
478	            url=self.roles_uri, data={"name": role_name}, method=HTTPMethod.POST
479	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
494	        """
495	        return self._admin_request(url=self.roles_uri, method=HTTPMethod.GET)
496	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
509	        """
510	        return self._admin_request(
511	            url=f"{self.roles_uri}/{role_name}",
512	            method=HTTPMethod.DELETE,
513	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:525
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
524	        """
525	        return self._admin_request(url=self.groups_uri, method=HTTPMethod.GET)
526	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
610	        """
611	        return self._admin_request(
612	            url=f"{self.groups_uri}/{group_id}",
613	            method=HTTPMethod.GET,
614	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
643	
644	        response = self._admin_request(
645	            url=groups_uri, data={"name": group_name}, method=HTTPMethod.POST
646	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
664	        """
665	        return self._admin_request(
666	            url=f"{self.groups_uri}/{group_id}",
667	            method=HTTPMethod.DELETE,
668	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
683	        """
684	        return self._admin_request(
685	            url=f"{self.users_uri}/{user_id}/groups/{group_id}", method=HTTPMethod.PUT
686	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:701
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
700	        """
701	        return self._admin_request(
702	            url=f"{self.users_uri}/{user_id}/groups",
703	            method=HTTPMethod.GET,
704	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
719	        """
720	        return self._admin_request(
721	            url=f"{self.groups_uri}/{group_id}/members",
722	            method=HTTPMethod.GET,
723	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:739
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
738	        """
739	        return self._admin_request(
740	            url=f"{self.users_uri}/{user_id}/groups/{group_id}",
741	            method=HTTPMethod.DELETE,
742	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:793
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
792	        }
793	        response = self._admin_request(
794	            url=self.users_uri, data=data, method=HTTPMethod.POST
795	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
830	        }
831	        return self._admin_request(
832	            url=f"{self.users_uri}/{user_id}/reset-password",
833	            data=credentials,
834	            method=HTTPMethod.PUT,
835	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
849	        """
850	        return self._admin_request(
851	            url=f"{self.users_uri}/{user_id}/send-verify-email",
852	            method=HTTPMethod.PUT,
853	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:870
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
869	        if user_id is None:
870	            response = self._admin_request(
871	                url=f"{self.users_uri}?{query}", method=HTTPMethod.GET
872	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:880
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
879	        else:
880	            response = self._admin_request(
881	                url=f"{self.users_uri}/{user_id}", method=HTTPMethod.GET
882	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:906
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
905	        """
906	        response = self._admin_request(
907	            url=f"{self.users_uri}/{user.id}", data=user.__dict__, method=HTTPMethod.PUT
908	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:926
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
925	        """
926	        return self._admin_request(
927	            url=f"{self.users_uri}/{user_id}",
928	            method=HTTPMethod.DELETE
929	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:941
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
940	        """
941	        return self._admin_request(url=self.users_uri, method=HTTPMethod.GET)
942	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:953
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
952	        """
953	        return self._admin_request(url=self.providers_uri, method=HTTPMethod.GET).json()
954	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:995
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
994	        }
995	        response = requests.post(url=self.token_uri, headers=headers, data=data, timeout=self.timeout, verify=self.ssl_verification)
996	        if response.status_code == 401:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:1002
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1001	                reason = user.requiredActions[0]
1002	                exception = {
1003	                    "update_user_locale": UpdateUserLocaleException(),
1004	                    "CONFIGURE_TOTP": ConfigureTOTPException(),
1005	                    "VERIFY_EMAIL": VerifyEmailException(),
1006	                    "UPDATE_PASSWORD": UpdatePasswordException(),
1007	                    "UPDATE_PROFILE": UpdateProfileException(),
1008	                }.get(
1009	                    reason,  # Try to return the matching exception
1010	                    # On custom or unknown actions return a MandatoryActionException by default
1011	                    MandatoryActionException(
1012	                        detail=f"This user can't login until the following action has been "
1013	                               f"resolved: {reason}"
1014	                    ),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:1046
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1045	        }
1046	        return requests.post(url=self.token_uri, headers=headers, data=data, timeout=self.timeout, verify=self.ssl_verification)
1047	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:1071
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1070	        }
1071	        return requests.request(
1072	            method=method.name, url=url, data=json.dumps(data), headers=headers, timeout=self.timeout, verify=self.ssl_verification
1073	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:1089
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1088	        """The authorization endpoint URL"""
1089	        return self.open_id_configuration.get("authorization_endpoint")
1090	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:1094
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1093	        """The token endpoint URL"""
1094	        return self.open_id_configuration.get("token_endpoint")
1095	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_keycloak-1.1.0rc0/fastapi_keycloak-1.1.0rc0/fastapi_keycloak/api.py:1099
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1098	        """The logout endpoint URL"""
1099	        return self.open_id_configuration.get("end_session_endpoint")
1100	

--------------------------------------------------

Code scanned:
	Total lines of code: 1670
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 0.0
		High: 41.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 0.0
Files skipped (0):
