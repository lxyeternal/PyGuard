Run started:2025-04-12 12:20:11.899709

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/__main__.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
353	    parser = ArgumentParser(description=__doc__, add_help=False, usage=usage_string(),
354	                            epilog="The complete documentation can be found at "
355	                                   "https://instaloader.github.io/.",
356	                            fromfile_prefix_chars='+')

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
30	def _get_config_dir() -> str:
31	    if platform.system() == "Windows":
32	        # on Windows, use %LOCALAPPDATA%\Instaloader

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
30	def _get_config_dir() -> str:
31	    if platform.system() == "Windows":
32	        # on Windows, use %LOCALAPPDATA%\Instaloader

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
30	def _get_config_dir() -> str:
31	    if platform.system() == "Windows":
32	        # on Windows, use %LOCALAPPDATA%\Instaloader

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
36	        # legacy fallback - store in temp dir if %LOCALAPPDATA% is not set
37	        return os.path.join(tempfile.gettempdir(), ".instaloader-" + getpass.getuser())
38	    # on Unix, use ~/.config/instaloader

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:37
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
36	        # legacy fallback - store in temp dir if %LOCALAPPDATA% is not set
37	        return os.path.join(tempfile.gettempdir(), ".instaloader-" + getpass.getuser())
38	    # on Unix, use ~/.config/instaloader

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
50	    """Returns legacy (until v4.4.3) default session filename for given username."""
51	    dirname = tempfile.gettempdir() + "/" + ".instaloader-" + getpass.getuser()
52	    filename = dirname + "/" + "session-" + username

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:51
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
50	    """Returns legacy (until v4.4.3) default session filename for given username."""
51	    dirname = tempfile.gettempdir() + "/" + ".instaloader-" + getpass.getuser()
52	    filename = dirname + "/" + "session-" + username

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	            error_string = "{}({}): {}".format(func.__name__, ', '.join([repr(arg) for arg in args]), err)
100	            if (kwargs.get('_attempt') or 1) == instaloader.context.max_connection_attempts:
101	                raise ConnectionException(error_string) from None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
103	            try:
104	                if kwargs.get('_attempt'):
105	                    kwargs['_attempt'] += 1

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
161	
162	        if force_windows_path or platform.system() == 'Windows':
163	            ret = ret.replace(':', '\uff1a').replace('<', '\ufe64').replace('>', '\ufe65').replace('\"', '\uff02')

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
161	
162	        if force_windows_path or platform.system() == 'Windows':
163	            ret = ret.replace(':', '\uff1a').replace('<', '\ufe64').replace('>', '\ufe65').replace('\"', '\uff02')

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:162
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
161	
162	        if force_windows_path or platform.system() == 'Windows':
163	            ret = ret.replace(':', '\uff1a').replace('<', '\ufe64').replace('>', '\ufe65').replace('\"', '\uff02')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
395	                else:
396	                    unique_comments_list[-1]['likes_count'] = y.get('likes_count')
397	                    if combine_answers:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
397	                    if combine_answers:
398	                        combined_answers = unique_comments_list[-1].get('answers') or list()
399	                        if 'answers' in y:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
411	            unique_comments = get_unique_comments(extended_comments, combine_answers=True)
412	            answer_ids = set(int(answer['id']) for comment in unique_comments for answer in comment.get('answers', []))
413	            with open(filename, 'w') as file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
413	            with open(filename, 'w') as file:
414	                file.write(json.dumps(list(filter(lambda t: int(t['id']) not in answer_ids, unique_comments)),
415	                                      indent=4))
416	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
413	            with open(filename, 'w') as file:
414	                file.write(json.dumps(list(filter(lambda t: int(t['id']) not in answer_ids, unique_comments)),
415	                                      indent=4))
416	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
456	            with open(filename, 'rb') as file:
457	                file_caption = file.read()
458	            if file_caption.replace(b'\r\n', b'\n') == bcaption.replace(b'\r\n', b'\n'):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
481	        with open(filename, 'w', encoding='UTF-8') as fio:
482	            fio.write(caption)
483	        os.utime(filename, (datetime.now().timestamp(), mtime.timestamp()))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
481	        with open(filename, 'w', encoding='UTF-8') as fio:
482	            fio.write(caption)
483	        os.utime(filename, (datetime.now().timestamp(), mtime.timestamp()))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
489	            location_string = (location.name + "\n" +
490	                               "https://maps.google.com/maps?q={0},{1}&ll={0},{1}\n".format(location.lat,
491	                                                                                            location.lng))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
540	        filename = self.__prepare_filename(filename_template, lambda: url) + ".jpg"
541	        content_length = http_response.headers.get('Content-Length', None)
542	        if os.path.isfile(filename) and (not self.context.is_logged_in or

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
617	            os.makedirs(dirname)
618	            os.chmod(dirname, 0o700)
619	        with open(filename, 'wb') as sessionfile:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:618
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
617	            os.makedirs(dirname)
618	            os.chmod(dirname, 0o700)
619	        with open(filename, 'wb') as sessionfile:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:620
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
619	        with open(filename, 'wb') as sessionfile:
620	            os.chmod(filename, 0o600)
621	            self.context.save_session_to_file(sessionfile)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:620
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
619	        with open(filename, 'wb') as sessionfile:
620	            os.chmod(filename, 0o600)
621	            self.context.save_session_to_file(sessionfile)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1075	                        try:
1076	                            downloaded = self.download_post(post, target=target)
1077	                            break

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1099	                node = edge["node"]
1100	                if node.get("__typename") in Post.supported_graphql_types() and node.get("shortcode") is not None:
1101	                    yield Post(self.context, node)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1099	                node = edge["node"]
1100	                if node.get("__typename") in Post.supported_graphql_types() and node.get("shortcode") is not None:
1101	                    yield Post(self.context, node)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:1208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1207	            lambda n: Post(self.context, n),
1208	            query_referer='https://www.instagram.com/explore/',
1209	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:1349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1348	            with open(id_filename, 'rb') as id_file:
1349	                return int(id_file.read())
1350	        except (FileNotFoundError, ValueError):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:1362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1361	        with open(self._get_id_filename(profile.username), 'w') as text_file:
1362	            text_file.write(str(profile.userid) + "\n")
1363	            self.context.log("Stored ID {0} for profile {1}.".format(profile.userid, profile.username))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloader.py:1362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1361	        with open(self._get_id_filename(profile.username), 'w') as text_file:
1362	            text_file.write(str(profile.userid) + "\n")
1363	            self.context.log("Stored ID {0} for profile {1}.".format(profile.userid, profile.username))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	                  'Host': 'www.instagram.com',
190	                  'Origin': 'https://www.instagram.com',
191	                  'Referer': 'https://www.instagram.com/',
192	                  'User-Agent': self.user_agent,
193	                  'X-Instagram-AJAX': '1',
194	                  'X-Requested-With': 'XMLHttpRequest'}
195	        if empty_session_only:
196	            del header['Host']
197	            del header['Origin']
198	            del header['X-Instagram-AJAX']
199	            del header['X-Requested-With']
200	        return header

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
190	                  'Origin': 'https://www.instagram.com',
191	                  'Referer': 'https://www.instagram.com/',
192	                  'User-Agent': self.user_agent,
193	                  'X-Instagram-AJAX': '1',
194	                  'X-Requested-With': 'XMLHttpRequest'}
195	        if empty_session_only:
196	            del header['Host']
197	            del header['Origin']
198	            del header['X-Instagram-AJAX']
199	            del header['X-Requested-With']
200	        return header
201	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
278	        # Not using self.get_json() here, because we need to access the cookie
279	        session.get('https://www.instagram.com/')
280	        # Add session's csrftoken cookie to session headers

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
278	        # Not using self.get_json() here, because we need to access the cookie
279	        session.get('https://www.instagram.com/')
280	        # Add session's csrftoken cookie to session headers

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
287	        enc_password = '#PWD_INSTAGRAM_BROWSER:0:{}:{}'.format(int(datetime.now().timestamp()), passwd)
288	        login = session.post('https://www.instagram.com/api/v1/web/accounts/login/ajax/',
289	                             data={'enc_password': enc_password, 'username': user}, allow_redirects=True)
290	        try:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
287	        enc_password = '#PWD_INSTAGRAM_BROWSER:0:{}:{}'.format(int(datetime.now().timestamp()), passwd)
288	        login = session.post('https://www.instagram.com/api/v1/web/accounts/login/ajax/',
289	                             data={'enc_password': enc_password, 'username': user}, allow_redirects=True)
290	        try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
296	            ) from err
297	        if resp_json.get('two_factor_required'):
298	            two_factor_session = copy_session(session, self.request_timeout)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
304	            raise TwoFactorAuthRequiredException("Login error: two-factor authentication required.")
305	        if resp_json.get('checkpoint_url'):
306	            raise LoginException(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
306	            raise LoginException(
307	                f"Login: Checkpoint required. Point your browser to {resp_json.get('checkpoint_url')} - "
308	                f"follow the instructions, then retry."

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
349	
350	        login = session.post('https://www.instagram.com/accounts/login/ajax/two_factor/',
351	                             data={'username': user, 'verificationCode': two_factor_code, 'identifier': two_factor_id},
352	                             allow_redirects=True)
353	        resp_json = login.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
349	
350	        login = session.post('https://www.instagram.com/accounts/login/ajax/two_factor/',
351	                             data={'username': user, 'verificationCode': two_factor_code, 'identifier': two_factor_id},
352	                             allow_redirects=True)
353	        resp_json = login.json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
420	            if use_post:
421	                resp = sess.post('https://{0}/{1}'.format(host, path), data=params, allow_redirects=False)
422	            else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:421
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
420	            if use_post:
421	                resp = sess.post('https://{0}/{1}'.format(host, path), data=params, allow_redirects=False)
422	            else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
422	            else:
423	                resp = sess.get('https://{0}/{1}'.format(host, path), params=params, allow_redirects=False)
424	            if resp.status_code in self.fatal_status_codes:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
422	            else:
423	                resp = sess.get('https://{0}/{1}'.format(host, path), params=params, allow_redirects=False)
424	            if resp.status_code in self.fatal_status_codes:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
428	                    body = ': ' + resp.text[:500] + ('â€¦' if len(resp.text) > 501 else '')
429	                raise AbortDownloadException("Query to https://{}/{} responded with \"{} {}\"{}{}".format(
430	                    host, path, resp.status_code, resp.reason, redirect, body

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:434
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
433	                redirect_url = resp.headers['location']
434	                self.log('\nHTTP redirect from https://{0}/{1} to {2}'.format(host, path, redirect_url))
435	                if (redirect_url.startswith('https://www.instagram.com/accounts/login') or

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
434	                self.log('\nHTTP redirect from https://{0}/{1} to {2}'.format(host, path, redirect_url))
435	                if (redirect_url.startswith('https://www.instagram.com/accounts/login') or
436	                    redirect_url.startswith('https://i.instagram.com/accounts/login')):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
435	                if (redirect_url.startswith('https://www.instagram.com/accounts/login') or
436	                    redirect_url.startswith('https://i.instagram.com/accounts/login')):
437	                    if not self.is_logged_in:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
440	                                                 "some time, recreate the session and try again")
441	                if redirect_url.startswith('https://{}/'.format(host)):
442	                    resp = sess.get(redirect_url if redirect_url.endswith('/') else redirect_url + '/',

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:442
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
441	                if redirect_url.startswith('https://{}/'.format(host)):
442	                    resp = sess.get(redirect_url if redirect_url.endswith('/') else redirect_url + '/',
443	                                    params=params, allow_redirects=False)
444	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:662
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
661	            else:
662	                file.write(resp)
663	        os.replace(filename + '.temp', filename)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:674
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
673	        with self.get_anonymous_session() as anonymous_session:
674	            resp = anonymous_session.get(url, stream=True)
675	        if resp.status_code == 200:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
830	                       untracked_next_request_time(),
831	                       iphone_next_request(),
832	                   ) - current_time)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/instaloadercontext.py:831
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
830	                       untracked_next_request_time(),
831	                       iphone_next_request(),
832	                   ) - current_time)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/lateststamps.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
27	        self.data = configparser.ConfigParser()
28	        self.data.read(latest_stamps_file)
29	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/lateststamps.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
33	        with open(self.file, 'w') as f:
34	            self.data.write(f)
35	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/nodeiterator.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
188	        ).encode())
189	        return base64.urlsafe_b64encode(magic_hash.digest()).decode()
190	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
124	                {'comment_id': self.id},
125	                'https://www.instagram.com/p/{0}/'.format(self._post.shortcode),
126	            )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
265	        code = 'A' * (12 - len(code)) + code
266	        return int.from_bytes(b64decode(code.encode(), b'-_'), 'big')
267	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:266
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
265	        code = 'A' * (12 - len(code)) + code
266	        return int.from_bytes(b64decode(code.encode(), b'-_'), 'big')
267	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
271	            raise InvalidArgumentException("Wrong mediaid {0}, unable to convert to shortcode".format(str(mediaid)))
272	        return b64encode(mediaid.to_bytes(9, 'big'), b'-_').decode().replace('A', ' ').lstrip().replace(' ', 'A')
273	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:272
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
271	            raise InvalidArgumentException("Wrong mediaid {0}, unable to convert to shortcode".format(str(mediaid)))
272	        return b64encode(mediaid.to_bytes(9, 'big'), b'-_').decode().replace('A', ' ').lstrip().replace(' ', 'A')
273	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:737
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
736	                {'comment_id': node['id']},
737	                'https://www.instagram.com/p/{0}/'.format(self.shortcode),
738	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:769
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
768	            {'shortcode': self.shortcode},
769	            'https://www.instagram.com/p/{0}/'.format(self.shortcode),
770	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:795
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
794	            {'shortcode': self.shortcode},
795	            'https://www.instagram.com/p/{0}/'.format(self.shortcode),
796	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1136	                                                'include_highlight_reels': False},
1137	                                               'https://www.instagram.com/{}/'.format(self.username))
1138	            self._has_public_story = data['data']['user']['has_public_story']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1207	             'username': self.username},
1208	            query_referer = 'https://www.instagram.com/{0}/'.format(self.username),
1209	            is_first = Profile._make_is_newest_checker(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1227	            {'id': self.userid},
1228	            'https://www.instagram.com/{0}/'.format(self.username),
1229	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1243	            {'id': self.userid},
1244	            'https://www.instagram.com/{0}/'.format(self.username),
1245	            is_first=Profile._make_is_newest_checker()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1264	                'page_size': 12, 'include_feed_video': True, "target_user_id": str(self.userid)}},
1265	            query_referer = 'https://www.instagram.com/{0}/'.format(self.username),
1266	            is_first = Profile._make_is_newest_checker(),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1284	            {'id': self.userid},
1285	            'https://www.instagram.com/{0}/channel/'.format(self.username),
1286	            self._metadata('edge_felix_video_timeline'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1311	            {'id': str(self.userid)},
1312	            'https://www.instagram.com/{0}/'.format(self.username),
1313	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1330	            {'id': str(self.userid)},
1331	            'https://www.instagram.com/{0}/'.format(self.username),
1332	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1349	            {'id': str(self.userid)},
1350	            'https://www.instagram.com/{0}/'.format(self.username),
1351	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:1366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1365	                                                {"user_id": str(self.userid), "include_chaining": True},
1366	                                                "https://www.instagram.com/{0}/"
1367	                                                .format(self.username))["data"]["user"]["edge_chaining"]["edges"])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/instaloader/structures.py:2021
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2020	            {'tag_name': self.name},
2021	            f"https://www.instagram.com/explore/tags/{self.name}/"
2022	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/setup.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    package_data={'instaloader': ['py.typed']},
41	    url='https://instaloader.github.io/',
42	    license='MIT',

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/instaloader-4.14.1/instaloader-4.14.1/setup.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
46	                'from Instagram.',
47	    long_description=open(os.path.join(SRC, 'README.rst')).read(),
48	    install_requires=requirements,

--------------------------------------------------

Code scanned:
	Total lines of code: 5067
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 39.0
		High: 44.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 75.0
		High: 8.0
Files skipped (0):
