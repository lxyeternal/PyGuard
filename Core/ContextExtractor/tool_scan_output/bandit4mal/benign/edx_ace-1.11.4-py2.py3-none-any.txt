Run started:2025-04-12 13:24:16.978095

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/channel/braze.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	        """
102	        omit_unsubscribe_link = kwargs.get('omit_unsubscribe_link')
103	        action_links = []

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/channel/braze.py:125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
124	
125	        transactional = message.options.get('transactional', False)
126	        override_frequency_capping = message.options.get('override_frequency_capping', transactional)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/channel/braze.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	        transactional = message.options.get('transactional', False)
126	        override_frequency_capping = message.options.get('override_frequency_capping', transactional)
127	        body_html = self.make_simple_html_template(rendered_message.head_html, rendered_message.body_html)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/channel/braze.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
138	        # https://www.braze.com/docs/api/objects_filters/email_object/
139	        response = requests.post(
140	            self._send_url(),
141	            headers=self._auth_headers(),
142	            json={
143	                'external_user_ids': [str(message.recipient.lms_user_id)],
144	                'recipient_subscription_state': 'all' if transactional else 'subscribed',
145	                'campaign_id': self._campaign_id(message.name),
146	                'override_frequency_capping': override_frequency_capping,
147	                'messages': {
148	                    'email': {
149	                        'app_id': getattr(settings, self._APP_ID_SETTING),
150	                        'subject': self.get_subject(rendered_message),
151	                        'from': from_address,
152	                        'reply_to': message.options.get('reply_to'),
153	                        'body': body_html,
154	                        'plaintext_body': rendered_message.body,
155	                        'message_variation_id': self._variation_id(message.name),
156	                        'should_inline_css': False,  # this feature messes with inline CSS already in ACE templates
157	                    },
158	                },
159	            },
160	            timeout=getattr(settings, 'ACE_DEFAULT_API_TIMEOUT', BRAZE_API_TIMEOUT)
161	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/channel/braze.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
151	                        'from': from_address,
152	                        'reply_to': message.options.get('reply_to'),
153	                        'body': body_html,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/channel/braze.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
168	            # https://www.braze.com/docs/api/errors/
169	            message = response.json().get('message', 'Unknown error')
170	            logger.debug('Failed to send to Braze: %s', message)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/channel/braze.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	        """Returns the campaign ID for a given ACE message name or None if no match is found"""
218	        campaign = getattr(settings, cls._CAMPAIGNS_SETTING, {}).get(name)
219	        if campaign:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/channel/braze.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	        """Returns the variation ID for a given ACE message name or None if no match is found"""
226	        campaign = getattr(settings, cls._CAMPAIGNS_SETTING, {}).get(name)
227	        if campaign:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/channel/file.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
85	        with open(output_file_path, 'w', encoding='utf-8') as output_file:
86	            output_file.write(self._encode(rendered_template))
87	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/delivery.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
63	            message.report(f'{channel_type}_delivery_succeeded', True)
64	            send_ace_message_sent_signal(channel, message)
65	            return

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/tests/channel/test_braze.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	        assert mock_post.call_count == 1
56	        assert mock_post.call_args[0] == ('https://rest.braze.com/messages/send',)
57	        assert mock_post.call_args[1] == {

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/edx_ace-1.11.4-py2.py3-none-any/edx_ace/tests/channel/test_file_email.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	            from_name='Robot',
25	            head_html='<img src="https://tracker/.img" />',
26	            subject='\n Hello from  \r\nRobot ! \n',

--------------------------------------------------

Code scanned:
	Total lines of code: 2728
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 10.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 0.0
Files skipped (0):
