Run started:2025-04-12 15:29:18.048071

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/docs/source/conf.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	intersphinx_mapping = {
66	    "python": ("https://docs.python.org/", None),
67	}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/setup.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
14	with io.open(readme_path, encoding="utf-8") as read_file:
15	    long_description = read_file.read()
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    author_email="warner@lothar.com",
25	    url="http://github.com/tlsfuzzer/python-ecdsa",
26	    packages=["ecdsa"],

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/_compat.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
31	        or sys.version_info < (2, 7, 4)
32	        or platform.system() == "Java"
33	    ):  # pragma: no branch

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/_compat.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
31	        or sys.version_info < (2, 7, 4)
32	        or platform.system() == "Java"
33	    ):  # pragma: no branch

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/der.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
467	    )
468	    return base64.b64decode(d)
469	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/der.py:468
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
467	    )
468	    return base64.b64decode(d)
469	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/der.py:472
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
471	def topem(der, name):
472	    b64 = base64.b64encode(compat26_str(der))
473	    lines = [("-----BEGIN %s-----\n" % name).encode()]

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/der.py:472
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
471	def topem(der, name):
472	    b64 = base64.b64encode(compat26_str(der))
473	    lines = [("-----BEGIN %s-----\n" % name).encode()]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/numbertheory.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
398	    warnings.warn(
399	        "Function is unused by library code. If you use this code, "
400	        "please open an issue in "
401	        "https://github.com/tlsfuzzer/python-ecdsa",
402	        DeprecationWarning,
403	    )
404	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/numbertheory.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
428	    warnings.warn(
429	        "Function is unused by library code. If you use this code, "
430	        "please open an issue in "
431	        "https://github.com/tlsfuzzer/python-ecdsa",
432	        DeprecationWarning,
433	    )
434	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/numbertheory.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
443	    warnings.warn(
444	        "Function is unused by library code. If you use this code, "
445	        "please open an issue in "
446	        "https://github.com/tlsfuzzer/python-ecdsa",
447	        DeprecationWarning,
448	    )
449	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/numbertheory.py:464
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
463	    warnings.warn(
464	        "Function is unused by library code. If you use this code, "
465	        "please open an issue in "
466	        "https://github.com/tlsfuzzer/python-ecdsa",
467	        DeprecationWarning,
468	    )
469	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/numbertheory.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
480	    warnings.warn(
481	        "Function is unused by library code. If you use this code, "
482	        "please open an issue in "
483	        "https://github.com/tlsfuzzer/python-ecdsa",
484	        DeprecationWarning,
485	    )
486	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/numbertheory.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
506	    warnings.warn(
507	        "Function is unused by library code. If you use this code, "
508	        "please open an issue in "
509	        "https://github.com/tlsfuzzer/python-ecdsa",
510	        DeprecationWarning,
511	    )
512	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/numbertheory.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
531	    warnings.warn(
532	        "Function is unused by library code. If you use this code, "
533	        "please open an issue in "
534	        "https://github.com/tlsfuzzer/python-ecdsa",
535	        DeprecationWarning,
536	    )
537	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
116	
117	        self.assertEqual(encoded, bytes(base64.b64decode(self.base64_params)))
118	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:117
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
116	
117	        self.assertEqual(encoded, bytes(base64.b64decode(self.base64_params)))
118	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
136	        self.assertEqual(
137	            encoded, bytes(base64.b64decode(compressed_base_point))
138	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:137
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
136	        self.assertEqual(
137	            encoded, bytes(base64.b64decode(compressed_base_point))
138	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
151	
152	        decoded = Curve.from_der(bytes(base64.b64decode(p256_explicit)))
153	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:152
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
151	
152	        decoded = Curve.from_der(bytes(base64.b64decode(p256_explicit)))
153	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
156	    def test_decoding_well_known_from_explicit_params(self):
157	        curve = Curve.from_der(bytes(base64.b64decode(self.base64_params)))
158	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:157
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
156	    def test_decoding_well_known_from_explicit_params(self):
157	        curve = Curve.from_der(bytes(base64.b64decode(self.base64_params)))
158	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
190	
191	        self.assertEqual(encoded, bytes(base64.b64decode(expected)))
192	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:191
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
190	
191	        self.assertEqual(encoded, bytes(base64.b64decode(expected)))
192	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
212	        with self.assertRaises(UnknownCurveError) as e:
213	            Curve.from_der(base64.b64decode(sect113r1_explicit))
214	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:213
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
212	        with self.assertRaises(UnknownCurveError) as e:
213	            Curve.from_der(base64.b64decode(sect113r1_explicit))
214	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
226	        bad_der = bytes(
227	            base64.b64decode(self.base64_params)
228	        ) + der.encode_integer(1)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_curves.py:227
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
226	        bad_der = bytes(
227	            base64.b64decode(self.base64_params)
228	        ) + der.encode_integer(1)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_ecdh.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
398	    if os.path.isdir("t"):  # pragma: no branch
399	        shutil.rmtree("t")
400	    os.mkdir("t")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_ecdh.py:412
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
411	    with open("t/privkey1.pem") as e:
412	        key = e.read()
413	    ecdh1.load_private_key_pem(key)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_ecdh.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
414	    with open("t/privkey2.pem") as e:
415	        key = e.read()
416	    ecdh2.load_private_key_pem(key)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_ecdh.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
418	    with open("t/pubkey1.pem") as e:
419	        key = e.read()
420	    vk1 = VerifyingKey.from_pem(key)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_ecdh.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
423	    with open("t/pubkey2.pem", "wb") as e:
424	        e.write(vk2.to_pem())
425	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_ecdh.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
440	    with open("t/secret1", "rb") as e:
441	        ssl_secret1 = e.read()
442	    with open("t/secret1", "rb") as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_ecdh.py:443
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
442	    with open("t/secret1", "rb") as e:
443	        ssl_secret2 = e.read()
444	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_jacobi.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
803	        for _ in range(thread_num):
804	            threads.append(threading.Thread(target=runner, args=(gen,)))
805	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_jacobi.py:851
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
850	        for _ in range(thread_num):
851	            threads.append(threading.Thread(target=runner, args=(gen,)))
852	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_jacobi.py:861
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
860	        threads.append(
861	            threading.Thread(
862	                target=interrupter,
863	                args=(barrier_start, barrier_end, lock_exit),
864	            )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_jacobi.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
820	    @pytest.mark.skipif(
821	        platform.system() == "Windows"
822	        or platform.python_implementation() == "PyPy",

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_jacobi.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
820	    @pytest.mark.skipif(
821	        platform.system() == "Windows"
822	        or platform.python_implementation() == "PyPy",

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_jacobi.py:821
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
820	    @pytest.mark.skipif(
821	        platform.system() == "Windows"
822	        or platform.python_implementation() == "PyPy",

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1305	        if os.path.isdir("t"):  # pragma: no cover
1306	            shutil.rmtree("t")
1307	        os.mkdir("t")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1311	        with open("t/data.txt", "wb") as e:
1312	            e.write(data)
1313	        run_openssl(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1320	        with open("t/pubkey.pem", "rb") as e:
1321	            pubkey_pem = e.read()
1322	        vk = VerifyingKey.from_pem(pubkey_pem)  # 3

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1323	        with open("t/data.sig", "rb") as e:
1324	            sig_der = e.read()
1325	        self.assertTrue(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1334	        with open("t/privkey.pem") as e:
1335	            fp = e.read()
1336	        sk = SigningKey.from_pem(fp)  # 1

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1347
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1346	        with open("t/privkey-p8.pem", "rb") as e:
1347	            privkey_p8_pem = e.read()
1348	        sk_from_p8 = SigningKey.from_pem(privkey_p8_pem)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1573	        if os.path.isdir("t"):  # pragma: no cover
1574	            shutil.rmtree("t")
1575	        os.mkdir("t")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1579	        with open("t/pubkey.der", "wb") as e:
1580	            e.write(vk.to_der())  # 4
1581	        with open("t/pubkey.pem", "wb") as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1582
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1581	        with open("t/pubkey.pem", "wb") as e:
1582	            e.write(vk.to_pem())  # 4
1583	        sig_der = sk.sign(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1589	        with open("t/data.sig", "wb") as e:
1590	            e.write(sig_der)  # 6
1591	        with open("t/data.txt", "wb") as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1591	        with open("t/data.txt", "wb") as e:
1592	            e.write(data)
1593	        with open("t/baddata.txt", "wb") as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1593	        with open("t/baddata.txt", "wb") as e:
1594	            e.write(data + b"corrupt")
1595	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1608
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1607	        with open("t/privkey.pem", "wb") as e:
1608	            e.write(sk.to_pem())  # 2
1609	        run_openssl(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1618
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1617	        with open("t/privkey-explicit.pem", "wb") as e:
1618	            e.write(sk.to_pem(curve_parameters_encoding="explicit"))
1619	        run_openssl(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1628	        with open("t/privkey-p8.pem", "wb") as e:
1629	            e.write(sk.to_pem(format="pkcs8"))
1630	        run_openssl(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1640
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1639	        with open("t/privkey-p8-explicit.pem", "wb") as e:
1640	            e.write(
1641	                sk.to_pem(format="pkcs8", curve_parameters_encoding="explicit")
1642	            )

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1664	        if os.path.isdir("t"):
1665	            shutil.rmtree("t")
1666	        os.mkdir("t")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1673
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1672	        with open("t/pubkey.der", "wb") as e:
1673	            e.write(vk.to_der())
1674	        with open("t/pubkey.pem", "wb") as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1675
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1674	        with open("t/pubkey.pem", "wb") as e:
1675	            e.write(vk.to_pem())
1676	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1680
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1679	        with open("t/data.sig", "wb") as e:
1680	            e.write(sig)
1681	        with open("t/data.txt", "wb") as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1682
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1681	        with open("t/data.txt", "wb") as e:
1682	            e.write(data)
1683	        with open("t/baddata.txt", "wb") as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1684
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1683	        with open("t/baddata.txt", "wb") as e:
1684	            e.write(data + b"corrupt")
1685	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1695	
1696	        shutil.rmtree("t")
1697	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1720
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1719	        if os.path.isdir("t"):
1720	            shutil.rmtree("t")
1721	        os.mkdir("t")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1735
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1734	        with open("t/data.txt", "wb") as e:
1735	            e.write(data)
1736	        run_openssl(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1742
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1741	        with open("t/data.sig", "rb") as e:
1742	            sig = e.read()
1743	        with open("t/pubkey.pem", "rb") as e:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1744
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1743	        with open("t/pubkey.pem", "rb") as e:
1744	            vk = VerifyingKey.from_pem(e.read())
1745	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/src/ecdsa/test_pyecdsa.py:1750
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
1749	
1750	        shutil.rmtree("t")
1751	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
447	    "git"
448	] = r'''
449	# This file helps to compute a version number in source trees obtained from
450	# git-archive tarball (such as those provided by githubs download-from-tag
451	# feature). Distribution tarballs (built by setup.py sdist) and build
452	# directories (produced by setup.py build) will contain a much shorter file
453	# that just contains the computed version number.
454	
455	# This file is released into the public domain. Generated by
456	# versioneer-0.21 (https://github.com/python-versioneer/python-versioneer)
457	
458	"""Git implementation of _version.py."""
459	
460	import errno
461	import os
462	import re
463	import subprocess
464	import sys
465	from typing import Callable, Dict
466	
467	
468	def get_keywords():
469	    """Get the keywords needed to look up the version information."""
470	    # these strings will be replaced by git during git-archive.
471	    # setup.py/versioneer.py will grep for the variable names, so they must
472	    # each be defined on a line of their own. _version.py will just call
473	    # get_keywords().
474	    git_refnames = "%(DOLLAR)sFormat:%%d%(DOLLAR)s"
475	    git_full = "%(DOLLAR)sFormat:%%H%(DOLLAR)s"
476	    git_date = "%(DOLLAR)sFormat:%%ci%(DOLLAR)s"
477	    keywords = {"refnames": git_refnames, "full": git_full, "date": git_date}
478	    return keywords
479	
480	
481	class VersioneerConfig:
482	    """Container for Versioneer configuration parameters."""
483	
484	
485	def get_config():
486	    """Create, populate and return the VersioneerConfig() object."""
487	    # these strings are filled in when 'setup.py versioneer' creates
488	    # _version.py
489	    cfg = VersioneerConfig()
490	    cfg.VCS = "git"
491	    cfg.style = "%(STYLE)s"
492	    cfg.tag_prefix = "%(TAG_PREFIX)s"
493	    cfg.parentdir_prefix = "%(PARENTDIR_PREFIX)s"
494	    cfg.versionfile_source = "%(VERSIONFILE_SOURCE)s"
495	    cfg.verbose = False
496	    return cfg
497	
498	
499	class NotThisMethod(Exception):
500	    """Exception raised if a method is not valid for the current scenario."""
501	
502	
503	LONG_VERSION_PY: Dict[str, str] = {}
504	HANDLERS: Dict[str, Dict[str, Callable]] = {}
505	
506	
507	def register_vcs_handler(vcs, method):  # decorator
508	    """Create decorator to mark a method as the handler of a VCS."""
509	    def decorate(f):
510	        """Store f in HANDLERS[vcs][method]."""
511	        if vcs not in HANDLERS:
512	            HANDLERS[vcs] = {}
513	        HANDLERS[vcs][method] = f
514	        return f
515	    return decorate
516	
517	
518	def run_command(commands, args, cwd=None, verbose=False, hide_stderr=False,
519	                env=None):
520	    """Call the given command(s)."""
521	    assert isinstance(commands, list)
522	    process = None
523	    for command in commands:
524	        try:
525	            dispcmd = str([command] + args)
526	            # remember shell=False, so use git.cmd on windows, not just git
527	            process = subprocess.Popen([command] + args, cwd=cwd, env=env,
528	                                       stdout=subprocess.PIPE,
529	                                       stderr=(subprocess.PIPE if hide_stderr
530	                                               else None))
531	            break
532	        except OSError:
533	            e = sys.exc_info()[1]
534	            if e.errno == errno.ENOENT:
535	                continue
536	            if verbose:
537	                print("unable to run %%s" %% dispcmd)
538	                print(e)
539	            return None, None
540	    else:
541	        if verbose:
542	            print("unable to find command, tried %%s" %% (commands,))
543	        return None, None
544	    stdout = process.communicate()[0].strip().decode()
545	    if process.returncode != 0:
546	        if verbose:
547	            print("unable to run %%s (error)" %% dispcmd)
548	            print("stdout was %%s" %% stdout)
549	        return None, process.returncode
550	    return stdout, process.returncode
551	
552	
553	def versions_from_parentdir(parentdir_prefix, root, verbose):
554	    """Try to determine the version from the parent directory name.
555	
556	    Source tarballs conventionally unpack into a directory that includes both
557	    the project name and a version string. We will also support searching up
558	    two directory levels for an appropriately named parent directory
559	    """
560	    rootdirs = []
561	
562	    for _ in range(3):
563	        dirname = os.path.basename(root)
564	        if dirname.startswith(parentdir_prefix):
565	            return {"version": dirname[len(parentdir_prefix):],
566	                    "full-revisionid": None,
567	                    "dirty": False, "error": None, "date": None}
568	        rootdirs.append(root)
569	        root = os.path.dirname(root)  # up a level
570	
571	    if verbose:
572	        print("Tried directories %%s but none started with prefix %%s" %%
573	              (str(rootdirs), parentdir_prefix))
574	    raise NotThisMethod("rootdir doesn't start with parentdir_prefix")
575	
576	
577	@register_vcs_handler("git", "get_keywords")
578	def git_get_keywords(versionfile_abs):
579	    """Extract version information from the given file."""
580	    # the code embedded in _version.py can just fetch the value of these
581	    # keywords. When used from setup.py, we don't want to import _version.py,
582	    # so we do it with a regexp instead. This function is not used from
583	    # _version.py.
584	    keywords = {}
585	    try:
586	        with open(versionfile_abs, "r") as fobj:
587	            for line in fobj:
588	                if line.strip().startswith("git_refnames ="):
589	                    mo = re.search(r'=\s*"(.*)"', line)
590	                    if mo:
591	                        keywords["refnames"] = mo.group(1)
592	                if line.strip().startswith("git_full ="):
593	                    mo = re.search(r'=\s*"(.*)"', line)
594	                    if mo:
595	                        keywords["full"] = mo.group(1)
596	                if line.strip().startswith("git_date ="):
597	                    mo = re.search(r'=\s*"(.*)"', line)
598	                    if mo:
599	                        keywords["date"] = mo.group(1)
600	    except OSError:
601	        pass
602	    return keywords
603	
604	
605	@register_vcs_handler("git", "keywords")
606	def git_versions_from_keywords(keywords, tag_prefix, verbose):
607	    """Get version information from git keywords."""
608	    if "refnames" not in keywords:
609	        raise NotThisMethod("Short version file found")
610	    date = keywords.get("date")
611	    if date is not None:
612	        # Use only the last line.  Previous lines may contain GPG signature
613	        # information.
614	        date = date.splitlines()[-1]
615	
616	        # git-2.2.0 added "%%cI", which expands to an ISO-8601 -compliant
617	        # datestamp. However we prefer "%%ci" (which expands to an "ISO-8601
618	        # -like" string, which we must then edit to make compliant), because
619	        # it's been around since git-1.5.3, and it's too difficult to
620	        # discover which version we're using, or to work around using an
621	        # older one.
622	        date = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
623	    refnames = keywords["refnames"].strip()
624	    if refnames.startswith("$Format"):
625	        if verbose:
626	            print("keywords are unexpanded, not using")
627	        raise NotThisMethod("unexpanded keywords, not a git-archive tarball")
628	    refs = {r.strip() for r in refnames.strip("()").split(",")}
629	    # starting in git-1.8.3, tags are listed as "tag: foo-1.0" instead of
630	    # just "foo-1.0". If we see a "tag: " prefix, prefer those.
631	    TAG = "tag: "
632	    tags = {r[len(TAG):] for r in refs if r.startswith(TAG)}
633	    if not tags:
634	        # Either we're using git < 1.8.3, or there really are no tags. We use
635	        # a heuristic: assume all version tags have a digit. The old git %%d
636	        # expansion behaves like git log --decorate=short and strips out the
637	        # refs/heads/ and refs/tags/ prefixes that would let us distinguish
638	        # between branches and tags. By ignoring refnames without digits, we
639	        # filter out many common branch names like "release" and
640	        # "stabilization", as well as "HEAD" and "master".
641	        tags = {r for r in refs if re.search(r'\d', r)}
642	        if verbose:
643	            print("discarding '%%s', no digits" %% ",".join(refs - tags))
644	    if verbose:
645	        print("likely tags: %%s" %% ",".join(sorted(tags)))
646	    for ref in sorted(tags):
647	        # sorting will prefer e.g. "2.0" over "2.0rc1"
648	        if ref.startswith(tag_prefix):
649	            r = ref[len(tag_prefix):]
650	            # Filter out refs that exactly match prefix or that don't start
651	            # with a number once the prefix is stripped (mostly a concern
652	            # when prefix is '')
653	            if not re.match(r'\d', r):
654	                continue
655	            if verbose:
656	                print("picking %%s" %% r)
657	            return {"version": r,
658	                    "full-revisionid": keywords["full"].strip(),
659	                    "dirty": False, "error": None,
660	                    "date": date}
661	    # no suitable tags, so version is "0+unknown", but full hex is still there
662	    if verbose:
663	        print("no suitable tags, using unknown + full revision id")
664	    return {"version": "0+unknown",
665	            "full-revisionid": keywords["full"].strip(),
666	            "dirty": False, "error": "no suitable tags", "date": None}
667	
668	
669	@register_vcs_handler("git", "pieces_from_vcs")
670	def git_pieces_from_vcs(tag_prefix, root, verbose, runner=run_command):
671	    """Get version from 'git describe' in the root of the source tree.
672	
673	    This only gets called if the git-archive 'subst' keywords were *not*
674	    expanded, and _version.py hasn't already been rewritten with a short
675	    version string, meaning we're inside a checked out source tree.
676	    """
677	    GITS = ["git"]
678	    TAG_PREFIX_REGEX = "*"
679	    if sys.platform == "win32":
680	        GITS = ["git.cmd", "git.exe"]
681	        TAG_PREFIX_REGEX = r"\*"
682	
683	    _, rc = runner(GITS, ["rev-parse", "--git-dir"], cwd=root,
684	                   hide_stderr=True)
685	    if rc != 0:
686	        if verbose:
687	            print("Directory %%s not under git control" %% root)
688	        raise NotThisMethod("'git rev-parse --git-dir' returned error")
689	
690	    # if there is a tag matching tag_prefix, this yields TAG-NUM-gHEX[-dirty]
691	    # if there isn't one, this yields HEX[-dirty] (no NUM)
692	    describe_out, rc = runner(GITS, ["describe", "--tags", "--dirty",
693	                                     "--always", "--long",
694	                                     "--match",
695	                                     "%%s%%s" %% (tag_prefix, TAG_PREFIX_REGEX)],
696	                              cwd=root)
697	    # --long was added in git-1.5.5
698	    if describe_out is None:
699	        raise NotThisMethod("'git describe' failed")
700	    describe_out = describe_out.strip()
701	    full_out, rc = runner(GITS, ["rev-parse", "HEAD"], cwd=root)
702	    if full_out is None:
703	        raise NotThisMethod("'git rev-parse' failed")
704	    full_out = full_out.strip()
705	
706	    pieces = {}
707	    pieces["long"] = full_out
708	    pieces["short"] = full_out[:7]  # maybe improved later
709	    pieces["error"] = None
710	
711	    branch_name, rc = runner(GITS, ["rev-parse", "--abbrev-ref", "HEAD"],
712	                             cwd=root)
713	    # --abbrev-ref was added in git-1.6.3
714	    if rc != 0 or branch_name is None:
715	        raise NotThisMethod("'git rev-parse --abbrev-ref' returned error")
716	    branch_name = branch_name.strip()
717	
718	    if branch_name == "HEAD":
719	        # If we aren't exactly on a branch, pick a branch which represents
720	        # the current commit. If all else fails, we are on a branchless
721	        # commit.
722	        branches, rc = runner(GITS, ["branch", "--contains"], cwd=root)
723	        # --contains was added in git-1.5.4
724	        if rc != 0 or branches is None:
725	            raise NotThisMethod("'git branch --contains' returned error")
726	        branches = branches.split("\n")
727	
728	        # Remove the first line if we're running detached
729	        if "(" in branches[0]:
730	            branches.pop(0)
731	
732	        # Strip off the leading "* " from the list of branches.
733	        branches = [branch[2:] for branch in branches]
734	        if "master" in branches:
735	            branch_name = "master"
736	        elif not branches:
737	            branch_name = None
738	        else:
739	            # Pick the first branch that is returned. Good or bad.
740	            branch_name = branches[0]
741	
742	    pieces["branch"] = branch_name
743	
744	    # parse describe_out. It will be like TAG-NUM-gHEX[-dirty] or HEX[-dirty]
745	    # TAG might have hyphens.
746	    git_describe = describe_out
747	
748	    # look for -dirty suffix
749	    dirty = git_describe.endswith("-dirty")
750	    pieces["dirty"] = dirty
751	    if dirty:
752	        git_describe = git_describe[:git_describe.rindex("-dirty")]
753	
754	    # now we have TAG-NUM-gHEX or HEX
755	
756	    if "-" in git_describe:
757	        # TAG-NUM-gHEX
758	        mo = re.search(r'^(.+)-(\d+)-g([0-9a-f]+)$', git_describe)
759	        if not mo:
760	            # unparsable. Maybe git-describe is misbehaving?
761	            pieces["error"] = ("unable to parse git-describe output: '%%s'"
762	                               %% describe_out)
763	            return pieces
764	
765	        # tag
766	        full_tag = mo.group(1)
767	        if not full_tag.startswith(tag_prefix):
768	            if verbose:
769	                fmt = "tag '%%s' doesn't start with prefix '%%s'"
770	                print(fmt %% (full_tag, tag_prefix))
771	            pieces["error"] = ("tag '%%s' doesn't start with prefix '%%s'"
772	                               %% (full_tag, tag_prefix))
773	            return pieces
774	        pieces["closest-tag"] = full_tag[len(tag_prefix):]
775	
776	        # distance: number of commits since tag
777	        pieces["distance"] = int(mo.group(2))
778	
779	        # commit: short hex revision ID
780	        pieces["short"] = mo.group(3)
781	
782	    else:
783	        # HEX: no tags
784	        pieces["closest-tag"] = None
785	        count_out, rc = runner(GITS, ["rev-list", "HEAD", "--count"], cwd=root)
786	        pieces["distance"] = int(count_out)  # total number of commits
787	
788	    # commit date: see ISO-8601 comment in git_versions_from_keywords()
789	    date = runner(GITS, ["show", "-s", "--format=%%ci", "HEAD"], cwd=root)[0].strip()
790	    # Use only the last line.  Previous lines may contain GPG signature
791	    # information.
792	    date = date.splitlines()[-1]
793	    pieces["date"] = date.strip().replace(" ", "T", 1).replace(" ", "", 1)
794	
795	    return pieces
796	
797	
798	def plus_or_dot(pieces):
799	    """Return a + if we don't already have one, else return a ."""
800	    if "+" in pieces.get("closest-tag", ""):
801	        return "."
802	    return "+"
803	
804	
805	def render_pep440(pieces):
806	    """Build up version string, with post-release "local version identifier".
807	
808	    Our goal: TAG[+DISTANCE.gHEX[.dirty]] . Note that if you
809	    get a tagged build and then dirty it, you'll get TAG+0.gHEX.dirty
810	
811	    Exceptions:
812	    1: no tags. git_describe was just HEX. 0+untagged.DISTANCE.gHEX[.dirty]
813	    """
814	    if pieces["closest-tag"]:
815	        rendered = pieces["closest-tag"]
816	        if pieces["distance"] or pieces["dirty"]:
817	            rendered += plus_or_dot(pieces)
818	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
819	            if pieces["dirty"]:
820	                rendered += ".dirty"
821	    else:
822	        # exception #1
823	        rendered = "0+untagged.%%d.g%%s" %% (pieces["distance"],
824	                                          pieces["short"])
825	        if pieces["dirty"]:
826	            rendered += ".dirty"
827	    return rendered
828	
829	
830	def render_pep440_branch(pieces):
831	    """TAG[[.dev0]+DISTANCE.gHEX[.dirty]] .
832	
833	    The ".dev0" means not master branch. Note that .dev0 sorts backwards
834	    (a feature branch will appear "older" than the master branch).
835	
836	    Exceptions:
837	    1: no tags. 0[.dev0]+untagged.DISTANCE.gHEX[.dirty]
838	    """
839	    if pieces["closest-tag"]:
840	        rendered = pieces["closest-tag"]
841	        if pieces["distance"] or pieces["dirty"]:
842	            if pieces["branch"] != "master":
843	                rendered += ".dev0"
844	            rendered += plus_or_dot(pieces)
845	            rendered += "%%d.g%%s" %% (pieces["distance"], pieces["short"])
846	            if pieces["dirty"]:
847	                rendered += ".dirty"
848	    else:
849	        # exception #1
850	        rendered = "0"
851	        if pieces["branch"] != "master":
852	            rendered += ".dev0"
853	        rendered += "+untagged.%%d.g%%s" %% (pieces["distance"],
854	                                          pieces["short"])
855	        if pieces["dirty"]:
856	            rendered += ".dirty"
857	    return rendered
858	
859	
860	def pep440_split_post(ver):
861	    """Split pep440 version string at the post-release segment.
862	
863	    Returns the release segments before the post-release and the
864	    post-release version number (or -1 if no post-release segment is present).
865	    """
866	    vc = str.split(ver, ".post")
867	    return vc[0], int(vc[1] or 0) if len(vc) == 2 else None
868	
869	
870	def render_pep440_pre(pieces):
871	    """TAG[.postN.devDISTANCE] -- No -dirty.
872	
873	    Exceptions:
874	    1: no tags. 0.post0.devDISTANCE
875	    """
876	    if pieces["closest-tag"]:
877	        if pieces["distance"]:
878	            # update the post release segment
879	            tag_version, post_version = pep440_split_post(pieces["closest-tag"])
880	            rendered = tag_version
881	            if post_version is not None:
882	                rendered += ".post%%d.dev%%d" %% (post_version+1, pieces["distance"])
883	            else:
884	                rendered += ".post0.dev%%d" %% (pieces["distance"])
885	        else:
886	            # no commits, use the tag as the version
887	            rendered = pieces["closest-tag"]
888	    else:
889	        # exception #1
890	        rendered = "0.post0.dev%%d" %% pieces["distance"]
891	    return rendered
892	
893	
894	def render_pep440_post(pieces):
895	    """TAG[.postDISTANCE[.dev0]+gHEX] .
896	
897	    The ".dev0" means dirty. Note that .dev0 sorts backwards
898	    (a dirty tree will appear "older" than the corresponding clean one),
899	    but you shouldn't be releasing software with -dirty anyways.
900	
901	    Exceptions:
902	    1: no tags. 0.postDISTANCE[.dev0]
903	    """
904	    if pieces["closest-tag"]:
905	        rendered = pieces["closest-tag"]
906	        if pieces["distance"] or pieces["dirty"]:
907	            rendered += ".post%%d" %% pieces["distance"]
908	            if pieces["dirty"]:
909	                rendered += ".dev0"
910	            rendered += plus_or_dot(pieces)
911	            rendered += "g%%s" %% pieces["short"]
912	    else:
913	        # exception #1
914	        rendered = "0.post%%d" %% pieces["distance"]
915	        if pieces["dirty"]:
916	            rendered += ".dev0"
917	        rendered += "+g%%s" %% pieces["short"]
918	    return rendered
919	
920	
921	def render_pep440_post_branch(pieces):
922	    """TAG[.postDISTANCE[.dev0]+gHEX[.dirty]] .
923	
924	    The ".dev0" means not master branch.
925	
926	    Exceptions:
927	    1: no tags. 0.postDISTANCE[.dev0]+gHEX[.dirty]
928	    """
929	    if pieces["closest-tag"]:
930	        rendered = pieces["closest-tag"]
931	        if pieces["distance"] or pieces["dirty"]:
932	            rendered += ".post%%d" %% pieces["distance"]
933	            if pieces["branch"] != "master":
934	                rendered += ".dev0"
935	            rendered += plus_or_dot(pieces)
936	            rendered += "g%%s" %% pieces["short"]
937	            if pieces["dirty"]:
938	                rendered += ".dirty"
939	    else:
940	        # exception #1
941	        rendered = "0.post%%d" %% pieces["distance"]
942	        if pieces["branch"] != "master":
943	            rendered += ".dev0"
944	        rendered += "+g%%s" %% pieces["short"]
945	        if pieces["dirty"]:
946	            rendered += ".dirty"
947	    return rendered
948	
949	
950	def render_pep440_old(pieces):
951	    """TAG[.postDISTANCE[.dev0]] .
952	
953	    The ".dev0" means dirty.
954	
955	    Exceptions:
956	    1: no tags. 0.postDISTANCE[.dev0]
957	    """
958	    if pieces["closest-tag"]:
959	        rendered = pieces["closest-tag"]
960	        if pieces["distance"] or pieces["dirty"]:
961	            rendered += ".post%%d" %% pieces["distance"]
962	            if pieces["dirty"]:
963	                rendered += ".dev0"
964	    else:
965	        # exception #1
966	        rendered = "0.post%%d" %% pieces["distance"]
967	        if pieces["dirty"]:
968	            rendered += ".dev0"
969	    return rendered
970	
971	
972	def render_git_describe(pieces):
973	    """TAG[-DISTANCE-gHEX][-dirty].
974	
975	    Like 'git describe --tags --dirty --always'.
976	
977	    Exceptions:
978	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
979	    """
980	    if pieces["closest-tag"]:
981	        rendered = pieces["closest-tag"]
982	        if pieces["distance"]:
983	            rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
984	    else:
985	        # exception #1
986	        rendered = pieces["short"]
987	    if pieces["dirty"]:
988	        rendered += "-dirty"
989	    return rendered
990	
991	
992	def render_git_describe_long(pieces):
993	    """TAG-DISTANCE-gHEX[-dirty].
994	
995	    Like 'git describe --tags --dirty --always -long'.
996	    The distance/hash is unconditional.
997	
998	    Exceptions:
999	    1: no tags. HEX[-dirty]  (note: no 'g' prefix)
1000	    """
1001	    if pieces["closest-tag"]:
1002	        rendered = pieces["closest-tag"]
1003	        rendered += "-%%d-g%%s" %% (pieces["distance"], pieces["short"])
1004	    else:
1005	        # exception #1
1006	        rendered = pieces["short"]
1007	    if pieces["dirty"]:
1008	        rendered += "-dirty"
1009	    return rendered
1010	
1011	
1012	def render(pieces, style):
1013	    """Render the given version pieces into the requested style."""
1014	    if pieces["error"]:
1015	        return {"version": "unknown",
1016	                "full-revisionid": pieces.get("long"),
1017	                "dirty": None,
1018	                "error": pieces["error"],
1019	                "date": None}
1020	
1021	    if not style or style == "default":
1022	        style = "pep440"  # the default
1023	
1024	    if style == "pep440":
1025	        rendered = render_pep440(pieces)
1026	    elif style == "pep440-branch":
1027	        rendered = render_pep440_branch(pieces)
1028	    elif style == "pep440-pre":
1029	        rendered = render_pep440_pre(pieces)
1030	    elif style == "pep440-post":
1031	        rendered = render_pep440_post(pieces)
1032	    elif style == "pep440-post-branch":
1033	        rendered = render_pep440_post_branch(pieces)
1034	    elif style == "pep440-old":
1035	        rendered = render_pep440_old(pieces)
1036	    elif style == "git-describe":
1037	        rendered = render_git_describe(pieces)
1038	    elif style == "git-describe-long":
1039	        rendered = render_git_describe_long(pieces)
1040	    else:
1041	        raise ValueError("unknown style '%%s'" %% style)
1042	
1043	    return {"version": rendered, "full-revisionid": pieces["long"],
1044	            "dirty": pieces["dirty"], "error": None,
1045	            "date": pieces.get("date")}
1046	
1047	
1048	def get_versions():
1049	    """Get version information or return default if unable to do so."""
1050	    # I am in _version.py, which lives at ROOT/VERSIONFILE_SOURCE. If we have
1051	    # __file__, we can work backwards from there to the root. Some
1052	    # py2exe/bbfreeze/non-CPython implementations don't do __file__, in which
1053	    # case we can only use expanded keywords.
1054	
1055	    cfg = get_config()
1056	    verbose = cfg.verbose
1057	
1058	    try:
1059	        return git_versions_from_keywords(get_keywords(), cfg.tag_prefix,
1060	                                          verbose)
1061	    except NotThisMethod:
1062	        pass
1063	
1064	    try:
1065	        root = os.path.realpath(__file__)
1066	        # versionfile_source is the relative path from the top of the source
1067	        # tree (where the .git directory might live) to this file. Invert
1068	        # this to find the root from __file__.
1069	        for _ in cfg.versionfile_source.split('/'):
1070	            root = os.path.dirname(root)
1071	    except NameError:
1072	        return {"version": "0+unknown", "full-revisionid": None,
1073	                "dirty": None,
1074	                "error": "unable to find root of source tree",
1075	                "date": None}
1076	
1077	    try:
1078	        pieces = git_pieces_from_vcs(cfg.tag_prefix, root, verbose)
1079	        return render(pieces, cfg.style)
1080	    except NotThisMethod:
1081	        pass
1082	
1083	    try:
1084	        if cfg.parentdir_prefix:
1085	            return versions_from_parentdir(cfg.parentdir_prefix, root, verbose)
1086	    except NotThisMethod:
1087	        pass
1088	
1089	    return {"version": "0+unknown", "full-revisionid": None,
1090	            "dirty": None,
1091	            "error": "unable to compute version", "date": None}
1092	'''
1093	
1094	
1095	@register_vcs_handler("git", "get_keywords")
1096	def git_get_keywords(versionfile_abs):
1097	    """Extract version information from the given file."""
1098	    # the code embedded in _version.py can just fetch the value of these

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:1370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1369	        with open(".gitattributes", "a+") as fobj:
1370	            fobj.write("{0} export-subst\n".format(versionfile_source))
1371	        files.append(".gitattributes")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:1427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1426	        with open(filename) as f:
1427	            contents = f.read()
1428	    except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:1453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1452	    with open(filename, "w") as f:
1453	        f.write(SHORT_VERSION_PY % contents)
1454	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:1947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1946	                    LONG = LONG_VERSION_PY[cfg.VCS]
1947	                    f.write(
1948	                        LONG
1949	                        % {
1950	                            "DOLLAR": "$",
1951	                            "STYLE": cfg.style,
1952	                            "TAG_PREFIX": cfg.tag_prefix,
1953	                            "PARENTDIR_PREFIX": cfg.parentdir_prefix,
1954	                            "VERSIONFILE_SOURCE": cfg.versionfile_source,
1955	                        }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:1977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1976	                    LONG = LONG_VERSION_PY[cfg.VCS]
1977	                    f.write(
1978	                        LONG
1979	                        % {
1980	                            "DOLLAR": "$",
1981	                            "STYLE": cfg.style,
1982	                            "TAG_PREFIX": cfg.tag_prefix,
1983	                            "PARENTDIR_PREFIX": cfg.parentdir_prefix,
1984	                            "VERSIONFILE_SOURCE": cfg.versionfile_source,
1985	                        }

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:2089
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2088	            with open(os.path.join(root, "setup.cfg"), "a") as f:
2089	                f.write(SAMPLE_CONFIG)
2090	        print(CONFIG_ERROR, file=sys.stderr)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:2096
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2095	        LONG = LONG_VERSION_PY[cfg.VCS]
2096	        f.write(
2097	            LONG
2098	            % {
2099	                "DOLLAR": "$",
2100	                "STYLE": cfg.style,
2101	                "TAG_PREFIX": cfg.tag_prefix,
2102	                "PARENTDIR_PREFIX": cfg.parentdir_prefix,
2103	                "VERSIONFILE_SOURCE": cfg.versionfile_source,
2104	            }

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:2111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
2110	            with open(ipy, "r") as f:
2111	                old = f.read()
2112	        except OSError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:2119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2118	            with open(ipy, "w") as f:
2119	                f.write(old.replace(OLD_SNIPPET, snippet))
2120	        elif snippet not in old:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:2123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2122	            with open(ipy, "a") as f:
2123	                f.write(snippet)
2124	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:2151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2150	        with open(manifest_in, "a") as f:
2151	            f.write("include versioneer.py\n")
2152	    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ecdsa-0.19.1/ecdsa-0.19.1/versioneer.py:2160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2159	        with open(manifest_in, "a") as f:
2160	            f.write("include %s\n" % cfg.versionfile_source)
2161	    else:

--------------------------------------------------

Code scanned:
	Total lines of code: 15287
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 21.0
		High: 63.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 73.0
		High: 11.0
Files skipped (0):
