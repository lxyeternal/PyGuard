Run started:2025-04-12 12:06:59.898764

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/__main__.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
207	        print(
208	            "Error:\n\n{}\n\nTo report issues, please visit "
209	            "https://github.com/wkentaro/gdown/issues.".format(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/cached_download.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
31	    with open(filename, "rb") as f:
32	        for block in iter(lambda: f.read(blocksize), b""):
33	            hash.update(block)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/cached_download.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
145	    except Exception:
146	        shutil.rmtree(temp_root)
147	        raise

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/cached_download.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
169	    with open(path, "rb") as f:
170	        for block in iter(lambda: f.read(BLOCKSIZE), b""):
171	            algorithm_instance.update(block)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
29	        if m:
30	            url = "https://docs.google.com" + m.groups()[0]
31	            url = url.replace("&amp;", "&")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	        raise FileURLRetrievalError(
56	            "Cannot retrieve the public link of the file. "
57	            "You may need to change the permission to "
58	            "'Anyone with the link', or have had many accesses. "

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
103	        cookie_jar = MozillaCookieJar(cookies_file)
104	        cookie_jar.load()
105	        sess.cookies.update(cookie_jar)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	    if id is not None:
177	        url = "https://drive.google.com/uc?id={id}".format(id=id)
178	    if user_agent is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
196	        # overwrite the url with fuzzy match of a file id
197	        url = "https://drive.google.com/uc?id={id}".format(id=gdrive_file_id)
198	        url_origin = url

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
201	    while True:
202	        res = sess.get(url, stream=True, verify=verify)
203	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
208	            # The file could be Google Docs or Spreadsheets.
209	            url = "https://drive.google.com/open?id={id}".format(id=gdrive_file_id)
210	            continue

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
215	                url = (
216	                    "https://docs.google.com/document/d/{id}/export"
217	                    "?format={format}".format(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
224	                url = (
225	                    "https://docs.google.com/spreadsheets/d/{id}/export"
226	                    "?format={format}".format(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
233	                url = (
234	                    "https://docs.google.com/presentation/d/{id}/export"
235	                    "?format={format}".format(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
246	            url = (
247	                "https://docs.google.com/presentation/d/{id}/export"
248	                "?format={format}".format(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
339	        headers = {"Range": "bytes={}-".format(start_size)}
340	        res = sess.get(url, headers=headers, stream=True, verify=verify)
341	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
344	    if not quiet:
345	        print(log_messages.get("start", "Downloading...\n"), file=sys.stderr, end="")
346	        if resume:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
353	        print(
354	            log_messages.get(
355	                "output", f"To: {osp.abspath(output) if output_is_path else output}\n"
356	            ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:362
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
361	    try:
362	        total = res.headers.get("Content-Length")
363	        if total is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
368	        for chunk in res.iter_content(chunk_size=CHUNK_SIZE):
369	            f.write(chunk)
370	            if not quiet:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download.py:369
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
368	        for chunk in res.iter_content(chunk_size=CHUNK_SIZE):
369	            f.write(chunk)
370	            if not quiet:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download_folder.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	        raise RuntimeError(
57	            "Cannot retrieve the folder information from the link. "
58	            "You may need to change the permission to "
59	            "'Anyone with the link', or have had many accesses. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download_folder.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	            sess=sess,
160	            url="https://drive.google.com/drive/folders/" + child_id,
161	            quiet=quiet,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download_folder.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	    if id is not None:
266	        url = "https://drive.google.com/drive/folders/{id}".format(id=id)
267	    if user_agent is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/download_folder.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
325	            local_path = download(
326	                url="https://drive.google.com/uc?id=" + id,
327	                output=local_path,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/gdown/parse_url.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	            "or the following url: {url}".format(
52	                url="https://drive.google.com/uc?id={}".format(file_id)
53	            )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test___main__.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	        with open(file_path) as f:
33	            assert f.read() == content
34	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test___main__.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	def test_download_from_url_other_than_gdrive():
37	    url = "https://raw.githubusercontent.com/wkentaro/gdown/3.1.0/gdown/__init__.py"
38	    md5 = "2a51927dde6b146ce56b4d89ebbb5268"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test___main__.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
73	def test_download_and_extract():
74	    cmd = "gdown --no-cookies https://github.com/wkentaro/gdown/archive/refs/tags/v4.0.0.tar.gz -O - | tar zxvf -"  # noqa: E501
75	    with tempfile.TemporaryDirectory() as d:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test___main__.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
116	            "--no-cookies",
117	            "https://drive.google.com/drive/folders/1gd3xLkmjT8IckN6WtMbyFZvLR4exRIkn",
118	            "-O",
119	            d,
120	            "--folder",
121	        ]
122	    assert subprocess.call(cmd) == 1
123	
124	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test___main__.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
143	def test_download_a_folder_with_file_content_more_than_the_limit():
144	    url = "https://drive.google.com/drive/folders/1gd3xLkmjT8IckN6WtMbyFZvLR4exRIkn"
145	
146	    with tempfile.TemporaryDirectory() as d:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test_cached_download.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	def _cached_download(**kwargs):
8	    url = "https://drive.google.com/uc?id=0B9P1L--7Wd2vU3VUVlFnbTgtS2c"
9	    path = tempfile.mktemp()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test_download.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	        file_path = os.path.join(d, "file")
10	        url = "https://raw.githubusercontent.com/wkentaro/gdown/3.1.0/gdown/__init__.py"  # NOQA
11	        # Usage before https://github.com/wkentaro/gdown/pull/32
12	        assert download(url=url, output=file_path, quiet=False) == file_path

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test_download_folder.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12	    with open(html_file) as f:
13	        content = f.read()
14	    folder = "".join(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test_download_folder.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	        [
16	            "https://drive.google.com",
17	            "/drive/folders/1KpLl_1tcK0eeehzN980zbG-3M2nhbVks",
18	        ]
19	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test_download_folder.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	def test_download_folder_dry_run():
66	    url = "https://drive.google.com/drive/folders/1KpLl_1tcK0eeehzN980zbG-3M2nhbVks"
67	    tmp_dir = tempfile.mkdtemp()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test_parse_url.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	        (
12	            "https://drive.google.com/open?id={}".format(file_id),
13	            (file_id, False),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test_parse_url.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        (
17	            "https://drive.google.com/uc?id={}".format(file_id),
18	            (file_id, True),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test_parse_url.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        (
22	            "https://drive.google.com/file/d/{}/view?usp=sharing".format(file_id),
23	            (file_id, False),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/gdown-5.2.0/gdown-5.2.0/tests/test_parse_url.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        (
27	            "https://drive.google.com/a/jsk.imi.i.u-tokyo.ac.jp/uc?id={}&export=download".format(  # NOQA
28	                file_id

--------------------------------------------------

Code scanned:
	Total lines of code: 1310
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 27.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 40.0
		High: 0.0
Files skipped (0):
