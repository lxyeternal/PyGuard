Run started:2025-04-13 07:02:55.701358

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/auth.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	class AzureIdentityCredentialAdapter(BasicTokenAuthentication):
68	    def __init__(self, credential, resource_id="https://iothubs.azure.net/.default", **kwargs):
69	        """Adapt any azure-identity credential to work with SDK that needs azure.common.credentials or msrestazure.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/auth.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        return PipelineRequest(
79	            HttpRequest("AzureIdentityCredentialAdapter", "https://fakeurl"), PipelineContext(None)
80	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/iothub_amqp_client.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
73	            expiry = int(time.time() + default_sas_expiry)
74	            sas = base64.b64decode(shared_access_key)
75	            string_to_sign = (hostname + "\n" + str(expiry)).encode("utf-8")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/iothub_amqp_client.py:74
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
73	            expiry = int(time.time() + default_sas_expiry)
74	            sas = base64.b64decode(shared_access_key)
75	            string_to_sign = (hostname + "\n" + str(expiry)).encode("utf-8")

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/iothub_amqp_client.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
76	            signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
77	            signature = urllib.parse.quote(base64.b64encode(signed_hmac_sha256.digest()))
78	            return AccessToken(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/iothub_amqp_client.py:77
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
76	            signed_hmac_sha256 = hmac.HMAC(sas, string_to_sign, hashlib.sha256)
77	            signature = urllib.parse.quote(base64.b64encode(signed_hmac_sha256.digest()))
78	            return AccessToken(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/iothub_amqp_client.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	    def __init__(
101	        self, hostname, token_credential, token_scope="https://iothubs.azure.net/.default"
102	    ):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/protocol/iot_hub_gateway_service_ap_is.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	        if not base_url:
40	            base_url = "https://fully-qualified-iothubname.azure-devices.net"
41	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/sastoken.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
73	            message = (self._uri + "\n" + str(self.expiry_time)).encode(self._encoding_type)
74	            signing_key = base64.b64decode(self._key.encode(self._encoding_type))
75	            signed_hmac = hmac.HMAC(signing_key, message, hashlib.sha256)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/sastoken.py:74
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
73	            message = (self._uri + "\n" + str(self.expiry_time)).encode(self._encoding_type)
74	            signing_key = base64.b64decode(self._key.encode(self._encoding_type))
75	            signed_hmac = hmac.HMAC(signing_key, message, hashlib.sha256)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/sastoken.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
75	            signed_hmac = hmac.HMAC(signing_key, message, hashlib.sha256)
76	            signature = urllib.parse.quote(base64.b64encode(signed_hmac.digest()))
77	        except (TypeError, base64.binascii.Error) as e:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_iot_hub-2.6.1-py2.py3-none-any/azure/iot/hub/sastoken.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
75	            signed_hmac = hmac.HMAC(signing_key, message, hashlib.sha256)
76	            signature = urllib.parse.quote(base64.b64encode(signed_hmac.digest()))
77	        except (TypeError, base64.binascii.Error) as e:

--------------------------------------------------

Code scanned:
	Total lines of code: 6210
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 4.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 4.0
Files skipped (0):
