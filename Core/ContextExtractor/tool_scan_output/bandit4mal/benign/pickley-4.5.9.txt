Run started:2025-04-12 11:31:39.262051

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/setup.py:8
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
7	    author="Zoran Simic zoran@simicweb.com",
8	    url="https://github.com/codrsquad/pickley",
9	    python_requires=">=3.6",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/setup.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    project_urls={
39	        "Documentation": "https://github.com/codrsquad/pickley/wiki",
40	        "Release notes": "https://github.com/codrsquad/pickley/wiki/Release-notes",
41	        "Source": "https://github.com/codrsquad/pickley",
42	    },
43	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/setup.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
39	        "Documentation": "https://github.com/codrsquad/pickley/wiki",
40	        "Release notes": "https://github.com/codrsquad/pickley/wiki/Release-notes",
41	        "Source": "https://github.com/codrsquad/pickley",
42	    },
43	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/setup.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	        "Release notes": "https://github.com/codrsquad/pickley/wiki/Release-notes",
41	        "Source": "https://github.com/codrsquad/pickley",
42	    },
43	)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/__init__.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
32	}
33	PLATFORM = platform.system().lower()
34	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/__init__.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
32	}
33	PLATFORM = platform.system().lower()
34	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/__init__.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
32	}
33	PLATFORM = platform.system().lower()
34	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/bstrap.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	PIP_CONFS = ("~/.config/pip/pip.conf", "/etc/pip.conf")
27	DEFAULT_MIRROR = "https://pypi.org/simple"
28	CURRENT_PYTHON_MM = sys.version_info[:2]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/bstrap.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
142	            if not zipapp.exists():
143	                url = f"https://bootstrap.pypa.io/virtualenv/{pv}/virtualenv.pyz"
144	                download(zipapp, url)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/bstrap.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
174	            shutil.move(uv_tmp / "uvx", self.pickley_base / "uvx")
175	            shutil.rmtree(uv_tmp, ignore_errors=True)
176	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/bstrap.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
214	        if version:
215	            return f"https://github.com/astral-sh/uv/releases/download/{version}/uv-installer.sh"
216	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/bstrap.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
216	
217	        return "https://github.com/astral-sh/uv/releases/latest/download/uv-installer.sh"
218	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/bstrap.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
236	    request = Request(url)
237	    response = urlopen(request, timeout=10)
238	    target.write_bytes(response.read())

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/bstrap.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
237	    response = urlopen(request, timeout=10)
238	    target.write_bytes(response.read())
239	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/bstrap.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
307	            config = configparser.ConfigParser()
308	            config.read(expanduser(pip_conf_path))
309	            mirror = _groomed_mirror_url(config["global"]["index-url"])

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/cli.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
106	            runez.log.trace(f"{msg} {runez.short(self.lock_path)}")
107	            runez.write(self.lock_path, runez.joined(os.getpid(), runez.quoted(sys.argv[1:]), delimiter="\n"), logger=None)
108	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/delivery.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	
10	WRAPPER_MARK = "# Wrapper generated by https://pypi.org/project/pickley/"
11	
12	GENERIC_WRAPPER = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/delivery.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	PICKLEY_WRAPPER = (
37	    """
38	#!/bin/bash
39	
40	# pypi-package: pickley
41	%s
42	
43	if [[ -x {source} ]]; then
44	    if [[ "$*" != *"auto-"* ]]; then
45	        {hook}nohup {source} auto-upgrade {name}{bg}
46	    fi
47	    {hook}exec {source} "$@"
48	else
49	    echo "{source} is not available anymore"
50	    echo ""
51	    echo "Please reinstall with:"
52	    echo '/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/codrsquad/pickley/main/get-pickley)"'
53	    exit 1
54	fi
55	"""
56	    % WRAPPER_MARK
57	)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/src/pickley/package.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	            pip_wrapper = '#!/bin/sh -e\n\nVIRTUAL_ENV="$(cd $(dirname $0)/..; pwd)" exec uv pip "$@"'
69	            runez.write(pip_path, pip_wrapper, logger=None)
70	            runez.make_executable(pip_path, logger=None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_bootstrap.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    # Simulate bogus mirror, verify that we fail bootstrap in that case
64	    cli.run("-nvv", cli.project_folder, "-mhttp://localhost:12345")
65	    assert cli.succeeded

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_bootstrap.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	    assert cli.succeeded
66	    assert "Would seed .config/pip/pip.conf with http://localhost:12345" in cli.logged
67	    assert "Setting PIP_INDEX_URL and UV_INDEX_URL to http://localhost:12345" in cli.logged

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_bootstrap.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
66	    assert "Would seed .config/pip/pip.conf with http://localhost:12345" in cli.logged
67	    assert "Setting PIP_INDEX_URL and UV_INDEX_URL to http://localhost:12345" in cli.logged
68	    assert cli.match("Would run: .../.local/bin/.pk/.cache/pickley-bootstrap-venv/bin/pickley -vv bootstrap")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_bootstrap.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	    # Full bootstrap run, with seeding
94	    mirror = "https://pypi.org/simple"
95	
96	    # Seeding is best-effort (bootstrap still succeeds)
97	    runez.touch(".config/pip", logger=None)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_bootstrap.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
167	    runez.write("b", "[global]\nindex-url = /", logger=None)  # Valid, but mirror not actually configured
168	    runez.write("c", "[global]\nindex-url = https://example.com/simple//", logger=None)
169	    runez.write("d", "[global]\nindex-url = https://example.com/pypi2", logger=None)  # Not needed, previous one wins

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_bootstrap.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
168	    runez.write("c", "[global]\nindex-url = https://example.com/simple//", logger=None)
169	    runez.write("d", "[global]\nindex-url = https://example.com/pypi2", logger=None)  # Not needed, previous one wins
170	    assert bstrap.globally_configured_pypi_mirror(["no-such-file.conf", "a", "b", "c", "d"]) == ("https://example.com/simple", Path("c"))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_bootstrap.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	    runez.write("d", "[global]\nindex-url = https://example.com/pypi2", logger=None)  # Not needed, previous one wins
170	    assert bstrap.globally_configured_pypi_mirror(["no-such-file.conf", "a", "b", "c", "d"]) == ("https://example.com/simple", Path("c"))
171	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_config.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	
5	SAMPLE_CONFIG = """
6	base: {base}
7	
8	cli:  # empty
9	
10	{meta}/config.json:
11	  bundle:
12	    dev: tox mgit
13	    dev2: bundle:dev pipenv
14	  delivery: wrap
15	  include: custom.json
16	  index: https://pypi-mirror.mycompany.net/pypi
17	  pinned:
18	    mgit: 1.2.1
19	    tox:
20	      delivery: custom-delivery
21	      index: custom-index
22	      install_timeout: 42
23	      python: 2.8.1
24	      version: 3.2.1
25	
26	{meta}/custom.json:
27	  delivery: wrap
28	  foo: bar
29	  include:
30	   - bogus.json
31	   - /dev/null/non-existent-config-file.json
32	  install_timeout: 250
33	  python: /dev/null/foo
34	  version_check_delay: 15
35	
36	defaults:
37	  delivery: wrap
38	  install_timeout: 1800
39	  version_check_delay: 300
40	"""
41	
42	
43	def grab_sample(name):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_describe.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	
43	        cli.run("describe https://github.com/codrsquad/pickley.git")
44	        assert cli.succeeded

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_ops.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	    # Simulate a bogus symlink
99	    runez.write("some-folder/virtualenv", "#!/bin/sh\nexit 1", logger=None)
100	    runez.make_executable("some-folder/virtualenv", logger=None)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_ops.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
125	    # Simulate pickley wrapper
126	    runez.write("virtualenv", "echo installed by pickley", logger=None)
127	    runez.make_executable("virtualenv", logger=None)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_ops.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	    # Unknown executable -> skip pickley installation (since facultative)
133	    runez.write("virtualenv", "echo foo", logger=None)
134	    runez.make_executable("virtualenv", logger=None)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_ops.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
200	
201	    runez.write(".pk/config.json", '{"installation_retention": 0}', logger=None)
202	    cli.run("--no-color -vv install mgit<1.3.0")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_ops.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
276	
277	    runez.write(".pk/config.json", '{"cache_retention": 0}', logger=None)
278	    runez.delete("mgit", logger=None)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pickley-4.5.9/pickley-4.5.9/tests/test_ops.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
341	    # Check that lock detects bogus (or dead) PID
342	    runez.write(lock_path, "0\nbar\n", logger=None)
343	    with SoftLock("foo", give_up=600):

--------------------------------------------------

Code scanned:
	Total lines of code: 3131
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 14.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 33.0
		High: 1.0
Files skipped (0):
