Run started:2025-04-12 19:44:12.371374

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/__init__.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
386	        settings = dict(super().get_server_settings())
387	        settings['listen_addresses'] = '127.0.0.1'
388	        return settings

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/__init__.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
399	        if not host:
400	            host = '127.0.0.1'
401	        elif host.startswith('/'):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/__init__.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
401	        elif host.startswith('/'):
402	            host = '127.0.0.1'
403	        cls.proxy = fuzzer.TCPFuzzingProxy(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
20	class TCPFuzzingProxy:
21	    def __init__(self, *, listening_addr: str='127.0.0.1',
22	                 listening_port: typing.Optional[int]=None,
23	                 backend_host: str, backend_port: int,
24	                 settings: typing.Optional[dict]=None) -> None:
25	        self.listening_addr = listening_addr

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:84
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
83	
84	        self.sock = socket.socket()
85	        self.sock.bind((self.listening_addr, self.listening_port))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
91	        finally:
92	            self.loop.close()
93	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
101	            for c in list(self.connections):
102	                c.close()
103	            await asyncio.sleep(0.01)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
105	                self.loop.remove_reader(self.sock.fileno())
106	            self.sock.close()
107	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:114
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
113	
114	                backend_sock = socket.socket()
115	                backend_sock.setblocking(False)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
116	
117	                await self._wait(self.loop.sock_connect(
118	                    backend_sock, (self.backend_host, self.backend_port)))
119	            except StopServer:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
208	
209	            self.client_sock.close()
210	            self.backend_sock.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
209	            self.client_sock.close()
210	            self.backend_sock.close()
211	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
213	        read_task = asyncio.ensure_future(
214	            self.loop.sock_recv(sock, n))
215	        conn_event_task = asyncio.ensure_future(

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/_testbase/fuzzer.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
235	        write_task = asyncio.ensure_future(
236	            self.loop.sock_sendall(sock, data))
237	        conn_event_task = asyncio.ensure_future(

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
39	def find_available_port():
40	    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
41	    try:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
41	    try:
42	        sock.bind(('127.0.0.1', 0))
43	        return sock.getsockname()[1]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
46	    finally:
47	        sock.close()
48	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
129	        conn_info.update(kwargs)
130	        return await asyncpg.connect(loop=loop, **conn_info)
131	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
194	            shutil.copy(ssl_key, keyfile)
195	            os.chmod(keyfile, 0o600)
196	            server_settings = server_settings.copy()

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:195
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
194	            shutil.copy(ssl_key, keyfile)
195	            os.chmod(keyfile, 0o600)
196	            server_settings = server_settings.copy()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:305
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
304	        if status == 'stopped' or status == 'not-initialized':
305	            shutil.rmtree(self._data_dir)
306	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:467
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
466	            with open(pidfile, 'rt') as f:
467	                piddata = f.read()
468	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:498
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
497	            host_str = 'localhost'
498	        elif host_str == '0.0.0.0':
499	            host_str = '127.0.0.1'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
498	        elif host_str == '0.0.0.0':
499	            host_str = '127.0.0.1'
500	        elif host_str == '::':

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:523
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
522	                    con = loop.run_until_complete(
523	                        asyncpg.connect(database='postgres',
524	                                        user='postgres',
525	                                        timeout=5, loop=loop,
526	                                        **self._connection_addr))
527	                except (OSError, asyncio.TimeoutError,

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:538
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
537	                else:
538	                    loop.run_until_complete(con.close())
539	                    break

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
540	        finally:
541	            loop.close()
542	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
671	            with open(os.path.join(self._data_dir, 'recovery.conf'), 'w') as f:
672	                f.write(textwrap.dedent("""\
673	                    standby_mode = 'on'
674	                    primary_conninfo = 'host={host} port={port} user={user}'
675	                """.format(
676	                    host=self._master['host'],
677	                    port=self._master['port'],
678	                    user=self._repl_user)))
679	        else:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
671	            with open(os.path.join(self._data_dir, 'recovery.conf'), 'w') as f:
672	                f.write(textwrap.dedent("""\
673	                    standby_mode = 'on'
674	                    primary_conninfo = 'host={host} port={port} user={user}'
675	                """.format(
676	                    host=self._master['host'],
677	                    port=self._master['port'],
678	                    user=self._repl_user)))
679	        else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/cluster.py:681
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
680	            f = open(os.path.join(self._data_dir, 'standby.signal'), 'w')
681	            f.close()
682	

--------------------------------------------------
>> Issue: [B829:getuser] getpass.getuser
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b829_getuser.html
453	        if not user:
454	            user = getpass.getuser()
455	

--------------------------------------------------
>> Issue: [B329:blacklist] getpass_getuser
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:454
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b329-getpass-getuser
453	        if not user:
454	            user = getpass.getuser()
455	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:807
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
806	
807	    tr.write(struct.pack('!ll', 8, 80877103))  # SSLRequest message.
808	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:812
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
811	    except (Exception, asyncio.CancelledError):
812	        tr.close()
813	        raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
820	            except (Exception, asyncio.CancelledError):
821	                tr.close()
822	                raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
842	        _set_nodelay(sock)
843	        tr.close()
844	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
849	        except (Exception, asyncio.CancelledError):
850	            sock.close()
851	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
938	    ):
939	        tr.close()
940	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
964	    except (Exception, asyncio.CancelledError):
965	        tr.close()
966	        raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:1068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1067	    await asyncio.gather(
1068	        *(c.close() for c in candidates if c is not chosen_connection),
1069	        return_exceptions=True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:1113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1112	    try:
1113	        tr.write(msg)
1114	        await pr.on_disconnect

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connect_utils.py:1116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1115	    finally:
1116	        tr.close()
1117	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/asyncpg/connection.py:1384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1383	                    'only tuple-format codecs can be used on composite types',
1384	                    hint="Use `set_type_codec(..., format='tuple')` and "
1385	                         "pass/interpret data as a Python tuple.  See an "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/docs/conf.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
93	
94	intersphinx_mapping = {'python': ('https://docs.python.org/3', None)}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/setup.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
40	with open(str(_ROOT / 'README.rst')) as f:
41	    readme = f.read()
42	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/setup.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
82	        with open(str(filename)) as f:
83	            content = f.read()
84	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/setup.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
89	        with open(str(filename), 'w') as f:
90	            f.write(content)
91	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/certs/gen.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	    with open(path + ".key.pem", "wb") as f:
139	        f.write(
140	            private_key.private_bytes(
141	                encoding=serialization.Encoding.PEM,
142	                format=serialization.PrivateFormat.TraditionalOpenSSL,
143	                encryption_algorithm=encryption,
144	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/certs/gen.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
146	    with open(path + ".cert.pem", "wb") as f:
147	        f.write(
148	            certificate.public_bytes(
149	                encoding=serialization.Encoding.PEM,
150	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/certs/gen.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
186	    with open(path + ".crl.pem", "wb") as f:
187	        f.write(crl.public_bytes(encoding=serialization.Encoding.PEM))
188	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_adversity.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
18	@unittest.skipIf(
19	    platform.system() == 'Windows',
20	    'not compatible with ProactorEventLoop which is default in Python 3.8+')

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_adversity.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
18	@unittest.skipIf(
19	    platform.system() == 'Windows',
20	    'not compatible with ProactorEventLoop which is default in Python 3.8+')

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_adversity.py:19
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
18	@unittest.skipIf(
19	    platform.system() == 'Windows',
20	    'not compatible with ProactorEventLoop which is default in Python 3.8+')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_codecs.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
349	    ('inet', 'inet', [
350	        ipaddress.IPv4Address('255.255.255.255'),
351	        ipaddress.IPv4Address('127.0.0.1'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_codecs.py:351
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
350	        ipaddress.IPv4Address('255.255.255.255'),
351	        ipaddress.IPv4Address('127.0.0.1'),
352	        ipaddress.IPv4Address('0.0.0.0'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_codecs.py:352
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
351	        ipaddress.IPv4Address('127.0.0.1'),
352	        ipaddress.IPv4Address('0.0.0.0'),
353	        ipaddress.IPv6Address('ffff' + ':ffff' * 7),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_codecs.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
363	            input='127.0.0.1/32',
364	            output=ipaddress.IPv4Address('127.0.0.1')),
365	        # Postgres appends /32 when casting to text explicitly, but

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_codecs.py:368
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
367	        dict(
368	            input='10.11.12.13',
369	            textoutput='10.11.12.13/32'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_codecs.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
371	        dict(
372	            input=ipaddress.IPv4Address('10.11.12.13'),
373	            textoutput='10.11.12.13/32'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_codecs.py:376
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
375	        dict(
376	            input=ipaddress.IPv4Interface('10.11.12.13'),
377	            textoutput='10.11.12.13/32'

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_codecs.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
379	        dict(
380	            textinput='10.11.12.13',
381	            output=ipaddress.IPv4Address('10.11.12.13'),

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_codecs.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
380	            textinput='10.11.12.13',
381	            output=ipaddress.IPv4Address('10.11.12.13'),
382	        ),

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
234	                try:
235	                    return await self.connect(**kwargs)
236	                except asyncpg.ConnectionDoesNotExistError:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
238	
239	        return await self.connect(**kwargs)
240	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
243	                asyncpg.InvalidAuthorizationSpecificationError):
244	            await self._try_connect(user='__nonexistent__')
245	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
246	    async def test_auth_trust(self):
247	        conn = await self.connect(user='trust_user')
248	        await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
247	        conn = await self.connect(user='trust_user')
248	        await conn.close()
249	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
253	                'pg_hba.conf rejects connection'):
254	            await self._try_connect(user='reject_user')
255	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
256	    async def test_auth_password_cleartext(self):
257	        conn = await self.connect(
258	            user='password_user',
259	            password=CORRECT_PASSWORD)
260	        await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
259	            password=CORRECT_PASSWORD)
260	        await conn.close()
261	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
264	                'password authentication failed for user "password_user"'):
265	            await self._try_connect(
266	                user='password_user',
267	                password='wrongpassword')
268	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
275	
276	        conn = await self.connect(
277	            user='password_user',
278	            password=get_correctpassword)
279	        await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
278	            password=get_correctpassword)
279	        await conn.close()
280	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
283	                'password authentication failed for user "password_user"'):
284	            await self._try_connect(
285	                user='password_user',
286	                password=get_wrongpassword)
287	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:295
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
294	
295	        conn = await self.connect(
296	            user='password_user',
297	            password=get_correctpassword)
298	        await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
297	            password=get_correctpassword)
298	        await conn.close()
299	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
302	                'password authentication failed for user "password_user"'):
303	            await self._try_connect(
304	                user='password_user',
305	                password=get_wrongpassword)
306	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
313	
314	        conn = await self.connect(
315	            user='password_user',
316	            password=lambda: get_correctpassword())
317	        await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
316	            password=lambda: get_correctpassword())
317	        await conn.close()
318	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
321	                'password authentication failed for user "password_user"'):
322	            await self._try_connect(
323	                user='password_user',
324	                password=lambda: get_wrongpassword())
325	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
326	    async def test_auth_password_md5(self):
327	        conn = await self.connect(
328	            user='md5_user', password=CORRECT_PASSWORD)
329	        await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
328	            user='md5_user', password=CORRECT_PASSWORD)
329	        await conn.close()
330	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
333	                'password authentication failed for user "md5_user"'):
334	            await self._try_connect(
335	                user='md5_user', password='wrongpassword')
336	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
341	
342	        conn = await self.connect(
343	            user='scram_sha_256_user', password=CORRECT_PASSWORD)
344	        await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
343	            user='scram_sha_256_user', password=CORRECT_PASSWORD)
344	        await conn.close()
345	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
349	        ):
350	            await self._try_connect(
351	                user='scram_sha_256_user', password='wrongpassword')
352	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
374	            # test to see that passwords are properly SASL prepped
375	            conn = await self.connect(
376	                user='scram_sha_256_user', password=password)
377	            await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
376	                user='scram_sha_256_user', password=password)
377	            await conn.close()
378	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
389	        ):
390	            await self.connect(user='md5_user', password=CORRECT_PASSWORD)
391	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
435	    async def test_auth_gssapi_ok(self):
436	        conn = await self.connect(user=self.realm.user_princ)
437	        await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
436	        conn = await self.connect(user=self.realm.user_princ)
437	        await conn.close()
438	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:445
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
444	        ):
445	            await self.connect(user=self.realm.user_princ, krbsrvname='wrong')
446	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
452	        ):
453	            await self.connect(user=f'wrong-{self.realm.user_princ}')
454	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
459	    def setUpClass(cls):
460	        cls.username = f'{os.getlogin()}@{socket.gethostname()}'
461	        cls.USERS = [

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:460
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
459	    def setUpClass(cls):
460	        cls.username = f'{os.getlogin()}@{socket.gethostname()}'
461	        cls.USERS = [

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
467	    async def test_auth_sspi(self):
468	        conn = await self.connect(user=self.username)
469	        await conn.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
468	        conn = await self.connect(user=self.username)
469	        await conn.close()
470	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
475	        ):
476	            await self.connect(user=f'wrong-{self.username}')
477	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:939
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
938	                   '&port=2222&database=testdb&sslmode=require',
939	            'host': '127.0.0.1',
940	            'port': '888',
941	            'user': 'me',
942	            'password': 'ask',
943	            'database': 'db',
944	            'result': ([('127.0.0.1', 888)], {
945	                'server_settings': {'param': '123'},
946	                'user': 'me',
947	                'password': 'ask',
948	                'database': 'db',
949	                'ssl': True,
950	                'sslmode': SSLMode.require,
951	                'target_session_attrs': 'any'})
952	        },
953	
954	        {
955	            'name': 'params_settings_and_ssl_override_dsn',
956	            'dsn': 'postgresql://user3:123123@localhost:5555/'
957	                   'abcdef?param=sss&param=123&host=testhost&user=testuser'
958	                   '&port=2222&database=testdb&sslmode=disable',
959	            'host': '127.0.0.1',

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:944
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
943	            'database': 'db',
944	            'result': ([('127.0.0.1', 888)], {
945	                'server_settings': {'param': '123'},

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:959
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
958	                   '&port=2222&database=testdb&sslmode=disable',
959	            'host': '127.0.0.1',
960	            'port': '888',
961	            'user': 'me',
962	            'password': 'ask',
963	            'database': 'db',
964	            'server_settings': {'aa': 'bb'},
965	            'ssl': True,
966	            'result': ([('127.0.0.1', 888)], {
967	                'server_settings': {'aa': 'bb', 'param': '123'},
968	                'user': 'me',
969	                'password': 'ask',
970	                'database': 'db',
971	                'sslmode': SSLMode.verify_full,
972	                'ssl': True,
973	                'target_session_attrs': 'any'})
974	        },
975	
976	        {
977	            'name': 'dsn_only_unix',
978	            'dsn': 'postgresql:///dbname?host=/unix_sock/test&user=spam',
979	            'result': ([os.path.join('/unix_sock/test', '.s.PGSQL.5432')], {
980	                'user': 'spam',
981	                'database': 'dbname',

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:966
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
965	            'ssl': True,
966	            'result': ([('127.0.0.1', 888)], {
967	                'server_settings': {'aa': 'bb', 'param': '123'},

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1075
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1074	                [
1075	                    ('127.0.0.1', 5432),
1076	                    os.path.join(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1240	        passfile = tempfile.NamedTemporaryFile('w+t', delete=False)
1241	        passfile.write(textwrap.dedent(R'''
1242	            abc:*:*:user:password from pgpass for user@abc

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1241
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1240	        passfile = tempfile.NamedTemporaryFile('w+t', delete=False)
1241	        passfile.write(textwrap.dedent(R'''
1242	            abc:*:*:user:password from pgpass for user@abc

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1250	        '''))
1251	        passfile.close()
1252	        os.chmod(passfile.name, stat.S_IWUSR | stat.S_IRUSR)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1251	        passfile.close()
1252	        os.chmod(passfile.name, stat.S_IWUSR | stat.S_IRUSR)
1253	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1252
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1251	        passfile.close()
1252	        os.chmod(passfile.name, stat.S_IWUSR | stat.S_IRUSR)
1253	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1416
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1415	        with tempfile.NamedTemporaryFile('w+t') as passfile:
1416	            os.chmod(passfile.name,
1417	                     stat.S_IWUSR | stat.S_IRUSR | stat.S_IWGRP | stat.S_IRGRP)
1418	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1416
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1415	        with tempfile.NamedTemporaryFile('w+t') as passfile:
1416	            os.chmod(passfile.name,
1417	                     stat.S_IWUSR | stat.S_IRUSR | stat.S_IWGRP | stat.S_IRGRP)
1418	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1478
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1477	        with tempfile.NamedTemporaryFile('w+t') as passfile:
1478	            os.chmod(passfile.name, stat.S_IWUSR)
1479	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1478
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1477	        with tempfile.NamedTemporaryFile('w+t') as passfile:
1478	            os.chmod(passfile.name, stat.S_IWUSR)
1479	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1499	            with tempfile.NamedTemporaryFile('w+t', dir=passdir) as passfile:
1500	                os.chmod(passdir, stat.S_IWUSR)
1501	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1500
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1499	            with tempfile.NamedTemporaryFile('w+t', dir=passdir) as passfile:
1500	                os.chmod(passdir, stat.S_IWUSR)
1501	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1518	                finally:
1519	                    os.chmod(passdir, stat.S_IRWXU)
1520	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1519
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1518	                finally:
1519	                    os.chmod(passdir, stat.S_IRWXU)
1520	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1524
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1523	            with self.assertRaisesRegex(ValueError, 'greater than 0'):
1524	                await asyncpg.connect(command_timeout=val)
1525	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1530	                with self.assertRaisesRegex(ValueError, 'greater or equal'):
1531	                    await asyncpg.connect(**{arg: val})
1532	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1545	
1546	        await self.con.close()
1547	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1577	        with self.assertRaisesRegex(ConnectionError, 'rejected SSL'):
1578	            await self.connect(
1579	                host='localhost',
1580	                user='ssl_user',
1581	                ssl=ssl_context)
1582	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1587	            try:
1588	                con = await self.connect(
1589	                    dsn='postgresql://foo/?sslmode=' + sslmode,
1590	                    user='postgres',
1591	                    database='postgres',
1592	                    host='localhost')
1593	                self.assertEqual(await con.fetchval('SELECT 42'), 42)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1597
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1596	                if con:
1597	                    await con.close()
1598	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1603
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1602	                with self.assertRaises(ConnectionError):
1603	                    con = await self.connect(
1604	                        dsn='postgresql://foo/?sslmode=' + sslmode,
1605	                        user='postgres',
1606	                        database='postgres',
1607	                        host='localhost')
1608	                    await con.fetchval('SELECT 42')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1610	                if con:
1611	                    await con.close()
1612	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1624
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1623	        conn_spec = self.get_connection_spec()
1624	        con = await asyncpg.connect(
1625	            port=conn_spec.get('port'),
1626	            database=conn_spec.get('database'),
1627	            user=conn_spec.get('user'))
1628	        await con.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1627	            user=conn_spec.get('user'))
1628	        await con.close()
1629	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1633
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1632	        with mock_no_home_dir():
1633	            con = await self.connect(
1634	                dsn='postgresql://foo/',
1635	                user='postgres',
1636	                database='postgres',
1637	                host='localhost')
1638	            await con.fetchval('SELECT 42')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1638	            await con.fetchval('SELECT 42')
1639	            await con.close()
1640	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1641	        with mock_dev_null_home_dir():
1642	            con = await self.connect(
1643	                dsn='postgresql://foo/',
1644	                user='postgres',
1645	                database='postgres',
1646	                host='localhost')
1647	            await con.fetchval('SELECT 42')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1648
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1647	            await con.fetchval('SELECT 42')
1648	            await con.close()
1649	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1655
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1654	            with mock_no_home_dir():
1655	                await self.connect(
1656	                    host='localhost',
1657	                    user='ssl_user',
1658	                    ssl='verify-full')
1659	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1664	            with mock_dev_null_home_dir():
1665	                await self.connect(
1666	                    host='localhost',
1667	                    user='ssl_user',
1668	                    ssl='verify-full')
1669	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1743
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1742	
1743	        con = await self.connect(
1744	            host='localhost',
1745	            user='ssl_user',
1746	            ssl=ssl_context)
1747	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1756
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1755	        finally:
1756	            await con.close()
1757	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1761	            try:
1762	                con = await self.connect(
1763	                    dsn='postgresql://foo/postgres?sslmode=' + sslmode,
1764	                    host=host,
1765	                    user='ssl_user')
1766	                self.assertEqual(await con.fetchval('SELECT 42'), 42)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1770
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1769	                if con:
1770	                    await con.close()
1771	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1778	                with self.assertRaises(exn_type):
1779	                    con = await self.connect(
1780	                        dsn='postgresql://foo/?sslmode=' + sslmode,
1781	                        host=host,
1782	                        user='ssl_user')
1783	                    await con.fetchval('SELECT 42')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1786
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1785	                if con:
1786	                    await con.close()
1787	                self.loop.set_exception_handler(old_handler)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1800
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1799	            await verify_works('verify-ca')
1800	            await verify_works('verify-ca', host='127.0.0.1')
1801	            await verify_works('verify-full')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1802
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1801	            await verify_works('verify-full')
1802	            await verify_fails('verify-full', host='127.0.0.1',
1803	                               exn_type=ssl.CertificateError)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1813
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
1812	                               exn_type=ssl.SSLError)
1813	            await verify_fails('verify-ca', host='127.0.0.1',
1814	                               exn_type=ssl.SSLError)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1823	            with self.assertRaisesRegex(ssl.SSLError, 'verify failed'):
1824	                await self.connect(
1825	                    host='localhost',
1826	                    user='ssl_user',
1827	                    ssl=True)
1828	        finally:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1854
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1853	        await asyncio.gather(*tasks)
1854	        await pool.close()
1855	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1859	
1860	        con = await self.connect(
1861	            host='localhost',
1862	            user='ssl_user',
1863	            ssl=ssl_context)
1864	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1877	            finally:
1878	                await con.close()
1879	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1899
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1898	                ):
1899	                    await self.connect(
1900	                        dsn='postgresql://ssl_user@localhost/postgres'
1901	                            '?sslmode=require&ssl_min_protocol_version=TLSv1.3'

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1904
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1903	                with self.assertRaises((ssl.SSLError, ConnectionResetError)):
1904	                    await self.connect(
1905	                        dsn='postgresql://ssl_user@localhost/postgres'
1906	                            '?sslmode=require'

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1911	                    with self.assertRaisesRegex(ssl.SSLError, 'no protocols'):
1912	                        await self.connect(
1913	                            dsn='postgresql://ssl_user@localhost/postgres'
1914	                                '?sslmode=require'

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1918
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1917	                        )
1918	                con = await self.connect(
1919	                    dsn='postgresql://ssl_user@localhost/postgres'
1920	                        '?sslmode=require'

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1927
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1926	                finally:
1927	                    await con.close()
1928	            finally:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1955
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1954	        ):
1955	            await self.connect(
1956	                host='localhost',
1957	                user='ssl_user',
1958	                ssl=ssl_context,
1959	            )

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1962
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1961	    async def _test_works(self, **conn_args):
1962	        con = await self.connect(**conn_args)
1963	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:1967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1966	        finally:
1967	            await con.close()
1968	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2041	            try:
2042	                con = await self.connect(
2043	                    dsn='postgresql://foo/postgres?sslmode=' + sslmode,
2044	                    host=host,
2045	                    user='ssl_user')
2046	                self.assertEqual(await con.fetchval('SELECT 42'), 42)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2049	                if con:
2050	                    await con.close()
2051	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2061
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2060	                ):
2061	                    con = await self.connect(
2062	                        dsn='postgresql://foo/?sslmode=' + sslmode,
2063	                        host=host,
2064	                        user='ssl_user')
2065	                    await con.fetchval('SELECT 42')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2068
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2067	                if con:
2068	                    await con.close()
2069	                self.loop.set_exception_handler(old_handler)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2080	    async def test_nossl_connection_prefer_cancel(self):
2081	        con = await self.connect(
2082	            dsn='postgresql://foo/postgres?sslmode=prefer',
2083	            host='localhost',
2084	            user='ssl_user')
2085	        try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2092
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2091	        finally:
2092	            await con.close()
2093	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2114	        await asyncio.gather(*tasks)
2115	        await pool.close()
2116	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2123	        try:
2124	            con = await self.connect()
2125	            await con.fetchval("select 123")

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2173	    ):
2174	        conn = await connect(target_session_attrs=target_attribute)
2175	        self.assertTrue(_get_connected_host(conn).endswith(expected_port))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2175	        self.assertTrue(_get_connected_host(conn).endswith(expected_port))
2176	        await conn.close()
2177	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2209	            with self.assertRaises(exceptions.TargetServerAttributeNotMatched):
2210	                await connect(target_session_attrs=target_attr)
2211	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2220	            with self.assertRaises(exceptions.TargetServerAttributeNotMatched):
2221	                await connect(target_session_attrs=target_attr)
2222	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2223	    async def test_prefer_standby_when_standby_is_up(self):
2224	        con = await self.connect(target_session_attrs='prefer-standby')
2225	        standby_port = self.standby_cluster.get_connection_spec()['port']

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2227	        self.assertTrue(connected_host.endswith(standby_port))
2228	        await con.close()
2229	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
2242	
2243	        con = await self.connect(**connection_spec)
2244	        master_port = self.master_cluster.get_connection_spec()['port']

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_connect.py:2247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
2246	        self.assertTrue(connected_host.endswith(master_port))
2247	        await con.close()
2248	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	            with open(f.name, 'rb') as fr:
184	                output = fr.read().decode().split('\n')
185	                self.assertEqual(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
213	            with open(f.name, 'rb') as fr:
214	                output = fr.read().decode().split('\n')
215	                self.assertEqual(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
239	                await asyncio.sleep(0.05)
240	                f.write(data)
241	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
239	                await asyncio.sleep(0.05)
240	                f.write(data)
241	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
250	
251	            output = f.read().decode().split('\n')
252	            self.assertEqual(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
372	            f = io.BytesIO()
373	            f.write(
374	                '\n'.join([
375	                    'a1\tb1\t1',
376	                    'a2\tb2\t2',
377	                    'a3\tb3\t3',
378	                    'a4\tb4\t4',
379	                    'a5\tb5\t5',
380	                    '*\t\\N\t\\N',
381	                    ''
382	                ]).encode('utf-8')
383	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
372	            f = io.BytesIO()
373	            f.write(
374	                '\n'.join([
375	                    'a1\tb1\t1',
376	                    'a2\tb2\t2',
377	                    'a3\tb3\t3',
378	                    'a4\tb4\t4',
379	                    'a5\tb5\t5',
380	                    '*\t\\N\t\\N',
381	                    ''
382	                ]).encode('utf-8')
383	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
410	
411	            f.write(
412	                '\n'.join([
413	                    'a|b~',
414	                    '*a1*|b1',
415	                    '*a2*|b2',
416	                    '*a3*|b3',
417	                    '*a4*|b4',
418	                    '*a5*|b5',
419	                    '*!**|*n-u-l-l*',
420	                    'n-u-l-l|bb',
421	                ]).encode('utf-8')
422	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:411
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
410	
411	            f.write(
412	                '\n'.join([
413	                    'a|b~',
414	                    '*a1*|b1',
415	                    '*a2*|b2',
416	                    '*a3*|b3',
417	                    '*a4*|b4',
418	                    '*a5*|b5',
419	                    '*!**|*n-u-l-l*',
420	                    'n-u-l-l|bb',
421	                ]).encode('utf-8')
422	            )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
590	        try:
591	            f.write(
592	                '\n'.join([
593	                    'a1\tb1\t1',
594	                    'a2\tb2\t2',
595	                    'a3\tb3\t3',
596	                    'a4\tb4\t4',
597	                    'a5\tb5\t5',
598	                    '*\t\\N\t\\N',
599	                    ''
600	                ]).encode('utf-8')
601	            )

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_copy.py:591
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
590	        try:
591	            f.write(
592	                '\n'.join([
593	                    'a1\tb1\t1',
594	                    'a2\tb2\t2',
595	                    'a3\tb3\t3',
596	                    'a4\tb4\t4',
597	                    'a5\tb5\t5',
598	                    '*\t\\N\t\\N',
599	                    ''
600	                ]).encode('utf-8')
601	            )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_listeners.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
315	@unittest.skipIf(
316	    platform.system() == 'Windows',
317	    'not compatible with ProactorEventLoop which is default in Python 3.8+')

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_listeners.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
315	@unittest.skipIf(
316	    platform.system() == 'Windows',
317	    'not compatible with ProactorEventLoop which is default in Python 3.8+')

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_listeners.py:316
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
315	@unittest.skipIf(
316	    platform.system() == 'Windows',
317	    'not compatible with ProactorEventLoop which is default in Python 3.8+')

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_pool.py:794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
793	        locals_ = {}
794	        exec(textwrap.dedent('''\
795	            async def iterate(con):
796	                async with con.transaction():
797	                    for record in await con.fetch("SELECT 1"):
798	                        yield record
799	        '''), globals(), locals_)
800	        iterate = locals_['iterate']

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_pool.py:815
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
814	        locals_ = {}
815	        exec(textwrap.dedent('''\
816	            async def iterate(con):
817	                async with con.transaction():
818	                    for record in await con.fetch("SELECT 1"):
819	                        yield record
820	        '''), globals(), locals_)
821	        iterate = locals_['iterate']

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/asyncpg-0.30.0/asyncpg-0.30.0/tests/test_pool.py:839
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
838	        locals_ = {}
839	        exec(textwrap.dedent('''\
840	            async def iterate(con):
841	                for record in await con.fetch("SELECT 1"):
842	                    yield record
843	        '''), globals(), locals_)
844	        iterate = locals_['iterate']

--------------------------------------------------

Code scanned:
	Total lines of code: 15703
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 42.0
		High: 144.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 170.0
		High: 16.0
Files skipped (0):
