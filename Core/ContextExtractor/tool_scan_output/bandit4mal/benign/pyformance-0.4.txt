Run started:2025-04-12 12:19:08.421258

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/carbon_reporter.py:11
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
10	
11	DEFAULT_CARBON_SERVER = '0.0.0.0'
12	DEFAULT_CARBON_PORT = 2003

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/carbon_reporter.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
35	            with contextlib.closing(self.socket_factory()) as sock:
36	                sock.connect((self.server, self.port))
37	                sock.sendall(metrics)

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/carbon_reporter.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
36	                sock.connect((self.server, self.port))
37	                sock.sendall(metrics)
38	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/csv_reporter.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	                    f = open(target, "w")
41	                    f.write("%s\n" % self.separator.join(["timestamp"] + value_keys))
42	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/csv_reporter.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
47	                cols.append(values[vk])
48	            f.write("%s\n" % self.separator.join(map(str, cols)))
49	            f.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/hosted_graphite_reporter.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	    def __init__(
19	        self, hosted_graphite_api_key, registry=None, reporting_interval=10, url="https://hostedgraphite.com/api/v1/sink",
20	            clock=None):
21	        super(HostedGraphiteReporter, self).__init__(

--------------------------------------------------
>> Issue: [B321:blacklist] urllib2_Request
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/hosted_graphite_reporter.py:31
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-urllib2-request
30	                # XXX: better use http-keepalive/pipelining somehow?
31	                request = urllib2.Request(self.url, metrics)
32	                request.add_header("Authorization", "Basic %s" %

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/hosted_graphite_reporter.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
33	                                   base64.encodestring(self.api_key).strip())
34	                result = urllib2.urlopen(request)
35	            except Exception as e:

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/hosted_graphite_reporter.py:34
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
33	                                   base64.encodestring(self.api_key).strip())
34	                result = urllib2.urlopen(request)
35	            except Exception as e:

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/influx.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
15	
16	DEFAULT_INFLUX_SERVER = '127.0.0.1'
17	DEFAULT_INFLUX_PORT = 8086

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/influx.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
55	        try:
56	            response = urlopen(request)
57	            _result = response.read()

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/influx.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
87	        try:
88	            response = urlopen(request)
89	            response.read()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/influx.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
96	    auth_string = ('%s:%s' % (username, password)).encode()
97	    return base64.b64encode(auth_string)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/influx.py:97
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
96	    auth_string = ('%s:%s' % (username, password)).encode()
97	    return base64.b64encode(auth_string)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/newrelic_reporter.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
19	
20	DEFAULT_CARBON_SERVER = '0.0.0.0'
21	DEFAULT_CARBON_PORT = 2003

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/newrelic_reporter.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	    MAX_METRICS_PER_REQUEST = 10000
56	    PLATFORM_URL = 'https://platform-api.newrelic.com/platform/v1/metrics'
57	
58	    def __init__(self, license_key, registry=None, name=socket.gethostname(), reporting_interval=5, prefix="",

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/newrelic_reporter.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
57	
58	    def __init__(self, license_key, registry=None, name=socket.gethostname(), reporting_interval=5, prefix="",
59	                 clock=None):

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/newrelic_reporter.py:58
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
57	
58	    def __init__(self, license_key, registry=None, name=socket.gethostname(), reporting_interval=5, prefix="",
59	                 clock=None):

--------------------------------------------------
>> Issue: [B321:blacklist] urllib2_Request
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/newrelic_reporter.py:75
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-urllib2-request
74	                # XXX: better use http-keepalive/pipelining somehow?
75	                request = urllib.Request(self.PLATFORM_URL, metrics.encode() if sys.version_info[0] > 2 else metrics)
76	                for k, v in self.http_headers.items():

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/newrelic_reporter.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
77	                    request.add_header(k, v)
78	                result = urllib.urlopen(request)
79	                if isinstance(result, urlerror.HTTPError):

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/newrelic_reporter.py:78
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
77	                    request.add_header(k, v)
78	                result = urllib.urlopen(request)
79	                if isinstance(result, urlerror.HTTPError):

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/newrelic_reporter.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
90	        """
91	        return {'host': socket.gethostname(),
92	                'pid': os.getpid(),

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/newrelic_reporter.py:91
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
90	        """
91	        return {'host': socket.gethostname(),
92	                'pid': os.getpid(),

--------------------------------------------------
>> Issue: [B321:blacklist] urllib2_Request
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/opentsdb_reporter.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-urllib2-request
35	            try:
36	                request = urllib.Request(self.url,
37	                                         data=json.dumps(metrics).encode("utf-8"),
38	                                         headers={'content-type': "application/json"})
39	                authentication_data = "{0}:{1}".format(self.application_name, self.write_key)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/opentsdb_reporter.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
39	                authentication_data = "{0}:{1}".format(self.application_name, self.write_key)
40	                auth_header = base64.b64encode(bytes(authentication_data.encode("utf-8")))
41	                request.add_header("Authorization", "Basic {0}".format(auth_header))

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/opentsdb_reporter.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
39	                authentication_data = "{0}:{1}".format(self.application_name, self.write_key)
40	                auth_header = base64.b64encode(bytes(authentication_data.encode("utf-8")))
41	                request.add_header("Authorization", "Basic {0}".format(auth_header))

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/opentsdb_reporter.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
41	                request.add_header("Authorization", "Basic {0}".format(auth_header))
42	                urllib.urlopen(request)
43	            except Exception as e:

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/pyformance/reporters/opentsdb_reporter.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
41	                request.add_header("Authorization", "Basic {0}".format(auth_header))
42	                urllib.urlopen(request)
43	            except Exception as e:

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/setup.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
8	with open(_IN_PACKAGE_DIR("__version__.py")) as version_file:
9	    exec(version_file.read())
10	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/setup.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
8	with open(_IN_PACKAGE_DIR("__version__.py")) as version_file:
9	    exec(version_file.read())
10	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/tests/test__csv_reporter.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
26	        if os.path.exists(self.path):
27	            shutil.rmtree(self.path)
28	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/tests/test__csv_reporter.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	
40	        output = open(output_filename).read()
41	        self.assertEqual(output.splitlines(), [

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/tests/test__newrelic_reporter.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
36	        expected = '{"agent": {"host": "%s", "pid": %s, "version": "%s"}, "components": [{"duration": 1, "guid": "com.github.pyformance", "metrics": {"Component/t1": {' \
37	                   '"count": 1, "max": 1, "min": 1, "sum_of_squares": 1, "total": 1}}, "name": "foo"}]}' % (socket.gethostname(), os.getpid(), __version__)
38	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/tests/test__newrelic_reporter.py:37
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
36	        expected = '{"agent": {"host": "%s", "pid": %s, "version": "%s"}, "components": [{"duration": 1, "guid": "com.github.pyformance", "metrics": {"Component/t1": {' \
37	                   '"count": 1, "max": 1, "min": 1, "sum_of_squares": 1, "total": 1}}, "name": "foo"}]}' % (socket.gethostname(), os.getpid(), __version__)
38	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/tests/test__opentsdb_reporter.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	        r = OpenTSDBReporter(application_name="app", write_key="key", registry=self.registry, reporting_interval=1,
21	                             clock=self.clock, prefix="prefix.", url="http://opentsdb.com/api/put")
22	        h1 = self.registry.histogram("hist")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyformance-0.4/pyformance-0.4/tests/test__opentsdb_reporter.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	        r = OpenTSDBReporter(application_name="app", write_key="key", registry=self.registry, reporting_interval=1,
42	                             clock=self.clock, prefix="prefix.", url="http://opentsdb.com/api/put")
43	        h1 = self.registry.histogram("hist")

--------------------------------------------------

Code scanned:
	Total lines of code: 1974
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 12.0
Files skipped (0):
