Run started:2025-04-12 10:53:19.807576

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/setup.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	    long_description_content_type="text/markdown",
32	    url="https://github.com/GoogleCloudPlatform/terraform-python-testing-helper",
33	    py_modules=['tftest'],

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/test/test_cache.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
43	  try:
44	    shutil.rmtree(terra.cache_dir)
45	  except FileNotFoundError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/test/test_cache.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
176	  with open(filepath, "w") as f:
177	    f.write("old")
178	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/test/test_cache.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
195	        with open(dummy_tf_filepath, "w") as f:
196	          f.write(str(uuid.uuid4()))
197	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/test/test_workspace.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
27	  yield tf
28	  shutil.rmtree(os.path.join(tf.tfdir, 'terraform.tfstate.d'))
29	  os.remove(os.path.join(tf.tfdir, '.terraform.lock.hcl'))

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
355	      _LOGGER.warning(f'Issue deleting file {path}, caused by {excinfo}')
356	      os.chmod(path, stat.S_IWRITE)
357	      func(path)

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:356
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
355	      _LOGGER.warning(f'Issue deleting file {path}, caused by {excinfo}')
356	      os.chmod(path, stat.S_IWRITE)
357	      func(path)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:367
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
366	    if os.path.isdir(path):
367	      shutil.rmtree(path, onerror=remove_readonly)
368	    path = os.path.join(tfdir, 'terraform.tfstate')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
373	      if os.path.isdir(tg_dir):
374	        shutil.rmtree(tg_dir, onerror=remove_readonly)
375	    _LOGGER.debug(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
409	        with open(path, "rb") as f:
410	          for chunk in iter(lambda: f.read(4096), b""):
411	            hash.update(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:435
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
434	          params[path_param] = [
435	              sha1(open(fp, 'rb').read()).hexdigest()
436	              for fp in method_kwargs[path_param]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
439	          params[path_param] = sha1(
440	              open(method_kwargs[path_param], 'rb').read()).hexdigest()
441	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:552
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
551	          with open(tf_file, 'r') as src:
552	            terraform = src.read()
553	          with open(tf_file, 'w') as src:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
555	                               'prevent_destroy = false', terraform)
556	            src.write(terraform)
557	        except (OSError, IOError):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/tftest-1.8.5/tftest-1.8.5/tftest.py:556
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
555	                               'prevent_destroy = false', terraform)
556	            src.write(terraform)
557	        except (OSError, IOError):

--------------------------------------------------

Code scanned:
	Total lines of code: 1265
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 14.0
		High: 1.0
Files skipped (0):
