Run started:2025-04-12 10:29:03.897288

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/_help.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	helps['ad app create'] = """
21	type: command
22	short-summary: Create a web application, web API or native application
23	examples:
24	  - name: Create a native application with delegated permission of "access the AAD directory as the signed-in user"
25	    text: |
26	        az ad app create --display-name my-native --native-app --required-resource-accesses @manifest.json
27	        ("manifest.json" contains the following content)
28	        [{
29	            "resourceAppId": "00000002-0000-0000-c000-000000000000",
30	            "resourceAccess": [
31	                {
32	                    "id": "a42657d6-7f20-40e3-b6f0-cee03008a62a",
33	                    "type": "Scope"
34	                }
35	           ]
36	        }]
37	  - name: Create an application with a role
38	    text: |
39	        az ad app create --id e042ec79-34cd-498f-9d9f-123456781234 --display-name mytestapp --identifier-uris https://mytestapp.websites.net --app-roles @manifest.json
40	        ("manifest.json" contains the following content)
41	        [{
42	            "allowedMemberTypes": [
43	              "User"
44	            ],
45	            "description": "Approvers can mark documents as approved",
46	            "displayName": "Approver",
47	            "isEnabled": "true",
48	            "value": "approver"
49	        }]
50	"""
51	
52	helps['ad app credential'] = """

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
761	        if 'insufficient privileges' in str(ex).lower():
762	            link = 'https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-create-service-principal-portal'  # pylint: disable=line-too-long
763	            raise CLIError("Directory permission is needed for the current user to register the application. "

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
870	    application = show_application(graph_client.applications, identifier)
871	    url = 'https://main.iam.ad.ext.azure.com/api/RegisteredApplications/{}/Consent?onBehalfOfAll=true'.format(
872	        application.app_id)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1200	        kv_client = _get_keyvault_client(cli_ctx)
1201	        vault_base = 'https://{}{}/'.format(keyvault, cli_ctx.cloud.suffixes.keyvault_dns)
1202	        cert_obj = kv_client.get_certificate(vault_base, cert, '')

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1202	        cert_obj = kv_client.get_certificate(vault_base, cert, '')
1203	        public_cert_string = base64.b64encode(cert_obj.cer).decode('utf-8')  # pylint: disable=no-member
1204	        cert_start_date = cert_obj.attributes.not_before  # pylint: disable=no-member

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1202	        cert_obj = kv_client.get_certificate(vault_base, cert, '')
1203	        public_cert_string = base64.b64encode(cert_obj.cer).decode('utf-8')  # pylint: disable=no-member
1204	        cert_start_date = cert_obj.attributes.not_before  # pylint: disable=no-member

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1407	    with open(cert_file, "wt") as f:
1408	        f.write(crypto.dump_certificate(crypto.FILETYPE_PEM, cert).decode())
1409	    with open(key_file, "wt") as f:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1407	    with open(cert_file, "wt") as f:
1408	        f.write(crypto.dump_certificate(crypto.FILETYPE_PEM, cert).decode())
1409	    with open(key_file, "wt") as f:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1409	    with open(key_file, "wt") as f:
1410	        f.write(crypto.dump_privatekey(crypto.FILETYPE_PEM, k).decode())
1411	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1409	    with open(key_file, "wt") as f:
1410	        f.write(crypto.dump_privatekey(crypto.FILETYPE_PEM, k).decode())
1411	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1414	        with open(key_file, 'rt') as f:
1415	            cf.write(f.read())
1416	        with open(cert_file, "rt") as f:

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1414	        with open(key_file, 'rt') as f:
1415	            cf.write(f.read())
1416	        with open(cert_file, "rt") as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1414	        with open(key_file, 'rt') as f:
1415	            cf.write(f.read())
1416	        with open(cert_file, "rt") as f:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1416	        with open(cert_file, "rt") as f:
1417	            cert_string = f.read()
1418	            cf.write(cert_string)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1417	            cert_string = f.read()
1418	            cf.write(cert_string)
1419	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1417	            cert_string = f.read()
1418	            cf.write(cert_string)
1419	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1463
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1462	    }
1463	    vault_base_url = 'https://{}{}/'.format(keyvault, cli_ctx.cloud.suffixes.keyvault_dns)
1464	    kv_client.create_certificate(vault_base_url, keyvault_cert_name, cert_policy)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1468	    cert = kv_client.get_certificate(vault_base_url, keyvault_cert_name, '')
1469	    cert_string = base64.b64encode(cert.cer).decode('utf-8')  # pylint: disable=no-member
1470	    cert_start_date = cert.attributes.not_before  # pylint: disable=no-member

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1469
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
1468	    cert = kv_client.get_certificate(vault_base_url, keyvault_cert_name, '')
1469	    cert_string = base64.b64encode(cert.cer).decode('utf-8')  # pylint: disable=no-member
1470	    cert_start_date = cert.attributes.not_before  # pylint: disable=no-member

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1496	    try:
1497	        cert = base64.b64decode(cert)
1498	        return OpenSSL.crypto.load_certificate(OpenSSL.crypto.FILETYPE_ASN1, cert)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_role-2.6.4-py2.py3-none-any/azure/cli/command_modules/role/custom.py:1497
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1496	    try:
1497	        cert = base64.b64decode(cert)
1498	        return OpenSSL.crypto.load_certificate(OpenSSL.crypto.FILETYPE_ASN1, cert)

--------------------------------------------------

Code scanned:
	Total lines of code: 2346
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 8.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 3.0
Files skipped (0):
