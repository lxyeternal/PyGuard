Run started:2025-04-12 14:07:24.001052

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/__init__.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
121	        with open(private_key_file, 'r') as file:
122	            private_key = file.read()
123	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/__init__.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
223	        with open(key_file, "wb") as file:
224	            file.write(self.private_pem())
225	            file.close()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/__init__.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
233	        with open(key_file, "wb") as file:
234	            file.write(self.public_pem())
235	            file.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/__init__.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
276	            raise VapidException(
277	                "Missing 'aud' from claims. "
278	                "'aud' is the scheme, host and optional port for this "
279	                "transaction e.g. https://example.com:8080")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/__main__.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	            print(
97	                """
98	The claims file should be a JSON formatted file that holds the
99	information that describes you. There are three elements in the claims

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/__main__.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
119	        try:
120	            claims = json.loads(open(claim_file).read())
121	            result.update(vapid.sign(claims))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/main.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	            print("No {} file found.".format(claim_file))
78	            print("""
79	The claims file should be a JSON formatted file that holds the

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/main.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
99	        try:
100	            claims = json.loads(open(claim_file).read())
101	            result.update(vapid.sign(claims))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
52	    with open('/tmp/private', 'w') as ff:
53	        ff.write(TEST_KEY_PRIVATE_PEM)
54	    with open('/tmp/public', 'w') as ff:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
54	    with open('/tmp/public', 'w') as ff:
55	        ff.write(TEST_KEY_PUBLIC_PEM)
56	    with open('/tmp/private.der', 'w') as ff:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	    with open('/tmp/private.der', 'w') as ff:
57	        ff.write(TEST_KEY_PRIVATE_DER)
58	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	        v = Vapid01.from_string(TEST_KEY_PRIVATE_DER)
134	        claims = {"aud": "https://example.com",
135	                  "sub": "mailto:admin@example.com"}
136	        result = v.sign(claims, "id=previous")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
159	        v = Vapid02.from_file("/tmp/private")
160	        claims = {"aud": "https://example.com",
161	                  "sub": "mailto:admin@example.com",
162	                  "foo": "extra value"}
163	        claim_check = copy.deepcopy(claims)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
170	        assert len(parts) == 2
171	        t_val = json.loads(base64.urlsafe_b64decode(
172	            self.repad(parts[0][2:].split('.')[1])
173	        ).decode('utf8'))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
182	        v = Vapid02.from_file("/tmp/private")
183	        claims = {"aud": "http://localhost:8000",
184	                  "sub": "mailto:admin@example.com",
185	                  "foo": "extra value"}
186	        result = v.sign(claims, "id=previous")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
230	                          {'sub': 'mailto:foo@bar.com',
231	                           'aud': "https://p.example.com:8080/"})
232	
233	    def test_ignore_sub(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
235	        v.conf['no-strict'] = True
236	        assert v.sign({"sub": "foo", "aud": "http://localhost:8000"})
237	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
263	            'mailto:admin-test-case@example-test-case.test.org',
264	            'https://localhost',
265	            'https://exmample-test-case.test.org',
266	            'https://8001::',
267	            'https://8001:1000:0001',
268	            'https://1.2.3.4'
269	        ]
270	        invalid = [
271	            'mailto:@foobar.com',
272	            'mailto:example.org',
273	            'mailto:0123:',
274	            'mailto:::1234',
275	            'https://somehost',
276	            'https://xyz:123',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
264	            'https://localhost',
265	            'https://exmample-test-case.test.org',
266	            'https://8001::',
267	            'https://8001:1000:0001',
268	            'https://1.2.3.4'
269	        ]
270	        invalid = [
271	            'mailto:@foobar.com',
272	            'mailto:example.org',
273	            'mailto:0123:',
274	            'mailto:::1234',
275	            'https://somehost',
276	            'https://xyz:123',
277	        ]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	            'https://exmample-test-case.test.org',
266	            'https://8001::',
267	            'https://8001:1000:0001',
268	            'https://1.2.3.4'
269	        ]
270	        invalid = [
271	            'mailto:@foobar.com',
272	            'mailto:example.org',
273	            'mailto:0123:',
274	            'mailto:::1234',
275	            'https://somehost',
276	            'https://xyz:123',
277	        ]
278	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
266	            'https://8001::',
267	            'https://8001:1000:0001',
268	            'https://1.2.3.4'
269	        ]
270	        invalid = [
271	            'mailto:@foobar.com',
272	            'mailto:example.org',
273	            'mailto:0123:',
274	            'mailto:::1234',
275	            'https://somehost',
276	            'https://xyz:123',
277	        ]
278	
279	        for val in valid:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	            'https://8001:1000:0001',
268	            'https://1.2.3.4'
269	        ]
270	        invalid = [
271	            'mailto:@foobar.com',
272	            'mailto:example.org',
273	            'mailto:0123:',
274	            'mailto:::1234',
275	            'https://somehost',
276	            'https://xyz:123',
277	        ]
278	
279	        for val in valid:
280	            assert _check_sub(val) is True

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
274	            'mailto:::1234',
275	            'https://somehost',
276	            'https://xyz:123',
277	        ]
278	
279	        for val in valid:
280	            assert _check_sub(val) is True
281	        for val in invalid:
282	            assert _check_sub(val) is False

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/tests/test_vapid.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
275	            'https://somehost',
276	            'https://xyz:123',
277	        ]
278	
279	        for val in valid:
280	            assert _check_sub(val) is True
281	        for val in invalid:
282	            assert _check_sub(val) is False

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/utils.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
13	    """
14	    return base64.urlsafe_b64decode(data + b"===="[len(data) % 4:])
15	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/py_vapid-1.9.2/py_vapid-1.9.2/py_vapid/utils.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
25	    """
26	    return base64.urlsafe_b64encode(data).replace(b'=', b'').decode('utf8')
27	

--------------------------------------------------

Code scanned:
	Total lines of code: 858
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 11.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 26.0
		High: 0.0
Files skipped (0):
