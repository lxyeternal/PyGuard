Run started:2025-04-12 17:49:45.628075

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/command/base.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
96	        """Prepare Molecule's provisioner and returns None."""
97	        self._config.write()
98	        if self._config.provisioner is not None:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/command/base.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
204	            LOG.info("Removing %s", scenario.ephemeral_directory)
205	            shutil.rmtree(scenario.ephemeral_directory)
206	            return

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/command/login.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
106	        # ruff: noqa: S605,S607
107	        lines, columns = os.popen("stty size", "r").read().split()
108	        login_options = self._config.driver.login_options(hostname)

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/command/login.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
106	        # ruff: noqa: S605,S607
107	        lines, columns = os.popen("stty size", "r").read().split()
108	        login_options = self._config.driver.login_options(hostname)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/config.py:502
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
501	            with open(base_config) as stream:  # noqa: PTH123
502	                s = stream.read()
503	                interpolated_config = self._interpolate(s, env, keep_string)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/config.py:511
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
510	            with open(self.molecule_file) as stream:  # noqa: PTH123
511	                s = stream.read()
512	                interpolated_config = self._interpolate(s, env, keep_string)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/provisioner/ansible.py:838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
837	            elif os.path.isdir(d):  # noqa: PTH112
838	                shutil.rmtree(d)
839	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/scenario.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
72	        LOG.info("Removing %s", directory)
73	        shutil.rmtree(directory)
74	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/text.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
129	    # Convert the hash to a base64-encoded string
130	    base64_hash = base64.urlsafe_b64encode(hash_object.digest()).decode("utf-8")
131	    # Truncate the result to the desired length

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/util.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	    with report_file.open("w") as f:
115	        f.write(console.export_html())
116	        f.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/util.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
233	    with filename.open("r+") as f:
234	        content = f.read()
235	        f.seek(0, 0)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/src/molecule/util.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
235	        f.seek(0, 0)
236	        f.write(molecule_prepender(content))
237	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/conftest.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
48	mac_on_gh = pytest.mark.skipif(
49	    platform.system() == "Darwin" and "CI" in os.environ,
50	    reason="Podman and docker not currently available for macOS on Github",

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/conftest.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
48	mac_on_gh = pytest.mark.skipif(
49	    platform.system() == "Darwin" and "CI" in os.environ,
50	    reason="Podman and docker not currently available for macOS on Github",

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/conftest.py:49
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
48	mac_on_gh = pytest.mark.skipif(
49	    platform.system() == "Darwin" and "CI" in os.environ,
50	    reason="Podman and docker not currently available for macOS on Github",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/conftest.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
183	    command = "git rev-parse --show-toplevel"
184	    return Path(os.popen(command, mode="r").read().strip())  # noqa: S605
185	

--------------------------------------------------
>> Issue: [B813:popen] os.popen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/conftest.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b813_popen.html
183	    command = "git rev-parse --show-toplevel"
184	    return Path(os.popen(command, mode="r").read().strip())  # noqa: S605
185	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/conftest.py:216
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
215	    if test_dir.exists():
216	        shutil.rmtree(test_dir, ignore_errors=True)
217	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/conftest.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
239	
240	    shutil.rmtree(test_dir, ignore_errors=True)
241	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/conftest.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
276	    if test_cache_dir.exists():
277	        shutil.rmtree(test_cache_dir)
278	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/integration/test_command.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
89	                else:
90	                    failure = "Docker is using podman's backend, so we will skip running docker tests as they are high likely to fail. See https://github.com/ansible-collections/community.docker/issues/660 https://github.com/containers/podman/issues/16548"
91	            elif result.stdout.rstrip() not in ("Not Found", '{"message":"page not found"}'):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/integration/test_command.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
99	            warnings.warn(
100	                f"Docker found but not using default socket from {default_docker_socket}, we will define DOCKER_HOST={docker_current_socket} during testing. See https://github.com/ansible-collections/community.docker/issues/660#issuecomment-2607286542",
101	                stacklevel=2,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/integration/test_command.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
459	    not has_pure_docker(),
460	    reason="Bug https://github.com/ansible-collections/community.docker/issues/660",
461	)

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/unit/driver/test_delegated.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
186	        "instance": "foo",
187	        "address": "172.16.0.2",
188	        "user": "cloud-user",
189	        "port": 22,
190	        "become_method": "su",
191	        "become_pass": "password",
192	        "identity_file": "/foo/bar",
193	    }
194	
195	    x = {

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/unit/driver/test_delegated.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
196	        "instance": "foo",
197	        "address": "172.16.0.2",
198	        "user": "cloud-user",
199	        "port": 22,
200	        "become_method": "su",
201	        "become_pass": "password",
202	        "identity_file": "/foo/bar",
203	    }
204	    assert x == _instance.login_options("foo")
205	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/unit/driver/test_delegated.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
230	        "instance": "foo",
231	        "address": "172.16.0.2",
232	        "user": "cloud-user",
233	        "port": 22,
234	        "become_method": "su",
235	        "become_pass": "password",
236	        "identity_file": "/foo/bar",
237	    }
238	
239	    ssh_expected_data = {

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/unit/driver/test_delegated.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
239	    ssh_expected_data = {
240	        "ansible_host": "172.16.0.2",
241	        "ansible_port": 22,
242	        "ansible_user": "cloud-user",
243	        "ansible_become_method": "su",
244	        "ansible_become_pass": "password",
245	        "ansible_private_key_file": "/foo/bar",
246	        "ansible_connection": "smart",
247	        "ansible_ssh_common_args": (
248	            "-o UserKnownHostsFile=/dev/null "
249	            "-o ControlMaster=auto "
250	            "-o ControlPersist=60s "

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/unit/driver/test_delegated.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
264	        "instance": "foo",
265	        "address": "172.16.0.2",
266	        "user": "cloud-user",
267	        "port": 5896,
268	        "connection": "winrm",
269	    }
270	
271	    winrm_expected_data = {

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/unit/driver/test_delegated.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
271	    winrm_expected_data = {
272	        "ansible_host": "172.16.0.2",
273	        "ansible_port": 5896,
274	        "ansible_user": "cloud-user",
275	        "ansible_connection": "winrm",
276	    }
277	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/unit/test_config.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
450	def test_write_config(config_instance: config.Config) -> None:  # noqa: D103
451	    config_instance.write()
452	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/unit/test_scenario.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
232	    inventory_dir = _instance.config.scenario.inventory_directory
233	    shutil.rmtree(ephemeral_dir)
234	    _instance._setup()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/molecule-25.4.0/molecule-25.4.0/tests/unit/test_util.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
221	    with dest_file.open() as stream:
222	        data = stream.read()
223	    x = f"# Molecule managed\n\n{contents}"

--------------------------------------------------

Code scanned:
	Total lines of code: 12130
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 22.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 1.0
Files skipped (0):
