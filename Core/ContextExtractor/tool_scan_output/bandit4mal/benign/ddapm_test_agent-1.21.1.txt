Run started:2025-04-13 00:27:52.508643

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
142	            else:
143	                raw_response_data = await resp.read()
144	                if len(raw_response_data) == 0:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
169	
170	    (client_response, body) = await _forward_request(data, headers, full_agent_url)
171	    return web.Response(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
252	        for req in reversed(self._requests):
253	            traces = await self._traces_from_request(req)
254	            for t in traces:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
335	            if req.match_info.handler == self.handle_v2_apmtelemetry:
336	                _events.append(await v2_apmtelemetry_decode_request(req, await req.read()))
337	        return _events

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
335	            if req.match_info.handler == self.handle_v2_apmtelemetry:
336	                _events.append(await v2_apmtelemetry_decode_request(req, await req.read()))
337	        return _events

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:350
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
349	        # See: https://github.com/DataDog/dd-apm-test-agent/pull/101 for more info
350	        request["_testagent_data"] = await request.read()
351	        self._requests.append(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:420
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
419	        for req in self._requests_by_session(token):
420	            traces = await self._traces_from_request(req)
421	            for trace in traces:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
438	            if req.match_info.handler == self.handle_v2_apmtelemetry:
439	                events.append(await v2_apmtelemetry_decode_request(req, await req.read()))
440	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
438	            if req.match_info.handler == self.handle_v2_apmtelemetry:
439	                events.append(await v2_apmtelemetry_decode_request(req, await req.read()))
440	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:454
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
453	            if req.match_info.handler == self.handle_v1_tracer_flare:
454	                events.append(await v1_tracerflare_decode(req, await req.read()))
455	        return events

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
476	                if "integration" not in req:
477	                    data = json.loads(await req.read())
478	                    integration_name = data.get("integration_name", None)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
567	        """Configure the response payload of /v0.7/config."""
568	        raw_data = await request.read()
569	        token = _session_token(request)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
577	        """
578	        raw_data = await request.read()
579	        content = json.loads(raw_data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:588
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
587	        """Configure the response payload of /v0.7/config"""
588	        raw_data = await request.read()
589	        token = _session_token(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:594
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
593	    async def handle_v2_apmtelemetry(self, request: Request) -> web.Response:
594	        await v2_apmtelemetry_decode_request(request, self._request_data(request))
595	        # TODO: Validation

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:622
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
621	        # we need to store the request manually since this is not a real DD agent endpoint
622	        await self._store_request(request)
623	        return web.HTTPOk()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:670
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
669	        """Allow to change test agent settings on the fly"""
670	        raw_data = await request.read()
671	        data = json.loads(raw_data)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
834	                with open(trace_snap_file, mode="r") as f:
835	                    raw_snapshot = json.load(f)
836	                trace_snapshot.snapshot(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:844
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
843	                with open(trace_snap_file, mode="w") as f:
844	                    f.write(trace_snapshot.generate_snapshot(received_traces=received_traces, removed=span_removes))
845	                log.info("wrote new trace snapshot to %r", os.path.abspath(trace_snap_file))

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:860
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
859	                with open(tracestats_snap_file, mode="r") as f:
860	                    raw_snapshot = json.load(f)
861	                tracestats_snapshot.snapshot(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
867	                with open(tracestats_snap_file, mode="w") as f:
868	                    f.write(tracestats_snapshot.generate(received_stats))
869	                log.info(

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
919	                    "headers": dict(req.headers),
920	                    "body": base64.b64encode(await req.read()).decode(),
921	                    "url": str(req.url),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:920
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
919	                    "headers": dict(req.headers),
920	                    "body": base64.b64encode(await req.read()).decode(),
921	                    "url": str(req.url),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:920
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
919	                    "headers": dict(req.headers),
920	                    "body": base64.b64encode(await req.read()).decode(),
921	                    "url": str(req.url),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:963
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
962	    async def handle_v1_profiling(self, request: Request) -> web.Response:
963	        await request.read()
964	        self._requests.append(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:1007
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1006	        if request.path in self._forward_endpoints:
1007	            await self._store_request(request)
1008	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:1053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1052	        if agent_url and proxy_to_agent:
1053	            agent_response = await _prepare_and_send_request(data, request, headers)
1054	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:1248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1247	        help=(
1248	            "Comma-separated values of checks to enable. None are enabled "
1249	            " by default. For the list of values see "
1250	            "https://github.com/datadog/dd-trace-test-agent"

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:1314
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
1313	            os.unlink(parsed_args.trace_uds_socket)
1314	        apm_sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
1315	        apm_sock.bind(parsed_args.trace_uds_socket)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:1317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
1316	        try:
1317	            os.chmod(parsed_args.trace_uds_socket, 0o722)
1318	        except OSError as e:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py:1317
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
1316	        try:
1317	            os.chmod(parsed_args.trace_uds_socket, 0o722)
1318	        except OSError as e:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	    def traces(self, clear: bool = False, **kwargs: Any) -> List[Trace]:
23	        resp = self._session.get(self._url("/test/session/traces"), **kwargs)
24	        if clear:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	    def requests(self, **kwargs: Any) -> List[Any]:
30	        resp = self._session.get(self._url("/test/session/requests"), **kwargs)
31	        json = resp.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	    def telemetry(self, clear: bool = False, **kwargs: Any) -> List[Any]:
45	        resp = self._session.get(self._url("/test/session/apmtelemetry"), **kwargs)
46	        if clear:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
50	    def clear(self, **kwargs: Any) -> None:
51	        self._session.get(self._url("/test/session/clear"), **kwargs)
52	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	    def info(self, **kwargs):
54	        resp = self._session.get(self._url("/info"), **kwargs)
55	        json = resp.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
13	        type=str,
14	        default=os.environ.get("TEST_SESSION_TOKEN"),
15	        help="Test session token to query with.",

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
23	        type=str,
24	        default=os.environ.get(
25	            "DD_TRACE_AGENT_URL",
26	            os.environ.get("DD_AGENT_URL", "http://localhost:8126"),
27	        ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
25	            "DD_TRACE_AGENT_URL",
26	            os.environ.get("DD_AGENT_URL", "http://localhost:8126"),
27	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	            "DD_TRACE_AGENT_URL",
26	            os.environ.get("DD_AGENT_URL", "http://localhost:8126"),
27	        ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	        ),
28	        help=("Test agent URL. Default is http://localhost:8126"),
29	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	    url = yarl.URL(parsed_args.agent_url).with_path("/test/session/start")
45	    resp = requests.get(str(url), params={"test_session_token": parsed_args.test_session_token})
46	    if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	    url = yarl.URL(parsed_args.agent_url).with_path("/test/session/snapshot")
69	    resp = requests.get(str(url), params={"test_session_token": parsed_args.test_session_token})
70	    if resp.status_code != 200:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/fmt.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
94	            with open(fname, "r") as fp:
95	                original = fp.read()
96	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/fmt.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
110	                    with open(fname, "w") as fp:
111	                        fp.write(formatted)
112	                    log.info("Snapshot file %r was formatted", fname)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
53	                str(
54	                    base64.b64encode(
55	                        bytes(
56	                            json.dumps(
57	                                {
58	                                    "signatures": [],
59	                                    "signed": {
60	                                        "_type": "root",
61	                                        "consistent_snapshot": True,
62	                                        "expires": "1986-12-11T00:00:00Z",
63	                                        "keys": {},
64	                                        "roles": {},
65	                                        "spec_version": "1.0",
66	                                        "version": 2,
67	                                    },
68	                                }
69	                            ),
70	                            encoding="utf-8",
71	                        )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py:54
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
53	                str(
54	                    base64.b64encode(
55	                        bytes(
56	                            json.dumps(
57	                                {
58	                                    "signatures": [],
59	                                    "signed": {
60	                                        "_type": "root",
61	                                        "consistent_snapshot": True,
62	                                        "expires": "1986-12-11T00:00:00Z",
63	                                        "keys": {},
64	                                        "roles": {},
65	                                        "spec_version": "1.0",
66	                                        "version": 2,
67	                                    },
68	                                }
69	                            ),
70	                            encoding="utf-8",
71	                        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
75	            ],
76	            "targets": str(base64.b64encode(bytes(json.dumps(data), encoding="utf-8")), encoding="utf-8"),
77	            "target_files": [

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py:76
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
75	            ],
76	            "targets": str(base64.b64encode(bytes(json.dumps(data), encoding="utf-8")), encoding="utf-8"),
77	            "target_files": [

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
79	                    "path": path,
80	                    "raw": str(base64.b64encode(msg_enc), encoding="utf-8"),
81	                }

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
79	                    "path": path,
80	                    "raw": str(base64.b64encode(msg_enc), encoding="utf-8"),
81	                }

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/tracerflare.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
23	                if part.name == "flare_file":
24	                    tracer_flare[part.name] = base64.b64encode(await part.read()).decode("ascii")
25	                else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/ddapm_test_agent/tracerflare.py:24
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
23	                if part.name == "flare_file":
24	                    tracer_flare[part.name] = base64.b64encode(await part.read()).decode("ascii")
25	                else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/setup.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    description="Test agent for Datadog APM client libraries",
14	    url="https://github.com/Datadog/dd-apm-test-agent",
15	    author="Kyle Verhoog",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/conftest.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	                        "component": "",
150	                        "http.url": "http://localhost:8080/users",
151	                        "http.method": "GET",
152	                        "http.status_code": "200",
153	                        "http.status_msg": "OK",
154	                        "language": "python",
155	                        "runtime-id": "2d377516ca12429aaf072f037ed2e4cc",
156	                    },
157	                    "metrics": {
158	                        "process_id": 111,
159	                        "sampling_priority_v1": 1.0,

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/conftest.py:543
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
542	def available_port() -> str:
543	    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
544	    s.bind(("", 0))  # Bind to a free port provided by the host.

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/conftest.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
545	    port = s.getsockname()[1]  # Get the port number assigned.
546	    s.close()  # Release the socket.
547	    return str(port)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/conftest.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
556	def testagent_url(testagent_port: str) -> str:
557	    return "http://localhost:%s" % testagent_port
558	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/conftest.py:587
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
586	                try:
587	                    r = await session.get(f"http://localhost:{testagent_port}")
588	                except (ClientConnectorError, ClientOSError):

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/test_container.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
94	
95	@pytest.mark.skipif(platform.system() == "Linux", reason="No socket mounting issues on Linux")
96	def test_container_uds(build_image, tmp_path_factory):

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/test_container.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
94	
95	@pytest.mark.skipif(platform.system() == "Linux", reason="No socket mounting issues on Linux")
96	def test_container_uds(build_image, tmp_path_factory):

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/test_container.py:95
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
94	
95	@pytest.mark.skipif(platform.system() == "Linux", reason="No socket mounting issues on Linux")
96	def test_container_uds(build_image, tmp_path_factory):

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
172	    assert content[0]["method"] == "POST"
173	    assert base64.b64decode(content[0]["body"]) == b""

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py:173
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
172	    assert content[0]["method"] == "POST"
173	    assert base64.b64decode(content[0]["body"]) == b""

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/test_session.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
125	    body = requests[0]["body"]
126	    traces = msgpack.unpackb(base64.b64decode(body))
127	    assert len(traces) == 1

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/test_session.py:126
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
125	    body = requests[0]["body"]
126	    traces = msgpack.unpackb(base64.b64decode(body))
127	    assert len(traces) == 1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ddapm_test_agent-1.21.1/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	def tracer(testagent_port: str, testagent: aiohttp.ClientSession) -> Tracer:
23	    tracer = Tracer(url=f"http://localhost:{testagent_port}")
24	    return tracer

--------------------------------------------------

Code scanned:
	Total lines of code: 6027
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 48.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 56.0
		High: 11.0
Files skipped (0):
