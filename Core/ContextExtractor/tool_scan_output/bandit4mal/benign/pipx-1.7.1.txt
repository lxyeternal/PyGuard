Run started:2025-04-12 10:45:24.929855

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/__init__.py:4
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
3	if sys.version_info < (3, 8, 0):
4	    sys.exit("Python 3.8 or later is required. See https://github.com/pypa/pipx for installation instructions.")

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/commands/common.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
137	        except IsADirectoryError:
138	            rmdir(symlink_path)
139	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/commands/interpreter.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
67	            continue
68	        rmdir(interpreter, safe_rm=True)
69	        removed.append(interpreter.name)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/commands/run.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	        raise PipxError(
145	            f"""
146	            '--pypackages' flag was passed, but '{pypackage_bin_path}' was
147	            not found. See https://github.com/cs01/pythonloc to learn how to

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/commands/run.py:308
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
307	        logger.info(f"Removing cached venv {venv_dir!s}")
308	        rmdir(venv_dir)
309	    _remove_all_expired_venvs()

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/commands/run.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
315	            logger.info(f"Removing expired venv {venv_dir!s}")
316	            rmdir(venv_dir)
317	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/commands/run.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
320	    try:
321	        res = urllib.request.urlopen(url)
322	        charset = res.headers.get_content_charset() or "utf-8"

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/commands/uninstall.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
151	
152	    rmdir(venv_dir)
153	    print(f"uninstalled {venv.name}! {stars}")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/constants.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
28	def is_windows() -> bool:
29	    return platform.system() == "Windows"
30	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/constants.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
28	def is_windows() -> bool:
29	    return platform.system() == "Windows"
30	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/constants.py:29
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
28	def is_windows() -> bool:
29	    return platform.system() == "Windows"
30	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/constants.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
32	def is_macos() -> bool:
33	    return platform.system() == "Darwin"
34	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/constants.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
32	def is_macos() -> bool:
33	    return platform.system() == "Darwin"
34	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/constants.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
32	def is_macos() -> bool:
33	    return platform.system() == "Darwin"
34	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/constants.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
36	def is_linux() -> bool:
37	    return platform.system() == "Linux"
38	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/constants.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
36	def is_linux() -> bool:
37	    return platform.system() == "Linux"
38	

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/constants.py:37
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
36	def is_linux() -> bool:
37	    return platform.system() == "Linux"
38	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/interpreter.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	        if source == "the python-build-standalone project":
49	            message += "listed in https://github.com/indygreg/python-build-standalone/releases/latest."
50	        super().__init__(message, wrap_message)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/main.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	SPEC_HELP = textwrap.dedent(
65	    """\
66	    The package name or specific installation source passed to pip.
67	    Runs `pip install -U SPEC`.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/main.py:816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
815	        description=textwrap.dedent(
816	            f"""
817	            Download the latest version of a package to a temporary virtual environment,
818	            then run an app from it. The environment will be cached
819	            and re-used for up to {constants.TEMP_VENV_EXPIRATION_THRESHOLD_DAYS} days. This
820	            means subsequent calls to 'run' for the same package will be faster

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/main.py:1127
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1126	            signature = (
1127	                "Signature: 8a477f597d28d172789f06886806bc55\n"
1128	                "# This file is a cache directory tag created by pipx.\n"
1129	                "# For information about cache directory tags, see:\n"
1130	                "#       https://bford.info/cachedir/\n"
1131	            )
1132	            with open(cachedir_tag, "w") as file:
1133	                file.write(signature)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/main.py:1133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1132	            with open(cachedir_tag, "w") as file:
1133	                file.write(signature)
1134	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/main.py:1135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
1134	
1135	    rmdir(paths.ctx.trash, False)
1136	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/main.py:1141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1140	            pipx_wrap(
1141	                f"""
1142	                {hazard}  A virtual environment for pipx was detected at
1143	                {old_pipx_venv_location!s}. The 'pipx-app' package has been
1144	                renamed back to 'pipx'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	
46	GITHUB_API_URL = "https://api.github.com/repos/indygreg/python-build-standalone/releases/latest"
47	PYTHON_VERSION_REGEX = re.compile(r"cpython-(\d+\.\d+\.\d+)")

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
64	        if install_dir.exists():
65	            shutil.rmtree(install_dir)
66	    else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
71	            logger.warning(f"A previous attempt to install python {python_version} failed. Retrying.")
72	            shutil.rmtree(install_dir)
73	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
99	            # ballooning memory usage, we read the file in chunks
100	            with urlopen(download_link) as response, open(archive, "wb") as file_handle:
101	                for data in iter(partial(response.read, 32768), b""):

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
99	            # ballooning memory usage, we read the file in chunks
100	            with urlopen(download_link) as response, open(archive, "wb") as file_handle:
101	                for data in iter(partial(response.read, 32768), b""):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
99	            # ballooning memory usage, we read the file in chunks
100	            with urlopen(download_link) as response, open(archive, "wb") as file_handle:
101	                for data in iter(partial(response.read, 32768), b""):

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
101	                for data in iter(partial(response.read, 32768), b""):
102	                    file_handle.write(data)
103	        except urllib.error.URLError as e:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
109	        # Calculate checksum
110	        with open(archive, "rb") as python_zip:
111	            checksum = hashlib.sha256(python_zip.read()).hexdigest()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
114	        checksum_link = download_link + ".sha256"
115	        expected_checksum = urlopen(checksum_link).read().decode().rstrip("\n")
116	        if checksum != expected_checksum:

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
114	        checksum_link = download_link + ".sha256"
115	        expected_checksum = urlopen(checksum_link).read().decode().rstrip("\n")
116	        if checksum != expected_checksum:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
120	
121	        with tarfile.open(archive, mode="r:gz") as tar:
122	            tar.extractall(download_dir)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
147	    try:
148	        with urlopen(GITHUB_API_URL) as response:
149	            release_data = json.load(response)

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
147	    try:
148	        with urlopen(GITHUB_API_URL) as response:
149	            release_data = json.load(response)

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
159	    """Returns available python versions for your machine and their download links."""
160	    system, machine = platform.system(), platform.machine()
161	    download_link_suffixes = MACHINE_SUFFIX[system][machine]

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/standalone_python.py:160
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
159	    """Returns available python versions for your machine and their download links."""
160	    system, machine = platform.system(), platform.machine()
161	    download_link_suffixes = MACHINE_SUFFIX[system][machine]

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/util.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
60	    # So, if safe_rm is True, we ignore any errors and move the file to the trash with below code
61	    shutil.rmtree(path, ignore_errors=safe_rm)
62	

--------------------------------------------------
>> Issue: [B837:rmdir] pathlib.Path.rmdir
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/venv.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b837_rmdir.html
196	        if self.safe_to_remove():
197	            rmdir(self.root)
198	        else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/venv.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
228	            self.pipx_metadata.injected_packages.pop(package)
229	            self.pipx_metadata.write()
230	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pipx-1.7.1/pipx-1.7.1/src/pipx/venv.py:389
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
388	
389	        self.pipx_metadata.write()
390	

--------------------------------------------------

Code scanned:
	Total lines of code: 5378
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 31.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 39.0
		High: 4.0
Files skipped (0):
