Run started:2025-04-12 15:39:56.523976

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/_funcs.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
47	            num = int(val[:-1])
48	            unit = units.get(val[-1].lower(), None)
49	            if unit and num > 0:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/_funcs.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	    """
85	    mode = FILE_EXISTS_MODE.get(mode, mode)
86	    if mode not in FILE_EXISTS_MODE:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/_funcs.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
101	    # 在headers中获取编码
102	    content_type = response.headers.get('content-type', '').lower()
103	    if not content_type.endswith(';'):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/_funcs.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	    # ------------获取文件大小------------
137	    file_size = response.headers.get('Content-Length', None)
138	    file_size = None if file_size is None else int(file_size)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/_funcs.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
213	    charset = ''
214	    content_disposition = response.headers.get('content-disposition', '').replace(' ', '')
215	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/downloadKit.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
194	        """
195	        thread_id = self._get_usable_thread()
196	        if thread_id is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/downloadKit.py:197
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
196	        if thread_id is not None:
197	            thread = Thread(target=self._run, args=(thread_id, mission), daemon=False)
198	            self._threads[thread_id] = {'thread': thread, 'mission': None}

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/downloadKit.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
212	                    try:
213	                        mission = self._waiting_list.get(True, .5)
214	                    except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/downloadKit.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
267	        if asyn:
268	            Thread(target=self._show, args=(2, keep)).start()
269	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/downloadKit.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
280	        if keep:
281	            Thread(target=self._stop_show).start()
282	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/downloadKit.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
326	                if method == 'get':
327	                    r = session.get(url, **kwargs)
328	                elif method == 'post':

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/downloadKit.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
328	                elif method == 'post':
329	                    r = session.post(url, **kwargs)
330	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/downloadKit.py:465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
464	        first = False
465	        if split and file_size and file_size > self.block_size and r.headers.get('Accept-Ranges') == 'bytes':
466	            first = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/mission.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	        self._overwrote = False
109	        self.method = 'post' if (self._data.kwargs.get('data', None) is not None or
110	                                 self._data.kwargs.get('json', None) is not None) else 'get'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/DownloadKit/mission.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	        self.method = 'post' if (self._data.kwargs.get('data', None) is not None or
110	                                 self._data.kwargs.get('json', None) is not None) else 'get'
111	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/downloadkit-2.0.7/DownloadKit-2.0.7/setup.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    keywords="DownloadKit",
18	    url="https://gitee.com/g1879/DownloadKit",
19	    include_package_data=True,

--------------------------------------------------

Code scanned:
	Total lines of code: 1203
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 0.0
Files skipped (0):
