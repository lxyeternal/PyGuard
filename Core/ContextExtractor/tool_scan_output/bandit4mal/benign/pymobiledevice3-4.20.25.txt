Run started:2025-04-12 13:37:12.279219

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/__main__.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	
43	INVALID_SERVICE_MESSAGE = """Failed to start service. Possible reasons are:
44	- If you were trying to access a developer service (developer subcommand):
45	    - If your device iOS version >= 15.0:
46	        - Make sure you first enabled "Developer Mode" via:
47	          > python3 -m pymobiledevice3 amfi enable-developer-mode
48	
49	    - Make sure the DeveloperDiskImage/PersonalizedImage is mounted via:
50	      > python3 -m pymobiledevice3 mounter auto-mount
51	
52	    - If your device iOS version >= 17.0:
53	        - Make sure you passed the --rsd option to the subcommand
54	          https://github.com/doronz88/pymobiledevice3#working-with-developer-tools-ios--170
55	
56	- Apple removed this service
57	
58	- A bug. Please file a bug report:
59	  https://github.com/doronz88/pymobiledevice3/issues/new?assignees=&labels=&projects=&template=bug_report.md&title=
60	"""
61	
62	CONTEXT_SETTINGS = dict(help_option_names=['-h', '--help'], max_content_width=400)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/__main__.py:254
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
253	        logger.error(
254	            f'Unsupported OS - {e.os_name}. To add support, consider contributing at '
255	            f'https://github.com/doronz88/pymobiledevice3.')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/__main__.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
261	        logger.error(
262	            f'Missing implementation of `{e.feature}` on `{e.os_name}`. To add support, consider contributing at '
263	            f'https://github.com/doronz88/pymobiledevice3.')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/bonjour.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
92	                answers.append(answer)
93	        await bonjour_query.listener.close()
94	        await bonjour_query.service_browser.async_cancel()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/bonjour.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
94	        await bonjour_query.service_browser.async_cancel()
95	        await bonjour_query.zc.async_close()
96	    return answers

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/bonjour.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
109	        for ip in adapter.ips:
110	            if ip.ip == '127.0.0.1':
111	                continue

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/cli/developer.py:156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
155	    with DvtSecureSocketProxyService(lockdown=service_provider) as dvt:
156	        ProcessControl(dvt).signal(pid, sig)
157	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/cli/developer.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
295	    with DvtSecureSocketProxyService(lockdown=service_provider) as dvt:
296	        out.write(Screenshot(dvt).get_screenshot())
297	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/cli/developer.py:940
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
939	    """ Take a screenshot in PNG format """
940	    out.write(ScreenshotService(lockdown=service_provider).take_screenshot())
941	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/cli/developer.py:972
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
971	    if local_port is not None:
972	        print(DEBUGSERVER_CONNECTION_STEPS.format(host='127.0.0.1', port=local_port))
973	        print('Started port forwarding. Press Ctrl-C to close this shell when done')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/cli/developer.py:1100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1099	        if output is not None:
1100	            output.write(buf)
1101	        else:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/cli/restore.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	logger = logging.getLogger(__name__)
35	IPSWME_API = 'https://api.ipsw.me/v4/device/'
36	
37	
38	class Command(click.Command):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/cli/restore.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
112	def query_ipswme(identifier: str) -> str:
113	    resp = requests.get(IPSWME_API + identifier, headers={'Accept': 'application/json'})
114	    firmwares = resp.json()['firmwares']

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/cli/webinspector.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
158	
159	SHELL_USAGE = '''
160	# This shell allows you to control the web with selenium like API.
161	# The first thing you should do is creating a session:
162	driver.start_session()
163	
164	# Then, you can navigate by using the get method:
165	driver.get("https://google.com")
166	
167	# You can search for a specific element using the `By` enum:
168	driver.find_element(By.TAG_NAME, 'input')
169	
170	# You can also add cookies:
171	driver.add_cookie(
172	    Cookie(name='tz', value='UTC', domain='.github.com', path='/', expires=0, httpOnly=False, secure=True,
173	    session=True, sameSite='None')
174	)
175	
176	# See selenium api for more features.
177	'''
178	
179	
180	@webinspector.command(cls=Command)
181	@click.option('-t', '--timeout', default=3, show_default=True, type=float)
182	@catch_errors
183	def shell(service_provider: LockdownClient, timeout):

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/cli/webinspector.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
247	@webinspector.command(cls=Command)
248	@click.option('--host', default='127.0.0.1')
249	@click.option('--port', type=click.INT, default=9222)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/lockdown.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
386	        with open(keybag_file, 'rb') as keybag_file:
387	            keybag_file = keybag_file.read()
388	        private_key = serialization.load_pem_private_key(keybag_file, password=None)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/lockdown.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
386	        with open(keybag_file, 'rb') as keybag_file:
387	            keybag_file = keybag_file.read()
388	        private_key = serialization.load_pem_private_key(keybag_file, password=None)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/lockdown.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
532	        with tempfile.NamedTemporaryFile('w+b', delete=False) as f:
533	            f.write(cert_pem + b'\n' + private_key_pem)
534	            filename = f.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/lockdown.py:533
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
532	        with tempfile.NamedTemporaryFile('w+b', delete=False) as f:
533	            f.write(cert_pem + b'\n' + private_key_pem)
534	            filename = f.name

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/module_imports.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	
14	GENERAL_IMPORT_ERROR = """Failed to import `start_tunnel`.
15	Please file an issue at:
16	https://github.com/doronz88/pymobiledevice3/issues/new?assignees=&labels=&projects=&template=bug_report.md&title=
17	
18	Also, please supply with a traceback of the following python line:
19	
20	from pymobiledevice3.remote.tunnel_service import start_tunnel
21	"""
22	
23	
24	def verify_tunnel_imports() -> bool:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/remote_service_discovery.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
85	                pairing_record = get_local_pairing_record(get_remote_pairing_record_filename(self.udid), get_home_folder())
86	                checkin['EscrowBag'] = base64.b64decode(pairing_record['remote_unlock_host_key'])
87	            response = service.send_recv_plist(checkin)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/remote_service_discovery.py:86
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
85	                pairing_record = get_local_pairing_record(get_remote_pairing_record_filename(self.udid), get_home_folder())
86	                checkin['EscrowBag'] = base64.b64decode(pairing_record['remote_unlock_host_key'])
87	            response = service.send_recv_plist(checkin)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/remotexpc.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
75	            data, message_id=self.next_message_id[ROOT_CHANNEL], wanting_reply=wanting_reply)
76	        self._writer.write(DataFrame(stream_id=ROOT_CHANNEL, data=xpc_wrapper).serialize())
77	        await self._writer.drain()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/remotexpc.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
137	    async def _do_handshake(self) -> None:
138	        self._writer.write(HTTP2_MAGIC)
139	        await self._writer.drain()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/remotexpc.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
167	    async def _send_frame(self, frame: Frame) -> None:
168	        self._writer.write(frame.serialize())
169	        await self._writer.drain()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
164	                    while True:
165	                        packet = await f.read(read_size)
166	                        assert packet.startswith(LOOPBACK_HEADER)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
164	                    while True:
165	                        packet = await f.read(read_size)
166	                        assert packet.startswith(LOOPBACK_HEADER)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
191	        if self.tun is not None:
192	            self.tun.close()
193	        self.tun = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
246	        if isinstance(event, ConnectionTerminated):
247	            self.close()
248	        elif isinstance(event, StreamDataReceived):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:251
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
250	        elif isinstance(event, DatagramFrameReceived):
251	            self.tun.write(LOOPBACK_HEADER + event.data)
252	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
267	    async def send_packet_to_device(self, packet: bytes) -> None:
268	        self._writer.write(packet)
269	        await self._writer.drain()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
278	                    ipv6_body = await self._reader.readexactly(ipv6_length)
279	                    self.tun.write(LOOPBACK_HEADER + ipv6_header + ipv6_body)
280	                except asyncio.exceptions.IncompleteReadError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
292	    async def request_tunnel_establish(self) -> dict:
293	        self._writer.write(self._encode_cdtunnel_packet(
294	            {'type': 'clientHandshakeRequest', 'mtu': self.REQUESTED_MTU}))
295	        await self._writer.drain()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
295	        await self._writer.drain()
296	        return json.loads(CDTunnelPacket.parse(await self._reader.read(self.REQUESTED_MTU)).body)
297	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
295	        await self._writer.drain()
296	        return json.loads(CDTunnelPacket.parse(await self._reader.read(self.REQUESTED_MTU)).body)
297	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
306	        if not self._writer.is_closing():
307	            self._writer.close()
308	            try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
379	            await self._pair()
380	            await self.close()
381	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:387
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
386	        request = {'request': {'_0': {'createListener': {
387	            'key': base64.b64encode(
388	                private_key.public_key().public_bytes(Encoding.DER, PublicFormat.SubjectPublicKeyInfo)
389	            ).decode(),

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:387
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
386	        request = {'request': {'_0': {'createListener': {
387	            'key': base64.b64encode(
388	                private_key.public_key().public_bytes(Encoding.DER, PublicFormat.SubjectPublicKeyInfo)
389	            ).decode(),

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
397	        request = {'request': {'_0': {'createListener': {
398	            'key': base64.b64encode(self.encryption_key).decode(),
399	            'peerConnectionsInfo': [{'owningPID': os.getpid(), 'owningProcessName': 'CoreDeviceService'}],

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:398
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
397	        request = {'request': {'_0': {'createListener': {
398	            'key': base64.b64encode(self.encryption_key).decode(),
399	            'peerConnectionsInfo': [{'owningPID': os.getpid(), 'owningProcessName': 'CoreDeviceService'}],

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
428	        try:
429	            async with aioquic_connect(
430	                    host,
431	                    port,
432	                    configuration=configuration,
433	                    create_protocol=RemotePairingQuicTunnel,
434	            ) as client:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
823	    async def __aexit__(self, exc_type, exc_val, exc_tb) -> None:
824	        await self.close()
825	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:837
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
836	        # Establish RemoteXPC connection to `SERVICE_NAME`
837	        await RemoteService.connect(self)
838	        try:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:843
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
842	            # Perform pairing if necessary and start a trusted RemoteXPC connection
843	            await RemotePairingProtocol.connect(self, autopair=autopair)
844	            self.hostname = self.service.address[0]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:846
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
845	        except Exception:  # noqa: E722
846	            await self.service.close()
847	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:850
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
849	    async def close(self) -> None:
850	        await self.rsd.close()
851	        await self.service.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:851
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
850	        await self.rsd.close()
851	        await self.service.close()
852	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:885
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
884	        except:  # noqa: E722
885	            await self.close()
886	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:891
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
890	            return
891	        self._writer.close()
892	        try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:905
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
904	    async def send_request(self, data: dict) -> None:
905	        self._writer.write(
906	            RPPairingPacket.build({'body': json.dumps(data, default=self._default_json_encoder).encode()}))
907	        await self._writer.drain()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:912
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
911	        if isinstance(obj, bytes):
912	            return base64.b64encode(obj).decode()
913	        raise TypeError()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:912
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
911	        if isinstance(obj, bytes):
912	            return base64.b64encode(obj).decode()
913	        raise TypeError()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
916	    def _decode_bytes_if_needed(data: bytes) -> bytes:
917	        return base64.b64decode(data)
918	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:917
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
916	    def _decode_bytes_if_needed(data: bytes) -> bytes:
917	        return base64.b64decode(data)
918	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:928
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
927	        self._reader, self._writer = await asyncio.wait_for(fut, timeout=TIMEOUT)
928	        await RemotePairingProtocol.connect(self, autopair=autopair)
929	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:958
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
957	        if self._service is not None:
958	            await self._service.aio_close()
959	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:965
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
964	    try:
965	        await service.connect(autopair=autopair)
966	    except RemotePairingCompletedError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:968
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
967	        # The connection must be reestablished upon pairing is completed
968	        await service.close()
969	        service = CoreDeviceTunnelService(rsd)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:970
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
969	        service = CoreDeviceTunnelService(rsd)
970	        await service.connect(autopair=autopair)
971	    except Exception:  # noqa: E722

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:972
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
971	    except Exception:  # noqa: E722
972	        await service.close()
973	        raise

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:980
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
979	    service = RemotePairingTunnelService(remote_identifier, hostname, port)
980	    await service.connect(autopair=autopair)
981	    return service

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:987
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
986	    service = RemotePairingManualPairingService(remote_identifier, hostname, port)
987	    await service.connect(autopair=autopair)
988	    return service

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:1056
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1055	            logger.debug(f'Skipping {rsd.udid}:, iOS {rsd.product_version} < 17.0')
1056	            await rsd.close()
1057	            continue

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:1062
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1061	            logger.error(f'Failed to start service: {rsd}: {e}')
1062	            await rsd.close()
1063	            raise

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:1083
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1082	                    if conn is not None:
1083	                        await conn.close()
1084	                except OSError:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/tunnel_service.py:1086
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1085	                    if conn is not None:
1086	                        await conn.close()
1087	                    continue

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/utils.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
47	def stop_remoted_if_required() -> None:
48	    if platform.system() != 'Darwin':
49	        # only Darwin systems require it

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/utils.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
47	def stop_remoted_if_required() -> None:
48	    if platform.system() != 'Darwin':
49	        # only Darwin systems require it

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/utils.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
65	def resume_remoted_if_required() -> None:
66	    if platform.system() != 'Darwin':
67	        # only Darwin systems require it

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/remote/utils.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
65	def resume_remoted_if_required() -> None:
66	    if platform.system() != 'Darwin':
67	        # only Darwin systems require it

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/resources/dsc_uuid_map.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
47	
48	    dsc = dsc.read()
49	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/resources/firmware_notifications.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12	    with open(NOTIFICATIONS_FILENAME, 'rb') as f:
13	        return f.read().decode().split('\n')
14	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/resources/firmware_notifications.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
18	        notifications.sort()
19	        f.write('\n'.join(notifications).encode())
20	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/asr.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
68	
69	        oob_data = filesystem.read(oob_length)
70	        assert len(oob_data) == oob_length

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/asr.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	        for _ in trange(0, length, ASR_PAYLOAD_CHUNK_SIZE, dynamic_ncols=True):
117	            chunk = filesystem.read(ASR_PAYLOAD_CHUNK_SIZE)
118	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
71	
72	        self.service.sendall(CTRLCMD)
73	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
86	    def sync_handshake(self):
87	        self.service.sendall(HELLOCMD)
88	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
109	    def handle_proxy_cmd(self):
110	        buf = self.service.recv(1048576)
111	        logger.debug(f'got proxy command with {len(buf)} bytes')

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
114	        # anything else, and we will eventually abort on failure anyway
115	        self.service.sendall(struct.pack('<H', 5))
116	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
121	        # ack command data too
122	        self.service.sendall(buf)
123	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:140
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
139	
140	        sockfd = socket.socket()
141	        sockfd.connect((host, port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
140	        sockfd = socket.socket()
141	        sockfd.connect((host, port))
142	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
149	                if current_sock == self.service.socket:
150	                    buf = self.service.recv(CHUNK_SIZE)
151	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
154	
155	                    sockfd.sendall(buf)
156	                else:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
156	                else:
157	                    buf = sockfd.recv(CHUNK_SIZE)
158	                    logger.debug(f'Received {len(buf)} bytes')

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
158	                    logger.debug(f'Received {len(buf)} bytes')
159	                    self.service.sendall(buf)
160	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
167	
168	        sockfd.close()
169	        self.service.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/fdr.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
168	        sockfd.close()
169	        self.service.close()
170	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
150	
151	        asr_port = message.get('DataPort', DEFAULT_ASR_SYNC_PORT)
152	        self.logger.info(f'connecting to ASR on port {asr_port}')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
178	    def get_build_identity_from_request(self, msg):
179	        return self.get_build_identity(msg['Arguments'].get('IsRecoveryOS', False))
180	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
182	        self.logger.info('About to send BuildIdentity Dict...')
183	        service = await self._get_service_for_data_request(message)
184	        req = {'BuildIdentityDict': dict(self.get_build_identity_from_request(message))}

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
183	        service = await self._get_service_for_data_request(message)
184	        req = {'BuildIdentityDict': dict(self.get_build_identity_from_request(message))}
185	        arguments = message['Arguments']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
185	        arguments = message['Arguments']
186	        variant = arguments.get('Variant', 'Erase')
187	        req['Variant'] = variant

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	    async def extract_global_manifest(self) -> dict:
192	        build_info = self.build_identity.get('Info')
193	        if build_info is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
195	
196	        device_class = build_info.get('DeviceClass')
197	        if device_class is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:200
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
199	
200	        macos_variant = build_info.get('MacOSVariant')
201	        if macos_variant is None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
208	        self.logger.debug('send_personalized_boot_object_v3')
209	        service = await self._get_service_for_data_request(message)
210	        image_name = message['Arguments']['ImageName']

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
234	        self.logger.debug('send_source_boot_object_v4')
235	        service = await self._get_service_for_data_request(message)
236	        image_name = message['Arguments']['ImageName']

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
246	        else:
247	            data = (self.get_build_identity_from_request(message)
248	                    .get_component(component_name, tss=self.recovery.tss).data)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
320	        component = 'Ap,LocalPolicy'
321	        service = await self._get_service_for_data_request(message)
322	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:334
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
333	        self.logger.info('About to send RecoveryOSRootTicket...')
334	        service = await self._get_service_for_data_request(message)
335	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
354	        self.logger.info('About to send RootTicket...')
355	        service = await self._get_service_for_data_request(message)
356	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:365
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
364	        self.logger.info('About to send NORData...')
365	        service = await self._get_service_for_data_request(message)
366	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:371
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
370	
371	        arguments = message.get('Arguments')
372	        if arguments:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
372	        if arguments:
373	            flash_version_1 = arguments.get('FlashVersion1', False)
374	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:466
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
465	        }
466	        return bbfw_fn_elem.get(elem)
467	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:480
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
479	        bbticket = bbtss.bb_ticket
480	        bbfw_dict = bbtss.get('BasebandFirmware')
481	        is_fls = False

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
484	        with tempfile.NamedTemporaryFile(delete=False) as tmp_zip_read:
485	            tmp_zip_read.write(bbfw_orig)
486	            tmp_zip_read_name = tmp_zip_read.name

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
484	        with tempfile.NamedTemporaryFile(delete=False) as tmp_zip_read:
485	            tmp_zip_read.write(bbfw_orig)
486	            tmp_zip_read_name = tmp_zip_read.name

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
504	
505	                            buffer = bbfw_orig.read(signfn)
506	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
535	                        if keep and (filename not in signed_file):
536	                            bbfw_patched.writestr(bbfw_orig.getinfo(filename), bbfw_orig.read(filename))
537	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
540	                            # add BBTicket to file ebl.fls
541	                            buffer = bbfw_orig.read('ebl.fls')
542	                            fls = self.fls_parse(buffer)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:555
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
554	                    tmp_zip_write.seek(0)
555	                    return tmp_zip_write.read()
556	        finally:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:562
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
561	        self.logger.info(f'About to send BasebandData: {message}')
562	        service = await self._get_service_for_data_request(message)
563	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:568
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
567	        arguments = message['Arguments']
568	        bb_chip_id = arguments.get('ChipID')
569	        bb_cert_id = arguments.get('CertID')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
568	        bb_chip_id = arguments.get('ChipID')
569	        bb_cert_id = arguments.get('CertID')
570	        bb_snum = arguments.get('ChipSerialNo')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
569	        bb_cert_id = arguments.get('CertID')
570	        bb_snum = arguments.get('ChipSerialNo')
571	        bb_nonce = arguments.get('Nonce')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:571
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
570	        bb_snum = arguments.get('ChipSerialNo')
571	        bb_nonce = arguments.get('Nonce')
572	        bbtss = self.bbtss

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:592
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
591	
592	            fdr_support = self.build_identity['Info'].get('FDRSupport', False)
593	            if fdr_support:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
606	        # extract baseband firmware to temp file
607	        bbfw = self.ipsw.read(bbfwpath)
608	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
615	        self.logger.info('About to send FDR Trust data...')
616	        service = await self._get_service_for_data_request(message)
617	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
628	        arguments = message['Arguments']
629	        want_image_list = arguments.get(image_list_k)
630	        image_name = arguments.get('ImageName')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:630
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
629	        want_image_list = arguments.get(image_list_k)
630	        image_name = arguments.get('ImageName')
631	        build_id_manifest = self.build_identity['Manifest']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:656
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
655	
656	            is_image_type = manifest_entry['Info'].get(image_type_k)
657	            if is_image_type:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
686	        self.logger.debug(f'send_bootability_bundle_data: {message}')
687	        service = await self._get_service_for_data_request(message)
688	        await service.aio_sendall(self.ipsw.bootability)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:696
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
695	    async def get_se_firmware_data(self, updater_name: str, info: dict, arguments: dict) -> dict:
696	        chip_id = info.get('SE,ChipID')
697	        if chip_id is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:848
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
847	
848	            rose_ticket = response.get('Rap,Ticket')
849	            if rose_ticket is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:894
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
893	
894	            ticket = response.get('BMU,Ticket')
895	            if ticket is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:927
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
926	
927	        ticket = response.get('Baobab,Ticket')
928	        if ticket is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:967
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
966	
967	        ticket = response.get(response_ticket)
968	        if ticket is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1018
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1017	
1018	        ticket = response.get(ticket_name)
1019	        if ticket is None:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1050
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1049	        self.logger.debug(f'got FirmwareUpdaterData request: {message}')
1050	        service = await self._get_service_for_data_request(message)
1051	        arguments = message['Arguments']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1054
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1053	        updater_name = arguments['MessageArgUpdaterName']
1054	        device_generated_request = arguments.get('DeviceGeneratedRequest')
1055	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1073
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1072	            fwtype = 'Savage'
1073	            info2 = info.get('YonkersDeviceInfo')
1074	            if info2:

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1109	        self.logger.warning(f'send_firmware_updater_preflight: {message}')
1110	        service = await self._get_service_for_data_request(message)
1111	        await service.aio_send_plist({})

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1114	        self.logger.info(f'send_url_asset: {message}')
1115	        service = await self._get_service_for_data_request(message)
1116	        arguments = message['Arguments']

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1125
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1124	            loop = asyncio.get_event_loop()
1125	            with ThreadPoolExecutor() as executor:
1126	                response = await loop.run_in_executor(executor, requests.get, url)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1137	        self.logger.info(f'send_streamed_image_decryption_key: {message}')
1138	        service = await self._get_service_for_data_request(message)
1139	        arguments = message['Arguments']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1141	
1142	        response = requests.post(
1143	            arguments['RequestURL'],
1144	            headers=arguments['RequestAdditionalHeaders'],
1145	            data=arguments['RequestBody'])
1146	        self.logger.info(f'response {response} {response.content}')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1165	        # checks and see what kind of data restored is requests and pass the request to its own handler
1166	        data_type = message.get('DataType')
1167	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1223	        status = message['Status']
1224	        log = message.get('Log')
1225	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1273	                    break
1274	                f.write(buf)
1275	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
1273	                    break
1274	                f.write(buf)
1275	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1316	            self.logger.info('Starting FDR listener thread')
1317	            start_fdr_thread(fdr_type.FDR_CTRL)
1318	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1319
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1318	
1319	        sep = self.build_identity['Manifest']['SEP'].get('Info')
1320	        spp = self.build_identity['Info'].get('SystemPartitionPadding')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1320
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1319	        sep = self.build_identity['Manifest']['SEP'].get('Info')
1320	        spp = self.build_identity['Info'].get('SystemPartitionPadding')
1321	        opts = RestoreOptions(preflight_info=self._preflight_info, sep=sep, macos_variant=self.macos_variant,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1336	            # discover what kind of message has been received
1337	            message_type = message.get('MsgType')
1338	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/restore.py:1356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1355	    async def _get_service_for_data_request(self, message: dict) -> ServiceConnection:
1356	        data_port = message.get('DataPort')
1357	        if data_port is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	
15	TSS_CONTROLLER_ACTION_URL = 'http://gs.apple.com/TSS/controller?action=2'
16	
17	TSS_CLIENT_VERSION_STRING = 'libauthinstall-1033.80.3'

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	def get_with_or_without_comma(obj: dict, k: str, default=None):
23	    val = obj.get(k, obj.get(k.replace(',', '')))
24	    if val is None and default is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
22	def get_with_or_without_comma(obj: dict, k: str, default=None):
23	    val = obj.get(k, obj.get(k.replace(',', '')))
24	    if val is None and default is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	def is_fw_payload(info: dict[str, typing.Any]) -> bool:
30	    return (info.get('IsFirmwarePayload') or info.get('IsSecondaryFirmwarePayload') or info.get('IsFUDFirmware') or
31	            info.get('IsLoadedByiBoot') or info.get('IsEarlyAccessFirmware') or info.get('IsiBootEANFirmware') or

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	def is_fw_payload(info: dict[str, typing.Any]) -> bool:
30	    return (info.get('IsFirmwarePayload') or info.get('IsSecondaryFirmwarePayload') or info.get('IsFUDFirmware') or
31	            info.get('IsLoadedByiBoot') or info.get('IsEarlyAccessFirmware') or info.get('IsiBootEANFirmware') or

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:30
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
29	def is_fw_payload(info: dict[str, typing.Any]) -> bool:
30	    return (info.get('IsFirmwarePayload') or info.get('IsSecondaryFirmwarePayload') or info.get('IsFUDFirmware') or
31	            info.get('IsLoadedByiBoot') or info.get('IsEarlyAccessFirmware') or info.get('IsiBootEANFirmware') or

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	    return (info.get('IsFirmwarePayload') or info.get('IsSecondaryFirmwarePayload') or info.get('IsFUDFirmware') or
31	            info.get('IsLoadedByiBoot') or info.get('IsEarlyAccessFirmware') or info.get('IsiBootEANFirmware') or
32	            info.get('IsiBootNonEssentialFirmware'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	    return (info.get('IsFirmwarePayload') or info.get('IsSecondaryFirmwarePayload') or info.get('IsFUDFirmware') or
31	            info.get('IsLoadedByiBoot') or info.get('IsEarlyAccessFirmware') or info.get('IsiBootEANFirmware') or
32	            info.get('IsiBootNonEssentialFirmware'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
30	    return (info.get('IsFirmwarePayload') or info.get('IsSecondaryFirmwarePayload') or info.get('IsFUDFirmware') or
31	            info.get('IsLoadedByiBoot') or info.get('IsEarlyAccessFirmware') or info.get('IsiBootEANFirmware') or
32	            info.get('IsiBootNonEssentialFirmware'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	            info.get('IsLoadedByiBoot') or info.get('IsEarlyAccessFirmware') or info.get('IsiBootEANFirmware') or
32	            info.get('IsiBootNonEssentialFirmware'))
33	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
37	    def ap_img4_ticket(self):
38	        ticket = self.get('ApImg4Ticket')
39	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
46	    def bb_ticket(self):
47	        return self.get('BBTicket')
48	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    def get_path_by_entry(self, component: str):
50	        node = self.get(component)
51	        if node is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
51	        if node is not None:
52	            return node.get('Path')
53	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
74	                if key == 'ApRawProductionMode':
75	                    value2 = parameters.get('ApProductionMode')
76	                elif key == 'ApCurrentProductionMode':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	                elif key == 'ApCurrentProductionMode':
77	                    value2 = parameters.get('ApProductionMode')
78	                elif key == 'ApRawSecurityMode':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	                elif key == 'ApRawSecurityMode':
79	                    value2 = parameters.get('ApSecurityMode')
80	                elif key == 'ApRequiresImage4':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	                elif key == 'ApRequiresImage4':
81	                    value2 = parameters.get('ApSupportsImg4')
82	                elif key == 'ApDemotionPolicyOverride':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
82	                elif key == 'ApDemotionPolicyOverride':
83	                    value2 = parameters.get('DemotionPolicy')
84	                elif key == 'ApInRomDFU':

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
84	                elif key == 'ApInRomDFU':
85	                    value2 = parameters.get('ApInRomDFU')
86	                else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	                if value != 255:
101	                    value2 = tss_entry.get(key)
102	                    if value2:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
133	                continue
134	            info = manifest_entry.get('Info')
135	            if not info:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
136	                continue
137	            if parameters.get('_OnlyFWComponents', False):
138	                if not manifest_entry.get('Trusted', False):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:138
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
137	            if parameters.get('_OnlyFWComponents', False):
138	                if not manifest_entry.get('Trusted', False):
139	                    logger.debug(f'skipping {key} as it is not trusted')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
159	            # Make sure we have a Digest key for Trusted items even if empty
160	            node = manifest_entry.get('Trusted', False)
161	            if node:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	            if node:
162	                if manifest_entry.get('Digest') is None:
163	                    tss_entry['Digest'] = b''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
184	        for key in keys_to_copy_uint:
185	            value = parameters.get(key)
186	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:195
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
194	        for key in keys_to_copy_bool:
195	            value = parameters.get(key)
196	            self._request[key] = bytes_to_uint(value) == 1

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
197	
198	        nonce = parameters.get(parameters, f'Timer,Nonce,{tag}')
199	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
209	            # handle RestoreRequestRules
210	            rules = manifest_entry['Info'].get('RestoreRequestRules')
211	            if rules is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	            # Make sure we have a Digest key for Trusted items even if empty
215	            trusted = manifest_entry.get('Trusted', False)
216	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
217	            if trusted:
218	                digest = manifest_entry.get('Digest')
219	                if digest is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	
249	        self._request['eUICC,ApProductionMode'] = parameters.get('eUICC,ApProductionMode',
250	                                                                 parameters.get('ApProductionMode'))
251	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
249	        self._request['eUICC,ApProductionMode'] = parameters.get('eUICC,ApProductionMode',
250	                                                                 parameters.get('ApProductionMode'))
251	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
256	
257	        if self._request.get('eUICC,Gold') is None:
258	            n = plist_access_path(parameters, ('Manifest', 'eUICC,Gold'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
261	
262	        if self._request.get('eUICC,Main') is None:
263	            n = plist_access_path(parameters, ('Manifest', 'eUICC,Main'))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
267	        # set Nonce for eUICC,Gold component
268	        node = parameters.get('EUICCGoldNonce')
269	        if node is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
269	        if node is not None:
270	            n = self._request.get('eUICC,Gold')
271	            if n is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
274	        # set Nonce for eUICC,Main component
275	        node = parameters.get('EUICCMainNonce')
276	        if node is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:277
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
276	        if node is not None:
277	            n = self._request.get('eUICC,Main')
278	            if n is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
297	
298	            info_dict = manifest_entry.get('Info')
299	            if info_dict is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
301	
302	            if parameters.get('ApSupportsImg4', False) and ('RestoreRequestRules' not in info_dict):
303	                logger.debug(f'Skipping "{key}" as it doesn\'t have RestoreRequestRules')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
305	
306	            if parameters.get('_OnlyFWComponents', False):
307	                if not manifest_node.get('Trusted', False):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:307
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
306	            if parameters.get('_OnlyFWComponents', False):
307	                if not manifest_node.get('Trusted', False):
308	                    logger.debug(f'skipping {key} as it is not trusted')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:315
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
314	
315	            if info_dict.get('IsFTAB'):
316	                logger.debug('Skipping IsFTAB')

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
332	            # Make sure we have a Digest key for Trusted items even if empty
333	            node = manifest_entry.get('Trusted', False)
334	            if node:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
334	            if node:
335	                if manifest_entry.get('Digest') is None:
336	                    tss_entry['Digest'] = b''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
363	
364	        uid_mode = parameters.get('UID_MODE', False)
365	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
372	
373	        if parameters.get('RequiresUIDMode'):
374	            self._request['Ap,SikaFuse'] = 0

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
397	        # 'IsDev' determines whether we have Production or Development
398	        is_dev = parameters.get('SE,IsDev')
399	        if is_dev is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:400
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
399	        if is_dev is None:
400	            is_dev = parameters.get('SEIsDev', False)
401	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
503	            target_node = 1
504	            sub_node = node.get('EPRO')
505	            if sub_node:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
506	                target_node &= sub_node if isprod else not sub_node
507	            sub_node = node.get('FabRevision')
508	            if sub_node:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:599
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
598	            # handle RestoreRequestRules
599	            rules = manifest_entry['Info'].get('RestoreRequestRules')
600	            if rules is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:604
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
603	            # Make sure we have a Digest key for Trusted items even if empty
604	            trusted = manifest_entry.get('Trusted', False)
605	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
606	            if trusted:
607	                digest = manifest_entry.get('Digest')
608	                if digest is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:631
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
630	
631	        nonce = parameters.get('Nonce')
632	        if nonce is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
641	            # handle RestoreRequestRules
642	            rules = manifest_entry['Info'].get('RestoreRequestRules')
643	            if rules is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:647
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
646	            # Make sure we have a Digest key for Trusted items even if empty
647	            trusted = manifest_entry.get('Trusted', False)
648	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
649	            if trusted:
650	                digest = manifest_entry.get('Digest')
651	                if digest is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:745
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
744	                if manifest is not None:
745	                    comp = manifest[k]['Info'].get('Img4PayloadType')
746	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:748
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
747	                if comp is None:
748	                    comp = COMPONENT_FOURCC.get(k)
749	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:785
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
784	        loop = asyncio.get_event_loop()
785	        with ThreadPoolExecutor() as executor:
786	            def post() -> bytes:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/restore/tss.py:787
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
786	            def post() -> bytes:
787	                return requests.post(TSS_CONTROLLER_ACTION_URL, headers=headers, data=plistlib.dumps(self._request),
788	                                     verify=False).content
789	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
129	        sock = socket.create_connection((hostname, port), timeout=create_connection_timeout)
130	        sock.settimeout(None)
131	        if keep_alive:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
153	            raise NoDeviceConnectedError()
154	        sock = target_device.connect(port, usbmux_address=usbmux_address)
155	        return ServiceConnection(sock, mux_device=target_device)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:167
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
166	        """ Close the connection. """
167	        self.socket.close()
168	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
172	            return
173	        self.writer.close()
174	        try:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
188	        try:
189	            return self.socket.recv(length)
190	        except ssl.SSLError:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
200	        try:
201	            self.socket.sendall(data)
202	        except ssl.SSLEOFError as e:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
238	        while len(data) < size:
239	            chunk = self.recv(size - len(data))
240	            if chunk is None or len(chunk) == 0:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:293
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
292	        msg = b''.join([hdr, data])
293	        return self.sendall(msg)
294	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
320	        """
321	        return self.sendall(build_plist(d, endianity, fmt))
322	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
328	        """
329	        self.writer.write(payload)
330	        await self.writer.drain()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
339	        """
340	        await self.aio_sendall(build_plist(d, endianity, fmt))
341	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/service_connection.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
392	        """
393	        self.sendall(data)
394	        self._offset += len(data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/afc.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
237	                if src_size <= MAXIMUM_READ_SIZE:
238	                    f.write(self.get_file_contents(src))
239	                else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/afc.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
246	                    for _ in pb:
247	                        f.write(self.fread(handle, min(MAXIMUM_READ_SIZE, left_size)))
248	                        left_size -= MAXIMUM_READ_SIZE

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/afc.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
246	                    for _ in pb:
247	                        f.write(self.fread(handle, min(MAXIMUM_READ_SIZE, left_size)))
248	                        left_size -= MAXIMUM_READ_SIZE

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/afc.py:313
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
312	            with open(local_path, 'rb') as f:
313	                self.set_file_contents(remote_path, f.read())
314	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/afc.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
549	            return
550	        d = self.fread(h, int(info['st_size']))
551	        self.fclose(h)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/afc.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
556	        h = self.fopen(filename, 'w')
557	        self.fwrite(h, data)
558	        self.fclose(h)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/device_link.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
181	            if rm_path.is_dir():
182	                shutil.rmtree(rm_path)
183	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/dvt/instruments/activity_trace_tap.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
122	    def _peek_word(self) -> int:
123	        buf = self._message.read(2)
124	        if len(buf) != 2:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/dvt/testmanaged/xcuitest.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
72	            self.pctl.kill(pid)
73	            dvt1.close()
74	            dvt2.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/dvt/testmanaged/xcuitest.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
73	            dvt1.close()
74	            dvt2.close()
75	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/dvt/testmanaged/xcuitest.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
116	        msg = mheader + pheader
117	        dvt.service.sendall(msg)
118	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/installation_proxy.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
43	                    full_path.touch()
44	                    zip_file.write(full_path,
45	                                   arcname=f'{payload_prefix}/{os.path.relpath(full_path, directory)}')
46	        return zip_path.read_bytes()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/installation_proxy.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
43	                    full_path.touch()
44	                    zip_file.write(full_path,
45	                                   arcname=f'{payload_prefix}/{os.path.relpath(full_path, directory)}')
46	        return zip_path.read_bytes()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/installation_proxy.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
195	            file_name = file.name
196	            file_stream = BytesIO(fb.read())
197	            self._upload_ipcc(file_stream, afc_client, file_name)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/installation_proxy.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
218	                with file_zip.open(file_name) as inside_file_zip:
219	                    file_data = inside_file_zip.read()
220	                    afc_client.makedirs(TEMP_REMOTE_BASEDIR)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	ACTIVATION_USER_AGENT_IOS = 'iOS Device Activator (MobileActivation-20 built on Jan 15 2012 at 19:07:28)'
18	ACTIVATION_DEFAULT_URL = 'https://albert.apple.com/deviceservices/deviceActivation'
19	ACTIVATION_DRM_HANDSHAKE_DEFAULT_URL = 'https://albert.apple.com/deviceservices/drmHandshake'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	ACTIVATION_DEFAULT_URL = 'https://albert.apple.com/deviceservices/deviceActivation'
19	ACTIVATION_DRM_HANDSHAKE_DEFAULT_URL = 'https://albert.apple.com/deviceservices/drmHandshake'
20	DEFAULT_HEADERS = {

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        root = ET.fromstring(content)
71	        title = root.find('page/navigationBar').get('title')
72	        description = root.find('page/tableView/section/footer').text

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	            fields.append(
76	                Field(id=editable.get('id'), label=editable.get('label'), placeholder=editable.get('placeholder'),
77	                      secure=bool(editable.get('secure', False))))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	            fields.append(
76	                Field(id=editable.get('id'), label=editable.get('label'), placeholder=editable.get('placeholder'),
77	                      secure=bool(editable.get('secure', False))))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:76
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
75	            fields.append(
76	                Field(id=editable.get('id'), label=editable.get('label'), placeholder=editable.get('placeholder'),
77	                      secure=bool(editable.get('secure', False))))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
76	                Field(id=editable.get('id'), label=editable.get('label'), placeholder=editable.get('placeholder'),
77	                      secure=bool(editable.get('secure', False))))
78	        server_info = {}

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
88	        headers.update(DEFAULT_HEADERS)
89	        content, headers = self.post(ACTIVATION_DRM_HANDSHAKE_DEFAULT_URL, data=plistlib.dumps(blob), headers=headers)
90	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
92	
93	        content, headers = self.post(ACTIVATION_DEFAULT_URL, data={'activation-info': plistlib.dumps(activation_info)})
94	        content_type = headers['Content-Type']

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
109	            data.update(activation_form.server_info)
110	            content, headers = self.post(ACTIVATION_DEFAULT_URL, data=data)
111	            content_type = headers['Content-Type']

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	        response = self.send_command('CreateTunnel1SessionInfoRequest')
121	        error = response.get('Error')
122	        if error is not None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	        response = self.send_command('CreateTunnel1ActivationInfoRequest', handshake_response)
128	        error = response.get('Error')
129	        if error is not None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/mobile_activation.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
154	
155	        resp = requests.post(url, data=data, headers=headers)
156	        return resp.content, resp.headers

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/notification_proxy.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
31	        if timeout is not None:
32	            self.service.socket.settimeout(timeout)
33	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/os_trace.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
144	                break
145	            out.write(self.service.recv_prefixed(endianity='<'))
146	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/os_trace.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
158	            file = Path(temp_dir) / 'foo.tar'
159	            with open(file, 'wb') as f:
160	                self.create_archive(f, size_limit=size_limit, age_limit=age_limit, start_time=start_time)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/remote_server.py:458
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
457	        obj_size = pheader.totalLength - pheader.auxiliaryLength
458	        data = packet_stream.read(obj_size) if obj_size else None
459	        return data, aux

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/web_protocol/cdp_screencast.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
83	        """
84	        resized_img = Image.open(BytesIO(b64decode(data)))
85	        resized_img = resized_img.resize((self.scaled_width, self.scaled_height), Image.ANTIALIAS)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/web_protocol/cdp_screencast.py:84
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
83	        """
84	        resized_img = Image.open(BytesIO(b64decode(data)))
85	        resized_img = resized_img.resize((self.scaled_width, self.scaled_height), Image.ANTIALIAS)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/web_protocol/cdp_screencast.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
88	        resized_img.save(resized, format='jpeg', quality='maximum')
89	        return b64encode(resized.getvalue()).decode()
90	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/web_protocol/cdp_screencast.py:89
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
88	        resized_img.save(resized, format='jpeg', quality='maximum')
89	        return b64encode(resized.getvalue()).decode()
90	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/web_protocol/selenium_api.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
78	    def screenshot_as_png(self):
79	        return b64decode(self.screenshot_as_base64.encode('ascii'))
80	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/services/web_protocol/selenium_api.py:79
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
78	    def screenshot_as_png(self):
79	        return b64decode(self.screenshot_as_base64.encode('ascii'))
80	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tcp_forwarder.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
40	
41	    def start(self, address='0.0.0.0'):
42	        """ forward each connection from given local machine port to remote device port """

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tcp_forwarder.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
43	        # create local tcp server socket
44	        self.server_socket = socket.socket()
45	        self.server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tcp_forwarder.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
83	        for current_sock in self.inputs:
84	            current_sock.close()
85	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tcp_forwarder.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
89	
90	        other_sock.close()
91	        from_sock.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tcp_forwarder.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
90	        other_sock.close()
91	        from_sock.close()
92	        self.inputs.remove(other_sock)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tcp_forwarder.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
99	        try:
100	            data = from_sock.recv(1024)
101	            if not data:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tcp_forwarder.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
120	                try:
121	                    sent = other_sock.send(data[total_sent:])
122	                    total_sent += sent

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tcp_forwarder.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
147	            self.logger.error(f'failed to connect to port: {self.dst_port}')
148	            local_connection.close()
149	            return

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tcp_forwarder.py:198
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
197	            raise ConnectionFailedError()
198	        return mux_device.connect(self.dst_port, usbmux_address=self.usbmux_address)
199	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tunneld/api.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
8	
9	TUNNELD_DEFAULT_ADDRESS = ('127.0.0.1', 49151)
10	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/tunneld/api.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	        # Get the list of tunnels from the specified address
40	        resp = requests.get(f'http://{tunneld_address[0]}:{tunneld_address[1]}')
41	        tunnels = resp.json()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
88	        try:
89	            return mux.connect(self, port)
90	        except:  # noqa: E722

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
90	        except:  # noqa: E722
91	            mux.close()
92	            raise

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:111
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
110	        self._offset = 0
111	        self.sock = socket.socket(family, socket.SOCK_STREAM)
112	        self.sock.connect(address)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
111	        self.sock = socket.socket(family, socket.SOCK_STREAM)
112	        self.sock.connect(address)
113	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
115	        self._offset += len(msg)
116	        self.sock.sendall(msg)
117	        return len(msg)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
121	        while len(msg) < size:
122	            chunk = self.sock.recv(size - len(msg))
123	            self._offset += len(chunk)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
129	    def close(self) -> None:
130	        self.sock.close()
131	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
132	    def settimeout(self, interval: float) -> None:
133	        self.sock.settimeout(interval)
134	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
146	    # used on Windows
147	    ITUNES_HOST = ('127.0.0.1', 27015)
148	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
180	        })
181	        sock.send(message)
182	        response = usbmuxd_response.parse_stream(sock)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
184	        # if we sent a bad request, we should re-create the socket in the correct version this time
185	        sock.close()
186	        sock = MuxConnection.create_usbmux_socket(usbmux_address=usbmux_address)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
221	        """ connect to a relay port on target machine and get a raw python socket object for the connection """
222	        self._connect(device.devid, socket.htons(port))
223	        self._connected = True

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
227	        """ close current socket """
228	        self._sock.close()
229	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:250
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
249	    def __exit__(self, exc_type, exc_val, exc_tb):
250	        self.close()
251	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
265	        while time.time() < end:
266	            self._sock.settimeout(end - time.time())
267	            try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:274
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
273	                    self._sock.setblocking(True)
274	                    self.close()
275	                except OSError:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
283	    def _connect(self, device_id: int, port: int):
284	        self._send({'header': {'version': self._version,
285	                               'message': usbmuxd_msgtype.CONNECT,
286	                               'tag': self._tag},
287	                    'data': {'device_id': device_id, 'port': port},
288	                    })

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
299	        self._assert_not_connected()
300	        self._sock.send(usbmuxd_request.build(data))
301	        self._tag += 1

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
310	    def _send_receive(self, message_type: int):
311	        self._send({'header': {'version': self._version, 'message': message_type, 'tag': self._tag},
312	                    'data': b''})
313	        response = self._receive(self._tag - 1)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
347	        # serials are saved inside usbmuxd without '-'
348	        self._send({'MessageType': 'ReadPairRecord', 'PairRecordID': serial})
349	        response = self._receive(self._tag - 1)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:358
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
357	        self.devices = []
358	        self._send({'MessageType': 'ListDevices'})
359	        response = self._receive(self._tag - 1)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
373	        """ get SystemBUID """
374	        self._send({'MessageType': 'ReadBUID'})
375	        return self._receive(self._tag - 1)['BUID']

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
389	        request.update(data)
390	        super()._send({'header': {'version': self._version,
391	                                  'message': usbmuxd_msgtype.PLIST,
392	                                  'tag': self._tag},
393	                       'data': plistlib.dumps(request),
394	                       })

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
402	    def _send_receive(self, data: dict):
403	        self._send(data)
404	        response = self._receive(self._tag - 1)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/usbmux.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
418	    devices = mux.devices
419	    mux.close()
420	    return devices

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/utils.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
13	    for component in path:
14	        d = d.get(component)
15	        if d is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/utils.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
68	def file_download(url: str, outfile: Path, chunk_size=1024) -> None:
69	    resp = requests.get(url, stream=True)
70	    total = int(resp.headers.get('content-length', 0))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/pymobiledevice3/utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	    resp = requests.get(url, stream=True)
70	    total = int(resp.headers.get('content-length', 0))
71	    with outfile.open('wb') as file, tqdm(

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/conftest.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
60	            for rsd in rsds:
61	                await rsd.close()
62	        except IndexError:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_crash_reports.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
73	    assert sorted(dir_list) == sorted(pulled_list)
74	    shutil.rmtree(BASENAME)
75	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_tcp_forwarder.py:13
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
12	def attempt_local_connection(port: int):
13	    client = socket()
14	    client.connect(('127.0.0.1', port))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_tcp_forwarder.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
13	    client = socket()
14	    client.connect(('127.0.0.1', port))
15	    client.close()

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_tcp_forwarder.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
13	    client = socket()
14	    client.connect(('127.0.0.1', port))
15	    client.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_tcp_forwarder.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
14	    client.connect(('127.0.0.1', port))
15	    client.close()
16	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_web_protocol/common.py:2
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	LINK_HTML = (
2	    '<a id="id_of_link" class="link-class" name="name_of_link" href="http://i_am_a_link.com/" rel="noreferrer">'
3	    'the text obviously'
4	    '</a>'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_web_protocol/test_driver.py:6
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
5	def test_back(webdriver):
6	    webdriver.get('https://www.google.com')
7	    webdriver.get('https://github.com')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_web_protocol/test_driver.py:7
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
6	    webdriver.get('https://www.google.com')
7	    webdriver.get('https://github.com')
8	    webdriver.back()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_web_protocol/test_driver.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	    webdriver.back()
9	    assert webdriver.current_url.rstrip('/') == 'https://www.google.com'
10	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_web_protocol/test_driver.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	    assert not webdriver.current_url
14	    url = 'https://www.google.com'
15	    webdriver.get(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_web_protocol/test_driver.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	def test_forward(webdriver):
20	    webdriver.get('https://www.google.com')
21	    webdriver.get('https://github.com')

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_web_protocol/test_driver.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    webdriver.get('https://www.google.com')
21	    webdriver.get('https://github.com')
22	    webdriver.back()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymobiledevice3-4.20.25/pymobiledevice3-4.20.25/tests/services/test_web_protocol/test_driver.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    webdriver.forward()
24	    assert webdriver.current_url.rstrip('/') == 'https://github.com'
25	

--------------------------------------------------

Code scanned:
	Total lines of code: 22073
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 38.0
		High: 278.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 302.0
		High: 14.0
Files skipped (0):
