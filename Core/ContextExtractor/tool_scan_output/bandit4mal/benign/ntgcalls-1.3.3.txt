Run started:2025-04-12 13:56:56.415945

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/json/tools/amalgamate/amalgamate.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	        with open(args.config, 'r') as f:
66	            config = json.loads(f.read())
67	            for key in config:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/json/tools/amalgamate/amalgamate.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
80	            with open(self.prologue, 'r') as f:
81	                amalgamation += datetime.datetime.now().strftime(f.read())
82	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/json/tools/amalgamate/amalgamate.py:98
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
97	        with open(self.target, 'w') as f:
98	            f.write(amalgamation)
99	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/json/tools/amalgamate/amalgamate.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
265	        with open(actual_path, 'r') as f:
266	            self.content = f.read()
267	            self._process()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/json/tools/generate_natvis/generate_natvis.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	    with open(os.path.join(args.output, 'nlohmann_json.natvis'), 'w') as f:
41	        f.write(natvis)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/json/tools/serve_header/serve_header.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
297	            if not injected and JSON_VERSION_RE.match(line):
298	                length += content.write(bytes('#define JSON_BUILD_COUNT '\
299	                                              f'{self.worktree.build_count}\n', 'utf-8'))
300	                length += content.write(bytes('#define JSON_BUILD_TIME '\

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/json/tools/serve_header/serve_header.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
299	                                              f'{self.worktree.build_count}\n', 'utf-8'))
300	                length += content.write(bytes('#define JSON_BUILD_TIME '\
301	                                              f'"{self.worktree.build_time}"\n\n', 'utf-8'))
302	                injected = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/json/tools/serve_header/serve_header.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
302	                injected = True
303	            length += content.write(bytes(line, 'utf-8'))
304	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/json/tools/serve_header/serve_header.py:372
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
371	            with open(config_file, 'r') as f:
372	                config = yaml.safe_load(f)
373	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/docs/benchmark.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	        with open("test.cpp", "w") as f:
78	            f.write(codegen(nclasses))
79	        n1 = dt.datetime.now()

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/docs/benchmark.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
79	        n1 = dt.datetime.now()
80	        os.system(
81	            "g++ -Os -shared -rdynamic -undefined dynamic_lookup "
82	            "-fvisibility=hidden -std=c++14 test.cpp -I include "

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/docs/benchmark.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
79	        n1 = dt.datetime.now()
80	        os.system(
81	            "g++ -Os -shared -rdynamic -undefined dynamic_lookup "
82	            "-fvisibility=hidden -std=c++14 test.cpp -I include "

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/docs/conf.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
72	with open("../pybind11/_version.py") as f:
73	    code = compile(f.read(), "../pybind11/_version.py", "exec")
74	loc = {}

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/docs/conf.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
74	loc = {}
75	exec(code, loc)
76	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/docs/conf.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
336	        if retcode < 0:
337	            sys.stderr.write(f"doxygen error code: {-retcode}\n")
338	    except OSError as e:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/docs/conf.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
338	    except OSError as e:
339	        sys.stderr.write(f"doxygen execution failed: {e}\n")
340	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/docs/conf.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
343	    with open(DIR.parent / "README.rst") as f:
344	        contents = f.read()
345	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/docs/conf.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
353	    with open(DIR / "readme.rst", "w") as f:
354	        f.write(contents)
355	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/pybind11/setup_helpers.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
224	            os.chdir(olddir)
225	            shutil.rmtree(tmpdir)
226	

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/pybind11/setup_helpers.py:477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
476	            if threads > 1:
477	                with ThreadPool(threads) as pool:
478	                    for _ in pool.imap_unordered(_single_compile, objects):

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/setup.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
69	code = compile(VERSION_FILE.read_text(encoding="utf-8"), "pybind11/_version.py", "exec")
70	exec(code, loc)
71	version = loc["__version__"]

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/setup.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
118	        for src in sources:
119	            shutil.rmtree(src)
120	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/setup.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
148	    code = compile(txt, setup_py, "exec")
149	    exec(code, {"SDist": SDist})

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
140	    with contextlib.closing(inner_file) as f:
141	        return f.read()
142	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
156	
157	    with tarfile.open(str(sdist), "r:gz") as tar:
158	        start = tar.getnames()[0] + "/"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
180	
181	    with open(os.path.join(MAIN_DIR, "tools", "setup_main.py.in"), "rb") as f:
182	        contents = (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
182	        contents = (
183	            string.Template(f.read().decode("utf-8"))
184	            .substitute(version=version, extra_cmd="")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
188	
189	    with open(os.path.join(MAIN_DIR, "tools", "pyproject.toml"), "rb") as f:
190	        contents = f.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
189	    with open(os.path.join(MAIN_DIR, "tools", "pyproject.toml"), "rb") as f:
190	        contents = f.read()
191	    assert pyproject_toml == contents

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
206	
207	    with tarfile.open(str(sdist), "r:gz") as tar:
208	        start = tar.getnames()[0] + "/"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
228	
229	    with open(os.path.join(MAIN_DIR, "tools", "setup_global.py.in"), "rb") as f:
230	        contents = (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:231
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
230	        contents = (
231	            string.Template(f.read().decode())
232	            .substitute(version=version, extra_cmd="")

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:237
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
236	
237	    with open(os.path.join(MAIN_DIR, "tools", "pyproject.toml"), "rb") as f:
238	        contents = f.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/extra_python_package/test_files.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
237	    with open(os.path.join(MAIN_DIR, "tools", "pyproject.toml"), "rb") as f:
238	        contents = f.read()
239	        assert pyproject_toml == contents

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/test_gil_scoped.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
160	    timeout = 0.1 if test_fn is _intentional_deadlock else 10
161	    process = multiprocessing.Process(target=target, args=args, kwargs=kwargs)
162	    process.daemon = True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/test_iostream.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
283	        for _j in range(20):
284	            threads.append(m.TestThread())
285	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tests/test_unnamed_namespace_a.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	)
15	XFAIL_REASON = "Known issues: https://github.com/pybind/pybind11/pull/4319"
16	
17	
18	@pytest.mark.xfail(XFAIL_CONDITION, reason=XFAIL_REASON, strict=False)
19	@pytest.mark.parametrize(
20	    "any_struct", [m.unnamed_namespace_a_any_struct, mb.unnamed_namespace_b_any_struct]
21	)
22	def test_have_class_any_struct(any_struct):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/deps/pybind11/tools/libsize.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
37	with open(save, "w") as sf:
38	    sf.write(str(libsize))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/setup.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
20	    regex = re.compile(r'VERSION ([A-Za-z0-9.]+)', re.MULTILINE)
21	    version = re.findall(regex, f.read())[1]
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/setup.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    os_base = 'x86_64' if platform.machine() != 'aarch64' else 'aarch64'
55	    url = (f'https://github.com/Kitware/CMake/releases/download/v{cmake_version}/'
56	           f'cmake-{cmake_version}-linux-{os_base}.sh')
57	    download_sh = Path(fixed_name, 'install_cmake.sh')

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/setup.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
57	    download_sh = Path(fixed_name, 'install_cmake.sh')
58	    with urlopen(url) as response:
59	        with open(download_sh, 'wb') as file:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/setup.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	        with open(download_sh, 'wb') as file:
60	            file.write(response.read())
61	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/setup.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	        with open(download_sh, 'wb') as file:
60	            file.write(response.read())
61	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/setup.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
167	        if self.no_preserve_cache:
168	            shutil.rmtree(build_temp)
169	            boost_dir = Path(source_dir, 'deps', 'boost')

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ntgcalls-1.3.3/ntgcalls-1.3.3/setup.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
171	                if boost_build.startswith('boost_'):
172	                    shutil.rmtree(Path(boost_dir, boost_build))
173	            print('Cleanup successfully')

--------------------------------------------------

Code scanned:
	Total lines of code: 11862
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 39.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 41.0
		High: 4.0
Files skipped (0):
