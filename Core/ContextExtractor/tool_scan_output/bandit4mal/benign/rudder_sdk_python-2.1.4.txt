Run started:2025-04-12 10:55:08.002402

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/request.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	    body["sentAt"] = datetime.now(timezone.utc).replace(tzinfo=tzutc()).isoformat()
21	    url = remove_trailing_slash(host or 'https://api.rudderstack.com') + '/v1/batch'
22	    auth = HTTPBasicAuth(write_key, '')

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/request.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
42	
43	    res = _session.post(url, data=data, auth=auth,
44	                        headers=headers, timeout=timeout)
45	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/__init__.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	        self.assertIsNone(analytics.default_client)
48	        analytics.host = 'https://test-host/v1/batch'
49	        analytics.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/__init__.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	        analytics.flush()
50	        self.assertEqual(analytics.default_client.host, 'https://test-host/v1/batch')
51	

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
71	            'userId', 'python test event', {'property': 'value'},
72	            {'ip': '192.168.0.1'}, datetime(2014, 9, 3), 'anonymousId',
73	            {'Amplitude': True}, 'messageId')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
79	        self.assertEqual(msg['integrations'], {'Amplitude': True})
80	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
81	        self.assertEqual(msg['event'], 'python test event')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:107
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
106	        success, msg = client.identify(
107	            'userId', {'trait': 'value'}, {'ip': '192.168.0.1'},
108	            datetime(2014, 9, 3), 'anonymousId', {'Amplitude': True},

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
114	        self.assertEqual(msg['integrations'], {'Amplitude': True})
115	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
116	        self.assertEqual(msg['context']['traits'], {'trait': 'value'})

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
140	        success, msg = client.group(
141	            'userId', 'groupId', {'trait': 'value'}, {'ip': '192.168.0.1'},
142	            datetime(2014, 9, 3), 'anonymousId', {'Amplitude': True},

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
148	        self.assertEqual(msg['integrations'], {'Amplitude': True})
149	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
150	        self.assertEqual(msg['traits'], {'trait': 'value'})

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
183	            'userId', 'category', 'name', {'property': 'value'},
184	            {'ip': '192.168.0.1'}, datetime(2014, 9, 3), 'anonymousId',
185	            {'Amplitude': True}, 'messageId')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
190	        self.assertEqual(msg['integrations'], {'Amplitude': True})
191	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
192	        self.assertEqual(msg['properties'], {'property': 'value'})

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:218
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
217	            'userId', 'category', 'name', {'property': 'value'},
218	            {'ip': '192.168.0.1'}, datetime(2014, 9, 3), 'anonymousId',
219	            {'Amplitude': True}, 'messageId')

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_client.py:225
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
224	        self.assertEqual(msg['integrations'], {'Amplitude': True})
225	        self.assertEqual(msg['context']['ip'], '192.168.0.1')
226	        self.assertEqual(msg['properties'], {'property': 'value'})

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_request.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
12	    def test_valid_request(self):
13	        res = post(TEST_WRITE_KEY,host=TEST_DATA_PLANE_URL, batch=[{
14	            'userId': 'userId',
15	            'event': 'python event',
16	            'type': 'track'
17	        }])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_request.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	        self.assertRaises(Exception, post, 'TEST_WRITE_KEY',
22	                          'https://hosted.rudderlabs.com', False, '[{]')
23	
24	    def test_invalid_host(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_request.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	        self.assertRaises(Exception, post, TEST_WRITE_KEY,
26	                          'https://invalid_host/', batch=[])
27	
28	    def test_datetime_serialization(self):

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_request.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
40	    def test_should_not_timeout(self):
41	        res = post(TEST_WRITE_KEY,host=TEST_DATA_PLANE_URL, batch=[{
42	            'userId': 'userId',
43	            'event': 'python event',
44	            'type': 'track'
45	        }], timeout=15)
46	        self.assertEqual(res.status_code, 200)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_request.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
49	        with self.assertRaises(requests.ReadTimeout):
50	            post(TEST_WRITE_KEY,host=TEST_DATA_PLANE_URL,
51	             batch=[{
52	                'userId': 'userId',
53	                'event': 'python event',
54	                'type': 'track'
55	            }], timeout=0.0001)
56	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_request.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
70	    def test_proxies(self):
71	        res = post(TEST_WRITE_KEY,host=TEST_DATA_PLANE_URL, batch=[{
72	            'userId': 'userId',
73	            'event': 'python event',
74	            'type': 'track',
75	            'proxies': TEST_PROXY
76	        }])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_utils.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	    def test_remove_slash(self):
70	        self.assertEqual('http://hosted.rudderlabs.com',
71	                         utils.remove_trailing_slash('http://hosted.rudderlabs.com/'))
72	        self.assertEqual('http://hosted.rudderlabs.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_utils.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	        self.assertEqual('http://hosted.rudderlabs.com',
71	                         utils.remove_trailing_slash('http://hosted.rudderlabs.com/'))
72	        self.assertEqual('http://hosted.rudderlabs.com',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_utils.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
71	                         utils.remove_trailing_slash('http://hosted.rudderlabs.com/'))
72	        self.assertEqual('http://hosted.rudderlabs.com',
73	                         utils.remove_trailing_slash('http://hosted.rudderlabs.com'))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/rudderstack/analytics/test/test_utils.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
72	        self.assertEqual('http://hosted.rudderlabs.com',
73	                         utils.remove_trailing_slash('http://hosted.rudderlabs.com'))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/rudder_sdk_python-2.1.4/rudder_sdk_python-2.1.4/setup.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	    version=VERSION,
28	    url='https://github.com/rudderlabs/rudder-sdk-python',
29	    author='RudderStack',

--------------------------------------------------

Code scanned:
	Total lines of code: 1341
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 5.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 0.0
Files skipped (0):
