Run started:2025-04-12 10:34:08.335623

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tabulator/config.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
12	
13	VERSION = io.open(os.path.join(os.path.dirname(__file__), 'VERSION')).read().strip()
14	DEFAULT_SCHEME = 'file'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tabulator/config.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	SQL_SCHEMES = ['firebird', 'mssql', 'mysql', 'oracle', 'postgresql', 'sqlite', 'sybase']
29	S3_DEFAULT_ENDPOINT_URL = 'https://s3.amazonaws.com'
30	
31	# Loaders
32	
33	LOADERS = {

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tabulator/loaders/aws.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
51	            bytes = io.BufferedRandom(io.BytesIO())
52	            bytes.write(response['Body'].read())
53	            bytes.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tabulator/loaders/aws.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	            bytes = io.BufferedRandom(io.BytesIO())
52	            bytes.write(response['Body'].read())
53	            bytes.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tabulator/loaders/aws.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
64	        if self.__bytes_sample_size:
65	            sample = bytes.read(self.__bytes_sample_size)
66	            bytes.seek(0)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tabulator/loaders/remote.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
141	        assert whence == 0
142	        self.__response = self.__session.get(self.__source, stream=True, timeout=self.__timeout)
143	        self.__response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tabulator/parsers/gsheet.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	        self.close()
34	        url = 'https://docs.google.com/spreadsheets/d/%s/export?format=csv&id=%s'
35	        match = re.search(r'.*/d/(?P<key>[^/]+)/.*?(?:gid=(?P<gid>\d+))?$', source)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tabulator/stream.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
372	                    for line in file:
373	                        source.write(line)
374	                    source.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tabulator/stream.py:732
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
731	        writer = writer_class(**writer_options)
732	        return writer.write(self.iter(), target, headers=self.headers, encoding=encoding)
733	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_csv.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	from tabulator.parsers.csv import CSVParser
12	BASE_URL = 'https://raw.githubusercontent.com/okfn/tabulator-py/master/%s'
13	
14	
15	# Read
16	
17	def test_stream_local_csv():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_csv.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	def test_stream_remote_csv_non_ascii_url():
92	    with Stream('http://data.defra.gov.uk/ops/government_procurement_card/over_£500_GPC_apr_2013.csv') as stream:
93	        assert stream.sample[0] == [

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_datapackage.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
21	        assert stream.headers == ['id', 'name']
22	        assert stream.read(keyed=True) == [
23	            {'id': 1, 'name': 'english'},

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_datapackage.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
30	        assert stream.headers == ['id', 'name']
31	        assert stream.read(keyed=True) == [
32	            {'id': 1, 'name': '中国人'},

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_datapackage.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
43	            assert stream.headers == ['id', 'name']
44	            assert stream.read(keyed=True) == [
45	                {'id': 1, 'name': '中国人'},

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_gsheet.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	def test_stream_gsheet():
15	    source = 'https://docs.google.com/spreadsheets/d/1mHIWnDvW9cALRMq9OdNfRwjAthCUFUOACPp0Lkyl7b4/edit?usp=sharing'
16	    with Stream(source) as stream:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_gsheet.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	def test_stream_gsheet_with_gid():
22	    source = 'https://docs.google.com/spreadsheets/d/1mHIWnDvW9cALRMq9OdNfRwjAthCUFUOACPp0Lkyl7b4/edit#gid=960698813'
23	    with Stream(source) as stream:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_gsheet.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	def test_stream_gsheet_bad_url():
29	    stream = Stream('https://docs.google.com/spreadsheets/d/bad')
30	    with pytest.raises(exceptions.HTTPError) as excinfo:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_json.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	from tabulator.parsers.json import JSONParser
13	BASE_URL = 'https://raw.githubusercontent.com/okfn/tabulator-py/master/%s'
14	
15	
16	# Read
17	
18	def test_stream_local_json_dicts():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_ods.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	from tabulator.parsers.ods import ODSParser
13	BASE_URL = 'https://raw.githubusercontent.com/okfn/tabulator-py/master/%s'
14	
15	
16	# Read
17	
18	def test_stream_ods():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_xls.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	from tabulator.parsers.xls import XLSParser
14	BASE_URL = 'https://raw.githubusercontent.com/okfn/tabulator-py/master/%s'
15	
16	
17	# Read
18	
19	def test_stream_local_xls():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_xls.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
100	def test_fix_for_2007_xls():
101	    source = 'https://ams3.digitaloceanspaces.com/budgetkey-files/spending-reports/2018-3-משרד התרבות והספורט-לשכת הפרסום הממשלתית-2018-10-22-c457.xls'
102	    with Stream(source) as stream:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/formats/test_xlsx.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	BASE_URL = "https://raw.githubusercontent.com/frictionlessdata/tabulator-py/master/%s"
14	
15	
16	# Read
17	
18	
19	def test_stream_xlsx_stream():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/schemes/test_aws.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	S3_ENDPOINT_URL = os.environ['S3_ENDPOINT_URL'] = 'http://localhost:5000'
21	
22	
23	# Read
24	
25	# https://github.com/frictionlessdata/tabulator-py/issues/271
26	@pytest.mark.skip
27	def test_stream_s3(s3_client, bucket):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/schemes/test_aws.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
38	    with Stream('s3://%s/table.csv' % bucket) as stream:
39	        assert stream.read() == [['id', 'name'], ['1', 'english'], ['2', '中国人']]
40	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/schemes/test_aws.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
55	    with Stream('s3://%s/table.csv' % bucket, s3_endpoint_url=S3_ENDPOINT_URL) as stream:
56	        assert stream.read() == [['id', 'name'], ['1', 'english'], ['2', '中国人']]
57	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/schemes/test_aws.py:73
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
72	    yield s3_client
73	    os.system('pkill moto_server')
74	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/schemes/test_aws.py:73
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
72	    yield s3_client
73	    os.system('pkill moto_server')
74	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/schemes/test_remote.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	BASE_URL = 'https://raw.githubusercontent.com/frictionlessdata/tabulator-py/master/%s'
14	
15	
16	# Read
17	
18	@pytest.mark.remote
19	def test_stream_https():

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/schemes/test_remote.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
52	    t = time()
53	    chars = loader.load('https://httpstat.us/200?sleep=5000', mode='b', encoding='utf-8')
54	    assert time() - t > 5

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dataflows_tabulator-1.54.3-py2.py3-none-any/tests/schemes/test_remote.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    with pytest.raises(HTTPError):
64	        chars = loader.load('https://httpstat.us/200?sleep=5000', mode='b', encoding='utf-8')
65	    assert time() - t < 5

--------------------------------------------------

Code scanned:
	Total lines of code: 3678
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 17.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 29.0
		High: 1.0
Files skipped (0):
