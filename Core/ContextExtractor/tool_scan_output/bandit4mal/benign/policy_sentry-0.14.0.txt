Run started:2025-04-12 12:12:10.701724

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
49	    """Gets the links from the actions, resources, and conditions keys page, and returns their filenames."""
50	    html = requests.get(BASE_DOCUMENTATION_URL, timeout=300)
51	    soup = BeautifulSoup(html.content, "html.parser")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	    """
85	    link_url_prefix = "https://docs.aws.amazon.com/service-authorization/latest/reference/"
86	    initial_html_filenames_list = get_links_from_base_actions_resources_conditions_page()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
92	    for page in html_filenames:
93	        response = requests.get(link_url_prefix + page, allow_redirects=False, timeout=300)
94	        # Replace the CSS stuff. Basically this:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
105	        for link in soup.find_all("link"):
106	            if link.get("href").startswith("/"):
107	                temp = link.attrs["href"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
107	                temp = link.attrs["href"]
108	                link.attrs["href"] = link.attrs["href"].replace(temp, f"https://docs.aws.amazon.com{temp}")
109	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
111	            try:
112	                if "src" in script.attrs and script.get("src").startswith("/"):
113	                    temp = script.attrs["src"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	                    temp = script.attrs["src"]
114	                    script.attrs["src"] = script.attrs["src"].replace(temp, f"https://docs.aws.amazon.com{temp}")
115	            except TypeError as t_e:  # noqa: PERF203

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
123	            # file.write(str(soup.html))
124	            file.write(str(soup.prettify()))
125	            file.close()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
205	            # The URL to that service's Actions, Resources, and Condition Keys page
206	            service_authorization_url_prefix = "https://docs.aws.amazon.com/service-authorization/latest/reference"
207	            service_authorization_url = f"{service_authorization_url_prefix}/{filename}"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/awsdocs.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	                    else:
260	                        api_documentation_link = link.attrs.get("href")
261	                        logger.debug(api_documentation_link)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/policy_sentry/shared/constants.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	
21	BASE_DOCUMENTATION_URL = "https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html"
22	# BASE_DOCUMENTATION_URL = "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_actions-resources-contextkeys.html"
23	
24	# Data json file
25	# On initialization, load the IAM data
26	BUNDLED_DATASTORE_FILE_PATH = Path(__file__).parent / "data/iam-definition.json"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/setup.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	PROJECT_URLS = {
22	    "Documentation": "https://policy-sentry.readthedocs.io/",
23	    "Code": "https://github.com/salesforce/policy_sentry/",
24	    "Twitter": "https://twitter.com/kmcquade3",
25	    "Red Team Report": "https://opensource.salesforce.com/policy_sentry",
26	}
27	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/setup.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	    "Documentation": "https://policy-sentry.readthedocs.io/",
23	    "Code": "https://github.com/salesforce/policy_sentry/",
24	    "Twitter": "https://twitter.com/kmcquade3",
25	    "Red Team Report": "https://opensource.salesforce.com/policy_sentry",
26	}
27	
28	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	    "Code": "https://github.com/salesforce/policy_sentry/",
24	    "Twitter": "https://twitter.com/kmcquade3",
25	    "Red Team Report": "https://opensource.salesforce.com/policy_sentry",
26	}
27	
28	
29	class PreBuildCommand(build_py):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/setup.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	    "Twitter": "https://twitter.com/kmcquade3",
25	    "Red Team Report": "https://opensource.salesforce.com/policy_sentry",
26	}
27	
28	
29	class PreBuildCommand(build_py):
30	    """Pre-build command"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/policy_sentry-0.14.0/policy_sentry-0.14.0/setup.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
63	    long_description_content_type="text/markdown",
64	    url="https://github.com/salesforce/policy_sentry",
65	    packages=setuptools.find_packages(exclude=["test*"]),

--------------------------------------------------

Code scanned:
	Total lines of code: 3272
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 6.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 0.0
Files skipped (0):
