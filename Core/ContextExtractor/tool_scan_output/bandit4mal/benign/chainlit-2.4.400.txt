Run started:2025-04-12 10:19:27.422729

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/config.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
62	# Default config file created if none exists
63	DEFAULT_CONFIG_STR = f"""[project]
64	# Whether to enable telemetry (default: true). No personal data is collected.
65	enable_telemetry = true
66	
67	
68	# List of environment variables to be provided by each user to use the app.
69	user_env = []
70	
71	# Duration (in seconds) during which the session is saved when the connection is lost
72	session_timeout = 3600
73	
74	# Duration (in seconds) of the user session expiry
75	user_session_timeout = 1296000  # 15 days
76	
77	# Enable third parties caching (e.g., LangChain cache)
78	cache = false
79	
80	# Authorized origins
81	allow_origins = ["*"]
82	
83	[features]
84	# Process and display HTML in messages. This can be a security risk (see https://stackoverflow.com/questions/19603097/why-is-it-dangerous-to-render-user-generated-html-or-javascript)
85	unsafe_allow_html = false
86	
87	# Process and display mathematical expressions. This can clash with "$" characters in messages.
88	latex = false
89	
90	# Autoscroll new user messages at the top of the window
91	user_message_autoscroll = true
92	
93	# Automatically tag threads with the current chat profile (if a chat profile is used)
94	auto_tag_thread = true
95	
96	# Allow users to edit their own messages
97	edit_message = true
98	
99	# Authorize users to spontaneously upload files with messages
100	[features.spontaneous_file_upload]
101	    enabled = true
102	    # Define accepted file types using MIME types
103	    # Examples:
104	    # 1. For specific file types:
105	    #    accept = ["image/jpeg", "image/png", "application/pdf"]
106	    # 2. For all files of certain type:
107	    #    accept = ["image/*", "audio/*", "video/*"]
108	    # 3. For specific file extensions:
109	    #    accept = {{ "application/octet-stream" = [".xyz", ".pdb"] }}
110	    # Note: Using "*/*" is not recommended as it may cause browser warnings
111	    accept = ["*/*"]
112	    max_files = 20
113	    max_size_mb = 500
114	
115	[features.audio]
116	    # Sample rate of the audio
117	    sample_rate = 24000
118	
119	[features.mcp.sse]
120	    enabled = true
121	
122	[features.mcp.stdio]
123	    enabled = true
124	    # Only the executables in the allow list can be used for MCP stdio server.
125	    # Only need the base name of the executable, e.g. "npx", not "/usr/bin/npx".
126	    # Please don't comment this line for now, we need it to parse the executable name.
127	    allowed_executables = [ "npx", "uvx" ]
128	
129	[UI]
130	# Name of the assistant.
131	name = "Assistant"
132	
133	# default_theme = "dark"
134	
135	# layout = "wide"
136	
137	# default_sidebar_state = "open"
138	
139	# Description of the assistant. This is used for HTML tags.
140	# description = ""
141	
142	# Chain of Thought (CoT) display mode. Can be "hidden", "tool_call" or "full".
143	cot = "full"
144	
145	# Specify a CSS file that can be used to customize the user interface.
146	# The CSS file can be served from the public directory or via an external link.
147	# custom_css = "/public/test.css"
148	
149	# Specify a JavaScript file that can be used to customize the user interface.
150	# The JavaScript file can be served from the public directory.
151	# custom_js = "/public/test.js"
152	
153	# Custom login page image, relative to public directory or external URL
154	# login_page_image = "/public/custom-background.jpg"
155	
156	# Custom login page image filter (Tailwind internal filters, no dark/light variants)
157	# login_page_image_filter = "brightness-50 grayscale"
158	# login_page_image_dark_filter = "contrast-200 blur-sm"
159	
160	# Specify a custom meta image url.
161	# custom_meta_image_url = "https://chainlit-cloud.s3.eu-west-3.amazonaws.com/logo/chainlit_banner.png"
162	
163	# Specify a custom build directory for the frontend.
164	# This can be used to customize the frontend code.
165	# Be careful: If this is a relative path, it should not start with a slash.
166	# custom_build = "./public/build"
167	
168	# Specify optional one or more custom links in the header.
169	# [[UI.header_links]]
170	#     name = "Issues"
171	#     icon_url = "https://avatars.githubusercontent.com/u/128686189?s=200&v=4"
172	#     url = "https://github.com/Chainlit/chainlit/issues"
173	
174	[meta]
175	generated_by = "{__version__}"
176	"""

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/config.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
178	
179	DEFAULT_HOST = "127.0.0.1"
180	DEFAULT_PORT = 8000

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/config.py:426
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
425	        with open(config_file, "w", encoding="utf-8") as f:
426	            f.write(DEFAULT_CONFIG_STR)
427	            logger.info(f"Created default config file at {config_file}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/config.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
542	
543	    chainlit_server = os.environ.get("CHAINLIT_SERVER", "https://cloud.chainlit.io")
544	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/dynamodb.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
228	            async with aiofiles.open(element.path, "rb") as f:
229	                content = await f.read()
230	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/dynamodb.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
235	                    if response.status == 200:
236	                        content = await response.read()
237	                    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/dynamodb.py:391
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
390	
391	        thread = await self.get_thread(thread_id)
392	        if not thread:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/sql_alchemy.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
347	    async def create_step(self, step_dict: "StepDict"):
348	        await self.update_thread(step_dict["threadId"])
349	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/sql_alchemy.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
481	            async with aiofiles.open(element.path, "rb") as f:
482	                content = await f.read()
483	        elif element.url:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/sql_alchemy.py:487
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
486	                    if response.status == 200:
487	                        content = await response.read()
488	                    else:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/sql_alchemy.py:497
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
496	
497	        user_id: str = await self._get_user_id_by_thread(element.thread_id) or "unknown"
498	        file_object_key = f"{user_id}/{element.id}" + (

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/storage_clients/gcs.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
15	    ):
16	        private_key = base64.b64decode(private_key).decode("utf-8")
17	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/storage_clients/gcs.py:16
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
15	    ):
16	        private_key = base64.b64decode(private_key).decode("utf-8")
17	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/data/storage_clients/gcs.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	                "client_email": client_email,
24	                "token_uri": "https://oauth2.googleapis.com/token",
25	            }
26	        )
27	
28	        self.client = storage.Client(project=project_id, credentials=credentials)
29	        self.bucket = self.client.bucket(bucket_name)
30	        logger.info("GCSStorageClient initialized")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/emitter.py:297
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
296	                for element in message.elements:
297	                    await element.send(for_id=message.id)
298	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/markdown.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	# Default chainlit.md file created if none exists
10	DEFAULT_MARKDOWN_STR = """# Welcome to Chainlit! ðŸš€ðŸ¤–
11	
12	Hi there, Developer! ðŸ‘‹ We're excited to have you on board. Chainlit is a powerful tool designed to help you prototype, debug and share applications built on top of LLMs.
13	
14	## Useful Links ðŸ”—
15	
16	- **Documentation:** Get started with our comprehensive [Chainlit Documentation](https://docs.chainlit.io) ðŸ“š
17	- **Discord Community:** Join our friendly [Chainlit Discord](https://discord.gg/k73SQ3FyUh) to ask questions, share your projects, and connect with other developers! ðŸ’¬
18	
19	We can't wait to see what you create with Chainlit! Happy coding! ðŸ’»ðŸ˜Š
20	
21	## Welcome screen
22	
23	To modify the welcome screen, edit the `chainlit.md` file at the root of your project. If you do not want a welcome screen, just leave this file empty.
24	"""
25	
26	
27	def init_markdown(root: str):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/markdown.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
32	        with open(chainlit_md_file, "w", encoding="utf-8") as f:
33	            f.write(DEFAULT_MARKDOWN_STR)
34	            logger.info(f"Created default chainlit markdown file at {chainlit_md_file}")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    env = ["OAUTH_GITHUB_CLIENT_ID", "OAUTH_GITHUB_CLIENT_SECRET"]
50	    authorize_url = "https://github.com/login/oauth/authorize"
51	
52	    def __init__(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
69	            response = await client.post(
70	                "https://github.com/login/oauth/access_token",
71	                data=payload,
72	            )
73	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
84	            user_response = await client.get(
85	                "https://api.github.com/user",
86	                headers={"Authorization": f"token {token}"},
87	            )
88	            user_response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	            emails_response = await client.get(
92	                "https://api.github.com/user/emails",
93	                headers={"Authorization": f"token {token}"},
94	            )
95	            emails_response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
108	    env = ["OAUTH_GOOGLE_CLIENT_ID", "OAUTH_GOOGLE_CLIENT_SECRET"]
109	    authorize_url = "https://accounts.google.com/o/oauth2/v2/auth"
110	
111	    def __init__(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	        self.authorize_params = {
115	            "scope": "https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email",
116	            "response_type": "code",
117	            "access_type": "offline",
118	        }
119	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
132	            response = await client.post(
133	                "https://oauth2.googleapis.com/token",
134	                data=payload,
135	            )
136	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	            response = await client.get(
150	                "https://www.googleapis.com/userinfo/v2/me",
151	                headers={"Authorization": f"Bearer {token}"},
152	            )
153	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
169	    authorize_url = (
170	        f"https://login.microsoftonline.com/{os.environ.get('OAUTH_AZURE_AD_TENANT_ID', '')}/oauth2/v2.0/authorize"
171	        if os.environ.get("OAUTH_AZURE_AD_ENABLE_SINGLE_TENANT")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
171	        if os.environ.get("OAUTH_AZURE_AD_ENABLE_SINGLE_TENANT")
172	        else "https://login.microsoftonline.com/common/oauth2/v2.0/authorize"
173	    )
174	    token_url = (
175	        f"https://login.microsoftonline.com/{os.environ.get('OAUTH_AZURE_AD_TENANT_ID', '')}/oauth2/v2.0/token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
174	    token_url = (
175	        f"https://login.microsoftonline.com/{os.environ.get('OAUTH_AZURE_AD_TENANT_ID', '')}/oauth2/v2.0/token"
176	        if os.environ.get("OAUTH_AZURE_AD_ENABLE_SINGLE_TENANT")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
176	        if os.environ.get("OAUTH_AZURE_AD_ENABLE_SINGLE_TENANT")
177	        else "https://login.microsoftonline.com/common/oauth2/v2.0/token"
178	    )
179	
180	    def __init__(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
185	            "response_type": "code",
186	            "scope": "https://graph.microsoft.com/User.Read offline_access",
187	            "response_mode": "query",
188	        }
189	
190	        if prompt := self.get_prompt():
191	            self.authorize_params["prompt"] = prompt

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
220	            response = await client.get(
221	                "https://graph.microsoft.com/v1.0/me",
222	                headers={"Authorization": f"Bearer {token}"},
223	            )
224	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
229	                photo_response = await client.get(
230	                    "https://graph.microsoft.com/v1.0/me/photos/48x48/$value",
231	                    headers={"Authorization": f"Bearer {token}"},
232	                )
233	                photo_data = await photo_response.aread()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:233
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
232	                )
233	                photo_data = await photo_response.aread()
234	                base64_image = base64.b64encode(photo_data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:234
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
233	                photo_data = await photo_response.aread()
234	                base64_image = base64.b64encode(photo_data)
235	                azure_user["image"] = (

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:234
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
233	                photo_data = await photo_response.aread()
234	                base64_image = base64.b64encode(photo_data)
235	                azure_user["image"] = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
260	    authorize_url = (
261	        f"https://login.microsoftonline.com/{os.environ.get('OAUTH_AZURE_AD_HYBRID_TENANT_ID', '')}/oauth2/v2.0/authorize"
262	        if os.environ.get("OAUTH_AZURE_AD_HYBRID_ENABLE_SINGLE_TENANT")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
262	        if os.environ.get("OAUTH_AZURE_AD_HYBRID_ENABLE_SINGLE_TENANT")
263	        else "https://login.microsoftonline.com/common/oauth2/v2.0/authorize"
264	    )
265	    token_url = (
266	        f"https://login.microsoftonline.com/{os.environ.get('OAUTH_AZURE_AD_HYBRID_TENANT_ID', '')}/oauth2/v2.0/token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
265	    token_url = (
266	        f"https://login.microsoftonline.com/{os.environ.get('OAUTH_AZURE_AD_HYBRID_TENANT_ID', '')}/oauth2/v2.0/token"
267	        if os.environ.get("OAUTH_AZURE_AD_HYBRID_ENABLE_SINGLE_TENANT")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
267	        if os.environ.get("OAUTH_AZURE_AD_HYBRID_ENABLE_SINGLE_TENANT")
268	        else "https://login.microsoftonline.com/common/oauth2/v2.0/token"
269	    )
270	
271	    def __init__(self):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
277	            "response_type": "code id_token",
278	            "scope": "https://graph.microsoft.com/User.Read https://graph.microsoft.com/openid offline_access",
279	            "response_mode": "form_post",
280	            "nonce": nonce,
281	        }
282	
283	        if prompt := self.get_prompt():
284	            self.authorize_params["prompt"] = prompt

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
313	            response = await client.get(
314	                "https://graph.microsoft.com/v1.0/me",
315	                headers={"Authorization": f"Bearer {token}"},
316	            )
317	            response.raise_for_status()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:323
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
322	                photo_response = await client.get(
323	                    "https://graph.microsoft.com/v1.0/me/photos/48x48/$value",
324	                    headers={"Authorization": f"Bearer {token}"},
325	                )
326	                photo_data = await photo_response.aread()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:326
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
325	                )
326	                photo_data = await photo_response.aread()
327	                base64_image = base64.b64encode(photo_data)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:327
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
326	                photo_data = await photo_response.aread()
327	                base64_image = base64.b64encode(photo_data)
328	                azure_user["image"] = (

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:327
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
326	                photo_data = await photo_response.aread()
327	                base64_image = base64.b64encode(photo_data)
328	                azure_user["image"] = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/oauth_providers.py:492
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
491	    # Ensure that the domain does not have a trailing slash
492	    domain = "https://api.descope.com/oauth2/v1"
493	
494	    authorize_url = f"{domain}/authorize"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	    if host == DEFAULT_HOST:
91	        url = f"http://localhost:{port}{root_path}"
92	    else:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
165	        if FILES_DIRECTORY.is_dir():
166	            shutil.rmtree(FILES_DIRECTORY)
167	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
341	
342	    default_url = "https://github.com/Chainlit/chainlit"
343	    default_meta_image_url = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
343	    default_meta_image_url = (
344	        "https://chainlit-cloud.s3.eu-west-3.amazonaws.com/logo/chainlit_banner.png"
345	    )
346	    meta_image_url = config.ui.custom_meta_image_url or default_meta_image_url
347	    favicon_path = "/favicon"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
382	    with open(index_html_file_path, encoding="utf-8") as f:
383	        content = f.read()
384	        content = content.replace(PLACEHOLDER, tags)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:877
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
876	
877	    res = await data_layer.get_thread(thread_id)
878	    return JSONResponse(content=res)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:1004
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1003	
1004	    await data_layer.update_thread(thread_id, name=payload.name)
1005	    return JSONResponse(content={"success": True})

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1027	
1028	    await data_layer.delete_thread(thread_id)
1029	    return JSONResponse(content={"success": True})

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:1062
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1061	            context.session.has_first_interaction = True
1062	            asyncio.create_task(context.emitter.init_thread(action.name))
1063	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:1108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1107	            if on_mcp_disconnect := config.code.on_mcp_disconnect:
1108	                await on_mcp_disconnect(payload.name, old_client_session)
1109	            try:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:1110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1109	            try:
1110	                await old_exit_stack.aclose()
1111	            except Exception:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:1169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1168	            # Call the callback
1169	            await config.code.on_mcp_connect(mcp_connection, mcp_session)
1170	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:1228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1227	            try:
1228	                await exit_stack.aclose()
1229	            except Exception:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:1270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1269	    try:
1270	        content = await file.read()
1271	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/server.py:1286
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1285	    finally:
1286	        await file.close()
1287	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/session.py:193
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
192	        if self.files_dir.is_dir():
193	            shutil.rmtree(self.files_dir)
194	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/session.py:279
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
278	        if self.files_dir.is_dir():
279	            shutil.rmtree(self.files_dir)
280	        ws_sessions_sid.pop(self.socket_id, None)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/slack/app.py:314
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
313	        try:
314	            await data_layer.update_thread(
315	                thread_id=thread_id,
316	                name=thread_name or msg.content,
317	                metadata=ctx.session.to_persistable(),
318	                user_id=user_id,
319	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
53	
54	    author = thread.get("userIdentifier")
55	    user_is_author = author == session.user.identifier

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
57	    if user_is_author:
58	        metadata = thread.get("metadata") or {}
59	        if isinstance(metadata, str):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
61	        user_sessions[session.id] = metadata.copy()
62	        if chat_profile := metadata.get("chat_profile"):
63	            session.chat_profile = chat_profile

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	            session.chat_profile = chat_profile
64	        if chat_settings := metadata.get("chat_settings"):
65	            session.chat_settings = chat_settings

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
89	def _get_token_from_cookie(environ: WSGIEnvironment) -> Optional[str]:
90	    if cookie_header := environ.get("HTTP_COOKIE", None):
91	        cookies = cookie_parser(cookie_header)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
135	
136	    session_id = auth.get("sessionId")
137	    if restore_existing_session(sid, session_id, emit_fn, emit_call_fn):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
139	
140	    user_env_string = auth.get("userEnv")
141	    user_env = load_user_env(user_env_string)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
142	
143	    client_type = auth.get("clientType")
144	    http_referer = environ.get("HTTP_REFERER")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
143	    client_type = auth.get("clientType")
144	    http_referer = environ.get("HTTP_REFERER")
145	    http_cookie = environ.get("HTTP_COOKIE")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
144	    http_referer = environ.get("HTTP_REFERER")
145	    http_cookie = environ.get("HTTP_COOKIE")
146	    url_encoded_chat_profile = auth.get("chatProfile")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	    http_cookie = environ.get("HTTP_COOKIE")
146	    url_encoded_chat_profile = auth.get("chatProfile")
147	    chat_profile = (

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	        chat_profile=chat_profile,
161	        thread_id=auth.get("threadId"),
162	        languages=environ.get("HTTP_ACCEPT_LANGUAGE"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	        thread_id=auth.get("threadId"),
162	        languages=environ.get("HTTP_ACCEPT_LANGUAGE"),
163	        http_referer=http_referer,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
187	                "first_interaction",
188	                {"interaction": "resume", "thread_id": thread.get("id")},
189	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
191	
192	            for step in thread.get("steps", []):
193	                if "message" in step["type"]:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
207	async def clean_session(sid):
208	    session = WebsocketSession.get(sid)
209	    if session:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:215
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
214	async def disconnect(sid):
215	    session = WebsocketSession.get(sid)
216	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:229
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
228	    async def clear(_sid):
229	        if session := WebsocketSession.get(_sid):
230	            # Clean up the user session

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
248	async def stop(sid):
249	    if session := WebsocketSession.get(sid):
250	        trace_event("stop_task")

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:253
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
252	        init_ws_context(session)
253	        await Message(content="Task manually stopped.").send()
254	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
275	        logger.exception(e)
276	        await ErrorMessage(
277	            author="Error", content=str(e) or e.__class__.__name__
278	        ).send()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
288	
289	    messages = chat_context.get()
290	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/socket.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
376	        logger.exception(e)
377	        await ErrorMessage(
378	            author="Error", content=str(e) or e.__class__.__name__
379	        ).send()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/teams/app.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
67	            with open(persisted_file["path"], "rb") as file:
68	                dencoded_string = base64.b64encode(file.read()).decode()
69	                content_url = f"data:{mime};base64,{dencoded_string}"

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/teams/app.py:68
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
67	            with open(persisted_file["path"], "rb") as file:
68	                dencoded_string = base64.b64encode(file.read()).decode()
69	                content_url = f"data:{mime};base64,{dencoded_string}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/teams/app.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
67	            with open(persisted_file["path"], "rb") as file:
68	                dencoded_string = base64.b64encode(file.read()).decode()
69	                content_url = f"data:{mime};base64,{dencoded_string}"

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/teams/app.py:291
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
290	            try:
291	                await data_layer.update_thread(
292	                    thread_id=thread_id,
293	                    name=thread_name,
294	                    metadata=ctx.session.to_persistable(),
295	                    user_id=user.id,
296	                )

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/telemetry.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
35	        else:
36	            host_name = gethostname()
37	            host_name = hashlib.sha256(host_name.encode("UTF-8")).hexdigest()

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/telemetry.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
35	        else:
36	            host_name = gethostname()
37	            host_name = hashlib.sha256(host_name.encode("UTF-8")).hexdigest()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/chainlit-2.4.400/chainlit-2.4.400/chainlit/telemetry.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	        uptrace.configure_opentelemetry(
65	            dsn="https://YPa4AbDF853uCW6UWN2oYg@api.uptrace.dev/1778",
66	            service_name="chainlit",

--------------------------------------------------

Code scanned:
	Total lines of code: 10752
	Total lines skipped (#nosec): 1

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 57.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 89.0
		High: 5.0
Files skipped (0):
