Run started:2025-04-12 18:16:06.014311

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/other/exploit_webdav.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
13	if len(sys.argv) != 2:
14	    sys.exit("{} http://user:password@host:port/".format(sys.argv[0]))
15	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/other/exploit_webdav.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
35	if url.username:
36	    auth = base64.b64encode(":".join((url.username, url.password)))
37	    headers["Authorization"] = "Basic %s" % auth

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/other/exploit_webdav.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
35	if url.username:
36	    auth = base64.b64encode(":".join((url.username, url.password)))
37	    headers["Authorization"] = "Basic %s" % auth

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/other/exploit_webdav.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
39	con = httplib.HTTPConnection(url.hostname, int(url.port))
40	con.request("PROPFIND", url.path, body=xml, headers=headers)
41	res = con.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/other/exploit_webdav.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
40	con.request("PROPFIND", url.path, body=xml, headers=headers)
41	res = con.getresponse()
42	print(res.read())

--------------------------------------------------
>> Issue: [B321:blacklist] urllib2_Request
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/other/exploit_xmlrpc.py:35
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b321-urllib2-request
34	
35	req = urllib2.Request(url, data=xml, headers=headers)
36	

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/other/exploit_xmlrpc.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
38	
39	resp = urllib2.urlopen(req)
40	

--------------------------------------------------
>> Issue: [B320:blacklist] urllib2_urlopen
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/other/exploit_xmlrpc.py:39
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-urllib2-urlopen
38	
39	resp = urllib2.urlopen(req)
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/other/python_external.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	
20	xml_bad_url = """<?xml version="1.0" encoding="utf-8"?>
21	<!DOCTYPE weather [
22	<!ENTITY url SYSTEM "http://hg.python.org/cpython/raw-file/a11ddd687a0b/Lib/test/dh512.pem">
23	]>
24	<weather>&url;</weather>
25	"""
26	
27	
28	class WeatherHandler(ContentHandler):

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/setup.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	    maintainer_email="christian@python.org",
41	    url="https://github.com/tiran/defusedxml",
42	    download_url="https://pypi.python.org/pypi/defusedxml",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/setup.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    url="https://github.com/tiran/defusedxml",
42	    download_url="https://pypi.python.org/pypi/defusedxml",
43	    keywords="xml bomb DoS",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/tests.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
60	# based on Debian's rules, Port 9 is discard
61	os.environ["http_proxy"] = "http://127.0.9.1:9"
62	os.environ["https_proxy"] = os.environ["http_proxy"]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/tests.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
83	        with io.open(xmlfile, mode) as f:
84	            data = f.read()
85	        return data

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/tests.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
336	        msg = (
337	            "ExternalReferenceForbidden"
338	            "(system_id='http://www.w3schools.com/xml/note.xml', public_id=None)"
339	        )
340	        self.assertEqual(str(ctx.exception), msg)
341	        self.assertEqual(repr(ctx.exception), msg)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/tests.py:459
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
458	            os.environ.pop("no_proxy", None)
459	            os.environ["http_proxy"] = "http://proxy.invalid:3128"
460	            os.environ["https_proxy"] = "http://proxy.invalid:3128"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/tests.py:460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
459	            os.environ["http_proxy"] = "http://proxy.invalid:3128"
460	            os.environ["https_proxy"] = "http://proxy.invalid:3128"
461	
462	            doc = self.module.fromstring("<root>true</root>")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/tests.py:534
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
533	        gzf = gzip.GzipFile(mode="wb", fileobj=f)
534	        gzf.write(b"d" * length)
535	        gzf.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/defusedxml-0.8.0rc2/defusedxml-0.8.0rc2/tests.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
542	        while True:
543	            data = dec.read(readlength)
544	            if not data:

--------------------------------------------------

Code scanned:
	Total lines of code: 1366
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 11.0
		High: 7.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 15.0
		High: 3.0
Files skipped (0):
