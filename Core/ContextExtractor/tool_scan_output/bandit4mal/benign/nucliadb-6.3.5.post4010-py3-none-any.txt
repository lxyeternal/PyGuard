Run started:2025-04-12 19:49:48.358861

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/backups/restore.py:176
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
175	            to_read = min(chunk_size, remaining_bytes)
176	            chunk = await self.read(to_read)
177	            yield chunk

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/backups/restore.py:182
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
181	    async def read_tarinfo(self):
182	        raw_tar_header = await self.read(512)
183	        return tarfile.TarInfo.frombuf(raw_tar_header, encoding="utf-8", errors="strict")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/backups/restore.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
190	            padding_bytes = 512 - (tarinfo_size % 512)
191	        data = await self.read(tarinfo_size + padding_bytes)
192	        return data[:tarinfo_size]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/common/cluster/standalone/utils.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
39	        with open(host_key_path, "wb") as f:
40	            f.write(uuid.uuid4().bytes)
41	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/common/cluster/standalone/utils.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
42	    with open(host_key_path, "rb") as f:
43	        return str(uuid.UUID(bytes=f.read()))
44	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/common/external_index_providers/pinecone.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
516	        # be less of a problem when we move pinecone indexing to its own consumer.
517	        return await asyncio.to_thread(self._compute_base_vector_metadatas, index_data, resource_uuid)
518	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/common/external_index_providers/pinecone.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
579	        # be less of a problem when we move pinecone indexing to its own consumer.
580	        return await asyncio.to_thread(
581	            self._compute_vectorset_vectors, index_data, base_vector_metadatas
582	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/common/http_clients/pypi.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	
22	PYPI_JSON_API = "https://pypi.org/pypi/{package_name}/json"
23	
24	
25	class PyPi:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/common/maindb/local.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	        async with aiofiles.open(key, "wb+") as resp:
71	            await resp.write(value)
72	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/common/maindb/local.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
83	            async with aiofiles.open(self.compute_path(key), "rb") as resp:
84	                return await resp.read()
85	        except FileNotFoundError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/common/maindb/local.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
138	        else:
139	            obj = await self.read(key)
140	            if obj is not None:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/export_import/utils.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
406	    async def seek(self, offset: int):
407	        await self.stream.read(offset)
408	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/export_import/utils.py:410
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
409	    async def read_type(self) -> ExportedItemType:
410	        type_bytes = await self.stream.read(3)
411	        try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/export_import/utils.py:417
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
416	    async def read_item(self) -> bytes:
417	        size_bytes = await self.stream.read(4)
418	        size = int.from_bytes(size_bytes, byteorder="big")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/export_import/utils.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
418	        size = int.from_bytes(size_bytes, byteorder="big")
419	        data = await self.stream.read(size)
420	        return data

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/export_import/utils.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
431	            raise WrongExportStreamFormat() from ex
432	        binary_size_bytes = await self.stream.read(4)
433	        binary_size = int.from_bytes(binary_size_bytes, byteorder="big")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/export_import/utils.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
440	                    break
441	                chunk = await self.stream.read(bytes_to_read)
442	                yield chunk

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/export_import/utils.py:485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
484	        try:
485	            type_bytes = await self.stream.read(3)
486	        except ExportStreamExhausted:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/consumer/pull.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
76	        pb = BrokerMessage()
77	        data = base64.b64decode(payload)
78	        pb.ParseFromString(data)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/consumer/pull.py:77
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
76	        pb = BrokerMessage()
77	        data = base64.b64decode(payload)
78	        pb.ParseFromString(data)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/consumer/pull.py:208
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
207	                        if data.payload:
208	                            payload_length = len(base64.b64decode(data.payload))
209	                        logger.error(f"Message too big for transaction: {payload_length}")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/consumer/pull.py:208
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
207	                        if data.payload:
208	                            payload_length = len(base64.b64decode(data.payload))
209	                        logger.error(f"Message too big for transaction: {payload_length}")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/fields/base.py:296
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
295	                pb = FieldQuestionAnswers()
296	                pb.ParseFromString(raw_payload.read())
297	                raw_payload.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/fields/base.py:331
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
330	                pb = ExtractedText()
331	                pb.ParseFromString(raw_payload.read())
332	                raw_payload.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/fields/base.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
402	                pb = VectorObject()
403	                pb.ParseFromString(raw_payload.read())
404	                raw_payload.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/fields/base.py:505
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
504	            data = await self.storage.downloadbytescf(payload.file)
505	            new_payload.ParseFromString(data.read())
506	            data.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/orm/index_message.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
51	        security = await self.resource.get_security()
52	        await asyncio.to_thread(
53	            brain.generate_resource_metadata,
54	            basic,
55	            user_relations,
56	            origin,
57	            self.resource._previous_status,
58	            security,
59	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/orm/index_message.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
91	                    field_author = None
92	                await asyncio.to_thread(
93	                    brain.generate_texts,
94	                    self.resource.generate_field_id(fieldid),
95	                    extracted_text,
96	                    field_computed_metadata,
97	                    basic.usermetadata,
98	                    field_author,
99	                    replace_field=replace_texts,
100	                    skip_index=skip_index_texts,
101	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/orm/index_message.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
112	                )
113	                await asyncio.to_thread(
114	                    brain.generate_paragraphs,
115	                    self.resource.generate_field_id(fieldid),
116	                    field_computed_metadata,
117	                    extracted_text,
118	                    page_positions,
119	                    user_field_metadata,
120	                    replace_field=replace_paragraphs,
121	                    skip_index=skip_index_paragraphs,
122	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/orm/index_message.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
131	                    dimension = vectorset_config.vectorset_index_config.vector_dimension
132	                    await asyncio.to_thread(
133	                        brain.generate_vectors,
134	                        self.resource.generate_field_id(fieldid),
135	                        vo,
136	                        vectorset=vectorset_config.vectorset_id,
137	                        replace_field=replace,
138	                        vector_dimension=dimension,
139	                    )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/orm/index_message.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
140	        if relations:
141	            await asyncio.to_thread(
142	                brain.generate_relations,
143	                self.resource.generate_field_id(fieldid),
144	                field_computed_metadata,
145	                basic.usermetadata,
146	                replace_field=replace,
147	            )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/orm/resource.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
87	
88	_executor = ThreadPoolExecutor(10)
89	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/processing.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
238	        headers["X-LANGUAGE"] = file.language
239	        headers["X-FILENAME"] = base64.b64encode(file.file.filename.encode()).decode()  # type: ignore
240	        headers["X-MD5"] = file.file.md5

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/processing.py:239
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
238	        headers["X-LANGUAGE"] = file.language
239	        headers["X-FILENAME"] = base64.b64encode(file.file.filename.encode()).decode()  # type: ignore
240	        headers["X-MD5"] = file.file.md5

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/processing.py:264
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
263	    def encode_classif_labels(self, classif_labels: list[ClassificationLabel]) -> str:
264	        return base64.b64encode(
265	            json.dumps([label.model_dump(mode="python") for label in classif_labels]).encode()
266	        ).decode()

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/processing.py:264
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
263	    def encode_classif_labels(self, classif_labels: list[ClassificationLabel]) -> str:
264	        return base64.b64encode(
265	            json.dumps([label.model_dump(mode="python") for label in classif_labels]).encode()
266	        ).decode()

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/processing.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
317	            headers["X-LANGUAGE"] = file.language
318	            headers["X-FILENAME"] = base64.b64encode(file.file.filename.encode()).decode()
319	            headers["X-MD5"] = file.file.md5

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/processing.py:318
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
317	            headers["X-LANGUAGE"] = file.language
318	            headers["X-FILENAME"] = base64.b64encode(file.file.filename.encode()).decode()
319	            headers["X-MD5"] = file.file.md5

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/processing.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
355	            headers = {}
356	            headers["X-FILENAME"] = base64.b64encode(cf.filename.encode()).decode()
357	            headers["X-MD5"] = cf.md5

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/processing.py:356
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
355	            headers = {}
356	            headers["X-FILENAME"] = base64.b64encode(cf.filename.encode()).decode()
357	            headers["X-MD5"] = cf.md5

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/ingest/service/__init__.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	
51	    logger.info(f"======= Ingest GRPC running on http://0.0.0.0:{settings.grpc_port}/ ======")
52	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/learning_proxy.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
237	) -> httpx.Response:
238	    return await client.request(
239	        method=method.upper(), url=url, params=params, content=content, headers=headers
240	    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/learning_proxy.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
271	        try:
272	            response = await _retriable_proxied_request(
273	                client=client,
274	                method=method.upper(),
275	                url=url,
276	                params=dict(request.query_params),
277	                content=await request.body(),
278	                headers=proxied_headers,
279	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/learning_proxy.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
373	    async def get(self, *args, **kwargs: Any):
374	        return self._handle_request("GET", *args, **kwargs)
375	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/learning_proxy.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
376	    async def post(self, *args: Any, **kwargs: Any):
377	        return self._handle_request("POST", *args, **kwargs)
378	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/learning_proxy.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
379	    async def patch(self, *args: Any, **kwargs: Any):
380	        return self._handle_request("PATCH", *args, **kwargs)
381	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/learning_proxy.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
382	    async def delete(self, *args: Any, **kwargs: Any):
383	        return self._handle_request("DELETE", *args, **kwargs)
384	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/learning_proxy.py:415
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
414	    ) -> httpx.Response:
415	        return self._handle_request(method, url, params=params, content=content, headers=headers)
416	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/purge/__init__.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
274	    storage = await get_storage(
275	        gcs_scopes=["https://www.googleapis.com/auth/devstorage.full_control"],
276	        service_name=SERVICE_NAME,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/download.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
48	
49	@api.get(
50	    f"/{KB_PREFIX}/{{kbid}}/{RSLUG_PREFIX}/{{rslug}}/{{field_type}}/{{field_id}}/download/extracted/{{download_field:path}}",  # noqa
51	    tags=["Resource fields"],
52	    status_code=200,
53	    summary="Download extracted binary file (by slug)",
54	)
55	@requires_one([NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/download.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	
68	@api.get(
69	    f"/{KB_PREFIX}/{{kbid}}/{RESOURCE_PREFIX}/{{rid}}/{{field_type}}/{{field_id}}/download/extracted/{{download_field:path}}",  # noqa
70	    tags=["Resource fields"],
71	    status_code=200,
72	    summary="Download extracted binary file (by id)",
73	)
74	@requires_one([NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/download.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
107	
108	@api.get(
109	    f"/{KB_PREFIX}/{{kbid}}/{RSLUG_PREFIX}/{{rslug}}/file/{{field_id}}/download/field",
110	    tags=["Resource fields"],
111	    status_code=200,
112	    summary="Download field binary field (by slug)",
113	)
114	@requires_one([NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/download.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	
126	@api.get(
127	    f"/{KB_PREFIX}/{{kbid}}/{RESOURCE_PREFIX}/{{rid}}/file/{{field_id}}/download/field",
128	    tags=["Resource fields"],
129	    status_code=200,
130	    summary="Download field binary field (by id)",
131	)
132	@requires_one([NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/download.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	
161	@api.get(
162	    f"/{KB_PREFIX}/{{kbid}}/{RSLUG_PREFIX}/{{rslug}}/conversation/{{field_id}}/download/field/{{message_id}}/{{file_num}}",  # noqa
163	    tags=["Resource fields"],
164	    status_code=200,
165	    summary="Download conversation binary field (by slug)",
166	)
167	@requires_one([NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/download.py:180
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
179	
180	@api.get(
181	    f"/{KB_PREFIX}/{{kbid}}/{RESOURCE_PREFIX}/{{rid}}/conversation/{{field_id}}/download/field/{{message_id}}/{{file_num}}",  # noqa
182	    tags=["Resource fields"],
183	    status_code=200,
184	    summary="Download conversation binary field (by id)",
185	)
186	@requires_one([NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/export_import.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
40	
41	@api.get(
42	    f"/{KB_PREFIX}/{{kbid}}/export/{{export_id}}",
43	    status_code=200,
44	    summary="Download a Knowledge Box export",
45	    tags=["Knowledge Boxes"],
46	    response_class=StreamingResponse,
47	)
48	@requires_one([NucliaDBRoles.MANAGER, NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/export_import.py:100
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
99	
100	@api.get(
101	    f"/{KB_PREFIX}/{{kbid}}/export/{{export_id}}/status",
102	    status_code=200,
103	    summary="Get the status of a Knowledge Box Export",
104	    response_model=StatusResponse,
105	    tags=["Knowledge Boxes"],
106	)
107	@requires_one([NucliaDBRoles.MANAGER, NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/export_import.py:119
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
118	
119	@api.get(
120	    f"/{KB_PREFIX}/{{kbid}}/import/{{import_id}}/status",
121	    status_code=200,
122	    summary="Get the status of a Knowledge Box Import",
123	    response_model=StatusResponse,
124	    tags=["Knowledge Boxes"],
125	)
126	@requires_one([NucliaDBRoles.MANAGER, NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/knowledgebox.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
36	
37	@api.get(
38	    f"/{KBS_PREFIX}",
39	    status_code=200,
40	    summary="List Knowledge Boxes",
41	    response_model=KnowledgeBoxList,
42	    tags=["Knowledge Boxes"],
43	    include_in_schema=False,
44	)
45	@requires(NucliaDBRoles.MANAGER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/knowledgebox.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
55	
56	@api.get(
57	    f"/{KB_PREFIX}/{{kbid}}",
58	    status_code=200,
59	    summary="Get Knowledge Box",
60	    response_model=KnowledgeBoxObj,
61	    tags=["Knowledge Boxes"],
62	)
63	@requires_one([NucliaDBRoles.MANAGER, NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/knowledgebox.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
78	
79	@api.get(
80	    f"/{KB_PREFIX}/s/{{slug}}",
81	    status_code=200,
82	    summary="Get Knowledge Box (by slug)",
83	    response_model=KnowledgeBoxObj,
84	    tags=["Knowledge Boxes"],
85	)
86	@requires_one([NucliaDBRoles.MANAGER, NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
60	
61	@api.get(
62	    f"/{KB_PREFIX}/{{kbid}}/entitiesgroups",
63	    status_code=200,
64	    summary="Get Knowledge Box Entities",
65	    response_model=KnowledgeBoxEntities,
66	    tags=["Knowledge Box Services"],
67	)
68	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:101
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
100	
101	@api.get(
102	    f"/{KB_PREFIX}/{{kbid}}/entitiesgroup/{{group}}",
103	    status_code=200,
104	    summary="Get a Knowledge Box Entities Group",
105	    response_model=EntitiesGroup,
106	    tags=["Knowledge Box Services"],
107	)
108	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
127	
128	@api.get(
129	    f"/{KB_PREFIX}/{{kbid}}/labelsets",
130	    status_code=200,
131	    summary="Get Knowledge Box Label Sets",
132	    response_model=KnowledgeBoxLabels,
133	    tags=["Knowledge Box Services"],
134	)
135	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
161	
162	@api.get(
163	    f"/{KB_PREFIX}/{{kbid}}/labelset/{{labelset}}",
164	    status_code=200,
165	    summary="Get a Knowledge Box Label Set",
166	    response_model=LabelSet,
167	    tags=["Knowledge Box Services"],
168	    responses={"404": {"description": "Knowledge Box or Label Set not found"}},
169	)
170	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:189
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
188	        raise KnowledgeBoxNotFound()
189	    labelset: Optional[writer_pb2.LabelSet] = await datamanagers.atomic.labelset.get(
190	        kbid=kbid, labelset_id=labelset_id
191	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:217
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
216	        raise HTTPException(status_code=404, detail="Knowledge Box does not exist")
217	    synonyms = await datamanagers.atomic.synonyms.get(kbid=kbid) or Synonyms()
218	    return from_proto.kb_synonyms(synonyms)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
203	
204	@api.get(
205	    f"/{KB_PREFIX}/{{kbid}}/custom-synonyms",
206	    status_code=200,
207	    summary="Get Knowledge Box Custom Synonyms",
208	    tags=["Knowledge Box Services"],
209	    response_model=KnowledgeBoxSynonyms,
210	    openapi_extra={"x-operation_order": 2},
211	)
212	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:221
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
220	
221	@api.get(
222	    f"/{KB_PREFIX}/{{kbid}}/notifications",
223	    status_code=200,
224	    summary="Knowledge Box Notifications Stream",
225	    description="Provides a stream of activity notifications for the given Knowledge Box. The stream will be automatically closed after 2 minutes.",  # noqa: E501
226	    tags=["Knowledge Box Services"],
227	    response_description="Each line of the response is a Base64-encoded JSON object representing a notification. Refer to [the internal documentation](https://github.com/nuclia/nucliadb/blob/main/docs/tutorials/KB_NOTIFICATIONS.md) for a more detailed explanation of each notification type.",  # noqa: E501
228	    response_model=None,
229	    responses={"404": {"description": "Knowledge Box not found"}},
230	)
231	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
226	    tags=["Knowledge Box Services"],
227	    response_description="Each line of the response is a Base64-encoded JSON object representing a notification. Refer to [the internal documentation](https://github.com/nuclia/nucliadb/blob/main/docs/tutorials/KB_NOTIFICATIONS.md) for a more detailed explanation of each notification type.",  # noqa: E501
228	    response_model=None,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
298	            async with max_simultaneous:
299	                resource = await kb.get(result.resource_id)
300	                if resource is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	
261	@api.get(
262	    f"/{KB_PREFIX}/{{kbid}}/processing-status",
263	    status_code=200,
264	    summary="Knowledge Box Processing Status",
265	    description="Provides the status of the processing of the given Knowledge Box.",
266	    tags=["Knowledge Box Services"],
267	    response_model=processing.RequestsResults,
268	    responses={
269	        "404": {"description": "Knowledge Box not found"},
270	    },
271	)
272	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:335
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
334	
335	        config = await datamanagers.search_configurations.get(txn, kbid=kbid, name=config_name)
336	        if config is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	
321	@api.get(
322	    f"/{KB_PREFIX}/{{kbid}}/search_configurations/{{config_name}}",
323	    status_code=200,
324	    summary="Get search configuration",
325	    tags=["Knowledge Box Services"],
326	    response_model_exclude_unset=True,
327	)
328	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/services.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
341	
342	@api.get(
343	    f"/{KB_PREFIX}/{{kbid}}/search_configurations",
344	    status_code=200,
345	    summary="List search configurations",
346	    tags=["Knowledge Box Services"],
347	    response_model_exclude_unset=True,
348	)
349	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/reader/api/v1/vectorsets.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	
32	@api.get(
33	    f"/{KB_PREFIX}/{{kbid}}/vectorsets",
34	    status_code=200,
35	    summary="List vector sets",
36	    response_model=VectorSetList,
37	    tags=["Vector Sets"],
38	    # TODO: remove when the feature is mature
39	    include_in_schema=False,
40	)
41	@requires_one([NucliaDBRoles.READER])

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/find.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
91	        default=None,
92	        description="Minimum similarity score to filter vector index results. If not specified, the default minimum score of the semantic model associated to the Knowledge Box will be used. Check out the documentation for more information on how to use this parameter: https://docs.nuclia.dev/docs/rag/advanced/search#minimum-score",  # noqa: E501
93	        deprecated=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/find.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	        default=None,
97	        description="Minimum semantic similarity score to filter vector index results. If not specified, the default minimum score of the semantic model associated to the Knowledge Box will be used. Check out the documentation for more information on how to use this parameter: https://docs.nuclia.dev/docs/rag/advanced/search#minimum-score",  # noqa: E501
98	    ),

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/graph.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
51	
52	@api.post(
53	    f"/{KB_PREFIX}/{{kbid}}/graph",
54	    status_code=200,
55	    summary="Search Knowledge Box graph",
56	    description="Search on the Knowledge Box graph and retrieve triplets of vertex-edge-vertex",
57	    response_model_exclude_unset=True,
58	    include_in_schema=False,
59	    tags=["Search"],
60	)
61	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/graph.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
78	
79	@api.post(
80	    f"/{KB_PREFIX}/{{kbid}}/graph/nodes",
81	    status_code=200,
82	    summary="Search Knowledge Box graph nodes",
83	    description="Search on the Knowledge Box graph and retrieve nodes (vertices)",
84	    response_model_exclude_unset=True,
85	    include_in_schema=False,
86	    tags=["Search"],
87	)
88	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/graph.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
105	
106	@api.post(
107	    f"/{KB_PREFIX}/{{kbid}}/graph/relations",
108	    status_code=200,
109	    summary="Search Knowledge Box graph relations",
110	    description="Search on the Knowledge Box graph and retrieve relations (edges)",
111	    response_model_exclude_unset=True,
112	    include_in_schema=False,
113	    tags=["Search"],
114	)
115	@requires(NucliaDBRoles.READER)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/predict_proxy.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
35	
36	DESCRIPTION = "Convenience endpoint that proxies requests to the Predict API. It adds the Knowledge Box configuration settings as headers to the predict API request. Refer to the Predict API documentation for more details about the request and response models: https://docs.nuclia.dev/docs/nua-api#tag/Predict"  # noqa: E501
37	
38	
39	@api.get(
40	    path=f"/{KB_PREFIX}/{{kbid}}/predict/{{endpoint}}",
41	    status_code=200,
42	    summary="Predict API Proxy",
43	    description=DESCRIPTION,
44	    response_model=None,
45	    tags=["Search"],
46	)
47	@api.post(
48	    path=f"/{KB_PREFIX}/{{kbid}}/predict/{{endpoint}}",
49	    status_code=200,
50	    summary="Predict API Proxy",
51	    description=DESCRIPTION,
52	    response_model=None,
53	    tags=["Search"],
54	)
55	@requires(NucliaDBRoles.READER)
56	@version(1)
57	async def predict_proxy_endpoint(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/search.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
70	        summary="Search for pdf documents where the text 'Noam Chomsky' appears",
71	        description="For a complete list of filters, visit: https://github.com/nuclia/nucliadb/blob/main/docs/internal/SEARCH.md#filters-and-facets",  # noqa
72	        value={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/search.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        summary="Get the number of documents for each language",
80	        description="For a complete list of facets, visit: https://github.com/nuclia/nucliadb/blob/main/docs/internal/SEARCH.md#filters-and-facets",  # noqa
81	        value={

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/search.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
115	        default=None,
116	        description="Minimum similarity score to filter vector index results. If not specified, the default minimum score of the semantic model associated to the Knowledge Box will be used. Check out the documentation for more information on how to use this parameter: https://docs.nuclia.dev/docs/rag/advanced/search#minimum-score",  # noqa: E501
117	        deprecated=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/api/v1/search.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
120	        default=None,
121	        description="Minimum semantic similarity score to filter vector index results. If not specified, the default minimum score of the semantic model associated to the Knowledge Box will be used. Check out the documentation for more information on how to use this parameter: https://docs.nuclia.dev/docs/rag/advanced/search#minimum-score",  # noqa: E501
122	    ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:278
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
277	
278	        resp = await self.make_request(
279	            "POST",
280	            url=self.get_predict_url(REPHRASE, kbid),
281	            json=item.model_dump(),
282	            headers=self.get_predict_headers(kbid),
283	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
305	
306	        resp = await self.make_request(
307	            "POST",
308	            url=self.get_predict_url(CHAT, kbid),
309	            json=item.model_dump(),
310	            headers=headers,
311	            timeout=None,
312	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
360	
361	        resp = await self.make_request(
362	            "GET",
363	            url=self.get_predict_url(QUERY, kbid),
364	            params=params,
365	            headers=self.get_predict_headers(kbid),
366	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
380	
381	        resp = await self.make_request(
382	            "GET",
383	            url=self.get_predict_url(TOKENS, kbid),
384	            params={"text": sentence},
385	            headers=self.get_predict_headers(kbid),
386	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
398	            raise SendToPredictError(error)
399	        resp = await self.make_request(
400	            "POST",
401	            url=self.get_predict_url(SUMMARIZE, kbid),
402	            json=item.model_dump(),
403	            headers=self.get_predict_headers(kbid),
404	            timeout=None,
405	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:418
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
417	            raise SendToPredictError(error)
418	        resp = await self.make_request(
419	            "POST",
420	            url=self.get_predict_url(RERANK, kbid),
421	            json=item.model_dump(),
422	            headers=self.get_predict_headers(kbid),
423	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:436
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
435	            raise SendToPredictError(error)
436	        resp = await self.make_request(
437	            "POST",
438	            url=self.get_predict_url("/run-agents", kbid),
439	            json=item.model_dump(),
440	            headers=self.get_predict_headers(kbid),
441	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
451	        self.onprem = True
452	        self.cluster_url = "http://localhost:8000"
453	        self.public_url = "http://localhost:8000"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
452	        self.cluster_url = "http://localhost:8000"
453	        self.public_url = "http://localhost:8000"
454	        self.calls = []

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
577	        ada = AppliedDataAugmentation()
578	        serialized_fm = base64.b64encode(fm.SerializeToString()).decode("utf-8")
579	        augmented_field = AugmentedField(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict.py:578
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
577	        ada = AppliedDataAugmentation()
578	        serialized_fm = base64.b64encode(fm.SerializeToString()).decode("utf-8")
579	        augmented_field = AugmentedField(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict_models.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
108	        try:
109	            return QuestionAnswers.FromString(b64decode(qas))
110	        except DecodeError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict_models.py:109
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
108	        try:
109	            return QuestionAnswers.FromString(b64decode(qas))
110	        except DecodeError:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict_models.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
117	                NewTextField(
118	                    text_field=FieldText.FromString(b64decode(text_field["text_field"])),  # type: ignore
119	                    destination=text_field["destination"],

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict_models.py:118
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
117	                NewTextField(
118	                    text_field=FieldText.FromString(b64decode(text_field["text_field"])),  # type: ignore
119	                    destination=text_field["destination"],

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict_models.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
131	        # Custom encoding to be able to serialize protobuf messages
132	        json_encoders={Message: lambda m: b64encode(m.SerializeToString()).decode()},
133	    )

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict_models.py:132
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
131	        # Custom encoding to be able to serialize protobuf messages
132	        json_encoders={Message: lambda m: b64encode(m.SerializeToString()).decode()},
133	    )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict_models.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
151	        try:
152	            return FieldMetadata.FromString(b64decode(metadata))
153	        except DecodeError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/predict_models.py:152
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
151	        try:
152	            return FieldMetadata.FromString(b64decode(metadata))
153	        except DecodeError:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/search/chat/images.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
44	    image = Image(
45	        b64encoded=base64.b64encode(image_bytes).decode(),
46	        content_type="image/png",

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/search/chat/images.py:45
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
44	    image = Image(
45	        b64encoded=base64.b64encode(image_bytes).decode(),
46	        content_type="image/png",

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/search/chat/images.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
63	    image = Image(
64	        b64encoded=base64.b64encode(image_bytes).decode(),
65	        content_type="image/png",

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/search/chat/images.py:64
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
63	    image = Image(
64	        b64encoded=base64.b64encode(image_bytes).decode(),
65	        content_type="image/png",

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/search/chat/images.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
79	    image = Image(
80	        b64encoded=base64.b64encode(value).decode(),
81	        # We assume the thumbnail is always generated as jpeg by Nuclia processing

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/search/chat/images.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
79	    image = Image(
80	        b64encoded=base64.b64encode(value).decode(),
81	        # We assume the thumbnail is always generated as jpeg by Nuclia processing

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/search/ingestion_agents.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
82	        metadata = fcmw.metadata
83	    serialized_metadata = b64encode(metadata.SerializeToString()).decode()
84	    return FieldInfo(

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/search/search/ingestion_agents.py:83
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
82	        metadata = fcmw.metadata
83	    serialized_metadata = b64encode(metadata.SerializeToString()).decode()
84	    return FieldInfo(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/standalone/app.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	
59	HOMEPAGE_HTML = """
60	<!DOCTYPE html>
61	<html lang="en">
62	<head>
63	    <meta charset="UTF-8">
64	    <meta name="viewport" content="width=device-width, initial-scale=1.0">
65	    <title>NucliaDB Standalone Server</title>
66	</head>
67	<body>
68	    <h1>Welcome to NucliaDB Standalone Server</h1>
69	    <p> The NucliaDB API is exposed at /api/v1. </p>
70	    <br>
71	    <h2>Quick Links</h2>
72	    <ul>
73	        <li><a href="/admin">Admin UI</a></li>
74	        <li><a href="https://docs.nuclia.dev/docs/management/nucliadb/deploy/basics">NucliaDB Deployment Documentation</a></li>
75	        <li><a href="https://docs.nuclia.dev/docs/api">API Reference</a></li>
76	        <li><a href="/api/v1/docs">API Explorer</a></li>
77	        <li><a href="/metrics">Metrics</a></li>
78	        <li><a href="https://docs.nuclia.dev/docs/">Nuclia Documentation</a></li>
79	    </ul>
80	</body>
81	</html>
82	"""  # noqa: E501
83	
84	
85	def application_factory(settings: Settings) -> FastAPI:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/standalone/auth.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
127	        try:
128	            token_data = orjson.loads(base64.b64decode(token_split[1] + "==="))
129	        except Exception:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/standalone/auth.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
127	        try:
128	            token_data = orjson.loads(base64.b64decode(token_split[1] + "==="))
129	        except Exception:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/standalone/auth.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
174	
175	        token = base64.b64decode(auth_data).decode("utf-8")
176	        user = token.split(":")[0]

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/standalone/auth.py:175
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
174	
175	        token = base64.b64decode(auth_data).decode("utf-8")
176	        user = token.split(":")[0]

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/standalone/run.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
93	        if pid != 0:
94	            sys.stdout.write(f"Server forked and running on pid {pid}.")
95	            return

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/standalone/run.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	
133	    sys.stdout.write(
134	        f"""=================================================
135	||
136	||   NucliaDB Standalone Server Running!
137	||
138	||   Version: {version_info_fmted}
139	||
140	||   Configuration:
141	{settings_to_output_fmted}
142	=================================================

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/standalone/settings.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	        default=None,
49	        description="Nuclia Understanding API Key. Read how to generate a NUA Key here: https://docs.nuclia.dev/docs/rag/advanced/understanding/intro#get-a-nua-key",  # noqa
50	    )

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/standalone/settings.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
51	    zone: Optional[str] = pydantic.Field(default=None, description="Nuclia Understanding API Zone ID")
52	    http_host: str = pydantic.Field(default="0.0.0.0", description="HTTP Port")
53	    http_port: int = pydantic.Field(default=8080, description="HTTP Port")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/train/settings.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
28	
29	    nuclia_learning_url: Optional[str] = "https://nuclia.cloud/api/v1/learning/"
30	    nuclia_learning_apikey: Optional[str] = None

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/train/settings.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
31	
32	    internal_counter_api: str = "http://search.nuclia.svc.cluster.local:8030/api/v1/kb/{kbid}/counters"
33	
34	    internal_search_api: str = "http://search.nuclia.svc.cluster.local:8030/api/v1/kb/{kbid}/search"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/train/settings.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	
34	    internal_search_api: str = "http://search.nuclia.svc.cluster.local:8030/api/v1/kb/{kbid}/search"
35	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/train/uploader.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
121	        req = await sess.get(f"{url}/request")
122	        request_data = RequestData.model_validate_json(await req.read())
123	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/export_import.py:63
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
62	
63	@api.post(
64	    f"/{KB_PREFIX}/{{kbid}}/export",
65	    status_code=200,
66	    summary="Start an export of a Knowledge Box",
67	    tags=["Knowledge Boxes"],
68	    response_model=CreateExportResponse,
69	)
70	@requires_one([NucliaDBRoles.MANAGER, NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/export_import.py:88
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
87	@only_for_onprem
88	@api.post(
89	    f"/{KBS_PREFIX}/import",
90	    summary="Create a KB from an export and import its content",
91	    tags=["Knowledge Boxes"],
92	    response_model=NewImportedKbResponse,
93	    openapi_extra={"x-hidden-operation": True},
94	)
95	@requires_one([NucliaDBRoles.MANAGER, NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/export_import.py:137
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
136	
137	@api.post(
138	    f"/{KB_PREFIX}/{{kbid}}/import",
139	    status_code=200,
140	    summary="Start an import to a Knowledge Box",
141	    tags=["Knowledge Boxes"],
142	    response_model=CreateImportResponse,
143	)
144	@requires_one([NucliaDBRoles.MANAGER, NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/field.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
108	        partition=partition,
109	        userid=request.headers.get("X-NUCLIADB-USER", ""),
110	    )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/field.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
568	
569	        resource = await kb.get(rid)
570	        if resource is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/field.py:528
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
527	
528	@api.post(
529	    f"/{KB_PREFIX}/{{kbid}}/{RESOURCE_PREFIX}/{{rid}}/file/{{field_id}}/reprocess",
530	    status_code=202,
531	    summary="Reprocess file field (by id)",
532	    response_model=models.writer.ResourceUpdated,
533	    tags=["Resource fields"],
534	)
535	@requires(NucliaDBRoles.WRITER)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/knowledgebox.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
53	@only_for_onprem
54	@api.post(
55	    f"/{KBS_PREFIX}",
56	    status_code=201,
57	    summary="Create Knowledge Box",
58	    tags=["Knowledge Boxes"],
59	    openapi_extra={"x-hidden-operation": True},
60	)
61	@requires(NucliaDBRoles.MANAGER)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/resource.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
83	
84	@api.post(
85	    f"/{KB_PREFIX}/{{kbid}}/{RESOURCES_PREFIX}",
86	    status_code=201,
87	    name="Create Resource",
88	    description="Create a new Resource in a Knowledge Box",
89	    response_model=ResourceCreated,
90	    response_model_exclude_unset=True,
91	    tags=["Resources"],
92	)
93	@requires(NucliaDBRoles.WRITER)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/resource.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
382	
383	@api.post(
384	    f"/{KB_PREFIX}/{{kbid}}/{RSLUG_PREFIX}/{{rslug}}/reprocess",
385	    status_code=202,
386	    summary="Reprocess resource (by slug)",
387	    response_model=ResourceUpdated,
388	    tags=["Resources"],
389	)
390	@requires(NucliaDBRoles.WRITER)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/resource.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
401	
402	@api.post(
403	    f"/{KB_PREFIX}/{{kbid}}/{RESOURCE_PREFIX}/{{rid}}/reprocess",
404	    status_code=202,
405	    summary="Reprocess resource (by id)",
406	    response_model=ResourceUpdated,
407	    tags=["Resources"],
408	)
409	@requires(NucliaDBRoles.WRITER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/resource.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
450	
451	        resource = await kb.get(rid)
452	        if resource is None:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/resource.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
531	
532	@api.post(
533	    f"/{KB_PREFIX}/{{kbid}}/{RSLUG_PREFIX}/{{rslug}}/reindex",
534	    status_code=204,
535	    summary="Reindex Resource (by slug)",
536	    tags=["Resources"],
537	)
538	@requires(NucliaDBRoles.WRITER)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/resource.py:550
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
549	
550	@api.post(
551	    f"/{KB_PREFIX}/{{kbid}}/{RESOURCE_PREFIX}/{{rid}}/reindex",
552	    status_code=204,
553	    summary="Reindex Resource (by id)",
554	    tags=["Resources"],
555	)
556	@requires(NucliaDBRoles.WRITER)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/services.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
55	
56	@api.post(
57	    f"/{KB_PREFIX}/{{kbid}}/entitiesgroups",
58	    status_code=200,
59	    summary="Create Knowledge Box Entities Group",
60	    tags=["Knowledge Box Services"],
61	    openapi_extra={"x-operation_order": 1},
62	)
63	@requires(NucliaDBRoles.WRITER)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/services.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
167	
168	@api.post(
169	    f"/{KB_PREFIX}/{{kbid}}/labelset/{{labelset}}",
170	    status_code=200,
171	    summary="Set Knowledge Box Labels",
172	    tags=["Knowledge Box Services"],
173	    openapi_extra={"x-operation_order": 1},
174	)
175	@requires(NucliaDBRoles.WRITER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/services.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
298	
299	        if await datamanagers.search_configurations.get(txn, kbid=kbid, name=config_name) is not None:
300	            raise HTTPException(status_code=409, detail="Search configuration already exists")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/services.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
283	
284	@api.post(
285	    f"/{KB_PREFIX}/{{kbid}}/search_configurations/{{config_name}}",
286	    status_code=201,
287	    summary="Create search configuration",
288	    tags=["Knowledge Box Services"],
289	)
290	@requires(NucliaDBRoles.WRITER)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/services.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
324	
325	        if await datamanagers.search_configurations.get(txn, kbid=kbid, name=config_name) is None:
326	            raise HTTPException(status_code=404, detail="Search configuration does not exist")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/services.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
348	
349	        if await datamanagers.search_configurations.get(txn, kbid=kbid, name=config_name) is None:
350	            raise HTTPException(status_code=404, detail="Search configuration does not exist")

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
151	    rid = await get_rid_from_slug_or_raise_error(kbid, rslug)
152	    return await _tus_post(
153	        request, kbid, item, path_rid=rid, field_id=field, extract_strategy=x_extract_strategy
154	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
134	
135	@api.post(
136	    f"/{KB_PREFIX}/{{kbid}}/{RSLUG_PREFIX}/{{rslug}}/file/{{field}}/{TUSUPLOAD}",
137	    tags=["Resource field TUS uploads"],
138	    summary="Create new upload on a Resource (by slug)",
139	    openapi_extra={"x-operation-order": 1},
140	)
141	@requires_one([NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
172	) -> Response:
173	    return await _tus_post(
174	        request, kbid, item, path_rid=path_rid, field_id=field, extract_strategy=x_extract_strategy
175	    )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
156	
157	@api.post(
158	    f"/{KB_PREFIX}/{{kbid}}/{RESOURCE_PREFIX}/{{path_rid}}/file/{{field}}/{TUSUPLOAD}",
159	    tags=["Resource field TUS uploads"],
160	    summary="Create new upload on a Resource (by id)",
161	    openapi_extra={"x-operation-order": 1},
162	)
163	@requires_one([NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
191	) -> Response:
192	    return await _tus_post(request, kbid, item, extract_strategy=x_extract_strategy)
193	

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:178
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
177	
178	@api.post(
179	    f"/{KB_PREFIX}/{{kbid}}/{TUSUPLOAD}",
180	    tags=["Knowledge Box TUS uploads"],
181	    summary="Create new upload on a Knowledge Box",
182	    openapi_extra={"x-operation-order": 1},
183	)
184	@requires_one([NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
225	    deferred_length = False
226	    if request.headers.get("upload-defer-length") == "1":
227	        deferred_length = True

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
246	
247	    path, rid, field = await validate_field_upload(kbid, path_rid, field_id, metadata.get("md5"))
248	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	    # This only happens in tus-java-client, redirect this POST to a PATCH
260	    if request.headers.get("x-http-method-override") == "PATCH":
261	        return await patch(request, upload_id)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	    if item is None:
272	        request_content_type = request.headers.get("content-type")
273	    if request_content_type is None:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
287	    if implies_resource_creation:
288	        creation_payload = base64.b64encode(pickle.dumps(item)).decode()
289	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:288
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
287	    if implies_resource_creation:
288	        creation_payload = base64.b64encode(pickle.dumps(item)).decode()
289	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
394	    }
395	    if dm.get("size"):
396	        tus_head_response["Upload-Length"] = str(dm.get("size"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
395	    if dm.get("size"):
396	        tus_head_response["Upload-Length"] = str(dm.get("size"))
397	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
506	    if "upload-length" in request.headers:
507	        if dm.get("deferred_length"):
508	            size = int(request.headers["upload-length"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
540	
541	    upload_finished = dm.get("size") is not None and dm.offset >= dm.get("size")
542	    if upload_finished:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
540	
541	    upload_finished = dm.get("size") is not None and dm.offset >= dm.get("size")
542	    if upload_finished:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:543
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
542	    if upload_finished:
543	        rid = dm.get("rid", rid)
544	        if rid is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:546
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
545	            raise AttributeError()
546	        field = dm.get("field", field)
547	        if field is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
553	
554	        item_payload = dm.get("item")
555	        creation_payload = None

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:559
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
558	                item_payload = item_payload.encode()
559	            creation_payload = pickle.loads(base64.b64decode(item_payload))
560	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:559
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
558	                item_payload = item_payload.encode()
559	            creation_payload = pickle.loads(base64.b64decode(item_payload))
560	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
560	
561	        content_type = dm.get("metadata", {}).get("content_type")
562	        if content_type is not None and not content_types.valid(content_type):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
560	
561	        content_type = dm.get("metadata", {}).get("content_type")
562	        if content_type is not None and not content_types.valid(content_type):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
569	            seqid = await store_file_on_nuclia_db(
570	                size=dm.get("size"),
571	                content_type=content_type,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
571	                content_type=content_type,
572	                override_resource_title=dm.get("metadata", {}).get("implies_resource_creation", False),
573	                filename=dm.get("metadata", {}).get("filename"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:572
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
571	                content_type=content_type,
572	                override_resource_title=dm.get("metadata", {}).get("implies_resource_creation", False),
573	                filename=dm.get("metadata", {}).get("filename"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
572	                override_resource_title=dm.get("metadata", {}).get("implies_resource_creation", False),
573	                filename=dm.get("metadata", {}).get("filename"),
574	                password=dm.get("metadata", {}).get("password"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
572	                override_resource_title=dm.get("metadata", {}).get("implies_resource_creation", False),
573	                filename=dm.get("metadata", {}).get("filename"),
574	                password=dm.get("metadata", {}).get("password"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
573	                filename=dm.get("metadata", {}).get("filename"),
574	                password=dm.get("metadata", {}).get("password"),
575	                language=dm.get("metadata", {}).get("language"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
573	                filename=dm.get("metadata", {}).get("filename"),
574	                password=dm.get("metadata", {}).get("password"),
575	                language=dm.get("metadata", {}).get("language"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
574	                password=dm.get("metadata", {}).get("password"),
575	                language=dm.get("metadata", {}).get("language"),
576	                md5=dm.get("metadata", {}).get("md5"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:575
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
574	                password=dm.get("metadata", {}).get("password"),
575	                language=dm.get("metadata", {}).get("language"),
576	                md5=dm.get("metadata", {}).get("md5"),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
575	                language=dm.get("metadata", {}).get("language"),
576	                md5=dm.get("metadata", {}).get("md5"),
577	                source=storage_manager.storage.source,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
575	                language=dm.get("metadata", {}).get("language"),
576	                md5=dm.get("metadata", {}).get("md5"),
577	                source=storage_manager.storage.source,

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
584	                item=creation_payload,
585	                extract_strategy=dm.get("extract_strategy") or None,
586	            )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:605
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
604	
605	@api.post(
606	    f"/{KB_PREFIX}/{{kbid}}/{RSLUG_PREFIX}/{{rslug}}/file/{{field}}/{UPLOAD}",
607	    status_code=201,
608	    tags=["Resource fields"],
609	    summary="Upload binary file on a Resource (by slug)",
610	    description="Upload a file as a field on an existing resource, if the field exists will return a conflict (419)",
611	)
612	@requires_one([NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
638	
639	@api.post(
640	    f"/{KB_PREFIX}/{{kbid}}/{RESOURCE_PREFIX}/{{path_rid}}/file/{{field}}/{UPLOAD}",
641	    status_code=201,
642	    tags=["Resource fields"],
643	    summary="Upload binary file on a Resource (by id)",
644	    description="Upload a file as a field on an existing resource, if the field exists will return a conflict (419)",
645	)
646	@requires_one([NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:672
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
671	
672	@api.post(
673	    f"/{KB_PREFIX}/{{kbid}}/{UPLOAD}",
674	    status_code=201,
675	    tags=["Knowledge Boxes"],
676	    summary="Upload binary file on a Knowledge Box",
677	    description="Upload a file onto a Knowledge Box, field id will be file and rid will be autogenerated. ",
678	)
679	@requires_one([NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:740
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
739	    if x_filename is not None:
740	        filename = maybe_b64decode(x_filename)
741	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:747
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
746	    # - if not set, we will try to guess it from the filename and default to a generic binary content type otherwise
747	    content_type = request.headers.get("content-type")
748	    if content_type is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:761
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
760	        upload_file_id=f"{upload_id}",
761	        size=request.headers.get("content-length", None),
762	        metadata=metadata,

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:771
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
770	        async for chunk in request.stream():
771	            buf.write(chunk)
772	            while buf.tell() > storage_manager.chunk_size:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:774
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
773	                buf.seek(0)
774	                data = buf.read(storage_manager.chunk_size)
775	                if len(data):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:777
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
776	                    yield data
777	                old_data = buf.read()
778	                buf = BytesIO()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:779
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
778	                buf = BytesIO()
779	                buf.write(old_data)
780	        buf.seek(0)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:781
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
780	        buf.seek(0)
781	        data = buf.read()
782	        if len(data):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:878
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
877	        partition=partition,
878	        userid=request.headers.get("X-NUCLIADB-USER", ""),
879	    )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:989
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
988	    try:
989	        return base64.b64decode(some_string).decode()
990	    except ValueError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/upload.py:989
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
988	    try:
989	        return base64.b64decode(some_string).decode()
990	    except ValueError:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/api/v1/vectorsets.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
40	
41	@api.post(
42	    f"/{KB_PREFIX}/{{kbid}}/vectorsets/{{vectorset_id}}",
43	    status_code=201,
44	    summary="Add a vector set to Knowledge Box",
45	    tags=["VectorSets"],
46	    # TODO: remove when the feature is mature
47	    include_in_schema=False,
48	)
49	@requires_one([NucliaDBRoles.MANAGER, NucliaDBRoles.WRITER])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/resource/audit.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
27	def parse_audit(audit: Audit, request: Request):
28	    audit.user = request.headers.get("X-NUCLIADB-USER", "")
29	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/resource/audit.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
31	
32	    agents = request.headers.get("USER-AGENT", "").lower()
33	    if "dashboard" in agents:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/resource/audit.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
39	
40	    audit.origin = request.headers.get("X-FORWARDED-FOR", "")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
54	        if self._data is None:
55	            data = DATA.get(self.key)
56	            if not data:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	            # someone else
66	            last_activity: Optional[int] = self._data.get("last_activity")
67	            if last_activity and (time.time() - last_activity) < self._ttl:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
67	            if last_activity and (time.time() - last_activity) < self._ttl:
68	                if request.headers and request.headers.get("tus-override-upload", "0") != "1":
69	                    raise HTTPPreconditionFailed(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
98	    def metadata(self):
99	        return self._data.get("metadata", {})
100	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
102	    def content_type(self):
103	        return self.metadata.get("content_type")
104	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
109	            return default
110	        size = self._data.get("size")
111	        if size is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
116	    def offset(self):
117	        return self._data.get("offset", 0)
118	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:121
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
120	    def filename(self):
121	        return self.metadata.get("filename", 0)
122	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
125	            return default
126	        return self._data.get(name, default)
127	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/dm.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
158	        if self._data is None:
159	            data = await self.redis.get(self.key)
160	            if not data:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
58	
59	SCOPES = ["https://www.googleapis.com/auth/devstorage.read_write"]
60	MAX_RETRIES = 5

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
83	    project: str
84	    executor = ThreadPoolExecutor(max_workers=5)
85	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
108	        if self.session is not None:
109	            await self.session.close()
110	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
132	            with open(self.json_credentials_file, "w") as file:
133	                file.write(base64.b64decode(self.json_credentials).decode("utf-8"))
134	            self._credentials = ServiceAccountCredentials.from_json_keyfile_name(

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
132	            with open(self.json_credentials_file, "w") as file:
133	                file.write(base64.b64decode(self.json_credentials).decode("utf-8"))
134	            self._credentials = ServiceAccountCredentials.from_json_keyfile_name(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
132	            with open(self.json_credentials_file, "w") as file:
133	                file.write(base64.b64decode(self.json_credentials).decode("utf-8"))
134	            self._credentials = ServiceAccountCredentials.from_json_keyfile_name(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:133
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
132	            with open(self.json_credentials_file, "w") as file:
133	                file.write(base64.b64decode(self.json_credentials).decode("utf-8"))
134	            self._credentials = ServiceAccountCredentials.from_json_keyfile_name(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
154	        url = f"{self.object_base_url}/{bucket_name}/o"
155	        async with self.session.get(
156	            url,
157	            headers=headers,
158	        ) as resp:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:172
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
171	        labels = deepcopy(self.bucket_labels)
172	        async with self.session.post(
173	            url,
174	            headers=headers,
175	            json={
176	                "name": bucket_name,
177	                "location": self.location,
178	                "labels": labels,
179	                "iamConfiguration.uniformBucketLevelAccess.enabled": True,
180	            },

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:205
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
204	
205	        upload_file_id = dm.get("upload_file_id")
206	        if upload_file_id is not None:

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:207
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
206	        if upload_file_id is not None:
207	            await self.delete_upload(upload_file_id, kbid)
208	        else:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:244
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
243	
244	        async with self.storage.session.post(
245	            init_url,
246	            headers=headers,
247	            data=metadata,
248	        ) as call:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
298	        )
299	        resumable_uri = dm.get("resumable_uri")
300	        if resumable_uri is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
362	            }
363	            resumable_uri = dm.get("resumable_uri")
364	            async with self.storage.session.put(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/gcs.py:375
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
374	                    raise GoogleCloudException(f"{call.status}: {text}")
375	        path = dm.get("path")
376	        await dm.finish()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/local.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
59	        async with aiofiles.open(init_url, "wb+") as aio_fi:
60	            await aio_fi.write(b"")
61	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/local.py:69
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
68	        async with aiofiles.open(metadata_init_url, "w+") as resp:
69	            await resp.write(json.dumps(metadata))
70	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/local.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	            async for chunk in iterable:
79	                await aio_fi.write(chunk)
80	                size = len(chunk)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/s3.py:62
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
61	            upload_file_id = dm.get("upload_file_id")
62	            await self.storage._s3aioclient.abort_multipart_upload(
63	                Bucket=self.storage.bucket, Key=upload_file_id, UploadId=mpu["UploadId"]
64	            )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/s3.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
74	        custom_metadata: dict[str, str] = {
75	            "base64_filename": base64.b64encode((dm.filename or "").encode()).decode(),
76	            "content_type": dm.content_type or "",

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/s3.py:75
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
74	        custom_metadata: dict[str, str] = {
75	            "base64_filename": base64.b64encode((dm.filename or "").encode()).decode(),
76	            "content_type": dm.content_type or "",

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/s3.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
90	    async def _create_multipart(self, path, bucket, custom_metadata: dict[str, str]):
91	        return await self.storage._s3aioclient.create_multipart_upload(
92	            Bucket=bucket, Key=path, Metadata=custom_metadata
93	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/s3.py:126
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
125	        if dm.get("mpu") is not None:
126	            await self._complete_multipart_upload(dm)
127	        await dm.finish()

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/s3.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
138	            await dm.update(multipart=multipart, block=dm.get("block") + 1)
139	        await self.storage._s3aioclient.complete_multipart_upload(
140	            Bucket=dm.get("bucket"),
141	            Key=dm.get("path"),
142	            UploadId=dm.get("mpu")["UploadId"],
143	            MultipartUpload=dm.get("multipart"),
144	        )

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/utils.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
60	            try:
61	                value = base64.b64decode(value)
62	                if isinstance(value, bytes):

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/tus/utils.py:61
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
60	            try:
61	                value = base64.b64decode(value)
62	                if isinstance(value, bytes):

--------------------------------------------------

Code scanned:
	Total lines of code: 39225
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 43.0
		High: 192.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 212.0
		High: 23.0
Files skipped (0):
