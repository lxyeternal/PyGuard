Run started:2025-04-12 12:09:28.403683

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	        # for the list of Azure login ids and active directory endpoint in Azure environments
27	        active_directory_endpoint = "https://login.microsoftonline.com/"
28	        aad_url = f"{active_directory_endpoint}/{azure_tenant_id}/oauth2/token"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
28	        aad_url = f"{active_directory_endpoint}/{azure_tenant_id}/oauth2/token"
29	        aad_response = RequestUtils.issue_request(
30	            url=aad_url,
31	            method="POST",
32	            headers={
33	                "Content-Type": "application/x-www-form-urlencoded"
34	            },
35	            data={
36	                "grant_type": "client_credentials",
37	                "resource": azure_login_id,
38	                "client_id": service_principal_client_id,
39	                "client_secret": service_principal_client_secret
40	            }

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
47	        # If authorization_details is specified, we need to exchange the AAD token for an OAuth token
48	        return RequestUtils.issue_request(
49	            url=workspace_url + "/oidc/v1/token",
50	            headers={
51	                "Content-Type": "application/x-www-form-urlencoded",
52	                "Accept": "*/*",
53	            },
54	            method="POST",
55	            data={
56	                "grant_type": "urn:ietf:params:oauth:grant-type:jwt-bearer",
57	                "assertion": aad_token,
58	                "authorization_details": authorization_details
59	            }

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:77
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
76	        }
77	        response = RequestUtils.issue_request(
78	            url=url,
79	            auth=(service_principal_client_id, service_principal_client_secret),
80	            headers=headers,
81	            method="POST",
82	            data=data
83	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
116	        headers["X-Databricks-Python-SDK-Version"] = VERSION
117	        response = RequestUtils.session.request(
118	            url=url,
119	            headers=headers,
120	            method=method,
121	            params=params,
122	            json=json,
123	            verify=verify,
124	            auth=auth,
125	            data=data
126	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	    if is_in_model_serving_environment():
153	        host = os.environ.get("DATABRICKS_MODEL_SERVING_HOST_URL") or os.environ.get(
154	            "DB_MODEL_SERVING_HOST_URL"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:153
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
152	    if is_in_model_serving_environment():
153	        host = os.environ.get("DATABRICKS_MODEL_SERVING_HOST_URL") or os.environ.get(
154	            "DB_MODEL_SERVING_HOST_URL"
155	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
156	         
157	        main_thread = threading.main_thread()
158	        thread_data = main_thread.__dict__

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
172	        """
173	        is_in_model_serving_env = (os.environ.get("IS_IN_DB_MODEL_SERVING_ENV")
174	                                   or os.environ.get("IS_IN_DATABRICKS_MODEL_SERVING_ENV") or "false")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/databricks_vectorsearch-0.55-py3-none-any/databricks/vector_search/utils.py:174
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
173	        is_in_model_serving_env = (os.environ.get("IS_IN_DB_MODEL_SERVING_ENV")
174	                                   or os.environ.get("IS_IN_DATABRICKS_MODEL_SERVING_ENV") or "false")
175	        return is_in_model_serving_env == "true"

--------------------------------------------------

Code scanned:
	Total lines of code: 968
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 1.0
		High: 9.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 0.0
Files skipped (0):
