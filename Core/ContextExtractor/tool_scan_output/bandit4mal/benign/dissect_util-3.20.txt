Run started:2025-04-12 13:46:21.548904

Test results:
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/cpio.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
225	    kwargs.setdefault("format", FORMAT_CPIO_UNKNOWN)
226	    return tarfile.open(*args, **kwargs, tarinfo=CpioInfo)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/feature.py:68
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
67	                        f"Set FLAG '{flag}' in {DISSECT_FEATURES_ENV} to enable.",
68	                        "See https://docs.dissect.tools/en/latest/advanced/flags.html",
69	                    ]
70	                )
71	            )
72	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
58	
59	        self._buf = self._read(self._pos_align, self.align)
60	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
103	
104	                r.append(self._read(self._pos_align, -1))
105	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	                read_len = count * align
135	                r.append(self._read(self._pos, read_len))
136	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
151	        """
152	        buf = self.read(len(b))
153	        length = len(buf)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
162	        """Read until end of stream."""
163	        return self.read()
164	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:168
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
167	        self.seek(offset)
168	        return self.read(length)
169	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:209
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
208	        self._fh.seek(self.offset + offset)
209	        return self._fh.read(read_length)
210	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:245
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
244	        self._fh.seek(self.offset + offset)
245	        return self._fh.read(read_length)
246	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
336	            run_fh.seek(run_file_offset + run_pos)
337	            result.append(run_fh.read(read_count))
338	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:430
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
429	                self._fh.seek(run_block_offset * self.block_size + run_pos)
430	                r.append(self._fh.read(read_count))
431	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
516	                    prev_overlay_data.seek(offset_in_prev_overlay)
517	                    result.append(prev_overlay_data.read(prev_overlay_read_size))
518	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:532
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
531	                        fh.seek(offset)
532	                        result.append(fh.read(gap_to_next_overlay))
533	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:537
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
536	                    next_overlay_data.seek(0)
537	                    result.append(next_overlay_data.read(next_overlay_read_size))
538	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:544
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
543	                    fh.seek(offset)
544	                    result.append(fh.read(length))
545	                    break

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
548	                fh.seek(offset)
549	                result.append(fh.read(length))
550	                break

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
597	        if self._zlib_prepend_offset is None:
598	            return self._fh.read(length)
599	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
606	        self._zlib_prepend_offset = None
607	        return self._zlib_prepend[offset:] + self._fh.read(length - len(self._zlib_prepend) + offset)
608	

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/dissect/util/stream.py:616
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
615	            buf = self._read_fh(io.DEFAULT_BUFFER_SIZE)
616	            decompressed = self._zlib.decompress(buf, length)
617	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/tests/test_cpio.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
54	    # With explicit format
55	    archive = cpio.open(absolute_path(path), format=format)
56	    _verify_archive(archive)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/tests/test_cpio.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
58	    # Autodetect format
59	    archive = cpio.open(absolute_path(path))
60	    _verify_archive(archive)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/tests/test_plist.py:83
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
82	            # 11
83	            "http://base",
84	            # 12
85	            "relative",
86	            # 13
87	            {
88	                "$class": UID(14),
89	                "NS.base": UID(0),
90	                "NS.relative": UID(12),
91	            },
92	            # 14
93	            {
94	                "$classname": "NSURL",
95	                "$classes": ["NSURL", "NSObject"],
96	            },
97	            # 15
98	            {
99	                "$class": UID(16),
100	                "NS.objects": [1, UID(3)],
101	            },
102	            # 16
103	            {
104	                "$classname": "NSMutableArray",
105	                "$classes": ["NSMutableArray", "NSArray", "NSObject"],
106	            },
107	            # 17
108	            {
109	                "$class": UID(18),
110	                "NS.objects": [1, UID(3)],
111	            },
112	            # 18
113	            {
114	                "$classname": "NSMutableSet",
115	                "$classes": ["NSMutableSet", "NSSet", "NSObject"],
116	            },
117	            # 19
118	            {
119	                "$class": UID(21),
120	                "NS.keys": [UID(20)],
121	                "NS.objects": [UID(3)],
122	            },
123	            # 20
124	            "DictKey",
125	            # 21
126	            {
127	                "$classname": "NSMutableDictionary",
128	                "$classes": ["NSMutableDictionary", "NSDictionary", "NSObject"],
129	            },
130	        ],
131	    }
132	    with patch("plistlib.load", return_value=data):
133	        obj = NSKeyedArchiver(None)
134	        assert "root" in obj.top
135	
136	        root = obj["root"]
137	        assert root._classname == "TestObject"
138	        assert root.Null is None
139	        assert root.Integer == 1337
140	        assert root.String == "TestString"
141	        assert root.Bytes == b"bytes"
142	        assert root.Data == b"\x00" * 4
143	        assert root.UUID == uuid.UUID("00000000-0000-0000-0000-000000000000")  # noqa: SIM300
144	        assert root.Date == datetime.datetime(2021, 12, 10, 13, 55, 52, 84823, tzinfo=datetime.timezone.utc)
145	        assert root.URL == "http://base/relative"
146	        assert root.URLBaseless == "relative"
147	        assert root.Array == root.Set == [1, "TestString"]
148	        assert list(root.Dict.items()) == [("DictKey", "TestString")]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dissect_util-3.20/dissect_util-3.20/tests/test_plist.py:145
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
144	        assert root.Date == datetime.datetime(2021, 12, 10, 13, 55, 52, 84823, tzinfo=datetime.timezone.utc)
145	        assert root.URL == "http://base/relative"
146	        assert root.URLBaseless == "relative"

--------------------------------------------------

Code scanned:
	Total lines of code: 2637
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 3.0
		High: 21.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 0.0
Files skipped (0):
