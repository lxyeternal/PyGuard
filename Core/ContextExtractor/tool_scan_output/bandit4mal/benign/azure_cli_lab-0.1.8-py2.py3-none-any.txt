Run started:2025-04-12 11:08:16.792743

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_lab-0.1.8-py2.py3-none-any/azure/cli/command_modules/lab/_help.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	            """
18	helps['lab vm create'] = """
19	            type: command
20	            short-summary: Create a VM in a lab.
21	            parameters:
22	                - name: --name -n
23	                  short-summary: Name of the virtual machine.
24	                - name: --lab-name
25	                  short-summary: Name of the lab.
26	                - name: --notes
27	                  short-summary: Notes for the virtual machine.
28	                - name: --image
29	                  short-summary: The name of the operating system image (gallery image name or custom image name/ID).
30	                  long-summary:  Use `az lab gallery-image list` for available gallery images or `az lab custom-image list` for available custom images.
31	                - name: --image-type
32	                  short-summary: 'Type of the image. Allowed values are: gallery, custom'
33	                - name: --formula
34	                  short-summary: Name of the formula. Use `az lab formula list` for available formulas.
35	                  long-summary: >
36	                    Use `az lab formula` with the `--export-artifacts` flag to export and update artifacts, then pass
37	                    the results via the `--artifacts` argument.
38	                - name: --size
39	                  short-summary: 'The size of the VM to be created. See https://azure.microsoft.com/en-us/pricing/details/virtual-machines/ for size info.'
40	                - name: --admin-username
41	                  short-summary: Username for the VM admin.
42	                - name: --admin-password
43	                  short-summary: Password for the VM admin.
44	                - name: --ssh-key
45	                  short-summary: The SSH public key or public key file path. Use `--generate-ssh-keys` to generate SSH keys.
46	                - name: --authentication-type
47	                  short-summary: 'Type of authentication allowed for the VM. Allowed values are: password, ssh.'
48	                - name: --saved-secret
49	                  short-summary: Name of the saved secret to be used for authentication.
50	                  long-summary: When this value is provided, it is used in the place of other authentication methods.
51	                - name: --vnet-name
52	                  short-summary: Name of the virtual network to add the VM to.
53	                - name: --subnet
54	                  short-summary: Name of the subnet to add the VM to.
55	                - name: --ip-configuration
56	                  short-summary: 'Type of IP configuration to use for the VM. Allowed values are: shared, public, private.'
57	                  long-summary: If omitted, will be selected based on the VM's vnet.
58	                - name: --artifacts
59	                  short-summary: JSON encoded array of artifacts to be applied. Use '@{file}' to load from a file.
60	                - name: --tags
61	                  short-summary: Space-separated tags in `key[=value]` format.
62	                  long-summary: Tags may be cleared by assigning the empty value "" to them.
63	                - name: --allow-claim
64	                  short-summary: Flag indicating if the VM should be created as claimable.
65	                - name: --disk-type
66	                  short-summary: Storage type to use for virtual machine.
67	                - name: --expiration-date
68	                  short-summary: The expiration date in UTC(YYYY-mm-dd) for the VM.
69	                - name: --generate-ssh-keys
70	                  short-summary: Generate SSH public and private key files if missing.
71	            examples:
72	                - name: Create a VM in the lab from a gallery image.
73	                  text: >
74	                    az lab vm create --lab-name {LabName} -g {ResourceGroup} --name {VMName} --image "Ubuntu Server 16.04 LTS" --image-type gallery --size Standard_DS1_v2
75	                - name: Create a VM in the lab from a gallery image with SSH authentication.
76	                  text: >
77	                    az lab vm create --lab-name {LabName} -g {ResourceGroup} --name {VMName} --image "Ubuntu Server 16.04 LTS" --image-type gallery --size Standard_DS1_v2 --authentication-type ssh
78	                - name: Create a claimable VM in the lab from a gallery image with password authentication.
79	                  text: >
80	                    az lab vm create --lab-name {LabName} -g {ResourceGroup} --name {VMName} --image "Ubuntu Server 16.04 LTS" --image-type gallery --size Standard_DS1_v2 --allow-claim
81	                - name: Create a windows VM in the lab from a gallery image with password authentication.
82	                  text: >
83	                    az lab vm create --lab-name {LabName} -g {ResourceGroup} --name {VMName} --image "Windows Server 2008 R2 SP1" --image-type gallery --size Standard_DS1_v2
84	                - name: Create a VM in the lab from a custom image.
85	                  text: >
86	                    az lab vm create --lab-name {LabName} -g {ResourceGroup} --name {VMName} --image "jenkins_custom" --image-type custom --size Standard_DS1_v2
87	                - name: Create a VM in the lab with a public IP.
88	                  text: >
89	                    az lab vm create --lab-name {LabName} -g {ResourceGroup} --name {VMName} --image "Ubuntu Server 16.04 LTS" --image-type gallery --size Standard_DS1_v2 --ip-configuration public
90	                - name: Create a VM from a formula.
91	                  text: >
92	                    az lab vm create --lab-name {LabName} -g {ResourceGroup} --name {VMName} --formula MyFormula --artifacts '@artifacts.json'
93	            """
94	helps['lab vm list'] = """

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_lab-0.1.8-py2.py3-none-any/azure/cli/command_modules/lab/validators.py:469
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
468	        with open(string_or_file, 'r') as f:
469	            content = f.read()
470	    elif not _is_valid_ssh_rsa_public_key(content):

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_lab-0.1.8-py2.py3-none-any/azure/cli/command_modules/lab/validators.py:495
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
494	        os.makedirs(ssh_dir)
495	        os.chmod(ssh_dir, 0o700)
496	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_lab-0.1.8-py2.py3-none-any/azure/cli/command_modules/lab/validators.py:495
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
494	        os.makedirs(ssh_dir)
495	        os.chmod(ssh_dir, 0o700)
496	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_lab-0.1.8-py2.py3-none-any/azure/cli/command_modules/lab/validators.py:499
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
498	    key.write_private_key_file(private_key_filepath)
499	    os.chmod(private_key_filepath, 0o600)
500	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_lab-0.1.8-py2.py3-none-any/azure/cli/command_modules/lab/validators.py:499
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
498	    key.write_private_key_file(private_key_filepath)
499	    os.chmod(private_key_filepath, 0o600)
500	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_lab-0.1.8-py2.py3-none-any/azure/cli/command_modules/lab/validators.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
502	        public_key = '%s %s' % (key.get_name(), key.get_base64())
503	        public_key_file.write(public_key)
504	    os.chmod(public_key_filepath, 0o644)

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_lab-0.1.8-py2.py3-none-any/azure/cli/command_modules/lab/validators.py:504
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
503	        public_key_file.write(public_key)
504	    os.chmod(public_key_filepath, 0o644)
505	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/azure_cli_lab-0.1.8-py2.py3-none-any/azure/cli/command_modules/lab/validators.py:504
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
503	        public_key_file.write(public_key)
504	    os.chmod(public_key_filepath, 0o644)
505	

--------------------------------------------------

Code scanned:
	Total lines of code: 1082
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 5.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 3.0
Files skipped (0):
