Run started:2025-04-12 19:58:33.625837

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/cli.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
142	        f.seek(human_readable_to_bytes(size) - 1)
143	        f.write(b"\0")
144	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/cli.py:152
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
151	    with file.open("wb") as f:
152	        f.write(os.urandom(human_readable_to_bytes(size)))
153	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/cli.py:204
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
203	def from_shortoid(odb: HashFileDB, oid: str) -> str:
204	    oid = oid if oid != "-" else sys.stdin.read().strip()
205	    try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/cli.py:239
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
238	    if fs_path == "-":
239	        fs_path = sys.stdin.read().strip()
240	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/db/local.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
39	        super().move(from_info, to_info)
40	        os.chmod(to_info, self._file_mode)
41	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/db/local.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
39	        super().move(from_info, to_info)
40	        os.chmod(to_info, self._file_mode)
41	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/db/local.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
103	
104	        os.chmod(path, self._file_mode)
105	

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/db/local.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
103	
104	        os.chmod(path, self._file_mode)
105	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/db/local.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
116	        try:
117	            os.chmod(path, self.CACHE_MODE)
118	        except OSError:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/db/local.py:117
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
116	        try:
117	            os.chmod(path, self.CACHE_MODE)
118	        except OSError:

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/db/local.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
143	        try:
144	            os.chmod(path, mode)
145	        except OSError:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/db/local.py:144
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
143	        try:
144	            os.chmod(path, mode)
145	        except OSError:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/meta.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
51	
52	            etag = base64.b64decode(info["etag"]).hex()
53	        elif (

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/hashfile/meta.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
51	
52	            etag = base64.b64decode(info["etag"]).hex()
53	        elif (

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/index/checkout.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
182	        try:
183	            os.chmod(entry_path, mode)
184	        except OSError:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/src/dvc_data/index/checkout.py:183
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
182	        try:
183	            os.chmod(entry_path, mode)
184	        except OSError:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/tests/benchmarks/test_checkout.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
44	            try:
45	                shutil.rmtree(path)
46	            except FileNotFoundError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/tests/hashfile/test_hash_stream.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
19	
20	        assert stream_reader.read(2) == b"fo"
21	        assert stream_reader.tell() == 2

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/tests/hashfile/test_hash_stream.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
22	
23	        assert stream_reader.read(1) == b"o"
24	        assert stream_reader.tell() == 3

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/tests/hashfile/test_hash_stream.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
39	        while True:
40	            chunk = stream_reader.read(16)
41	            total_read += len(chunk)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/tests/hashfile/test_hash_stream.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
65	        stream_reader = HashStreamFile(fobj)
66	        stream_reader.read(chunk_size)
67	

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/dvc_data-3.16.9/dvc_data-3.16.9/tests/index/conftest.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
11	        path = tmp_upath_factory.mktemp()
12	        fs = as_filesystem(path.fs)
13	        return HashFileDB(fs, os.fspath(path))

--------------------------------------------------

Code scanned:
	Total lines of code: 7886
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 16.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 16.0
		High: 6.0
Files skipped (0):
