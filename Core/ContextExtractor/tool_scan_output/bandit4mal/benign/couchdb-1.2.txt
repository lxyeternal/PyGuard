Run started:2025-04-12 15:02:32.719613

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/client.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	
42	DEFAULT_BASE_URL = os.environ.get('COUCHDB_URL', 'http://localhost:5984/')
43	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/client.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
611	
612	        _, _, data = self.resource._request('COPY', src,
613	                                            headers={'Destination': dest})
614	        data = json.decode(data.read().decode('utf-8'))

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/client.py:614
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
613	                                            headers={'Destination': dest})
614	        data = json.decode(data.read().decode('utf-8'))
615	        return data['rev']

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
71	                message_body = None
72	            self.send(msg)
73	            if message_body is not None:

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
71	                message_body = None
72	            self.send(msg)
73	            if message_body is not None:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
73	            if message_body is not None:
74	                self.send(message_body)
75	

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
73	            if message_body is not None:
74	                self.send(message_body)
75	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
141	        if not self.chunked:
142	            self.close()
143	        else:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:144
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
143	        else:
144	            self.resp.close()
145	            if self.conn:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
154	                # and require a layering violation.
155	                self.conn.close()
156	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:158
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
157	    def read(self, size=None):
158	        bytes = self.resp.read(size)
159	        if size is None or len(bytes) < size:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:160
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
159	        if size is None or len(bytes) < size:
160	            self.close()
161	        return bytes

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
168	        while not self.resp.isclosed():
169	            chunk = self.resp.read(CHUNK_SIZE)
170	            if not chunk:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
170	            if not chunk:
171	                self.resp.close()
172	        if self.conn:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:185
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
184	            if not chunksz:
185	                self.resp.fp.read(2) #crlf
186	                self.resp.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:186
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
185	                self.resp.fp.read(2) #crlf
186	                self.resp.close()
187	                self._release_conn()

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
189	
190	            chunk = self.resp.fp.read(chunksz)
191	            for ln in chunk.splitlines(True):

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:202
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
201	
202	            self.resp.fp.read(2) #crlf
203	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:300
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
299	                try:
300	                    return _try_request()
301	                except socket.error as e:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
311	                        time.sleep(delay)
312	                        conn.close()
313	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:316
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
315	            try:
316	                conn.putrequest(method, path_query, skip_accept_encoding=True)
317	                for header in headers:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
329	                        while 1:
330	                            chunk = body.read(CHUNK_SIZE)
331	                            if not chunk:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
335	                            status = ('%x\r\n' % len(chunk)).encode('utf-8')
336	                            conn.send(status + chunk + b'\r\n')
337	                        conn.send(b'0\r\n\r\n')

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
335	                            status = ('%x\r\n' % len(chunk)).encode('utf-8')
336	                            conn.send(status + chunk + b'\r\n')
337	                        conn.send(b'0\r\n\r\n')

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
336	                            conn.send(status + chunk + b'\r\n')
337	                        conn.send(b'0\r\n\r\n')
338	                return conn.getresponse()

--------------------------------------------------
>> Issue: [B831:send] ssl.SSLSocket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b831_send.html
336	                            conn.send(status + chunk + b'\r\n')
337	                        conn.send(b'0\r\n\r\n')
338	                return conn.getresponse()

--------------------------------------------------
>> Issue: [B826:getresponse] http.client.HTTPConnection.getresponse
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:338
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b826_getresponse.html
337	                        conn.send(b'0\r\n\r\n')
338	                return conn.getresponse()
339	            except BadStatusLine as e:

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
353	        if status == 304 and method in ('GET', 'HEAD'):
354	            resp.read()
355	            self.connection_pool.release(url, conn)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:366
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
365	                method in ('GET', 'HEAD') and status in (301, 302, 307):
366	            resp.read()
367	            self.connection_pool.release(url, conn)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
382	                method = 'GET'
383	            return self.request(method, location, body, headers,
384	                                num_redirects=num_redirects + 1)
385	

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:393
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
392	                status < 200 or status in (204, 304):
393	            resp.read()
394	            self.connection_pool.release(url, conn)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
397	        elif int(resp.getheader('content-length', sys.maxsize)) < CHUNK_SIZE:
398	            data = resp.read()
399	            self.connection_pool.release(url, conn)

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:414
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
413	            elif method != 'HEAD':
414	                error = resp.read()
415	                self.connection_pool.release(url, conn)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:515
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
514	            conn = cls(host, timeout=self.timeout)
515	            conn.connect()
516	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:530
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
529	            for conn in conns:
530	                conn.close()
531	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:551
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
550	    def delete(self, path=None, headers=None, **params):
551	        return self._request('DELETE', path, headers=headers, **params)
552	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
553	    def get(self, path=None, headers=None, **params):
554	        return self._request('GET', path, headers=headers, **params)
555	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:557
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
556	    def head(self, path=None, headers=None, **params):
557	        return self._request('HEAD', path, headers=headers, **params)
558	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:560
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
559	    def post(self, path=None, body=None, headers=None, **params):
560	        return self._request('POST', path, body=body, headers=headers,
561	                             **params)
562	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:564
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
563	    def put(self, path=None, body=None, headers=None, **params):
564	        return self._request('PUT', path, body=body, headers=headers, **params)
565	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
589	            url = urljoin(self.url, **params)
590	        return self.session.request(method, url, body=body,
591	                                    headers=all_headers,
592	                                    credentials=self.credentials)
593	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:595
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
594	    def _request_json(self, method, path=None, body=None, headers=None, **params):
595	        status, headers, data = self._request(method, path, body=body,
596	                                              headers=headers, **params)
597	        if 'application/json' in headers.get('content-type', ''):

--------------------------------------------------
>> Issue: [B830:read] ssl.SSLSocket.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:598
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b830_read.html
597	        if 'application/json' in headers.get('content-type', ''):
598	            data = json.decode(data.read().decode('utf-8'))
599	        return status, headers, data

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:634
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
633	    if credentials:
634	        token = b64encode(('%s:%s' % credentials).encode('utf-8'))
635	        return ('Basic %s' % token.strip().decode('utf-8')).encode('ascii')

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/http.py:634
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
633	    if credentials:
634	        token = b64encode(('%s:%s' % credentials).encode('utf-8'))
635	        return ('Basic %s' % token.strip().decode('utf-8')).encode('ascii')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/loader.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
101	            with codecs.open(fullname, 'r', 'utf-8') as f:
102	                contents = f.read()
103	                if name.endswith('.json'):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/loader.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
127	    except IndexError:
128	        sys.stderr.write("Usage:\n\t{0} [directory]\n".format(sys.argv[0]))
129	        sys.exit(1)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/loader.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
130	    obj = load_design_doc(directory)
131	    sys.stdout.write(json.dumps(obj, indent=2))
132	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/multipart.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
65	        if content_md5:
66	            h = b64encode(md5(payload).digest())
67	            if content_md5 != h:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/multipart.py:66
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
65	        if content_md5:
66	            h = b64encode(md5(payload).digest())
67	            if content_md5 != h:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/multipart.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
158	            headers['Content-Length'] = str(len(content))
159	            hash = b64encode(md5(content).digest()).decode('ascii')
160	            headers['Content-MD5'] = hash

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/multipart.py:159
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
158	            headers['Content-Length'] = str(len(content))
159	            hash = b64encode(md5(content).digest()).decode('ascii')
160	            headers['Content-MD5'] = hash

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	        self.assertTrue(client.Server(client.DEFAULT_BASE_URL))
38	        self.assertFalse(client.Server('http://localhost:9999'))
39	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
133	    def test_basic_auth(self):
134	        url = "http://root:password@localhost:5984/"
135	        server = client.Server(url)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
279	        self.assertEqual(b'Foo bar',
280	                         self.db.get_attachment(doc, 'foo.txt').read())
281	        self.assertEqual(b'Foo bar',

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:282
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
281	        self.assertEqual(b'Foo bar',
282	                         self.db.get_attachment('foo', 'foo.txt').read())
283	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
303	        self.assertEqual(b'Foo bar baz',
304	                         self.db.get_attachment(doc, 'foo.txt').read())
305	        self.assertEqual(b'Foo bar baz',

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:306
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
305	        self.assertEqual(b'Foo bar baz',
306	                         self.db.get_attachment('foo', 'foo.txt').read())
307	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
335	        f = open(tmpfile, 'w')
336	        f.write('Hello!')
337	        f.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:336
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
335	        f = open(tmpfile, 'w')
336	        f.write('Hello!')
337	        f.close()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
343	        self.assertTrue(doc['_attachments']['test.txt']['content_type'] == 'text/plain')
344	        shutil.rmtree(tmpdir)
345	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:355
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
354	        self.db.put_attachment(doc, '{}', 'test.json', 'application/json')
355	        self.assertEqual(self.db.get_attachment(doc, 'test.json').read(), b'{}')
356	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:612
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
611	            self.db.save({})
612	        threading.Thread(target=wakeup).start()
613	        for change in self.db.changes(feed='continuous', heartbeat=100):

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:816
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
815	    def test_show_urls(self):
816	        self.assertEqual(self.db.show('_design/foo/_show/bar')[1].read(), b'null:<default>')
817	        self.assertEqual(self.db.show('foo/bar')[1].read(), b'null:<default>')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:817
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
816	        self.assertEqual(self.db.show('_design/foo/_show/bar')[1].read(), b'null:<default>')
817	        self.assertEqual(self.db.show('foo/bar')[1].read(), b'null:<default>')
818	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:820
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
819	    def test_show_docid(self):
820	        self.assertEqual(self.db.show('foo/bar')[1].read(), b'null:<default>')
821	        self.assertEqual(self.db.show('foo/bar', '1')[1].read(), b'1:<default>')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:821
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
820	        self.assertEqual(self.db.show('foo/bar')[1].read(), b'null:<default>')
821	        self.assertEqual(self.db.show('foo/bar', '1')[1].read(), b'1:<default>')
822	        self.assertEqual(self.db.show('foo/bar', '2')[1].read(), b'2:<default>')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:822
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
821	        self.assertEqual(self.db.show('foo/bar', '1')[1].read(), b'1:<default>')
822	        self.assertEqual(self.db.show('foo/bar', '2')[1].read(), b'2:<default>')
823	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:825
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
824	    def test_show_params(self):
825	        self.assertEqual(self.db.show('foo/bar', r='abc')[1].read(), b'null:abc')
826	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:828
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
827	    def test_list(self):
828	        self.assertEqual(self.db.list('foo/list', 'foo/by_id')[1].read(), b'1\r\n2\r\n')
829	        self.assertEqual(self.db.list('foo/list', 'foo/by_id', include_header='true')[1].read(), b'id\r\n1\r\n2\r\n')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:829
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
828	        self.assertEqual(self.db.list('foo/list', 'foo/by_id')[1].read(), b'1\r\n2\r\n')
829	        self.assertEqual(self.db.list('foo/list', 'foo/by_id', include_header='true')[1].read(), b'id\r\n1\r\n2\r\n')
830	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:832
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
831	    def test_list_keys(self):
832	        self.assertEqual(self.db.list('foo/list', 'foo/by_id', keys=['1'])[1].read(), b'1\r\n')
833	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
834	    def test_list_view_params(self):
835	        self.assertEqual(self.db.list('foo/list', 'foo/by_name', startkey='o', endkey='p')[1].read(), b'1\r\n')
836	        self.assertEqual(self.db.list('foo/list', 'foo/by_name', descending=True)[1].read(), b'2\r\n1\r\n')

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:836
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
835	        self.assertEqual(self.db.list('foo/list', 'foo/by_name', startkey='o', endkey='p')[1].read(), b'1\r\n')
836	        self.assertEqual(self.db.list('foo/list', 'foo/by_name', descending=True)[1].read(), b'2\r\n1\r\n')
837	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
867	    def test_empty_doc(self):
868	        self.assertEqual(self.db.update_doc('foo/bar')[1].read(), b'empty doc')
869	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:871
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
870	    def test_new_doc(self):
871	        self.assertEqual(self.db.update_doc('foo/bar', 'new')[1].read(), b'new doc')
872	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/client.py:874
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
873	    def test_update_doc(self):
874	        self.assertEqual(self.db.update_doc('foo/bar', 'existed')[1].read(), b'hello doc')
875	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/couchhttp.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
23	        start = time.time()
24	        status, headers, body = session.request('GET', db.resource.url + '/_changes?feed=longpoll&since=1000&timeout=%s' % (timeout*2*1000,))
25	        self.assertRaises(socket.timeout, body.read)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tests/couchhttp.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
78	        """Check that a cache remove miss is handled gracefully."""
79	        url = 'http://localhost:5984/foo'
80	        cache = http.Cache()

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tools/dump.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
47	                else:
48	                    data = b64decode(info['data'])
49	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tools/dump.py:48
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
47	                else:
48	                    data = b64decode(info['data'])
49	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tools/load.py:40
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
39	                    doc['_attachments'][headers['content-id']] = {
40	                        'data': b64encode(payload).decode('ascii'),
41	                        'content_type': headers['content-type'],

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/tools/load.py:40
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
39	                    doc['_attachments'][headers['content-id']] = {
40	                        'data': b64encode(payload).decode('ascii'),
41	                        'content_type': headers['content-type'],

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/util.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
9	    # http://bugs.python.org/issue21591
10	    exec(code, gns, lns)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/view.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
40	            obj = obj.encode('utf-8')
41	        output.write(obj)
42	        output.write(b'\n')

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/view.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
41	        output.write(obj)
42	        output.write(b'\n')
43	        output.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/view.py:163
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
162	
163	_HELP = """Usage: %(name)s [OPTION]
164	
165	The %(name)s command runs the CouchDB Python view server.
166	
167	The exit status is 0 for success or 1 for failure.
168	
169	Options:
170	
171	  --version             display version information and exit
172	  -h, --help            display a short help message and exit
173	  --json-module=<name>  set the JSON module to use ('simplejson', 'cjson',
174	                        or 'json' are supported)
175	  --log-file=<file>     name of the file to write log messages to, or '-' to
176	                        enable logging to the standard error stream
177	  --debug               enable debug logging; requires --log-file to be
178	                        specified
179	
180	Report bugs via the web at <https://github.com/djc/couchdb-python/issues>.
181	"""
182	
183	
184	def main():

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/view.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
218	        if message:
219	            sys.stdout.write(message)
220	            sys.stdout.flush()

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/couchdb/view.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
226	        )
227	        sys.stderr.write(message)
228	        sys.stderr.flush()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/setup.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
51	    license = 'BSD',
52	    url = 'https://github.com/djc/couchdb-python/',
53	    classifiers = [

--------------------------------------------------

Code scanned:
	Total lines of code: 5302
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 12.0
		High: 78.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 84.0
		High: 6.0
Files skipped (1):
	/home/blue/PyPIAgent/Dataset/study/unzip_benign/couchdb-1.2/CouchDB-1.2/perftest.py (syntax error while parsing AST from file)
