Run started:2025-04-12 15:04:26.216014

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/setup.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
57	    long_description_content_type="text/markdown",
58	    url="https://github.com/ai-platform-ml-platform/shrike",
59	    author="AML Data Science",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/_core/eyesoff.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	
44	POLYMER_FEED = "--index-url https://o365exchange.pkgs.visualstudio.com/_packaging/PolymerPythonPackages/pypi/simple/"  # noqa: E501
45	O365_FEED = "--index-url https://o365exchange.pkgs.visualstudio.com/_packaging/O365PythonPackagesV2/pypi/simple/"  # noqa: E501

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/_core/eyesoff.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	POLYMER_FEED = "--index-url https://o365exchange.pkgs.visualstudio.com/_packaging/PolymerPythonPackages/pypi/simple/"  # noqa: E501
45	O365_FEED = "--index-url https://o365exchange.pkgs.visualstudio.com/_packaging/O365PythonPackagesV2/pypi/simple/"  # noqa: E501
46	
47	
48	def get_hashed_eyes_on_subs():

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/_core/utils.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
32	    s_bytes = s.encode(encoding)
33	    b64_bytes = base64.b64encode(s_bytes)
34	    s_encoded = b64_bytes.decode(encoding)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/_core/utils.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
32	    s_bytes = s.encode(encoding)
33	    b64_bytes = base64.b64encode(s_bytes)
34	    s_encoded = b64_bytes.decode(encoding)

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/_core/utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
43	    b64_bytes = s.encode(encoding)
44	    s_bytes = base64.b64decode(b64_bytes)
45	    s_decoded = s_bytes.decode(encoding)

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/_core/utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
43	    b64_bytes = s.encode(encoding)
44	    s_bytes = base64.b64decode(b64_bytes)
45	    s_decoded = s_bytes.decode(encoding)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	ALLOWED_PACKAGE_FEEDS = [
37	    "https://o365exchange.pkgs.visualstudio.com/_packaging/PolymerPythonPackages/pypi/simple/",
38	    "https://o365exchange.pkgs.visualstudio.com/_packaging/O365PythonPackages/pypi/simple/",
39	    "https://o365exchange.pkgs.visualstudio.com/_packaging/O365PythonPackagesV2/pypi/simple/"
40	]
41	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    "https://o365exchange.pkgs.visualstudio.com/_packaging/PolymerPythonPackages/pypi/simple/",
38	    "https://o365exchange.pkgs.visualstudio.com/_packaging/O365PythonPackages/pypi/simple/",
39	    "https://o365exchange.pkgs.visualstudio.com/_packaging/O365PythonPackagesV2/pypi/simple/"
40	]
41	
42	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	    "https://o365exchange.pkgs.visualstudio.com/_packaging/O365PythonPackages/pypi/simple/",
39	    "https://o365exchange.pkgs.visualstudio.com/_packaging/O365PythonPackagesV2/pypi/simple/"
40	]
41	
42	
43	class RuntimeEnvironment(Enum):

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
130	                )
131	                pool = multiprocessing.Pool(processes=nb_cores)
132	                if action_type == ActionType.BUILD:

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:131
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
130	                )
131	                pool = multiprocessing.Pool(processes=nb_cores)
132	                if action_type == ActionType.BUILD:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:607
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
606	        if Path(component_target_file_path).exists():
607	            rbfile = open(component_target_file_path, "rb").read()
608	            if chardet.detect(rbfile).get("encoding").lower() not in ["utf-8", "ascii"]:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:857
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
856	                    for req in pip_dependencies:
857	                        file.write(req)
858	                        if not req.endswith("\n"):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:859
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
858	                        if not req.endswith("\n"):
859	                            file.write("\n")
860	            if conda_dependencies:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:1131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
1130	        # let's figure out the OS
1131	        operating_system = self.determine_operating_system()
1132	        # let's figure out the runtime environment

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/prepare.py:1257
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1256	            raise ValueError(
1257	                "It seems like both the GitHub- and Azure-specific environment variables are non-empty. This shouldn't be possible and implies shrike should be using alternate environment variables to determine the runtime environment. Please open an issue in the GitHub shrike repository: https://github.com/ai-platform-ml-platform/shrike/issues."
1258	            )
1259	        elif github_ev:

--------------------------------------------------
>> Issue: [B839:pool] multiprocessing.Pool
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/register.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b839_pool.html
103	                files_with_registry = [(f, registry) for f in files]
104	                pool = multiprocessing.Pool(processes=nb_cores)
105	                pool.starmap(self.register_component_with_status, files_with_registry)

--------------------------------------------------
>> Issue: [B323:blacklist] multiprocessing_Pool
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/commands/register.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b323-multiprocessing-pool
103	                files_with_registry = [(f, registry) for f in files]
104	                pool = multiprocessing.Pool(processes=nb_cores)
105	                pool.starmap(self.register_component_with_status, files_with_registry)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/core/command_line.py:166
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
165	        az_command_bytes = bytes(f"az {command}", "utf-16le")
166	        az_command_b64 = base64.b64encode(az_command_bytes).decode("ascii")
167	        pwsh_command = ["pwsh", "-EncodedCommand", az_command_b64]

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/core/command_line.py:166
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
165	        az_command_bytes = bytes(f"az {command}", "utf-16le")
166	        az_command_b64 = base64.b64encode(az_command_bytes).decode("ascii")
167	        pwsh_command = ["pwsh", "-EncodedCommand", az_command_b64]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/core/configuration.py:188
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
187	            raise ValueError(
188	                "Please don't specify both allow_duplicate_versions and fail_if_version_exists. Check out https://aka.ms/aml/amlbuild for more information."
189	            )
190	        print("Please refer to https://aka.ms/aml/amlbuild for more information.")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/core/configuration.py:190
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
189	            )
190	        print("Please refer to https://aka.ms/aml/amlbuild for more information.")
191	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/build/utils/utils.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
32	        # Read and update hash string value in blocks of 4K
33	        for byte_block in iter(lambda: f.read(4096), b""):
34	            sha256_hash.update(byte_block)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/compliant_logging/argparser_utils.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
79	        raise PublicTypeError(
80	            "The auto arg parser API only works with "
81	            "[category-aware logging](https://shrike-docs.com/compliant_logging/). "
82	            "Please call `enable_compliant_logging()` before creating a logger."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/compliant_logging/logging.py:1141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1140	
1141	_logging_basic_config_set_warning = """
1142	********************************************************************************
1143	The root logger already has handlers set! As a result, the behavior of this
1144	library is undefined. If running in Python >= 3.8, this library will attempt to
1145	call logging.basicConfig(force=True), which will remove all existing root
1146	handlers. See https://stackoverflow.com/q/20240464 and
1147	https://github.com/Azure/confidential-ml-utils/issues/33 for more information.
1148	********************************************************************************
1149	"""
1150	
1151	
1152	def enable_compliant_logging(

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/distributed/dask.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
78	        self.rank = int(cast(str, os.getenv("OMPI_COMM_WORLD_RANK")))
79	        self.ip = socket.gethostbyname(socket.gethostname())
80	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/distributed/dask.py:79
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
78	        self.rank = int(cast(str, os.getenv("OMPI_COMM_WORLD_RANK")))
79	        self.ip = socket.gethostbyname(socket.gethostname())
80	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/distributed/dask.py:128
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
127	        # create setup config
128	        self.head_address = socket.gethostbyname(socket.gethostname())
129	

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/distributed/dask.py:128
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
127	        # create setup config
128	        self.head_address = socket.gethostbyname(socket.gethostname())
129	

--------------------------------------------------
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/distributed/ray.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
43	        # create setup config
44	        local_hostname = socket.gethostname()
45	        local_ip = socket.gethostbyname(local_hostname)

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/distributed/ray.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
43	        # create setup config
44	        local_hostname = socket.gethostname()
45	        local_ip = socket.gethostbyname(local_hostname)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/pipeline/pipeline_helper_base.py:531
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
530	                        log.info(
531	                            f"Override for key {key} is not supported yet. Please open a [feature request](https://github.com/ai-platform-ml-platform/shrike/issues) if necessary."
532	                        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/pipeline/ray_actor.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
79	    with open(script) as file:
80	        contents = file.read()
81	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/pipeline/testing/components.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
36	    with open(component_spec_path, "r") as ifile:
37	        component_spec_content = ifile.read()
38	        if (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/pipeline/testing/pipeline_class_test.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
117	    with open(pipeline_export_file, "r") as export_file:
118	        pipeline = json.loads(export_file.read())
119	    assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/pipeline/testing/pipeline_class_test.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
123	    with open(pipeline_definition_file, "r") as definition_file:
124	        definition = json.loads(definition_file.read())
125	    assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/pipeline/testing/pipeline_class_test_v2.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
110	    with open(pipeline_export_file, "r") as export_file:
111	        pipeline = json.loads(export_file.read())
112	    assert (

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/shrike-2.0.0rc2/shrike-2.0.0rc2/shrike/pipeline/testing/pipeline_class_test_v2.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	    with open(pipeline_definition_file, "r") as definition_file:
117	        definition = json.loads(definition_file.read())
118	    assert (

--------------------------------------------------

Code scanned:
	Total lines of code: 10610
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 20.0
		High: 19.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 8.0
Files skipped (0):
