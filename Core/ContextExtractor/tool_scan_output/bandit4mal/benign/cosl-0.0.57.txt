Run started:2025-04-12 10:30:39.134055

Test results:
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/coordinator.py:755
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
754	            with open(file_name, "w") as writer:
755	                writer.write(alert_rules_contents)
756	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
247	        """Determine the status of the service's endpoint."""
248	        if not self._container.can_connect():
249	            logger.debug("Container cannot connect. Skipping status check.")

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:298
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
297	        try:
298	            with urllib.request.urlopen(check_endpoint(self)) as response:
299	                html: bytes = response.read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
298	            with urllib.request.urlopen(check_endpoint(self)) as response:
299	                html: bytes = response.read()
300	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:337
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
336	            statuses.append(self.resources_patch.get_status())
337	        if not self._container.can_connect():
338	            statuses.append(WaitingStatus(f"Waiting for `{self._name}` container"))

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
511	
512	            if self._container.can_connect():
513	                logger.debug("Wiping configs and stopping workload...")

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:585
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
584	        """Return the worker config as dict, or None if retrieval failed."""
585	        if not self._container.can_connect():
586	            logger.debug("Could not connect to the workload container")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:590
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
589	        try:
590	            raw_current = self._container.pull(CONFIG_FILE).read()
591	            return yaml.safe_load(raw_current)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:602
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
601	        """Check whether the worker has all data it needs to operate."""
602	        if not self._container.can_connect():
603	            logger.warning("worker not ready: container cannot connect.")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:666
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
665	            if self._container.exists(file):
666	                current_contents = self._container.pull(file).read()
667	                if current_contents == new_contents:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:804
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
803	        """Get the running version from the worker process."""
804	        if not self._container.can_connect():
805	            return None

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:917
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
916	        for container in self._charm.unit.containers.values():
917	            if container.can_connect():
918	                _PebbleLogClient.disable_inactive_endpoints(  # type:ignore

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/coordinated_workers/worker.py:932
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
931	        for container in self._charm.unit.containers.values():
932	            if container.can_connect():
933	                _PebbleLogClient.disable_inactive_endpoints(  # type:ignore

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/grafana_dashboard.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
59	            raw_json = raw_json.encode("utf-8")
60	        return base64.b64encode(lzma.compress(raw_json)).decode("utf-8")
61	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/grafana_dashboard.py:60
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
59	            raw_json = raw_json.encode("utf-8")
60	        return base64.b64encode(lzma.compress(raw_json)).decode("utf-8")
61	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/grafana_dashboard.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
64	        """Decompress from base64-encoded-lzma-compressed string."""
65	        return lzma.decompress(base64.b64decode(compressed.encode("utf-8"))).decode()
66	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/grafana_dashboard.py:65
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
64	        """Decompress from base64-encoded-lzma-compressed string."""
65	        return lzma.decompress(base64.b64decode(compressed.encode("utf-8"))).decode()
66	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/interfaces/datasource_exchange.py:50
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
49	    type: str = Field(
50	        description="Type of the datasource, typically one of "
51	        "https://grafana.com/docs/grafana/latest/datasources/#built-in-core-data-sources.",
52	        examples=["tempo", "loki", "prometheus", "elasticsearch"],

--------------------------------------------------
>> Issue: [B818:urlopen] urllib.request.urlopen
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/src/cosl/loki_logger.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b818_urlopen.html
69	    def _send_request(self, req: request.Request, jsondata_encoded: bytes):
70	        return request.urlopen(req, jsondata_encoded, capath=self.cert)
71	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_coordinator.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
149	                ),
150	                external_url="https://foo.example.com",
151	                worker_metrics_port=123,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_coordinator.py:262
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
261	        ("example.com", "example.com"),
262	        ("http://example.com", "example.com"),
263	        ("https://example.com", "example.com"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_coordinator.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
262	        ("http://example.com", "example.com"),
263	        ("https://example.com", "example.com"),
264	    ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_coordinator_status.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	            "bucket": "tempo",
97	            "endpoint": "http://1.2.3.4:9000",
98	            "secret-key": "soverysecret",
99	        },
100	        local_unit_data={"bucket": "tempo"},
101	    )
102	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_coordinator_status.py:224
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
223	    # GIVEN an https ingress address, but no tls relation
224	    coord_charm.external_url = "https://198.18.0.0:3200"
225	    # WHEN the charm processes any event
226	    state_out = ctx.run(event, base_state)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_nginx.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
116	    with open(test_config.name, "w") as f:
117	        f.write("foo")
118	

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_nginx.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
116	    with open(test_config.name, "w") as f:
117	        f.write("foo")
118	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_worker.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	            {"cluster": "cluster"},
34	            readiness_check_endpoint="http://localhost:3200/ready",
35	        )

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_worker.py:441
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
440	    # THEN the data gets preprocessed
441	    fs = Path(str(state_out.get_container("foo").get_filesystem(ctx)) + CONFIG_FILE)
442	    assert fs.read_text() == yaml.safe_dump(new_config)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_worker.py:549
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
548	                {"cluster": "cluster"},
549	                readiness_check_endpoint="http://localhost:3200/ready",
550	                resources_requests=lambda _: {"cpu": "50m", "memory": "50Mi"},

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_worker.py:736
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
735	
736	    fs = container.get_filesystem(ctx)
737	    # THEN the worker wipes all certificates if they are there

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_worker.py:830
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
829	    # AND ClusterRequirer is passed an invalid url as FQDN
830	    mock_socket_fqdn.return_value = "http://www.invalid-]url.com"
831	
832	    # WHEN the charm executes any event
833	    # THEN the charm raises an error with the appropriate cause
834	    with pytest.raises(UncaughtCharmError) as exc:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_worker.py:976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
975	                {
976	                    "jaeger_thrift_http": "https://198.18.0.0:14268",
977	                    "otlp_http": "http://198.18.0.0:4318",
978	                }
979	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_worker.py:977
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
976	                    "jaeger_thrift_http": "https://198.18.0.0:14268",
977	                    "otlp_http": "http://198.18.0.0:4318",
978	                }
979	            ),
980	            "workload_tracing_receivers": json.dumps(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_worker.py:982
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
981	                {
982	                    "jaeger_thrift_http": "http://198.18.0.0:14268",
983	                    "otlp_http": "http://198.18.0.0:4318",
984	                }
985	            ),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_coordinated_workers/test_worker.py:983
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
982	                    "jaeger_thrift_http": "http://198.18.0.0:14268",
983	                    "otlp_http": "http://198.18.0.0:4318",
984	                }
985	            ),
986	            "worker_config": json.dumps("test"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_loki_logger.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
41	    for i in range(n_lokis):
42	        url = f"http://loki_{i}.com"
43	        urls.append(url)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_loki_logger.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	    send_request_mock.side_effect = HTTPError(
82	        url="http://foo", code=123, msg="foo", hdrs={}, fp=None
83	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/cosl-0.0.57/cosl-0.0.57/tests/test_loki_logger.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	
86	    url = "http://loki_1.com"
87	    handler = LokiHandler(url=url, labels={"test-label": "loki-id-1"})

--------------------------------------------------

Code scanned:
	Total lines of code: 6348
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 20.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 36.0
		High: 2.0
Files skipped (0):
