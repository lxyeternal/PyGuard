Run started:2025-04-12 15:34:06.640517

Test results:
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	            raise http_error
70	        errors = response_json.get("root", {}).get("errors", [])
71	        error_message = response_json.get("message", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
69	            raise http_error
70	        errors = response_json.get("root", {}).get("errors", [])
71	        error_message = response_json.get("message", None)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
70	        errors = response_json.get("root", {}).get("errors", [])
71	        error_message = response_json.get("message", None)
72	        if errors:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:213
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
212	            new_loop = asyncio.new_event_loop()
213	            with concurrent.futures.ThreadPoolExecutor() as executor:
214	                future = executor.submit(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	        with self.syncio() as sync_sess:
292	            response = sync_sess.http_session.get(endpoint)
293	        return response

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:437
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
436	                try:
437	                    doc = queue.get(timeout=5)
438	                except Empty:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:473
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
472	        ) -> Tuple[str, Union[VespaResponse, Exception]]:
473	            id = doc.get("id", None)
474	            if id is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:481
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
480	                )
481	            fields = doc.get("fields", None)
482	            if fields is None and operation_type != "delete":

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:489
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
488	                )
489	            groupname = doc.get("groupname", None)
490	            try:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
553	            queue = Queue(maxsize=max_queue_size)
554	            with ThreadPoolExecutor(max_workers=max_workers) as executor:
555	                consumer_thread = threading.Thread(

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:650
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
649	                for doc in iter:
650	                    id = doc.get("id")
651	                    fields = doc.get("fields")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:651
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
650	                    id = doc.get("id")
651	                    fields = doc.get("fields")
652	                    groupname = doc.get("groupname")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:652
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
651	                    fields = doc.get("fields")
652	                    groupname = doc.get("groupname")
653	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1075	        # Automatically handle compression if needed
1076	        self._maybe_compress_request(request)
1077	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1076
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1075	        # Automatically handle compression if needed
1076	        self._maybe_compress_request(request)
1077	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1225	        try:
1226	            response = self.http_session.get(end_point)
1227	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1247	        try:
1248	            response = self.http_session.get(end_point)
1249	            if response.status_code == 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1283	        vespa_format = {"fields": fields}
1284	        response = self.http_session.post(end_point, json=vespa_format, params=kwargs)
1285	        raise_for_status(response)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1310
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1309	            kwargs["streaming.groupname"] = groupname
1310	        response = self.http_session.post(
1311	            self.app.search_end_point, json=body, params=kwargs
1312	        )

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1406
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1405	
1406	        with ThreadPoolExecutor(max_workers=slices) as executor:
1407	            executor.map(delete_slice, range(slices))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1460
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1459	        def visit_request(end_point: str, params: Dict[str, str]):
1460	            r = self.http_session.get(end_point, params=params)
1461	            r.raise_for_status()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1476	            while True:
1477	                result = visit_request(end_point, params=params)
1478	                yield result

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1477
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1476	            while True:
1477	                result = visit_request(end_point, params=params)
1478	                yield result

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1485
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
1484	        if slice_id is None:
1485	            with ThreadPoolExecutor(max_workers=slices) as executor:
1486	                futures = [

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1519	
1520	        response = self.http_session.get(end_point, params=kwargs)
1521	        raise_for_status(response, raise_on_not_found=raise_on_not_found)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1658
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1657	        self.headers = self.app.base_headers.copy()
1658	        self.limits = kwargs.get(
1659	            "limits", httpx.Limits(max_keepalive_connections=self.connections)
1660	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1721
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1720	            kwargs["streaming.groupname"] = groupname
1721	        r = await self.httpx_client.post(
1722	            self.app.search_end_point, json=body, params=kwargs
1723	        )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1758
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1757	            async with semaphore:
1758	                response = await self.httpx_client.post(
1759	                    end_point, json=vespa_format, params=kwargs
1760	                )

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1762
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
1761	        else:
1762	            response = await self.httpx_client.post(
1763	                end_point, json=vespa_format, params=kwargs
1764	            )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1838
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1837	            async with semaphore:
1838	                response = await self.httpx_client.get(end_point, params=kwargs)
1839	        else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/application.py:1840
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1839	        else:
1840	            response = await self.httpx_client.get(end_point, params=kwargs)
1841	        return VespaResponse(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
53	            for file in files:
54	                zipf.write(os.path.join(root, file))
55	        zipf.close()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
57	        with open(tmp_zip, "rb") as f:
58	            data = f.read()
59	        os.remove(tmp_zip)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
113	        self.container_id = container_id
114	        self.url = "http://localhost"
115	        self.local_port = port

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
163	        try:
164	            container = client.containers.get(name_or_id)
165	        except docker.errors.NotFound:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:363
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
362	
363	        r = requests.post(
364	            "http://localhost:{}/application/v2/tenant/default/prepareandactivate".format(
365	                self.cfgsrv_port
366	            ),
367	            headers={"Content-Type": "application/zip"},
368	            data=data,
369	            verify=False,
370	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:364
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
363	        r = requests.post(
364	            "http://localhost:{}/application/v2/tenant/default/prepareandactivate".format(
365	                self.cfgsrv_port

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:397
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
396	                logging.debug("Try Docker container restart")
397	                self.container = client.containers.get(application_name)
398	                self.container.restart()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
443	        output = self.container.exec_run(
444	            "bash -c 'curl -s --head http://localhost:19071/ApplicationStatus'"
445	        ).output.decode("utf-8")
446	        logging.debug("Config Server ApplicationStatus head response: " + output)

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
535	        if self.api_key:
536	            self.api_public_key_bytes = standard_b64encode(
537	                self.api_key.public_key().public_bytes(
538	                    serialization.Encoding.PEM,
539	                    serialization.PublicFormat.SubjectPublicKeyInfo,
540	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
569	        )
570	        self.base_url = "https://api-ctl.vespa-cloud.com:4443"
571	        self.pyvespa_version = vespa.__version__

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:687
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
686	
687	        deploy_url = "https://console.vespa-cloud.com/tenant/{}/application/{}/prod/deployment".format(
688	            self.tenant, self.application

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
699	            time.sleep(1)
700	            deployments = self._request(
701	                "GET",
702	                f"/application/v4/tenant/{self.tenant}/application/{self.application}/deployment/",
703	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
699	            time.sleep(1)
700	            deployments = self._request(
701	                "GET",
702	                f"/application/v4/tenant/{self.tenant}/application/{self.application}/deployment/",
703	            )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
834	        print(f"Checking status of build number: {build_no}", file=self.output)
835	        status = self._request(
836	            "GET",
837	            f"/application/v4/tenant/{self.tenant}/application/{self.application}/build-status/{build_no}",
838	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:835
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
834	        print(f"Checking status of build number: {build_no}", file=self.output)
835	        status = self._request(
836	            "GET",
837	            f"/application/v4/tenant/{self.tenant}/application/{self.application}/build-status/{build_no}",
838	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
920	        print(
921	            self._request(
922	                "DELETE",
923	                "/application/v4/tenant/{}/application/{}/instance/{}/environment/dev/region/{}".format(
924	                    self.tenant, self.application, instance, self.get_dev_region()
925	                ),

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:921
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
920	        print(
921	            self._request(
922	                "DELETE",
923	                "/application/v4/tenant/{}/application/{}/instance/{}/environment/dev/region/{}".format(
924	                    self.tenant, self.application, instance, self.get_dev_region()
925	                ),

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:930
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
929	        print(
930	            self._request(
931	                "DELETE",
932	                "/application/v4/tenant/{}/application/{}/instance/{}".format(
933	                    self.tenant, self.application, instance
934	                ),

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:930
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
929	        print(
930	            self._request(
931	                "DELETE",
932	                "/application/v4/tenant/{}/application/{}/instance/{}".format(
933	                    self.tenant, self.application, instance
934	                ),

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:947
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
946	            with open(key_location, "rb") as key_data:
947	                key_content = key_data.read()
948	        else:

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
985	    def _vespa_auth_login(self):
986	        system = platform.system()
987	        if system == "Windows":

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:986
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
985	    def _vespa_auth_login(self):
986	        system = platform.system()
987	        if system == "Windows":

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:986
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
985	    def _vespa_auth_login(self):
986	        system = platform.system()
987	        if system == "Windows":

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1017
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1016	                        # Read output from the master end of the PTY
1017	                        output = os.read(master, 1024).decode("utf-8")
1018	                        if output:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1028
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1027	                            user_input = input() + "\n"
1028	                            os.write(master, user_input.encode())
1029	                            sys.stdout.flush()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1103	                private_key = serialization.load_pem_private_key(
1104	                    key_file.read(), password=None, backend=default_backend()
1105	                )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1109
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1108	                cert = x509.load_pem_x509_certificate(
1109	                    cert_file.read(), default_backend()
1110	                )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1138	        regions = []
1139	        info = self._request(
1140	            method="GET",
1141	            path=f"/application/v4/tenant/{self.tenant}/application/{self.application}",
1142	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1138	        regions = []
1139	        info = self._request(
1140	            method="GET",
1141	            path=f"/application/v4/tenant/{self.tenant}/application/{self.application}",
1142	        )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1183	        ):
1184	            response = client.request(
1185	                method, path, data=data, content=content, headers=headers
1186	            )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1184
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1183	        ):
1184	            response = client.request(
1185	                method, path, data=data, content=content, headers=headers
1186	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
1246	        try:
1247	            parsed = json.load(response)
1248	        except json.JSONDecodeError:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1249
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1248	        except json.JSONDecodeError:
1249	            parsed = response.read()
1250	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1328	                body.seek(0)
1329	            digest.update(body.read())
1330	            body_data = body

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1331	        # Create signature
1332	        content_hash = standard_b64encode(digest.finalize()).decode("UTF-8")
1333	        timestamp = datetime.utcnow().isoformat() + "Z"

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1339	        )
1340	        signature_b64 = standard_b64encode(signature).decode("UTF-8")
1341	

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1376	
1377	        endpoints = self._request(
1378	            "GET",
1379	            "/application/v4/tenant/{}/application/{}/instance/{}/environment/{}/region/{}".format(
1380	                self.tenant, self.application, instance, environment, region
1381	            ),

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1376	
1377	        endpoints = self._request(
1378	            "GET",
1379	            "/application/v4/tenant/{}/application/{}/instance/{}/environment/{}/region/{}".format(
1380	                self.tenant, self.application, instance, environment, region
1381	            ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1431	        for endpoint in endpoints:
1432	            endpoint_cluster = endpoint.get("cluster", None)
1433	            available_clusters.add(endpoint_cluster)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1437	
1438	            authMethod = endpoint.get("authMethod", None)
1439	            if authMethod == auth_method:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1536
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1535	                with open(client_pem_path, "wb") as clients_pem:
1536	                    clients_pem.write(
1537	                        self.data_certificate.public_bytes(serialization.Encoding.PEM)
1538	                    )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1610	            )  # Needs to be reset. Otherwise, no data will be sent
1611	            content_hash = standard_b64encode(digest.finalize()).decode("UTF-8")
1612	            timestamp = (

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1626
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
1625	                "X-Key": self.api_public_key_bytes,
1626	                "X-Authorization": standard_b64encode(signature),
1627	            }

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1638	        multipart_data_bytes = BytesIO(multipart_data_bytes)
1639	        response = self._request(
1640	            "POST", deploy_path, body=multipart_data_bytes, headers=headers
1641	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1639
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1638	        multipart_data_bytes = BytesIO(multipart_data_bytes)
1639	        response = self._request(
1640	            "POST", deploy_path, body=multipart_data_bytes, headers=headers
1641	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1642
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1641	        )
1642	        message = response.get("message", "No message provided")
1643	        print(message, file=self.output)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1644
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1643	        print(message, file=self.output)
1644	        build_no = int(response.get("build"))
1645	        skipped = bool(response.get("skipped"))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1645
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1644	        build_no = int(response.get("build"))
1645	        skipped = bool(response.get("skipped"))
1646	        if skipped:

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1699	
1700	        response = self._request(
1701	            method="POST", path=deploy_path, body=payload, headers=headers
1702	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1700
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1699	
1700	        response = self._request(
1701	            method="POST", path=deploy_path, body=payload, headers=headers
1702	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1703
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1702	        )
1703	        message = response.get("message", "No message provided")
1704	        print(message, file=self.output)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1716
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1715	                for model in schema.models:
1716	                    zip_archive.write(
1717	                        model.model_file_path,
1718	                        os.path.join("files", model.model_file_name),
1719	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1728
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
1727	                    model.export_to_onnx(output_path=temp_model_file)
1728	                    zip_archive.write(
1729	                        temp_model_file,
1730	                        "models/{}.onnx".format(model_id),
1731	                    )

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
1783	    ) -> Tuple[str, int]:
1784	        update = self._request(
1785	            "GET",
1786	            "/application/v4/tenant/{}/application/{}/instance/{}/job/{}/run/{}?after={}".format(
1787	                self.tenant, self.application, instance, job, run, last
1788	            ),

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1784
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
1783	    ) -> Tuple[str, int]:
1784	        update = self._request(
1785	            "GET",
1786	            "/application/v4/tenant/{}/application/{}/instance/{}/job/{}/run/{}?after={}".format(
1787	                self.tenant, self.application, instance, job, run, last
1788	            ),

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/deployment.py:1794
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
1793	                self._print_log_entry(step, entry)
1794	        last = update.get("lastId", last)
1795	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/package.py:2929
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2928	                for model in schema.models:
2929	                    zip_archive.write(
2930	                        model.model_file_path,
2931	                        "files/{}".format(model.model_file_name),
2932	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/package.py:2938
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2937	                    model.export_to_onnx(output_path=temp_model_file)
2938	                    zip_archive.write(
2939	                        temp_model_file,
2940	                        "models/{}.onnx".format(model_id),
2941	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/package.py:2976
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2975	        with open(zfile, "wb") as f:
2976	            f.write(self.to_zip().getbuffer().tobytes())
2977	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/package.py:2999
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
2998	            ) as f:
2999	                f.write(schema.schema_to_text)
3000	            for model in schema.models:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/package.py:3010
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3009	            ) as f:
3010	                f.write(self.query_profile_to_text)
3011	            with open(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/package.py:3014
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3013	            ) as f:
3014	                f.write(self.query_profile_type_to_text)
3015	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/package.py:3017
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3016	        with open(os.path.join(root, "services.xml"), "w") as f:
3017	            f.write(self.services_to_text)
3018	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/package.py:3027
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3026	            with open(os.path.join(root, "validation-overrides.xml"), "w") as f:
3027	                f.write(self.validations_to_text)
3028	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pyvespa-0.55.0/pyvespa-0.55.0/vespa/package.py:3031
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
3030	            with open(os.path.join(root, "deployment.xml"), "w") as f:
3031	                f.write(self.deployment_to_text)
3032	

--------------------------------------------------

Code scanned:
	Total lines of code: 9218
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 90.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 95.0
		High: 1.0
Files skipped (0):
