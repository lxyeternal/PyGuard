Run started:2025-04-12 10:18:37.288356

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/checks.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	        warning = (
91	            "You are using django-csp < 4.0 settings. Please update your settings to use the new format.\n"
92	            "See https://django-csp.readthedocs.io/en/latest/migration-guide.html for more information.\n\n"
93	            "We have attempted to build the new CSP config for you based on your current settings:\n\n"
94	            f"CONTENT_SECURITY_POLICY{'_REPORT_ONLY' if REPORT_ONLY else ''} = " + pprint.pformat(config, sort_dicts=True)
95	        )

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/middleware.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
58	            return stored_nonce
59	        nonce = base64.b64encode(os.urandom(16)).decode("ascii")
60	        setattr(request, "_csp_nonce", nonce)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/middleware.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
58	            return stored_nonce
59	        nonce = base64.b64encode(os.urandom(16)).decode("ascii")
60	        setattr(request, "_csp_nonce", nonce)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_context_processors.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
16	    request = rf.get("/")
17	    mw.process_request(request)
18	    context = nonce(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_context_processors.py:29
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
28	    request = rf.get("/")
29	    mw.process_request(request)
30	    context = nonce(request)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_decorators.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
60	    assert getattr(response, "_csp_update") == {"img-src": ["bar.com", NONCE]}
61	    mw.process_request(request)
62	    csp_nonce = str(getattr(request, "csp_nonce"))  # This also triggers the nonce creation.

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_decorators.py:94
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
93	    assert getattr(response, "_csp_update_ro") == {"img-src": ["bar.com", NONCE]}
94	    mw.process_request(request)
95	    csp_nonce = str(getattr(request, "csp_nonce"))  # This also triggers the nonce creation.

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
146	    request = rf.get("/")
147	    mw.process_request(request)
148	    nonce = str(getattr(request, "csp_nonce"))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
156	    request = rf.get("/")
157	    mw.process_request(request)
158	    assert bool(getattr(request, "csp_nonce")) is False

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:183
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
182	
183	    mw.process_request(request)
184	    rendered_unset = template.render(context).strip()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:199
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
198	
199	    mw.process_request(request)
200	    nonce = getattr(request, "csp_nonce", None)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:222
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
221	
222	    mw.process_request(request)
223	    rendered_unset = template.render(context).strip()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
237	
238	    mw.process_request(request)
239	    nonce = getattr(request, "csp_nonce", None)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:248
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
247	    request = rf.get("/")
248	    mw.process_request(request)
249	    response = HttpResponse()

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:258
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
257	    request2 = rf.get("/")
258	    mw.process_request(request1)
259	    mw.process_request(request2)

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:259
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
258	    mw.process_request(request1)
259	    mw.process_request(request2)
260	    nonce1 = str(getattr(request1, "csp_nonce"))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
274	    request = rf.get("/")
275	    mw.process_request(request)
276	    mw.process_response(request, HttpResponse())

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/test_middleware.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
284	    request = rf.get("/")
285	    mw.process_request(request)
286	    nonce = str(getattr(request, "csp_nonce"))

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/django_csp-4.0/django_csp-4.0/csp/tests/utils.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
40	        request = rf.get("/")
41	        mw.process_request(request)
42	        nonce = getattr(request, "csp_nonce")

--------------------------------------------------

Code scanned:
	Total lines of code: 1655
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 17.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 18.0
		High: 1.0
Files skipped (0):
