Run started:2025-04-12 19:02:07.381277

Test results:
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:283
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
282	        if self.sock:
283	            self.sock.close()
284	            self.sock = None

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
287	        self.timeout = value
288	        self.sock.settimeout(self.timeout)
289	

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
291	        try:
292	            buf = [self.sock.recv(size)]
293	            if not buf[0]:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:302
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
301	            log("write %r", data)
302	            self.sock.sendall(data)
303	        except socket.timeout:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:315
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
314	
315	        sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
316	        try:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:317
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
316	        try:
317	            sock.settimeout(self.timeout)
318	            sock.connect(self.sockpath.unix_domain)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:318
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
317	            sock.settimeout(self.timeout)
318	            sock.connect(self.sockpath.unix_domain)
319	            self.sock = sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
320	        except socket.error as e:
321	            sock.close()
322	            raise SocketConnectError(self.sockpath.unix_domain, e)

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
338	            sock = WindowsSocketHandle()
339	            sock.settimeout(self.timeout)
340	            sock.connect(self.sockpath.unix_domain)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:340
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
339	            sock.settimeout(self.timeout)
340	            sock.connect(self.sockpath.unix_domain)
341	            self.sock = sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:344
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
343	            if sock is not None:
344	                sock.close()
345	            raise SocketConnectError(self.sockpath.unix_domain, e)

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:371
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
370	
371	        sock = socket.socket(family, socket.SOCK_STREAM)
372	        try:

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:373
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
372	        try:
373	            sock.settimeout(self.timeout)
374	            sock.connect(sockaddr)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:374
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
373	            sock.settimeout(self.timeout)
374	            sock.connect(sockaddr)
375	            self.sock = sock

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:377
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
376	        except socket.error as e:
377	            sock.close()
378	            raise SocketConnectError(str(self.sockpath.tcp_address), e)

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:628
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
627	                self.proc.kill()
628	            self.proc.stdin.close()
629	            self.proc.stdout.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:629
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
628	            self.proc.stdin.close()
629	            self.proc.stdout.close()
630	            self.proc.wait()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:654
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
653	    def readBytes(self, size):
654	        self._connect()
655	        res = self.proc.stdout.read(size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:655
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
654	        self._connect()
655	        res = self.proc.stdout.read(size)
656	        log("CLI read %r", repr(res))

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:663
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
662	        if self.closed:
663	            self.close()
664	            self.closed = False

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:665
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
664	            self.closed = False
665	        self._connect()
666	        log("CLI write %r", data)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:667
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
666	        log("CLI write %r", data)
667	        res = self.proc.stdin.write(data)
668	        self.proc.stdin.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:668
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
667	        res = self.proc.stdin.write(data)
668	        self.proc.stdin.close()
669	        self.closed = True

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:709
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
708	        cmd = bser.dumps(*args)  # Defaults to BSER v1
709	        self.transport.write(cmd)
710	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:734
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
733	
734	        self.send(["version", {bserv2_key: ["bser-v2"]}])
735	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:782
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
781	            cmd = bser.dumps(*args)
782	        self.transport.write(cmd)
783	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:824
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
823	        cmd = cmd.encode("ascii")
824	        self.transport.write(cmd + b"\n")
825	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:1020
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1019	    def __del__(self):
1020	        self.close()
1021	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:1023
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1022	    def __enter__(self):
1023	        self._connect()
1024	        return self

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:1027
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1026	    def __exit__(self, exc_type, exc_value, exc_traceback):
1027	        self.close()
1028	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:1031
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
1030	        if self.tport:
1031	            self.tport.close()
1032	            self.tport = None

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:1051
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1050	
1051	        self._connect()
1052	        result = self.recvConn.receive()

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:1140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
1139	        log("calling client.query")
1140	        self._connect()
1141	        try:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/__init__.py:1142
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
1141	        try:
1142	            self.sendConn.send(args)
1143	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pywatchman-2.0.0/pywatchman-2.0.0/pywatchman/windows.py:285
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
284	        while len(buff) > 0:
285	            x = self.send(buff)
286	            if x > 0:

--------------------------------------------------

Code scanned:
	Total lines of code: 2006
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 2.0
		High: 33.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 33.0
		High: 2.0
Files skipped (0):
