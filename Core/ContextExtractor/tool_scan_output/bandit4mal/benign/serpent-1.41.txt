Run started:2025-04-12 13:50:56.939032

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/serpent.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
169	    else:
170	        b64 = base64.b64encode(data)
171	        return repr({

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/serpent.py:170
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
169	    else:
170	        b64 = base64.b64encode(data)
171	        return repr({

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/serpent.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
191	        try:
192	            return base64.b64decode(obj["data"])
193	        except TypeError:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/serpent.py:192
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
191	        try:
192	            return base64.b64decode(obj["data"])
193	        except TypeError:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/serpent.py:194
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
193	        except TypeError:
194	            return base64.b64decode(obj["data"].encode("ascii"))  # needed for certain older versions of pypy
195	    raise TypeError("argument is neither bytes nor serpent base64 encoded bytes dict")

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/serpent.py:194
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
193	        except TypeError:
194	            return base64.b64decode(obj["data"].encode("ascii"))  # needed for certain older versions of pypy
195	    raise TypeError("argument is neither bytes nor serpent base64 encoded bytes dict")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/setup.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	    author_email='irmen@razorvine.net',
33	    url='https://github.com/irmen/Serpent',
34	    description='Serialization based on ast.literal_eval',

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/setup.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	    description='Serialization based on ast.literal_eval',
35	    long_description="""
36	Serpent is a simple serialization library based on ast.literal_eval.
37	
38	Because it only serializes literals and recreates the objects using ast.literal_eval(),
39	the serialized data is safe to transport to other machines (over the network for instance)
40	and de-serialize it there.
41	
42	*There is also a Java and a .NET (C#) implementation available. This allows for easy data transfer between the various ecosystems.
43	You can get the full source distribution, a Java .jar file, and a .NET assembly dll.*
44	The java library can be obtained from Maven central (groupid ``net.razorvine`` artifactid ``serpent``),
45	and the .NET assembly can be obtained from Nuget.org (package ``Razorvine.Serpent``).
46	
47	
48	**API**
49	
50	- ``ser_bytes = serpent.dumps(obj, indent=False, module_in_classname=False):``      # serialize obj tree to bytes
51	- ``obj = serpent.loads(ser_bytes)``     # deserialize bytes back into object tree
52	- You can use ``ast.literal_eval`` yourself to deserialize, but ``serpent.deserialize``
53	  works around a few corner cases. See source for details.
54	
55	Serpent is more sophisticated than a simple repr() + literal_eval():
56	
57	- it serializes directly to bytes (utf-8 encoded), instead of a string, so it can immediately be saved to a file or sent over a socket
58	- it encodes byte-types as base-64 instead of inefficient escaping notation that repr would use (this does mean you have
59	  to base-64 decode these strings manually on the receiving side to get your bytes back.
60	  You can use the serpent.tobytes utility function for this.)
61	- it contains a few custom serializers for several additional Python types such as uuid, datetime, array and decimal
62	- it tries to serialize unrecognised types as a dict (you can control this with __getstate__ on your own types)
63	- it can create a pretty-printed (indented) output for readability purposes
64	- it outputs the keys of sets and dicts in alphabetical order (when pretty-printing)
65	- it works around a few quirks of ast.literal_eval() on the various Python implementations
66	
67	Serpent allows comments in the serialized data (because it is just Python source code).
68	Serpent can't serialize object graphs (when an object refers to itself); it will then crash with a ValueError pointing out the problem.
69	
70	Works with Python 3 recent versions.
71	
72	**FAQ**
73	
74	- Why not use XML? Answer: because XML.
75	- Why not use JSON? Answer: because JSON is quite limited in the number of datatypes it supports, and you can't use comments in a JSON file.
76	- Why not use pickle? Answer: because pickle has security problems.
77	- Why not use ``repr()``/``ast.literal_eval()``? See above; serpent is a superset of this and provides more convenience.
78	  Serpent provides automatic serialization mappings for types other than the builtin primitive types.
79	  ``repr()`` can't serialize these to literals that ``ast.literal_eval()`` understands.
80	- Why not a binary format? Answer: because binary isn't readable by humans.
81	- But I don't care about readability. Answer: doesn't matter, ``ast.literal_eval()`` wants a literal string, so that is what we produce.
82	- But I want better performance. Answer: ok, maybe you shouldn't use serpent in this case. Find an efficient binary protocol (protobuf?)
83	- Why only Python, Java and C#/.NET, but no bindings for insert-favorite-language-here? Answer: I don't speak that language.
84	  Maybe you could port serpent yourself?
85	- Where is the source?  It's on Github: https://github.com/irmen/Serpent
86	- Can I use it everywhere?  Sure, as long as you keep the copyright and disclaimer somewhere. See the LICENSE file.
87	
88	**Demo**
89	
90	.. code:: python
91	
92	 # -*- coding: utf-8 -*-
93	 import ast
94	 import uuid
95	 import datetime
96	 import pprint
97	 import serpent
98	
99	
100	 class DemoClass:
101	     def __init__(self):
102	         self.i=42
103	         self.b=False
104	
105	 data = {
106	     "names": ["Harry", "Sally", "Peter"],
107	     "big": 2**200,
108	     "colorset": { "red", "green" },
109	     "id": uuid.uuid4(),
110	     "timestamp": datetime.datetime.now(),
111	     "class": DemoClass(),
112	     "unicode": "€"
113	 }
114	
115	 # serialize it
116	 ser = serpent.dumps(data, indent=True)
117	 open("data.serpent", "wb").write(ser)
118	
119	 print("Serialized form:")
120	 print(ser.decode("utf-8"))
121	
122	 # read it back
123	 data = serpent.load(open("data.serpent", "rb"))
124	 print("Data:")
125	 pprint.pprint(data)
126	
127	 # you can also use ast.literal_eval if you like
128	 ser_string = open("data.serpent", "r", encoding="utf-8").read()
129	 data2 = ast.literal_eval(ser_string)
130	
131	 assert data2==data
132	
133	
134	When you run this it prints:
135	
136	.. code:: python
137	
138	 Serialized form:
139	 # serpent utf-8 python3.2
140	 {
141	   'big': 1606938044258990275541962092341162602522202993782792835301376,
142	   'class': {
143	     '__class__': 'DemoClass',
144	     'b': False,
145	     'i': 42
146	   },
147	   'colorset': {
148	     'green',
149	     'red'
150	   },
151	   'id': 'e461378a-201d-4844-8119-7c1570d9d186',
152	   'names': [
153	     'Harry',
154	     'Sally',
155	     'Peter'
156	   ],
157	   'timestamp': '2013-04-02T00:23:00.924000',
158	   'unicode': '€'
159	 }
160	 Data:
161	 {'big': 1606938044258990275541962092341162602522202993782792835301376,
162	  'class': {'__class__': 'DemoClass', 'b': False, 'i': 42},
163	  'colorset': {'green', 'red'},
164	  'id': 'e461378a-201d-4844-8119-7c1570d9d186',
165	  'names': ['Harry', 'Sally', 'Peter'],
166	  'timestamp': '2013-04-02T00:23:00.924000',
167	  'unicode': '€'}
168	    """,
169	
170	    keywords="serialization",

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/tests/test_serpent.py:801
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
800	        with open(datafile, "rb") as dfile:
801	            data = dfile.read()
802	        obj = serpent.loads(data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/tests/test_serpent.py:1041
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1040	    def testThreadsafeTypeRegistrations(self):
1041	        reg = RegisterThread()
1042	        ser = SerializationThread()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/tests/test_serpent.py:1042
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1041	        reg = RegisterThread()
1042	        ser = SerializationThread()
1043	        reg.daemon = ser.daemon = True

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/serpent-1.41/serpent-1.41/tests/test_unicode_parse.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
13	    with io.open(f, "rb") as inf:
14	        data = inf.read()
15	        data = re.split(b"~\n~\n", data)[:-1]

--------------------------------------------------

Code scanned:
	Total lines of code: 1811
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 5.0
		High: 7.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 3.0
Files skipped (0):
