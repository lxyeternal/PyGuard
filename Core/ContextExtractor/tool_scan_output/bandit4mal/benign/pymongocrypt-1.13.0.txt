Run started:2025-04-12 10:40:22.416356

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/pymongocrypt/asynchronous/credentials.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    url = (
37	        "http://%s/computeMetadata/v1/instance/service-accounts/default/token"
38	        % metadata_host
39	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/pymongocrypt/asynchronous/credentials.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	
82	    url = "http://169.254.169.254/metadata/identity/oauth2/token"
83	    url += "?api-version=2018-02-01"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/pymongocrypt/asynchronous/credentials.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	    url += "?api-version=2018-02-01"
84	    url += "&resource=https://vault.azure.net"
85	    headers = {"Metadata": "true", "Accept": "application/json"}

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/pymongocrypt/binding.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	ffi.cdef(
34	    """
35	/*
36	 * Copyright 2019-present MongoDB, Inc.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/pymongocrypt/synchronous/credentials.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	    url = (
37	        "http://%s/computeMetadata/v1/instance/service-accounts/default/token"
38	        % metadata_host
39	    )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/pymongocrypt/synchronous/credentials.py:82
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
81	
82	    url = "http://169.254.169.254/metadata/identity/oauth2/token"
83	    url += "?api-version=2018-02-01"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/pymongocrypt/synchronous/credentials.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
83	    url += "?api-version=2018-02-01"
84	    url += "&resource=https://vault.azure.net"
85	    headers = {"Metadata": "true", "Accept": "application/json"}

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/performance/perf_test.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
59	    with open(os.path.join(os.path.dirname(__file__), filename), **kwargs) as fp:
60	        return fp.read()
61	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/performance/perf_test.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
63	def json_data(filename):
64	    return json_util.loads(read(filename))
65	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/performance/perf_test.py:75
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
74	        with open(OUTPUT_FILE, "w") as opf:
75	            opf.write(output)
76	    else:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/performance/perf_test.py:131
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
130	        for n_threads in [1, 2, 8, 64]:
131	            with ThreadPoolExecutor(max_workers=n_threads) as executor:
132	                self.results = []

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_crypto.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
35	        with MongoCryptBinaryIn(b"1" * 256) as output, MongoCryptBinaryIn(
36	            base64.b64decode(key_b64)
37	        ) as key, MongoCryptBinaryIn(value) as value:

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_crypto.py:36
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
35	        with MongoCryptBinaryIn(b"1" * 256) as output, MongoCryptBinaryIn(
36	            base64.b64decode(key_b64)
37	        ) as key, MongoCryptBinaryIn(value) as value:

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_crypto.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
42	            self.assertTrue(retval)
43	            self.assertEqual(output.to_bytes(), base64.b64decode(ciphertext_b64))
44	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_crypto.py:43
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
42	            self.assertTrue(retval)
43	            self.assertEqual(output.to_bytes(), base64.b64decode(ciphertext_b64))
44	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:59
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
58	def to_base64(data):
59	    b64 = base64.b64encode(data)
60	    if not PY3:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:59
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
58	def to_base64(data):
59	    b64 = base64.b64encode(data)
60	    if not PY3:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:288
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
287	        kms_dict = copy.deepcopy(base_kms_dict)
288	        kms_dict["local"]["key"] = base64.b64encode(b"\x00" * 96)
289	        options = MongoCryptOptions(kms_dict)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:288
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
287	        kms_dict = copy.deepcopy(base_kms_dict)
288	        kms_dict["local"]["key"] = base64.b64encode(b"\x00" * 96)
289	        options = MongoCryptOptions(kms_dict)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:625
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
624	            data = {"access_token": "foo"}
625	            url = "http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token"
626	            router.add(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:768
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
767	                data = {"access_token": "foo"}
768	                url = "http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token"
769	                router.add(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:950
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
949	            master_key = {"region": "region", "key": "key", "endpoint": "example.com"}
950	            key_material = base64.b64decode(
951	                "xPTAjBRG5JiPm+d3fj6XLi2q5DMXUS/f1f+SMAlhhwkhDRL0kr8r9GDLIGTAGlvC+HVjSIgdL+RKwZCvpXSyxTICWSXTUYsWYPyu3IoHbuBZdmw2faM3WhcRIgbMReU5"
952	            )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:950
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
949	            master_key = {"region": "region", "key": "key", "endpoint": "example.com"}
950	            key_material = base64.b64decode(
951	                "xPTAjBRG5JiPm+d3fj6XLi2q5DMXUS/f1f+SMAlhhwkhDRL0kr8r9GDLIGTAGlvC+HVjSIgdL+RKwZCvpXSyxTICWSXTUYsWYPyu3IoHbuBZdmw2faM3WhcRIgbMReU5"
952	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1039
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1038	            data = {"access_token": "foo", "expires_in": 4000}
1039	            url = "http://169.254.169.254/metadata/identity/oauth2/token"
1040	            router.add(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1053
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1052	        with respx.mock(using="httpx") as router:
1053	            url = "http://169.254.169.254/metadata/identity/oauth2/token"
1054	            router.add(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1067
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1066	        with respx.mock(using="httpx") as router:
1067	            url = "http://169.254.169.254/metadata/identity/oauth2/token"
1068	            router.add(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1081
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1080	        with respx.mock(using="httpx") as router:
1081	            url = "http://169.254.169.254/metadata/identity/oauth2/token"
1082	            router.add(respx.get(url=url).mock(return_value=httpx.Response(404)))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1093
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1092	        with respx.mock(using="httpx") as router:
1093	            url = "http://169.254.169.254/metadata/identity/oauth2/token"
1094	            router.add(respx.get(url=url).mock(return_value=httpx.Response(500)))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1104	        with respx.mock(using="httpx") as router:
1105	            url = "http://169.254.169.254/metadata/identity/oauth2/token"
1106	            router.add(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1119	            data = {"access_token": "foo", "expires_in": 4000}
1120	            url = "http://169.254.169.254/metadata/identity/oauth2/token"
1121	            router.add(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1140	            data = {"access_token": "foo", "expires_in": 10}
1141	            url = "http://169.254.169.254/metadata/identity/oauth2/token"
1142	            router.add(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1156
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1155	        with respx.mock(using="httpx") as router:
1156	            url = "http://169.254.169.254/metadata/identity/oauth2/token"
1157	            router.add(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1370
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
1369	        master_key = {"region": "region", "key": "key", "endpoint": "example.com"}
1370	        key_material = base64.b64decode(
1371	            "xPTAjBRG5JiPm+d3fj6XLi2q5DMXUS/f1f+SMAlhhwkhDRL0kr8r9GDLIGTAGlvC+HVjSIgdL+RKwZCvpXSyxTICWSXTUYsWYPyu3IoHbuBZdmw2faM3WhcRIgbMReU5"
1372	        )

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1370
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
1369	        master_key = {"region": "region", "key": "key", "endpoint": "example.com"}
1370	        key_material = base64.b64decode(
1371	            "xPTAjBRG5JiPm+d3fj6XLi2q5DMXUS/f1f+SMAlhhwkhDRL0kr8r9GDLIGTAGlvC+HVjSIgdL+RKwZCvpXSyxTICWSXTUYsWYPyu3IoHbuBZdmw2faM3WhcRIgbMReU5"
1372	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1465
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1464	    with open(os.path.join(DATA_DIR, filename), **kwargs) as fp:
1465	        return fp.read()
1466	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1475	def json_data(filename):
1476	    return json_util.loads(read(filename), json_options=JSON_OPTS)
1477	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/pymongocrypt-1.13.0/pymongocrypt-1.13.0/test/test_mongocrypt.py:1484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1483	def http_data(filename):
1484	    data = read(filename, mode="rb")
1485	    return data.replace(b"\n", b"\r\n")

--------------------------------------------------

Code scanned:
	Total lines of code: 4808
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 24.0
		High: 13.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 31.0
		High: 6.0
Files skipped (0):
