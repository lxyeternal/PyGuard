Run started:2025-04-12 18:22:11.686947

Test results:
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/__init__.py:14
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
13	    from signal import signal, SIGPIPE, SIG_DFL
14	    signal(SIGPIPE, SIG_DFL)
15	except ImportError as exc:

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/__init__.py:14
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
13	    from signal import signal, SIGPIPE, SIG_DFL
14	    signal(SIGPIPE, SIG_DFL)
15	except ImportError as exc:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/align.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
115	            if show:
116	                print(open(matrix).read(), end='')
117	            mat = substitution_matrices.read(matrix)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/align.py:117
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
116	                print(open(matrix).read(), end='')
117	            mat = substitution_matrices.read(matrix)
118	        else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/align.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
122	                path = os.path.join(path, "data", matrix)
123	                print(open(path).read(), end='')
124	    except Exception as exc:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/api/ena.py:3
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
2	
3	URL = 'https://rest.ensembl.org'
4	
5	ENA_SEARCH_URL = f"{URL}/lookup/id"

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/api/ena.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
11	    conn = f"{url}/{acc}"
12	    r = requests.get(conn, headers={"Content-Type": "application/json"})
13	    if not r.ok:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/api/ena_fastq.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	# ENA API points
13	ENA_API = "https://www.ebi.ac.uk/ena/portal/api"
14	ENA_FIELDS = f"{ENA_API}/returnFields"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/api/ncbi_datasets.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	
5	DS_REPORT = 'https://api.ncbi.nlm.nih.gov/datasets/v2alpha/genome/accession/GCA_000001405/dataset_report'
6	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/code.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	
5	URL = "http://data.biostarhandbook.com/make/code.tar.gz"
6	
7	@plac.flg('update', "update existing files", abbrev="u")
8	def run(update=False):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/code.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
16	    # Download the data.
17	    resp = requests.get(URL)
18	    resp.raise_for_status()

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/code.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
20	    # Extract the data.
21	    tar = tarfile.open(fileobj=io.BytesIO(resp.content))
22	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/code.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	            print(f"# Updated {len(found)} files.")
56	    print("# Biostar Workflows: https://www.biostarhandbook.com/")
57	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/enrichr.py:49
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
48	
49	        ENRICHR_URL = 'https://maayanlab.cloud/Enrichr/addList'
50	        genes_str = '\n'.join(genes)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/enrichr.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
59	
60	        response = requests.post(ENRICHR_URL, files=payload)
61	        if not response.ok:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/enrichr.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	
66	        print(f"# User list id: {data.get('userListId')}")
67	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/enrichr.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
77	        # Construct the URL.
78	        export_url = f'https://maayanlab.cloud/Enrichr/export?userListId={userListId}&backgroundType={library}'
79	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/enrichr.py:81
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
80	        # Submit the request.
81	        response = requests.get(export_url, stream=True)
82	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/fetch.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
160	    # Output may contain errors, empty rows and
161	    items = filter(lambda x: len(x.get("Run")) > 5, reader)
162	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/fetch.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
202	def fetch_ncbi_gff(ids, db="nuccore"):
203	    url = "https://www.ncbi.nlm.nih.gov/sviewer/viewer.cgi"
204	    params = dict(db=db, report='gff3', id=ids)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/fetch.py:206
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
205	    try:
206	        r = requests.get(url, params=params)
207	        for chunk in r.iter_content(chunk_size=1024):

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/fetch.py:252
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
251	
252	    ext = EXTMAP.get(format_) or "gbff"
253	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/fetch.py:255
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
254	    for elem in coll:
255	        url = elem.get("ftp_path")
256	        name = url.split("/")[-1]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/fetch.py:261
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
260	        try:
261	            r = requests.get(url, stream=True)
262	            f = gzip.GzipFile(fileobj=r.raw)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/fetch.py:273
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
272	
273	    server = "https://rest.ensembl.org"
274	
275	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/fetch.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
279	
280	            r = requests.get(server + ext, headers={"Content-Type": "text/x-fasta"})
281	

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/libs/sqlitedict.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
57	            _locs_ = _globs_
58	        exec("""exec _code_ in _globs_, _locs_""")
59	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/libs/sqlitedict.py:179
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
178	    def _new_conn(self):
179	        return SqliteMultithread(self.filename, autocommit=self.autocommit, journal_mode=self.journal_mode)
180	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/libs/xmltodict.py:359
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
358	            # Attempt to disable DTD in Jython's expat parser (Xerces-J).
359	            feature = "http://apache.org/xml/features/disallow-doctype-decl"
360	            parser._reader.setFeature(feature, True)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/main.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
65	# Fill help section into the usage.
66	USAGE = f"""
67	bio: making bioinformatics fun again 
68	
69	{block}
70	
71	Run each command for more help.
72	
73	Examples:
74	
75	  bio fetch NC_045512 MN996532 > genomes.gb
76	  bio fasta genomes.gb --gene S | bio align
77	  bio gff genomes.gb --type CDS
78	  bio taxon 2697049 --lineage
79	  bio align GATTACA GATCA  
80	  bio explain exon 
81	  bio mygene HAD3 -fields refseq
82	 
83	See also: https://www.bioinfo.help
84	
85	Version: {VERSION}
86	"""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/mart.py:9
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
8	
9	HOST = 'https://www.biomart.org'
10	PATH = '/biomart/martservice'

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/mart.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
11	
12	url = 'http://www.ensembl.org/biomart/martservice'
13	
14	query2 = '''

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/mart.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
34	
35	    resp = requests.get(url, params=params)
36	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/mart.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
63	
64	    resp = requests.get(url, params=params, stream=True)
65	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/meta.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	
35	    url = f"https://api.ncbi.nlm.nih.gov/datasets/v1alpha/virus/taxon/{taxid}/genome/table"
36	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/meta.py:53
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
52	
53	    conn = requests.get(url, stream=True, params=params)
54	    lines = conn.iter_lines()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	GO_PATH = utils.cache_path(GO_FILE)
16	GO_URL = "http://purl.obolibrary.org/obo/go.obo"
17	
18	# De
19	# Sequence Ontology file
20	SO_FILE = "so.obo"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	SO_PATH = utils.cache_path(SO_FILE)
22	SO_URL = "https://raw.githubusercontent.com/The-Sequence-Ontology/SO-Ontologies/master/Ontology_Files/so-simple.obo"
23	
24	ROOT_URL = "http://www.bioinfo.help/data/"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
23	
24	ROOT_URL = "http://www.bioinfo.help/data/"
25	
26	# Stores the Sqlite database.
27	SQLITE_FILE = "ontology.sqlite"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
79	            utils.error(f"file not found (download or build it first): {JSON_PATH}")
80	        store = json.load(open(JSON_PATH))
81	        terms = store[TERM]

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:143
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
142	    # The ontology file, with both sequence and gene info.
143	    stream = open(fname, mode="r", encoding="utf-8")
144	    stream = islice(stream, LIMIT)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
239	    store = dict(TERMS=terms, GRAPH=nodes, NAMES=names, CHILDREN=back_prop, RELATED=back_prop)
240	    fp = open(JSON_PATH, "wt")
241	    json.dump(store, fp, indent=4)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
255	
256	    parents = nodes.get(start, [])
257	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:304
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
303	        printer(uids=parents, terms=terms, prefix=prefix)
304	    children = nodes.get(uid, [])
305	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:339
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
338	    for depth, uid in enumerate(tree):
339	        vals = terms.get(uid)
340	        if vals:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:349
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
348	
349	    parents = back_prop.get(start, [])
350	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
377	    # The query is an exact match, print info.
378	    if names.get(query) or terms.get(query):
379	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:378
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
377	    # The query is an exact match, print info.
378	    if names.get(query) or terms.get(query):
379	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:381
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
380	        # Get the GO or SO id
381	        uid = names.get(query) or query
382	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:392
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
391	        # Get the parents.
392	        parents = back_prop.get(uid,[])
393	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
427	
428	    if names.get(query) or terms.get(query):
429	        uid = names.get(query) or query

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:428
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
427	
428	    if names.get(query) or terms.get(query):
429	        uid = names.get(query) or query

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:429
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
428	    if names.get(query) or terms.get(query):
429	        uid = names.get(query) or query
430	    else:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:446
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
445	        # Get all children for this node present in tree
446	        children = nodes.get(item, [])
447	        chls = [c for c in children if c[0] in collect]

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:448
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
447	        chls = [c for c in children if c[0] in collect]
448	        name, define = terms.get(item)
449	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:453
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
452	            chl, etype = child
453	            cname, cdefine = terms.get(chl)
454	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:468
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
467	    # Highlight the query term.
468	    name, define = terms.get(uid)
469	    try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
481	    if outname.endswith('.dot'):
482	        open(outname, 'w').write(grph.to_string())
483	    else:

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/ontology.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
481	    if outname.endswith('.dot'):
482	        open(outname, 'w').write(grph.to_string())
483	    else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/parser.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	        if size is None:
90	            return self.buffer.read() + self.stream.read()
91	        content = self.buffer.read(size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/parser.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	        if size is None:
90	            return self.buffer.read() + self.stream.read()
91	        content = self.buffer.read(size)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/parser.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
90	            return self.buffer.read() + self.stream.read()
91	        content = self.buffer.read(size)
92	        if len(content) < size:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/parser.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
92	        if len(content) < size:
93	            content += self.stream.read(size - len(content))
94	        return content

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/parser.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	    def __iter__(self):
103	        data = self.buffer.read()
104	        if data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/parser.py:111
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
110	    def __next__(self):
111	        data = self.buffer.read() or next(self.stream)
112	        if not data:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/parser.py:149
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
148	def parse_json(stream):
149	    text = stream.read()
150	    json_list = json.loads(text)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	# ENA API points
23	ENA_API = "https://www.ebi.ac.uk/ena/portal/api"
24	ENA_FIELDS = f"{ENA_API}/returnFields"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
27	# The assembly summary file
28	ASSEMBLY_SUMMARY_URL = 'https://ftp.ncbi.nlm.nih.gov/genomes/ASSEMBLY_REPORTS/assembly_summary_genbank.txt'
29	ASSEMBLY_SUMMARY_PATH = "assembly_summary_genbank.txt"

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
45	    params = dict(dataPortal=db, result='read_run')
46	    stream = get_request(url=ENA_FIELDS, params=params, sep="\t")
47	    fields = [r['columnId'] for r in stream]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
55	
56	    url = 'https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi'
57	
58	    params = dict(db=db, format=format, id=text)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:60
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
59	
60	    stream = get_request(url, params=params, bulk=True)
61	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:66
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
65	
66	    data = data.get("result", {})
67	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
138	
139	    stream = get_request(url, params=params, sep=sep)
140	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
153	
154	            paired =  entry.get('library_layout') == 'PAIRED'
155	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:294
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
293	
294	        r = requests.get(url, params=params)
295	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:321
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
320	
321	    total = data.get('total', 0)
322	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:324
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
323	    # Get rid of data we don't need
324	    hits = data.get('hits', [])
325	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
332	        del hit['_score']
333	        hit['taxname'] = names.get(hit.get('taxid'), [''])[0]
334	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search.py:333
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
332	        del hit['_score']
333	        hit['taxname'] = names.get(hit.get('taxid'), [''])[0]
334	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/search2.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	# ENA API urls.
47	ENA_API = "https://www.ebi.ac.uk/ena/portal/api"
48	ENA_FIELDS = f"{ENA_API}/returnFields"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/taxon.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	TAXDB_PATH = utils.cache_path(TAXDB_FILE)
25	TAXDB_URL = "http://ftp.ncbi.nih.gov/pub/taxonomy/taxdump.tar.gz"
26	
27	# Keys into the database
28	GRAPH, BACK, TAXID = "GRAPH", "BACK", "TAXIDS"

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/taxon.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
77	    store = {TAXID: tax2data, GRAPH: graph}
78	    fp = open(json_path, 'wt')
79	    json.dump(store, fp, indent=4)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/taxon.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
86	    """
87	    tar = tarfile.open(archive, "r:gz")
88	    mem = tar.getmember(filename)

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/taxon.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
262	            utils.error(f"taxonomy file not found (you must build it first): {JSON_PATH}")
263	        store = json.load(open(JSON_PATH))
264	        names = store[TAXID]

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/taxon.py:353
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
352	            utils.error(msg)
353	        stream = open(terms[0])
354	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/test.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
79	
80	    text = open(USAGE).read()
81	    cmds = parse_commands(text, flag=True)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/test.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
95	            shell(cmd)
96	            result = open(join(RUN_DIR, fname)).read()
97	            expect = open(join(DATA_DIR, fname)).read()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/test.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
96	            result = open(join(RUN_DIR, fname)).read()
97	            expect = open(join(DATA_DIR, fname)).read()
98	        except Exception as exc:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
138	        # print("*** opening stdin", file=sys.stderr)
139	        stream = StringIO(sys.stdin.read())
140	        yield stream

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
226	    try:
227	        r = requests.get(url, params=params)
228	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
241	    try:
242	        r = requests.get(url, stream=True)
243	        r.raise_for_status()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	    # Open request to file
260	    r = requests.get(url, stream=True, params=params)
261	    try:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:292
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
291	    headers = lower_case_keys(r.headers)
292	    size = headers.get("content-length", 0)
293	    total = int_or_zero(size)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
311	            total += len(chunk)
312	            fp.write(chunk)
313	            pbar.update(len(chunk))

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:312
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
311	            total += len(chunk)
312	            fp.write(chunk)
313	            pbar.update(len(chunk))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:330
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
329	
330	ROOT_URL = "http://www.bioinfo.help/data/"
331	
332	
333	def download_prebuilt(fname='biodata.tar.gz'):

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:345
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
344	
345	    fp = tarfile.open(path)
346	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
430	    """
431	    stream = gzip.open(fname, flag, compresslevel=3) if fname.endswith(".gz") else open(fname, flag)
432	    return stream

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:431
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
430	    """
431	    stream = gzip.open(fname, flag, compresslevel=3) if fname.endswith(".gz") else open(fname, flag)
432	    return stream

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
438	    """
439	    stream = gzip.open(fname, flag) if fname.endswith(".gz") else open(fname, flag)
440	    return stream

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/bio-1.7.1/bio-1.7.1/biorun/utils.py:439
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
438	    """
439	    stream = gzip.open(fname, flag) if fname.endswith(".gz") else open(fname, flag)
440	    return stream

--------------------------------------------------

Code scanned:
	Total lines of code: 4990
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 76.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 99.0
		High: 2.0
Files skipped (0):
