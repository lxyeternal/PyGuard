Run started:2025-04-12 10:41:01.180000

Test results:
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
172	    def __exit__(self, type, value, traceback):
173	        self.close()
174	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
195	        self._pushed = 0
196	        self.channel.settimeout(self.socket_timeout)
197	        scp_command = self.scp_command + b' ' + (b'-t ', b'-r -t ')[recursive]

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:212
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
211	
212	        self.close()
213	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:235
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
234	        self.channel = self._open()
235	        self.channel.settimeout(self.socket_timeout)
236	        self.channel.exec_command(self.scp_command + b' -t ' +

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:240
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
239	        self._send_file(fl, remote_path, mode, size=size)
240	        self.close()
241	

--------------------------------------------------
>> Issue: [B808:settimeout] settimeout
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:280
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b808_settimeout.html
279	        self._pushed = 0
280	        self.channel.settimeout(self.socket_timeout)
281	        self.channel.exec_command(self.scp_command +

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:287
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
286	        self._recv_all()
287	        self.close()
288	

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:299
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
298	        if self.channel is not None:
299	            self.channel.close()
300	            self.channel = None

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:322
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
321	            finally:
322	                fl.close()
323	

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:329
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
328	        # which is how openssh handles it.
329	        self.channel.sendall(("C%s %d " % (mode, size)).encode('ascii') +
330	                             basename.replace(b'\n', b'\\^J') + b"\n")
331	        self._recv_confirm()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
341	        while file_pos < size:
342	            chan.sendall(fl.read(buff_size))
343	            file_pos = fl.tell()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:342
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
341	        while file_pos < size:
342	            chan.sendall(fl.read(buff_size))
343	            file_pos = fl.tell()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
345	                self._progress(basename, size, file_pos, self.peername)
346	        chan.sendall('\x00')
347	        self._recv_confirm()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:390
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
389	            self._send_time(mtime, atime)
390	        self.channel.sendall(('D%s 0 ' % mode).encode('ascii') +
391	                             basename.replace(b'\n', b'\\^J') + b'\n')
392	        self._recv_confirm()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:396
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
395	    def _send_popd(self):
396	        self.channel.sendall('E\n')
397	        self._recv_confirm()

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:401
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
400	    def _send_time(self, mtime, atime):
401	        self.channel.sendall(('T%d 0 %d 0\n' % (mtime, atime)).encode('ascii'))
402	        self._recv_confirm()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:408
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
407	        try:
408	            msg = self.channel.recv(512)
409	        except SocketTimeout:

--------------------------------------------------
>> Issue: [B806:sendall] socket.socket.sendall
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:432
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b806_sendall.html
431	            # wait for command as long as we're open
432	            self.channel.sendall('\x00')
433	            msg = self.channel.recv(1024)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:433
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
432	            self.channel.sendall('\x00')
433	            msg = self.channel.recv(1024)
434	            if not msg:  # chan closed while receiving

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:451
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
450	        except:
451	            self.channel.send(b'\x01')
452	            raise SCPException('Bad time format')

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:475
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
474	        except:
475	            chan.send('\x01')
476	            chan.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:476
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
475	            chan.send('\x01')
476	            chan.close()
477	            raise SCPException('Bad file format')

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:482
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
481	        except IOError as e:
482	            chan.send(b'\x01' + str(e).encode('utf-8'))
483	            chan.close()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
482	            chan.send(b'\x01' + str(e).encode('utf-8'))
483	            chan.close()
484	            raise

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
493	        pos = 0
494	        chan.send(b'\x00')
495	        try:

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:500
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
499	                    buff_size = size - pos
500	                data = chan.recv(buff_size)
501	                if not data:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:503
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
502	                    raise SCPException("Underlying channel was closed")
503	                file_hdl.write(data)
504	                pos = file_hdl.tell()

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:507
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
506	                    self._progress(path, size, pos, self.peername)
507	            msg = chan.recv(512)
508	            if msg and msg[0:1] != b'\x00':

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
513	            self._utime = None
514	            os.chmod(path, mode)
515	            # should we notify the other end?

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:514
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
513	            self._utime = None
514	            os.chmod(path, mode)
515	            # should we notify the other end?

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:517
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
516	        except SocketTimeout:
517	            chan.close()
518	            raise SCPException('Error receiving, socket.timeout')

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:520
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
519	        finally:
520	            file_hdl.close()
521	        # '\x00' confirmation sent in _recv_all

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
540	        except:
541	            self.channel.send(b'\x01')
542	            raise SCPException('Bad directory format')

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:547
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
546	            elif os.path.isdir(path):
547	                os.chmod(path, mode)
548	            else:

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:547
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
546	            elif os.path.isdir(path):
547	                os.chmod(path, mode)
548	            else:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/scp.py:554
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
553	        except (OSError, SCPException) as e:
554	            self.channel.send(b'\x01' + asbytes(str(e)))
555	            raise

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/setup.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
9	with io.open('README.rst', encoding='utf-8') as fp:
10	    description = fp.read()
11	setup(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/setup.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
18	        license = 'LGPL-2.1-or-later',
19	        url = 'https://github.com/jbardin/scp.py',
20	        description='scp module for paramiko',

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/test.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
20	ssh_info = {
21	    'hostname': os.environ.get('SCPPY_HOSTNAME', '127.0.0.1'),
22	    'port': int(os.environ.get('SCPPY_PORT', 22)),

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/test.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
135	            os.chdir(previous)
136	            shutil.rmtree(temp)
137	

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/test.py:214
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
213	    def tearDownClass(cls):
214	        shutil.rmtree(cls._temp)
215	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/test.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
310	        fl = BytesIO()
311	        fl.write(b'r\xC3\xA9mi')
312	        fl.seek(0)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/test.py:311
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
310	        fl = BytesIO()
311	        fl.write(b'r\xC3\xA9mi')
312	        fl.seek(0)

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/test.py:332
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
331	    def tearDownClass(cls):
332	        shutil.rmtree(cls._temp)
333	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/test.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
342	            with open(testfile, 'w') as f:
343	                f.write("TESTING\n")
344	            put(self.ssh.get_transport(), testfile, testfile_sent)

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/test.py:343
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
342	            with open(testfile, 'w') as f:
343	                f.write("TESTING\n")
344	            put(self.ssh.get_transport(), testfile, testfile_sent)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/scp-0.15.0/scp-0.15.0/test.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
347	            with open(testfile_rcvd) as f:
348	                self.assertEqual(f.read(), 'TESTING\n')
349	        finally:

--------------------------------------------------

Code scanned:
	Total lines of code: 839
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 43.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 45.0
		High: 2.0
Files skipped (0):
