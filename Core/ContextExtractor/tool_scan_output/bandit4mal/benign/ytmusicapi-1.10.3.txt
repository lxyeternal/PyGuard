Run started:2025-04-13 01:09:48.045260

Test results:
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/tests/auth/test_oauth.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        "interval": 5,
25	        "verification_url": "https://www.google.com/device",
26	    }
27	
28	
29	@pytest.fixture(name="alt_oauth_credentials")
30	def fixture_alt_oauth_credentials(config) -> OAuthCredentials:
31	    return OAuthCredentials(config["auth"]["client_id"], config["auth"]["client_secret"])

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/auth_parse.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
44	
45	    if authorization := auth_headers.get("authorization"):
46	        if "SAPISIDHASH" in authorization:

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/browser.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
17	    if not headers_raw:
18	        eof = "Ctrl-D" if platform.system() != "Windows" else "'Enter, Ctrl-Z, Enter'"
19	        print(f"Please paste the request headers from Firefox and press {eof} to continue:")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/browser.py:18
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
17	    if not headers_raw:
18	        eof = "Ctrl-D" if platform.system() != "Windows" else "'Enter, Ctrl-Z, Enter'"
19	        print(f"Please paste the request headers from Firefox and press {eof} to continue:")

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/oauth/credentials.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
78	        """Method for obtaining a new user auth code. First step of token creation."""
79	        code_response = self._send_request(OAUTH_CODE_URL, data={"scope": OAUTH_SCOPE})
80	        return code_response.json()

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/oauth/credentials.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
85	        data.update({"client_id": self.client_id})
86	        response = self._session.post(url, data, headers={"User-Agent": OAUTH_USER_AGENT})
87	        if response.status_code == 401:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/oauth/credentials.py:89
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
88	            data = response.json()
89	            issue = data.get("error")
90	            if issue == "unauthorized_client":

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/oauth/credentials.py:106
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
105	        """Method for verifying user auth code and conversion into a FullTokenDict."""
106	        response = self._send_request(
107	            OAUTH_TOKEN_URL,
108	            data={
109	                "client_secret": self.client_secret,
110	                "grant_type": "http://oauth.net/grant_type/device/1.0",
111	                "code": device_code,
112	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/oauth/credentials.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
109	                "client_secret": self.client_secret,
110	                "grant_type": "http://oauth.net/grant_type/device/1.0",
111	                "code": device_code,
112	            },
113	        )
114	        return response.json()

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/oauth/credentials.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
123	        """
124	        response = self._send_request(
125	            OAUTH_TOKEN_URL,
126	            data={
127	                "client_secret": self.client_secret,
128	                "grant_type": "refresh_token",
129	                "refresh_token": refresh_token,
130	            },

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/auth/oauth/models.py:5
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
4	
5	DefaultScope = Union[str, Literal["https://www.googleapis.com/auth/youtube"]]
6	Bearer = Union[str, Literal["Bearer"]]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/constants.py:1
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1	YTM_DOMAIN = "https://music.youtube.com"
2	YTM_BASE_API = YTM_DOMAIN + "/youtubei/v1/"
3	YTM_PARAMS = "?alt=json"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/constants.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	# fmt: on
21	OAUTH_SCOPE = "https://www.googleapis.com/auth/youtube"
22	OAUTH_CODE_URL = "https://www.youtube.com/o/oauth2/device/code"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/constants.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	OAUTH_SCOPE = "https://www.googleapis.com/auth/youtube"
22	OAUTH_CODE_URL = "https://www.youtube.com/o/oauth2/device/code"
23	OAUTH_TOKEN_URL = "https://oauth2.googleapis.com/token"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/constants.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	OAUTH_CODE_URL = "https://www.youtube.com/o/oauth2/device/code"
23	OAUTH_TOKEN_URL = "https://oauth2.googleapis.com/token"
24	OAUTH_USER_AGENT = USER_AGENT + " Cobalt/Version"

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/helpers.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
46	    cookie = SimpleCookie()
47	    cookie.load(raw_cookie.replace('"', ""))
48	    return cookie["__Secure-3PAPISID"].value

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
56	            body["params"] = prepare_order_params(order)
57	        response = self._send_request(endpoint, body)
58	        results = get_library_contents(response, MUSIC_SHELF)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
64	        if "continuations" in results:
65	            request_func = lambda additionalParams: self._send_request(endpoint, body, additionalParams)
66	            remaining_limit = None if limit is None else (limit - len(songs))

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
90	        endpoint = "browse"
91	        response = self._send_request(endpoint, body)
92	        return parse_library_albums(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:93
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
92	        return parse_library_albums(
93	            response, lambda additionalParams: self._send_request(endpoint, body, additionalParams), limit
94	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
111	        endpoint = "browse"
112	        response = self._send_request(endpoint, body)
113	        return parse_library_artists(

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
113	        return parse_library_artists(
114	            response, lambda additionalParams: self._send_request(endpoint, body, additionalParams), limit
115	        )

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
146	        endpoint = "browse"
147	        response = self._send_request(endpoint, body)
148	        results = nav(response, SINGLE_COLUMN_TAB + SECTION_LIST_ITEM + MUSIC_SHELF)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
154	        if "continuations" in results:
155	            request_func = lambda additionalParams: self._send_request(endpoint, body, additionalParams)
156	            parse_func = lambda contents: parse_uploaded_items(contents)

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:201
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
200	        endpoint = "browse"
201	        response = self._send_request(endpoint, body)
202	        album = parse_album_header(response)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:230
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
229	        headers = self.headers.copy()
230	        upload_url = f"https://upload.youtube.com/upload/usermusic/http?authuser={headers['x-goog-authuser']}"
231	        filesize = fp.stat().st_size

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
241	        headers["X-Goog-Upload-Protocol"] = "resumable"
242	        response = requests.post(upload_url, data=body, headers=headers, proxies=self.proxies)
243	        headers["X-Goog-Upload-Command"] = "upload, finalize"

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:247
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
246	        with open(fp, "rb") as file:
247	            response = requests.post(upload_url, data=file, headers=headers, proxies=self.proxies)
248	

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/mixins/uploads.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
267	        body = {"entityId": entityId}
268	        response = self._send_request(endpoint, body)
269	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/ytmusic.py:146
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
145	            try:
146	                cookie = self.base_headers.get("cookie")
147	                self.sapisid = sapisid_from_cookie(cookie)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/ytmusic.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	                self.sapisid = sapisid_from_cookie(cookie)
148	                self.origin = self.base_headers.get("origin", self.base_headers.get("x-origin"))
149	            except KeyError:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/ytmusic.py:148
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
147	                self.sapisid = sapisid_from_cookie(cookie)
148	                self.origin = self.base_headers.get("origin", self.base_headers.get("x-origin"))
149	            except KeyError:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/ytmusic.py:226
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
225	
226	        response = self._session.post(
227	            YTM_BASE_API + endpoint + self.params + additionalParams,
228	            json=body,
229	            headers=self.headers,
230	            proxies=self.proxies,
231	            cookies=self.cookies,
232	        )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/ytmusic.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
235	            message = "Server returned HTTP " + str(response.status_code) + ": " + response.reason + ".\n"
236	            error = response_text.get("error", {}).get("message")
237	            raise YTMusicServerError(message + error)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/ytmusic.py:236
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
235	            message = "Server returned HTTP " + str(response.status_code) + ": " + response.reason + ".\n"
236	            error = response_text.get("error", {}).get("message")
237	            raise YTMusicServerError(message + error)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/ytmusicapi-1.10.3/ytmusicapi-1.10.3/ytmusicapi/ytmusic.py:243
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
242	    ) -> Response:
243	        response = self._session.get(
244	            url,
245	            params=params,
246	            # handle first-use x-goog-visitor-id fetching
247	            headers=initialize_headers() if use_base_headers else self.headers,
248	            proxies=self.proxies,
249	            cookies=self.cookies,
250	        )

--------------------------------------------------

Code scanned:
	Total lines of code: 6127
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 9.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 35.0
		High: 1.0
Files skipped (0):
