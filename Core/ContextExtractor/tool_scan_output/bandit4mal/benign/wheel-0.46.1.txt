Run started:2025-04-12 10:22:47.134173

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/docs/conf.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
54	) as version_file:
55	    match = re.search(r'__version__ = "((\d+\.\d+\.\d+).*)"', version_file.read())
56	    # The short X.Y version.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/docs/conf.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
96	
97	intersphinx_mapping = {"python": ("https://docs.python.org/", None)}
98	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/convert.py:147
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
146	                    if filename == "EGG-INFO/requires.txt":
147	                        requires = zip_file.read(filename).decode("utf-8")
148	                        convert_requires(requires, self.metadata)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/convert.py:150
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
149	                    elif filename == "EGG-INFO/PKG-INFO":
150	                        pkginfo = zip_file.read(filename).decode("utf-8")
151	                        convert_pkg_info(pkginfo, self.metadata)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/convert.py:155
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
154	                            f"{self.dist_info_dir}/entry_points.txt",
155	                            zip_file.read(filename),
156	                        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/convert.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
160	                # For any other file, just pass it through
161	                yield filename, zip_file.read(filename)
162	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/convert.py:268
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
267	                    if basename == "requires.txt":
268	                        requires = zip_file.read(filename).decode("utf-8")
269	                        convert_requires(requires, self.metadata)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/convert.py:271
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
270	                    elif basename == "PKG-INFO":
271	                        pkginfo = zip_file.read(filename).decode("utf-8")
272	                        convert_pkg_info(pkginfo, self.metadata)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/convert.py:276
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
275	                            f"{dist_info_dir}/entry_points.txt",
276	                            zip_file.read(filename),
277	                        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/convert.py:284
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
283	                # For any other file, just pass it through
284	                yield target_filename, zip_file.read(filename)
285	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/tags.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
50	
51	        wheel_info = f.read(f.dist_info_path + "/WHEEL")
52	        info = BytesParser(policy=email.policy.compat32).parsebytes(wheel_info)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_commands/tags.py:135
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
134	                else:
135	                    fout.writestr(item, fin.read(item))
136	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/_metadata.py:161
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
160	        with open(requires_path, encoding="utf-8") as requires_file:
161	            requires = requires_file.read()
162	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/macosx_libfile.py:270
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
269	    magic_number = ctypes.c_uint32.from_buffer_copy(
270	        lib_file.read(ctypes.sizeof(ctypes.c_uint32))
271	    ).value

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/macosx_libfile.py:289
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
288	def read_data(struct_class: type[ctypes.Structure], lib_file: BufferedIOBase):
289	    return struct_class.from_buffer_copy(lib_file.read(ctypes.sizeof(struct_class)))
290	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/macosx_libfile.py:427
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
426	        if deploy_target < base_version:
427	            sys.stderr.write(
428	                "[WARNING] MACOSX_DEPLOYMENT_TARGET is set to a lower value ({}) than "
429	                "the version on which the Python interpreter was compiled ({}), and "
430	                "will be ignored.\n".format(
431	                    ".".join(str(x) for x in deploy_target),
432	                    ".".join(str(x) for x in base_version),
433	                )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/macosx_libfile.py:483
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
482	
483	        sys.stderr.write(error_message)
484	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/wheelfile.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
38	    """urlsafe_b64encode without padding"""
39	    return base64.urlsafe_b64encode(data).rstrip(b"=")
40	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/wheelfile.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
44	    pad = b"=" * (4 - (len(data) & 3))
45	    return base64.urlsafe_b64decode(data + pad)
46	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/wheelfile.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
119	                        algorithm,
120	                        urlsafe_b64decode(hash_sum.encode("ascii")),
121	                    )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/wheelfile.py:173
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
172	                    else:
173	                        self.write(path, arcname)
174	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/wheelfile.py:177
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
176	        for path, arcname in deferred:
177	            self.write(path, arcname)
178	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/wheelfile.py:187
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
186	            st = os.fstat(f.fileno())
187	            data = f.read()
188	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/src/wheel/wheelfile.py:223
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
222	                hash_.name,
223	                urlsafe_b64encode(hash_.digest()).decode("ascii"),
224	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/commands/test_convert.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	
17	PKG_INFO = """\
18	Metadata-Version: 2.1

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/commands/test_convert.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	
44	EXPECTED_METADATA = """\
45	Metadata-Version: 2.4

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/commands/test_convert.py:267
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
266	    # Regression test for https://github.com/pypa/wheel/issues/645
267	    pkginfo = """\
268	Metadata-Version: 2.1
269	Name: Sampledist
270	Version: 1.0.0
271	Home-page: https://example.com
272	Download-URL: https://example.com/sampledist
273	Description:"""
274	    message = Message()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/commands/test_convert.py:281
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
280	def test_convert_pkg_info_with_one_line_description() -> None:
281	    pkginfo = """\
282	Metadata-Version: 2.1
283	Name: Sampledist
284	Version: 1.0.0
285	Home-page: https://example.com
286	Download-URL: https://example.com/sampledist
287	Description:    My cool package"""
288	    message = Message()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/commands/test_pack.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
37	    with ZipFile(TESTWHEEL_PATH) as zf:
38	        old_record = zf.read("test-1.0.dist-info/RECORD")
39	        old_record_lines = sorted(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/commands/test_pack.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
63	    with ZipFile(new_wheel_path) as zf:
64	        new_record = zf.read("test-1.0.dist-info/RECORD")
65	        new_record_lines = sorted(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/commands/test_pack.py:72
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
71	        parser = BytesParser(policy=email.policy.compat32)
72	        new_wheel_file_content = parser.parsebytes(zf.read("test-1.0.dist-info/WHEEL"))
73	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/commands/test_unpack.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
41	@pytest.mark.skipif(
42	    platform.system() == "Windows", reason="Windows does not support the executable bit"
43	)

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/commands/test_unpack.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
41	@pytest.mark.skipif(
42	    platform.system() == "Windows", reason="Windows does not support the executable bit"
43	)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/test_metadata.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	        ("Version", "0.1"),
15	        ("Requires-Dist", "pip@ https://github.com/pypa/pip/archive/1.3.1.zip"),
16	        ("Requires-Dist", 'pywin32; sys_platform == "win32"'),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/test_metadata.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	        ("Requires-Dist", 'pywin32; sys_platform == "win32"'),
17	        ("Requires-Dist", 'foo@ http://host/foo.zip ; sys_platform == "win32"'),
18	        ("Provides-Extra", "signatures"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/test_metadata.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        ("Provides-Extra", "extra"),
25	        ("Requires-Dist", 'bar@ http://host/bar.zip ; extra == "extra"'),
26	        ("Provides-Extra", "faster-signatures"),

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/test_metadata.py:55
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
54	    egg_info_dir.joinpath("requires.txt").write_text(
55	        """\
56	pip@https://github.com/pypa/pip/archive/1.3.1.zip
57	
58	[extra]
59	bar @ http://host/bar.zip
60	
61	[empty+extra]
62	
63	[:sys_platform=="win32"]
64	pywin32
65	foo @http://host/foo.zip
66	
67	[faster-signatures]
68	ed25519ll
69	
70	[reST]
71	docutils>=0.8
72	
73	[signatures]
74	keyring
75	keyrings.alt
76	
77	[Signatures:sys_platform!="win32"]
78	pyxdg
79	
80	[test]
81	pytest>=3.0.0
82	pytest-cov""",
83	        encoding="utf-8",
84	    )
85	

--------------------------------------------------
>> Issue: [B834:open] tarfile.open
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/wheel-0.46.1/wheel-0.46.1/tests/test_sdist.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b834_open.html
47	    for i, sdist in enumerate([sdist_build, sdist_flit]):
48	        with tarfile.open(sdist, "r:gz") as tar:
49	            out[i] = set(tar.getnames())

--------------------------------------------------

Code scanned:
	Total lines of code: 2281
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 10.0
		High: 28.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 37.0
		High: 1.0
Files skipped (0):
