Run started:2025-04-12 13:17:53.715215

Test results:
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/pkce.py:12
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
11	    bytes_length = int(length * 3 / 4)
12	    return base64.urlsafe_b64encode(os.urandom(bytes_length)).decode("utf-8").replace("=", "")[:length]
13	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/pkce.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
18	    code_challenge = (
19	        base64.urlsafe_b64encode(hashlib.sha256(code_verifier.encode("utf-8")).digest())
20	        .decode("utf-8")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	            warnings.warn(
86	                "Please make sure you are using SSO provider in an async context (using 'async with provider:'). "
87	                "See https://github.com/tomasvotava/fastapi-sso/issues/186 for more information.",
88	                category=SecurityWarning,
89	                stacklevel=1,
90	            )
91	        return func(*args, **kwargs)

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:260
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
259	        discovery = await self.get_discovery_document()
260	        return discovery.get("authorization_endpoint")
261	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:266
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
265	        discovery = await self.get_discovery_document()
266	        return discovery.get("token_endpoint")
267	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:272
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
271	        discovery = await self.get_discovery_document()
272	        return discovery.get("userinfo_endpoint")
273	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:395
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
394	        headers = headers or {}
395	        code = request.query_params.get("code")
396	        if code is None:

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
403	            raise SSOLoginError(400, "'code' parameter was not found in callback request")
404	        self._state = request.query_params.get("state")
405	        pkce_code_verifier: Optional[str] = None

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:407
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
406	        if self.uses_pkce:
407	            pkce_code_verifier = request.cookies.get("pkce_code_verifier")
408	            if pkce_code_verifier is None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:424
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
423	        warnings.warn(
424	            "SSO Providers are supposed to be used in async context, please change 'with provider' to "
425	            "'async with provider'. See https://github.com/tomasvotava/fastapi-sso/issues/186 for more information.",
426	            DeprecationWarning,
427	            stacklevel=1,
428	        )
429	        self._oauth_client = None

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
557	
558	        token_url, headers, body = self.oauth_client.prepare_token_request(
559	            await self.token_endpoint,
560	            authorization_response=current_url,
561	            redirect_url=redirect_uri or self.redirect_uri or current_path,
562	            code=code,
563	            **params,
564	        )  # type: ignore

--------------------------------------------------
>> Issue: [B822:request] requests.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:558
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b822_request.html
557	
558	        token_url, headers, body = self.oauth_client.prepare_token_request(
559	            await self.token_endpoint,
560	            authorization_response=current_url,
561	            redirect_url=redirect_uri or self.redirect_uri or current_path,
562	            code=code,
563	            **params,
564	        )  # type: ignore

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:574
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
573	        async with httpx.AsyncClient() as session:
574	            response = await session.post(token_url, headers=headers, content=body, auth=auth)
575	            content = response.json()

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:576
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
575	            content = response.json()
576	            self._refresh_token = content.get("refresh_token")
577	            self._id_token = content.get("id_token")

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:577
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
576	            self._refresh_token = content.get("refresh_token")
577	            self._id_token = content.get("id_token")
578	            self.oauth_client.parse_request_body_response(json.dumps(content))

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/base.py:583
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
582	            session.headers.update(headers)
583	            response = await session.get(uri)
584	            content = response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/bitbucket.py:41
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
40	
41	        response = await session.get(f"https://api.bitbucket.org/{self.version}/user/emails")
42	        return response.json()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/bitbucket.py:46
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
45	        return {
46	            "authorization_endpoint": "https://bitbucket.org/site/oauth2/authorize",
47	            "token_endpoint": "https://bitbucket.org/site/oauth2/access_token",
48	            "userinfo_endpoint": f"https://api.bitbucket.org/{self.version}/user",
49	        }
50	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/bitbucket.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	            "authorization_endpoint": "https://bitbucket.org/site/oauth2/authorize",
47	            "token_endpoint": "https://bitbucket.org/site/oauth2/access_token",
48	            "userinfo_endpoint": f"https://api.bitbucket.org/{self.version}/user",
49	        }
50	
51	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/bitbucket.py:48
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
47	            "token_endpoint": "https://bitbucket.org/site/oauth2/access_token",
48	            "userinfo_endpoint": f"https://api.bitbucket.org/{self.version}/user",
49	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/discord.py:37
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
36	        return {
37	            "authorization_endpoint": "https://discord.com/oauth2/authorize",
38	            "token_endpoint": "https://discord.com/api/oauth2/token",
39	            "userinfo_endpoint": "https://discord.com/api/users/@me",
40	        }
41	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/discord.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	            "authorization_endpoint": "https://discord.com/oauth2/authorize",
38	            "token_endpoint": "https://discord.com/api/oauth2/token",
39	            "userinfo_endpoint": "https://discord.com/api/users/@me",
40	        }
41	
42	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/discord.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
38	            "token_endpoint": "https://discord.com/api/oauth2/token",
39	            "userinfo_endpoint": "https://discord.com/api/users/@me",
40	        }
41	
42	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:
43	        user_id = response.get("id")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/discord.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
46	        if user_id and avatar:
47	            picture = f"https://cdn.discordapp.com/avatars/{user_id}/{avatar}.png"
48	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/facebook.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    provider = "facebook"
15	    base_url = "https://graph.facebook.com/v19.0"
16	    scope: ClassVar = ["email"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/facebook.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	        return {
21	            "authorization_endpoint": "https://www.facebook.com/v9.0/dialog/oauth",
22	            "token_endpoint": f"{self.base_url}/oauth/access_token",
23	            "userinfo_endpoint": f"{self.base_url}/me?fields=id,name,email,first_name,last_name,picture",
24	        }
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/fitbit.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
32	        return {
33	            "authorization_endpoint": "https://www.fitbit.com/oauth2/authorize?response_type=code",
34	            "token_endpoint": "https://api.fitbit.com/oauth2/token",
35	            "userinfo_endpoint": "https://api.fitbit.com/1/user/-/profile.json",
36	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/fitbit.py:34
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
33	            "authorization_endpoint": "https://www.fitbit.com/oauth2/authorize?response_type=code",
34	            "token_endpoint": "https://api.fitbit.com/oauth2/token",
35	            "userinfo_endpoint": "https://api.fitbit.com/1/user/-/profile.json",
36	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/fitbit.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
34	            "token_endpoint": "https://api.fitbit.com/oauth2/token",
35	            "userinfo_endpoint": "https://api.fitbit.com/1/user/-/profile.json",
36	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/github.py:17
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
16	    additional_headers: ClassVar = {"accept": "application/json"}
17	    emails_endpoint = "https://api.github.com/user/emails"
18	
19	    async def get_discovery_document(self) -> DiscoveryDocument:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/github.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	        return {
21	            "authorization_endpoint": "https://github.com/login/oauth/authorize",
22	            "token_endpoint": "https://github.com/login/oauth/access_token",
23	            "userinfo_endpoint": "https://api.github.com/user",
24	        }
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/github.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	            "authorization_endpoint": "https://github.com/login/oauth/authorize",
22	            "token_endpoint": "https://github.com/login/oauth/access_token",
23	            "userinfo_endpoint": "https://api.github.com/user",
24	        }
25	
26	    async def _get_primary_email(self, session: Optional["httpx.AsyncClient"] = None) -> Optional[str]:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/github.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	            "token_endpoint": "https://github.com/login/oauth/access_token",
23	            "userinfo_endpoint": "https://api.github.com/user",
24	        }
25	
26	    async def _get_primary_email(self, session: Optional["httpx.AsyncClient"] = None) -> Optional[str]:
27	        """Attempt to get primary email from Github for a current user.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/gitlab.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	    additional_headers: ClassVar = {"accept": "application/json"}
20	    base_endpoint_url = "https://gitlab.com"
21	
22	    def __init__(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/google.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
12	
13	    discovery_url = "https://accounts.google.com/.well-known/openid-configuration"
14	    provider = "google"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/kakao.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        return {
20	            "authorization_endpoint": "https://kauth.kakao.com/oauth/authorize",
21	            "token_endpoint": "https://kauth.kakao.com/oauth/token",
22	            "userinfo_endpoint": f"https://kapi.kakao.com/{self.version}/user/me",
23	        }
24	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/kakao.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	            "authorization_endpoint": "https://kauth.kakao.com/oauth/authorize",
21	            "token_endpoint": "https://kauth.kakao.com/oauth/token",
22	            "userinfo_endpoint": f"https://kapi.kakao.com/{self.version}/user/me",
23	        }
24	
25	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/kakao.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	            "token_endpoint": "https://kauth.kakao.com/oauth/token",
22	            "userinfo_endpoint": f"https://kapi.kakao.com/{self.version}/user/me",
23	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/line.py:15
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
14	    provider = "line"
15	    base_url = "https://api.line.me/oauth2/v2.1"
16	    scope: ClassVar = ["email", "profile", "openid"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/line.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	        return {
21	            "authorization_endpoint": "https://access.line.me/oauth2/v2.1/authorize",
22	            "token_endpoint": f"{self.base_url}/token",
23	            "userinfo_endpoint": f"{self.base_url}/userinfo",
24	        }
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/linkedin.py:25
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
24	        return {
25	            "authorization_endpoint": "https://www.linkedin.com/oauth/v2/authorization",
26	            "token_endpoint": "https://www.linkedin.com/oauth/v2/accessToken",
27	            "userinfo_endpoint": "https://api.linkedin.com/v2/userinfo",
28	        }
29	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/linkedin.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	            "authorization_endpoint": "https://www.linkedin.com/oauth/v2/authorization",
26	            "token_endpoint": "https://www.linkedin.com/oauth/v2/accessToken",
27	            "userinfo_endpoint": "https://api.linkedin.com/v2/userinfo",
28	        }
29	
30	    async def openid_from_token(self, id_token: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/linkedin.py:27
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
26	            "token_endpoint": "https://www.linkedin.com/oauth/v2/accessToken",
27	            "userinfo_endpoint": "https://api.linkedin.com/v2/userinfo",
28	        }
29	
30	    async def openid_from_token(self, id_token: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:
31	        return await self.openid_from_response(id_token, session)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/microsoft.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
42	        return {
43	            "authorization_endpoint": f"https://login.microsoftonline.com/{self.tenant}/oauth2/v2.0/authorize",
44	            "token_endpoint": f"https://login.microsoftonline.com/{self.tenant}/oauth2/v2.0/token",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/microsoft.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
43	            "authorization_endpoint": f"https://login.microsoftonline.com/{self.tenant}/oauth2/v2.0/authorize",
44	            "token_endpoint": f"https://login.microsoftonline.com/{self.tenant}/oauth2/v2.0/token",
45	            "userinfo_endpoint": f"https://graph.microsoft.com/{self.version}/me",

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/microsoft.py:45
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
44	            "token_endpoint": f"https://login.microsoftonline.com/{self.tenant}/oauth2/v2.0/token",
45	            "userinfo_endpoint": f"https://graph.microsoft.com/{self.version}/me",
46	        }

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/naver.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        return {
20	            "authorization_endpoint": "https://nid.naver.com/oauth2.0/authorize",
21	            "token_endpoint": "https://nid.naver.com/oauth2.0/token",
22	            "userinfo_endpoint": "https://openapi.naver.com/v1/nid/me",
23	        }
24	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/naver.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	            "authorization_endpoint": "https://nid.naver.com/oauth2.0/authorize",
21	            "token_endpoint": "https://nid.naver.com/oauth2.0/token",
22	            "userinfo_endpoint": "https://openapi.naver.com/v1/nid/me",
23	        }
24	
25	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/naver.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	            "token_endpoint": "https://nid.naver.com/oauth2.0/token",
22	            "userinfo_endpoint": "https://openapi.naver.com/v1/nid/me",
23	        }
24	
25	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:
26	        return OpenID(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/notion.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        return {
20	            "authorization_endpoint": "https://api.notion.com/v1/oauth/authorize?owner=user",
21	            "token_endpoint": "https://api.notion.com/v1/oauth/token",
22	            "userinfo_endpoint": "https://api.notion.com/v1/users/me",
23	        }
24	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/notion.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	            "authorization_endpoint": "https://api.notion.com/v1/oauth/authorize?owner=user",
21	            "token_endpoint": "https://api.notion.com/v1/oauth/token",
22	            "userinfo_endpoint": "https://api.notion.com/v1/users/me",
23	        }
24	
25	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/notion.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	            "token_endpoint": "https://api.notion.com/v1/oauth/token",
22	            "userinfo_endpoint": "https://api.notion.com/v1/users/me",
23	        }
24	
25	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:
26	        owner = response["bot"]["owner"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/seznam.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	    provider = "seznam"
18	    base_url = "https://login.szn.cz/api/v1"
19	    scope: ClassVar = ["identity", "avatar"]  # + ["contact-phone", "adulthood", "birthday", "gender"]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/spotify.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	        return {
20	            "authorization_endpoint": "https://accounts.spotify.com/authorize",
21	            "token_endpoint": "https://accounts.spotify.com/api/token",
22	            "userinfo_endpoint": "https://api.spotify.com/v1/me",
23	        }
24	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/spotify.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	            "authorization_endpoint": "https://accounts.spotify.com/authorize",
21	            "token_endpoint": "https://accounts.spotify.com/api/token",
22	            "userinfo_endpoint": "https://api.spotify.com/v1/me",
23	        }
24	
25	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/spotify.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	            "token_endpoint": "https://accounts.spotify.com/api/token",
22	            "userinfo_endpoint": "https://api.spotify.com/v1/me",
23	        }
24	
25	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:
26	        """Return OpenID from user information provided by Spotify."""

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/twitter.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	        return {
21	            "authorization_endpoint": "https://twitter.com/i/oauth2/authorize",
22	            "token_endpoint": "https://api.twitter.com/2/oauth2/token",
23	            "userinfo_endpoint": "https://api.twitter.com/2/users/me",
24	        }
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/twitter.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	            "authorization_endpoint": "https://twitter.com/i/oauth2/authorize",
22	            "token_endpoint": "https://api.twitter.com/2/oauth2/token",
23	            "userinfo_endpoint": "https://api.twitter.com/2/users/me",
24	        }
25	
26	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/twitter.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	            "token_endpoint": "https://api.twitter.com/2/oauth2/token",
23	            "userinfo_endpoint": "https://api.twitter.com/2/users/me",
24	        }
25	
26	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:
27	        first_name, *last_name_parts = response["data"].get("name", "").split(" ")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/yandex.py:16
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
15	    scope: ClassVar = ["login:email", "login:info", "login:avatar"]
16	    avatar_url = "https://avatars.yandex.net/get-yapic"
17	
18	    async def get_discovery_document(self) -> DiscoveryDocument:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/yandex.py:21
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
20	        return {
21	            "authorization_endpoint": "https://oauth.yandex.ru/authorize",
22	            "token_endpoint": "https://oauth.yandex.ru/token",
23	            "userinfo_endpoint": "https://login.yandex.ru/info",
24	        }
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/yandex.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	            "authorization_endpoint": "https://oauth.yandex.ru/authorize",
22	            "token_endpoint": "https://oauth.yandex.ru/token",
23	            "userinfo_endpoint": "https://login.yandex.ru/info",
24	        }
25	
26	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/sso/yandex.py:23
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
22	            "token_endpoint": "https://oauth.yandex.ru/token",
23	            "userinfo_endpoint": "https://login.yandex.ru/info",
24	        }
25	
26	    async def openid_from_response(self, response: dict, session: Optional["httpx.AsyncClient"] = None) -> OpenID:
27	        """Converts Yandex user info response to OpenID object."""

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/fastapi_sso-0.18.0/fastapi_sso-0.18.0/fastapi_sso/state.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
9	    bytes_length = int(length * 3 / 4)
10	    return base64.urlsafe_b64encode(os.urandom(bytes_length)).decode("utf-8")

--------------------------------------------------

Code scanned:
	Total lines of code: 1184
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 49.0
		High: 15.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 64.0
		High: 0.0
Files skipped (0):
