Run started:2025-04-12 15:07:39.915178

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/setup.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
23	with open(path.join(here, 'README.md'), encoding='utf-8') as f:
24	    long_description = f.read()
25	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/setup.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    # The project's main homepage.
38	    url='https://github.com/IntegralDefense/splunklib',
39	
40	    # Author details
41	    author='John Davison',

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
27	    cipher = ARC4.new(memorized_password)
28	    return b64encode(cipher.encrypt(password))
29	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:28
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
27	    cipher = ARC4.new(memorized_password)
28	    return b64encode(cipher.encrypt(password))
29	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
34	    cipher = ARC4.new(memorized_password)
35	    return cipher.decrypt(b64decode(encrypted_password))
36	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:35
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
34	    cipher = ARC4.new(memorized_password)
35	    return cipher.decrypt(b64decode(encrypted_password))
36	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:110
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
109	    with open(config_path, 'w') as fp:
110	        fp.write('[splunklib]\n')
111	        if args.uri is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:112
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
111	        if args.uri is not None:
112	            fp.write('uri = {0}\n'.format(args.uri))
113	        if args.username is not None:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:114
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
113	        if args.username is not None:
114	            fp.write('username = {0}\n'.format(args.username))
115	        if args.password:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:132
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
131	                logging.debug("encrypted_password = {0}".format(encrypted_password))
132	                fp.write('encrypted_password = {0}\n'.format(encrypted_password))
133	            else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:134
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
133	            else:
134	                fp.write('password = {0}\n'.format(password))
135	                logging.warning("saving PLAIN TEXT PASSWORD (use --encrypt option)")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:139
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
138	        if args.max_result_count is not None:
139	            fp.write('max_result_count = {0}\n'.format(str(args.max_result_count)))
140	

--------------------------------------------------
>> Issue: [B810:chmod] os.chmod
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:141
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b810_chmod.html
140	
141	    os.chmod(config_path, 0o600) # sane permissions
142	    logging.debug("updated configuration")

--------------------------------------------------
>> Issue: [B315:blacklist] os.chmod
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:141
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-chmod
140	
141	    os.chmod(config_path, 0o600) # sane permissions
142	    logging.debug("updated configuration")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:159
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
158	    config = SafeConfigParser()
159	    config.read(config_path)
160	    try:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
170	                if os.stat(config_path).st_mode & stat.S_IROTH:
171	                    sys.stderr.write("""
172	
173	*** HEY CLOWN ***
174	
175	your file permissions on {0} allow anyone to read your plain text splunk password!
176	use the --save-config option with --encrypt to save your configuration with an encrypted password or chmod o-rwx this file
177	so that other people cannot read it
178	
179	*** END CLOWN MESSAGE ***
180	
181	""".format(config_path))
182	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:220
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
219	        with open(args.search_file, 'r') as fp:
220	            search_text = fp.read()
221	            # comments in the search files are lines that start with #

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunk.py:301
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
300	if args.json:
301	    output_fp.write(json.dumps({
302	        'search': query,
303	        'username': username,
304	        'uri': uri,
305	        'max_result_count': max_result_count,
306	        'result': searcher.json() }))
307	    sys.exit(0)

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunklib.py:196
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
195	                warnings.simplefilter("ignore")
196	                r = requests.post(
197	                    '{0}/servicesNS/admin/search/auth/login'.format(self.uri),
198	                    data = { 'username': self.username, 'password': self.password },
199	                    verify = False, # XXX take this out!
200	                    timeout = self.network_timeout )
201	            if r.status_code != 200:

--------------------------------------------------
>> Issue: [B821:post] requests.post
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunklib.py:228
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b821_post.html
227	                warnings.simplefilter("ignore")
228	                r = requests.post(
229	                    '{0}/servicesNS/admin/search/search/jobs'.format(self.uri),
230	                    verify = False, # XXX take this out!
231	                    headers = {
232	                        'Authorization': 'Splunk {0}'.format(self.session_key)
233	                    },
234	                    data = {
235	                        'search': query,
236	                        #'output_mode': 'csv',
237	                        'max_count': str(self.max_result_count),
238	                        #'earliest_time': splunk_time_start,
239	                        #'latest_time': splunk_time_end
240	                    },
241	                    timeout = self.network_timeout)
242	

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunklib.py:265
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
264	                warnings.simplefilter("ignore")
265	                r = requests.get(
266	                    '{0}/servicesNS/admin/search/search/jobs/{1}'.format(self.uri, self.search_id),
267	                    headers = {
268	                        'Authorization': 'Splunk {0}'.format(self.session_key)
269	                    }, 
270	                    verify = False, # XXX take this out!
271	                    timeout = self.network_timeout
272	                )

--------------------------------------------------
>> Issue: [B820:get] requests.get
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/splunklib-1.0.0/splunklib-1.0.0/splunklib.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b820_get.html
302	                warnings.simplefilter("ignore")
303	                r = requests.get(
304	                    '{0}/servicesNS/admin/search/search/jobs/{1}/results'.format(self.uri, self.search_id),
305	                    headers = {
306	                        'Authorization': 'Splunk {0}'.format(self.session_key)
307	                    }, 
308	                    params = {
309	                        'count': "0", # get all of the results
310	                        'output_mode': 'json_rows' # get the results in json format
311	                    },
312	                    verify = False, # XXX take this out!
313	                    timeout = self.network_timeout
314	                )

--------------------------------------------------

Code scanned:
	Total lines of code: 535
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 18.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 19.0
		High: 3.0
Files skipped (0):
