Run started:2025-04-13 07:05:41.615006

Test results:
>> Issue: [B803:gethostname] socket.gethostname
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_clustered_functions.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b803_gethostname.html
38	
39	    hostname = socket.gethostname()
40	    container_ip = get_i6pn()

--------------------------------------------------
>> Issue: [B302:blacklist] socket.gethostname
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_clustered_functions.py:39
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b302-socket-gethostname
38	
39	    hostname = socket.gethostname()
40	    container_ip = get_i6pn()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:102
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
101	        if self.spawned_workers < self.max_threads:
102	            threading.Thread(target=worker_thread, daemon=True).start()
103	            self.spawned_workers += 1

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:162
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
161	
162	        ignore_sigint = signal.getsignal(signal.SIGINT) == signal.SIG_IGN
163	        if not ignore_sigint:

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:348
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
347	
348	                usr1_handler = signal.signal(signal.SIGUSR1, _cancel_input_signal_handler)
349	                # run this sync code in the main thread, blocking the "userland" event loop

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:348
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
347	
348	                usr1_handler = signal.signal(signal.SIGUSR1, _cancel_input_signal_handler)
349	                # run this sync code in the main thread, blocking the "userland" event loop

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:354
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
353	                finally:
354	                    signal.signal(signal.SIGUSR1, usr1_handler)  # reset signal handler
355	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:354
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
353	                finally:
354	                    signal.signal(signal.SIGUSR1, usr1_handler)  # reset signal handler
355	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:540
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
539	            # may have been sent to cancel inputs.
540	            int_handler = signal.signal(signal.SIGINT, signal.SIG_IGN)
541	            usr1_handler = signal.signal(signal.SIGUSR1, signal.SIG_IGN)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:540
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
539	            # may have been sent to cancel inputs.
540	            int_handler = signal.signal(signal.SIGINT, signal.SIG_IGN)
541	            usr1_handler = signal.signal(signal.SIGUSR1, signal.SIG_IGN)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:541
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
540	            int_handler = signal.signal(signal.SIGINT, signal.SIG_IGN)
541	            usr1_handler = signal.signal(signal.SIGUSR1, signal.SIG_IGN)
542	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:541
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
540	            int_handler = signal.signal(signal.SIGINT, signal.SIG_IGN)
541	            usr1_handler = signal.signal(signal.SIGUSR1, signal.SIG_IGN)
542	

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:569
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
568	                # test runs `main()` multiple times in the same process.
569	                signal.signal(signal.SIGINT, int_handler)
570	                signal.signal(signal.SIGUSR1, usr1_handler)

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:569
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
568	                # test runs `main()` multiple times in the same process.
569	                signal.signal(signal.SIGINT, int_handler)
570	                signal.signal(signal.SIGUSR1, usr1_handler)

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:570
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
569	                signal.signal(signal.SIGINT, int_handler)
570	                signal.signal(signal.SIGUSR1, usr1_handler)
571	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:570
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
569	                signal.signal(signal.SIGINT, int_handler)
570	                signal.signal(signal.SIGUSR1, usr1_handler)
571	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_container_entrypoint.py:580
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
579	        raise RuntimeError("No path to the container arguments file provided!")
580	    container_args.ParseFromString(open(container_arguments_path, "rb").read())
581	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_functions.py:519
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
518	                    + (f"e.g.:\nimage_with_source = my_image.add_local_python_source({python_stringified_modules})\n\n")
519	                    + "For more information, see https://modal.com/docs/guide/modal-1-0-migration",
520	                )
521	            all_mounts += auto_mounts.values()
522	
523	        retry_policy = _parse_retries(
524	            retries, f"Function '{info.get_tag()}'" if info.raw_f else f"Class '{info.get_tag()}'"
525	        )
526	
527	        if retry_policy is not None:
528	            if webhook_config is not None:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_functions.py:611
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
610	                raise InvalidError(
611	                    """Webhooks cannot be generators. If you want a streaming response, see https://modal.com/docs/guide/streaming-endpoints
612	                    """
613	                )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_functions.py:1181
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1180	            (2025, 1, 27),
1181	            "`modal.Function.lookup` is deprecated and will be removed in a future release."
1182	            " It can be replaced with `modal.Function.from_name`."
1183	            "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
1184	        )

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_output.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
41	
42	if platform.system() == "Windows":
43	    default_spinner = "line"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_output.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
41	
42	if platform.system() == "Windows":
43	    default_spinner = "line"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_partial_function.py:690
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
689	        (2025, 1, 15),
690	        "The `@modal.build` decorator is deprecated and will be removed in a future release."
691	        "\n\nWe now recommend storing large assets (such as model weights) using a `modal.Volume`"
692	        " instead of writing them directly into the `modal.Image` filesystem."
693	        " For other use cases we recommend using `Image.run_function` instead."

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_proxy_tunnel.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
17	        f = open(t.name, "w")
18	        f.write(info.proxy_key)
19	        f.close()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_proxy_tunnel.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
17	        f = open(t.name, "w")
18	        f.write(info.proxy_key)
19	        f.close()

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:269
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
268	
269	    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
270	    return socket.inet_ntoa(

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
359	    try:
360	        proxy_response = await session.request(
361	            method=scope["method"],
362	            url=path,
363	            headers=[(k.decode(), v.decode()) for k, v in scope["headers"]],
364	            data=None if scope["method"] in aiohttp.ClientRequest.GET_METHODS else request_generator(),
365	            allow_redirects=False,
366	        )

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:380
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
379	        }
380	        await send(msg)
381	        async for data in proxy_response.content.iter_any():

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:383
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
382	            msg = {"type": "http.response.body", "body": data, "more_body": True}
383	            await send(msg)
384	        await send({"type": "http.response.body"})

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:384
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
383	            await send(msg)
384	        await send({"type": "http.response.body"})
385	

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:398
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
397	        send_response_task = tc.create_task(send_response())
398	        disconnect_task = tc.create_task(listen_for_disconnect())
399	        await asyncio.wait([send_response_task, disconnect_task], return_when=asyncio.FIRST_COMPLETED)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:413
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
412	
413	    async with session.ws_connect(
414	        url=path,
415	        headers=[(k.decode(), v.decode()) for k, v in scope["headers"]],  # type: ignore
416	        protocols=scope.get("subprotocols", []),
417	    ) as upstream_ws:

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:423
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
422	                if client_message["type"] == "websocket.disconnect":
423	                    await upstream_ws.close(code=client_message.get("code", 1005))
424	                    break

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:438
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
437	            }
438	            await send(msg)
439	

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:447
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
446	                        msg["reason"] = upstream_message.extra
447	                    await send(msg)
448	                    break

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:450
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
449	                elif upstream_message.type == aiohttp.WSMsgType.text:
450	                    await send({"type": "websocket.send", "text": upstream_message.data})
451	                elif upstream_message.type == aiohttp.WSMsgType.binary:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:452
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
451	                elif upstream_message.type == aiohttp.WSMsgType.binary:
452	                    await send({"type": "websocket.send", "bytes": upstream_message.data})
453	                else:

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:490
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
489	                scope["state"]["session"] = session
490	            await send({"type": "lifespan.startup.complete"})
491	        elif message["type"] == "lifespan.shutdown":

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:493
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
492	            if session is not None:
493	                await session.close()
494	            await send({"type": "lifespan.shutdown.complete"})

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:494
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
493	                await session.close()
494	            await send({"type": "lifespan.shutdown.complete"})
495	            break

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:510
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
509	            if scope["type"] == "lifespan":
510	                await _proxy_lifespan_request(base_url, scope, receive, send)
511	            elif scope["type"] == "http":

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:512
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
511	            elif scope["type"] == "http":
512	                await _proxy_http_request(scope["state"]["session"], scope, receive, send)
513	            elif scope["type"] == "websocket":

--------------------------------------------------
>> Issue: [B825:request] http.client.HTTPConnection.request
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/asgi.py:514
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b825_request.html
513	            elif scope["type"] == "websocket":
514	                await _proxy_websocket_request(scope["state"]["session"], scope, receive, send)
515	            else:

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/telemetry.py:73
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
72	    def connect(cls, socket_filename: str) -> "ImportInterceptor":
73	        tracing_socket = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
74	        tracing_socket.connect(socket_filename)

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/telemetry.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
73	        tracing_socket = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)
74	        tracing_socket.connect(socket_filename)
75	        return cls(tracing_socket)

--------------------------------------------------
>> Issue: [B805:send] socket.socket.send
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/telemetry.py:136
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b805_send.html
135	                encoded_len = pack(MESSAGE_HEADER_FORMAT, len(msg))
136	                self.tracing_socket.send(encoded_len + msg)
137	            except OSError as e:

--------------------------------------------------
>> Issue: [B804:connect] socket.socket.connect
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_runtime/telemetry.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b804_connect.html
156	        return
157	    interceptor = ImportInterceptor.connect(socket_filename)
158	    interceptor.install()

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/async_utils.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
262	    """
263	    with concurrent.futures.ThreadPoolExecutor(max_workers=1) as executor:
264	        fut = executor.submit(asyncio.run, coro)

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:124
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
123	        part_length_bytes = min(num_bytes_left, max_part_size)
124	        part_payload = BytesIOSegmentPayload(
125	            data_file_rdr,
126	            segment_start=file_offset,
127	            segment_length=part_length_bytes,
128	            chunk_size=upload_chunk_size,
129	            progress_report_cb=progress_report_cb,
130	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:191
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
190	    if resp.WhichOneof("upload_type_oneof") == "multipart":
191	        await perform_multipart_upload(
192	            data,
193	            content_length=content_length,
194	            max_part_size=resp.multipart.part_length,
195	            part_urls=resp.multipart.upload_urls,
196	            completion_url=resp.multipart.completion_url,
197	            upload_chunk_size=DEFAULT_SEGMENT_CHUNK_SIZE,
198	            progress_report_cb=progress_report_cb,
199	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
202	
203	        payload = BytesIOSegmentPayload(
204	            data, segment_start=0, segment_length=content_length, progress_report_cb=progress_report_cb
205	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:227
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
226	    upload_hashes = get_upload_hashes(payload)
227	    blob_id = await _blob_upload(upload_hashes, payload, stub)
228	    dur_s = max(time.time() - t0, 0.001)  # avoid division by zero

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:242
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
241	    upload_hashes = get_upload_hashes(file_obj, sha256_hex=sha256_hex, md5_hex=md5_hex)
242	    return await _blob_upload(upload_hashes, file_obj, stub, progress_report_cb)
243	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:256
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
255	            raise ExecutionError(f"Get from url failed with status {s3_resp.status}: {text}")
256	        return await s3_resp.read()
257	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
324	            use_blob = False
325	            content = fp.read()
326	            hashes = get_upload_hashes(content)

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
345	    # so we mask those out to 0o755 for compatibility with POSIX-based permissions.
346	    mode = mode or os.stat(filename).st_mode & (0o7777 if platform.system() != "Windows" else 0o7755)
347	    return _get_file_upload_spec(

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:346
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
345	    # so we mask those out to 0o755 for compatibility with POSIX-based permissions.
346	    mode = mode or os.stat(filename).st_mode & (0o7777 if platform.system() != "Windows" else 0o7755)
347	    return _get_file_upload_spec(

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:346
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
345	    # so we mask those out to 0o755 for compatibility with POSIX-based permissions.
346	    mode = mode or os.stat(filename).st_mode & (0o7777 if platform.system() != "Windows" else 0o7755)
347	    return _get_file_upload_spec(

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
378	        return True
379	    elif host in ["127.0.0.1", "localhost", "172.21.0.1"]:
380	        return False

--------------------------------------------------
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/blob_utils.py:379
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
378	        return True
379	    elif host in ["127.0.0.1", "localhost", "172.21.0.1"]:
380	        return False

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/deprecation.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
114	            message = (
115	                "We have renamed several parameters related to autoscaling."
116	                " Please update your code to use the following new names:"
117	                f"\n\n{substitution_string}"
118	                "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more details."

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/function_utils.py:444
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
443	            exc.args[0]
444	            + """\n
445	HINT: This error usually indicates an outdated CUDA version. Older versions of torch (<=1.12)
446	come with CUDA 10.2 by default. If pinning to an older torch version, you can specify a CUDA version

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/grpc_utils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
41	    version=__version__,
42	    sys=platform.system(),
43	    py=platform.python_implementation(),

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/grpc_utils.py:42
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
41	    version=__version__,
42	    sys=platform.system(),
43	    py=platform.python_implementation(),

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/grpc_utils.py:241
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
240	    """
241	    with contextlib.closing(socket.socket(socket.AF_INET, socket.SOCK_STREAM)) as s:
242	        s.bind(("", 0))

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
43	    logger.debug("get_sha256_base64 took %.3fs", time.monotonic() - t0)
44	    return base64.b64encode(hasher.digest()).decode("ascii")
45	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:44
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
43	    logger.debug("get_sha256_base64 took %.3fs", time.monotonic() - t0)
44	    return base64.b64encode(hasher.digest()).decode("ascii")
45	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:52
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
51	    logger.debug("get_md5_base64 took %.3fs", time.monotonic() - t0)
52	    return base64.b64encode(hasher.digest()).decode("utf-8")
53	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:52
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
51	    logger.debug("get_md5_base64 took %.3fs", time.monotonic() - t0)
52	    return base64.b64encode(hasher.digest()).decode("utf-8")
53	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
60	    def md5_hex(self) -> str:
61	        return base64.b64decode(self.md5_base64).hex()
62	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:61
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
60	    def md5_hex(self) -> str:
61	        return base64.b64decode(self.md5_base64).hex()
62	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:64
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
63	    def sha256_hex(self) -> str:
64	        return base64.b64decode(self.sha256_base64).hex()
65	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:64
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
63	    def sha256_hex(self) -> str:
64	        return base64.b64decode(self.sha256_base64).hex()
65	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:85
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
84	    if sha256_hex:
85	        sha256_base64 = base64.b64encode(bytes.fromhex(sha256_hex)).decode("ascii")
86	    else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:85
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
84	    if sha256_hex:
85	        sha256_base64 = base64.b64encode(bytes.fromhex(sha256_hex)).decode("ascii")
86	    else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
86	    else:
87	        sha256_base64 = base64.b64encode(hashers["sha256"].digest()).decode("ascii")
88	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:87
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
86	    else:
87	        sha256_base64 = base64.b64encode(hashers["sha256"].digest()).decode("ascii")
88	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
89	    if md5_hex:
90	        md5_base64 = base64.b64encode(bytes.fromhex(md5_hex)).decode("ascii")
91	    else:

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:90
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
89	    if md5_hex:
90	        md5_base64 = base64.b64encode(bytes.fromhex(md5_hex)).decode("ascii")
91	    else:

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:92
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
91	    else:
92	        md5_base64 = base64.b64encode(hashers["md5"].digest()).decode("ascii")
93	

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/hash_utils.py:92
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
91	    else:
92	        md5_base64 = base64.b64encode(hashers["md5"].digest()).decode("ascii")
93	

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/http_utils.py:62
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
61	
62	    sock = socket.socket()
63	    sock.bind(("", 0))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/http_utils.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	    port = sock.getsockname()[1]
65	    host = f"http://127.0.0.1:{port}"
66	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/jwt_utils.py:19
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
18	        # Decode Base64 (with padding handling)
19	        header_json = base64.urlsafe_b64decode(header_b64 + "==").decode("utf-8")
20	        payload_json = base64.urlsafe_b64decode(payload_b64 + "==").decode("utf-8")

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/jwt_utils.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
19	        header_json = base64.urlsafe_b64decode(header_b64 + "==").decode("utf-8")
20	        payload_json = base64.urlsafe_b64decode(payload_b64 + "==").decode("utf-8")
21	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/jwt_utils.py:31
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
30	        """Encodes data to Base64 URL-safe format without padding."""
31	        return base64.urlsafe_b64encode(data.encode()).rstrip(b"=").decode()
32	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/shell_utils.py:24
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
23	        try:
24	            nbytes = os.write(fd, data)
25	            data = data[nbytes:]

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/shell_utils.py:56
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
55	        if sys.stdin.buffer in readable:
56	            return sys.stdin.buffer.read()
57	        # we had 5 seconds of no input. send an empty string as a "heartbeat" to the server.

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/shell_utils.py:71
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
70	
71	    write_task = asyncio.create_task(_write())
72	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_utils/shell_utils.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	        yield
78	    os.write(quit_pipe_write, b"\n")
79	    write_task.cancel()

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_vendor/a2wsgi_wsgi.py:457
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
456	        if hint == -1:
457	            raw_data = self.read(-1)
458	            bytelist = raw_data.split(b"\n")

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_vendor/a2wsgi_wsgi.py:545
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
544	        self.send_queue_size = send_queue_size
545	        self.executor = ThreadPoolExecutor(
546	            thread_name_prefix="WSGI", max_workers=workers
547	        )

--------------------------------------------------
>> Issue: [B800:exec_used] exec
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/_vendor/tblib.py:175
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b800_exec_used.html
174	            try:
175	                exec(code, dict(current.tb_frame.f_globals), dict(current.tb_frame.f_locals))  # noqa: S102
176	            except Exception:

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/app.py:643
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
642	                (2025, 4, 9),
643	                "The `allow_concurrent_inputs` parameter is deprecated."
644	                " Please use the `@modal.concurrent` decorator instead."
645	                "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
646	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/app.py:868
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
867	                (2025, 4, 9),
868	                "The `allow_concurrent_inputs` parameter is deprecated."
869	                " Please use the `@modal.concurrent` decorator instead."
870	                "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
871	            )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/app.py:996
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
995	        message = (
996	            "`App.spawn_sandbox` is deprecated.\n\n"
997	            "Sandboxes can be created using the `Sandbox` object:\n\n"
998	            f"```\nsb = Sandbox.create({arglist}, app=app)\n```\n\n"
999	            "See https://modal.com/docs/guide/sandbox for more info on working with sandboxes."

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/_download.py:54
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
53	                        else:
54	                            shutil.rmtree(output_path)
55	                    else:

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/_download.py:74
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
73	                        async for chunk in volume.read_file(entry.path):
74	                            sys.stdout.buffer.write(chunk)
75	                            progress_cb(task_id=progress_task_id, advance=len(chunk))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/_download.py:84
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
83	                            async for chunk in volume.read_file(entry.path):
84	                                b += fp.write(chunk)
85	                                progress_cb(task_id=progress_task_id, advance=len(chunk))

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/config.py:10
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
9	    name="config",
10	    help="""
11	    Manage client configuration for the current profile.
12	
13	    Refer to https://modal.com/docs/reference/modal.config for a full explanation
14	    of what these options mean, and how to set them.
15	    """,
16	    no_args_is_help=True,

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/entry_point.py:38
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
37	    rich_markup_mode="markdown",
38	    help="""
39	    Modal is the fastest way to run code in the cloud.

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/entry_point.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
56	    """Checks whether the `modal` executable is on the path and usable."""
57	    url = "https://modal.com/docs/guide/troubleshooting#command-not-found-errors"
58	    try:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/programs/run_jupyter.py:67
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
66	        url = tunnel.url + "/?token=" + token
67	        threading.Thread(target=wait_for_port, args=(url, q)).start()
68	        print("\nJupyter on Modal, opening in browser...")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/programs/vscode.py:18
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
17	
18	CODE_SERVER_INSTALLER = "https://code-server.dev/install.sh"
19	CODE_SERVER_ENTRYPOINT = (

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/programs/vscode.py:20
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
19	CODE_SERVER_ENTRYPOINT = (
20	    "https://raw.githubusercontent.com/coder/code-server/refs/tags/v4.96.1/ci/release-image/entrypoint.sh"
21	)
22	FIXUD_INSTALLER = "https://github.com/boxboat/fixuid/releases/download/v0.6.0/fixuid-0.6.0-linux-$ARCH.tar.gz"
23	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/programs/vscode.py:22
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
21	)
22	FIXUD_INSTALLER = "https://github.com/boxboat/fixuid/releases/download/v0.6.0/fixuid-0.6.0-linux-$ARCH.tar.gz"
23	
24	
25	app = App(include_source=True)  # TODO: remove include_source=True when automount is disabled by default

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/programs/vscode.py:95
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
94	        print(f"   -> password: {token}\n")
95	        threading.Thread(target=wait_for_port, args=((url, token), q)).start()
96	        subprocess.run(

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/run.py:573
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
572	
573	    if platform.system() == "Windows":
574	        raise InvalidError("`modal shell` is currently not supported on Windows")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/run.py:573
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
572	
573	    if platform.system() == "Windows":
574	        raise InvalidError("`modal shell` is currently not supported on Windows")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/secret.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
95	    with NamedTemporaryFile("w+", prefix="secret_buffer", suffix=".txt") as bufferfile:
96	        if platform.system() != "Windows":
97	            editor = os.getenv("EDITOR", "vi")

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/secret.py:96
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
95	    with NamedTemporaryFile("w+", prefix="secret_buffer", suffix=".txt") as bufferfile:
96	        if platform.system() != "Windows":
97	            editor = os.getenv("EDITOR", "vi")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/secret.py:96
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
95	    with NamedTemporaryFile("w+", prefix="secret_buffer", suffix=".txt") as bufferfile:
96	        if platform.system() != "Windows":
97	            editor = os.getenv("EDITOR", "vi")

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/secret.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
103	            input("Pressing enter will open an external editor to allow you to edit the secret value...")
104	            status_code = os.system(bufferfile.name)
105	

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/secret.py:104
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
103	            input("Pressing enter will open an external editor to allow you to edit the secret value...")
104	            status_code = os.system(bufferfile.name)
105	

--------------------------------------------------
>> Issue: [B316:blacklist] os.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/secret.py:104
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b313-b320-os-system
103	            input("Pressing enter will open an external editor to allow you to edit the secret value...")
104	            status_code = os.system(bufferfile.name)
105	

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cli/secret.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
112	        bufferfile.seek(0)
113	        return bufferfile.read()

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/cls.py:679
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
678	            (2025, 1, 27),
679	            "`modal.Cls.lookup` is deprecated and will be removed in a future release."
680	            " It can be replaced with `modal.Cls.from_name`."
681	            "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
682	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/config.py:210
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
209	    "log_format": _Setting("STRING", lambda s: s.upper()),
210	    "server_url": _Setting("https://api.modal.com"),
211	    "token_id": _Setting(),

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/container_process.py:122
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
121	    async def attach(self, *, pty: Optional[bool] = None):
122	        if platform.system() == "Windows":
123	            print("interactive exec is not currently supported on Windows.")

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/container_process.py:122
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
121	    async def attach(self, *, pty: Optional[bool] = None):
122	        if platform.system() == "Windows":
123	            print("interactive exec is not currently supported on Windows.")

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/dict.py:171
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
170	            (2025, 1, 27),
171	            "`modal.Dict.lookup` is deprecated and will be removed in a future release."
172	            " It can be replaced with `modal.Dict.from_name`."
173	            "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
174	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/environments.py:91
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
90	            (2025, 1, 27),
91	            "`modal.Environment.lookup` is deprecated and will be removed in a future release."
92	            " It can be replaced with `modal.Environment.from_name`."
93	            "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
94	        )

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/exception.py:164
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
163	    """
164	    signal.signal(signal.SIGALRM, _simulate_preemption_interrupt)
165	    jitter = random.randrange(0, jitter_seconds) if jitter_seconds else 0

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/exception.py:164
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
163	    """
164	    signal.signal(signal.SIGALRM, _simulate_preemption_interrupt)
165	    jitter = random.randrange(0, jitter_seconds) if jitter_seconds else 0

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/experimental/__init__.py:105
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
104	        with open(os.path.expanduser(path)) as f:
105	            commands = f.read().split("\n")
106	        return DockerfileSpec(commands=commands, context_files={})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/gpu.py:165
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
164	
165	__doc__ = """
166	**GPU configuration shortcodes**
167	
168	You can pass a wide range of `str` values for the `gpu` parameter of
169	[`@app.function`](/docs/reference/modal.App#function).
170	
171	For instance:
172	- `gpu="H100"` will attach 1 H100 GPU to each container
173	- `gpu="L40S"` will attach 1 L40S GPU to each container
174	- `gpu="T4:4"` will attach 4 T4 GPUs to each container
175	
176	You can see a list of Modal GPU options in the
177	[GPU docs](https://modal.com/docs/guide/gpu).
178	
179	**Example**
180	
181	```python
182	@app.function(gpu="A100-80GB:4")
183	def my_gpu_function():
184	    ... # This will have 4 A100-80GB with each container
185	```
186	
187	**Deprecation notes**
188	
189	An older deprecated way to configure GPU is also still supported,
190	but will be removed in future versions of Modal. Examples:
191	
192	- `gpu=modal.gpu.H100()` will attach 1 H100 GPU to each container
193	- `gpu=modal.gpu.T4(count=4)` will attach 4 T4 GPUs to each container
194	- `gpu=modal.gpu.A100()` will attach 1 A100-40GB GPUs to each container
195	- `gpu=modal.gpu.A100(size="80GB")` will attach 1 A100-80GB GPUs to each container
196	"""
197	
198	GPU_T = Union[None, str, _GPUConfig]

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/image.py:86
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
85	
86	COPY_DEPRECATION_MESSAGE_PATTERN = """modal.Image.copy_* methods will soon be deprecated.
87	
88	Use {replacement} instead, which is functionally and performance-wise equivalent.
89	
90	See https://modal.com/docs/guide/modal-1-0-migration for more details.
91	"""
92	
93	
94	def _validate_python_version(

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/image.py:578
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
577	                with open(path, "rb") as f:
578	                    context_file_pb2s.append(api_pb2.ImageContextFile(filename=filename, data=f.read()))
579	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/image.py:1203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
1202	                msg = (
1203	                    "No [project.dependencies] section in pyproject.toml file. "
1204	                    "If your pyproject.toml instead declares [tool.poetry.dependencies], "
1205	                    "use `Image.poetry_install_from_file()`. "
1206	                    "See https://packaging.python.org/en/latest/guides/writing-pyproject-toml "
1207	                    "for further file format guidelines."
1208	                )
1209	                raise ValueError(msg)
1210	            else:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/image.py:1789
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
1788	            with open(os.path.expanduser(path)) as f:
1789	                commands = f.read().split("\n")
1790	            return DockerfileSpec(commands=commands, context_files={})

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/mount.py:51
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
50	
51	MOUNT_DEPRECATION_MESSAGE_PATTERN = """modal.Mount usage will soon be deprecated.
52	
53	Use {replacement} instead, which is functionally and performance-wise equivalent.
54	
55	See https://modal.com/docs/guide/modal-1-0-migration for more details.
56	"""
57	
58	
59	def client_mount_name() -> str:

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/mount.py:486
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
485	        loop = asyncio.get_event_loop()
486	        with concurrent.futures.ThreadPoolExecutor() as exe:
487	            all_files = await loop.run_in_executor(exe, _select_files, entries)

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/mount.py:712
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
711	            (2025, 1, 27),
712	            "`modal.Mount.lookup` is deprecated and will be removed in a future release."
713	            " It can be replaced with `modal.Mount.from_name`."
714	            "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
715	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/network_file_system.py:192
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
191	            (2025, 1, 27),
192	            "`modal.NetworkFileSystem.lookup` is deprecated and will be removed in a future release."
193	            " It can be replaced with `modal.NetworkFileSystem.from_name`."
194	            "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
195	        )

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/network_file_system.py:263
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
262	        else:
263	            data = fp.read()
264	            req = api_pb2.SharedVolumePutFileRequest(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/queue.py:203
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
202	            (2025, 1, 27),
203	            "`modal.Queue.lookup` is deprecated and will be removed in a future release."
204	            " It can be replaced with `modal.Queue.from_name`."
205	            "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
206	        )

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/runner.py:65
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
64	    )
65	    app_page_url = f"https://modal.com/apps/{existing_app_id}"  # TODO (elias): this should come from the backend
66	    return running_app_from_layout(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/sandbox.py:303
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
302	                raise ValueError(
303	                    "App has not been initialized yet. To create an App lazily, use `App.lookup`: \n"
304	                    "app = modal.App.lookup('my-app', create_if_missing=True)\n"
305	                    "modal.Sandbox.create('echo', 'hi', app=app)\n"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/secret.py:219
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
218	            (2025, 1, 27),
219	            "`modal.Secret.lookup` is deprecated and will be removed in a future release."
220	            " It can be replaced with `modal.Secret.from_name`."
221	            "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
222	        )

--------------------------------------------------
>> Issue: [B838:process] multiprocessing.Process
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/serving.py:47
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b838_process.html
46	    show_progress = output_mgr is not None
47	    p = ctx.Process(target=_run_serve, args=(import_ref, existing_app_id, is_ready, environment_name, show_progress))
48	    p.start()

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/serving.py:80
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
79	    unsupported_msg = None
80	    if platform.system() == "Windows":
81	        unsupported_msg = "Live-reload skipped. This feature is currently unsupported on Windows"

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/serving.py:80
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
79	    unsupported_msg = None
80	    if platform.system() == "Windows":
81	        unsupported_msg = "Live-reload skipped. This feature is currently unsupported on Windows"

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/volume.py:238
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
237	            (2025, 1, 27),
238	            "`modal.Volume.lookup` is deprecated and will be removed in a future release."
239	            " It can be replaced with `modal.Volume.from_name`."
240	            "\n\nSee https://modal.com/docs/guide/modal-1-0-migration for more information.",
241	        )

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/volume.py:419
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
418	
419	        n = fileobj.write(response.data)
420	        if n != len(response.data):

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/volume.py:440
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
439	
440	            n = fileobj.write(response.data)
441	            if n != len(response.data):

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/volume.py:561
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
560	                loop = asyncio.get_event_loop()
561	                with concurrent.futures.ThreadPoolExecutor() as exe:
562	                    # TODO: avoid eagerly expanding

--------------------------------------------------
>> Issue: [B812:system] os.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/volume.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b812_system.html
685	def _open_files_error_annotation(mount_path: str) -> Optional[str]:
686	    if platform.system() != "Linux":
687	        return None

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/volume.py:686
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
685	def _open_files_error_annotation(mount_path: str) -> Optional[str]:
686	    if platform.system() != "Linux":
687	        return None

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/volume.py:686
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
685	def _open_files_error_annotation(mount_path: str) -> Optional[str]:
686	    if platform.system() != "Linux":
687	        return None

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal/volume.py:694
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
693	        with open(f"/proc/{pid}/cmdline", "rb") as f:
694	            raw = f.read()
695	            parts = raw.split(b"\0")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/modal-0.73.164/modal-0.73.164/modal_docs/gen_reference_docs.py:169
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
168	        with open(filename, "w") as fp:
169	            fp.write(data)
170	

--------------------------------------------------

Code scanned:
	Total lines of code: 34812
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 63.0
		High: 88.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 121.0
		High: 30.0
Files skipped (0):
