Run started:2025-04-13 06:58:31.533115

Test results:
>> Issue: [B823:ip_found] ip_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/__main__.py:13
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b823_ip_found.html
12	parser = argparse.ArgumentParser(description="Launch httpstan HTTP server.")
13	parser.add_argument("--host", default="127.0.0.1")
14	parser.add_argument("--port", default="8080")

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/build_ext.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
89	            stream.seek(0)
90	            compiler_output = stream.read().decode()
91	            stream.close()

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/cache.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
38	    """Delete the directory in which a model and associated fits are stored."""
39	    shutil.rmtree(model_directory(model_name), ignore_errors=True)
40	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/compile.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
27	            with filepath.open("w") as fh:
28	                fh.write(program_code)
29	            run_args: List[Union[os.PathLike, str]] = [

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/compile.py:28
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
27	            with filepath.open("w") as fh:
28	                fh.write(program_code)
29	            run_args: List[Union[os.PathLike, str]] = [

--------------------------------------------------
>> Issue: [B817:system] platform.system
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/models.py:151
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b817_system.html
150	    libraries = ["sundials_cvodes", "sundials_idas", "sundials_nvecserial", "tbb"]
151	    if platform.system() == "Darwin":  # pragma: no cover
152	        libraries.extend(["tbbmalloc", "tbbmalloc_proxy"])

--------------------------------------------------
>> Issue: [B308:blacklist] platform.system
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/models.py:151
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b308-platform-system
150	    libraries = ["sundials_cvodes", "sundials_idas", "sundials_nvecserial", "tbb"]
151	    if platform.system() == "Darwin":  # pragma: no cover
152	        libraries.extend(["tbbmalloc", "tbbmalloc_proxy"])

--------------------------------------------------
>> Issue: [B828:signal] signal.signal
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:33
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b828_signal.html
32	def init_worker() -> None:
33	    signal.signal(signal.SIGINT, signal.SIG_IGN)  # ignore KeyboardInterrupt
34	

--------------------------------------------------
>> Issue: [B324:blacklist] signal_signal
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:33
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b324-signal-signal
32	def init_worker() -> None:
33	    signal.signal(signal.SIGINT, signal.SIG_IGN)  # ignore KeyboardInterrupt
34	

--------------------------------------------------
>> Issue: [B840:executor] concurrent.futures.Executor
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:36
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b840_executor.html
35	
36	executor = concurrent.futures.ProcessPoolExecutor(mp_context=mp.get_context("fork"), initializer=init_worker)
37	logger = logging.getLogger("httpstan")

--------------------------------------------------
>> Issue: [B304:blacklist] socket.socket
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:95
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b304-b305-ciphers-and-modes
94	
95	    with socket.socket(socket.AF_UNIX, type=socket.SOCK_STREAM) as socket_:
96	        temp_fd, socket_filename = tempfile.mkstemp(prefix="httpstan_", suffix=".sock")

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:97
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
96	        temp_fd, socket_filename = tempfile.mkstemp(prefix="httpstan_", suffix=".sock")
97	        os.close(temp_fd)
98	        os.unlink(socket_filename)

--------------------------------------------------
>> Issue: [B809:recv] socket.socket.recv
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:130
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b809_recv.html
129	                    continue
130	                message = s.recv(8192)
131	                if not len(message):

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:133
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
132	                    # `close` called on other end
133	                    s.close()
134	                    logger.debug("Closed socket connection to a socket_logger or socket_writer.")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
139	                    logger_callback(message)
140	                messages_files[s].write(messages_compressobjs[s].compress(message))
141	            # if `potential_readers == [socket_]` then either (1) no connections

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:140
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
139	                    logger_callback(message)
140	                messages_files[s].write(messages_compressobjs[s].compress(message))
141	            # if `potential_readers == [socket_]` then either (1) no connections

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
153	    for s, fh in messages_files.items():
154	        fh.write(messages_compressobjs[s].flush())
155	        fh.flush()

--------------------------------------------------
>> Issue: [B832:write] tempfile_NamedTemporaryFile_write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b832_write.html
153	    for s, fh in messages_files.items():
154	        fh.write(messages_compressobjs[s].flush())
155	        fh.flush()

--------------------------------------------------
>> Issue: [B807:close] socket.socket.close
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:157
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b807_close.html
156	        compressed_parts.append(fh.getvalue())
157	        fh.close()
158	    httpstan.cache.dump_fit(b"".join(compressed_parts), fit_name)

--------------------------------------------------
>> Issue: [B816:decompress] zlib.decompress
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/services_stub.py:170
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b816_decompress.html
169	
170	        jsonlines = gzip.decompress(b"".join(compressed_parts)).decode()
171	        for line in jsonlines.split("\n"):

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:35
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
34	        status_dict["details"] = details
35	    return cast(dict, schemas.Status().load(status_dict))
36	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:90
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
89	        stanc_warnings = httpstan.cache.load_stanc_warnings(model_name)
90	        response_dict = schemas.Model().load(
91	            {"name": model_name, "compiler_output": compiler_output, "stanc_warnings": stanc_warnings}
92	        )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:123
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
122	    httpstan.cache.dump_services_extension_module_compiler_output(compiler_output, model_name)
123	    response_dict = schemas.Model().load(
124	        {"name": model_name, "compiler_output": compiler_output, "stanc_warnings": stanc_warnings}
125	    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:154
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
153	        models.append(
154	            schemas.Model().load(
155	                {"name": model_name, "compiler_output": compiler_output, "stanc_warnings": stanc_warnings}
156	            )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:275
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
274	        constrained_names = tuple(filter(lambda s: re.match(rf"^{name}\.\S+|^{name}\Z", s), constrained_param_names))
275	        params.append(schemas.Parameter().load({"name": name, "dims": dims_, "constrained_names": constrained_names}))
276	    return aiohttp.web.json_response({"name": model_name, "params": params})

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:356
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
355	        operation_name = f'operations/{name.split("/")[-1]}'
356	        operation_dict = schemas.Operation().load(
357	            {
358	                "name": operation_name,
359	                "done": True,
360	                "metadata": {"fit": schemas.Fit().load({"name": name})},
361	                "result": schemas.Fit().load({"name": name}),
362	            }

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:360
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
359	                "done": True,
360	                "metadata": {"fit": schemas.Fit().load({"name": name})},
361	                "result": schemas.Fit().load({"name": name}),

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:361
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
360	                "metadata": {"fit": schemas.Fit().load({"name": name})},
361	                "result": schemas.Fit().load({"name": name}),
362	            }

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:399
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
398	            logger.info(f"Operation `{operation['name']}` finished.")
399	            operation["result"] = schemas.Fit().load(operation["metadata"]["fit"])
400	

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:402
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
401	    operation_name = f'operations/{name.split("/")[-1]}'
402	    operation_dict = schemas.Operation().load(
403	        {"name": operation_name, "done": False, "metadata": {"fit": schemas.Fit().load({"name": name})}}
404	    )

--------------------------------------------------
>> Issue: [B835:load] http.cookiejar.FileCookieJar.load
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/httpstan-4.13.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64/httpstan/views.py:403
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b835_load.html
402	    operation_dict = schemas.Operation().load(
403	        {"name": operation_name, "done": False, "metadata": {"fit": schemas.Fit().load({"name": name})}}
404	    )

--------------------------------------------------

Code scanned:
	Total lines of code: 1718
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 4.0
		High: 27.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 28.0
		High: 3.0
Files skipped (0):
