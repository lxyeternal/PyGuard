Run started:2025-04-12 12:06:49.353619

Test results:
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/files.py:404
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
403	                subsampling=subsampling, keep_icc_profile=thumbnail_options.get('keep_icc_profile', False))
404	        data = img.read()
405	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:43
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
42	        except Exception as e:
43	            self.stderr.write("Something went wrong when checking existance of {}:".format(path))
44	            self.stderr.write(e)

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:44
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
43	            self.stderr.write("Something went wrong when checking existance of {}:".format(path))
44	            self.stderr.write(e)
45	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:57
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
56	        if dry_run:
57	            self.stdout.write("Dry run...")
58	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:78
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
77	            if not source_storage:
78	                self.stdout.write(f"Source storage hash ({source.storage_hash}) not found in STORAGES")
79	                self.stdout.write("Can't determine source storage, skipping source")

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:79
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
78	                self.stdout.write(f"Source storage hash ({source.storage_hash}) not found in STORAGES")
79	                self.stdout.write("Can't determine source storage, skipping source")
80	                continue

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
86	                if verbosity > 0:
87	                    self.stdout.write("Source not present: {}".format(abs_source_path))
88	                self.source_refs_deleted += 1

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:99
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
98	                        if verbosity > 0:
99	                            self.stdout.write("Deleting thumbnail: {}".format(abs_thumbnail_path))
100	

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:113
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
112	        """
113	        self.stdout.write(
114	            "{0:-<48}".format(datetime.now().strftime('%Y-%m-%d %H:%M ')))
115	        self.stdout.write("{0:<40} {1:>7}".format("Sources checked:", self.sources))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:115
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
114	            "{0:-<48}".format(datetime.now().strftime('%Y-%m-%d %H:%M ')))
115	        self.stdout.write("{0:<40} {1:>7}".format("Sources checked:", self.sources))
116	        self.stdout.write("{0:<40} {1:>7}".format(

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:116
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
115	        self.stdout.write("{0:<40} {1:>7}".format("Sources checked:", self.sources))
116	        self.stdout.write("{0:<40} {1:>7}".format(
117	            "Source references deleted from DB:", self.source_refs_deleted))
118	        self.stdout.write("{0:<40} {1:>7}".format("Thumbnails deleted from disk:",

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:118
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
117	            "Source references deleted from DB:", self.source_refs_deleted))
118	        self.stdout.write("{0:<40} {1:>7}".format("Thumbnails deleted from disk:",
119	                                    self.thumbnails_deleted))
120	        self.stdout.write("(Completed in {} seconds)\n".format(self.execution_time))

--------------------------------------------------
>> Issue: [B815:write] os.write
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/management/commands/thumbnail_cleanup.py:120
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b815_write.html
119	                                    self.thumbnails_deleted))
120	        self.stdout.write("(Completed in {} seconds)\n".format(self.execution_time))
121	

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/namers.py:42
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
41	    short_sha = hashlib.sha1(parts.encode('utf-8')).digest()
42	    short_hash = base64.urlsafe_b64encode(short_sha[:9]).decode('utf-8')
43	    return '.'.join([short_hash, thumbnail_extension])

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/namers.py:58
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
57	    source_sha = hashlib.sha1(source_filename.encode('utf-8')).digest()
58	    source_hash = base64.urlsafe_b64encode(source_sha[:9]).decode('utf-8')
59	    parts = ':'.join(prepared_options[1:])

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/namers.py:61
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
60	    parts_sha = hashlib.sha1(parts.encode('utf-8')).digest()
61	    options_hash = base64.urlsafe_b64encode(parts_sha[:6]).decode('utf-8')
62	    return '%s_%s_%s.%s' % (

--------------------------------------------------
>> Issue: [B802:b64encode] base64.b64encode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/templatetags/thumbnail.py:325
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b802_b64encode.html
324	    mime_type = mimetypes.guess_type(str(thumbnail.file))[0] or 'application/octet-stream'
325	    data = b64encode(data).decode('utf-8')
326	    return 'data:{0};base64,{1}'.format(mime_type, data)

--------------------------------------------------
>> Issue: [B301:blacklist] base64.b64encode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/templatetags/thumbnail.py:325
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b301-base64-b64encode
324	    mime_type = mimetypes.guess_type(str(thumbnail.file))[0] or 'application/octet-stream'
325	    data = b64encode(data).decode('utf-8')
326	    return 'data:{0};base64,{1}'.format(mime_type, data)

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/test_fields.py:103
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
102	            try:
103	                return field.file.read()
104	            finally:

--------------------------------------------------
>> Issue: [B814:read] os.read
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/test_fields.py:108
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b814_read.html
107	        with field.open('rb') as fd:
108	            return fd.read()
109	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/test_source_generators.py:32
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
31	def image_from_b64(data):
32	    return Image.open(BytesIO(base64.b64decode(data)))
33	

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/test_source_generators.py:32
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
31	def image_from_b64(data):
32	    return Image.open(BytesIO(base64.b64decode(data)))
33	

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/test_source_generators.py:70
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
69	
70	            im = source_generators.pil_image(BytesIO(base64.b64decode(data)))
71	            self.assertTrue(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/test_source_generators.py:70
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
69	
70	            im = source_generators.pil_image(BytesIO(base64.b64decode(data)))
71	            self.assertTrue(

--------------------------------------------------
>> Issue: [B801:b64decode] base64.b64decode
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/test_source_generators.py:87
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b801_b64decode.html
86	        im = source_generators.pil_image(
87	            BytesIO(base64.b64decode(data)), exif_orientation=False)
88	        self.assertFalse(

--------------------------------------------------
>> Issue: [B300:blacklist] base64.b64decode
   Severity: Medium   Confidence: High
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/test_source_generators.py:87
   More Info: https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b300-base64-b64decode
86	        im = source_generators.pil_image(
87	            BytesIO(base64.b64decode(data)), exif_orientation=False)
88	        self.assertFalse(

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/test_templatetags.py:484
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
483	        Image = import_string('easy_thumbnails.VIL.Image')
484	        expected = '<svg width="30" height="30" preserveAspectRatio="xMinYMin meet" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg" version="1.0" fill-rule="evenodd" xmlns:xlink="http://www.w3.org/1999/xlink"><title>...</title><desc>...</desc><g id="group" transform="scale(1,-1) translate(0,-30)" clip="0 0 30 30"/></svg>'
485	        with Image.new('rgb', (30, 30)) as img:

--------------------------------------------------
>> Issue: [B836:rmtree] shutil.rmtree
   Severity: High   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/tests/utils.py:39
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b836_rmtree.html
38	        if temporary_location:
39	            shutil.rmtree(temporary_location)
40	

--------------------------------------------------
>> Issue: [B824:url_found] url_found
   Severity: Medium   Confidence: Medium
   Location: /home/blue/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/setup.py:26
   More Info: https://bandit.readthedocs.io/en/latest/plugins/b824_url_found.html
25	    version=easy_thumbnails.get_version(),
26	    url="http://github.com/SmileyChris/easy-thumbnails",
27	    description="Easy thumbnails for Django",

--------------------------------------------------

Code scanned:
	Total lines of code: 4822
	Total lines skipped (#nosec): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0.0
		Low: 0.0
		Medium: 6.0
		High: 23.0
	Total issues (by confidence):
		Undefined: 0.0
		Low: 0.0
		Medium: 25.0
		High: 4.0
Files skipped (0):
